[{"title": "微信小程序开发中 var that =this的用法 ", "author": "                  Rolan                  2020-2-6 00:52                ", "text": "                                                                                                                                                                                     在微信小程序开发中var that =this的声明很常见。举个例子代码如下！示例代码11  //index.js  2  Page({  3   4   data: {  5    toastHidden: true,  6   },  7   8   loadData: function () {  9      var that = this//这里声明了that；将this存在that里面  10     wx.request({  11       url: 'test.php',  12       data: {a: 'a', b: 'b'},  13       header: {  14        'content-type': 'application/json'  15       },  16       success(res) {  17           that.setData({ toastHidden: false }) //这里使用了that这样就可以获取Page({})对象  18        },  19      })  20    }  21  22  })在代码中第9行声明了var that =this；第17行使用了that。如果不声明var that =this且that改成this代码如下！示例代码21  //index.js  2   Page({  3  4    data: {  5     toastHidden: true,  6   },  7  8    loadData: function () {  9      wx.request({  10      url: 'test.php',  11      data: {a: 'a', b: 'b'},  12      header: {  13       'content-type': 'application/json'  14      },  15      success(res) {  16        this.setData({ toastHidden: false })  17       },  18      })  19   }  20  21  })此时运行代码就会报以下错误！从报错中得知setData这个属性读不到为何读不到？这跟this关键字的作用域有关！this作用域分析：1.在Page({})里面this关键字指代Page({})整个对象2.因此可以通过this关键字访问或者重新设置Page({})里data的变量3.然而在loadData函数中使用了wx.request({})API这个方法导致在wx.request({})里没办法使用this来获取Page({})对象4.虽然在wx.request({})里没法使用this获取Page({})对象但是可以在wx.request({})外面先把this存在某个变量中所以就有了var that =this 这个声明。此时that指代Page({})整个对象这样子就可以在wx.request({})里使用that访问或者重新设置Page({})里data的变量                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序--滑动右侧字母索引               小程序页面效果--如何实现滚动列表左右半透明                                                        原作者:  阿山                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序、H5登录授权、分享、支付流程 ", "author": "                  Rolan                  2020-1-14 00:32                ", "text": "                                                                                                                                                                                                                                                                 前言对于前端来说微信的 支付 、 分享 、 登录 是一定要掌握的今天这篇文章主要对这三方面的流程进行详细的介绍。主要内容如下：域名相关知识介绍该网站不安全请不要输入密码微信小程序授权登录流程op=>operation: openid判断是否登录授权op2=>operation: 根据wx.login获取codeop3=>operation: 调用服务端根据code换取openidop4=>operation: 通过用户授权获取信息存到数据库op->op2->op3->op4复制代码如果你从来没有阅读过小程序登录授权的文档建议你看一下下面的地址：服务端官方文档 客户端文档nodejs + 小程序实现授权登录前端部分根据本地是否有userId判断是否登录如果没有登录则获取用户的openidonLoad() {   if(!this.data.userId) {       this.getSession()   }}, getSession() {   wx.login({     success: (res) => {       if (res.code) {         app.get(Api.getSession, {           code: res.code         }).then(res => {           store.setItem('openid', res.openid)         })       }     }   }) }复制代码点击授权按钮发起登录请求。getUserInfo(e) {    let userInfo = e.detail.userInfo;    userInfo.openid = store.getItem('openid')    app.get(Api.login, {        userInfo    }).then(res => {        store.setItem('userId', res.data.userId)        this.setData({            userId: res.userId        })    })}复制代码服务端部分在 config 里面定义公用的 appid 和 appsecretmodule.exports = {    wx: {        appId: 'wx0ef10432747d8f57',        appsecret: 'cc47a6127687e999a1dffa756ff83c0e'    },    mp: {        appId: 'wx0691f1dcf6e5e231',        appSecret: 'c7ed875e338120f15f49476a6596eb4f'    }}复制代码然后通过调用小程序 官方文档 的接口获取到 appid 传给客户端let express = require('express');let router = express.Router();let request = require('request');let config = require('./config');let uril = require('./../../util/index')config = Object.assign({}, config.mp);router.get('/getSession', (req, res) => {    let code = req.query.code    if (!code) {        res.json(uril.handleFail('code不能为空', 10001))    }    let sessionUrl = `https://api.weixin.qq.com/sns/jscode2session?appid=${config.appId}&secret=${config.appSecret}&js_code=${code}&grant_type=authorization_code`;    request(sessionUrl, (err, response, body) => {        let result = util.handleResponse(err, response, body)        res.json(result)    })})复制代码登录接口 的编写// 小程序授权登录router.get('/login',async function(req,res){  let userInfo = JSON.parse(req.query.userInfo);  if (!userInfo){    // 如果接口没有信息则返回错误信息    res.json(util.handleFail('用户信息不能为空',10002))  }else{    // 查询当前用户是否已经注册    let userRes = await dao.query({ openid: userInfo.openid},'users_mp');    if (userRes.code == 0){      // 如果已经注册直接把查出来的信息返回给客户端      if (userRes.data.length >0){        res.json(util.handleSuc({          userId: userRes.data[0]._id        }))      }else{        // 如果这个用户之前没有注册则在数据库插入用户信息        let insertData = await dao.insert(userInfo,'users_mp');        if (insertData.code == 0){          let result = await dao.query({ openid: userInfo.openid }, 'users_mp');          res.json(util.handleSuc({            userId: result.data[0]._id          }))        }else{          res.json(insertData);        }      }    }else{      res.json(userRes);    }  }})复制代码上述代码的 handleFail 和 handleResponse 是封装的对数据的统一处理如果有兴趣参见 github 地址。这里不展示代码。需要注意的是这种实现方式获取 openid 的行为放在后端实现了。如果放在前端实现也可以但是会相对比较麻烦一点。此时suerId就已经在数据库存储并且在本地保存了下次登录的时候如果有userId存在就不需要再次登录了。H5的登录授权和分享流程H5的登录授权略有不同。如果用户登录授权页面发现该用户没有登录授权则需要跳转到授权页面。 官方文档 给出的流程如下：1 第一步：用户同意授权获取code2 第二步：通过code换取网页授权access_token3 第三步：刷新access_token（如果需要）4 第四步：拉取用户信息(需scope为 snsapi_userinfo)5 附：检验授权凭证（access_token）是否有效在项目中代码如下：(这里代码没有实现刷新access_token和拉取用户信息)页面加载的时候判断是否已经授权。mounted(){   this.checkUserAuth(); },methods:{// 检查用户是否授权过checkUserAuth(){  let openId = this.$cookie.get('openId');  if(!openId){    // 如果没有登录授权则跳转到微信提供的跳转页面。    window.location.href = API.wechatRedirect;  }else{  // 如果用户已经授权则调用获取微信配置信息接口    this.getWechatConfig();  }},复制代码API.wechatRedirect:wechatRedirect:'/api/wechat/redirect?url=http%3A%2F%2Fm.51purse.com%2F%23%2Findex&scope=snsapi_userinfo',复制代码「注意」url地址需要 encodeURIComponent 编码才可以。m.51purse.com 需要与你在微信公众号后台配置的 授权域名 一致！nodejs 对登录授权回调接口的实现主要是拿到客户端的请求参数请求微信提供的 接口// 用户授权重定向router.get('/redirect',function (req,res) {  let redirectUrl = req.query.url, scope = req.query.scope, callback = 'http://m.51purse.com/api/wechat/getOpenId';  cache.put('redirectUrl', redirectUrl);  // 获取到客户端带过来的数据请求微信接口  let authorizeUrl = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${config.appId}&redirect_uri=${callback}&response_type=code&scope=${scope}&state=STATE#wechat_redirect`;  res.redirect(authorizeUrl);})复制代码当用户点击 确认授权 之后会执行跳转 callbacl：http://m.51purse.com/api/wechat/getOpenId 。而这个接口也是node端实现的具体内容如下：// 用code换取access_token的方法exports.getAccessToken = function(code){  let token_url = `https://api.weixin.qq.com/sns/oauth2/access_token?appid=${config.appId}&secret=${config.appSecret}&code=${code}&grant_type=authorization_code`;  return new Promise((resolve, reject) => {    request.get(token_url, function (err, response, body) {      let result = util.handleResponse(err, response, body);      resolve(result);    })  });}// 根据code获取用户的OpenIdrouter.get('/getOpenId',async function(req,res){  let code = req.query.code;  console.log(\"code:\"+code);  if(!code){    res.json(util.handleFail('当前未获取到授权code码'));  }else{    // 用code换取access_token    let result = await common.getAccessToken(code);    if(result.code == 0){      // 换取access_token成功      let data = result.data;      let expire_time = 1000 * 60 * 60 * 2;      // 往客户端写入cookie：openId      res.cookie('openId', data.openid, { maxAge: expire_time });      let openId = data.openid;      let userRes = await dao.query({ 'openid': openId },'users');      if (userRes.code == 0){        if (userRes.data.length>0){          // 从数据库查找到用户信息后回调到客户端的页面          let redirectUrl = cache.get('redirectUrl');          res.redirect(redirectUrl);        }else{          let userData = await common.getUserInfo(data.access_token, openId);          let insertData = await dao.insert(userData.data,'users');          if (insertData.code == 0){            // 从数据库查找到用户信息后回调到客户端的页面            let redirectUrl = cache.get('redirectUrl');            res.redirect(redirectUrl);          }else{            // 返回错误信息            res.json(insertData);          }        }      }else{        // 返回错误信息        res.json(userRes);      }    }else{      // 返回错误信息      res.json(result);    }  }})复制代码「注意」：上面的代码为了简单删除了一些不必要的代码如有兴趣访问gitHub。H5分享流程同样如果你没有阅读过微信H5开发的 官方文档 ,建议你先阅读。关于分享你应该阅读以下内容：当再次回调到页面的时候从cookie已经拿到openId了。客户端会继续执行下面的代码。获取到服务端返回的配置信息从而初始化分享的功能。在这之前你需要 npm install wx-jssdk// 这个信息统一定义在api.js中这里为了方便放在前面便于查看。API.wechatConfig: /api/wechat/jssdk// 获取微信配置信息getWechatConfig(){  this.$http.get(API.wechatConfig+'?url='+location.href.split('#')[0]).then(function(response){    let res = response.data;    if(res.code == 0){      let data = res.data;      wx.config({        debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来若要查看传入的参数可以在pc端打开参数信息会通过log打出仅在pc端时才会打印。        appId: data.appId, // 必填公众号的唯一标识        timestamp: data.timestamp, // 必填生成签名的时间戳        nonceStr: data.nonceStr, // 必填生成签名的随机串        signature: data.signature,// 必填签名        jsApiList: data.jsApiList // 必填需要使用的JS接口列表      })      wx.ready(()=>{        util.initShareInfo(wx);      })    }  })}复制代码util/index.js 里面对分享的功能进行了封装。export default {  //获取浏览器地址栏参数值  getUrlParam(name){    let reg = new RegExp('(^|&)'+name+'=([^&]*)');    let r = window.location.search.substr(1).match(reg);    if(r!=null)return decodeURIComponent(r[2]);  },  initShareInfo(wx){    let shareInfo = {      title: 'xxxx', // 分享标题      desc: 'xxxx', // 分享描述      link: 'http://m.51purse.com/#/index', // 分享链接该链接域名或路径必须与当前页面对应的公众号JS安全域名一致      imgUrl: '', // 分享图标    }    wx.onMenuShareAppMessage(shareInfo);    wx.onMenuShareTimeline(shareInfo);    wx.onMenuShareQQ(shareInfo);    wx.onMenuShareQZone(shareInfo);    // 下面两种方法为新的方法,上面的方法将会被淘汰。    wx.updateAppMessageShareData(shareInfo);    wx.updateTimelineShareData(shareInfo);  }}复制代码nodejs端对 /wechat/jssdk 接口的实现如下：// common.getToken()方法 获取基础接口的Tokenexports.getToken = function(){  let token = `https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=${config.appId}&secret=${config.appSecret}`;  return new Promise((resolve, reject)=>{    request.get(token, function (err, response, body) {      let result = util.handleResponse(err, response, body);      resolve(result);    })  })}----router.get('/jssdk',async function(req,res){  let url = req.query.url;  let result = await common.getToken();  if (result.code == 0){    let token = result.data.access_token;    let params = {      // 生成随机字符串      noncestr:util.createNonceStr(),      // 生成时间戳      timestamp:util.createTimeStamp(),      url    }      let str = util.raw(params);      console.log('str:::' + JSON.stringify(params))      let sign = createHash('sha1').update(str).digest('hex');      res.json(util.handleSuc({        appId: config.appId, // 必填公众号的唯一标识        timestamp: params.timestamp, // 必填生成签名的时间戳        nonceStr: params.noncestr, // 必填生成签名的随机串        signature: sign,// 必填签名        jsApiList: [          'updateAppMessageShareData',          'updateTimelineShareData',          'onMenuShareTimeline',          'onMenuShareAppMessage',          'onMenuShareQQ',          'onMenuShareQZone',          'chooseWXPay'        ] // 必填需要使用的JS接口列表      }))    }  }else{    res.json(result);  }})复制代码以上代码主要获得基础的 token ,然后用基础 token 结合签名、时间戳、随机数等相关的参数返回给客户端相应的参数。需要注意的是 基础token 和 accessToken 的区别。建议 参考文章 。到此微信H5接入jssdk实现分享就已经完成了。小程序支付小程序支付前端流程获取openId调起数字签名后端支付流程拼接常规参数生成签名拼接xml数据调用下单接口获取预支付Id：prepay_id生成支付sdk定义回调接口接受微信支付消息支付的主要逻辑在服务端下面把服务端的流程通过代码的方式表述出来。首先在util中封装了一些支付需要的公共方法/** * 公共函数定义 */let createHash = require('create-hash');module.exports = {  // 生成随机数  createNonceStr(){    return Math.random().toString(36).substr(2,15);  },  // 生成时间戳  createTimeStamp(){    return parseInt(new Date().getTime() / 1000) + ''  },  // 生成签名  getSign(params, key){    let string = this.raw(params) + '&key=' + key;    let sign = createHash('md5').update(string).digest('hex');    return sign.toUpperCase();  },  // 生成系统的交易订单号  getTradeId(type='wx'){    let date = new Date().getTime().toString();    let text = '';    let possible = '0123456789';    for(let i=0;i<5;i++){      text += possible.charAt(Math.floor(Math.random() * possible.length))    }    return (type == 'wx'?'ImoocWxJuZi':'ImoocMpJuZi') + date + text;  },  // Object 转换成json并排序  raw(args){    let keys = Object.keys(args).sort();    let obj = {};    keys.forEach((key)=>{      obj[key] = args[key];    })    // {a:1,b:2} =>  &a=1&b=2    // 将对象转换为&分割的参数    let val = '';    for(let k in obj){      val += '&' + k + '=' +obj[k];    }    return val.substr(1);  }}复制代码下面是对支付的方法的封装其中调用了util中的函数。客户端调用的就是下面的 order 方法。/** * 微信小程序、H5通用支付封装 */let config = require('./../pay/config')let request = require('request')let util = require('../../util/util')let createHash = require('create-hash')let xml = require('xml2js')config = config.mch;module.exports = {    order: function (appid,attach, body, openid, total_fee, notify_url, ip){    return new Promise((resolve,reject)=>{      let nonce_str = util.createNonceStr();      let out_trade_no = util.getTradeId('mp');      // 支付前需要先获取支付签名      let sign = this.getPrePaySign(appid, attach, body, openid, total_fee, notify_url, ip, nonce_str, out_trade_no);      // 通过参数和签名组装xml数据用以调用统一下单接口      let sendData = this.wxSendData(appid, attach, body, openid, total_fee, notify_url, ip, nonce_str, out_trade_no, sign);      let self = this;      let url = 'https://api.mch.weixin.qq.com/pay/unifiedorder';      request({        url,        method: 'POST',        body: sendData      }, function (err, response, body) {        if (!err && response.statusCode == 200) {          xml.parseString(body.toString('utf-8'),(error,res)=>{            if(!error){              let data = res.xml;              console.log('data:' + JSON.stringify(data));              if (data.return_code[0] == 'SUCCESS' && data.result_code[0] == 'SUCCESS'){                // 获取预支付的ID                let prepay_id = data.prepay_id || [];                let payResult = self.getPayParams(appid, prepay_id[0]);                resolve(payResult);              }            }          })        } else {          resolve(util.handleFail(err));        }      })    })  },  // 生成预支付的签名  getPrePaySign: function (appid, attach, body, openid, total_fee, notify_url, ip, nonce_str, out_trade_no) {    let params = {      appid,      attach,      body,      mch_id: config.mch_id,      nonce_str,      notify_url,      openid,      out_trade_no,      spbill_create_ip: ip,      total_fee,      trade_type: 'JSAPI'    }    let string = util.raw(params) + '&key=' + config.key;    let sign = createHash('md5').update(string).digest('hex');    return sign.toUpperCase();  },  // 签名成功后 根据参数拼接组装XML格式的数据调用下单接口  wxSendData: function (appid, attach, body, openid, total_fee, notify_url, ip, nonce_str, out_trade_no,sign) {    let data = '<xml>' +       '<appid><![CDATA[' + appid + ']]></appid>' +       '<attach><![CDATA[' + attach + ']]></attach>' +       '<body><![CDATA[' + body + ']]></body>' +       '<mch_id><![CDATA[' + config.mch_id + ']]></mch_id>' +       '<nonce_str><![CDATA[' + nonce_str + ']]></nonce_str>' +       '<notify_url><![CDATA[' + notify_url + ']]></notify_url>' +       '<openid><![CDATA[' + openid + ']]></openid>' +       '<out_trade_no><![CDATA[' + out_trade_no + ']]></out_trade_no>' +       '<spbill_create_ip><![CDATA[' + ip + ']]></spbill_create_ip>' +       '<total_fee><![CDATA[' + total_fee + ']]></total_fee>' +       '<trade_type><![CDATA[JSAPI]]></trade_type>' +       '<sign><![CDATA['+sign+']]></sign>' +     '</xml>'    return data;  },  getPayParams:function(appId,prepay_id){    let params = {      appId,      timeStamp:util.createTimeStamp(),      nonceStr:util.createNonceStr(),      package: 'prepay_id=' + prepay_id,      signType:'MD5'    }    let paySign = util.getSign(params,config.key);    params.paySign = paySign;    return params;  }}复制代码最后定义 /pay/payWallet 的支付接口里面调用公用的order方法。// 小程序支付router.get('/pay/payWallet',function(req,res){  let openId = req.query.openId;//用户的openid  let appId = config.appId;//应用的ID  let attach = \"小程序支付课程体验\";//附加数据  let body = \"欢迎学习慕课首门支付专项课程\";//支付主体内容  let total_fee = req.query.money;//支付总金额  let notify_url = \"http://localhost:3000/api/mp/pay/callback\"  let ip = \"123.57.2.144\";  wxpay.order(appId,attach,body,openId,total_fee,notify_url,ip).then((result)=>{    res.json(util.handleSuc(result));  }).catch((result)=>{    res.json(util.handleFail(result.toString()))  });})复制代码这里的流程请参见 官方描述 。官方描述的非常清楚这儿就不描述更多了其实主要就是拼接一些参数获取 签名 。然后根据签名加上其他需要的 参数 (参见上述代码)再凭借xml的数据。然后再调用统一下单接口 https://api.mch.weixin.qq.com/pay/unifiedorder 。生成 prepay_id之后生成小程序端需要的一些参数然后把这些参数返回个小程序客户端供小程序的客户端调用微信小程序的支付功能。小程序前端支付非常简单只是简单的调用服务端提供的 payWallet 接口传入 openId 和 money 即可。然后获取到相应的参数调用微信提供的 requestPayment 拉起支付即可。主要代码逻辑如下：pay() {    app.get(Api.payWallet,{      openId: Store.getItem('openId'),      money: this.data.index    }).then((res) => {      // 支付      wx.requestPayment({        timeStamp: res.timeStamp,        nonceStr: res.nonceStr,        package: res.package,        signType: res.signType,        paySign: res.paySign,        success: function (errmsg) {          if (errmsg == 'requestPayment:ok') {            wx.showToast({              title: '支付成功',              icon: 'success'            });          }        },        fail: function (res) {          if (res.errMsg == 'requestPayment:fail cancel') {            wx.showToast({              title: '支付取消',              icon: 'none'            });          } else {            wx.showToast({              title: res.errmsg,              icon: 'none'            });          }        }      })    });  }复制代码到这里小程序端的支付功能就已经实现了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序实战教程——2实战之模仿知乎                                                                       原作者:  海明月                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序页面效果--如何实现滚动列表左右半透明 ", "author": "                  Rolan                  2020-2-6 00:56                ", "text": "                                                                                                                                                                                     为了更好的体验左右滑动而且更加美观我们常常会做如下效果：通过伪类+渐变实现左右半透明的滚动列表微信小程序同样也适用渐变的兼容性不太好所以我们需要针对不同的浏览器写不同的代码。静态页面首先先写个静态页面<div class=\"my-list\">    <ul>        <li>左右半透明</li>                <li>滚动列表</li>                <li>左右半透明</li>                <li>滚动列表</li>                <li>伪类</li>                <li>渐变</li>                <li>内容</li>    </ul></div>如果是微信小程序类似的写一个<scroll-view class=\"my-list\" scroll-x=\"true\" enable-flex=\"true\">            <text>左右半透明</text>            <text>滚动列表</text>            <text>左右半透明</text>            <text>滚动列表</text>            <text>伪类</text>            <text>渐变</text>            <text>内容</text></scroll-view>css然后写css.my-list:after,.my-list:before {    display: block;    content: \"\";    position: absolute;    z-index: 1;    top: 0;    height: 100%;    width: 20%}.my-list:before {    left: 0;    background: -webkit-gradient(linear,left top,right top,from(#fff),to(hsla(0,0%,100%,0)));    background:-webkit-linear-gradient(left,#fff,hsla(0,0%,100%,0));    background: -moz-linear-gradient(left,#fff,hsla(0,0%,100%,0));    background: linear-gradient(90deg,#fff,hsla(0,0%,100%,0));}.my-list:after {    right: 0;    background: -webkit-gradient(linear,right top,left top,from(#fff),to(hsla(0,0%,100%,0)));    background: -webkit-linear-gradient(right,#fff,hsla(0,0%,100%,0));    background: -moz-linear-gradient(right,#fff,hsla(0,0%,100%,0));    background: linear-gradient(270deg,#fff,hsla(0,0%,100%,0));}其中 .my-list:after,.my-list:before 中 width 控制左右半透明的长度根据需求更改如此便通过伪类+渐变实现了左右半透明的滚动列表                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发中 var that =this的用法               小程序canvas开发水果老虎机                                                        原作者: Vien                    来自: VienBlog                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序如何写动态标签 ", "author": "                  Rolan                  2020-2-6 00:14                ", "text": "                                                                                                                                                                                     web开发中尤其使用react开发项目时我们可以很方便的动态定义标签(jsx)const props = {  id: '',  className: '',  data-a: ''}<button {...props} />复制代码动态配置标签的好处一是所有逻辑在JS端控制二是使得我们的模板非常规范方便后续维护更新碎片模板可以很好的控制三是我们可以根据使用场景很方便的配置props的属性这样在html结构输出的时候能够得到比较干净的结构在小程序的开发中却不能实现类似的功能导致我们的动态标签通常非常的冗余多余的属性全部展示在结构生成后以button为例我们知道button在小程序中有非常多的属性如上所示这里只是列举了一部分的属性动态模板我们的button动态模板写下来应该是这样的配置Page({  data: {    option: {      ...    }  }})复制代码<button  size=\"{{option.size || 'default'}}\"  type=\"{{option.type || 'default'}}\"  plain=\"{{option.plain || false}}\"  value=\"{{option.value || '按钮'}}\"  ...  .../>复制代码调试工具的输出结构<button bindtap='' size='' type='' plain='' disabled=false open-typ='' hover-class='' .... />复制代码可以看到调试工具中输出的结构就会变得非常冗余降低了开发效率这种冗余的模板输出搞久了会吐的好吧。可以使用模板语法区分不同场景的button我知道会有很多这样的声音但那不是动态模板。解决问题那要如何解决输出结构不冗余呢说了这么多终于到了重点其实真的只是一个很小的技巧我的开发经历告诉我这是有效的你也可以试试将默认值统统换成 '' 改版后的模板如下<button  size=\"{{option.size || ''}}\"  type=\"{{option.type || ''}}\"  plain=\"{{option.plain || ''}}\"  value=\"{{option.value || '按钮'}}\"  ...  .../>复制代码这时你得到的模板就是一段漂亮的结构<button value='按钮' />复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序的自动化测试框架               微信小程序|实现界面滑动切换                                                        原作者:  天天修改                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "我是怎么在 3 天内开发 AI 微信小程序的 ", "author": "                  Rolan                  2020-2-5 00:32                ", "text": "                                                                                                                                                                                     基于对 AI 的爱好与兴趣我走上了独自钻研机器学习的道路。和所有热爱 AI 的人们一样在一段孤独的摸索旅程中我勉强完成了几次深度学习模型的训练。其中令我印象较深的成果就是情感分类模型。他能够根据你的文字生成其背后作者的喜怒哀乐。深度学习模型展示出来的 \"人性化\"让我感到惊喜于是我开始思考怎么将它的“人性化”转化为帮助人们的工具。在情感模型的基础上建立一个上层应用让它为人类社会中增添不一样的烟火。基于多方面的考量我最终选择开发一款 微信 \"情感\" 小程序。故事拉开序幕在进行小程序开发之前我们非常有必要先对小程序做一个充分的了解。什么是小程序简单来说比起传统的 App微信小程序是一种全新的连接用户与服务的方式它具有非常出色的使用体验并且它可以在微信内被便捷地获取与传播。小程序发展史实际上小程序并非凭空而来的。当微信逐渐流行、变成几乎人人都离不开的社交工具时承载微信的 WebView 也逐渐成为了量级最大的移动 Web 入口。每天访问 WebView 的数量甚至超过了访问所有浏览器的总和。虽然无法通过第三方获取到微信 WebView 的日活数据但这个客观事实间接促进了小程序的诞生。其实在小程序正式步入人们视线之前微信早已有了类似的 js 调用接口这里给大家展示一个调用了微信 js-bridge 原生组件去浏览图片的例子：WeixinJSBridge.invoke('imagePreview', {current: 'http://inews.com',urls: [ // 所有图片的URL列表数组格式    'https://img/1.jpg',    'https://img/2.jpg',    'https://img/3.jpg']}, function(res) {    console.log(res.err_msg)})复制代码此类 js 接口其实最开始是专门给腾讯内部人员去进行调用的但却意外被许多个人开发者发现很多并进行了使用这也慢慢成为了微信中网页的标准。在 15 年开始的时候微信官方发布了一套专门用于进行网页开发的工具包名为 js-sdk 在这个工具包内开放了如微信支付、录音、语音识别、等数十个接口。这给所有的 Web 开发者都打开了一扇从未开启过的全新的大门让所有的开发者都可以自由地使用微信开发的原生能力这使得他们可以去完成一些之前无法完成或是难以做到的事情。js-sdk 完美继承了 WeixinJSBridge 的特性并且由只对内部开放转为了对外部开放。并且它通过其暴露的微信调用接口使得所有 Web 开发者有了更多操作微信功能的能力。但是这个模式并没有很好地解决移动网页的体验问题：用户访问页面时在页面显示前会有一段比较明显能够被感知的白屏过程。受限于网速与不同终端的性能这个问题会越来越明显。于是乎js-sdk 的增强版本就诞生了其中有一个非常重要的新特性被称之为： 微信 Web 资源离线存储 。​以下文字引用自内部的文档（没有最终对外开放）：微信 Web 资源离线存储是面向 Web 开发者提供的基于微信内的 Web 加速方案。通过使用微信离线存储Web 开发者可借助微信提供的资源存储能力直接从微信本地加载 Web 资源而不需要再从服务端拉取从而减少网页加载时间为微信用户提供更优质的网页浏览体验。每个公众号下所有 Web App 累计最多可缓存 5M 的资源。相信大家都已经看明白了这其实就是 HTML5 中 Application Cache 的加强版。然而在经过了多次测试后发现还有问题没有被完全的解决：页面切换较为生硬；点击有明显延滞的感觉。最终微信意识到 js-sdk 无法处理这些问题这需要一个全新的系统去完成而这个系统必须具备以下几个能力：加载速度快原生的体验易用且安全的微信数据开放兼顾开发效率与开发难度而这就是小程序的由来。故事开始了前言首先请大家见谅这一篇文章并不会教你如何零基础开发小程序。如果你是一个软件开发新手。那么我建议你先了解一些基础的 js 语法 以及相应的 前端知识 。掌握前端基础后相信在 小程序前端组件官方文档 的帮助下任何人都可以快速上手开发小程序。下面我主要跟大家分享两个最核心、 最省钱 的两个小程序开发技巧：搭建小程序云开发环境；如何使用云开发调用 AI 模型接口。小程序云开发在刚开始考虑开发小程序时和你们一样我有着许多的顾虑：需要购买域名、服务器吗？维护成本大吗？带着这些顾虑我小心翼翼地翻开了 微信官方文档 。在大脑经过分布式阅读过后我发现了 云开发 这个关键词。什么是云开发？微信官方文档中是这么解释的：开发者可以使用云开发开发微信小程序、小游戏无需搭建服务器即可使用云端能力。云开发为开发者提供完整的原生云端支持和微信服务支持弱化后端和运维概念无需搭建服务器使用平台提供的 API 进行核心业务开发即可实现快速上线和迭代同时这一能力同开发者已经使用的云服务相互兼容并不互斥。云开发提供了几大基础能力支持：简单来说有了云开发 我不需要购买服务器就可以开发一款全栈小程序。嘿嘿没错这就是我想要的。如何搭建小程序云开发环境那么如何搭建云开发环境呢综合官方文档我总结了一套极简搭建教程大家可以作为参考。云开发环境极简搭建四部曲：首先需要 注册一个小程序账号 添加管理员 / 开发者微信账号并记录下 APPID；接着需要下载 小程序开发工具 ；然后使用管理员 / 开发者账号登录开发工具并填入小程序的 APPID 以及勾选 云开发 选项后点击新建；点击页面中的云开发跟着提示选择 免费版云开发配额 。至此一个云环境就算是搭建完毕了。什么是云函数？云开发环境搭建完毕后是时候看看什么是 云函数 了。官方的定义如下：云函数是一段运行在云端的代码无需管理服务器在开发工具内编写、一键上传部署即可运行后端代码。简单来说云函数就是运行在云端的函数。云函数有什么用？云函数大有用处。有了它就相当于是有了一个 \"大后端\"所有业务逻辑以及对数据库的操作我们都可以封装在云函数中调用十分方便。第一个云函数说了这么多大道理是时候来实战一下了。右键点击云函数环境 （cloudfunctions | xxxxxxx）后新建一个名为 test 的云函数：可以看到默认的文件（index.js）中已经有了云函数代码（获取当前微信用户上下文并返回用户信息）：// 云函数入口文件const cloud = require('wx-server-sdk')cloud.init()// 云函数入口函数exports.main = async (event, context) => {\tconst wxContext = cloud.getWXContext()\treturn {\t\tevent,\t\t\t\topenid: wxContext.OPENID,\t\t\t\tappid: wxContext.APPID,\t\t\t\tunionid: wxContext.UNIONID,\t\t}}复制代码这时候需要开启命令行并进入到该目录下运行 npm install 安装 wx-server-sdk ( 若目录下没有 node_modules 则需要先运行 npm init )：最后右键点击该云函数并选择 开启云函数本地调试 后点击右下角调用：可以看到函数执行成功并拿到了返回值（openid 等信息......）至此恭喜我们快速完成了第一个云函数。如何在小程序中快速调用 AI 模型来自清晨的灵光一闪相信大家都非常好奇我是怎么做到在云函数中 \"零成本\" 调用 AI 能力的。其实我开始也非常苦恼这个问题即使小程序有云函数的功能但也没办法轻易 \"零成本\" 调用 AI 模型原因如下：小程序云函数目前仅支持 node.js而我的模型调用接口代码为 python；不管再怎么 \"云\"想要运行自己的 AI 模型必须得有一台 16G 内存以上的机器（成本巨大）；即使有了自己的服务器也需要域名备案实在是太麻烦了；但就在一个明媚的清晨我翻身起床后突然灵光一闪：可不可以调用腾讯自己的 AI 开放接口间接达到这个目的呢？想法再多不如动手行动于是我访问了 腾讯云控制台的自然语言处理模块 。根据指引进行服务开通后我进入到 API 密钥管理 并记录下了 API 密钥：那么如何在小程序中调用它呢？我再一次陷入了深深的沉思......云函数调用 AI 模型在经过漫长的探索后我回到了 test 云函数目录下的命令行安装了腾讯云服务调用包：npm install tencentcloud-sdk-nodejs复制代码然后修改 test 云函数 （index.js）：// 云函数入口文件const cloud = require('wx-server-sdk')const tencentcloud = require(\"tencentcloud-sdk-nodejs\");cloud.init()// 云函数入口函数exports.main = async (event, context) => {\tconst  NlpClient = tencentcloud.nlp.v20190408.Client;\t\tconst models = tencentcloud.nlp.v20190408.Models;\t\tconst  Credential = tencentcloud.common.Credential;\t\tconst  ClientProfile = tencentcloud.common.ClientProfile;\t\tconst  HttpProfile = tencentcloud.common.HttpProfile;\t\tlet cred = new  Credential(event.secretId, event.secretKey);\t\tlet httpProfile = new  HttpProfile();\t\thttpProfile.endpoint = \"nlp.tencentcloudapi.com\";\t\tlet clientProfile = new  ClientProfile();\t\tclientProfile.httpProfile = httpProfile;\t\tlet client = new  NlpClient(cred, \"ap-guangzhou\", clientProfile);\t\tlet req = new models.SentimentAnalysisRequest();\t\tlet text = event.text\t\tlet params = '{\"Text\":\\\"' + text + '\\\"}'\t\tconsole.log('待预测字符串： ' + text)\t\treq.from_json_string(params);\t\tclient.SentimentAnalysis(req, function (errMsg, response) {\t\t\tif (errMsg) {\t\t\t\tconsole.log(errMsg)\t\t\t\t}\t\t\t\tconsole.log('AI 预测情绪正值: ' + response.Positive)\t\t\t\tconsole.log('AI 预测情绪负值: ' + response.Negative)\t\t\t})}复制代码在这段代码中我通过腾讯云账号中的密钥连通了 AI 情感预测接口最后将情感预测的结果打印了出来。接下来我开启了本地云函数调用窗口并传入相应参数：secretId （腾讯云 API 服务密钥 Id ）secretKey （腾讯云 API 服务密钥 Key）text （待预测的字符串）然后点击调用后终于看到了 AI 模型的预测结果：最后我成功地使用云函数调用了免费的 AI 开放接口。这时我已经热泪盈眶除了感动还有一丝小满意原来云开发还能这么玩。故事的结尾文章到这里相信最重要的两个部分大家已经了解并掌握了：搭建云开发环境快速调用 AI 模型回头望去整个小程序开发过程大概历经三天两夜整段经历大概与 \"编程马拉松\" 类似。编程马拉松又称黑客日、黑客节或编程节是一个流传于黑客当中的新词汇。编程马拉松是一种活动。在该活动当中计算机程序员以及其他与软件发展相关的人员如图形设计师、界面设计师与项目经理相聚在一起以紧密合作的形式去进行某项软件项目。编程马拉松的灵魂是合作地编写程序和应用。编程马拉松的时长一般在几天到一周不等 。--维基百科于是乎在经过 \"疯狂\" 开发后一个日记小程序的雏形就诞生了。虽然说前端页面并没有多复杂但是确实倾注了许多开发心血。开发完成的那一刻我已经不在乎是否有人真正去使用他。因为我已经从他身上收获到了全身心投入开发的快乐。最后老铁要不点个赞再走可好？么么哒1、给俺点个赞呗可以让更多的人看到这篇文章顺便激励下我嘻嘻。2、老铁们关注我的原创微信公众号「智能测试开发」专注于写 AI 与测试开发的结合（AI + 测试 + 开发）。保证让你看完有所收获不信你打我。后台回复『进阶教程』免费送你一套关于测试与开发的进阶教程。作者简介作者：大家好我是泰斯特从测试入门再转战开发最后学习 AI。深知 AI 对测试与开发的影响力。所以申请了一个微信公众号『智能测试开发』泰斯特期待你的关注和我一起学习。 转载说明：未获得授权禁止转载最后预祝所有用心实践的读者都能开发出有特色的 AI 小程序~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序加入购物车动画的实现（向上、向下）               微信小程序的自动化测试框架                                                        原作者: 泰斯特                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序的自动化测试框架 ", "author": "                  Rolan                  2020-2-5 00:52                ", "text": "                                                                                                                                                                                     微信发布了小程序的自动化测试框架Minium提供了多种运行验证方式其特点：支持一套脚本iOS & Android & 模拟器三端运行提供丰富的页面跳转方式看不到也能去得到可以获取和设置小程序页面数据让测试不止点点点可以直接触发小程序元素绑定事件支持往 AppSerive 注入代码片段可以调用部分 wx 对象上的接口官方地址如下： https://git.weixin.qq.com/min...minium 是为小程序专门开发的自动化框架, 提供了 Python 和 JavaScript 版本。使用 minium 可以进行小程序 UI 自动化测试, 但是 minium 的功能不止于仅仅是 UI 自动化, 甚至可以使用 minium 来进行函数的 mock, 可以直接跳转到小程序某个页面并设置页面数据, 做针对性的全面测试, 这些都得益于我们开放了部分小程序 API 的能力。除此之外小程序有部分组件使用了系统原生的组件对于这部分的组件我们也基于 uiautomator 和 wda 做了补充。环境依赖Python 3.x微信公共库版本 >= 2.7.3下载并安装稳定版微信开发者工具工具下载地址： https://developers.weixin.qq....如果要测Android请下载微信测试包下载地址： http://dldir1.qq.com/weixin/a...文档使用Minium的文档是采用Nodejs编写的因此想看文档还需要安装NodeJs的环境如果你不知道怎么安装请自行查找。文档的安装：npm i docsify-cli -g然后checkout文档项目：git clone https://git.weixin.qq.com/minitest/minium-doc安装依赖：cd minium-docnpm install本地部署：docsify serve .然后通过浏览器访问 http://localhost :3000 即可以查看了。框架依赖运行环境部署首先你要先下载框架压缩包： https://git.weixin.qq.com/min...接下来你要打开微信开发者工具的安全模式然后安装Minium:pip3 install minium-0.0.2.zip使用首先你要通过命令行启动开发者工具提供了命令行命令行通过命令行调用安装完成的工具可执行文件完成登录、预览、上传、自动化测试等操作。调用返回码为 0 时代表正常为 -1 时错误。命令行工具所在位置：macOS: <安装路径>/Contents/MacOS/cli   Windows: <安装路径>/cli.bat命令行启动工具-o, --open [projectpath]: 打开工具如果不带 projectpath只是打开工具。如果带 project path则打开路径中的项目每次执行都会自动编译刷新并且自动打开模拟器和调试器。projectpath 不能是相对路径。项目路径中必须含正确格式的 project.config.json 且其中有 appid 和 projectname 字段。示例：# 打开工具cli -o# 打开路径 /Users/username/demo 下的项目cli -o /Users/username/demo输入如下命令：path/to/cli --auto /miniprogram/project/path --auto-port 9420# path/to/cli 是命令行工具所在位置：# macOS: <安装路径>/Contents/MacOS/cli# Windows: <安装路径>/cli.bat windows版本在安装之后默认会把cli加入到系统路径可以先测试cli命令是否可用如果可用path/to/cli可以直接用cli替换# /miniprogram/project/path 是小程序工程的路径( Windows下面用 \\\\ 代替 \\ )特别说明：1、这里的--auto-port请填写 9420不是开发者工具安全模式的端口2、请确保开发者工具登陆的微信号具备被测小程序的开发者权限3、如果没有Open project with automation enabled success的输出否则请检查IDE版本（开发者工具调试基础库版本 >= 2.7.3）或者检查命令行参数关注我关注测试                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    我是怎么在 3 天内开发 AI 微信小程序的               小程序如何写动态标签                                                        原作者:  测者陈磊                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "迷你PS小程序-集成的开放式画报、油墨电子签名、图片拖拽可单独食用 ... ", "author": "                  Rolan                  2020-1-13 00:58                ", "text": "                                                                                                                                                                                     米娜桑哦哈哟~个人制作该文章主要讲解最近基于 uni-app 框架编写的集图文拖拽等多方位编辑、油墨电子签名、开放式海报于一体的小程序的制作思路和实现代码。目录1、完整源码链接2、实现思路3、核心代码3-1、图文多方位编辑3-2、油墨电子签名3-3、开放式海报3-4、小结4.效果展示和体验1、完整源码链接：完整代码：https://github.com/TensionMax/mini-ps其中演示的文字编辑、图片编辑、油墨电子签名、开放式海报可单独食用含文档说明。2、实现思路该工具主要由五个不同组件模块：文字编辑、图片编辑油墨电子签名、控制、开放式海报1、文字编辑模块设置好的文字参数对象插入到文字队列中。2、图片编辑模块设置好的图片参数对象插入到图片队列中。3、油墨电子签名模块完成绘制后转为利用 canvasToTempFilePath 转成临时图片获取参数后插入图片队列中也可以直接导出。4、利用控制模块调整/文字队列和图片队列的参数。5、开放式海报模块利用控制台的参数将PS画板上的效果绘制到canvas上来实现的效果接着再利用 canvasToTempFilePath 转成图片导出。3、核心代码3-1、文字/图片编辑模块文字/图片编辑模块主要是实现移动/缩放功能其他附带的属于甜品由于两个模块功能类似该篇仅讲解图片编辑模块。HTML<img style=\"position: absolute\" :style=\"{     left: item.x+'px',      top: item.y+'px',     width: item.w+'px',     height: item.h+'px',     }\"  @touchstart='touchStart($event,item,index)'   @longpress='longPress($event,item,index)'  @touchmove.stop='touchMove($event,item,index)'   @touchcancel=\"touchEnd($event,item,index)\"   @touchend='touchEnd($event,item,index)'  v-for=\"(item,index) of imagelist\"  :key=\"index\"   :src=\"item.src\"  />在 imageList 的数组标签中每个绑定的事件中用 $event 来调用事件本身的参数其中 $event 的 touches 或 changedTouches 包含我们需要的位置参数示例如下：touches:[{        clientX: 14 //与显示区域(不含顶部栏)左上角的水平距离        clientY: 16 //与显示区域(不含顶部栏)左上角的垂直距离        pageX: 14 //与整个页面(不含顶部栏)左上角的水平距离        pageY: 16 //与整个页面(不含顶部栏)左上角的垂直距离        },        {        clientX: 14        clientY: 16        pageX: 14        pageY: 16        }]touches 长度为2代表双指触碰通过判定双指触摸点的变化方向可实现双指缩放效果。因为每个标签都设置为 style=\"position: absolute\" 所以只需要根据位置参数来更新 x、y、w、h 即可题外话-性能问题一次移动多次操作DOM影响性能—— 虚拟DOM了解一下为何不用事件委派—— 不必要Vue已经帮我们做了优化在非常影响性能时再考虑图片编辑Demo3-2、油墨电子签名板由于 touchmove 事件在小程序真机的触发频率和精确度很迷不太好根据速度来判定绘制的线宽我只好用其他方式去实现虽然效果不完美。其实现思路是通过多次的循环绘制以达到油墨效果每次循环绘制的长度和宽度都不相同。HTML<canvas canvas-id=\"canvas\" @touchstart.stop=\"touchStart\" @touchmove.stop=\"touchMove\"@touchend.stop=\"touchEnd\"></canvas>JAVASCRIPTexport default {data() {    return {        lineWidth0: 5, //初始线宽 建议1~5        ctx: null,        x0: 0, //初始横坐标或上一段touchmove事件中触摸点的横坐标        y0: 0, //初始纵坐标或上一段touchmove事件中触摸点的纵坐标        t0: 0, //初始时间或上一段touchmove事件发生时间        v0: 0, //初始速率或touchmove事件间发生速率        lineWidth: 0, //动态线宽        keenness: 5, //油墨程度 建议0~5        k: 0.3, //油墨因子即每次绘制线条时线宽的变化程度    }},onReady() {    this.ctx = uni.createCanvasContext('canvas', this);    this.ctx.setLineCap('round')},methods: {    //设置初始值    touchStart(e) {        this.lineWidth = this.lineWidth0        this.t0 = new Date().getTime()        this.v0 = 0        this.x0 = e.touches[0].clientX        this.y0 = e.touches[0].clientY    },    touchMove(e) {        let dx = e.touches[0].clientX - this.x0,            dy = e.touches[0].clientY - this.y0,            ds = Math.pow(dx * dx + dy * dy, 0.5),            dt = (new Date().getTime()) - this.t0,            v1 = ds / dt; //同 this.v0 初始速率或touchmove事件间发生速率        if (this.keenness === 0) { //油墨为0时            this.ctx.moveTo(this.x0, this.y0)            this.ctx.lineTo(this.x0 + dx, this.y0 + dy)            this.ctx.setLineWidth(this.lineWidth)            this.ctx.stroke()            this.ctx.draw(true)        } else {            //由于touchMove的触发频率问题这里采用for循环绘制原理如图所示            //这里的k因为            let a = this.keenness            if (this.keenness > 5) {                a = 5            }            for (let i = 0; i < a; i++) {                this.ctx.moveTo(this.x0 + dx * i / a, this.y0 + dy * i / a)                this.ctx.lineTo(this.x0 + dx * (i + 1) / a, this.y0 + dy * (i + 1) / a)                //此时touchmove事件间发生与上一个事件的发生的速率比较                if (v1 < this.v0) {                    this.lineWidth -= this.k                    if (this.lineWidth < this.lineWidth * 0.25) this.lineWidth = this.lineWidth * 0.25                } else {                    this.lineWidth += this.k                    if (this.lineWidth > this.lineWidth * 1.5) this.lineWidth = this.lineWidth * 1.5                }                this.ctx.setLineWidth(this.lineWidth)                this.ctx.stroke()                this.ctx.draw(true)            }        }        this.x0 = e.touches[0].clientX        this.y0 = e.touches[0].clientY        this.t0 = new Date().getTime()        this.v0 = v1    },    touchEnd(e) {        this.x0 = 0        this.y0 = 0        this.t0 = 0        this.v0 = 0    }}}使用的大部分是canvas的基础api注意绘制单位都为px。油墨电子签名Demo3-3、开放式海报模块如果说微信小程序是银色金滩那么截至2020年1月6日或者未来小程序的canvas就是金滩上充斥着未知数个的玻璃块的那一片 ——鲁迅说起小程序canvas那bug不是一般的多部分不常见bug我会在代码注释里说明。HTML<canvas canvas-id=\"generate\" :style=\"{ width: canvasW + 'rpx', height: canvasH + 'rpx'}\"></canvas>相关介绍spread 语法async 函数如果图片是网络路径记得获取临时路径。//别忘了在函数前加 asynclet src = 'https://s2.ax1x.com/2020/01/05/lrCDx0.jpg'src = (await uni.getImageInfo({src}))[1].path;JAVASCRIPT输出字段部分//为方便设置以下除角度外单位均以rpx为主data() {    return {        canvasW:720,        canvasH:1000,        img:[{            src: 'https://s2.ax1x.com/2020/01/05/lrCDx0.jpg',            x: 0,            y: 0,            w: 100,            h: 100,            r: 50,//圆角度            degrees: 30,//旋转度            mirror: true//是否镜像            }],        text:[{                content: 'TensionMax',                x: 50,                y: 50,                w: 100,                lineHeight: 35,//行间距                color: '#000000',                size: 28,                weight: 'normal',//字体粗细                lineThrough: true,//是否贯穿            }],        ctx: null,        k: null //单位转换因子    };}JAVASCRIPTrpx 或 upx与 px 的单位统一转换方法px2rpx() {    //当转换的参数只有一个时直接返回数值如    //当不为一个时返回数组然后用spread语法将其展开为几个参数    //Math.floor()是为了防止在安卓机上造成的数据紊乱开发者工具无此bug    if (arguments.length === 1) return Math.floor(arguments[0] / this.k)    let params = []    for (let i of arguments) {        params.push(Math.floor(i / this.k))    }    return params},rpx2px() {    if (arguments.length === 1) return Math.floor(arguments[0] * this.k)    let params = []    for (let i of arguments) {        params.push(Math.floor(i * this.k))    }    return params},JAVASCRIPT绘制图片的函数async drawImg() {this.ctx.setFillStyle('#FFFFFF')this.ctx.fillRect(0, 0, ...this.rpx2px(this.canvasW, this.canvasH)) //绘制背景for (let i of this.img) { //for循环绘制图片    i.src = (await uni.getImageInfo({src: i.src}))[1].path;//获取图片临时路径    this.ctx.save() //保存当前绘制内容    if (i.mirror) { //如果设置镜像        //因为canvas的translate属性是基于原点（初始原点为右上角）变化        //所以需要先将原点移动至图片中心变化后再还原        //旋转变化同理        this.ctx.translate(...this.rpx2px(i.x + i.w / 2, i.y + i.h / 2))        this.ctx.scale(-1, 1)        this.ctx.translate(...this.rpx2px(-i.x - i.w / 2, -i.y - i.h / 2))    }    if (i.degrees) { //如果设置旋转        this.ctx.translate(...this.rpx2px(i.x + i.w / 2, i.y + i.h / 2))        this.ctx.rotate(i.degrees * Math.PI / 180)        this.ctx.translate(...this.rpx2px(-i.x - i.w / 2, -i.y - i.h / 2))    }    this.radiusRect(...this.rpx2px(i.x, i.y, i.w, i.h, i.r)) //圆角或矩形路径绘制    this.ctx.clip() //裁剪    this.ctx.drawImage(i.src, ...this.rpx2px(i.x, i.y, i.w, i.h))    this.ctx.restore() //恢复非裁剪区域}this.ctx.draw(true) }radiusRect(x, y, w, h, r) {    if (r > w / 2 || r > h / 2) {        r = Math.min(w, h) / 2    }    this.ctx.beginPath();    this.ctx.moveTo(x, y); // 将操作点移至左上角    this.ctx.arcTo(x + w, y, x + w, y + r, r); // 画右上角的弧    this.ctx.lineTo(x + w, y) //可省略但由于安卓真机的小程序bug留之下同。    this.ctx.arcTo(x + w, y + h, x + w - r, y + h, r); // 画右下角的弧    this.ctx.lineTo(x + w, y + h) //可省略    this.ctx.arcTo(x, y + h, x, y + h - r, r); // 画左下角的弧    this.ctx.lineTo(x, y + h) //可省略    this.ctx.arcTo(x, y, x + r, y, r); // 画左上角的弧    this.ctx.lineTo(x, y) //可省略},绘制自定义文字文字绘制稍微麻烦些主要是canvas不会自动帮我们换行排版网上类似的实现方法太多该篇就不讲直接放在Demo里面。开放式海报Demo3-4、小结既然我们知道了这几个组件自定义调整参数的方式那么最后只需要一个父组件作为控制台来调整他们的参数即可可以通过 props 、 sync 修饰符 等来实现父子通信当然如果想做更复杂的可以考虑用 Vuex 传参。接下来就可以根据这思路来实现繁琐的业务逻辑了。4、效果展示效果图如下如果由什么疑问欢迎到下方评论区讨论。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    京东购物小程序cookie方案实践               小程序登录的最优流程                                                        原作者: TensionMax                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序加入购物车动画的实现（向上、向下） ", "author": "                  Rolan                  2020-1-14 00:42                ", "text": "                                                                                                                                                                                     场景描述：一般情况下加入购物车的动画效果都会是上图的3的路线在这篇文章里我们来实现1和2路线的加入购物车的动效（3路线的动画效果网上有很多具体可以参考这篇文章来实现： www.cnblogs.com/greengage/p… ）。实现方式：不管是上图中的哪一种效果我们都是用CSS3里的cubic-bezier（三次贝塞尔曲线）来实现的。具体什么是三次贝塞尔曲线可以参考这篇文章： www.bbsmax.com/A/RnJWwpbRJ…#实现流程：1、获取屏幕的高度大小wx.getSystemInfo({//  获取页面的有关信息      success: function (res) {        wx.setStorageSync('systemInfo', res)        var ww = res.windowWidth;        var hh = res.windowHeight;        that.globalData.ww = ww;        that.globalData.hh = hh;      }    });复制代码2、获取点击的位置（购物车的位置我们定为最上方或者最下方）定义移动距离/*加入购物车动效*/  _flyToCartEffect: function (events) {    //获得当前点击的位置距离可视区域左上角    var touches = events.touches[0];    var diff = {      x: '25px',      y: app.globalData.hh -touches.clientY-40 + 'px'//向下      // y: 25- touches.clientY  + 'px'//向上    },      style = 'display: block;-webkit-transform:translate(' + diff.x + ',' + diff.y + ') rotate(350deg) scale(0)';  //移动距离    this.setData({      isFly: true,      translateStyle: style    });    var that = this;    setTimeout(() => {      that.setData({        isFly: false,        translateStyle: '-webkit-transform: none;',  //恢复到最初状态        isShake: true,      });      setTimeout(() => {        var counts = that.data.cartTotalCounts + that.data.productCounts;        that.setData({          isShake: false,          cartTotalCounts: counts        });      }, 200);    }, 1000);  },复制代码3、在css里调用beizer函数.fiexd-cart.animate{  animation: aCartScale 200ms cubic-bezier(.17,.67,.83,.67);  animation-fill-mode: backwards;}复制代码aCartScale是在曲线的最后实现了个购物车抖动的动画@-webkit-keyframes aCartScale{  0%{    -webkit-transform: scale(1.1);  }  100% {    -webkit-transform: scale(1);  }}复制代码至此流程全部介绍完毕下面是全部的代码（里面可能有一些没用的css样式代码读者可以自行根据需要删除）：js代码：var app = getApp();Page({  /**   * 页面的初始数据   */  data: {    isFly:false  },  /*添加到购物车*/  onAddingToCartTap: function (events) {    //防止快速点击    if (this.data.isFly) {      return;    }    this._flyToCartEffect(events);  },  /*加入购物车动效*/  _flyToCartEffect: function (events) {    //获得当前点击的位置距离可视区域左上角    var touches = events.touches[0];    var diff = {      x: '25px',      y: app.globalData.hh -touches.clientY-40 + 'px'//向下      // y: 25- touches.clientY  + 'px'//向上    },      style = 'display: block;-webkit-transform:translate(' + diff.x + ',' + diff.y + ') rotate(350deg) scale(0)';  //移动距离    this.setData({      isFly: true,      translateStyle: style    });    var that = this;    setTimeout(() => {      that.setData({        isFly: false,        translateStyle: '-webkit-transform: none;',  //恢复到最初状态        isShake: true,      });      setTimeout(() => {        var counts = that.data.cartTotalCounts + that.data.productCounts;        that.setData({          isShake: false,          cartTotalCounts: counts        });      }, 200);    }, 1000);  },})复制代码wxml代码：<view class=\"container detail-container\">  <view class=\"fixed-btns-box\" bindtap=\"onCartTap\">    <view class=\"fiexd-cart {{isShake?'animate':''}}\">      <image src=\"../../imgs/icon/cart@top.png\"></image>      <view wx:if=\"{{cartTotalCounts>0}}\">{{cartTotalCounts}}</view>    </view>  </view>  <view   style=\"position: fixed;right: 50rpx;bottom:100rpx;width: 100rpx;\"  class=\"add-cart-btn {{product.stock==0?'disabled':''}}\" bindtap=\"onAddingToCartTap\">    <text style=\"width: 360rpx\">加入分享</text>    <image class=\"cart-icon\" src=\"../../imgs/icon/cart.png\"></image>    <image id=\"small-top-img\" class=\"small-top-img {{isFly?'animate':''}}\" src=\"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1575871576&di=dda9d07660c88bea6553c3279b0a8cf0&imgtype=jpg&er=1&src=http%3A%2F%2Fpic.pc6.com%2Fup%2F2011-9%2F2011926155953.jpg\"      mode=\"aspectFill\" style=\"{{translateStyle}}\"></image>  </view>    <view class=\"fixed-btns-box2\" bindtap=\"onCartTap\">    <view class=\"fiexd-cart {{isShake?'animate':''}}\">      <image src=\"../../imgs/icon/cart@top.png\"></image>      <view wx:if=\"{{cartTotalCounts>0}}\">{{cartTotalCounts}}</view>    </view>  </view></view>复制代码wxss代码：.detail-container {  background-color:#F9F9F9}.detail-header-box,.detail-bottom-box{  background-color: #fff;}.detail-topic-img{  display: flex;  justify-content: center;}.detail-topic-img image{  width: 100%;}.fixed-btns-box{  position: fixed;  top:50rpx;  right:12px;  width: 80rpx;}.fixed-btns-box2{  position: fixed;  right:12px;  width: 80rpx;  bottom: 50rpx;}.fiexd-cart image{  height: 64rpx;  width: 64rpx;}.fiexd-cart view{  font-size: 24rpx;  background-color: #AB956D;  color: white;  position: absolute;  right: 64rpx;  top: 0rpx;  height: 36rpx;  width: 36rpx;  line-height: 36rpx;  border-radius: 36rpx;  text-align: center;}.fiexd-cart.animate{  animation: aCartScale 200ms cubic-bezier(.17,.67,.83,.67);  animation-fill-mode: backwards;}@-webkit-keyframes aCartScale{  0%{    -webkit-transform: scale(1.1);  }  100% {    -webkit-transform: scale(1);  }}.product-counts,.add-cart-btn{  height: 100%;  display: flex;  font-size: 24rpx;  align-items: center;  justify-content: center;}.product-counts{  width: 50%;}.add-cart-btn{  position: relative;  flex: 1;}.add-cart-btn:active{  color: #fff;}.add-cart-btn.disabled{  color: #D5D5DB;}.small-top-img{  height: 160rpx;  width: 160rpx;  right:6rpx;  position: absolute;  opacity: 0;}.small-top-img.animate{  opacity: 1;  -webkit-transition:all 1000ms cubic-bezier(0.175, 0.885, 0.32, 1.275);}.add-cart-btn .cart-icon{  margin-left: 40rpx;  height: 32rpx;  width: 32rpx;}.disabled{    pointer-events: none;}复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从客户端角度窥探小程序架构               我是怎么在 3 天内开发 AI 微信小程序的                                                        原作者:  _小三爷                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序--滑动右侧字母索引 ", "author": "                  Rolan                  2020-2-6 00:50                ", "text": "                                                                                                                                                                                     微信和通讯录经常看到这种那么在小程序如何实现呢（等下我们需要用到小程序的一个官方组件）这个功能可以拆分两块一个是滚动区域一个是滑动定位区域。实现滚动区域小程序里面实现滚动到指定位置可以用 scroll-view 组件. （点击我即可查看小程序文档）<scroll-view class=\"goup_list\" scroll-with-animation=\"true\" scroll-y=\"true\" style=\"height: 300rpx;\" scroll-into-view=\"{{toView}}\">    <具体业务界面代码 /></scroll-view>复制代码最后面是我刚刚录gif的代码。可以看到 scroll-view 组件有一个属性 scroll-into-view ,这个属性可以实现转跳到指定位置。值是id也就是Gif看到的 B、C、D的ID。（最后会有完整代码）滑动实现滑动我们会想到 touchmove 事件我们需要依靠这个判断滑动到了哪个索引（字母）。但是滑动里面没有直接告诉你是哪个组件所以我们需要根据现有的信息进行利用这里用的是y,x的信息。拿到x,y之后的逻辑如下用文字不好描述清楚看下面图可以这样求偏差值然后除以每项的高度就拿到了滑动到了第几项。 这里又涉及一个问题就是怎么求单个项的高度。 height / 个数。代码var y = e.touches[0].pageY;    var itemLen = this.data.list.length    var height = letterDomRes.height    var top = letterDomRes.top    // 滑动的偏移量（偏差值）    var offsetTop = (height + top - y)    var itemHeight = height / itemLen    var index = itemLen - ((offsetTop / itemHeight)|0) - 1    if(index < 0 || index >= itemLen){      return    }复制代码还有就是上面数据从哪里来也就是小程序如何拿下图中的top值和height。代码//创建节点选择器var query = wx.createSelectorQuery()query.select('.letter-index').boundingClientRect()query.exec(function (res) {      letterDomRes = res[0]      console.log(letterDomRes);})复制代码letterDomRes.height letterDomRes.top 就是我们需要的数据了。到这里就都完成了。然后加一个优化超出滑动范围就return上面代码也有了然后设置的时候判断是否在滑动期间是的话过滤相同的设置。完整代码JS// pages/word/strange.jsvar letterDomRes = {}var moveing_word = ''Page({  /**   * 页面的初始数据   */  data: {    toView: '',    list: [      {        word: 'B',        children: [          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},        ]      },      {        word: 'C',        children: [          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},        ]      },      {        word: 'D',        children: [          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},          {word: 'Ban', translation: 'vt. 禁止查禁；n. 禁止禁令'},        ]      },    ]  },  // ---- methods  letterTap(e){    var id = e.target.id    // console.log(id)    this.setListSite(id)  },  letterMove(e){    var y = e.touches[0].pageY;    var itemLen = this.data.list.length    var height = letterDomRes.height    var top = letterDomRes.top    // 滑动的偏移量（偏差值）    var offsetTop = (height + top - y)    var itemHeight = height / itemLen    var index = itemLen - ((offsetTop / itemHeight)|0) - 1    if(index < 0 || index >= itemLen){      return    }    var letter = this.data.list[index].word    // console.log(index, letter)    // [优化] 过滤相同的    if(moveing_word == letter){      return    }    moveing_word = letter    this.setListSite('word_' + letter)    // console.log(height / this.data.list.length)    //  / this.data.list.length    // console.log(letterDomRes.top)  },  letterEnd(e){    // 重置    moveing_word = ''  },  /**   * 设置滚动位置   * @param {String} id 前缀 + 字母   */  setListSite(id){    wx.showToast({      title: id.split('_')[1],      icon: 'none',    })    this.setData({      toView: id,      duration: 500,    })  },  /**   * 生命周期函数--监听页面加载   */  onLoad: function (options) {  },  /**   * 生命周期函数--监听页面初次渲染完成   */  onReady: function () {    //onshow中获取索引条高度    var query = wx.createSelectorQuery();//创建节点选择器    query.select('.letter-index').boundingClientRect()    query.exec(function (res) {      //res就是 所有标签为mjltest的元素的信息 的数组      letterDomRes = res[0]      console.log(letterDomRes);      //取高度      console.log(\"height : \"+res[0].height);    })  },  /**   * 生命周期函数--监听页面显示   */  onShow: function () {  },  /**   * 生命周期函数--监听页面隐藏   */  onHide: function () {  },  /**   * 生命周期函数--监听页面卸载   */  onUnload: function () {  },  /**   * 页面相关事件处理函数--监听用户下拉动作   */  onPullDownRefresh: function () {  },  /**   * 页面上拉触底事件的处理函数   */  onReachBottom: function () {  },})复制代码WXML<!--pages/word/strange.wxml--><view class=\"container\">    <scroll-view class=\"goup_list\" scroll-with-animation=\"true\" scroll-y=\"true\" style=\"height: 300rpx;\" scroll-into-view=\"{{toView}}\">        <view class=\"\">            <view class=\"group_item\" wx:for=\"{{list}}\" wx:key=\"{{index}}\">                <view class=\"group\">                    <view class=\"title\" id=\"word_{{item.word}}\">{{item.word}}</view>                    <view class=\"word_list\">                        <view class=\"word_list_item\" wx:for=\"{{item.children}}\" wx:key=\"{{index}}\">                            <view class=\"e\">                                <view>{{item.word}}</view>                                <view class=\"\">{{item.translation}}</view>                            </view>                            <image mode=\"widthFix\" src=\"/image/right.png\" class=\"right-image\" />                        </view>                    </view>                </view>            </view>        </view>    </scroll-view>    <view class=\"letter-index\" bind:touchmove=\"letterMove\" bindtap=\"letterTap\" bind:touchend=\"letterEnd\">        <view class=\"item\" id=\"word_{{item.word}}\" wx:for=\"{{list}}\" wx:key=\"index\">{{item.word}}</view>    </view></view>复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序|实现界面滑动切换               微信小程序开发中 var that =this的用法                                                        原作者:  秀岳_知行合一的小猫咪                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序canvas开发水果老虎机 ", "author": "                  Rolan                  2020-2-8 00:53                ", "text": "                                                                                                                                                                                     在这个超长假期中无聊。。。所以动手做一个早就计划要做的小玩意 水果老虎机 嗯这是一个小程序而不是小游戏...使用结构还是canvas？使用模板结构(view)生成水果盘的好处一是用户可自定义产出 n x n 的定制化老虎机二是容易通过算法样式生成布局三是通过 wx.selectQueryAll 的方法能够很方便的抓到定位数据。但问题是动画性能过于孱弱如图构建一个 7x7 的水果盘动画性能估计会惨不忍睹而且纯粹模板结构无论使用 animation 动画方法还是 css 的keyframe的动画方法得到的动画效果都非常差(测试过的结论)还有是已知的动画方法可控性很差使用canvas来生成水果盘好处是动画性能很好(canvas2d)但是定制性和扩展性比较差so综上考虑使用模板(view)布局使用canvas来实现动画。既保证了组件的性能同时定制型扩展性也很好准备计时器方法动画的生成离不开计时器方法settimeout/setinterval这两兄弟真的不够看啊问题还多做过web开发的一定都知道 window.requestAnimationFrame 这货在小程序的计时器方法中不存在好在 canvas2d 中可以使用 Canvas.requestAnimationFrame(function callback) 方法来实现准备运动算法在水果老虎机中激活状态会沿着四方的水果盘做非线性运动(easeInOut比较好用)需要基础的运动算法来计算实际的运动距离。在 animation 动画方法中我们可以使用 ease-in/ease-out 等缓动算法来实现动画效果但在这里必须要借助 tween.js 中的缓动算法来实现运动效果(因为需要控制运动节点)。你会不会想到用css的keyframe动画来做这个运动效果经过我的测试css的动画和animation的动画会在每一条边上实现一次(ease)缓动运动(很奇怪的效果)推荐这篇文章使用其中一个节省代码量/* * Tween.js * t: current time（当前时间）； * b: beginning value（初始值）； * c: change in value（变化量）； * d: duration（持续时间）。 */// Quart 四次方的缓动const easeInOutQuart = function (t, b, c, d) {  if ((t /= d / 2) < 1) return c / 2 * t * t * t * t + b;  return -c / 2 * ((t -= 2) * t * t * t - 2) + b;}复制代码tween算法是以时间为基准(时间比率 = 距离比率)来计算单位时间的实际运动距离布局以上面的图为例我们需要做一个 7 x 7 的水果盘实际有效的奖品格子数为 7*4-4 共24个有效格子有效格子算法js// 0-6 第一行所有格子全部有效  // 21-27 最后一行所有格子全部有效  // 中间部分 i%7===0 和 i%7 === (7-1) 有效// 算法源码有点无聊依据上述思路即可遍历28个格子并标识奖品格子valide=true// 可以扩展想一想 6x6 5x5思路是一样的复制代码wxml<view class=\"fruits-container\" >    <view class=\"fruits-table\" >        <block wx:for=\"{{ary}}\" wx:key=\"index\" >            <view wx:if=\"{{item.valide}}\" class=\"valide\">{{item.title}}</view>            <view wx:else class=\"in-valide\"></view>        </block>    </view>    <canvas type=\"2d\" .... /></view>复制代码样式只节选关键样式目的是让canvas覆盖在水果盘上长宽一致.fruits-container {    position: relative;    width: 400px;    height: 400px;    ...}.fruits-table {    position: absolute;    width: 100%;    height: 100%;    top: 0;    left: 0;    ...}复制代码抓取位置信息canvas的绘制需要X轴, Y轴的精确信息可以使用 wx.createSelectorQuery 方式抓取类名为‘valide’的 view (奖品格子)的位置信息let query = wx.createSelectorQuery().in(this)query.selectAll(`.fruits-table .valide`).boundingClientRect(ret => {    ....    console.log(ret[0]) // top, left, right, bottom, width, height    console.log(ret[1]) // top, left, right, bottom, width, height    ...    ...    console.log(ret[23]) // top, left, right, bottom, width, height})复制代码得到每一个奖品格子的位置信息后就可以使用canvas的 fillRect 方法来绘制激活状态了。绘制一个激活状态let query = wx.createSelectorQuery().in(this)query.selectAll(`.fruits-table .valide`).boundingClientRect(ret => {    ....    let {top, left, right, bottom, width, height} = ret[0]    const canvasQuery = wx.createSelectorQuery()    canvasQuery.select('#fruit-canvas')    .fields({ node: true, size: true })    .exec((res) => {        const canvas = res[0].node        const ctx = canvas.getContext('2d')         let x = top        let y = left        let dx = width        let dy = height        ctx.shadowOffsetX = 2        ctx.shadowOffsetY = -2        ctx.shadowColor = 'red'        ctx.shadowBlur = 50        ctx.lineWidth = 5        ctx.strokeStyle = 'red'        ctx.clearRect(0, 0, canvas.width, canvas.height)        ctx.strokeRect(x, y, dx, dy)    })})复制代码跑起来已经绘制了一个激活状态接下来使它能够简单动起来// 抽象激活方法  functon rect(point, canvas){    let {x, y, dx, dy} = getPosition(point)    ctx.shadowOffsetX = 2    ctx.shadowOffsetY = -2    ...    ...    ctx.clearRect(0, 0, canvas.width, canvas.height) // 擦除整个水果盘    ctx.strokeRect(x, y, dx, dy) // 绘制激活区域}function run(){    setTimeout(()=>{        if (ret.length) {            let point = ret.shift()            rect(point, canvas)            run()        }    }, 100)}复制代码执行run方法后可以看到水果盘的激活状态一步一步的往前走(100毫秒)拖拉机终于可以启动了配上运动算法经过上面的试验我们终于可以看到基本的运动效果了接下来配上运动算法和计时器方法// Quart 四次方的缓动const easeInOutQuart = function (t, b, c, d) {  if ((t /= d / 2) < 1) return c / 2 * t * t * t * t + b;  return -c / 2 * ((t -= 2) * t * t * t - 2) + b;}let start = 0  // 开始时间let begin = 0  // 开始奖品位置let end = 23  // 终点位置这里跑一圈let during = 5000 // 运动总时间// 1000/60 ≈ 17// 17毫秒即表示屏幕60帧刷新率每秒 ≈ requestAnimationFrame计数频率(一般情况)  const steper = () => {  // left为位移距离  // 老虎机的运动位移是节点位移不是精确位移  // 所以这里用parseInt处理只取整数部分  // 数据变化为 0,1,2,3,4,5...23  // 间隔时间/距离由easeInOutQuart算法计算  var left = easeInOutQuart(start, begin, end, during);  let idx = parseInt(left)  start = start + 17;   if (idx <= end) {    let point = this.ret[idx] // 取节点位置信息    this.rect(point) // 绘制  }    // 时间递增  if (start <= during) {    this.ctx.requestAnimationFrame(steper); // 计时器  } else {    // 动画结束这里可以插入回调...    // callback()...  }};steper(); // 启动复制代码以上为我的小程序水果老虎机的基本开发思路                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序页面效果--如何实现滚动列表左右半透明               Taro 小程序开发大型实战：尝鲜微信小程序云                                                        原作者:  天天修改                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序|实现界面滑动切换 ", "author": "                  Rolan                  2020-2-6 00:34                ", "text": "                                                                                                                                                                                     本文首发于微信公众号： \"算法与编程之美\"欢迎关注及时了解更多此系列文章。问题描述 在许多用户体验效果较好的微信小程序中用户通过左右滑动界面也能实现页面的切换方便了用户使用那它们是如何实现的呢？解决方案 图 1   标签页切换在图1中顶部的 3 个标签页标题用 0 、 1 、 2 来表示当前显示为标签页 0 。当用户向左滑动页面时标签页 0 就会被划到左边的不可见区域而标签页 1 被划入可见区域。如果用户在向右滑动页面则标签页 1 被滑动到右边的不可见区域标签页 0 被划入可见区域。问题解决S wiper 组件是滑块视图容器经常用于实现轮播图现在我们将他用于实现标签页的切换。代码如下所示：<swiper><swiper-item style= ” background:#aaa ” >0</swiper-item><swiper-item style= ” background:#bbb ” >1</swiper-item><swiper-item style= ” background:#ccc ” >2</swiper-item></swiper>在上述代码中<swiper>标签是外层容器里面有 3 个 <swiper-item> 标签表示当前一共有 3 项在初始状态下只显示第 1 项向左滑动显示第 2 项再向右滑动可以返回第 1 项。微信小程序并没有严格规定<swiper-item>标签内可以嵌套哪些组件如果放入 image 组件就实现了轮播图效果；如果放入一块页面内容就实现了标签页切换的效果了。I nclude 代码引用在wxml文件中可以使用 <include> 标签引用其他文件中的代码相当于把引用的代码复制到 <include> 标签的位置。 <include> 标签的用途主要有两点：当一个wxml页面中的代码过多时会给代码的维护带来麻烦有时为了找到某一处代码可能翻阅几百行。而利用 <include> 将代码拆分到多个文件中这样就可以方便的查找代码。当多个wxml页面中有相同的部分时可以将这些公共的部分抽取出来保存到一个单独的 wxml 文件中然后在用到的地方通过 <include> 引入。这样可以减少重复的代码并且修改时只需要修改一次。下面演示<include>标签的使用：<include src= ” index.wxml ” /> // 引入 index.wxml 文件<view>body</view><include scr= ” logs.wxml ” /> // 引入 logs.wxml 文件结语 在调试代码的过程中会遇上很多问题有可能一个错误你调试了大半天还是没能解决这个时候我们要做的就是暂时放下它等再过一会再来仔细的分析错误原因和代码逻辑。END                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序如何写动态标签               小程序--滑动右侧字母索引                                                        原作者:  李娇                   来自: 算法与编程之美                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序后端 egg 框架开发记录 ", "author": "                  Rolan                  2020-2-16 00:21                ", "text": "                                                                                                                                                                                     内置对象Request & Response可以在 Context 的实例上获取到当前请求的 Request(\tctx.request ) 和 Response(\tctx.response ) 实例。ctx.response.body= 和\tctx.body= 是等价的。[!] 需要注意的是获取 POST 的 body 应该使用\tctx.request.body 而不是\tctx.bodyController框架提供了一个 Controller 基类并推荐所有的\tController 都继承于该基类实现。这个 Controller 基类有下列属性:ctx - 当前请求的\tContext 实例。app - 应用的\tApplication 实例。config - 应用的\t配置 。service - 应用所有的\tservice 。logger - 为当前 controller 封装的 logger 对象。Service框架提供了一个 Service 基类并推荐所有的\tService 都继承于该基类实现。\tService 基类的属性和 Controller 基类属性一致访问方式也类似中间件编写中间件一个中间件是一个放置在\tapp/middleware 目录下的单独文件它需要 exports 一个普通的 function接受两个参数：options: 中间件的配置项框架会将\tapp.config[${middlewareName}] 传递进来。app: 当前应用 Application 的实例。// app/middleware/error_handler.jsmodule.exports = () => {  return async function errorHandler(ctx, next) {    try {      await next();    } catch (err) {      // 所有的异常都在 app 上触发一个 error 事件框架会记录一条错误日志      ctx.app.emit('error', err, ctx);      const status = err.status || 500;      // 生产环境时 500 错误的详细错误内容不返回给客户端因为可能包含敏感信息      const error = status === 500 && ctx.app.config.env === 'prod'        ? 'Internal Server Error'        : err.message;      // 从 error 对象上读出各个属性设置到响应中      if (status === 422) {        ctx.body = {           code: ctx.ERROR_CODE,           data: error,          msg: '参数错误'+status         };      }      if (status === 500) {        ctx.body = {           code: 500,           data: '',          msg: '服务端错误-----'+error         };      }      ctx.status = 200;    }  };};复制代码使用在应用中使用中间件在应用中我们可以完全通过配置来加载自定义的中间件并决定它们的顺序。如果我们需要加载上面的 gzip 中间件在\tconfig.default.js 中加入下面的配置就完成了中间件的开启和配置：// 加载 errorHandler 中间件  config.middleware = ['errorHandler']复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序登录的最优流程               小程序对文件及后缀名解析                                                        原作者:  shouhe                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "开发小程序折叠面板 ", "author": "                  Rolan                  2020-2-16 00:41                ", "text": "                                                                                                                                                                                     参考了一系列的小程序UI库。。。最后参考了ant-design的折叠面板(collapse)组件设计功能大致如下支持默认展开动态设置标签栏动态设置内容支持无效状态支持切换响应方法戳源码构思折叠面板组件由列表组件(ui-list)实现列表项作为标签页列表项子元素 content 作为弹出层数据子项结构大致如下{    title: '标签标题',    content: '弹层内容'}复制代码列表组件构建一个动态组件 ui-list 通过配置文件实现列表结构将如下这段数据结构const mockData = [  {title: '列表项1', content: '弹层内容1'},  {title: '列表项2', content: '弹层内容2'},  {title: '列表项3', content: '弹层内容3'},]复制代码生成大致如下的wxml<view class=\"list-container\">    <view class=\"item\">      <view class=\"title\">列表项1</view>      <view class=\"content\">弹层内容1</view>    </view>    <view class=\"item\">      <view class=\"title\">列表项2</view>      <view class=\"content\">弹层内容2</view>    </view>    <view class=\"item\">      <view class=\"title\">列表项3</view>      <view class=\"content\">弹层内容3</view>    </view></view>复制代码通过css样式将弹层内容 <view class=\"content\"> 隐藏交互设计弹出设计<view class='title'> 作为展示标签也作为点击事件的主体当点击标签时为 <view class='item'> 的子容器添加 active 激活样式此时弹层内容通过样式设计为 display: block 状态即实现弹出显示<view class=\"item active\">  <view class=\"title\" bind:tap=\"change\">列表项1</view>  <view class=\"content\">弹层内容1</view> <!--css display block--></view>复制代码更新设计为标签点击时提供 changeTitlechangeContent 方法通过关键字段寻址并更新数据从而更新wxml结构如下列的思路<view class=\"title\" bind:tap=\"change\" data-index=\"1\">列表项1</view>复制代码change(e){  const ds = e...dataset  this.toggleActive(e)  this.changeTitle(ds, ...) // 或者 this.changeContent(e, ...)}changeTitle(ds, param) {  let index = ds.index  let $data = findIt(index)  $data.title = param  this.setData({config.data[index]: ....})}changeContent(ds, param) {  // 思路同changeTitle}复制代码上面所述是简化逻辑实现起来并不如此简单尤其是寻址逻辑和更新逻辑实现及应用wxml<ui-list wx:if=\"{{collapsConfig}}\" list=\"{{collapsConfig}}\" />复制代码jslet config = {  listClass: 'collapse-pad',  data: [],  tap: function(param){ // 切换响应方法样式操作封装在组件内部       // this.title({...})      // this.content({...})     // this.disabled(true|false)  }  }Page({  data: {    collapsConfig: config   }})复制代码关于动态标签的一点想法动态标签的好处是可以将逻辑、寻址等在JS部分来实现相较于 template 语法动态标签的方式灵活太多了能方便的实现组件化、模块化规范化和将公共部分抽离且易于维护。当一个项目有多人维护时碎片模板是一个地狱。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序对文件及后缀名解析                                                                       原作者:  天天修改                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序对文件及后缀名解析 ", "author": "                  Rolan                  2020-2-16 00:25                ", "text": "                                                                                                                                                                                     小程序对文件及后缀名解析引用微信开放平台文档1、后缀：1.1、WXSS：样式文件（类似CSS）WXSS 具有\tCSS 大部分的特性小程序在\tWXSS 也做了一些扩充和修改。新增了尺寸单位。在写\tCSS 样式时开发者需要考虑到手机设备的屏幕会有不同的宽度和设备像素比采用一些技巧来换算一些像素单位。\tWXSS 在底层支持新的尺寸单位\trpx 开发者可以免去换算的烦恼只要交给小程序底层来换算即可由于换算采用的浮点数运算所以运算结果会和预期结果有一点点偏差。提供了全局的样式和局部样式。和前边\tapp.json ,\tpage.json 的概念相同你可以写一个\tapp.wxss 作为全局样式会作用于当前小程序的所有页面局部页面样式\tpage.wxss 仅对当前页面生效。此外\tWXSS 仅支持部分\tCSS 选择器更详细的文档可以参考\tWXSS 。1.2、WXML：模板文件（类似HTML）从事过网页编程的人知道网页编程采用的是 HTML + CSS + JS 这样的组合其中\tHTML 是用来描述当前这个页面的结构\tCSS 用来描述页面的样子\tJS 通常是用来处理这个页面和用户的交互。和\tHTML 非常相似\tWXML 由标签、属性等等构成。但是也有很多不一样的地方我们来一一阐述一下：1.2.1、标签名字有点不一样往往写 HTML 的时候经常会用到的标签是\tdiv ,\tp ,\tspan 开发者在写一个页面的时候可以根据这些基础的标签组合出不一样的组件例如日历、弹窗等等。换个思路既然大家都需要这些组件为什么我们不能把这些常用的组件包装起来大大提高我们的开发效率。从上边的例子可以看到小程序的\tWXML 用的标签是\tview ,\tbutton ,\ttext 等等这些标签就是小程序给开发者包装好的基本能力我们还提供了地图、视频、音频等等组件能力。1.2.2、多了一些\twx:if 这样的属性以及 {{ }} 这样的表达式在网页的一般开发流程中我们通常会通过\tJS 操作\tDOM (对应\tHTML 的描述产生的树)以引起界面的一些变化响应用户的行为。例如用户点击某个按钮的时候\tJS 会记录一些状态到\tJS 变量里边同时通过\tDOM API 操控\tDOM 的属性或者行为进而引起界面一些变化。当项目越来越大的时候你的代码会充斥着非常多的界面交互逻辑和程序的各种状态变量显然这不是一个很好的开发模式因此就有了 MVVM 的开发模式（例如 React, Vue）提倡把渲染和逻辑分离。简单来说就是不要再让\tJS 直接操控\tDOM \tJS 只需要管理状态即可然后再通过一种模板语法来描述状态和界面结构的关系即可。小程序的框架也是用到了这个思路如果你需要把一个\tHello World 的字符串显示在界面上。WXML 是这么写 :<text>{{msg}}</text>JS 只需要管理状态即可:this.setData({ msg: \"Hello World\" })通过 {{ }} 的语法把一个变量绑定到界面上我们称为数据绑定。仅仅通过数据绑定还不够完整的描述状态和界面的关系还需要\tif /\telse ,\tfor 等控制能力在小程序里边这些控制能力都用\twx: 开头的属性来表达。文档：\tWXML1.3、JS：一个服务仅仅只有界面展示是不够的还需要和用户做交互：响应用户的点击、获取用户的位置等等。在小程序里边我们就通过编写\tJS （JavaScript）脚本文件来处理用户的操作。<view>{{ msg }}</view><button bindtap=\"clickMe\">点击我</button>点击\tbutton 按钮的时候我们希望把界面上\tmsg 显示成\t\"Hello World\" 于是我们在\tbutton 上声明一个属性:\tbindtap 在 JS 文件里边声明了\tclickMe 方法来响应这次点击操作Page({  clickMe: function() {    this.setData({ msg: \"Hello World\" })  }})响应用户的操作就是这么简单更详细的事件可以参考文档\tWXML - 事件 。此外你还可以在 JS 中调用小程序提供的丰富的 API利用这些 API 可以很方便的调起微信提供的能力例如获取用户信息、本地存储、微信支付等。在前边的 QuickStart 例子中在\tpages/index/index.js 就调用了\twx.getUserInfo 获取微信用户的头像和昵称最后通过\tsetData 把获取到的信息显示到界面上。更多 API 可以参考文档\t小程序的API 。1.4、json：json数据类型用于静态配置2、文件：2.1、小程序配置app.json：是当前小程序的全局配置包括了小程序的所有页面路径、界面表现、网络超时时间、底部 tab 等。QuickStart 项目里边的\tapp.json 配置内容app.json的字段：pages字段—— 用于描述当前小程序所有页面路径这是为了让微信客户端知道当前你的小程序页面定义在哪个目录。window字段—— 定义小程序所有页面的顶部背景颜色文字颜色定义等。2.2、工具配置project.config.json：通常大家在使用一个工具的时候都会针对各自喜好做一些个性化配置例如界面颜色、编译配置等等当你换了另外一台电脑重新安装工具的时候你还要重新配置。考虑到这点小程序开发者工具在每个项目的根目录都会生成一个\tproject.config.json 你在工具上做的任何配置都会写入到这个文件当你重新安装工具或者换电脑工作时你只要载入同一个项目的代码包开发者工具就自动会帮你恢复到当时你开发项目时的个性化配置其中会包括编辑器的颜色、代码上传时自动压缩等等一系列选项参考文档：\t文档2.3、页面配置 page.json这里的\tpage.json 其实用来表示 pages/logs 目录下的\tlogs.json 这类和小程序页面相关的配置。如果你整个小程序的风格是蓝色调那么你可以在\tapp.json 里边声明顶部颜色是蓝色即可。实际情况可能不是这样可能你小程序里边的每个页面都有不一样的色调来区分不同功能模块因此我们提供了\tpage.json 让开发者可以独立定义每个页面的一些属性例如刚刚说的顶部颜色、是否允许下拉刷新等等。参考文档：\t文档                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序后端 egg 框架开发记录               开发小程序折叠面板                                                                           来自: 博客园                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "Taro 小程序开发大型实战：尝鲜微信小程序云 ", "author": "                  Rolan                  2020-2-19 00:37                ", "text": "                                                                                                                                                                                     欢迎继续阅读《Taro 小程序开发大型实战》系列前情回顾：熟悉的 React熟悉的 Hooks ：我们用 React 和 Hooks 实现了一个非常简单的添加帖子的原型多页面跳转和 Taro UI 组件库 ：我们用 Taro 自带的路由功能实现了多页面跳转并用 Taro UI 组件库升级了应用界面实现微信和支付宝多端登录 ：实现了微信、支付宝以及普通登录和退出登录Hooks + Redux 双剑合璧 ：使用了 Hooks 版的 Redux 来重构应用的状态管理使用 Hooks 版的 Redux 实现大型应用状态管理（上篇） ：使用 Hooks 版的 Redux 实现了 user 逻辑的状态管理重构使用 Hooks 版的 Redux 实现大型应用状态管理（下篇） ：使用 Hooks 版的 Redux 实现了 post 逻辑的状态管理重构Taro 小程序开发大型实战（六）：尝鲜微信小程序云（上篇） ： user 逻辑接入微信小程序云在上一篇文章中我们将我们两大逻辑之一 User 部分接入了 Redux 异步处理流程接着接入了微信小程序云使得 User 逻辑可以在云端永久保存好不自在：）两兄弟一个得了好处另外一个不能干瞪眼对吧？在这一篇教程中我们想办法把 User 另外一个兄弟 Post 捞上来也把 Redux 异步流程和微信小程序给它整上这样就齐活了:laughing:。我们首先来看一看最终的完成效果：如果你不熟悉 Redux推荐阅读我们的《Redux 包教包会》系列教程：Redux 包教包会（一）：解救 React 状态危机Redux 包教包会（二）：趁热打铁完全重构Redux 包教包会（三）：各司其职重拾初心如果你希望直接从这一步开始请运行以下命令：git clone -b miniprogram-start https://github.com/tuture-dev/ultra-club.gitcd ultra-club复制代码本文所涉及的源代码都放在了 Github 上如果您觉得我们写得还不错希望您能给 :heart:这篇文章点赞+Github仓库加星❤ ️哦~此教程属于 React 前端工程师学习路线 的一部分欢迎来 Star 一波鼓励我们继续创作出更好的教程持续更新中~“六脉神剑” 搞定 createPost 异步逻辑不知道看到这里的读者有没有发现上篇文章其实打造了一套讲解模式即按照如下的 “六步流程” 来讲解我们也称为 “六脉神剑” 讲解法：sagassagassagasreducers可以看到我们上面的讲解顺序实际上是按照前端数据流的流动来进行的我们对标上面的讲解逻辑来看一下前端数据流是如何流动的：从组件中通过对应的常量发起异步请求sagas 监听到对应的异步请求开始处理流程在 sagas 调用对应的前端 API 文件向微信小程序云发起请求微信小程序云函数处理对应的 API 请求返回数据sagas 中获取到对应的数据 dispatch action 到对应的 reducers 处理逻辑reducers 接收数据开始更新本地 Redux Store 中的 state组件中重新渲染好的了解了讲解逻辑和对应前端数据流动逻辑之后我们马上来实践这套逻辑把 User 逻辑的好兄弟 Post 逻辑搞定。第一剑： PostForm 组件中发起异步请求首先从创建帖子逻辑动刀子我们将创建帖子接入异步逻辑并接通小程序云让文章上云。打开 src/components/PostForm/index.jsx 对其中的内容作出对应的修改如下：import { useDispatch, useSelector } from '@tarojs/redux'import './index.scss'import { CREATE_POST } from '../../constants'export default function PostForm() {  const [formTitle, setFormTitle] = useState('')  const [formContent, setFormContent] = useState('')  const userId = useSelector(state => state.user.userId)  const dispatch = useDispatch()...    }    dispatch({      type: CREATE_POST,      payload: {        postData: {          title: formTitle,          content: formContent,        },        userId,      },    })    setFormTitle('')    setFormContent('')  }  return (复制代码可以看到上面的内容做了如下四处修改：首先我们现在是接收用户的文章输入数据然后向小程序云发起创建文章的请求所以我们将之前的 dispatch SET_POSTS Action 改为 CREATE_POST Action并且将之前的 action payload 简化为 postData 和 userId 因为我们可以通过小程序云数据库查询 userId 得到创建文章的用户信息所以不需要再携带用户的数据。接着因为我们不再需要用户的 avatar 和 nickName 数据所以我们删掉了对应的 useSelector 语句。接着因为请求是异步的所以需要等待请求完成之后再设置对应的发表文章的状态以及发表文章弹出层状态所以我们删掉了对应的 dispatch SET_POST_FORM_IS_OPENED Action 逻辑以及 Taro.atMessage 逻辑。最后我们删掉不需要的常量 SET_POSTS 和 SET_POST_FORM_IS_OPENED 然后导入异步创建文章的常量 CREATE_POST 。增加 Action 常量我们在上一步中使用到了 CREATE_POST 常量打开 src/constants/post.js 在其中增加 CREATE_POST 常量：export const CREATE_POST = 'CREATE_POST'复制代码到这里我们的 “六步流程” 讲解法就走完了第一步即从组件中发起对应的异步请求这里我们是发出的 action.type 为 CREATE_POST 的异步请求。第二剑： 声明和补充对应需要的异步 sagas 文件在 “第一剑” 中我们从组件中 dispatch 了 action.type 为 CREATE_POST 的异步 Action接下来我们要做的就是在对应的 sagas 文件中补齐响应这个异步 action 的 sagas。在 src/sagas/ 文件夹下面创建 post.js 文件并在其中编写如下创建文章的逻辑：import Taro from '@tarojs/taro'import { call, put, take, fork } from 'redux-saga/effects'import { postApi } from '../api'import {  CREATE_POST,  POST_SUCCESS,  POST_ERROR,  SET_POSTS,  SET_POST_FORM_IS_OPENED,} from '../constants'function* createPost(postData, userId) {  try {    const post = yield call(postApi.createPost, postData, userId)    // 其实以下三步可以合成一步但是这里为了讲解清晰将它们拆分成独立的单元    // 发起发帖成功的 action    yield put({ type: POST_SUCCESS })    // 关闭发帖框弹出层    yield put({ type: SET_POST_FORM_IS_OPENED, payload: { isOpened: false } })    // 更新 Redux store 数据    yield put({      type: SET_POSTS,      payload: {        posts: [post],      },    })    // 提示发帖成功    Taro.atMessage({      message: '发表文章成功',      type: 'success',    })  } catch (err) {    console.log('createPost ERR: ', err)    // 发帖失败发起失败的 action    yield put({ type: POST_ERROR })    // 提示发帖失败    Taro.atMessage({      message: '发表文章失败',      type: 'error',    })  }}function* watchCreatePost() {  while (true) {    const { payload } = yield take(CREATE_POST)    console.log('payload', payload)    yield fork(createPost, payload.postData, payload.userId)  }}export { watchCreatePost }复制代码可以看到上面的改动主要是创建 watcherSaga 和 handlerSaga 。创建 watcherSaga我们创建了登录的 watcherSaga ： watchCreatePost 它用来监听 action.type 为 CREATE_POST 的 action并且当监听到 CREATE_POST action 之后从这个 action 中获取必要的 postData 和 userId 数据然后激活 handlerSaga ： createPost 去处理对应的创建帖子的逻辑。这里的 watcherSaga ： watchCreatePost 是一个生成器函数它内部是一个 while 无限循环表示在内部持续监听 CREATE_POST action。在循环内部我们使用了 redux-saga 提供的 effects helper 函数： take 它用于监听 CREATE_POST action获取 action 中携带的数据。接着我们使用了另外一个 effects helper 函数： fork 它表示非阻塞的执行 handlerSaga： createPost 并将 payload.postData 和 payload.userId 作为参数传给 createPost 。创建 handlerSaga我们创建了创建帖子的 handlerSaga ： createPost 它用来处理创建逻辑。createPost 也是一个生成器函数在它内部是一个 try/catch 语句用于处理创建帖子请求可能存在的错误情况。在 try 语句中首先是使用了 redux-saga 提供给我们的 effects helper 函数： call 来调用登录的 API： postApi.createPost 并把 postData 和 userId 作为参数传给这个 API。如果创建帖子成功我们使用 redux-saga 提供的 effects helpers 函数： put  put类似之前在 view 中的 dispatch 操作来 dispatch 了三个 action： POST_SUCCESS  SET_POST_FORM_IS_OPENED  SET_POSTS 代表更新创建帖子成功的状态关闭发帖框设置最新创建的帖子信息到 Redux Store 中。最后我们使用了 Taro UI 提供给我们的消息框来显示一个 success 消息。如果发帖失败我们则使用 put 发起一个 POST_ERROR 的 action 来更新创建帖子失败的信息到 Redux Store接着使用了 Taro UI 提供给我们的消息框来显示一个 error 消息。一些额外的工作为了创建 watcherSaga 和 handlerSaga 我们还导入了 postApi 我们将在后面来创建这个 API。除此之外我们还导入了需要使用的 action 常量：POST_SUCCESSPOST_ERRORSET_POSTSCREATE_POSTSET_POST_FORM_IS_OPENED这里的 POST_SUCCESS 和 POST_ERROR 我们还没有创建我们将马上在 “下一剑” 中创建它。以及一些 redux-saga/effects 相关的 helper 函数我们已经在之前的内容中详细讲过了这里就不再赘述了。加入 saga 中心调度文件我们像之前将 watchLogin 等加入到 sagas 中心调度文件一样将我们创建好的 watchCreatePost 也加入进去：// ...之前的逻辑import { watchCreatePost } from './post'export default function* rootSaga() {  yield all([   // ... 之前的逻辑    fork(watchCreatePost)  ])}复制代码第三剑：定义 sagas 需要的常量文件打开 src/constants/post.js 文件定义我们之前创建的常量文件如下：export const POST_SUCCESS = 'POST_SUCCESS'export const POST_ERROR = 'POST_ERROR'复制代码第四剑：定义 sagas 涉及到的前端 API 文件在之前的 post saga 文件里面我们使用到了 postApi 它里面封装了用于向后端（这里我们是小程序云）发起和帖子有关请求的逻辑让我们马上来实现它吧。在 src/api/ 文件夹下添加 post.js 文件并在文件中编写内容如下：import Taro from '@tarojs/taro'async function createPost(postData, userId) {  const isWeapp = Taro.getEnv() === Taro.ENV_TYPE.WEAPP  const isAlipay = Taro.getEnv() === Taro.ENV_TYPE.ALIPAY  console.log('postData', postData, userId)  // 针对微信小程序使用小程序云函数其他使用小程序 RESTful API  try {    if (isWeapp) {      const { result } = await Taro.cloud.callFunction({        name: 'createPost',        data: {          postData,          userId,        },      })      return result.post    }  } catch (err) {    console.error('createPost ERR: ', err)  }}const postApi = {  createPost,}export default postApi;复制代码在上面的代码中我们定义了 createPost 函数它是一个 async 函数用来处理异步逻辑在 createPost 函数中我们对当前的环境进行了判断且只在微信小程序即 isWeapp 的条件下执行创建帖子的操作对于支付宝小程序和 H5我们则放在下一节使用 LeanCloud 的 Serverless 来解决。创建帖子逻辑是一个 try/catch 语句用于捕捉可能存在的请求错误在 try 代码块中我们使用了 Taro 为我们提供的微信小程序云的云函数 API Taro.cloud.callFunction 来便捷的向小程序云发起云函数调用请求。这里我们调用了一个 createPost 云函数并将 postData 和 userId 作为参数传给云函数用于在云函数中使用用户 Id 和帖子数据来创建一个属于此用户的帖子并保存到数据库我们将在下一节中实现这个云函数。如果调用成功我们可以接收返回值用于从后端返回数据这里我们返回了 result.post 数据。如果调用失败则打印错误。最后我们定义了一个 postApi 对象用于存放所有和用户逻辑有个的函数并添加 createPost API 属性然后将其导出这样在 post saga 函数里面就可以导入 postApi 然后通过 postApi.createPost 的方式来调用 createPost API 处理创建帖子的逻辑了。在 API 默认文件统一导出在 src/api/index.js 文件中导入上面创建的 postApi 并进行统一导出如下：import postApi from './post'export { postApi }复制代码第五剑：创建对应的微信小程序云函数创建 createPost 云函数按照和之前创建 login 云函数类似我们创建 createPost 云函数。创建成功之后我们可以得到两个文件一个是 functions/createPost/package.json 文件它和之前的类似。{  \"name\": \"createPost\",  \"version\": \"1.0.0\",  \"description\": \"\",  \"main\": \"index.js\",  \"scripts\": {    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"  },  \"author\": \"\",  \"license\": \"ISC\",  \"dependencies\": {    \"wx-server-sdk\": \"latest\"  }}复制代码第二个文件就是我们需要编写创建帖子逻辑的 functions/createPost/index.js 文件微信小程序开发者工具会默认为我们生成一段样板代码。我们在 function/createPost 文件夹下同样运行 npm install 安装对应的云函数依赖这样我们才能运行它。编写 createPost 云函数打开 functions/createPost/index.js 文件对其中的内容作出对应的修改如下：// 云函数入口文件const cloud = require('wx-server-sdk')cloud.init({  env: cloud.DYNAMIC_CURRENT_ENV,})const db = cloud.database()// 云函数入口函数exports.main = async (event, context) => {  const { postData, userId } = event  console.log('event', event)  try {    const user = await db      .collection('user')      .doc(userId)      .get()    const { _id } = await db.collection('post').add({      data: {        ...postData,        user: user.data,        createdAt: db.serverDate(),        updatedAt: db.serverDate(),      },    })    const newPost = await db      .collection('post')      .doc(_id)      .get()    return {      post: { ...newPost.data },    }  } catch (err) {    console.error(`createUser ERR: ${err}`)  }}复制代码可以看到上面的代码改动主要有以下七处：首先我们给 cloud.init() 传入了环境参数我们使用了内置的 cloud.DYNAMIC_CURRENT_ENV表示自动设置为当前的云环境即在右键点击小程序开发者工具里 functions 文件夹时选择的环境。接着我们通过 cloud.database() 生成了数据实例 db 用于之后在函数体中便捷的操作云数据库。接着就是 main 函数体我们首先从 event 对象中取到了在小程序的调用 Taro.cloud.callFunction 传过来的 postData 和 userId 数据。然后跟着取数据的是一个 try/catch 语句块用于捕获错误在 try 语句块中我们使用 db 的查询操作： db.collection('user').doc(userId).get() 表示查询 id 为 userId 的 user 表数据它查出来应该是个唯一值如果不存在满足 where 条件的那么是一个 null值如果存在满足 条件的那么返回一个 user 对象。接着我们使用的 db.collection('post').add() 添加一个 post 数据然后在 add 方法中传入 data 字段这里我们不仅传入了 postData 还将 user 也一同传入了原因我们将在之后来讲解。除此之外这里我们额外使用了 db.serverDate() 用于记录创建此帖子的时间和更新此帖子的时间方便之后做条件查询。接着因为向数据库添加一个记录之后只会返回此记录的 _id 所以我们需要一个额外的操作 db.collection('post').doc() 来获取此条记录这个 doc 用于获取指定的记录引用返回的是这条数据而不是一个数组。最后我们返回新创建的 post 。提示我们在上面创建 post 的时候将 user 对象也添加到了 post 数据中这里是因为小程序云数据库是 JSON 数据库,所以没有关系数据库的外键概念,导致建关系困难,所以为了之后查询 post 的时候方便展示 user 数据我们才这样保存的. 当然更加科学的做法是在 post 里面保存 userId 这样能减少数据冗余但是因为做教学用所以这些我们偷了一点懒。所以我们这里强烈建议,在正规的环境下关系型数据库应该建外键JSON 数据库也至少应该保存 userId 。:第六剑： 定义对应的 reducers 文件我们在前面处理创建帖子时在组件内部 dispatch 了 CREATE_POST action在处理异步 action 的 saga 函数中使用 put 发起了一系列更新 store 中帖子状态的 action现在我们马上来实现响应这些 action 的 reducers 打开 src/reducers/post.js 对其中的代码做出对应的修改如下：import {  SET_POST,  SET_POSTS,  SET_POST_FORM_IS_OPENED,  POST_ERROR,  CREATE_POST,  POST_NORMAL,  POST_SUCCESS,} from '../constants/'import avatar from '../images/avatar.png'const INITIAL_STATE = {  posts: [],  post: {},  isOpened: false,  isPost: false,  postStatus: POST_NORMAL,}export default function post(state = INITIAL_STATE, action) {  switch (action.type) {    case SET_POST: {      const { post } = action.payload      return { ...state, post }    }    case SET_POSTS: {      const { posts } = action.payload      return { ...state, posts: state.posts.concat(...posts) }    }    case SET_POST_FORM_IS_OPENED: {...      return { ...state, isOpened }    }    case CREATE_POST: {      return { ...state, postStatus: CREATE_POST, isPost: true }    }    case POST_SUCCESS: {      return { ...state, postStatus: POST_SUCCESS, isPost: false }    }    case POST_ERROR: {      return { ...state, postStatus: POST_ERROR, isPost: false }    }    default:      return state  }复制代码看一看到上面的代码主要有三处改动：首先我们导入了必要的 action 常量接着我们给 INITIAL_STATE 增加了几个字段：postspostisPost ：用于标志帖子逻辑过程中是否在执行创帖逻辑 true 表示正在执行创帖中 false 表示登录逻辑执行完毕postStatus ：用于标志创帖过程中的状态：开始创帖（ CREATE_POST ）、创帖成功（ POST_SUCCESS ）、登录失败（ POST_ERROR ）最后就是 switch 语句中响应 action更新相应的状态。“六脉神剑” 搞定 getPosts 异步逻辑在上一 “大” 节中我们使用了图雀社区不传之术：“六脉神剑” 搞定了 createPost 的异步逻辑现在我们马上趁热打铁来巩固我们的武功搞定 getPosts 异步逻辑它对应着我们小程序底部两个 tab 栏的第一个也就是我们打开小程序的首屏渲染逻辑也就是一个帖子列表。第一剑： index 组件中发起异步请求打开 src/pages/index/index.jsx 文件对其中的内容作出对应的修改如下：import { PostCard, PostForm } from '../../components'import './index.scss'import {  SET_POST_FORM_IS_OPENED,  SET_LOGIN_INFO,  GET_POSTS,} from '../../constants'export default function Index() {  const posts = useSelector(state => state.post.posts) || []...  const dispatch = useDispatch()  useEffect(() => {    const WeappEnv = Taro.getEnv() === Taro.ENV_TYPE.WEAPP    if (WeappEnv) {      Taro.cloud.init()    }    async function getStorage() {      try {        const { data } = await Taro.getStorage({ key: 'userInfo' })        const { nickName, avatar, _id } = data        // 更新 Redux Store 数据        dispatch({          type: SET_LOGIN_INFO,          payload: { nickName, avatar, userId: _id },        })      } catch (err) {        console.log('getStorage ERR: ', err)      }    }    if (!isLogged) {      getStorage()    }    async function getPosts() {      try {        // 更新 Redux Store 数据        dispatch({          type: GET_POSTS,        })      } catch (err) {        console.log('getPosts ERR: ', err)      }    }    if (!posts.length) {      getPosts()    }  }, [])  function setIsOpened(isOpened) {    dispatch({ type: SET_POST_FORM_IS_OPENED, payload: { isOpened } })...  return (    <View className=\"index\">      <AtMessage />      {posts.map(post => (        <PostCard key={post._id} postId={post._id} post={post} isList />      ))}      <AtFloatLayout        isOpened={isOpened}复制代码可以看到上面的内容做了如下四处修改：首先我们对当前的开发环境做了判断如果是微信小程序环境我们就使用 Taro.cloud.init() 进行小程序环境的初始化。接着我们在 useEffects Hooks 里面定义了 getPosts 函数它是一个异步函数用于 dispatch GET_POSTS 的异步请求并且我们进行了判断当此时 Redux Store 内部没有文章时才进行数据的获取。接着我们改进了 getStorage 获取缓存的函数将其移动到 useEffects Hooks 里面并额外增加了 _id 属性它被赋值给 userId 一起设置 Redux Store 中关于用户的属性这样做的目的主要是为了之后发帖标志用户或者获取用户的个人信息用。并且加了一层 if 判断只有当没有登录时即 isLogged 为 false 的时候才进行获取缓存操作。最后我们导入了必要的 GET_POSTS 常量并且将 return 语句里的 PostCard 接收的 key 和 postId 属性变成了真实的帖子 _id 。这样我们在帖子详情时可以直接拿 postId 向小程序云发起异步请求。注意在上一篇教程中有同学提到没有使用 Taro.cloud.init() 初始化的问题是因为分成了两篇文章在这篇文章才初始化。要使用小程序云初始化环境是必要的。第二剑：声明和补充对应需要的异步 sagas 文件在 “第一剑” 中我们从组件中 dispatch 了 action.type 为 GET_POSTS 的异步 Action接下来我们要做的就是在对应的 sagas 文件中补齐响应这个异步 action 的 sagas。打开 src/sagas/post.js 文件在其中定义 getPosts sagas 逻辑如下：import {  GET_POSTS,} from '../constants'function* getPosts() {  try {    const posts = yield call(postApi.getPosts)    // 其实以下三步可以合成一步但是这里为了讲解清晰将它们拆分成独立的单元    // 发起获取帖子成功的 action    yield put({ type: POST_SUCCESS })    // 更新 Redux store 数据    yield put({      type: SET_POSTS,      payload: {        posts,      },    })  } catch (err) {    console.log('getPosts ERR: ', err)    // 获取帖子失败发起失败的 action    yield put({ type: POST_ERROR })  }}function* watchGetPosts() {  while (true) {    yield take(GET_POSTS)    yield fork(getPosts)  }}export { watchGetPosts }复制代码可以看到上面的改动主要是创建 watcherSaga 和 handlerSaga 。创建 watcherSaga我们创建了登录的 watcherSaga ： watchGetPosts 它用来监听 action.type 为 GET_POSTS的 action并且当监听到 GET_POSTS action 之后然后激活 handlerSaga ： getPosts 去处理对应的获取帖子列表的逻辑。这里的 watcherSaga ： watchGetPosts 是一个生成器函数它内部是一个 while 无限循环表示在内部持续监听 GET_POSTS action。在循环内部我们使用了 redux-saga 提供的 effects helper 函数： take 它用于监听 GET_POSTS action获取 action 中携带的数据。接着我们使用了另外一个 effects helper 函数： fork 它表示非阻塞的执行 handlerSaga： getPosts 因为这里获取帖子列表不需要传数据所以这里没有额外的数据传递逻辑。创建 handlerSaga我们创建了创建帖子的 handlerSaga ： getPosts 它用来处理创建逻辑。getPosts 也是一个生成器函数在它内部是一个 try/catch 语句用于处理获取帖子列表请求可能存在的错误情况。在 try 语句中首先是使用了 redux-saga 提供给我们的 effects helper 函数： call 来调用登录的 API： postApi. getPosts 。如果获取帖子列表成功我们使用 redux-saga 提供的 effects helpers 函数： put  put 类似之前在 view 中的 dispatch 操作来 dispatch 了两个 action： POST_SUCCESS  SET_POSTS 代表更新获取帖子列表成功的状态设置最新获取的帖子列表到 Redux Store 中。如果获取帖子列表失败我们则使用 put 发起一个 POST_ERROR 的 action 来更新获取帖子列表失败的信息到 Redux Store一些额外的工作为了创建 watcherSaga 和 handlerSaga 我们还导入了 postApi. getPosts 我们将在后面来创建这个 API。除此之外我们还导入了需要使用的 action 常量：GET_POSTS ：响应获取帖子列表的 ACTION 常量我们将在 “第三剑” 中创建它。加入 saga 中心调度文件我们像之前将 watchCreatePost 等加入到 sagas 中心调度文件一样将我们创建好的 watchGetPosts 也加入进去：// ...之前的逻辑import { watchGetPosts } from './post'export default function* rootSaga() {  yield all([   // ... 之前的逻辑    fork(watchGetPosts)  ])}复制代码第三剑：定义 sagas 需要的常量文件打开 src/constants/post.js 文件定义我们之前创建的常量文件如下：export const GET_POSTS = 'GET_POSTS'复制代码第四剑：定义 sagas 涉及到的前端 API 文件在之前的 post saga 文件里面我们使用到了 postApi.getPosts 它里面封装了用于向后端（这里我们是小程序云）发起和获取帖子列表有关请求的逻辑让我们马上来实现它吧。打开 src/api/post.js 文件并在其中编写内容如下：// ... 其余逻辑一样async function getPosts() {  const isWeapp = Taro.getEnv() === Taro.ENV_TYPE.WEAPP  const isAlipay = Taro.getEnv() === Taro.ENV_TYPE.ALIPAY  // 针对微信小程序使用小程序云函数其他使用小程序 RESTful API  try {    if (isWeapp) {      const { result } = await Taro.cloud.callFunction({        name: 'getPosts',      })      return result.posts    }  } catch (err) {    console.error('getPosts ERR: ', err)  }}const postApi = {  // ... 之前的 API  getPosts,}// ... 其余逻辑一样复制代码在上面的代码中我们定义了 getPosts 函数它是一个 async 函数用来处理异步逻辑在 getPosts 函数中我们对当前的环境进行了判断且只在微信小程序即 isWeapp 的条件下执行获取帖子列表的操作对于支付宝小程序和 H5我们则放在下一节使用 LeanCloud 的 Serverless 来解决。创建帖子逻辑是一个 try/catch 语句用于捕捉可能存在的请求错误在 try 代码块中我们使用了 Taro 为我们提供的微信小程序云的云函数 API Taro.cloud.callFunction 来便捷的向小程序云发起云函数调用请求。这里我们调用了一个 getPosts 云函数我们将在下一节中实现这个云函数。如果调用成功我们可以接收返回值用于从后端返回数据这里我们返回了 result.posts数据即从小程序云返回的帖子列表。如果调用失败则打印错误。最后我们在已经定义好的 postApi 对象里添加 getPosts API 属性然后将其导出这样在 post saga 函数里面就可以导入 postApi 然后通过 postApi. getPosts 的方式来调用 getPosts API 处理获取帖子列表的逻辑了。第五剑：创建对应的微信小程序云函数创建 getPosts 云函数按照和之前创建 createPost 云函数类似我们创建 getPosts 云函数。创建成功之后我们可以得到两个文件一个是 functions/getPosts/package.json 文件它和之前的类似。{  \"name\": \"getPosts\",  \"version\": \"1.0.0\",  \"description\": \"\",  \"main\": \"index.js\",  \"scripts\": {    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"  },  \"author\": \"\",  \"license\": \"ISC\",  \"dependencies\": {    \"wx-server-sdk\": \"latest\"  }}复制代码第二个文件就是我们需要编写创建帖子逻辑的 functions/getPosts/index.js 文件微信小程序开发者工具会默认为我们生成一段样板代码。我们在 function/getPosts 文件夹下同样运行 npm install 安装对应的云函数依赖这样我们才能运行它。编写 getPosts 云函数打开 functions/getPosts/index.js 文件对其中的内容作出对应的修改如下：// 云函数入口文件const cloud = require('wx-server-sdk')cloud.init({  env: cloud.DYNAMIC_CURRENT_ENV,})const db = cloud.database()const _ = db.command// 云函数入口函数exports.main = async (event, context) => {  try {    const { data } = await db.collection('post').get()    return {      posts: data,    }  } catch (e) {    console.error(`getPosts ERR: ${e}`)  }}复制代码可以看到上面的代码改动主要有以下处：首先我们给 cloud.init() 传入了环境参数我们使用了内置的 cloud.DYNAMIC_CURRENT_ENV表示自动设置为当前的云环境即在右键点击小程序开发者工具里 functions 文件夹时选择的环境。接着我们通过 cloud.database() 生成了数据实例 db 用于之后在函数体中便捷的操作云数据库。接着就是 main 函数体里面是一个 try/catch 语句块用于捕获错误在 try 语句块中我们使用 db 的查询操作： db.collection('post').get() 表示查询所有的 post 数据。最后我们返回查询到的 posts 数据。第六剑： 定义对应的 reducers 文件因为这里 SET_POSTS 的 Action 我们在上一 “大” 节中创建帖子时已经定义了所有在 “这一剑” 中我们无需添加额外的代码复用之前的逻辑就好。“六脉神剑” 搞定 getPost 异步逻辑在上面两 “大” 节中我们连续用了两次 “六脉神剑”相信跟到这里的同学应该对我们接下来要做的事情已经轻车熟路了吧:grin:。接下来我们将收尾 Post 逻辑的最后一公里即帖子详情的异步逻辑 “getPost” 接入话不多说就是干！第一剑： post 组件中发起异步请求打开 src/pages/post/post.jsx 文件对其中的内容作出对应的修改如下：import Taro, { useRouter, useEffect } from '@tarojs/taro'import { View } from '@tarojs/components'import { useDispatch, useSelector } from '@tarojs/redux'import { PostCard } from '../../components'import './post.scss'import { GET_POST, SET_POST } from '../../constants'export default function Post() {  const router = useRouter()  const { postId } = router.params  const dispatch = useDispatch()  const post = useSelector(state => state.post.post)  useEffect(() => {    dispatch({      type: GET_POST,      payload: {        postId,      },    })    return () => {      dispatch({ type: SET_POST, payload: { post: {} } })    }  }, [])  return (    <View className=\"post\">复制代码可以看到上面的内容做了如下四处修改：首先我们使用 useDispatch Hooks 获取到了 dispatch 函数。接着在 useEffects Hooks 里面定义了 dispatch 了 action.type 为 GET_POST 的 action它是一个异步 Action并且我们在 Hooks 最后返回了一个函数其中的内容为将 post 设置为空对象这里用到的 SET_POST 常量我们将在后面定义它。这个返回函数主要用于 post 组件卸载之后Redux Store 数据的重置避免下次打开帖子详情还会渲染之前获取到的帖子数据。接着我们使用 useSelector Hooks 来获取异步请求到的 post 数据并用于 return 语句中的数据渲染。最后我们删除了不必要的获取 posts 数据的 useSelector Hooks以及删掉了不必要的调试 console.log 语句。第二剑： 声明和补充对应需要的异步 sagas 文件在 “第一剑” 中我们从组件中 dispatch 了 action.type 为 GET_POST 的异步 Action接下来我们要做的就是在对应的 sagas 文件中补齐响应这个异步 action 的 sagas。打开 src/sagas/post.js 文件在其中定义 getPosts sagas 逻辑如下：// ... 和之前的逻辑一样import {  // ... 和之前的逻辑一样  SET_POST,} from '../constants';  // ... 和之前的逻辑一样function* getPost(postId) {  try {    const post = yield call(postApi.getPost, postId)    // 其实以下三步可以合成一步但是这里为了讲解清晰将它们拆分成独立的单元    // 发起获取帖子成功的 action    yield put({ type: POST_SUCCESS })    // 更新 Redux store 数据    yield put({      type: SET_POST,      payload: {        post,      },    })  } catch (err) {    console.log('getPost ERR: ', err)    // 获取帖子失败发起失败的 action    yield put({ type: POST_ERROR })  }}function* watchGetPost() {  while (true) {    const { payload } = yield take(GET_POST)    yield fork(getPost, payload.postId)  }}export { watchGetPost }复制代码可以看到上面的改动主要是创建 watcherSaga 和 handlerSaga 。创建 watcherSaga我们创建了登录的 watcherSaga ： watchGetPost 它用来监听 action.type 为 GET_POST的 action并且当监听到 GET_POST action 之后然后激活 handlerSaga ： getPost 去处理对应的获取单个帖子的逻辑。这里的 watcherSaga ： watchGetPost 是一个生成器函数它内部是一个 while 无限循环表示在内部持续监听 GET_POST action。在循环内部我们使用了 redux-saga 提供的 effects helper 函数： take 它用于监听 GET_POST action获取 action 中携带的数据这里我们拿到了传过来的 payload 数据。接着我们使用了另外一个 effects helper 函数： fork 它表示非阻塞的执行 handlerSaga： getPost 并传入了获取到 payload.postId 参数。创建 handlerSaga我们创建了获取单个帖子的 handlerSaga ： getPost 它用来处理获取帖子逻辑。getPost 也是一个生成器函数在它内部是一个 try/catch 语句用于处理获取单个帖子请求可能存在的错误情况。在 try 语句中首先是使用了 redux-saga 提供给我们的 effects helper 函数： call 来调用登录的 API： postApi. getPost 。如果获取单个帖子成功我们使用 redux-saga 提供的 effects helpers 函数： put  put 类似之前在 view 中的 dispatch 操作来 dispatch 了两个 action： POST_SUCCESS  SET_POSTS 代表更新获取单个帖子成功的状态设置最新获取的帖子到 Redux Store 中。如果获取单个帖子失败我们则使用 put 发起一个 POST_ERROR 的 action 来更新获取单个帖子失败的信息到 Redux Store一些额外的工作为了创建 watcherSaga 和 handlerSaga 我们还导入了 postApi.getPost 我们将在后面来创建这个 API。除此之外我们还导入了需要使用的 action 常量：SET_POST ：响应获取帖子列表的 ACTION 常量我们将在 “第三剑” 中创建它加入 saga 中心调度文件我们像之前将 watchGetPosts 等加入到 sagas 中心调度文件一样将我们创建好的 watchGetPost 也加入进去：打开 src/sagas/index.js 文件对其中的内容作出如下的修改：import { fork, all } from 'redux-saga/effects'import { watchLogin } from './user'import { watchCreatePost, watchGetPosts, watchGetPost } from './post'export default function* rootSaga() {  yield all([    fork(watchLogin),    fork(watchCreatePost),    fork(watchGetPosts),    fork(watchGetPost),  ])}复制代码第三剑：定义 sagas 需要的常量文件打开 src/constants/post.js 文件定义我们之前创建的常量文件 GET_POST ：export const SET_POST = 'SET_POST'复制代码第四剑：定义 sagas 涉及到的前端 API 文件在之前的 post saga 文件里面我们使用到了 postApi.getPost 它里面封装了用于向后端（这里我们是小程序云）发起和获取单个帖子有关请求的逻辑让我们马上来实现它吧。打开 src/api/post.js 文件并在其中编写内容如下：// ... 其他内容和之前一致async function getPost(postId) {  const isWeapp = Taro.getEnv() === Taro.ENV_TYPE.WEAPP  const isAlipay = Taro.getEnv() === Taro.ENV_TYPE.ALIPAY  // 针对微信小程序使用小程序云函数其他使用小程序 RESTful API  try {    if (isWeapp) {      const { result } = await Taro.cloud.callFunction({        name: 'getPost',        data: {          postId,        },      })      return result.post    }  } catch (err) {    console.error('getPost ERR: ', err)  }}const postApi = {  getPost,}export default postApi复制代码可以看到上面的代码有如下六处改动：在上面的代码中我们定义了 getPost 函数它是一个 async 函数用来处理异步逻辑在 getPost 函数中我们对当前的环境进行了判断且只在微信小程序即 isWeapp 的条件下执行获取单个帖子的操作对于支付宝小程序和 H5我们则放在下一节使用 LeanCloud 的 Serverless 来解决。创建帖子逻辑是一个 try/catch 语句用于捕捉可能存在的请求错误在 try 代码块中我们使用了 Taro 为我们提供的微信小程序云的云函数 API Taro.cloud.callFunction 来便捷的向小程序云发起云函数调用请求。这里我们调用了一个 getPost 云函数并给它传递了对应要获取的帖子的 postId 我们将在下一节中实现这个云函数。如果调用成功我们可以接收返回值用于从后端返回数据这里我们返回了 result.post数据即从小程序云返回的单个帖子。如果调用失败则打印错误。最后我们在已经定义好的 postApi 对象里添加 getPost API 属性然后将其导出这样在 post saga 函数里面就可以导入 postApi 然后通过 postApi. getPost 的方式来调用 getPostAPI 处理获取单个帖子的逻辑了。第五剑：创建对应的微信小程序云函数创建 getPost 云函数按照和之前创建 getPosts 云函数类似我们创建 getPost 云函数。创建成功之后我们可以得到两个文件一个是 functions/getPost/package.json 文件它和之前的类似。{  \"name\": \"getPost\",  \"version\": \"1.0.0\",  \"description\": \"\",  \"main\": \"index.js\",  \"scripts\": {    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"  },  \"author\": \"\",  \"license\": \"ISC\",  \"dependencies\": {    \"wx-server-sdk\": \"latest\"  }}复制代码第二个文件就是我们需要编写创建帖子逻辑的 functions/getPost/index.js 文件微信小程序开发者工具会默认为我们生成一段样板代码。我们在 function/getPost 文件夹下同样运行 npm install 安装对应的云函数依赖这样我们才能运行它。编写 getPost 云函数打开 functions/getPost/index.js 文件对其中的内容作出对应的修改如下：// 云函数入口文件const cloud = require('wx-server-sdk')cloud.init({  env: cloud.DYNAMIC_CURRENT_ENV,})const db = cloud.database()// 云函数入口函数exports.main = async (event, context) => {  const { postId } = event  try {    const { data } = await db      .collection('post')      .doc(postId)      .get()    return {      post: data,    }  } catch (e) {    console.error(`getPost ERR: ${e}`)  }}复制代码可以看到上面的代码改动主要有以下处：首先我们给 cloud.init() 传入了环境参数我们使用了内置的 cloud.DYNAMIC_CURRENT_ENV表示自动设置为当前的云环境即在右键点击小程序开发者工具里 functions 文件夹时选择的环境。接着我们通过 cloud.database() 生成了数据实例 db 用于之后在函数体中便捷的操作云数据库。接着就是 main 函数体里面是一个 try/catch 语句块用于捕获错误在 try 语句块中我们首先从 event 对象里面获取到了 postId 接着我们使用 db 的查询操作： db.collection('post').doc(postId).get() 表示查询所有的对应 _id 为 postId 的单个帖子数据最后我们返回查询到的 post 数据。第六剑： 定义对应的 reducers 文件因为这里 SET_POST 的 Action 我们在上上 “大” 节中创建帖子时已经定义了所有在 “这一剑” 中我们无需添加额外的代码复用之前的逻辑就好。小结在这篇教程中我们连续使用了三次 “六脉神剑” 讲完了我们的 Post 逻辑的异步流程让我们再来复习一下我们开头提到的 “六脉神剑”：sagassagassagasreducers这是一套讲解模式也是一套写代码的最佳实践方式之一希望你能受用。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序canvas开发水果老虎机                                                                       原作者:  图雀社区                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发需要注意的一些规范 ", "author": "                  Rolan                  2019-5-5 00:42                ", "text": "                                                                                                                                                                                     出现 JavaScript 异常可能导致小程序的交互无法进行下去我们应当追求零异常保证小程序的高鲁棒性和高可用性相信这一点一般情况下都不会出现需要注意的是代码测试中多场景的试错。2.合理控制图片的大小图片太大会增加下载时间和内存的消耗应根据显示区域大小合理控制图片大小。 一般情况下图片较大的我们应该都会选择直接放在服务器上直接拿到地址但是官方说这样读取的图片： 存在网络图片资源未开启 HTTP 缓存控制 ,这是个什么意思我也未完全弄懂。3.小程序所有请求应响应正常请求失败可能导致小程序的交互无法进行下去应当保证所有请求都能成功。然而请求成功只是第一步还可能存在的问题就是请求的耗时太长、存在短时间内发起太多的请求这样的情况一方面是后台人员的接口写的烂一方面就是需求使然（技术半吊子还想安全的产品经理会有这种让你去指定地方请求的情况）比如在阿里云OSS存储的一些json数据。。。。4.避免setData的数据过大且避免setData的调用过于频繁。由于小程序运行逻辑线程与渲染线程之上setData的调用会把数据从逻辑层传到渲染层数据太大会增加通信时间. setData接口的调用涉及逻辑层与渲染层间的线程通过通信过于频繁可能导致处理队列阻塞界面渲染不及时而导致卡顿应避免无用的频繁调用.5.避免将未绑定在 WXML 的变量传入 setDatasetData操作会引起框架处理一些渲染界面相关的工作一个未绑定的变量意味着与界面渲染无关传入setData会造成不必要的性能消耗。 这一条我想是很多开发人员在初次接触小程序开发的时候都会犯的一个错误吧。因为刚开始的时候由于这种setData的语法让我们忘了还有全局变量的使用于是会经常出现使用Page中定义的data做中间过渡。6.wxss 覆盖率较高较少或没有引入未被使用的样式我们应该按需引入 wxss 资源如果小程序中存在大量未使用的样式会增加小程序包体积大小从而在一定程度上影响加载速度。 这个也是比较常见的一种不规范写了很多CSS样式很多不用的就留来了代码里面越来越多所以在编写代码过程中尽量去对每一行代码（特别是自己写的）了如指掌。7.避免首屏时间太长的情况首屏时间是指用户开始看到第一屏的内容的时间首屏时间太长会导致用户长时间看到的都是白屏会一直等待有意义的内容展示出来。出现这一情况应仔细检查这个过程都有哪个操作一般来说可能是请求数据的时间太长或者是一次渲染的数据太大导致渲染时间太长。这些东西是我感觉比较常见且容易修改的其它还存在一些规范不妨打开微信开发者工具点击 Audits ,对你写的代码进行一个测试测试结果会让你很好的处理自己的代码。That's really cool!                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w66                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从0开始搭建微信小程序(前后端)的全过程               微信小程序生命周期与性能指标                                                        原作者:  六个周                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发——点击按钮退出小程序的实现 ", "author": "                  Rolan                  2019-4-23 00:43                ", "text": "                                                                                                                                                                                     微信小程序官方是没有提供退出的API的但是在navigator这个组件中是有退出这个功能的：详情参考官方文档：navigator。示例代码：1 <navigator open-type=\"exit\" target=\"miniProgram\">关闭小程序navigator>不过这个功能最低支持版本时 2.1.0 如果一定要使用这个功能那么最好在小程序管理后台中设置最低基础库版本不低于2.1.0如果对小程序支持的最低基础库低于2.1.0那么可以对小程序基础库版本进行判断支持小程序退出的就使用退出组件如果不支持那么就做好跳转到其他指定页面的兼容处理。1         wx.getSystemInfo({2           success: function(res) {3             if(res.SDKVersion>=\"2.1.0\"){4               self.setData({5                 exitApp:true//data中的初始化变量6               })7             }8           }9         })1 <navigator wx:if=\"{{exitApp}}\" open-type=\"exit\" target=\"miniProgram\">关闭按钮navigator>2 <navigator wx:else open-type=\"navigate\" target=\"navigate\" url='../../index/index'>返回首页navigator>如果是首页那么就直接不处理这个返回退出了。注：由于不是API所以不能使用wx.canIUse(string)的方式进行判断了所以只能通过获取系统信息的方式获取小程序基础库版本以此来判断。对于小程序基础库版本分布可以查看官方统计说明：基础库版本分布。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序Page对象重写               适用于小程序的 ES6                                                        原作者: 逍遥云天                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "新能力！小程序直播开始公测，无门槛免费使用，一天便可开发完成？ ... ", "author": "                  Rolan                  2020-2-19 00:31                ", "text": "                                                                                                                                                                                     万众期待的小程序直播终于来了。据晓程序观察（yinghoo-tech）了解小程序官方直播组件已经开启公测部分商家已收到公测邀请商家通过直播组件可以在小程序中实现直播互动与商品销售的闭环。值得注意的是这是微信推出的首个小程序官方直播能力是微信提供的一项底层能力。此前被部分商家误解为“微信直播”的腾讯看点直播其官方资料显示是腾讯PCG基于微信开放能力推出的直播能力。这次微信自己的小程序直播是真的来了也是首次这么明确支持商家直播。小程序直播此时现身时间背景值得“玩味”就是如今的疫情大背景。要知道去年年初开始就有不少商家、企业“呼吁”小程序直播能力希望能在小程序上捧红自己的李佳琪。因为微信流量大、用户黏性高、平台内容多天然具备用户看直播的场景而小程序入口多、转化力强与直播结合是个天然的带货组合。微信的能力发布不会因为用户或者商家的单方面需求还会考虑场景和时机等因素。此前所有人都盼着小程序直播的到来但它迟迟未现身如今却不请自来了目的不言而喻。眼下线下企业受损严重一位不愿具名的品牌方直言目前旗下线下90%以上店铺闭店基本无销售。而直播能带来一定的收益扭转颓势。要知道去年双11期间就有线下门店导购直播出圈把线下多年练就的本领转化到线上实现了销售总体增长24.2%的业绩。微信推出小程序直播可以看出就是希望在眼下这种关键时刻通过能力释放让危机中的商家更好地卖货探索扭转颓势的方法。1关键词：高效、高效、高效！“我们差不多一天开发就完成了开发”。一位参与公测的百货商家对我们表示。如此快速的开发效率原因有两点。首先小程序直播组件是一款小程序插件商家引入直播组件代码包后只要进行简单的适配便可以开发完成。值得注意的是基础库版本2.9.1及以上的小程序才能运行该插件因此想开发该能力需先保证小程序在该版本及以上。此外商家还可以根据自身情况调取订阅组件、直播回放获取、直播间状态和直播列表等接口。第二点就是完全没有直播资质要求。目前小程序直播支持两大类目。小程序商家为“商家自营”类目下的以下12个垂直品类。具体而言就是百货、食品、初级食用农产品、服装/鞋/箱包、酒/盐、玩具/母婴用品(不含食品)、家电/数码/手机、美妆/洗护、珠宝/饰品/眼镜/钟表、运动/户外/乐器、家居/家饰/家纺、办公/文具。电商平台类目。上述两大类目的商家完全无需资质上传自动检测数据符合标准直接可见入口堪称“最快捷操作”。值得注意的是使用小程序直播插件无需单独的直播资质即《信息网络传播视听节目许可证》《电信与信息服务业务经营许可证》。有商家对我们表示“这等于免资质申请要知道那个《信息网络传播试听节目许可证》早就不发给新公司了而且有效期只有3年。以前碍于没有直播资质所以没法做现在微信提供的这个直接帮我们把问题解决了”。据晓程序观察（yinghoo-tech）了解微信能提供这样的服务是因为小程序直播是由腾讯提供资质背书也提供了安全检测能力帮助服务商解决了无资质的难题。这样的效率提升对眼下大部分的商家而言是个好消息眼下线下店亏损严重快速开发线上直播功能需求旺盛。开发效率越高意味着他们可以越快启用线上直播扭转业务颓势。完成开发后商家可以在PC端的MP管理后台实现直播的功能管理、运用如创建直播间、添加商品、查看数据等。主播则通过「主播端」小程序进行直播。用户在小程序上就可以观看直播内容了。“整个流程大概20分钟就能熟悉起来可以说是傻瓜式操作非常快速了”。上述商家总结。在参与公测的商家看来小程序直播插件从审核到开发到运营最大特点就是高效。2腾讯看点直播VS小程序直播怎么选？今年春节期间借助疫情的推动很多商家都开始将精力倾斜于微信生态包括尝试小程序分销、开启社群运营等而对于私域流量的运营直播也是其中一个需求。由于小程序官方的直播能力此前未上线不少人在需求的推动下先使用了腾讯看点直播这个基于App+小程序+直播的解决方案。一位资深电商从业者表示行业中的直播工具很多但作为商家多方尝试的成本几乎可以忽略不计因为一旦找到最适合自己的工具后得到的回报也会更多。“很多商家都会愿意尝试小程序直播的这和商家重视私域流量的趋势是一致的。”小程序直播和腾讯看点直播有什么区别？商家应该怎么选？晓程序观察（yinghoo-tech）做了一次评测。1、流量运维PK：小程序直播可以玩转私域流量无论在线上开店还是线下开店流量都是第一考虑要素。线下开店需要考虑位置能否带来客流。线上直播也一样。相比之下腾讯看点直播是平台更像一个“电视台”由App和小程序两部分组成商家在腾讯看点直播App上开直播间通过社群传播、客服朋友圈发布小程序码海报等方式将流量吸引到腾讯看点直播小程序上进行直播转化。而小程序直播是嵌入在商家自己的小程序里的功能商家小程序流量多直播就有流量小程序运营得越好直播的流量就越大换言之流量多少完全看自己怎么运营。换言之对于商家而言使用腾讯看点直播就需要将自己的私域流量导上腾讯看点直播平台再进行转化而小程序直播则是在商家自己的“底盘”——小程序上进行流量运营。这样的区别在私域流量的运营上显得尤为明显。腾讯看点直播的平台定位决定了对于直播过程中裂变来的新流量并且还无法直接关注公众号商家想将其沉淀到私域流量中几乎只有一个办法那就是在直播过程中的晒出微信号的方式引导腾讯看点直播用户沉淀到客服号、社群上进行私域流量沉淀。但这种私域流量的引导方式场景割裂感较强。小程序直播则是商家自己小程序内的功能。通过公众号+社群+小程序直播的方式可以无缝地运营私域流量。公众号可以推送文章植入小程序直播通知引导粉丝进入小程序看直播；在商家社群分享里分享小程序直播页面的卡片触达粉丝；粉丝进入小程序直播后观看内容进行转化。整条链路所有节点都在商家自己的“场地”上。而直播过程中裂变来的新流量自动成为商家小程序的用户商家可以在小程序里诸多场景中引导用户关注公众号或沉淀到社群。此外通过用户在小程序上的行为分析商家可以更好地了解用户实现精细化运营。据了解完美日记、热风、Lily女装等多个品牌已经通过公众号+群+小程序直播的方式进行社群粉丝直播营销并达到了不错的销量。“从直播到购买再到私域流量沉淀每一步都是一次‘漏斗’筛选的过程转化有限。”一位商家对我们表示整个过程越流畅越有利于私域流量的沉淀。总的来说由于腾讯看点直播的平台属性和和小程序直播的小程序“内置功能”的定位区别两者在流量上的优势大有不同：腾讯看点直播的优势是对现有流量进行转化对于私域流量的进一步沉淀缺乏有效途径小程序直播加上社群和公众号的组合拳可以对私域流量做一次全面的盘活为精细化运营铺路。2、边看边买&沉淀用户数据：小程序直播两手抓腾讯看点直播难两全一个好的销售都知道用户如果“出去逛逛再回来”就意味着该用户大概率会流失最好的办法就是让他在店内立刻转化。这一点上腾讯看点直播和小程序直播都可以实现小程序内的边看边买无需跳转但具体上却有很大不同。先看小程序直播是在商家自己的小程序里边看边买为用户提供了购物车功能用户可以在小程序里直接购买商品也可以将商品加入购物车打包购买整个流程不需要跳转非常流畅。另一边的腾讯看点直播情况却有些“复杂”：由于腾讯看点直播是平台所以商家需要在腾讯直播合作伙伴商城开一个店铺如微店然后将店铺内商品挂接到直播间即可实现小程序内边看边买的流畅用户体验。这一种也是大多数商家选择的方式。但一些本身有小程序的商家对这种直播带货的方式自然非常不感冒因为如此一来所有的流水和用户购买数据就都不在自己的平台上了。为此腾讯看点直播给出的解决方案是这类商家可以申请跳转自己的小程序商城让用户从腾讯看点直播跳转至自己小程序下单。但这种操作有几点值得注意：这样的操作对用户来说购买步骤比小程序内直接下单要多出一步跳转因此流失率可能会增加不少商家表示不会选择这种操作路径；由于小程序跳转次数存在限制由此种方式接入的直播在跳转回商家小程序时也可能存在限制；如若跳转直播排期需提前申请等待看点直播小助手审核通过。从这一环节看虽然都能实现边看边买但小程序直播的整个用户操作链路都在商家小程序上商家可以自行决定直播的时间、形式等自由度更高并且用户的购买记录、浏览记录均可以很好地沉淀可谓一举两得。而腾讯看点直播对于商家而言维系良好的用户体验就意味着所有数据都在腾讯看点直播平台上而引导用户到商家小程序则得付出用户流失率上升的代价并且直播排期不可控自由度相对较低。3、多位营销工具PK：腾讯看点直播瞄准转化和裂变小程序直播强调粉丝精细化运营在线下用户的购买转化率极大程度依靠导购的专业素质和商品本身的质量和折扣活动。而在线上直播场景想完成这一任务就需要能提高主播和用户互动的营销工具必不可少。腾讯看点直播在营销工具上主打优惠券能力：单品券:主播可将特定优惠券与直播中的商品相结合选择单品券进行发放吸引粉丝购买；全场券:主播可发放全场通用；分享领券主播可发布分享领券任务粉丝只需邀请一位好友进房好友进房后分享者和被分享者才会出现领券画面点击屏幕即可领取。小程序直播的营销工具目的则更为多样：抽奖：用户点击可参与评论or点赞参与抽奖获得兑奖码进行兑换中奖后可一键授权地址等信息用户体验流畅的同时商家节省运营精力。目前官方没有提供优惠券能力但是商家可以直接将优惠券添加到商品列表并置顶直播过程引导用户领取。总的来说相比之下可以看到由于小程序直播的是商家与自己粉丝的一种内容互动形式因此营销工具的目的更多包含互动、留存、转化等适合粉丝精细化运营进而实现转化总的来说更适合全用户生命周期的运营；而腾讯看点直播是平台流量为平台流量优惠券能力方面更强调快速变现和裂变长线价值优势不明显。4、提高留存率：两家都有“王牌”订阅消息对于任何商家而言留存率等于用户的回头率。在这一点上无论是腾讯看点直播还是小程序直播都纷纷祭出了「订阅消息」这个“王牌”功能。「腾讯看点直播」小程序首页会按时间排列预约信息。用户预约直播后当直播开始时微信会向观众发送「服务通知」提醒直播即将开始。小程序直播也一样商家在MP后台直播间内接入订阅组件后用户在直播间内点击“开播提醒”便可以进行订阅主播开播后用户将会收到一条模板消息提醒直播已开播。“这个功能是重大利好”一位尚未被公测但对小程序直播功能跃跃欲试的商家表示订阅消息功能在触达与唤醒用户上非常高效可以有效提升用户留存。5、收费VS免费目前腾讯看点直播是收取服务费方式其服务商目前统一收取 599 元/半年的官方技术服务费而小程序直播组件不向商家收费。值得注意的是无论是直播还是小程序都是商家的数字化探索在疫情大背景下数字化变得越来越重要。在小程序直播场景中商家也被给予了一些数据辅助能力主播直播的时候可以随时查看用户点赞评论情况、开奖直播结束后可查看本场直播数据。根据数据的情况商家可以针对性地进行直播调整和规划。总的来说腾讯看点直播和小程序直播双方的定位有所不同受众不同因此优势和特点也不同：小程序直播的优势是流量和流水都在自己的小程序上从观看到购买整个闭环都在商家自己的小程序上体验流畅从商家自身的资产出发帮商家第一次真正完成了直播和小程序商城的融合以及对私域流量进行了更全面的运维适合有小程序的商家；而腾讯看点直播则是针对没有小程序的无线上能力的小白玩家为他们提供一套无需任何技术操作便可以实现直播+带货的工具。为了方便大家了解我们做了一张表格：一位电商运营者表示“眼下小程序直播还只是个雏形未来还会上线什么功能值得期待”。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信紧急征集这四类小程序让你的小程序被更多人搜到                                                                       原作者:  Miss豆教授                   来自:  晓程序观察                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "支付宝英雄帖发布首周超1200位开发者报名：首批181款小程序已开发或上线 ... ", "author": "                  Rolan                  2020-2-16 00:02                ", "text": "                                                                                                                                                                                     全民积极响应国家抗击新冠肺炎疫情的号召正催生出越来越多新的互联网服务缺口。基于对用户、政府、企事业单位抗疫服务需求的紧缺情况调查支付宝于2月6日面向社会各界开发者发布“10大疫情期最急需服务开发清单”号召更多开发者投入进来开发更多服务解决社会问题。今日支付宝官方发布消息称 发布“英雄帖”不到一周的时间已有超过1200位个人开发者和服务商报名参战投入开发用户和机构急需的疫情服务相关小程序。其中首批报名者开发的服务中已有181款疫情小程序进入开发流程或已上线开始为用户和机构需求方提供疫情信息智能问答、疫情统计、心理咨询、紧急物资调度等服务。支付宝相关人士表示抗击疫情期间优质服务商的自研小程序和小程序模板在帮助政府和企事业单位迅速上线疫情服务上发挥了巨大的价值。 经筛选初期已有58家优质服务商的抗疫小程序已进入了开发流程服务涵盖了政务民生类、法律服务、医疗类、公益类、疫中便民生活类、物流配送类、疫中疫后恢复商家经营类等几大刚需场景。 服务商开发的小程序模板可以让机构需求方经过简单配置就上线一款自己的小程序。1月27日支付宝推出“疫情服务直通车”整合了疫情直播、紧急寻人、谣言粉粹机、权威解读等功能和“问查看吃买办”6大类不出门就可以使用的刚需服务。 目前累计已有近3亿人通过“疫情直通车”获取疫情相关服务。目前支付宝“英雄帖”还在持续招募疫情相关服务相关的开发者和服务商并提供亿级流量和技术资源扶持及现金奖励有意参与共抗疫情解决社会需求缺口的开发者可登录“支付宝开发者中心”疫情专题页面报名。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    国务院推荐微信到家业务微信预告新能力协助零售行业商家战“疫” ...               微信开放“智慧零售”入口每日优鲜、优衣库等商家接入                                                        原作者: 快科技                   来自: 快科技                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信开放“智慧零售”入口，每日优鲜、优衣库等商家接入 ", "author": "                  Rolan                  2020-2-18 00:02                ", "text": "                                                                                                                                                                                     36氪从知情人士处获悉2月18日起微信支付页面中间栏将开放“智慧零售”入口\t深圳地区用户可通过微信客户端“我-支付-腾讯服务-智慧零售”访问腾讯智慧零售小程序已接入商家包括每日优鲜、永辉、优衣库、沃尔玛等。智慧零售入口的放量是逐步扩大的\t今日起在深圳落地此后陆续在北京、上海、广州、成都、重庆等地上线。 据了解腾讯智慧零售微信入口曾在2019年11月福州地区小范围测试。从小范围测试到逐步全量开放腾讯智慧零售开始全面发力。以每日优鲜为例用户进入微信支付页面可在腾讯服务入口点击“智慧零售”进入后可浏览距离最近的前置仓商品及活动信息并在微信内完成购物闭环。据知情人士透露这一入口还将给优质零售企业更多的展示机会\t为腾讯智慧零售的线上线下合作伙伴带来更多流量利好。值得一提的是在微信这一波流量到达之前入驻商家中生鲜到家类服务（每日优鲜、永辉）在疫情期间已经出现了订单量的高速增长。据微信官方数据除夕到初六永辉生活到家业务福州地区订单同比增长率超过450%销售额同比增长超过600%。2月1日永辉超市到家服务全国订单量春节期间首次突破20万单销售额突破2000万元。同一时段每日优鲜小程序相比去年同期的订单量则增长309%实收交易额增长465%客单价上涨至120元。仅初一当天订单量较去年涨幅增加227%。永辉早在2018年9月就是腾讯智慧零售的样本每日优鲜和腾讯智慧零售的合作也已有开端。2019年6月腾讯智慧零售及每日优鲜共同启动每日优鲜“智鲜千亿计划”——\t计划在2021年实现千亿GMV 。这是一个不小的挑战。除了智慧零售入口逐步开放带来的微信流量永辉及每日优鲜还共同应用了腾讯智慧零售的开放能力——包括营销能力通过圈层视图工具实现精准投放和社交裂变；物流助手帮助精准选址及优化配送路径；以及通过消费大数据指导上游选品。这不是微信第一次开放入口直连商家。2019年10月底微信一级购物入口切换为京东社交电商“京喜”2020年京喜的目标是“大几千万的月活用户数”。据了解在切换到微信一级购物入口的两个多月京喜的复购率较以往已提升不少。社交电商之后\t腾讯智慧零售入口增加了极速到家、大牌好店、出门逛街等类目 。智慧零售板块进入微信支付入口也是微信生态服务体系的进一步完善。2020年微信释放的一系列信号及能力都围绕连接内容及服务展开。\t在微信2020年展望中已有分析 ：在内容生态上公众号求变、视频号补位；而在服务生态上一个区别于早期淘宝的电商交易体系正在形成一个更具象的描述是一个以消费者和零售企业本身为核心的社交电商体系也在逐步建立。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    支付宝英雄帖发布首周超1200位开发者报名：首批181款小程序已开发或上线 ...               微信小程序直播能力开启公测 疫情下助推商家卖货                                                        原作者: 高歌                   来自: 36kr                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序实战教程——2实战之模仿知乎 ", "author": "                  Rolan                  2019-6-25 00:42                ", "text": "                                                                                                                                                                                                                                                                 除了小程序项目中自带的文件夹我引入了几个新的文件夹：.vscode文件夹存放vscode编辑器的配置文件。components文件夹存放组件。images文件夹存放公共图片。Mock文件夹存放使用MockJS模拟后端接口的类。models文件夹存放封装好的请求类。utils文件夹存放公共类。接下来我以首页为例进行分析其他页面也都类似。建议能力较强的小伙伴先把 项目 下载下来自己先尝试着根据效果图实现代码做完之后再回来看与我的思路有哪些不同。2 起步2.1 布局与样式这个页面中每一条记录都是相同的所以可以抽象为一个组件在components文件夹下面创建一个组件wxml与wxss比较简单不做过多讲解。//wxml<view class=\"container-item\">    <view class=\"item-title\">        <text>{{items.title}}</text>        <image src=\"./images/more.png\"></image>    </view>    <view class=\"item-author\">        <image src=\"{{items.imgUrl}}\"></image>        <text>{{items.author}}</text>    </view>    <text class=\"text-body\">{{items.content}}</text>    <view class=\"item-action\">        <text>{{items.starNum}}</text>        <text>赞同</text>        <text>{{items.reviewNum}}</text>        <text>评论</text>    </view></view>//部分scss$border-color:#dfdfdf;.container-item {  padding:10rpx;  display: flex;  flex-direction: column;  width: 100%;  background-color: #fff;  margin-top: 10rpx;  border-top: 1px solid $border-color;  border-bottom: 1px solid $border-color;}复制代码2.2 子组件与父组件的粒度大小子组件需要监听两个事件分别为触摸该子组件时跳转到该问题的回答的详情页面以及触摸右上角的三个点跳转到该问题的详情页面。第二个事件触发的同时会冒泡并触发第一个事件所以监听第二个事件的时候需要采用catch前缀监听并阻止事件冒泡。完整代码如下。<view class=\"container-item\" bind:tap=\"clickItems\">    <view class=\"item-title\">        <text>{{items.title}}</text>        <image src=\"./images/more.png\" catch:tap=\"clickMore\"></image>    </view>    <view class=\"item-author\">        <image src=\"{{items.imgUrl}}\"></image>        <text>{{items.author}}</text>    </view>    <text class=\"text-body\">{{items.content}}</text>    <view class=\"item-action\">        <text>{{items.starNum}}</text>        <text>赞同</text>        <text>{{items.reviewNum}}</text>        <text>评论</text>    </view></view>复制代码抽象出子组件并不难难的是如何设计子组件与父组件的粒度大小在上面的例子中子组件监听了触摸事件这时候是由子组件执行wx.navigateTe()还是由父组件执行这才是我们最需要考虑的问题我的想法是子组件只控制样式的变化不执行业务逻辑业务逻辑我一律交给父组件来做。下面代码参考 微信小程序实战教程——1基础知识 5.2.2//子组件中将index传给父组件让父组件执行业务逻辑methods: {    //打开回答详情    clickItems() {      let index=this.properties.index;      this.triggerEvent('clickItems',{index});    },    //打开问题详情    clickMore() {      let index=this.properties.index;      this.triggerEvent('clickMore',{index});    }}//父组件中监听子组件准备触发的事件并执行业务逻辑//wxml<view class=\"container\">    <block wx:for=\"{{items}}\" wx:for-item=\"v\" wx:for-index=\"i\">        <index-items items=\"{{v}}\" index=\"{{i}}\" bind:clickItems=\"clickItems\" bind:clickMore=\"clickMore\"></index-items>    </block></view>//js//点击回答打开详情clickItems(event) {    //取出子组件传来的index表示被点击的子组件的下标    let index=event.detail.index;    let id=this.data.items[index].id;    wx.navigateTo({      url: '/pages/detail/detail?id='+id    });},//点击打开问题详情clickMore(event) {    let index=event.detail.index;    let id=this.data.items[index].id;    wx.navigateTo({      url:\"/pages/problem/problem?id=\"+id    });}复制代码2.3利用Mock制作虚拟数据分析首页可以得知每条记录需要一个id、标题、作者头像、作者名、正文内容、点赞的数量以及回复的数量。在Mock文件夹下创建一个indexMock.js文件专门为首页提供虚拟数据。//indexMock.jslet Mock = require('./mock-min.js');//引入Mockconst Random = Mock.Random;class IndexMock {    constructor() {}    //返回首页记录模拟数据    getIndexList() {        return Mock.mock({            'status': '0',            'msg': '',            'data|10': [{                'id': '@guid()',   //id                'img': Random.img('16x16', '#4A7BF7','#000','@word(1,2)'),   //头像                'title': '@ctitle(1,8)',                    //标题                'author':'@word(1,8)',                     //作者                'content':'@cparagraph(1)',                 //正文                'star_num': '@integer(0,10000)',            //点赞数量                'review_num':'@integer(0,1000)'            //回复数量            }]        });    }}export { IndexMock };复制代码2.4 封装AJAX请求微信小程序提供了wx.request()接口发送网络请求这是十分常用的API封装后我们可以省去很多的代码量。//不封装直接使用我们发送一个AJAX请求需要大量代码wx.request({    url:\"\",    data:\"数据\",    method:\"请求方式\" //有GET、POST、PUT等值    dataType:\"返回数据类型\",//默认为json字符串    header:{        //请求头        },    success() {        //接口调用成功的回调函数    },    fail() {        //接口调用失败的回调函数    },    complete() {        //接口调用成功/失败都会执行的回调函数    }});复制代码在utils文件夹中创建一个HTTP.js文件在这里对wx.request进行一次封装class HTTP {    constructor() {}    request(params) {        //默认值处理,url不允许为空        if(!params.url) {            console.log('url没有传入');            return;        }        //method默认为GET        if(!params.method) {            params.method='GET';        }        wx.request({            url:params.url,            method:params.method,            data:params.data,            header:{                'content-type':'application/json'            },            success:res=> {                let code=res.statusCode.toString().substr(0,1);                //http请求状态码为2开头的时候判断为请求成功                if(code==='2') {                    params.success && params.success(res.data);                }                //状态码不为2开头如5开头的则判断为请求失败                else {                    params.error && params.error(res.data);                }            },            fail:()=> {                console.log('ajax error');            }        });    }};export {HTTP};复制代码现在我们发送一个AJAX只需要传入url、data、method为GET时可以省略、success方法以及error方法。仍然需要传入很多参数这时候可以对每一个具体的AJAX请求做一个封装。在models文件夹中创建首页发送AJAX的文件indexModels.js在这其中对首页使用到的AJAX请求进行第二次封装。import {HTTP} from '../utils/HTTP.js';import {IndexMock} from '../Mock/indexMock.js' ;let indexMock=new IndexMock();class IndexModels extends HTTP{    constructor (){        super();    }    //请求首页真实数据    getIndexList(data,success) {        let params={            url:'http://xxx.com/Index/List',            //请求数据使用GET请求method不需要设置            data:data,            success:success        };        this.request(params);    }    //请求首页模拟数据    getIndexListByMock(data,success) {        let list=indexMock.getIndexList();        success && success(list);    }}export {IndexModels};复制代码在页面中引入indexModels.js文件后new一个类即可调用getIndexListByMock方法此时只需要传入data与success方法。2.5 简化Mock的副作用使用Mock之后总是要切换回真实数据的这时候在页面中的每一个AJAX请求都需要更改太过繁琐这时可以考虑引入一个全局常量只修改这个常量即可实现Mock数据切换为真实数据。在最外层创建一个config.js文件定义一个常量用于控制数据来源是Mock数据还是真实数据。const DEBUGGER=true;export {DEBUGGER};复制代码在indexModels.js文件中引入config.js使用常量DEBUGGER来判断使用哪个来源的数据indexModels.js改变为：//DEBUGGER为true表示请求虚拟数据为false表示请求真实数据import {DEBUGGER} from '../config.js';import {HTTP} from '../utils/HTTP.js';import {IndexMock} from '../Mock/indexMock.js' ;let indexMock=new IndexMock();class IndexModels extends HTTP{    constructor (){        super();    }    //请求首页数据    getIndexList(data,success) {        if(!DEBUGGER) {//请求真实数据            let params={                url:'http://xxx.com/Index/List',                data:data,                success:success            };            this.request(params);        }        else {//请求虚拟数据            let list=indexMock.getIndexList();            success && success(list);        }    }}export {IndexModels};复制代码之后需要改变数据来源为真实数据时只需要在config.js中将DEBUGGER改变为false即可。至此这个页面就已经写完了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序实战教程——1.基础知识               小程序、H5登录授权、分享、支付流程                                                        原作者:  再见骷颅王                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信紧急征集这四类小程序，让你的小程序被更多人搜到 ", "author": "                  Rolan                  2020-2-19 00:25                ", "text": "                                                                                                                                                                                     小程序已经成了大家战“疫”不可或缺的得力帮手。了解疫情发展、预约和购买口罩、购买生鲜时蔬等需求都可以在小程序上实现。目前物流服务、到家自提服务、医疗服务和电商服务类目的小程序用户需求较大为了帮助用户更方便地获取疫情期间所需资讯与服务微信小程序开辟了“疫情专区”专区现紧急征集四类小程序接入！服务展示形式相关申请提交并审核通过后开发者的小程序将有机会在小程序搜索-疫情服务专区中展示获得微信官方的免费流量入口扶持：1小程序搜索-疫情专区用户点击“发现-小程序”搜索或在微信首页下拉打开任务栏搜索时输入疫情相关的关键词如“新冠疫情”、“发热问诊”、“生鲜配送”等将直达小程序“疫情服务专区”；小程序搜索将根据用户的搜索意图匹配对应的疫情相关服务如搜索“发热问诊”会优先展示“疫情服务”等相关结果；搜索“生鲜配送”会优先展示“餐饮生鲜外送”等相关结果。2安卓小程序发现页（灰度中未全量）安卓灰度用户可在发现页-小程序-疫情专区查看对应服务。开放类目及入驻标准目前用户使用频率较高的物流（快递+同城）服务、到家自提服务、医疗服务和电商服务（包括滞销农产品与疫情应急商品）四个类目已开放申请更多类目将持续接入。1物流（快递+同城）目前物流（快递+同城）服务开放类目为快递业与邮政。2到家自提服务到家自提服务已开放商家自营-食品、生活服务-百货超市便利店、餐饮-外卖平台等7个类目。3医疗服务医疗服务已开放医疗-公立医疗机构、医疗-互联网医院、政务-医疗3个类目。4电商服务 包括滞销农产品与疫情应急商品滞销农产品与疫情应急商品作为当下电商行业的重中之重可申请入驻“疫情专区”。电商服务审核通过后商家应按照入驻标准及平台规则及时发货、审核售后单避免购物纠纷若产生严重投诉平台将按《微信小程序实物交易争议处理规则》等规则作相应处理。更多关于各服务的开放类目和具体入驻标准开发者可前往“微信行业助手”公众号菜单栏“疫情专区”查看：申请流程长按识别下方二维码关注微信行业助手公众号点击菜单栏疫情专区选择对应行业即可报名。微信小程序团队将在3个工作日内反馈申请结果。长按识别二维码希望我们的每一行代码都能帮助到更多人。这场战“疫”我们共同努力。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序直播能力开启公测 疫情下助推商家卖货               新能力！小程序直播开始公测无门槛免费使用一天便可开发完成？ ...                                                        原作者: 微信公开课                   来自: 微信公开课                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序直播能力开启公测 疫情下助推商家卖货 ", "author": "                  Rolan                  2020-2-18 00:07                ", "text": "                                                                                                                                                                                     　　新浪科技讯 2月17日下午消息据商家爆料收到小程序直播公测邀请相关邀请站内信显示小程序直播组件是微信官方提供的商家经营工具商家通过直播组件可以在小程序中实现直播互动与商品销售的闭环。　　在2020年1月9日的微信公开课PRO上微信小程序交出三周年成绩单： 2019年小程序日活超3亿累计创造8000多亿交易额同时预告即将推出最新的官方小程序直播组件。　　通过商家爆料信息可知直播组件是微信向B端商家提供的一项能力。新浪科技了解到微信小程序直播画面为竖屏观看形态画面内提供了展示商品、点赞、评论、抽奖、优惠券、购买、数据展示等能力而目前收到公测邀请的商户可以在小程序后台直接开通直播能力。　　综合来看微信小程序直播的主要优势除了庞大的微信用户体量和社交优势外还有一个重点：流程在商家小程序内闭环无需跳转其他小程序或App。据了解小程序直播支持最快一天开发完成、免资质申请。疫情爆发以来已有商家通过公众号+群+小程序直播的方式进行社群粉丝直播营销。　　新冠肺炎疫情爆发以来为抗击疫情各行各业纷纷推出“无接触服务”直播受到较大关注。2月15日商务部办公厅发布的《关于进一步做好疫情防控期间农产品产销对接工作的通知》就鼓励电商企业通过直播等带动农产品销售。在疫情背景下小程序直播的推出成为商家发展的新机遇同时也会助推小程序电商生态的进一步扩张。　　今日早些时候微信发布了《微信战“疫”数据报告》涉及从小程序到家业务、无接触服务、疫情动态、远程办公、在线教育等多方面数据。当中披露截至2月14日小程序超市业态访问量同比增长115%生鲜果蔬业态访问量同比增长168%社区电商业态同比增长83%。复工后物流行业小程序访问量环比上涨68%。（李楠）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信开放“智慧零售”入口每日优鲜、优衣库等商家接入               微信紧急征集这四类小程序让你的小程序被更多人搜到                                                        原作者: 新浪科技                   来自: 新浪科技                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "国务院推荐微信到家业务，微信预告新能力协助零售行业商家战“疫” ... ", "author": "                  Rolan                  2020-2-16 00:12                ", "text": "                                                                                                                                                                                     近日国务院联防联控机制召开新闻发布会介绍疫情防控中重要生活物资生产保供有关情况。会上国务院商务部市场运行司副司长王斌向全国市民发出倡议：大家尽量少出门生鲜物资可以在微信下单购买。疫情阴影下微信下单生鲜到家已经成为了市民在家隔离购买基础物资的首选也成为商家做线上经营的标配。并且目前大部分生鲜到家业务都支持送货上门到小区“无接触配送”不需要到店自取。据微信官方数据显示从除夕到2020年大年初七小程序生鲜果蔬业态交易笔数同比增长149%社区电商业态交易笔数同比增长322%。目前数据还在持续增长中。诸多零售品牌如步步高、永辉、每日优鲜、天虹、兴盛优选、百果园等都通过小程序到家业务获得了不错的经营效益。微信官方也为零售行业商家准备了小程序到家业务经营的十二个武器。小程序到家必用的六大免费流量疫情之下微信平台积极为用户提供战“疫”服务同时也帮助更多商家做好经营2月15日微信梳理了目前零售商家可用的六大免费流量入口并宣布小程序搜索专区和支付后直达到家小程序能力将在近期上线。1、小程序搜索多个专区微信官方表示为了帮助用户更方便地在微信内找到生鲜到家商品、疫情紧缺物资将在下周上线微信小程序搜索“到家自提专区”、“疫情紧缺物资专区”及“滞销农产品专区”直接展示相关小程序。如果商家提供了生鲜食品、口罩、消毒液、消毒酒精等疫情防控商品或滞销农产品可留意微信开放社区的报名通知也可通过微信行业助手公众号留下小程序资料及联系方式入选的小程序将会被展示。2、支付后直达到家小程序微信支付即将针对各行业到家服务小程序推出快速触达能力用户在线下商户微信支付后可快捷进入该商户到家小程序引导用户使用无接触的购物方式。除了2个即将上线的新能力微信官方还有这4个现有的免费流量入口可以助力零售行业商家发展到家业务：3、附近的小程序基于地理位置微信“附近的小程序”能力可以让商家的小程序直接免费曝光在用户的“附近的小程序”入口拉新能力强。用户往往会选择周边的商户来下单商家通过在微信公众号后台将已有的小程序设置到“附近的小程序”即可为门店5公里的用户提供服务还可以通过“优惠券”来吸引用户促成交易。4、我的小程序“我的小程序”不需要成本是用户所有使用的小程序中留存最高的一个入口商家可以重点关注。餐饮、到家业务的商家可以引导用户将小程序添加到“我的小程序”即可实现用户在微信首页下拉窗口中直达“我的小程序”实现快速访问。5、搜索微信搜索是小程序非常有潜力的一个入口。餐饮、到家业务的商家可通过后台的搜一搜入口配置品牌官方区及服务即可被用户搜索直接获得曝光与交易的机会还能强化用户对品牌的认知。6、企业微信与微信互通能力企业微信已经与微信小程序打通注册了企业微信的企业可通过「客户联系」「客户群」等互通能力将到家服务等小程序一键转发给微信里的顾客直接触达为顾客提供专业、有温度服务。小程序到家的五大运营工具面对商家使用到家小程序存在的一些运营问题微信官方也给出了五大运营工具希望可以帮助商家提高经营效益提升到家业务能力。1、微信群微信群+小程序让微信群可直接帮小程序转化。商家可以通过团长与门店附近的小区住户快速建立微信群提供定时在线点餐、发起团购食材、推送优惠信息、推出速食食品等服务还能根据不同区域和用户属性推荐不同商品拉动交易。2、小程序订阅消息及时性强、留存高的小程序订阅消息可将点餐配餐进程信息、送餐及配送信息、优惠券过期提醒等重要信息便捷有效地通知用户。3、微信物流助手-即时配送能力微信官方表示商家可通过此能力统一对接顺丰同城急送、闪送、达达快送和美团配送四家配送公司节省工作量。还可通过微信物流服务通知给用户发送配餐情况、配送员实时位置信息提供回访小程序能力。4、微信导购助手微信导购助手可以帮助商家主动向服务号粉丝发起一对一的沟通更有温度、人性化还可以盘活现有服务号粉丝精准实现转化。5、微信行业助手微信官方推出的微信行业助手小程序可以帮助商家免费学习运营工具、全方位提升经营能力。商家的小程序管理者、运营者、开发者都可使用可以对比自己的小程序与同行业的情况了解行业最新的玩法。到家小程序助力零售业务提升线上经营效率高效战“疫”作为参考微信官方也公布了一批通过到家业务提升了经营效率的品牌运营数据并提供了相对应的业务模式希望可以给广大商家提供业务经营上的借鉴。1、小程序名称：步步高better购业务模式：超市+微信群+小程序运营效果：1月29日步步高超市正式上线“小步到家”服务采取微信社群集单在小程序下单、商品由步步高总仓直发模式目前已在长沙、株洲、湘潭、益阳等城市开团。2020年1月步步高到家的多业态订单量环比增长3倍同比增长10多倍。2、小程序名称：YH永辉生活+、永辉买菜业务模式：超市+小程序“无接触配送”+订单集中配送运营效果：疫情期间永辉超市到家服务在全国门店上线“无接触配送”以小区为单位集中配送订单。除夕到初六永辉生活·到家福州地区订单同比增长率超过450%销售额同比增长超过600%。2月8日单日永辉超市包括小程序在内的多平台到家服务全国订单量首次突破30万单。3、小程序名称：每日优鲜水果生鲜买菜外卖业务模式：生鲜O2O平台+小程序+微信群+腾讯智慧零售圈层咨询运营效果：每日优鲜运用大数据能力提前做好配送资源和运力的调配同步调整商品供应信息保障配送。疫情期间每日优鲜小程序到家和社群下单交易额同比增长300%以上用户还通过微信群帮助小程序自发传播。4、小程序名称：天虹业务模式：超市+小程序+社区接龙购物运营效果：天虹在配送方式上新增“一对多”配送方式按社区分类配送用户下楼自提。同时与多个超市周边物业推进社区接龙购物服务提前对接购物清单。春节期间各门店销售占比比平时提升了1倍以上部分门店达到40-50%。广东地区天虹超市到家订单量增加近3倍销售增长超2.5倍。5、小程序名称：兴盛优选业务模式：小程序+社区电商运营效果：兴盛优选和部分武汉小区物业合作召集团长后发货到小区由顾客按号码上提取点自提。目前兴盛优选已经完成300个社区的配送服务覆盖近30万户社区家庭。不少门店单日的订单量突破3000单。其中武汉万科金域蓝湾中央花园店单日订单达到了6300单。6、小程序名称：百果园+业务模式：门店+微信群+小程序+会员码运营效果：百果园在微信群内实现活动触达、商品接龙；同时使用微信小程序到家+会员码+微信群完成转化。目前百果园小程序到家渠道同比增长5倍。社区接龙到点促进交易部分单店一天能够通过社群卖出一两万元的商品。除了以上案例微信开放社区的服务平台最新上线了“餐饮零售”疫情专区商家可前往了解更多案例详情商家也可以在疫情专区与服务商快速对接完成到家自提小程序的上线。同时微信也欢迎更多服务商入驻微信服务平台。未来微信将密切关注疫情和零售到家业务的发展持续推出新能力新措施协助零售行业商家提供优质的小程序到家服务共同战“疫”！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    支付宝刚刚发布的“抗疫召集令”开发者能“捞到”啥好处？ ...               支付宝英雄帖发布首周超1200位开发者报名：首批181款小程序已开发或上线 ...                                                        原作者: 途小萌                   来自: 品途网                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "京东购物小程序cookie方案实践 ", "author": "                  Rolan                  2020-1-13 00:32                ", "text": "                                                                                                                                                                                     早期为了解决“会话保持”的需求社区中出现了「cookie方案」并最终成为W3C标准：当某个网站登录成功后客户端（浏览器）收到一个cookie标识（文本）并保存下来在后续请求中会自动带上这个字段由此Web后台可以判断是否同一个用户从而使“会话”得以延续。微信小程序没有像浏览器一样内置实现了cookie方案需要开发者自行模拟而原先京东购物小程序及京喜小程序（现微信一级购物入口）是从微信及手Q购物H5中迁移迭代出来的也就是说我们不仅要在小程序中模拟一套cookie方案并且要保持和原业务对cookie处理逻辑的一致为此我们将实现方向确定为“基于小程序开放能力和浏览器保持一致”。微信小程序开放了 数据缓存 Storage 和 网络 Network 这两种能力通过这两套API我们可以自行DIY一个cookie方案。PS：本文所有代码及使用示例都可以 在这里 找到阅读本文时配合实践效果更佳。二、浏览器中的cookie为了保持后端对cookie的处理逻辑和原来的H5一致小程序的实现需要往浏览器看齐。所以模拟小程序的cookie前先看看浏览器的cookie机制主要有以下几个部分：本地存储：浏览器会在本地分配一块空间存储cookie请求携带：每次发起请求都会从本地取出cookie并追加在请求头上响应设置：当响应头有Set-Cookie字段时需要解析并更新过期时间：每个cookie字段有单独的过期时间并且到期会自动清除读写操作：暴露API给前端JS调用可进行增删改查操作作用域：路径path、域名domin编码：cookie值在网络传输需要encode建议存储也一样其它：HttpOnly、Secure、SameSite在浏览器的 DevTools 中可以看到当前站点下的Cookie明细：三、小程序中的cookie实现方案设计在小程序中模拟Cookie主要涉及五个部分：其中我们会重点关注 「Cookie基础库」 的实现另外也会给出「Request基础库」的封装示例。本地存储小程序提供了 「数据缓存 Storage API」（可以理解为Web规范中的 LocalStorage ）支持存储“原生类型、Date、及能够通过JSON.stringify序列化的对象”。我们可以利用这些API在Storage中新开一个 cookies 字段进行存储：// 存：wx.setStorageSync('cookies', cookies)// 取：wx.getStorageSync('cookies')复制代码其中 cookies 的「存储结构」如下：// cookies = {    cookie1: { // “最小cookie单元” ==> cookieItem        name: 'cookie1', // cookie名        value: 'xxx',    // cookie值        expires: 'Fri, 17 Jan 2020 08:49:41 GMT' // 过期时间使用GMT（格林威治标准时间）格式    }},复制代码上面的 cookie1 便是一个“最小cookie单元 cookieItem ”包含了3个字段（name、value、expires）是本文中定义的「标准cookie格式」也是cookie操作的基本单元。打开【微信开发工具】的 Storage 选项卡可以查看本地存储的情况：读写操作这部分主要作为“公共基础库“的角色为外部业务提供增删改查cookie的API。1. 获取cookie———— getCookie()步骤：从Storage中取出完整cookies ==> 取出指定name的cookie项 ==> 校验有效期 ==> 返回值value实现如下：function getCookie(name = '') {    let cookies = wx.getStorageSync('cookies') // try/catch 略过    let { value, expires } = cookies[name] || {}    return (name && expires && !isExpired(expires)) ? decodeURIComponent(cookieItem.value) : ''}复制代码2. 设置cookie———— setCookie()步骤：从Storage中取出完整cookies ==> 解析入参 ==> 覆盖更新 ==> 同步到本地Storage首先看下本API设计需求：设置单个/多个cookie直接传值/传cookieItem（Object）时间格式maxAge/expires调用示例如下：setCookie({    cookie1: 12345,    cookie2: '12345'})setCookie({    cookie1: {        value: 12345,        maxAge: 3600 * 24  // 自定义有效期（这里示例是24小时）    },    cookie2: {        value: '12345',        expires: 'Wed, 21 Oct 2015 07:28:00 GMT' // 标准GMT格式    }})复制代码这里可对入参遍历而cookie子项无论直接传值value还是传了详细object都尽量的获取 name/value/expires/maxAge 传给格式化函数转为标准的 cookieItem ：function setCookie(cookiesParam) {    let oldCookies = wx.getStorageSync('cookies') // try/catch 略过    let newCookies = {} // 由 cookiesParam 转化为标准格式后的cookies    for (let name in cookiesParam) {        if (isObject(cookiesParam[name])) { // 传入是Object格式            let { value, expires, maxAge } = cookiesParam[name]            // 转换为标准cookie格式（cookieItem）            newCookies[name] = getStandardCookieItem({ name, value, expires, maxAge })        } else {            newCookies[name] = getStandardCookieItem({ name, value: cookiesParam[name] })        }    }    // 同步到本地Storage    saveCookiesToStorage(Object.assign({}, oldCookies, newCookies))}复制代码3. 删除cookie———— removeCookie()步骤：从Storage中取出完整cookies ==> 删除指定的cookie项 ==> 同步到本地Storagefunction removeCookie(cookieName) {    let cookies = wx.getStorageSync('cookies') // try/catch 略过    delete cookies[cookieName]    saveCookiesToStorage(Object.assign({}, cookies))}复制代码四、Cookie 在网络中的传递本节主要简单实现设计图中的【Request基础库】部分如上图所示Cookie在网络中的传输主要有四个过程：Set-CookieCookieCookie以下是对一个请求的抓包示例：在小程序中请求发起有两种方式： HTTP 和 WebSocket 这里以HTTP为例先对请求api进行「封装」：function requestPro({ url, data, header, method = 'GET' }) {    return new Promise((resolve, reject) => {        wx.request({            url,            data,            header: Object.assign({}, { 'Cookie': CookieLib.getCookiesStr() }, header), // 请求头————带上Cookie            success (res) {              let { data : resData, header, statusCode } = res              let setCookieStr = header['Set-Cookie'] || header['set-cookie'] || ''              CookieLib.setCookieFromHeader(setCookieStr) // 响应头————解析Set-Cookie              resolve(resData)            },            fail (err) {                reject(err)            }          })    })}复制代码如上代码所示Cookie在前端侧请求模块中的处理主要有3点：1. 请求携带步骤：（每次发请求前）从Storage中取出完整cookies ==> 转化为HTTP规范的请求头Cookie格式 ==> 设置到 Request Header 中上面代码中的 getCookiesStr() 直接取cookies拼接即可返回示例： cookie1=xxx;cookie2=yyy 。2. 响应设置步骤：（每次收到响应后）解析 Response Header 的 Set-Cookie 字段 ==> 转为标准Cookie格式 ==> setCookie()这里处理 Set-Cookie 内容时有几个点需要留意： - 最基本的格式： Set-Cookie: <cookie-name>=<cookie-value> - 可能同时包含多个cookie字段以,分割（但需要排除时间值里的,） - 时间格式：Max-Age/Expires （不区分大小写）具体实现可在文末Demo中找到。3. 编码问题「Cookie值编码方式」是容易产生困惑的地方目前看到的广泛做法都是使用「URL编码」。但笔者翻阅 RFC6265 发现原始规范中并没有对编码进行指定比如在第四章 Server Requirements （服务端）中是这样描述：To maximize compatibility with user agents, servers that wish to store arbitrary data in a cookie-value SHOULD encode that data, for example, using Base64 [RFC4648].“为了最好的兼容效果服务端应该对cookie值进行编码例如使用Base64。”而在第五章 User Agent Requirements （客户端也就是浏览器）则是“建议以第四章服务端的实现为准”。总之规范并没有指定使用「URL编码」但基于该编码方案已经深入人心也就顺其自然成了“默认选择”。那这里也不做例外浏览器怎么做咋们小程序也保持一致。在浏览器中推荐cookie值经过 encode 编码后保存下来所以直接取到的也是 encode 后的值所以追加在请求头 Cookie 字段就不需要 decode 解码了直接拼接即可（但基础库API的get操作最终需要进行 decode 解码）。而对于响应头 Set-Cookie 的值我们认为后端已经做了 encode 编码所以前端不需要处理直接存进 Storage 即可。五、性能优化（高频读写）前面实现中每次读写cookie都会调用小程序Storage API（而且是同步的）小程序框架会读写到本地Storage。 对于高频场景可以将cookie在内存中维护一份读写都直接走「内存层」有更新才同步到「Storage层」。1. 初始化首先需要在内存中声明一个 _COOKIES （命名自行diy）建议在cookie基础库中声明便于统一维护。2. 读前面初始化时已经从Storage读取一次cookies后续getCookie就直接读内存的 _COOKIES 即可。3. 写写操作直接更新内存间接更新Storage。 如果有高频写场景可以考虑做个任务队列进行节流。六、单元测试微信官方在2019年5月推出了「小程序自动化 SDK」 miniprogram-automator 经过半年多的迭代目前已基本稳定下来。在购物小程序场景试用了一下cookie相关的用例很快就完成了简直是开发者的福音：真香！！！实际项目中对cookie的单元测试可以分为两类：小程序全局范围的cookie验证（比如初始化小程序后有没有种下版本号、访问行为等关键cookie）cookie基础库API验证（比如get/set/remove等各个API是否正常工作）以验证 setCookie() API为例：it('API验证：setCookie()', async () => {    await miniProgram.evaluate(() => {        wx.CookieLib.setCookie({ // 调用API            cookie1: 12345,        })    })    let { cookies } = await miniProgram.callWxMethod('getStorageSync', 'cookies')    expect(cookies['cookie1'].value).toBe(12345) // 期望成功设置cookie1为12345})复制代码这里为了方便测试用例调用基础库API在小程序启动前把Cookie基础库（CookieLib）挂到了 wx 对象上实现方式是使用node读写文件的API去【植入代码】：fs.appendFileSync('./your_project/app.js', ''\\n wx.CookieUtil = require(\\'./lib/cookie.js\\');\\n'')复制代码七、Cookie安全Cookie安全是一个比较大的话题这里只简单列出和小程序相关的几个点。path、domin、HttpOnly、Secure、SameSite小程序中已经做了一些安全措施比如只能走HTTPS、合法域名需要管理员到微信后台进行配置、Storage只能由写入它的小程序中访问等等。 因此 path、domin、HttpOnly、Secure、SameSite 这些字段在小程序环境下的价值没有浏览器环境大本例中没有使用（懒..）而实际业务场景可以按自身情况决定是否要使用。白名单机制前端维护（大小/数量） 通常浏览器保持的Cookie数据不超过4k部分浏览器限制同一站点最多cookie数为20个。 如果业务庞大的话建议在Cookie基础库做一套「白名单」机制在白名单内才可以写入以此防止“非法写入”或“内容超大导致信息丢失”的问题。后台维护（网关白名单） 同样的建议从网关层面建立一个“可信cookie”白名单自动过滤请求中的“非法cookie”字段。前端防篡改小程序前端更多是防“误改”————即在操作Cookie过程中发生了意料之外的修改。通常发生在JS“引用拷贝”特性上比如前面提到的内存维护一个 _Cookies 如果有一个API getAllCookies() 直接将这份内存版cookies暴露出去对象引用容易被连带修改。所以cookie基础库需要控制暴露API的能力范围并对取值进行“深拷贝”。SessionSession机制将用户状态放在了服务端维护具备更好的安全性而且目前各种后端对于session的存储和同步都有很成熟的技术方案有条件的业务应以Session为主做会话保持。指纹上报用户访问时生成设备指纹并上报（通常是登录/结算等环节）业务后台配合风控系统遇到异常请求时下发验证环节。八、完整小程序实现Demo代码片段： developers.weixin.qq.com/s/x4sFASmh7…九、小结本文先解析了浏览器的 Cookie机制 运作原理然后使用「数据缓存」和「网络」能力以 公共基础库 的形式在小程序中实现了一套 Cookie方案。希望对大家有所帮助。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 动态加载swiper时不显示的问题（爬坑）               迷你PS小程序-集成的开放式画报、油墨电子签名、图片拖拽可单独食用 ...                                                        原作者:  WecTeam                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "从客户端角度窥探小程序架构 ", "author": "                  Rolan                  2020-1-7 00:42                ", "text": "                                                                                                                                                                                     小程序自诞生以来。就以一种百家争鸣的姿态展现在开发者的面前。继2017年1月9日微信小程序诞生后小程序市场又陆续出现了支付宝小程序、头条小程序、百度智能小程序等等甚至平安内部也在发展自己的小程序生态。各家都在微信小程序的基础上面向自己的业务对架构进行逐步优化调整但是万变不离其宗微信小程序终归为小程序鼻祖也是得益于微信小程序的思想才造就了如今这百花齐放的业态。说起微信小程序在体验上的优化让我很长一段时间认为这是 Native 层渲染。事实并不完全是至今不敢相信webView 的渲染竟能带来如此体验。本篇主要以一个客户端开发者的角度来对微信小程序、支付宝小程序一探究竟。本篇旨在原理分析我并未有真实的小程序架构设计经验。说到小程序不得不需要指出另外一个问题苹果爸爸 对于 HTML5 app 的更新 的审核问题目前会有开发者存在这样的疑问Hybrid 和 H5 是不是要被苹果拒审了呢？其实从更新描述来看不难发现苹果的主要目的是针对 “核心功能未在二进制文件内” 的 App 实际上小程序无论是在设计理念上还是核心技术上都不存在这样的问题小程序并非App小程序是以 App 为载体尽可能的对 web 页面进行优化而生成的产物。还有一点是 马甲包 日益猖獗马甲包最后基本都转化成为了条款内描述的 “现金Bocai、彩票抽奖和慈善捐款” 类型所以苹果想要尽可能的禁止它。而且从微信小程序开发文档来看微信小程序是典型的 技术推动产品的结果 。关于RN类技术更不存在这样的问题了RN本质为 JS 通过 JSCore 调用 Native 组件。实际上它的核心仍然在 Native 端当然对 code push 我还尚存疑问。关于 RN 的动态更新上从 bang's 的描述也不难发现苹果爸爸的态度 只要不是为了绕过审核去做动态更新就可以接受 。二、从微信小程序的发展史说起微信小程序是什么微信把小程序定义为是 一种全新的连接用户与服务的方式它可以在微信内被便捷地获取和传播同时具有出色的使用体验 。便捷和出色有何而来？小程序技术最初来源于 H5 和 Native 间的简单调用微信构建了一个 WeixinJSBridge 来为H5提供一些 Native 的功能例如地图、播放器、定位、拍照、预览等功能。关于 Bridge 的具体实现可以参考之前的文章 写一个易于维护使用方便性能可靠的Hybrid框架 。但是微信逐渐的又遇到了另外一个问题那就 H5 页面的体验问题微信团队为了解决 H5 页面的白屏问题他们引入了最近很火的 离线包 概念当然微信称之为 微信 Web 资源离线存储 实际上是一个东西。Web 开发者可借助微信提供的资源存储能力直接从微信本地加载 Web 资源而不需要再从服务端拉取从而减少网页的加载时间。关于离线包的概念不了解的话可以参考下我之前的文章 iOS 性能优化 -- H5离线秒开 。但是当页面加载大量 CSS 和 JS 时依然会有白屏问题包括 H5 页面点击事件的迟钝感和页面跳转的体验问题。那么基于此问题应运而生的小程序技术就诞生了。从微信小程序的发展史不难看出小程序实际上是近几年开发者对 H5 体验优化而来的这也切合了前面所说的 小程序实际上是典型的技术推动产品的结果 。三、微信小程序原理分析微信小程序自称能够解决以下问题：快速的加载。更强大的能力。原生的体验。易用且安全的微信数据开发。高效和简单的开发。快速加载和原生的体验这其实都是在体验上的升级更强大能力实际上源于微信小程序为开发者提供了大量的组件这些组件有基于web技术也有基于Native技术在我看来这和 RN 技术不谋而合。后面我会举一个模仿 RN 实现的小例子来阐述一下它的原理。高效和简单的开发是因为微信小程序开发语言实质上还是基于 web 开发规范这使得开发前端的人来开发小程序显得更容易。还有一点更重要的就是安全为什么说小程序是安全的？后面会逐步展开揭开小程序的神秘面纱。快速加载和原生的体验小程序的架构设计与 web 技术还是有一定的差别吸取了 web 技术的一些优势也摒弃了 web 技术中体验不好的地方。最主要的特点就是小程序采用双线程机制即视图渲染和业务逻辑分别运行在不同的线程中。在传统的 web 开发中网页开发渲染线程和脚本线程是互斥的所以 H5 页面中长时间的脚本运行可能会导致页面失去响应或者白屏体验糟糕。为了更好的体验将页面渲染线程和脚本线程分开执行：渲染层：界面渲染相关的逻辑全部 在webView 线程内执行一个小程序存在多个页面一个页面对应一个 webView微信小程序限制开发者最多只能创建五个页面。逻辑层：Android采用 JSCore iOS采用的 JavaScriptCore 框架运行 JS 脚本。怎么在 JavaScriptCore 运行脚本文件后面会讲。双线程模型是小程序框架与大多数前端 web 框架的不同之处基于这个模型可以更好的管控以及提供更安全的环境。因为逻辑层运行在 JSCore 中并没有一个完整浏览器对象因而缺少相关的DOM API和BOM API。客户端的开发者可能对 DOM 有些陌生了解编译过程的同学应该知道在编译器编译代码的时候会有一个语法分析的过程生成抽象语法树 AST编译器会根据语法树去检查表达式是否合法、括号是否匹配等。实际上DOM也是一种树结构经过浏览器的解析最终呈现在用户面前。通过 JavaScript 操纵 DOM 可以随意改变元素的位置这对于小程序来说是极为不安全的。所以说逻辑层为小程序带来的另一个特点易于管控和安全。线程通信基于前面提到的 WeixinJSBridge ：逻辑层把数据变化通知到视图层触发视图层页面的更新视图层把触发的事件通知到逻辑层进行业务处理。当我们对渲染层进行事件操作后会通过 WeixinJSBridge 将数据传递到 Native 系统层。Native 系统层决定是否要用 Native 处理然后丢给 逻辑层进行用户的逻辑代码处理。逻辑层处理完毕后会将数据通过 WeixinJSBridge 返给 View 层View 渲染更新视图。渲染层根据 微信小程序开发者文档 描述 在视图层内小程序的每一个页面都独立运行在一个页面层级上。小程序启动时仅有一个页面层级每次调用wx.navigateTo都会创建一个新的页面层级；相对地wx.navigateBack会销毁一个页面层级 。大概可以理解为每个 web 页面都是运行在单独的 webView 里面这样的好处就是让每个 webView 单纯的处理当前页面的渲染逻辑不需要加载其他页面的逻辑代码减轻负担能够加速页面渲染使其能够尽可能的接近原生这与小程序跳转页面的体验上也是一致的。实际上在小程序源码内有一个 index.html 文件的存在这是小程序启动后的入口文件。初次加载的时候主入口会加载相应的 webView 这其中就会包括前面所提到的视图层和逻辑层。逻辑层虽然也提供了 webView 但是并不提供浏览器相关接口而是单纯的为了获取当前的 JSCore 执行相关的 JS 脚本文件这也是开发小程序是没办法直接操作 DOM 的根本原因。当我们每打开一个新页面的时候调用 navigateTo 都相当于打开了一个新的 webView 这样一直打开内存也会变得吃紧这也是为什么小程序对页面打开数量有限制的原因了。预加载根据小程序开发文档描述： 对于每一个新的页面层级视图层都需要进行一些额外的准备工作。在小程序启动前微信会提前准备好一个页面层级用于展示小程序的首页。除此以外每当一个页面层级被用于渲染页面微信都会提前开始准备一个新的页面层级使得每次调用wx.navigateTo都能够尽快展示一个新的页面 。这在客户端的角度来看相当于打开新页面之后对下一个页面的 webView 提前做了预加载这个思路与当前比较流行的 webView 缓存池的思路不谋而合原因是在 iOS 和 Android 系统上操作系统启动 webView 都需要一小段时间预加载会提升页面打开速度优化白屏问题。基础库内部优化再往深层次来看通过小程序开发工具的源码能找到一个 pageframe.html 的模版文件具体位置在 package.nw/html/pageframe.html ：看标题就应该很清楚了这是渲染层的核心模块它的作用就是为小程序准备一个新的页面小程序每个视图层页面内容都是通过 pageframe.html 模板来生成的包括小程序启动的首页。通过查看源码里面定义了一个属性 var __webviewId__ 我猜想这是每个 webView 页面的页面 ID 逻辑层处理多个视图层间的业务逻辑可能就是通过这个ID来做的映射关系。在首次启动时后台会缓存生成的 pageframe.html 模版在后面的页面打开时直接加载缓存的 pageframe.html 模版页面引入的资源文件也可以直接在缓存中加载包括小程序基础库视图层底层、页面的模版信息、配置信息以及样式等内容这样避免重复生成快速打开页面提升页面渲染性能。注入小程序WXML结构和WXSS样式关于 pageframe.html 最后是怎么生成相应页面的归功于一个叫 nw.js 的框架具体实现这里就不讲了更多的偏向于前端的知识了。逻辑层上面了解了渲染层都做了什么之后下面在窥探一下小程序的逻辑层都做了什么。参考 eux.baidu.com/blog/fe/微信小… 不难发现sevice 层的代码是由 WAService.js 实现的逻辑层实际上主要提供了 Page AppGetApp 接口和更为丰富 wx 接口模块包括数据绑定、事件分发、生命周期管理、路由管理等等。关于视图层和逻辑层间的具体交互细节可以看下这张图：我们写的页面逻辑最后都被引入到了一个叫 appservice.html 的页面中并且分别从 app.js 开始一一执行；小程序代码调用 Page 构造器的时候小程序基础库会记录页面的基础信息如初始数据（data）、方法等。需要注意的是如果一个页面被多次创建并不会使得这个页面所在的JS文件被执行多次而仅仅是根据初始数据多生成了一个页面实例（this）在页面 JS 文件中直接定义的变量在所有这个页面的实例间是共享的。对于逻辑层从客户端的角度看我们应该更关注于逻辑层的JS是怎么注入到JSCore中的。四、看看JavaScriptCore是怎么执行JS脚本的说到JavaScriptCore我们先来讨论下Hybrid App 的构建思路Hybird App是指混合模式移动应用即其中既包含原生的结构又有内嵌有 Web 的组件。这种 App 不仅性能和用户体验可以达到和原生所差无几的程度更大的优势在于 bug 修复快版本迭代无需发版。Hybird App的实质并没有修改原 Native 的行为而是将下发的资源进行加载和界面渲染类似 WebView。下面通过一个例子来模拟一下 avaScriptCore 执行 JS 脚本来让 Native 和 JS 之间的通信。关于 JavaScriptCore 的具体使用可以参考下戴铭的 深入剖析 JavaScriptCore 。我们打算实现这样的功能：通过下发JS脚本创建原生的 UILabel 和 UIButton 控件并响应事件首先编写 JS 代码如下：(function(){ console.log(\"ProgectInit\"); //JS脚本加载完成后 自动render界面 return render(); })();//JS标签类function Label(rect,text,color){    this.rect = rect;    this.text = text;    this.color = color;    this.typeName = \"Label\";}//JS按钮类function Button(rect,text,callFunc){    this.rect = rect;    this.text = text;    this.callFunc = callFunc;    this.typeName = \"Button\";}//JS Rect类function Rect(x,y,width,height){    this.x = x;    this.y = y;    this.width = width;    this.height = height;}//JS颜色类function Color(r,g,b,a){    this.r = r;    this.g = g;    this.b = b;    this.a = a;}//渲染方法 界面的渲染写在这里面function render(){    var rect = new Rect(20,100,280,30);    var color = new Color(1,0,0,1);    var label = new Label(rect,\"这是一个原生的Label\",color);    var rect4 = new Rect(20,150,280,30);    var button = new Button(rect4,\"这是一个原生的Button\",function(){                            var randColor = new Color(Math.random(),Math.random(),Math.random(),1);                            TestBridge.changeBackgroundColor(randColor);                            });    //将控件以数组形式返回    return [label,button];}复制代码创建一个 OC 类 TestBridge 绑定到 JavaScriptCore 全局对象上：@protocol TestBridgeProtocol <JSExport>- (void)changeBackgroundColor:(JSValue *)value;@end@interface TestBridge : NSObject<TestBridgeProtocol>@property(nonatomic, weak) UIViewController *ownerController;@end复制代码#import \"TestBridge.h\"@implementation TestBridge- (void)changeBackgroundColor:(JSValue *)value{    self.ownerController.view.backgroundColor = [UIColor colorWithRed:value[@\"r\"].toDouble green:value[@\"g\"].toDouble blue:value[@\"b\"].toDouble alpha:value[@\"a\"].toDouble];}@end复制代码在 ViewController 中实现一个界面渲染的 render 解释方法：#import \"ViewController.h\"#import <JavaScriptCore/JavaScriptCore.h>#import \"TestBridge.h\"@interface ViewController ()@property(nonatomic, strong)JSContext *jsContext;@property(nonatomic, strong)NSMutableArray *actionArray;@property(nonatomic, strong)TestBridge *bridge;@end@implementation ViewController- (void)viewDidLoad {    [super viewDidLoad];    //创建JS运行环境    self.jsContext = [JSContext new];    //绑定桥接器    self.bridge =  [TestBridge new];    self.bridge.ownerController = self;    self.jsContext[@\"TestBridge\"] = self.bridge;    self.actionArray = [NSMutableArray array];    [self render];}-(void)render{    NSString * path = [[NSBundle mainBundle] pathForResource:@\"main\" ofType:@\"js\"];    NSData * jsData = [[NSData alloc]initWithContentsOfFile:path];    NSString * jsCode = [[NSString alloc]initWithData:jsData encoding:NSUTF8StringEncoding];    JSValue * jsVlaue = [self.jsContext evaluateScript:jsCode];    for (int i=0; i<jsVlaue.toArray.count; i++) {        JSValue * subValue = [jsVlaue objectAtIndexedSubscript:i];        if ([[subValue objectForKeyedSubscript:@\"typeName\"].toString isEqualToString:@\"Label\"]) {            UILabel * label = [UILabel new];            label.frame = CGRectMake(subValue[@\"rect\"][@\"x\"].toDouble, subValue[@\"rect\"][@\"y\"].toDouble, subValue[@\"rect\"][@\"width\"].toDouble, subValue[@\"rect\"][@\"height\"].toDouble);            label.text = subValue[@\"text\"].toString;            label.textColor = [UIColor colorWithRed:subValue[@\"color\"][@\"r\"].toDouble green:subValue[@\"color\"][@\"g\"].toDouble blue:subValue[@\"color\"][@\"b\"].toDouble alpha:subValue[@\"color\"][@\"a\"].toDouble];            label.textAlignment = NSTextAlignmentCenter;            [self.view addSubview:label];        }else if ([[subValue objectForKeyedSubscript:@\"typeName\"].toString isEqualToString:@\"Button\"]){            UIButton * button = [UIButton buttonWithType:UIButtonTypeSystem];            button.frame = CGRectMake(subValue[@\"rect\"][@\"x\"].toDouble, subValue[@\"rect\"][@\"y\"].toDouble, subValue[@\"rect\"][@\"width\"].toDouble, subValue[@\"rect\"][@\"height\"].toDouble);            [button setTitle:subValue[@\"text\"].toString forState:UIControlStateNormal];            button.tag = self.actionArray.count;            [button addTarget:self action:@selector(buttonAction:) forControlEvents:UIControlEventTouchUpInside];            [self.actionArray addObject:subValue[@\"callFunc\"]];            [self.view addSubview:button];                    }    }}-(void)buttonAction:(UIButton *)btn{    JSValue * action  = self.actionArray[btn.tag];    [action callWithArguments:nil];}@end复制代码这样就完成了一个简单的 JS 脚本注入实际上执行后的样子是这样的：这就是一个简单的执行 JS 脚本的逻辑实际上 ReactNative 的原理也是基于此小程序逻辑层与微信客户端的交互逻辑也是基于此。到这里关于微信小程序渲染层与逻辑层做了什么、怎么做的、优化了什么以及为什么要采用这样的架构来设计基本都梳理完毕了。小程序这样的分层设计显然是有意为之的它的中间层完全控制了程序对于界面进行的操作 同时对于传递的数据和响应时间也做到的监控。一方面程序的行为受到了极大限制 另一方面微信可以确保他们对于小程序内容和体验有绝对的控制。我们在小程序的 JS 代码里面是不能直接使用浏览器提供的 DOM 和 BOM 接口的这一方面是因为 JS 代码外层使用了局部变量进行屏蔽另一方面即便我们可以操作 DOM 和 BOM 接口它们对应的也是逻辑层模块并不会对页面产生影响。这样的结构也说明了小程序的动画和绘图 API 被设计成生成一个最终对象而不是一步一步执行的样子 原因就是 json 格式的数据传递和解析相比与原生 API 都是损耗不菲的如果频繁调用很可能损耗 过多性能进而影响用户体验。总结一句话就是 webView渲染JSCore处理逻辑JSBridge做线程通信 。后面再简要的分析下支付宝小程序支付宝小程序属于后起之秀支付宝小程序在微信小程序的基础上做了一些优化单从技术角度来看有点后来者居上的意思。目前支付宝技术通过官方的媒体账号对外暴漏的一些实现细节也在逐步增多。六、再说说支付宝小程序前端框架下面是小程序 native 引擎包括了小程序容器、渲染引擎和 JavaScript 引擎这块主要是把客户端 native 的能力和前端框架结合起来给开发者提供系统底层能力的接口。在渲染引擎上面支付宝小程序不仅提供 JavaScript+Webview 的方式还提供 JavaScript+Native 的方式在对性能要求较高的场景可以选择 Native 的渲染模式给用户更好的体验。这段文字来源于支付宝对外开放的技术博客的描述从这段描述中我们能够发现支付宝小程序在架构设计上同样采用的渲染引擎加 JavaScript 引擎两部分包括页面间的切换实际上和微信小程序逻辑基本一致。下面这张是支付宝小程序应用框架的架构图：运行时架构单从这个运行时架构来看它与微信小程序不同的地方是webView 页面也就是渲染层通过消息服务直接与逻辑层进行通讯而不需要像微信的 JSBridge 那样作为中间层消息服务具体实现细节目前尚不得知。支付宝的JSBridge只会与逻辑层进行通讯来给小程序提供一些 Native 能力。支付宝的这种架构主要目的是解决渲染层与逻辑层交互的对象较复杂、数据量较大时交互的性能比较差的问题。支付宝小程序的设计思路比较值得借鉴微信小程序线程间的通讯是通过 JSBridge 序列化 json 进行传递的。支付宝小程序重新设计了V8虚拟机让逻辑和渲染都有自己的 Local Runtime存放私有的模块和数据。在渲染层和逻辑层交互时setData 的 对象会直接创建在 Shared Heap 里面因此渲染层的 Local Runtime 可以直接读到该对象并且用于 render 层的渲染保证了逻辑和渲染的隔离又减少了序列化和传输成本。当然支付宝还有些其他的优化包括首页离线缓存缓存时机的处理以及闪屏处理等等问题这里就不再延伸讨论了（因为很多细节我也不知道）。小程序SDK根据支付宝小程序对外开放的技术文章来看架构设计还是非常巧妙的也很值得我们学习先看图：参考： 独家！支付宝小程序技术架构全解析小程序SDK在架构设计上把它分为了两部分一部分是核心库基础引擎一部分是基于基础库开发的插件功能。从上往下看：第一层小程序层这是小程序开发者使用小程序 DSL 及各种组件开发的代码层。第二层和第三层架应该是小程序内部封装的一些组件和对外提供的相关API等。第四层和第五层是小程序的运行基础框架主要包含小程序的逻辑处理引擎及渲染层。支付宝基于 ReactNative 增加了 Native 引擎可以用原生来渲染 UI 。根据支付宝 mPaaS 的介绍来看目前支付宝的小程序使用的是 React 版蚂蚁内部的其他 App 有在使用 React Native 版的小程序。基础组件部分和扩展能力部分更像是基于 Bridge 调用的原生能力。六、最后差不多半年多没有写文章了趁着公司年会时间稍显充裕对当前的小程序架构进行了下分析和总结当然真正的小程序应该比这还要复杂的多小程序实际上是多年来大前端融合的一个结果是一套非常成体系的技术方案看了这么多我想你对小程序也有了初步认识小程序的核心实际上还是 渲染层 和 逻辑层 的构建那么如果让你开发一套 小程序SDK 你会怎样设计它们呢？                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序跨页面交互的作用与方法               微信小程序加入购物车动画的实现（向上、向下）                                                        原作者:  Sevin                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序登录的最优流程 ", "author": "                  Rolan                  2020-1-13 00:16                ", "text": "                                                                                                                                                                                     18年中旬做过一个小程序当时是通过转跳到一个登录页然后点击调用 wx.getUserInfo 然后发现这个api被禁用了(虽然依然可以用)然后用<!-- 需要使用 button 来授权登录 --><button wx:if=\"{{canIUse}}\" open-type=\"getUserInfo\" bindgetuserinfo=\"bindGetUserInfo\">授权登录</button><view wx:else>请升级微信版本</view>复制代码因为当时刚好需要用户信息然后这个api有一个 encryptedData 属性可以获取信息。这样的流程本就可以了但是意外出现了。思维的禁锢当第二次(2020年)需要开发一个新的小程序于是也用了老代码 但是出现了个奇怪的问题。 有兴趣的可以看下面的[奇怪的问题]奇怪的问题：因为微信限制无法转跳到登录页所以想是否应该在首页设置一个弹窗点击的时候授权。但是因为考虑到可能会被微信拒绝故在小程序开发者论坛开了一篇文章app无法转跳到登录页面 and 小程序登录的哲学思考随后发现登录其实并不需要授权弹窗or页面。（如果服务器不需要保存用户信息)流程下面这个图是小程序官方图 点我转跳代码app.js（小程序的入口文件）的完整代码const loginDataKey = 'loginData'//app.jsApp({  onLaunch: function () {    const loginData = wx.getStorageSync(loginDataKey)    console.log('--loginData--')    console.log(loginData)    let toLogin = () => {      console.log('未登录去登录..')      wx.showLoading({title: '登录中', icon: 'loading', mask: true})      wx.login({        success(res){          console.log('wx.login res')          console.log(res)          let success = () => {            console.log('登录成功')            let loginResponse = {\"openid\":\"ooZAbwpdDdaZV_xiamianshi_mashaike\"}            wx.setStorageSync(loginDataKey, loginResponse)            wx.hideLoading()          }          let fail = () => {            wx.hideLoading()            wx.showToast({              title: '登录失败请重新打开小程序试试',              icon: 'none',              duration: 1e8            })          }          // TODO 发起网络请求          // 延时模拟请求登录成功          setTimeout(success, 500)        },        fail(err){          console.log(err)          wx.hideLoading()          wx.showToast({            title: '登录失败请重新打开小程序试试',            icon: 'none',            duration: 1e8          })        }      })    }    // 未登录去登录    if(!loginData){      toLogin()    // 已登录但是微信session_key过期    }else{      wx.checkSession({        success () {          //session_key 未过期并且在本生命周期一直有效          console.log('session_key 未过期')        },        fail () {          // session_key 已经失效需要重新执行登录流程          console.log('session_key 已经失效需要重新执行登录流程, 重新登录中')          toLogin()        }      })    }  },  globalData: {    userInfo: null  }})复制代码流程如下根据本地储存判断是否登录已登录判断是否失效失效或者未登录去登录登录展示toast拿到信息存储 关闭toast核心wx.login拿到code然后把code通过 auth.code2Session 获取openid和unionid等。这是我通过 auth.code2Session 拿到openid的截图（因为这个是测试号所以没有unionid）【unionid】是拿来和其他平台打通账号的关键如果只有一个小程序都可以不需要这个。效果其他纯展示用户头像昵称等<open-data type=\"userAvatarUrl\"></open-data><open-data type=\"userNickName\"></open-data>复制代码查看open-data文档--完--                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    迷你PS小程序-集成的开放式画报、油墨电子签名、图片拖拽可单独食用 ...               小程序后端 egg 框架开发记录                                                        原作者: 秀岳_知行合一的小猫咪                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发注意指南和优化实践 ", "author": "                  Rolan                  2019-6-19 00:40                ", "text": "                                                                                                                                                                                     前言转眼间已经参与过我厂好几个小程序的开发了下面本妹子将开发中的那些注意点和各位小伙伴们分享下妥妥的干货一枚。一、WXML不要换行写有空格不行微信开发者工具不会对代码进行trim操作如果代码中换行页面也直接换行。wx:if vs hidden一般来说wx:if 有更高的切换消耗而 hidden 有更高的初始渲染消耗。因此如果需要频繁切换的情景下用 hidden 更好如果在运行时条件不大可能改变则 wx:if 较好。图片处理1.大图片也会造成页面切换的卡顿有一部分小程序会在页面中引用大图片在页面后退切换中会出现掉帧卡顿的情况。 2.图片占容量 代码包限制是2MB图片占用空间较大建议都上传到 CDN 上代码里直接引用链接。 3.大图片小点击位 小程序主要在手机端运行手机屏幕大小有限所以尽量点击位大点。 4.图片截取 存在图片没有按原图宽高比例显示可以设置 image 组件的 mode 属性来保持原图宽高比。 5.CSSSprites 所有零星图片都包含到一张大图中减少请求数WXS 模块每个 wxs 模块均有一个内置的 module 对象。 直接在wxml中引入可以将写需要转化数据的写进去防止给setData加负担使用了过大的 WXML 节点数目一个太大的WXML节点树会增加内存的使用样式重排时间也会更长建议一个页面使用少于 1000 个WXML的节点节点树深度少于 30 层子节点数不大于 60 个二、WXSSCss伪类看不到在微信开发者工具中 Styles 不会显示 Css 伪类喜欢写::before或:first-child的小伙伴们请注意了你的伪类在控制台是看不到的,所以本妹子不建议在小程序里用 Css 伪类以防找不到问题点不好修复bug。小程序 button 自带给 after 伪类添加了边框通过开发者工具是看不到 after ,我们需要自行去掉边框。button::after {  border: none;}hover 伪类则可以用小程序自带的属性 hover-class 代替。部分CSS3属性不能用如transform:rotate(180deg)不能用。自定义颜色限制不是所以颜色配置都能随心所欲比如导航栏标题颜色仅支持 black / white；下拉 loading 的样式仅支持 dark / light。所以出视觉图关注下。滚动区域没有开启惯性滚动当加了overflow: scroll时 IOS 下需要额外设置： -webkit-overflow-scrolling: touch来开启惯性滚动。三、JSJavaScript 支持情况如果需要支持到 IOS8 话建议下面 js 方法都不使用。分享事件不支持异步如果你想自定义分享图片则在生命周期onShareAppMessage中编写如下所示：Page({  onShareAppMessage: function (res) {    return {      title: '自定义转发标题',      imageUrl: 'https://raoenhui.github.io/images/logo.png'    }  }})但是 onShareAppMessage 不能支持异步如果你想从接口里获取分享图片URL必须在 onLoad 提前读取并放入Data中小程序有并发限制wx.request、wx.uploadFile、wx.downloadFile 的最大并发限制是 10 个。所有为了保险起见需要写个请求队列如果并发量大于10则等待请求。采用公共方法和组件编写公共方法和组件可以避免重复造轮子。 1.公共埋点方法 2.各种处理js的方法（转httpsthrottleformatTime等） 3.公共组件（iphonex兼容组件倒计时组件等）catch绑定事件比如 catchtouchmove 弹框禁止滑动 bind事件绑定不会阻止冒泡事件向上冒泡catch事件绑定可以阻止冒泡事件向上冒泡。循环中添加key对于经常要更新的列表需要加上 key 值key值相当于索引但是 key 值不要用 index ,因为 index 在增加删除的时候可能不变产生混乱推荐用唯一标示 id 对数据改变之后的diff更新比较有很大的性能提升。 PS：如果是单纯只显示的列表不需要操作更新那不需要加 key 。巧用nextTick小程序和vue写法比较相似也有 nextTick ,在当前同步流程结束后下一个时间片执行 。 比如有些取视图层的数据可以等页面上流程结束后再取比较准确wx.nextTick(() => {      query.select('.percent-line-toast').boundingClientRect()     })处理后台运行的jssetTimeout一定伴随着clearTimeout setInterval一定伴随着clearInterval 这些我们经常会滚动算高度倒计时动画中用到。当我跳到了另外一个页面还在运行小心后台页面的jswx.hide的坑两个都是基于同一个原生toast实例实现的wx.showLoading()与wx.showToast(), 同时只能显示一个 wx.hideLoading()也会隐藏Toast ; wx.hideToast()也会隐藏Loading 失败的提示toast会一闪而过的问题可能时因为调用了wx.hideLoading()。http需变httpsHTTP是明文传输有篡改内容的风险而且有些安卓机会不兼容。所以我们需要使用https。 所以开需求评审的时候要注意后端要写成https如果是运营配的数据后端最好有个转https方法输入了url自动转成https链接。在微信开发者工具中可勾选”不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书”规则即可用http但是在实体里并没有这个选项所以建议开发时就用https路径。埋点的坑埋点用公共方法页面曝光 pv 埋点放入 onshow 生命周期中更加准确。预加载1.数据预加载 上个页面就将接口请求好存到对象中下个页面直接从对象中拿有利有弊从业务角度出发看是否需要预加载数据 storage也可以存储数据同一个微信用户同一个小程序 storage 上限为 10MB。分包预加载preloadRule preloadRule预下载分包行为在进入某个页面时触发享有共同的预下载大小限额 2M。\"preloadRule\": { \"sub1/index\": {   \"packages\": [\"important\"] }}3.图片预加载 对视觉效果要求越来越高多张图片如果想动画显示流畅可以先加载图片直接用request先请求图片下来。setData注意点1. 频繁的去 setData存在将未绑定在 WXML 的变量都不需要传入 setData。 2. 每次 setData 都传递大量新数据可局部更新this.setData({    list[index] = newList[index]})3. 后台态页面进行 setData当页面进入后台态（用户不可见）不应该继续去进行 setData 后台态页面的渲染用户是无法感受的另外后台态页面去 setData 也会抢占前台页面的执行。也就是上文提到的不要忘了 clearTimeout 、 clearInterval 。四、其他使用分包由于小程序包大小有限制整个小程序所有分包(包括独立分包和普通分包)大小不超过 8M单个分包/主包大小不能超过 2M建议把首屏不需要展示的都放入分包中分包就像H5打出的chunk包一样可以按需加载。及时清理没有使用到的代码和资源在日常开发的时候我们可能引入了一些新的库文件而过了一段时间后由于各种原因又不再使用这个库了我们常常会只是去掉了代码里的引用而忘记删掉这类库文件了。目前小程序打包是会将工程下所有文件都打入代码包内也就是说这些没有被实际使用到的库文件和资源也会被打入到代码包里从而影响到整体代码包的大小。sitemap 配置小程序根目录下的 sitemap.json 文件用于配置小程序及其页面是否允许被微信索引文件内容为一个 JSON 对象如果没有 sitemap.json 则默认为所有页面都允许被索引.单元测试miniprogram-simulate模拟 touch 事件、自定义事件触发 选取子节点 更新自定义组件数据 触发生命周期检测工具开发者工具自带检测评分页面可以分析页面存在的问题。wxss 覆盖率较低有些动画样式比如 @keyframes 是检测不到的。以及可以通过性能面板查看页面性能。小伙伴们有其他建议欢迎留言评论^ ^                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序生命周期与性能指标               小程序入门看这篇就够了                                                        原作者: 前端妹子                   来自: 前端妹子的博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发中各种跳转方式的区别 ", "author": "                  Rolan                  2019-10-21 00:48                ", "text": "                                                                                                                                                                                     wx.navigateTo、wx.redirectTo、wx.reLaunch、wx.switchTab和wx.navigateBack有什么区别呢？wx.navigateTo：用于保留当前页面、跳转到应用内的某个页面使用 wx.navigateBack可以返回到原页面。对于页面不是特别多的小程序通常推荐使用 wx.navigateTo进行跳转 以便返回原页面以提高加载速度。当页面特别多时则不推荐使用。wx.redirectTo：当页面过多时被保留页面会挤占微信分配给小程序的内存或是达到微信所限制的 5 层页面栈。这时应该考虑选择 wx.redirectTo。wx.redirectTo()用于关闭当前页面跳转到应用内的某个页面。这样的跳转可以避免跳转前页面占据运行内存但返回时页面需要重新加载增加了返回页面的显示时间。wx.reLaunch：wx.reLaunch()与 wx.redirectTo()的用途基本相同 只是 wx.reLaunch()先关闭了内存中所有保留的页面再跳转到目标页面。wx.switchTab：对于跳转到 tab bar 的页面最好选择 wx.switchTab()它会先关闭所有非 tab bar 的页面。其次也可以选择 wx.reLaunch()它也能实现从非 tab bar 跳转到 tab bar或在 tab bar 间跳转效果等同 wx.switchTab()。使用其他跳转 API 来跳转到 tab bar则会跳转失败。wx.navigateBack：用于关闭当前页面并返回上一页面或多级页面。开发者可通过 getCurrentPages() 获取当前的页面栈决定需要返回几层。这个 API 需要填写的参数只有 delta表示要返回的页面数。若 delta 的取值大于现有可返回页面数时则返回到用户进入小程序的第一个页面。当不填写 delta 的值时就默认其为 1（注意默认并非取 0）即返回上一页面。本文来自木庄网络博客> wx.navigateTo、wx.redirectTo、wx.reLaunch、wx.switchTab和wx.navigateBack的区别                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序技能进阶回忆录 - 在缺少组件化的日子里               小程序自定义头部导航栏“完美”解决方案                                                        原作者:  木庄                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序生命周期与性能指标 ", "author": "                  Rolan                  2019-5-5 00:47                ", "text": "                                                                                                                                                                                     本文将介绍微信小程序整个App的生命周期、单个页面的生命周期和组件的生命周期并研究了这三个元素生命周期的关系这在学习和开发过程中对理解小程序运行机制有重要意义。最终由生命周期整理出小程序的关键指标仅供参考。App的生命周期在app.js中有其生命周期相关的三个方法：onLaunch、onShow和onHide。首先是onLaunch这是整个小程序的第一个生命周期回调函数在小程序初始化完成后调用。接着小程序将触发onShow事件如果小程序从后台切回前台后也会触发该事件。最后是小程序切到后台的事件onHide。Page的生命周期在每个页面注册函数Page()的参数中有生命周期的方法：onLoad、onShow、onReady、onHide、onUnload。页面触发的第一个生命周期回调是onLoad在页面加载的时候触发其参数是页面的query参数一个页面只有一次；接着是onShow监听页面的显示与onLoad不同如果页面被隐藏后再次显示（例如：进入下一页后返回）也会触发该生命周期；触发onShow之后逻辑层会向渲染层发送初始化数据渲染层完成第一次渲染之后会通知逻辑层触发onReady生命周期一个页面只有一次；onHide是页面隐藏但未卸载的时候触发的如 wx.navigateTo 或底部tab切换到其他页面小程序切入后台等。onUnload是页面卸载时触发如wx.redirectTo或wx.navigateBack到其他页面时。Component的生命周期组件最重要的生命周期是created、attached、detached 包含一个组件实例生命流程的最主要时间点。首先当组件实例刚被创建时 created生命周期被触发。此时还不能调用setData 。 通常情况下这个生命周期只应该用于给组件this添加一些自定义属性字段。接着在组件完全初始化完毕并且进入页面节点树后 attached生命周期被触发。此时 this.data 已被初始化为组件的当前值绝大多数初始化工作可以在这个时机进行。在组件离开页面节点树后 detached生命周期被触发。退出一个页面时如果组件还在页面节点树中则 detached 会被触发。此外组件生命周期还有ready和move生命周期分别在视图层布局完成和组件实例被移动到节点树另一个位置时执行。整体周期现在我们知道了App、Page、和Component分别的生命周期顺序那么他们之间的生命周期顺序又是如何？通过开发一个简单的demo观察运行结果可以得到如下结论：打开页面的情况首先前一个页面隐藏在加载下一个页面之前需要先初始化新页面的组件。页面首次渲染之后会触发组件的ready最后触发的是页面的onReady如下图：从PageA打开pageB时的生命周期顺序离开页面的情况离开当前页面时首先触发当前页面的卸载onUnload接着是组件离开节点树的detached。最后显示之前的页面触发onShow。如下图：从PageB返回到PageA的生命周期顺序打开App的情况App、Page与Component生命周期运行顺序先从App加载然后再加载Page在加载Page之前会先初始化该页面所用的所有组件之后才触发页面的onLoad生命周期如下图：打开App时的生命周期顺序切换到后台切换到后台时小程序和页面并没有卸载只会触发隐藏。先触发页面的onHide接着是App的onHide。如下图：切换到后台时的生命周期顺序切换到前台切换到后台时小程序会先触发onShow之后才是页面的onShow。如下图：切换到前台时的生命周期顺序关键性能指标了解了小程序各个阶段的生命周期我们可以制定出关键节点的性能指标整理如下表：参考文档官方文档 Page：developers.weixin.qq.com/miniprogram…官方文档 App：developers.weixin.qq.com/miniprogram…官方文档 页面生命周期：developers.weixin.qq.com/miniprogram…官方文档 组件生命周期：developers.weixin.qq.com/miniprogram…                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发需要注意的一些规范               微信小程序开发注意指南和优化实践                                                        原作者: w_西城                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发者自助解绑小程序 ", "author": "                  Rolan                  2019-11-14 00:52                ", "text": "                                                                                                                                                                                     最近在帮朋友开发小程序时朋友突然告诉我不能绑定开发者了。但是就比较纳闷问了下才知道一个微信号只能绑定为50个小程序的开发者。当时就比较懵了之前我帮过好多人开发过小程序这些小程序都绑定过我为开发者可是具体是那些人真的有点忘记了。就去官方文档搜还真给搜到了。官方给出的解决办法如下由于忘记都有谁绑定过我为开发者了所以只能有第二种方式了。 这不看不知道一看吓一跳啊。我居然被好多根本就没接触过的小程序绑定为开发者了。因为小程序绑定开者太容易了知道你的微信号就可以绑定你为开发者。至于这些人为啥要把我添加为开发者呢想来想去也就这个原因了。一个极速审核奖励。。。。。。大刀阔斧的解绑开发者权限1搜索微信公众号：公众平台安全助手 关注公众号必须要关注公众号。这个我就不多说了2进入公众号对话的主界面左下角找到 <绑定查询> 可以根据手机号、身份证号以及微信号的方式查询这里要用根据 微信号绑定账号 的方式查询。3点击进入后会看到：公众号、小程序、开放平台。因为我们的目的是微信开发者/体验者自主发起解绑小程序账号所以选择的是小程序可以看到你目前作为管理员和作为项目成员分别下面有那些小程序账号在这个页面可以看到每个小程序的头像、名称4以这个大米色选机为例点击会弹出上图的解绑按钮然后点击解绑5解绑以后会有个以下通知这样就解绑成功了后面自己慢慢的把自己用不到的或者自己根本不知道的都给解绑了后面就剩下这几个自己常用的了。这样以后又可以愉快的帮别人改小程序的代码了。是不是清爽很多了今天就到这里了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序导航栏选择每一项居中(scroll-view)               小程序 - 可搜索的地址选择                                                        原作者: 编程小石头                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发技巧 ", "author": "                  Rolan                  2019-11-18 00:43                ", "text": "                                                                                                                                                                                     开发小程序这么久了整理了一些技巧清单分享出来。1、backgroundColor 配置无效页面配置中 backgroundColor 可以设置窗口颜色：{  \"backgroundColor\": \"#f2f2f2\"}复制代码这么设置完之后发现一点效果都没有仔细研究一番原来窗口颜色指的是最底层。（真想说句：卧槽~）解决这个问题很简单使用 page 选择器即可：page {  background: #f2f2f2;}复制代码page 是页面的根节点也就是h5里的 html所以可以用来设置一些样式。2、改变自定义组件根节点样式header组件代码如下：<view class=\"header\">  header</view>复制代码可以看到渲染出来后发现多出 header 节点。在大部分开发中跟组件节点并没有什么用 但是 某些情况下是会影响样式的 比如说弹性布局这里不贴demo了反之此技巧必定用到回头瞧瞧就行。我们可以在自定义组件样式文件使用 :host 选择器修改跟组件节点：:host {  padding: 50px;}复制代码可以对比上图盒子模型3、block标签是什么block 标签其实就类似于 react 中的 Fragment, Vue中的 template。如果没接触过 react/vue 没关系看下面例子：<block>  <view>say</view>  <view>hello</view></block>复制代码渲染后结果, block 节点消失<view>say</view><view>hello</view>复制代码如果没有block节点需要这么做:<!-- 多渲染了跟节点标签 --><view>  <view>say</view>  <view>hello</view></view>复制代码比较常用的用来配合 wx:if<block wx:if=\"{{ show }}\">  <view wx:for=\"{{ arr }}\" wx:key=\"index\">{{ item }}</view></block>复制代码4、如何设置背景图片搞个背景图片都费劲 [发火]平常在h5中设置背景图片直接引入地址就行background: url(\"/example.png\");复制代码但是在小程序中竟然不可以。。。为啥？？？小程序： 你只能乖乖引入网络图片xx: mmp, 设置个图片都搞那么多花样？ 我觉得...小程序：我不要你觉得 我要我觉得。复制代码xx了。 只能走后门了。1、可以将图片转成 base64 即可：background-image: url(\"data:image/svg+xml;base64,PHN2ZyBjbGFzcz0ibGRzLXNwaW5uZXIiIHdpZHRoPSIxMDlweCIgIGhlaWdodD0iMTA5cHgiICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiIHN0eWxlPSJiYWNrZ3JvdW5kOiBub25lOyI+PGcgdHJhbnNmb3JtPSJyb3RhdGUoMCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ3IiB5PSIyNCIgcng9IjkuNCIgcnk9IjQuOCIgd2lkdGg9IjYiIGhlaWdodD0iMTIiIGZpbGw9IiMwMDAiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIHRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC45MTY2NjY2NjY2NjY2NjY2cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSgzMCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ3IiB5PSIyNCIgcng9IjkuNCIgcnk9IjQuOCIgd2lkdGg9IjYiIGhlaWdodD0iMTIiIGZpbGw9IiMwMDAiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIHRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC44MzMzMzMzMzMzMzMzMzM0cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSg2MCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ3IiB5PSIyNCIgcng9IjkuNCIgcnk9IjQuOCIgd2lkdGg9IjYiIGhlaWdodD0iMTIiIGZpbGw9IiMwMDAiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIHRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC43NXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGU+CiAgPC9yZWN0Pgo8L2c+PGcgdHJhbnNmb3JtPSJyb3RhdGUoOTAgNTAgNTApIj4KICA8cmVjdCB4PSI0NyIgeT0iMjQiIHJ4PSI5LjQiIHJ5PSI0LjgiIHdpZHRoPSI2IiBoZWlnaHQ9IjEyIiBmaWxsPSIjMDAwIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMTswIiB0aW1lcz0iMDsxIiBkdXI9IjFzIiBiZWdpbj0iLTAuNjY2NjY2NjY2NjY2NjY2NnMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGU+CiAgPC9yZWN0Pgo8L2c+PGcgdHJhbnNmb3JtPSJyb3RhdGUoMTIwIDUwIDUwKSI+CiAgPHJlY3QgeD0iNDciIHk9IjI0IiByeD0iOS40IiByeT0iNC44IiB3aWR0aD0iNiIgaGVpZ2h0PSIxMiIgZmlsbD0iIzAwMCI+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjE7MCIgdGltZXM9IjA7MSIgZHVyPSIxcyIgYmVnaW49Ii0wLjU4MzMzMzMzMzMzMzMzMzRzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDE1MCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ3IiB5PSIyNCIgcng9IjkuNCIgcnk9IjQuOCIgd2lkdGg9IjYiIGhlaWdodD0iMTIiIGZpbGw9IiMwMDAiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIHRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC41cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSgxODAgNTAgNTApIj4KICA8cmVjdCB4PSI0NyIgeT0iMjQiIHJ4PSI5LjQiIHJ5PSI0LjgiIHdpZHRoPSI2IiBoZWlnaHQ9IjEyIiBmaWxsPSIjMDAwIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMTswIiB0aW1lcz0iMDsxIiBkdXI9IjFzIiBiZWdpbj0iLTAuNDE2NjY2NjY2NjY2NjY2N3MiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGU+CiAgPC9yZWN0Pgo8L2c+PGcgdHJhbnNmb3JtPSJyb3RhdGUoMjEwIDUwIDUwKSI+CiAgPHJlY3QgeD0iNDciIHk9IjI0IiByeD0iOS40IiByeT0iNC44IiB3aWR0aD0iNiIgaGVpZ2h0PSIxMiIgZmlsbD0iIzAwMCI+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjE7MCIgdGltZXM9IjA7MSIgZHVyPSIxcyIgYmVnaW49Ii0wLjMzMzMzMzMzMzMzMzMzMzNzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDI0MCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ3IiB5PSIyNCIgcng9IjkuNCIgcnk9IjQuOCIgd2lkdGg9IjYiIGhlaWdodD0iMTIiIGZpbGw9IiMwMDAiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIHRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC4yNXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGU+CiAgPC9yZWN0Pgo8L2c+PGcgdHJhbnNmb3JtPSJyb3RhdGUoMjcwIDUwIDUwKSI+CiAgPHJlY3QgeD0iNDciIHk9IjI0IiByeD0iOS40IiByeT0iNC44IiB3aWR0aD0iNiIgaGVpZ2h0PSIxMiIgZmlsbD0iIzAwMCI+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjE7MCIgdGltZXM9IjA7MSIgZHVyPSIxcyIgYmVnaW49Ii0wLjE2NjY2NjY2NjY2NjY2NjY2cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSgzMDAgNTAgNTApIj4KICA8cmVjdCB4PSI0NyIgeT0iMjQiIHJ4PSI5LjQiIHJ5PSI0LjgiIHdpZHRoPSI2IiBoZWlnaHQ9IjEyIiBmaWxsPSIjMDAwIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMTswIiB0aW1lcz0iMDsxIiBkdXI9IjFzIiBiZWdpbj0iLTAuMDgzMzMzMzMzMzMzMzMzMzNzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDMzMCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ3IiB5PSIyNCIgcng9IjkuNCIgcnk9IjQuOCIgd2lkdGg9IjYiIGhlaWdodD0iMTIiIGZpbGw9IiMwMDAiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIHRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSIwcyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48L3N2Zz4=\");复制代码2、内联节点中使用 backgorund-image<view style=\"background-image: url(example.png)\"></view>复制代码这个方法我就不该说出来~ 因为在真机是无效的。。。（欲哭无泪）3、使用 image这个方法我也懒得详细贴demo了 总之就是使用 image 改改样式设置到底部即可。<view>  <image src=\"example.png\" /></view>复制代码最后：现在的项目本地图片使用是非常少的反正我见过的项目最多也就几张。 所以设置背景图片最简单的方法就是使用base64。5、object-fit无效在h5中使用 object-fit 特性是非常多的它可以对图片保持一定的比例而不会发生变形 如果想了解其具体内容到 MDN在小程序中对图片使用此特性是没有效果的.image {  object-fit: cover;}复制代码解决这个问题也很简单使用小程序自带的属性即可<image src=\"example.png\" mode=\"aspectFill\"></image>复制代码具体属性可到官方查看 mode属性一览6、小程序mock数据在WEB开发中我们会使用 mockjs 进行拦截请求从而模拟数据。在小程序中也可以使用吗？  那当然了 只不过要对小程序 wx.request 处理。1、安装 mockjsnpm i mockjs复制代码2、新建 wxMock.js// 有点水平的应该能看得懂// 微信底层API都是不能重写的所以用到 defineProperty 将其设置可写// 之后重写了底层 wx.request 方法然后做些处理即可const __request = wx.request;const Mock = require('mockjs');Object.defineProperty(wx, 'request', { writable: true });wx.request = function (config) {  if (typeof Mock._mocked[config.url] === 'undefined') {    __request(config);    return;  }  const resTemplate = Mock._mocked[config.url].template;  const response = Mock.mock(resTemplate);  if (typeof config.success === 'function') {    config.success(response)  }    if (typeof config.complete === 'function') {    config.complete(response)  }};module.exports = Mock;复制代码3、使用 wxMock.jsconst Mock = require('wxMock.js')// 平常怎么用的就怎么用Mock.mock('/api/example', {  data: { ... }})复制代码4、在app.js入口文件中引入mockimport \"./mock/index.js\";复制代码7、图片宽度100%高度无法自适应在WEB开发中当把图片设置 100% 时高度会自适应。小程序就是不行不行你看：因为小程序底层已经对 image 添加了宽高了所以默认就是 240px。解决方法是给 image 元素添加 mode 属性<image src=\"example.png\" mode=\"widthFix\"></image>复制代码当添加此模式并给图片设置 100% 宽度后小程序自动计算其高度就可以让图片自适应了。8、properties 能定义多个类型吗？我只能先说可以。此特性是小程序基础库2.6.5新增的可能有些小伙伴不知道。optionalTypes 字段是个数组指定属性类型可以多个。Component({  properties: {    lastLeaf: {      // 这个属性可以是 Number 、 String 、 Object 三种类型中的一种      type: Number,      optionalTypes: [String, Object],      value: 0    }  }})复制代码9、跳转到tabbar无法返回上一层这个问题我估计每一个开发者都经历过。常规页面跳转到 tabbar 页面只能使用 wx.switchTab 此API有个问题是：跳转到 tabBar 页面并关闭其他所有非 tabBar 页面所以当跳转到 tabbar 页面左上角返回键自然就没了所以是无法返回上一层的。用得比较多的场景就是购物车了 某个页面跳转到购物车不可以返回上一层那体验不是很差么。这个问题我就不贴demo了说下其方案。自定义导航头部新增一个返回键自定义 tabbar 组件 这个时候就不存在什么 switchTab 跳转了将购物车页面封装成一个组件然后新建2个页面一个作为tabbar一个作为常规页面目前jd使用这种方案。总结微信小程序开发和 web 还是有一些区别的 小程序的开发灵活度虽然现在没有那么高但随着不断的迭代更新会慢慢得到改善并受到众多开发者的喜爱。这篇文章不会断更只要有些好的技巧会总结下来并分享。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序 swiper 如何多页面高度自适应               云开发如何实现管理员通知消息                                                        原作者: 印度大使                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "适用于小程序的 ES6 ", "author": "                  Rolan                  2019-4-23 00:56                ", "text": "                                                                                                                                                                                     JavaScript内部字符以UTF-16的格式储存每个字符固定为2个字节。对于那些需要4个字节储存的字符（Unicode码点大于0xFFFF的字符）JavaScript会认为它们是两个字符。ES6新增了完全支持UTF-16的方法codePointAt()该方法接受编码单元的位置而非字符位置作为参数返回与字符串中给定位置对应的码位即一个整数值var text = \"a\" ;console.log(text.charCodeAt(0)); // 55362console.log(text.charCodeAt(1)); // 57271console.log(text.charCodeAt(2)); // 97console.log(text.codePointAt(0)); // 134071console.log(text.codePointAt(1)); // 57271console.log(text.codePointAt(2)); // 97二、includes1. indexOf用来查找某个元素的位置如果不存在就返回-1但是不能判断是否有NaN的元素。2. Array.includes()函数判断是否包含某一元素返回 true / false不能定位元素但是能判断 NaN。const arr1 = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', NaN]console.log('%s', arr1.indexOf(NaN)) // -1console.log(arr1.includes('c')) // trueconsole.log(arr1.includes('z')) // falseconsole.log(arr1.includes(NaN))  // true复制代码三、startsWith1. 确定字符串是否以指定字符串的字符开头返回 true/false。注意：区分大小写！2. 接受两个参数：  第一个参数要在此字符串开头搜索的字符；  第二个参数是指定从字符串开始的位置默认从零开始 四、endsWith1. 从字符串的末尾开始查找五、repeat1. 返回一个新字符串表示将原字符串重复n次let str1='a';let str2=str1.repeat(3);console.log(str2)//aaa复制代码六、String.fromCodePoint七、copyWithin1. 用于操作当前数组自身用来把某些位置的元素复制并覆盖到其他位置上去。2. 该函数有三个参数：  target：目的起始位置；  start：复制源的起始位置可以省略可以是负数；  end：复制源的结束位置可以省略可以是负数实际结束位置是end-1。3. const arr1 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]arr1.copyWithin(1, 3, 6)console.log('%s', JSON.stringify(arr1)) // [1,4,5,6,5,6,7,8,9,10,11]复制代码目标的位置不够的能覆盖多少就覆盖多少const arr2 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]arr2.copyWithin(3)console.log('%s', JSON.stringify(arr2)) // [1,2,3,1,2,3,4,5,6,7,8]复制代码start和end都可以是负数负数表示从右边数过来第几个const arr3 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]arr3.copyWithin(3, -3, -2)console.log(JSON.stringify(arr3)) // [1,2,3,9,5,6,7,8,9,10,11]复制代码八、find1. 查找目标元素找到就返回该元素找不到返回undefinedconst arr1 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]var ret1 = arr1.find((value, index, arr) => { return value > 4})var ret2 = arr1.find((value, index, arr) => { return value > 14})console.log('%s', ret1) // 5console.log('%s', ret2) // undefined复制代码九、findIndex1. 查找目标元素找到就返回元素的位置找不到就返回-1var ret3 = arr1.findIndex((value, index, arr) => { return value > 4}) var ret4 = arr1.findIndex((value, index, arr) => { return value > 14})console.log('%s', ret3) // 4console.log('%s', ret4) // -1复制代码十、fill1. 使用制定的元素填充数组2. 参数：  value：填充值。  start：填充起始位置可以省略。  end：填充结束位置可以省略实际结束位置是end-1。const arr1 = [1, 2, 3, 4, 5]arr1.fill(7)console.log(arr1) // [7, 7, 7, 7, 7]复制代码十一、entries()keys()和values() —— 用于遍历数组1. 区别是keys()是对键名的遍历、values()是对键值的遍历entries()是对键值对的遍历for (let index of ['a', 'b'].keys()) { console.log(index) // 0 1}复制代码十二、Array.from1. 将对象转换成数组2. 条件：  1）部署了Iterator接口的对象比如：SetMapArray  2）类数组对象就是一个对象必须有length属性没有length转出来的就是空数组。转换map转换set转换字符串Array.from('hello world') // [\"h\", \"e\", \"l\", \"l\", \"o\", \" \", \"w\", \"o\", \"r\", \"l\", \"d\"]复制代码Array.from('\\u767d\\u8272\\u7684\\u6d77') // [\"白\", \"色\", \"的\", \"海\"]复制代码类数组对象Array.from({  0: '0',  1: '1',  3: '3',  length:4}) // [\"0\", \"1\", undefined, \"3\"]复制代码Array.from({  0: 0,  1: 1})// []复制代码3. 参数： 1）被转换的的对象。 2）map函数。3）map函数中this指向的对象。let diObj = {  handle: function(n){    return n + 2  }}Array.from(  [1, 2, 3, 4, 5],   function (x){    return this.handle(x)  },   diObj) // [3, 4, 5, 6, 7]复制代码十三、Array.of1. new Array()构造数组的时候是有二意性的  构造时传一个参数表示生成多大的数组。  构造时传多个参数每个参数都是数组的一个元素。2.  将一个或多个值转换成数组 === new Array() 传多个参数 的情况                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发——点击按钮退出小程序的实现               微信小程序之自定义倒计时组件                                                        原作者: 玉米同学                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序Page对象重写 ", "author": "                  Rolan                  2019-4-23 00:21                ", "text": "                                                                                                                                                                                     关于重写微信小程序Page对象如下：let orgainPage = Page; // 保存原本的Page对象let basePage = function (data) {  // 生成初始data如果页面已经有该值不在重新赋值  if (typeof data.data.dataVal === 'undefined') {    data.data.dataVal = '具体值';  }  // 重写onLoad默认执行一些初始事件  let orgainOnLoad = data.onLoad;  data.onLoad = function (o) {    // 执行的初始事件 start    // 执行的初始事件 end    orgainOnLoad.call(this, o);  }  // 默认初始方法如果页面已经有该方法不在重写该方法  if (typeof data.orgainFun !== 'function') {    data.orgainFun = function () {      // 执行具体函数 start      // 执行具体函数 end    }  }  return orgainPage(data);}; 重写后的Page可以直接挂到App里面App({  onLaunch() { },   // 直接挂到这边新页面直接调用app.Base替换Page  Base: basePage,  globalData: {}})不直接重写Page是因为使用app.json插件时不允许修改全局变量“Page”。 每个Page页面调用const app = getApp();app.Base({  data: {  }})页面必须有data,不然.call会报错。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    服务端使用 nodejs 获取带参微信小程序码图片               微信小程序开发——点击按钮退出小程序的实现                                                        原作者: 他们的小伙伴                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "5个套路看懂微信小程序开发 ", "author": "                  Rolan                  2019-6-21 00:17                ", "text": "                                                                                                                                                                                     你或许听说过快速入门就是要学最小必要知识。而我最近在看微信小程序的官方教程时发现这个教程虽然简单但对于微信小程序开发来说80%的套路都能从这里学习到你的小程序从0到1可以从这里实现突破。在开始之前先做100字的铺垫。一个页面 = 4个文件小程序的每个页面都是由4个文件组成的 前两个最重要是我们的重头戏。先给这几个文件一个简短的解释：js 文件——数据来源；wxml 文件——页面的骨架；wxss 文件——页面的装饰效果；json 文件——可选配置页面上的零件。另外本文的目标读者是真心想要尝试小程序的无经验开发者英语水平要求中学及格水平以上。另外为了你可以动手跟着做请下载微信开发工具并注册微信小程序。部分语言过于通俗是为了更好的理解。绑定数据现在就开始我们的第一个套路。小程序简易教程 -> 编写代码 -> 创建页面 -> 第二个代码块依照小程序的定义小程序中的每个页面都包含一个js文件。在一个 js 文件中你需要列出这个页面上需要的数据（上图红框中的内容）。也就是说data下面规定的数据（请努力去上图中找到 data）就是页面上需要用到的数据。这就叫做数据绑定。「数据绑定」对你来说可能是个新词汇。这里先不急着理解我们的目标是会用会用了就能理解一大半了。怎么应用「数据绑定」呢？只需要两步：1声明；2使用。声明的格式是这样的（类似上图中的内容）：Page({data: {greeting: 'Hello World'}//...})在微信开发工具中是这样的：注意看红框中的内容和上面的代码块是一样的注意看 data 那个部分我声明了名字为greeting的数据。（所谓数据学名应该叫变量但在我们的教程里可以近似理解。）第二步是使用。使用的意思是我们到页面上把这个数据显示出来。方法是这样的：{{greeting}}注意看{{ }}之间的部分我们只需要把刚刚定义好的数据名称写在两个大括号里就行了。顺带一提这种使用数据的方法叫做八字胡方法（英文Mustache）因为加上的两个大括号可以想象成嘴上的胡子。或许记住了胡子你就记住了这种使用方法。这就完成了我们的第一个套路——数据绑定。简单吧！但是这里有一个疑问我们在哪里使用绑定好的数据呢？也就是问在哪里使用{{greeting}}这句程序呢？答案是我们的页面上也就是 wxml 这个文件中。这就是我们的下一个套路——显示数据。显示数据上一个套路的讲解中我们出现了这样一句程序{{greeting}}。这是在使用数据。但这行代码的完整版其实是这样的：<text class=\"your-class\">{{greeting}}</text>在微信开发工具中的样子是这样的：还是看红框内的内容也请注意这是在 wxml 文件中我们对{{greeting}}这一部分已经熟悉但对于它前面和后面的代码还不熟悉。所以我们现在进行讲解。显示数据时我们其实希望显示出来的内容是很好看的。但如果你只写成{{greeting}}显示出来的效果并不好：最左边红框中的文字一点装饰效果都没有为了让显示数据有更好看的效果我们需要对{{greeting}}进行装饰。怎么装饰数据呢。我们要用2个东西：标签样式表什么是标签我们从例子中来理解：{{greeting}}两边的<text class=\"your-class\">和</text>就是标签而且分别叫开始标签和结束标签。（你能发现开始标签和结束标签的区别么？）开始标签可以定义一些属性以便调整显示的结果。这就像是你画一幅画可以选择用毛笔来画出国画的效果。在上面的例子中class=\"your-class\"就是<text>这个标签的一个属性<text>标签会表现出class=\"your-class\"的规定的样子。那么class=\"your-class\"这个属性的完整意思是什么呢？他的意思是<text>的 class 对应样式表中的your-class。对你可以把等号理解为对应。而后面的\"your-class\"就是我们在样式表中规定好的一种装饰效果。这里出现了我们的第2个工具：样式表。样式表是写在 wxss 文件中的我们来看看怎么写：.your-class {display: flex;flex-direction: column;align-items: center;color: blue;}在开发者工具中的样子是这样的：你通过理解代码中英文的字面意思就可以了解到我把字的 color 定义为蓝色把位置定义为 center。最重要的是这个样式的名字叫做.your-class而<text>标签中的 class 属性正好指向这个样式所以<text>中的数据会变成中间位置的蓝色字。（在.your-class的最前面有一个点那是对应<text>中 class 属性的特有标记还有类似的标记[1]可以在以后更多的实践中去理解)到这里我们的前两个套路就已经简单的介绍完了。总结一下：绑定数据：在 js 文件中的 Page 模块下面定义 data 的名字并用八字胡方法({{ }})来使用数据。显示数据：在 wxml 中给数据加上标签（比如 text 标签）并且给标签加上属性（比如 class 属性）。class 对应的样式在 wxss 文件中写好。不过我们这里好像缺了什么。我好像没教大家怎么写最后一步的 wxss。微信文档说wxss 和 css 大体上都是一样的[2]。大家可以去找找css的书或者期待我后续的实践教程带你一步一步写一个能上线的小程序。现在如果你把这两个套路循环用起来已经能解决很多问题了。想要多显示一个数据就先在 js文件中绑定这个数据然后去 wxml 文件中装饰数据。下面是绑定两个数据的示例代码：Page({data: {greeting: 'Hello World',farewell: 'Goodbye!'}//其他内容})而对应显示这两个数据的示例代码是这样的：<!--index.wxml--><text class=\"your-class\">{{greeting}}</text><view class=\"your-class\">{{farewell}}</view>在开发者工具中显示的样子是这样的：我在写教程的过程中升级了一次开发者工具所以界面有变化大家可以看到我在最右侧的红箭头处加入了一行新代码 然后显示出了新数据。但是这次不一样的是我用了一个叫做<view>的标签而不是之前的<text>标签。其实 wxml 文件中可以使用很多种标签来显示数据有负责显示图片的有可以负责滚动效果的的他们都被写在微信文档中你在实践的过程中可以查看。比如我使用了一个叫做<icon>的标签然后显示出了一个圆形的图标：有了「绑定数据」和「显示数据」这两个套路我们已经能够写出一个简单的页面了。能够做到展示但没有交互所以我们进入第三个套路：绑定交互。绑定交互绑定交互这个名字听起来有没有和之前的「绑定数据」很像？他们的操作方法也很相似。绑定交互分为两步：声明：在 js 文件中声明交互的名称。使用：在 wxml 文件中使用这个交互。先来看「声明」。怎么声明一个交互呢？（或者用微信文档的说法怎么来声明一个事件呢？）请在 js 文件中写下这样几行代码就在我们之前绑定数据的 data 模块下面：changeWord: function() {this.setData({farewell: 'Never Say Goodbye!'})}在开发者工具中的样子是：这样我们就声明了一个叫做changeWord的交互。这个交互的具体内容是改变 farewell 这个数据的内容。原来是Goodbye!现在我们要改成Never Say Goodbye!。而这个声明中functionthissetDate都是什么意思我们在后面实践中再讲大家关注的重点是这个声明中最前面的部分也就是这个交互的名字：changeWord。我们已经声明完了这个交互现在就该进入第2步——使用交互。请在 wxml 中插入这样的代码片段：<button bindtap=\"changeWord\" type='primary' class=\"your-button\" size='default'>改变文字</button>在开发者工具中的的样子是这样的：这里的重点是bindtap=\"changeWord\"大家可以看到我们刚刚声明的交互changeWord出现了那前面的bingtap=是什么呢？他的意思是：把点击事件的交互对应到changeWord。当你点一下图中的那个绿色按钮我们的页面就会把Goodbye!换为 Never Say Goodbye!除了利用标签的bindtap属性来绑定交互还可以用bindlongtap（绑定长按事件）bindtouchmove（绑定触摸后移动事件）等等他们都有各自的效果。具体内容都被写在事件相关的文档中你可以亲自试一下。你会发现他们的开头都是 bind就好像单词的前缀一样加上taplongtap等后缀就能帮你绑定一个交互。（绑定事件的前缀还有另外一种叫catch比如catchtapcatchtouchmove等等你可以结合文档试验一下他们的效果）[3]到这里我们已经能够简单的绑定交互了。但绑定交互的核心目的是要改变页面上的显示从而给用户一个反馈。下面就让我们来看看第4个套路：修改显示。执行交互就像绑定数据之后要去显示数据。我们绑定交互之后也要让交互被执行这样才有意义。而交互的执行内容就写在被声明的交互的下面：changeWord: function() {// 这里写交互的实际内容}我们这里介绍两种交互内容的写法足够解决很多问题了：修改页面数据弹窗第一种修改页面数据。我们在上一个套路的实例代码中已经见过：changeWord: function() {this.setData({farewell: 'Never Say Goodbye!'})}这几行代码中间的部分就是要执行的交互内容：this.setData({farewell: 'Never Say Goodbye!'})即使你不懂得javaScript编程语言也完全可以从英语的字面意思去理解这几行代码。这3行代码是在说我这个页面(this)要修改数据(setData)中的farewell为 Never Say Goodbye!。如果你想修改其他数据比如greeting你可以如法炮制：changeAnotherWord: function() {this.setData({greeting: 'Hello, again!'})}你会发现这里面有很多结构是固定的。变化的部分只有交互的名称（变成了changeAnotherWord）和要修改的数据（变成了greeting: 'Hello, again!'）。如果你也想修改页面上的数据请如法炮制。我们要介绍的第二种交互方法是弹窗而且是微信内建的弹窗。首先还是要做一下绑定交互这个套路：1在 js 文件中声明一个交互；2在 wxml 中使用这个交互。声明交互的代码如下（在 js 文件中）我们用showConfirmation作为名称： showConfirmation: function() { var that = this wx.showModal({ title: '提示', content: '你确定要更改文字吗？', showCancel: true, cancelText: '取消', confirmText: '确定', success: function (response) {  that.changeWord() } }) }在微信开发者工具中是这样的：先不要在乎这里面陌生的代码我们继续看使用交互的部分：<button bindtap=\"showConfirmation\" type='primary' class=\"your-button\" size='default'>改变文字</button>我把上一个套路中出现的 button 改写成了绑定到这个showConfirmation在微信开发者工具中的样子是这样的：写完之后我再去点「改变文字」的按钮就会出现对话框：箭头连接的两部分是一样的你发现了吗你会发现所有的不一样都只是在 js 文件中showConfirmation的下面其他的部分都符合我们以前的套路。那我们就看看那段陌生的代码： var that = this wx.showModal({ title: '提示', content: '你确定要更改文字吗？', showCancel: true, cancelText: '取消', confirmText: '确定', success: function (response) {  that.changeWord() } })我们从wx.showModal看起这是一个微信内建的代码表达方式从英文的字面就能理解他是什么意思：请微信（wx）显示一下对话框（showModal）。那怎么用这个工具呢微信的文档里面已经写好了：我们只需要像填空一样把制作对话框需要的 title, content, showCancel 等需要填充的地方填好就可以了。这样微信会帮助我们制作出一个对话框。但在这段代码中有一个比较难解释的地方就是var that = this和that.changeWord()。你能猜到他们是联动的因为他们都有一个that。具体的意思是：把这个页面存储在那个地方（var that = this）让那个地方的数据中的文字改变（that.changeWord()）。为了避免混乱我们暂时解释到这里。而且这两行也不影响我们制作一个对话框。因为制作对话框只需要做一件事[4]：使用wx.showModal跳转到这里我们已经能在一个页面上使用4个套路了：绑定数据显示数据绑定交互修改数据。如果你的小程序比较复杂那么是时候跳转到下一个页面来开辟一片新战场。要跳转到下一个页面我们只需要最后一个套路：跳转。跳转本质上也是一种交互我们完全可以用上面提到的「绑定交互」和「执行交互」来实现。再重复一遍这两步：1在 js 文件中声明一个交互；2在 wxml 中使用这个交互。我们先在 js 文件中声明一个名为navigateToLogs的交互：navigateToLogs: function() {wx.navigateTo({url: '/pages/logs/logs'})}在开发者工具中的样子是这样的：这里面有我们不太熟悉的代码比如wx.navigateTo根据上一个套路的经验你已经能够大致猜到他的意思了对么？不过我们还是把下一步走完再说。在 wxml 中使用这个交互：<button bindtap=\"navigateToLogs\" type='default' class=\"your-button\" size='default'>跳转</button>在开发者工具中的样子是这样的：好了现在如果我们点一下「跳转」按钮他就会跳到下一页。已经看完了效果我们回来看那段不熟悉的代码：wx.navigateTo({url: '/pages/logs/logs'})这一次我们依然可以从字面理解：请微信（wx）导航到（navigateTo）logs 路径下的页面（url: '/pages/logs/logs'）。其中 url 这个数据是微信要求的在文档中可以找到他的说明我们依然是照着文档来填空就可以了[5]。这里面有一点需要说明新页面的地址叫做'/pages/logs/logs'他是从哪里来的呢？大家看下图红框中的文件结构会发现 logs 这个页面的地址就是 pages 文件夹下面的 logs 文件夹下面的 logs 文件（有4个文件但都叫 logs）用标准的格式表示就成了我们刚刚提到的/pages/logs/logs。更进一步按照微信的规定我们还需要把他写在一个叫做app.json的配置文件中这样微信才允许我们跳转到那个路径。总结一下好了到这里我们把5个套路都学完了。如果你能把他们组合起来不断使用你就能制作一个用很多功能的小程序：绑定数据——在 js 文件中声明数据名称显示数据——在 wxml 中写出数据显示的位置并在 wxss 中写出装饰效果绑定交互——在 js 文件中声明交互的名称执行交互——在 js 文件中支出要修改的数据或者显示弹窗跳转——跳转到下一页开辟新的战场番外篇——调取微信数据微信小程序其实还有一个隐含套路叫做调用微信提供的接口。用微信官方的话讲就是使用微信的能力。如果没有这些能力微信小程序只能叫小程序而不能叫「微信」小程序。其实我们已经在上面见过一些微信小程序的能力了比如显示弹窗的wx.showModal比如跳转下一页的wx.navigateTo你已经发现他们的特点都是wx.开头。更多的能力还有还有获取用户头像打开扫一扫这样的能力。他们怎么用呢？其实都是查文档看看这个方法需要你提供哪些数据提供给他就好了。用两个字总结就是：填空。最后的最后轻轻说一句对于刚刚入门的开发者最大的坑可能是——忘记保存。因为我曾经也是个新手在很多领域依然是新手甚至还没有入门。希望这份教程能帮到你。共勉。这种标记叫做选择器可以在这个小程序 wxss 文档的选择器那一节找到而且是个简版的css不会用到复杂一点的级联样式另外还有两类特殊的交互为了避免大家混乱我没有讲但在我们后续的教程中会用到感兴趣的朋友可以先了解一下：一类是某些标签特有的绑定方法比如<checkbox-group>便签有一个特有属性 bindchange可以用来绑定交互。另一类是用户关闭和打开页面时绑定的交互比如onLoad这类交互都是以 on 开头的代表这个页面的事件直接在 js 文件中声明不用再 wxml 中绑定到标签。微信还有2个可用弹窗类交互大家可以对照文档进行实验。微信出了提供wx.navigateTo这个跳转方法还提供了其他4个导航相关的方法你可以在实践中体会他们的区别。另外微信还提供了<navigator>标签来实现跳转跟wx.navigateTo等方法实现同样效果为避免混乱这里只留下文档地址不详细举例。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    玩玩微信小程序（多图预警）               基于Proxy的小程序状态管理                                                        原作者: 火龙果软件工程                   来自: 火龙果软件工程                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "从0开始搭建微信小程序(前后端)的全过程 ", "author": "                  Rolan                  2019-4-16 00:42                ", "text": "                                                                                                                                                                                     有段时间比较闲就尝试着做了一个微信小程序一是为了锻炼自己独立部署一个前后端全链路系统的能力二是想做一个自己都想用的小程序出来。方向是让用户可以集中获取优质的电影、音乐、书籍、游戏等信息的推荐那什么是优质的信息呢？我这里假设的是排行榜里越靠前的信息就越是优质的信息于是就做了一个这几类信息的排行榜小程序当然排行的信息不是我随便瞎编的数据来源主要是豆瓣以及其他一些排行网站希望排行数据是权威和客观的能最大化的减少用户获取优质资源的成本。下面讲解的可能不会太详细毕竟想呈现的是一个全过程弄一个非常详细的图文教程反而显得有些冗长有些详细操作过程需要读者自己去参照相关文档有些文档链接也会给出。OK准备好了吗？一起开始这趟快乐的旅程吧。准备工作工欲善其事必先利其器。要做的事明确了那怎么做呢？需要准备什么呢？ 下面我将我涉及到的以等式的形式罗列出来：小程序账号 + 微信开发者工具 + 前端代码 + 后端数据 = 微信小程序豆瓣公共API + 参数 = 实时的排行榜数据及详情数据PyCharm + Python + 爬虫代码 = 爬取的排行榜数据Idea + Java + SpringBoot = 后端接口定义腾讯云服务器 + Tomcat + 后端接口定义 = 可访问的后端服务接口域名 + IP + SSL证书 + 备案 = 合法后端接口访问路径前端1. 注册微信小程序账号进入：微信公众平台, 选择小程序的账号类型按照流程进行注册。注意每个邮箱只能注册一个账号。2. 下载开发工具有了账号后我们就可以使用这个账号进行开发了开发用的IDE是腾讯出品的微信开发者工具进入：小程序开发工具下载对应的版本安装即可。3. 开始进入小程序前端开发打开刚下载好的微信开发者工具扫码登录、创建小程序项目。登录微信公众号平台在开发->开发设置->开发者ID中找到你小程序的AppID并填入到项目设置里。接着开始真正具体页面的开发了开发过程参考开发文档：微信小程序接入指南4. 前端开发过程小程序前端开发其实就是在腾讯的开发工具里使用js语言遵循腾讯小程序的开发文档规范进行代码编写。开发过程中可以编译、预览、真机调试等可以使用各种插件可以调用一些公共的api或者自己定义的后端接口也可以使用腾讯提供的云函数。调用的后端接口需要是https开头的并且需要在微信公众平台的开发->开发设置->服务器域名里配置好。5. 打包上线开发完成后就可以准备上线了首先在开发者工具里将写好的代码上传点击上传定义版本号和注释再到微信公众平台的版本管理提交审核待审核通过了就表示上线成功了就可以在微信中搜索到你的小程序进行访问了。小结到这里前端的工作就算是完成了其实一般如果不涉及复杂数据处理的话后端不是必需的直接所有简单数据都存放在前端就行了。如果你的小程序是这样的话那本文到这里就可以结束了。后面的你也不需要看了。如果你需要更灵活的交互更复杂的逻辑那后端接口则必不可少了。那更复杂的后端数据接口又是怎么完成的呢跟着我继续往下走你就知道了。后端后端主要是提供给小程序数据接口让小程序各个页面都能有排行榜数据展示这里我提供的是http接口返回的Json格式的字符串。使用的语言是Java使用的框架是SpringBoot将最终的java代码打包成war包部署在云主机上的web服务器Tomcat中Tomcat就可以自动的将通过url过来的请求分发到我的程序代码的处理逻辑中处理完请求拿到相应的数据则以Json字符串的格式返回。主要流程如下图：服务器搭建1. 购买云服务器首先要存放后端程序代码需要一台机器自己的电脑虽然也可以但是自己的电脑可不能保证24小时都开机且让外网能访问到所以需要购买一台云服务器；其次外网能访问到意味着需要一个公网IP购买的云服务器会配套一个对应的IP地址。这里我使用的是腾讯云服务器进入官网购买：腾讯云选择服务器的配置付款即可。基于经费预算以及实际需要（其实还是因为舍不得花钱）的考虑我这里选择的是比较低配的机器：CPU：1 核内存：1 GB公网带宽：1 Mbps操作系统：CentOS 7.5 64位系统盘：高性能云硬盘共 50 GB数据盘：高性能云硬盘共 50 GB2. 购买域名域名是用来映射到IP上便于直接使用域名访问其绑定IP所在的服务器。虽然直接用IP和端口的形式也可以访问到我们购买的云服务器但是一来IP不好记二来微信不允许使用IP加端口形式的url。所以只能“慷慨解囊”购买一个域名了。域名可以在任意域名服务商购买我为了方便也是直接在腾讯云上买的购买链接：域名注册3. 域名解析买好了域名那这个域名怎么用呢不和IP配套使用的域名是没有任何意义的域名。这里我们需要将这个域名或者其子域名绑定在我们需要对外提供服务的服务器所对应的IP上也就是我刚刚购买的云服务器的IP上。在腾讯云后台的云解析里点击你的域名添加记录一般主要是添加A记录也就是将域名绑定到IPv4地址上可以添加多条以主机记录区分各级的域名@表示直接使用二级域名xxx.com其他的则表示使用三级或更多级的域名挂在你自己二级域名以下的多级域名都归你管。4. 域名备案为什么要域名备案呢？这个普天之下莫非王土互联网这块一亩三分地自然也是属于国家的不能随随便便让你接入服务。要想在这块地开垦拓荒不是不可以只是需要向国家报备接受监管。整个小程序的搭建过程域名备案花的时间是最长的花了十几二十天。进入备案页面：备案管理开始备案详细的我就不多说了 备案过程详情参考：网站备案 主要流程包括下面几个：(1) 办理幕布拍照     (2) 验证备案信息     (3) 填写主体信息     (4) 填写网站信息     (5) 上传材料     (6) 确认备案信息提交初审     (7) 通过审核完成备案5. 购买SSL证书为什么需要SSL证书呢？因为配置了SSL证书后可以让我们的url以https开头这是微信小程序中要求的域名访问方式以加密传输的方式更加安全。说是购买其实你可以选择免费的证书“购买”一样可以达到目的只是没有付费的加密功能强安全性自然弱了一等。不过这也阻拦不了我选择免费的毕竟穷字当头。进入购买页面：SSL证书, 选择你要购买的证书的配置下单付钱即可将证书下载下来后续配置web服务器用得着。小结经过了前面5个大步骤这时我们的服务器具备了使用https协议通过域名访问的能力。接下来的工作就剩下开发我们的后端接口以及把后端程序代码部署到这台服务器上供小程序访问。后端程序开发环境：开发语言：Java 8开发集成环境：IntelliJ IDEA Ultimate 2017web框架：Springboot构建工具：Maven安装这些工具就不细讲了网上一大堆教程而且要是不懂后端开发的安装了这一套环境也没用这里姑且假设读者也是懂一定的后端开发知识。下面列出最主要的一部分Java代码来说明后端程序是怎么提供的http接口：@RestController@RequestMapping(value = \"/movie\")public class MovieListController extends MovieBaseController{    private static final Logger log = org.slf4j.LoggerFactory.getLogger(MovieListController.class);    /**     * 豆瓣top250电影     * test: http://localhost:8080/movie/top250?start=0&limit=10     */    @RequestMapping(value = \"/top250\")    public CommonRespVo<List<ListCommonVo>> getMovieTop250() {        try {            HttpServletRequest request = this.getHttpServletRequest();            String start = request.getParameter(\"start\");            String limit = request.getParameter(\"limit\");            String url = String.format(\"https://api.douban.com/v2/movie/top250?start=%s&count=%s\",start,limit);            JSONObject jsonObject = HttpUtil.getInfoFromHttpApi(url);            List<ListCommonVo> listCommonVos = this.movieListDataTrans(jsonObject);            if (CollectionUtils.isNotEmpty(listCommonVos)) {                return new CommonRespVo(listCommonVos, CommonRespVoCode.SUCCESS);            }        } catch (Exception e) {            log.error(\"获取豆瓣top250电影信息异常\",e);        }        return new CommonRespVo(CommonRespVoCode.FAILED.code, \"未获取到数据\");    }        /**     * 华语top100电影     * test: http://localhost:8080/movie/chinaTopMovie?start=0&limit=10     */    @RequestMapping(value = \"/chinaTopMovie\")    public CommonRespVo<List<JSONObject>> getChinaTopMovie() {        try {            List<JSONObject> result = this.getSubList(Lists.newArrayList(ChinaTopMovieData.chinaTopMovieData));            if (CollectionUtils.isNotEmpty(result)) {                return new CommonRespVo(result, CommonRespVoCode.SUCCESS);            }        } catch (Exception e) {            log.error(\"获取华语Top电影信息异常\",e);        }        return new CommonRespVo(CommonRespVoCode.FAILED.code, \"未获取到数据\");    }    //省略后续代码}复制代码上面这段代码就是其中的两个接口一个是通过公共API获取豆瓣top250电影信息一个是通过爬虫数据获取的华语top100电影信息。可以看到SpringBoot使用RestController注解表明此类处理http请求并在每个RequestMapping对应的方法上都返回json格式的数据。RequestMapping注解的作用是为每个方法映射一个url。@RequestMapping注解可以作用在控制器类上也可以作用在其下的某个方法上。当在类级别上添加@RequestMapping注解时这个注解会应用到控制器的所有方法上。而方法上的@RequestMapping注解会对类级别上的@RequestMapping的声明进行补充。这就是上面最终的url是类加方法上的路径的原因在本地测试的时候在浏览器里通过url： http://localhost:8080/movie/chinaTopMovie?start=0&limit=10 就可以获取到返回的数据。程序代码开发完成后使用Maven构建项目并将代码打包成一个war包形式的文件在target目录中可以找到该war包后面会讲到这个war包的用途。数据来源排行榜数据是要具有一定的权威性客观性的所以当然不能我随便拿一些数据排列一下就成的我自己又没有能力去统计这几类信息的相关排行所以我就想到了拿来主义：从别人那里拿已经具备一定权威的数据。豆瓣有一些公共开源的api可以拿到我想要的部分数据另外一些数据在其他各大排行榜网站上都有但是没有现成的api把他们的数据提供给我他们既然不给那我只能自己去取了。我使用Python写了一些爬虫软件定期的爬取特定的排行榜网站上的数据用这些数据更新我本地的静态数据这样我的Java程序就可以拿到相对新的数据了。这里其实我还可以做得更好但为了快速的上线我来不及使用数据库落地这些爬取来的数据这样有个不好的结果就是每次服务重启的时候有一段时间的数据不是最新的。这在我的可接受范围内后面有时间再去解决这个问题吧。豆瓣的api示例： api.douban.com/v2/movie/to… 通过这个url可以批量分页的拿到top电影榜的数据。python爬虫则使用的是urlopenurllib.request.urlopen()函数是用于实现对目标url的访问返回url对应的网页数据。再使用BeautifulSoup对网页数据进行解析主要是遍历搜索文档树从而拿到自己想要的那部分数据。部署后端程序准备：云服务主机： 腾讯云服务器Web应用服务器：Tomcat 8JRE：Java 8SSL证书：Tomcat对应的SSL证书FTP传输工具：FileZilla首先登录购买的那台云服务器部署前先安装好环境主要是安装JRE和Tomcat安装好后还需要对Tomcat进行一番配置。1. 安装环境安装JRE 点击下载Java运行时环境： Java SE Runtime Environment 8u201 下载后安装。安装Tomcat 需要提前安装好Tomcat。进Tomcat官网下载对应版本的Tomcat压缩包：Apache Tomcat将下载好的压缩包拷贝至指定的目录并解压我这里是拷贝到 /usr/local 。2. 配置Tomcat配置Tomcat的环境变量配置过程参考： Apache Tomcat User Guide把我们之前购买并下载好的SSL证书配置在Tomcat中具体配置过程参考:Tomcat 证书部署或者参考官网文档： SSL/TLS Configuration HOW-TO3. 部署应用将我们之前用Maven打包好的war包拷贝到安装Tomcat的webapps目录下如我这里下图的位置：[root@VM_0_12_centos webapps]# pwd/usr/local/tomcat8/webapps[root@VM_0_12_centos webapps]# lsdocs  examples  host-manager  manager  ROOT  wxrank  wxrank.war复制代码这里也就是上图中wxrank.war文件然后去Tomcat的bin文件夹下运行startup.bat启动tomcat即可自动解压war包并部署。小结为了方便上面有些文件是在自己的电脑上下载好了再通过FileZilla上传到云服务器上我自己电脑和云服务器之间的其他文件传输也都是用的这个工具。随着Tomcat的配置以及部署成功我们的后端接口就可以通过url访问到了。还有很多数据没准备好后面有时间再优化优化。另外既然云服务器买都买了怎么着也得充分的利用下所以又在上面搭了一个个人博客点下面我的博客链接看一下效果吧：www.jackielee.cn                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (2)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)w一步一步35135830                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序 template 模版使用方法               微信小程序开发需要注意的一些规范                                                        原作者: 猿奋                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发之页面分享 onShareAppMessage 分享参数用处 ", "author": "                  Rolan                  2019-8-19 00:08                ", "text": "                                                                                                                                                                                     今天下午突然听到群里有人说微信小程序工具更新了,文档也更新了不少内容.顾不上吃冬至的饺子.我就冲进来了.先说分享功能,目前真机尚不能调试.开发工具上可以看看效果.后续还会更新.Page()中加上如下代码后在右上角就会出现三个小白点title:分享的标题.desc:分享一段描述.path:这个参数有点意思.以前在微信中的分享一般都是url.这里是当前页面这里应该是pages/index?id=123这里的id目前还不知道是什么.也就是说以后你可以在微信中像分享一个网页一样分享一个页面了.onShareAppMessage: function () {    return {      title: '垃圾分类黑板报',      desc: '垃圾分类就选垃圾分类黑板报!',      path: '/page/user?id=123'    }  }分享参数用处:我这里没有用到路径后的参数,说个场景:参数是用户昵称,A分享了XXX小程序到微信群里,B点开小程序,弹个toast,”来自A的分享”.                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 - 输入起点、终点获取距离并且进行路线规划（腾讯地图） ... ...               uni-app微信小程序接入人脸核身SDK                                                        原作者:  小时光                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "uni-app微信小程序开发之引入腾讯视频小程序播放插件 ", "author": "                  Rolan                  2019-12-17 00:01                ", "text": "                                                                                                                                                                                     目录导航：登录微信小程序管理后台添加腾讯视频播放插件： 在uni-app中引入插件代码：指定整个小程序可使用：指定到对应的分包中使用：在pages.json全局配置文件中对要使用插件的页面配置如下条件编译代码：　　 在.vue页面中使用腾讯视频播放组件：关于如何获取腾讯视频vid问题： 参考资料：腾讯视频小程序播放插件开发文档：decloud uni-app相关配置：微信小程序特有配置: 文章正文：回到顶部登录微信小程序管理后台添加腾讯视频播放插件：　　正式开始使用腾讯视频小程序插件之前需先在微信公众平台 -> 第三方设置 -> 插件管理处添加插件如下图所示：回到顶部 在uni-app中引入插件代码：　　注意在使用uni-app开发微信小程序时与直接会用微信网页开发工具开发微信小程序是有很大的差别的因为uni-app可开发多平台的原因因此不同平台的开发相应的配置需要放到指定的位置才能够生效。而uni-app引入腾讯视频小程序有两种方式一种是整个小程序可使用（小程序中所有的分包可以使用）第二种是指定对应的分包可使用。指定整个小程序可使用：使用插件之前需要在manifest.json中的mp-weixin内声明使用的插件具体配置参照所用插件的开发文档：1234567891011\"mp-weixin\": {        /* 小程序相关配置 */        \"usingComponents\": true,//是否启用自定义组件模式        \"appid\": \"小程序AppID\",        \"plugins\": {            \"tencentvideo\": {                \"version\": \"1.3.6\",                \"provider\": \"腾讯视频小程序AppID\"            }        }    }指定到对应的分包中使用：如果插件只在（同一个插件不能被多个分包同时引用）一个分包用到可以单独配置到分包中这样插件不会随主包加载可以在pages.json的subPackages中声明插件：1234567891011121314151617{  \"subpackages\": [    {      \"root\": \"package1\",//分包名称      \"pages\": [        \"pages/cat\",        \"pages/dog\"      ],      \"plugins\": {        \"tencentvideo\": {          \"version\": \"1.3.6\",          \"provider\": \"腾讯视频小程序AppID\"        }      }    }  ]}　　回到顶部在pages.json全局配置文件中对要使用插件的页面配置如下条件编译代码：　　12345\"usingComponents\": {    // #ifdef  MP-WEIXIN       \"txv-video\": \"plugin://tencentvideo/video\"    // #endif},回到顶部 在.vue页面中使用腾讯视频播放组件：123456789101112131415<view>           <!--vid中的腾讯视频id最好为动态的数据方便管理-->          <txv-video :vid=\"VideoId\" playerid=\"txv1\"></txv-video></view>  <script>export default {    data() {        return {            VideoId:'c3029q7tdnp'        };    }}</script>　　　回到顶部关于如何获取腾讯视频vid问题：打开网页腾讯视频=>随便找到一个视频点击鼠标右键=>赋值链接地址（仅供参考）如下图所示：  最后取视频连接地址.html前面的那一小串英文数字编号即可下图所示：回到顶部 参考资料：腾讯视频小程序播放插件开发文档：https://mp.weixin.qq.com/wxopen/plugindevdoc?appid=wxa75efa648b60994b&token=&lang=zh_CNdecloud uni-app相关配置：https://uniapp.dcloud.io/component/mp-weixin-plugin微信小程序特有配置:https://uniapp.dcloud.io/collocation/manifest?id=mp-weixin                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序入门看这篇就够了               小程序初实践总结                                                        原作者: 追逐时光                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序 动态加载swiper时不显示的问题（爬坑） ", "author": "                  Rolan                  2020-1-13 00:24                ", "text": "                                                                                                                                                                                     问题一报错信息TypeError: Cannot read property '$$' of undefined    at HTMLElement._attached.wx.getPlatform._touchstartHandlerForDevtools解决方法：因为小程序会保留上一次滑动swiper时候的current所以会出现上次滑动到的current在这次的数据中不存在问题所以每次动态加载swiper-item前需要设置swiper的current属性为0问题二swiper 的current每次设置了0但是还是不显示 swiper检查元素是存在的并且current = -1<swiper current='-1'><swiper>解决方法动态设置swiper-item的数据时还需设置current = 0并且current和swiperList不能在一个this.setData中设置要先setData swiperList 然后在setData current我是这样写的：this.setData({  swiperItem: list},()=>{  this.setData({    current: 0  })})//在每次给swiper赋值之后在它的回调中在赋值current之后没有问题成功解决希望对你有所帮助。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    如何处理小程序独立分包的数据共享问题               京东购物小程序cookie方案实践                                                        原作者:  张优秀                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序实战教程——1.基础知识 ", "author": "                  Rolan                  2019-6-25 00:32                ", "text": "                                                                                                                                                                                                                                                                 微信小程序的语法与vueJS类似没学过vueJS的同学尽量先过一遍vue再看本教程。首先在微信平台中注册一个账号获得开发者AppID如下载微信小程序的开发者工具安装完毕后打开开发者工具创建一个项目将项目名称位置AppID填入即可。2 文件目录及每个文件的功能微信小程序的文件有四类分别是.wxml文件.wxss文件.js文件.json文件。 其中.wxml对应.html文件.wxss文件对应.css文件.json文件是配置文件。pages文件夹中每一个文件夹代表一个页面新建的项目有两个页面分别四index和logs页面每个页面包含一个.js文件一个.wxml文件一个.wxss文件以及一个.json文件。四类文件的作用稍后会讲到。utils文件存放的是工具类这个文件夹是非必须的可以直接删掉。project.config.json与sitemap.json初学者可以暂时不理会。2.1 .wxml文件.wxml文件类似我们写的.html文件但标签上有些不同。使用<view></view>标签代替<div></div>使用<image></image>代替<img/>使用<block></block>标签代替<template></template>引入<text></text>标签等等后续做项目的时候会了解到更多标签。<!--新建项目的index.wxml文件--><view class=\"container\">  <view class=\"userinfo\">    <button wx:if=\"{{!hasUserInfo && canIUse}}\" open-type=\"getUserInfo\" bindgetuserinfo=\"getUserInfo\"> 获取头像昵称 </button>    <block wx:else>      <image bindtap=\"bindViewTap\" class=\"userinfo-avatar\" src=\"{{userInfo.avatarUrl}}\" mode=\"cover\"></image>      <text class=\"userinfo-nickname\">{{userInfo.nickName}}</text>    </block>  </view>  <view class=\"usermotto\">    <text class=\"user-motto\">{{motto}}</text>  </view></view>复制代码2.2 .wxss文件.wxss文件就是.css文件。在app.wxss中控制全局样式在pages文件夹中的页面文件的.wxss文件中控制局部样式。局部样式的优先级大于全局样式。微信小程序推荐的布局方式是弹性布局（ 弹性布局快速入门点这里 ）,使用弹性布局可以很快速的搭建我们的项目。微信小程序为了适配多种不同屏幕大小的设备采取了一种的响应式单位rpx使用rpx单位就好像使用百分比作为单位一样实现响应式布局。rpx是一种相对大小我们使用iphone6的机型时1px=2rpxiphone6的大小为375px*667px对于的rpx为750rpx*1334rpx。关于rpx的更多了解见wxss.html#尺寸单位2.3 .json文件.json文件是项目的配置文件//-新建项目的app.json文件{  \"pages\": [    \"pages/index/index\",    \"pages/logs/logs\"  ],  \"window\": {    \"backgroundTextStyle\": \"light\",    \"navigationBarBackgroundColor\": \"#fff\",    \"navigationBarTitleText\": \"WeChat\",    \"navigationBarTextStyle\": \"black\"  },  \"sitemapLocation\": \"sitemap.json\"}复制代码pages是存放所有页面的数组,每一个使用到的页面都需要写入pages内不需要写文件后缀window属性配置的是状态栏的样式如navigationBarBackgroundColor用于设置背景色navigationBarTitleText设置状态栏显示的文本navigationBarTextStyle设置状态栏文本的颜色只能传入black/white除此之外还可以配置底部导航栏tabBar等等。app.json文件进行全局配置每个页面文件夹下还有一个.json文件用于局部配置局部配置只能配置window属性//局部配置.json文件,这里的配置会覆盖app.json中的window属性{  \"backgroundTextStyle\": \"light\",    \"navigationBarBackgroundColor\": \"#fff\",    \"navigationBarTitleText\": \"WeChat\",    \"navigationBarTextStyle\": \"black\"}复制代码注意事项必须用一对大括号将属性包围起来写成json字符串的格式。属性名必须用双引号包围起来..json文件中不可以写注释。2.4.js文件小程序的生命周期分为应用声明周期和页面生命周期应用声明周期函数在app.js中定义且在小程序运行过程中一直存在内存中处于运行状态在这里可以定义应用声明周期函数以及定义全局变量。每个页面中的.js文件中则可以定义页面声明周期函数等语法类似vueJS。小程序为了提高性能是不允许开发者操作DOM元素的。//新建项目的app.js文件通过App方法声明App({  onLaunch: function () {   //页面渲染前执行  },  globalData: {    //定义全局变量    userInfo: null    }});//页面的.js文件通过Page方法声明Page({    });复制代码3 指令小程序中常用的指令有wx:for、wx:if、wx:elif、wx:else等。//wxml<view>    <text wx:if=\"count>0\">{{count}}</text>    <text wx:elif=\"count<0\">{{count}}</text>    <text wx:else>{{count}}</text></view>//jsdata() {    return {        count:0    }}复制代码wx:if、wx:elif、wx:else的逻辑等同于if else。//wxml<view>    <text wx:for=\"arr\" wx:for-item=\"value\" wx:for-index=\"index\">        {{index}}.{{value}}    </text></view>//jsdata() {    return {        arr:[            '小明',            '小红',            '李雷'        ]    }}输出===><view>    <text>1.小明</text>    <text>2.小红</text>    <text>3.李雷</text></view>复制代码wx:for即循环生成标签。4 事件小程序中不使用click事件而用tab（触摸）事件代替事件的前缀有两种分别是bind和catchbind:tab表示冒泡事件即事件触发后继续冒泡触发后续事件catch:tab表示非冒泡事件即事件触发后不再冒泡类似执行了event.stopPropagation()方法。//实现一个点击加一的计数器//wxml<view>    <text bind:tab=\"addNumber\">{{count}}</text></view>//jsComponent({    //调用组件传来的变量    properties:{    },    //内部变量    data() {        return {            count:0        }    },    //内部方法    methods:{        //点击加一        addNumber() {            this.setData({               count:count+1             });        }    }});复制代码改变data中的属性值必须使用this.setData()方法传入一个对象对象中存放需要改变的属性键值对。bind:tab可以简写为bindtb个人喜欢bind:tab看起来更清晰5 组件对于一个js文件函数就是一个最小的、可复用的代码片段。而组件就是对于一个项目最小的、可复用的代码片段他包括html、css、js代码如我们常见的页面导航栏就可以做成一个组件通过组件名字来使用而不用将导航栏的代码复制粘贴到每个页面中。5.1组件的使用小程序的组件通过Component方法声明//.js文件Component({    properties:{        //接收外接传来的变量    },    data() {        return {            //组件内部的变量        }    },    methods:{        //组件内部的方法    }});复制代码声明完毕之后在需要使用到该组件的页面中进行调用//使用组件的页面的.json文件{    \"usingComponents\":{        //由键值对组成键表示组件的名字值是组件的路径也是不需要文件后缀        \"component-name\":\"/components/component/index\"    }}//使用组件的页面的.wxml文件<view>    <component-name />  <!--不需要传入properties-->    <component-name userName=\"小明\"/>  <!--传入properties--></view>复制代码5.2父子组件的传值首先我们看一下使用组件内部变量的例子我们定义了userName变量并把它渲染到页面当中。//component .wxml文件<view>    <text>Hello {{userName}},how are you?</text></view>//component .js文件Component({    properties:{        //接口外接传来的变量    },    data() {        return {            userName:\"李雷\"        }    }});复制代码5.2.1父组件向子组件传值接着我们接受一个外部的变量并把它渲染到页面上这样就实现了父组件向子组件传值。//component .wxml文件<view>    <text>Hello {{userName}},how are you?</text></view>//component .js文件Component({    properties:{        userName:{            type:String,    //调用该组件时传入的值的类型可以是Number、String、Boolean、Object、Aray、Null(任意类型)            value:\"李雷\"    //默认值调用该组件时未传入userName时则userName的值为预设值李雷        }    },    data() {        return {            //组件内部变量        }    }});复制代码5.2.2子组件向父组件传值子组件向父组件传值的思路一般都是父组件监听一个自定义的事件子组件触发这个事件同时将值传入父组件监听这个事件的时候就可以拿到子组件传过来的值。//component .wxml文件<view>    <text bind:tap=\"clickMe\">Hello world</text></view>//component .js文件Component({    properties:{        //接口外接传来的变量    },    data() {        return {            //组件内部变量        }    }    methods:{        //用户点击Hello world的时候向父组件传值        clickMe() {            //第一个参数为自定义事件名父组件需要监听这个事件第二个参数为需要传的值            this.triggerEvent('clickMe',{msg:'Hello world'});        }    }});//parent.wxml<!--监听clickMe事件--><component bind:clickMe=\"clickMe\"></component>//parent.jsclickMe(event) {    console.log(event.detail.msg);//输出子组件传来的参数Hello world子组件传来的参数都在event.deail中}复制代码5.3注意事项前面我们说到了可以在app.wxss中定义全局样式每个page页面都可以继承全局样式。但组件不同组件只能继承有关字体以及color的样式其他全局样式不能影响到组件的样式。6 声明周期小程序的声明周期分为整个应用的声明周期以及单个页面的声明周期对于初学者来说这部分内容可以先跳过它就像一幅眼镜你自然会知道什么时候需要。6.1 应用生命周期回调函数在app.js中调用的App函数中可以设置应用声明周期的回调函数App({  onLaunch (options) {    //初始化完成后执行  },  onShow (options) {    //进入小程序后执行  },  onHide () {    //离开小程序后执行注意不是销毁如切换其他App时微信处于后台中这时调用onHide  },  onError (msg) {    //小程序出错时执行  }});复制代码6.2 页面的生命周期回调函数Page({  onLoad: function(options) {    //页面初始化后执行  },  onReady: function() {    //初次渲染结束执行  },  onShow: function() {    //进入页面执行  },  onHide: function() {//页面隐藏/切入后台时触发如 wx.navigateTo 或底部 tab 切换到其他页面小程序切入后台等    },  onUnload: function() {    //页面卸载时触发。如wx.redirectTo或wx.navigateBack到其他页面时。  },  onPullDownRefresh: function() {    // Do something when pull down.监听下拉刷新事件,必须开启enablePullDownRefresh  },  onReachBottom: function() {    // Do something when page reach bottom. 监听用户上拉触底事件  },  onShareAppMessage: function () {    // return custom share data when user share.点击转发按钮  },  onPageScroll: function() {    // Do something when page scroll 页面滚动事件  },  onResize: function() {    // Do something when page resize旋转屏幕触发  },  onTabItemTap(item) {    console.log(item.index)    console.log(item.pagePath)    console.log(item.text)  },  // Event handler.  viewTap: function() {    this.setData({      text: 'Set some data for updating view.'    }, function() {      // this is setData callback    })  },  customData: {    hi: 'MINA'  }})复制代码6.3 组件生命周期回调函数Component({  lifetimes: {\tcreated:function() {\t\t//组件实例化的时候执行此时不能调用setData()\t}    attached: function() {      // 在组件实例进入页面节点树时执行    },    detached: function() {      // 在组件实例被从页面节点树移除时执行    },  },});复制代码7零碎知识点7.1<image><image>标签中不管图片多大默认的图片大小宽度为300px,高度为225px所以一定要给图片设置宽高。7.2页面最外层元素html页面中最外层的元素为<html>小程序中的最外层元素为<page>且<page>不需要自己添加啊小程序自动添加的。7.3开启识别转义字符<text></text>标签中默认不能识别&nbsp;&lt;&gt;等转移字符,设置decode属性即可识别这些转移字符。<text>< ><text>==>输出不可识别转移字符< ><text decode=\"{{true}}\">< ><text>==>输出可以识别转移字符< >复制代码7.4 隐藏元素VueJS中使用v-if控制元素是否渲染使用v-show控制元素是否显示。微信小程序中也有对应的操作使用wx:if控制元素是否渲染使用属性hidden控制元素是都显示。<!--渲染且显示(display:inline)--><text>Hello World<text><!--渲染但不显示(display:none)--><text hidden=\"{{true}}\">Hello World<text>复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)zef                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序常用样式汇总               微信小程序实战教程——2实战之模仿知乎                                                        原作者:  再见骷颅王                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序跨页面交互的作用与方法 ", "author": "                  Rolan                  2020-1-7 00:24                ", "text": "                                                                                                                                                                                     去年年末微信小程序的分包大小已经到达了 12M 大小,一方面说明小程序的确逐步为开发者放开更大的权限另一方面也说明了对于某些小程序 8M 的大小已经不够用了。我个人今年也是在开发一个 to B 小程序应用。这里列举一些跨页面交互的场景。对于 B 端应用的业务需求来说小程序开发的复杂度相对比网页开发要复杂一些。一个是双线程的处理机制问题另一个是页面栈之间交互问题。注: 笔者目前只需要开发微信小程序为了在小程序页面中可以使用 properties behaviors observers 等新功能已经使用 Component 构造器来构造页面。具体可以参考\t微信小程序 Component 构造器 。如果你也没有多端开发的需求建议尝试使用可以得到不错的体验。性能优化类对于小程序在页面中点击触发 wx.navigateTo 跳转其他页面中间会有一段时间的空白加载期(对于分包出去的页面空白期则会更长)但是这是小程序内部机制没有办法进行优化。我们只能眼睁睁的等待这段没有意思的空白期过去。当考虑到跳转页面后的第一件事情便是取数逻辑那么我们是否能够进行优化呢？答案是肯定的。我们没有办法直接在当前页面取得数据之后再进行跳转操作(这样操作更不好)但是我们却可以利用缓存当前的请求详情可以参考我之前的博客文章 ——\tPromise对象 3 种妙用 。代码如下:const promiseCache = new Map()export function setCachePromise(key, promise) {  promiseCache.set(key, promise)}export function getCachePromise(key) {  // 根据key获取当前的数据    const promise = promiseCache.get(key)  // 用完删除目前只做中转用途也可以添加其他用途  promiseCache.delete(key)  return promise  }做一份全局的 Map,然后利用 Map 缓存 promise 对象在跳转之前代码为:// 导入 setCachePromise 函数Component({  methods: {    getBookData(id) {      const promise = // promise 请求        setCachePromise(`xxx:${id}`, promise)          },      handleBookDetailShow(e) {      const id = e.detail      this.getBookData(id)       wx.navigateTo({url: `xx/xx/x?id=${id}`})    }  }})而跳转之后的代码也如下所示:// 导入 getCachePromise 函数Component({    properties: {      id: Number      },    lifetimes: {      attached () {        const id = this.data.id          // 取得全局缓存的promise        const bookPromise = getCachePromise(`xxx:${id}`)        bookPromise.then((res) => {          // 业务处理        }).catch(error => {          // 错误处理          })      }    },    methods: {      getBook() {        // 获取数据以便于 错误处理 上拉刷新 等操作        }      }})如此便可以同时处理取数和页面加载的逻辑当然这个对于页面有耦合性不利于后续的删除与修改。但考虑如果仅仅加在分包跳转之间可能会有不错的效果。想要无侵入式可以进一步学习研究\t微信小程序之提高应用速度小技巧 以及\twxpage 框架同时考虑到无论是 ToC 还是 ToC 用户都有可能存在硬件以及网络环境等问题该优化还是非常值得的。当然微信小程序为了减少冷启动时间提供了\t周期性更新 数据预拉取 功能。注: 上面的 promiseCache 只作为中转的用途不作为缓存的用途如果你考虑添加缓存可以参考我之前的博客文章——\t前端 api 请求缓存方案 。通知类如果是 pc 端中进行交互对于数据的 CRUD。例如在详情页面进行了数据的修改和删除返回列表时候就直接调取之前存储的列表查询条件再次查询即可而对于移动端这种下拉滚动的设计就没有办法直接调用之前的查询条件来进行搜索。如果从列表页面进入详情页面后在详情页面只会进行添加或者修改操作。然后返回列表页面。此时可以提示用户数据已经进行了修改请用户自行决定是否进行刷新操作。如在编辑页面修改了数据:const app = getApp()component({  methods: {    async handleSave() {      //...      app.globalData.xxxChanged = true      //...      }  }})列表界面:const app = getApp()component({  pageLifetimes: {    show() {      this.confirmThenRefresh()    }      },  methods: {    confirmThenRefresh() {      // 检查 globalData如果当前没有进行修改直接返回       if(!app.globalData.xxxChanged) return      wx.showModal({        // ...        complete: () => {          // 无论确认刷新与否都把数据置为 false           app.globalData.xxxChanged = false          }        })      }  }  })当然了我们也可以利用 wx.setStorage 或者 getCurrentPage 获取前面的页面 setData 来进行数据通知,以便用户进行页面刷新。订阅发布类如果仅仅只涉及到修改数据的前提下我们可以选择让用户进行刷新操作但是如果针对于删除操作而言如果用户选择不进行刷新然后用户又不小心点击到了已经被删除的数据就会发生错误。所以如果有删除的需求我们最好在返回列表页面前就进行列表的修改以免造成错误。mittgithub 上有很多的 pub/sub 开源库如果没有什么特定的需求找到代码量最少的就是\tmitt 这个库了,作者是喜欢开发微型库的\tdevelopit 大佬,著名的\tpreact 也是出于这位大佬之手。 这里就不做过多的介绍非常简单。大家可能都能看明白代码如下(除去 flow 工具的检查):export default function mitt(all) {  all = all || Object.create(null);  return {    on(type, handler) {      (all[type] || (all[type] = [])).push(handler);    },    off(type, handler) {      if (all[type]) {        all[type].splice(all[type].indexOf(handler) >>> 0, 1);      }    },    emit(type, evt) {      (all[type] || []).slice().map((handler) => { handler(evt); });      (all['*'] || []).slice().map((handler) => { handler(type, evt); });    }  };}仅仅只有3个方法on emit以及 off。只要在多个页面导入 生成的 mitt() 函数生成的对象即可(或者直接放入 app.globalData 中也可)。Component({  lifetimes: {    attached: function() {      // 页面创建时执行      const changeData = (type, data) => {        // 处理传递过来的类型与数据      }      this._changed = changeData      bus.on('xxxchanged', this._changed)    },    detached: function() {      // 页面销毁时执行      bus.off('xxxchanged', this._changed)    }  }})这里mitt可以有多个页面进行绑定事件如果需求仅仅只涉及到两个页面之间我们就可以使用 wx.navigateTo 中的 EventChannel (页面间事件信息通道)。可以参考\t微信小程序wx.navigateTo方法里的events参数使用详情及场景 ,该方案的利好在于传递到下一个页面的参数也可以通过 EventChannel 来通知以便于解决 properties 传递数据不宜过大的问题。注: 一个页面展示很多信息的时候会造成小程序页面的卡顿以及白屏。小程序官方也有长列表组件\trecycle-view 。有需求的情况下可以自行研究这个不在这里详述。鼓励一下如果你觉得这篇文章不错希望可以给与我一些鼓励在我的 github 博客下帮忙 star 一下。博客地址参考文档微信小程序 Component 构造器微信小程序之提高应用速度小技巧wxpagemittPromise对象 3 种妙用前端 api 请求缓存方案                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 接入 腾讯云验证码               从客户端角度窥探小程序架构                                                        原作者:  jump__jump                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "支付宝刚刚发布的“抗疫召集令”，开发者能“捞到”啥好处？ ... ", "author": "                  Rolan                  2020-2-8 00:40                ", "text": "                                                                                                                                                                                     线下门店门可罗雀线上数据却一路飙升。在疫情的影响之下这句话成为不少零售企业逆流而上的真实写照。2月1日绫致集团零售线上小程序交易额为141万；2月2日涨至272万；2月5日增至641万。甚至线上交易总额已经超过线下门店交易额的3倍。此时由线下转至线上这早已不是秘密而无论是企业还是政府在线上化的道路上都“心照不宣”的选择了小程序作为服务的载体。在疫情爆发的第二天武汉、杭州、广州这些疫情严重的地区就开始率先推出了官方小程序用于疫情信息的收集和科普。显然小程序已经成为了这场疫情中救急的“解药”。作为小程序的平台方微信和支付宝都陆续推出了相应的扶持政策：2月3日腾讯宣布设立2亿元资金池发起“战疫开发者公益联盟”并在微信开放社区上线了服务专区连接服务商、开发者的资源为政府部门、医疗机构等快速开发小程序。而支付宝却采用了截然不同的思路昨天支付宝发起了“阿里小程序开发者召集令”不同于微信的平台模式而是利用阿里生态的力量为开发者提供“实在”的资源和各激励措施：对于疫情急需的小程序免费提供的特色开发技术支持和专属的服务通道；阿里平台内亿级的流量支持提供携手阿里云“繁星计划”开发者小程序同步投放到阿里生态内的多个平台；此外还为每个优秀的疫情小程序提供最高50万元的现金奖励。 这种差异化打法引来各路开发者纷纷打call：一方面开发者们虽“受困”于家中但仍需要资金保证正常的生活支付宝此时发起的招募令可谓是“授人以渔”；另一方面不少互联网平台也都在做资源对接的服务而散落在开发者、企业、服务商中的大量潜力未被挖掘以这种方式调动开发者与资源方的积极性能够实现快速响应和高效的资源对接；当然对于整个阿里生态来说通过这种方式让更多人看到阿里生态的能力和创造力也是对外“秀肌肉”的好机会。不过这种方式到底能否切实满足开发者当下的需求？又有哪些具体的政策和规则需要注意？对此晓程序观察（yinghoo-tech）与支付宝深刻聊了聊关于此次“支付宝疫情小程序开发激励计划”的那些事。___1__最高50万元奖励能吸引开发者吗？“最高50万元奖励、支付宝特色能力和技术支持、费用全免。”这是支付宝此次“抗疫小程序激励计划”的主要关键词昨天支付宝也公布具体的激励细则支付宝方面告诉晓程序观察（yinghoo-tech）扶持主要将集中在技术支持方面和资金奖励上当然流量扶持也包含在内。开发是小程序的第一步该计划中支付宝给予开发者的支持可以分成两块。一是阿里云的资源：小程序云资源包3个月免费使用支持用于开发疫情相关小程序所需的后端云资源；小程序云Serverless不限规格不限量免费使用为开发者提供的一键构建后端应用运行环境、后端服务部署、运维监控等能力的一站式小程序部署服务。二是支付宝特色能力的免费开放使用。主要包括：疫情开发者可以通过绿色通道入驻能力实验室使用音视频、蚂蚁森林、AR等特色能力；天猫精灵AI能力免费提供人机语音交互、视觉识别能力音视频播放能力及专项技术接入支持；友盟+提供免费小程序数据统计及专业数据支持服务帮助开发者洞察用户数据波动和行为变化；蚂蚁区块链资源提供开放联盟链上链资源免费GAS资源以及专门接入技术支持服务；值得一提的是支付宝还为此设置了专属极速审核通道：疫情类小程序1小时急速审核、提供官方1对1技术支持服务支付宝的to B服务能力也是其优势所在。 除了技术上的支持在“钱”方面支付宝也有相应的激励其由两部分组成一方面是刚刚提到的小程序云资源和特色能力上的费用减免；另一方面则是“实打实”的现金奖励最高可达50万元。1、针对非模板小程序：单个小程序上线后使用MAU大于5万人每个小程序奖励5万元；若服务上线后被政府、医疗卫生机构、交通枢纽作为官方服务进行使用和推广等奖励还会加码；2、针对小程序模板生成的商家小程序：服务商开发小程序模板上架服务市场后被商家订购后单个小程序使用MAU大于200人且至少有3个商家订购并上线每个奖励300元单个服务商奖励上限50万元。不过想要获得这些奖励除了要达到以上这些要求从审核上看依然有门槛存在。虽然此次计划是面向所有的开发者和服务商但对不同的小程序类型也会存在着不同的门槛和政策某些特定的功能与服务其实还是有相关的资质。比如关于一些疫情数据披露的小程序是需要有媒体资质和医疗资质的或者买菜类小程序就需要卫生许可证、营业执照等这就不建议个人开发者开发。除了资质的审核外支付宝平台对疫情相关服务的质量也有所把控设有专门的保障团队和数据监控在事前、事中、事后三个阶段进行防控：事前进行安全合规、业务合规、技术质量的三个维度并行审核通过智能自检、自动化图文识别等审核产品；上线后会有成长扶持和健康分评估等机制保障结合用户反馈、资金监控等保障消费者服务体验；事后有体系化很多客诉处理保障、风险处置和小程序多手段处置等。“从费用减免这一点来看支付宝的激励计划还是非常有吸引力的”有开发者告诉晓程序观察（yinghoo-tech）,“不过即使支付宝没有发布这样一个计划也有大量疫情相关的小程序上线竞争还是很大所以支付宝能给怎样的流量倾斜也是我们开发者关注的。”可见对于开发者而言虽然技术和资金能够吸引开发者入驻但是他们更关注仍是流量。实际上我们也能看到社会层面对于疫情相关小程序的需求所以流量上扶持力度有多大才是更为现实的问题。___2__有待完善的流量扶持政策流量怎么扶持？如图支付宝会在支付宝首页、疫情服务专题页、小程序发现页、搜索等多入口推荐疫情相关小程序。不仅如此“繁星计划”也来帮忙即“一云多端”开发者只要一次开发就可以在钉钉、高德、手淘等阿里系其他App上同步上线并且可以获得这些平台的入口推荐。当然想要获得推荐“抗疫”小程序需要满足优质小程序的条件：经支付宝开放平台审核有助于疫情防控和疫中疫后恢复运营及便民生活的优质生态小程序具体包括十大类目：口罩预约、疫情上报、在线问诊、代跑腿、社区出入管理、餐饮外卖、送药品、果蔬配送、在线教育、运动健身；小程序性能和服务质量满足用户诉求小程序基础分≥6分：总分0-10；激励期间无严重违规（单次扣分12分及以上的处罚）和重大舆情。目前支付宝尚未公布具体的“推荐标准”。不过我们从多位支付宝相关人士那里了解到虽然支付宝会联合阿里资源为“抗疫”小程序流量开闸但具体的“推荐标准”仍离不开小程序性能和服务质量、用户访问量、用户的喜爱程度等多维度。从开发者的角度想要在众多竞争者中脱颖而出“霸占”支付宝首页除了做好小程序的本身的服务之外运营手段也必不可少比如：1、善用搜索入口比如接入“服务直达”功能。开发者配置支付宝小程序“服务直达”时如果某关键词仅有一家小程序成功申请该卡片位置将由该小程序独占。比如某小程序申请“预约口罩”这个关键词它就会独享该词条的搜索流量。2、用生活号构建消费场景此次开放的十大类目中对于在线教育、运动健身这样的服务场景生活号就是长期培养用户心智的最佳场所。3、收藏获利法。支付宝官方为开发者还提供了“收藏有礼”的能力只要用户收藏小程序就可以获得打折券或者优惠券代跑腿、餐饮外卖、送药品、果蔬配送等服务场景的小程序就可以使用这种方式。在支付宝发布这项计划后我们也第一时间了解了开发者的看法几位开发者都抱着观望态度支付宝的流量扶持一直是优势对于开发者来说很具有吸引力。但这次激励计划中的流量扶持还不够清晰尤其是但在众多同类服务的开放者竞争之下支付宝的流量扶持能给有多大影响还不好说。文章开始我们提到支付宝发布这项“激励计划”可以以这种方式调动开发者与资源方的积极性还能够壮大自己的开发者队伍丰富自己的开发者生态。但是对于支付宝来说开发者能够获得哪些实质性的“好处”才是决定其能否借助这次机会丰富生态的关键。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    腾讯上线新冠肺炎症状自查工具并开放接入               国务院推荐微信到家业务微信预告新能力协助零售行业商家战“疫” ...                                                        原作者: HENG                   来自:  晓程序观察                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序自定义头部导航栏“完美”解决方案 ", "author": "                  Rolan                  2019-10-23 00:03                ", "text": "                                                                                                                                                                                     为什么要做这个？主要是在项目中智酷君发现的一些问题一些页面是通过扫码和订阅消息访问后没有直接可以点击去首页的需要添加一个home链接需要添加自定义搜索功能需要自定义一些功能按钮其实,第一个问题在最近的微信版本更新中已经优化了通过 小程序模板消息 过来的系统会自动加上 home按钮 但对于其他的访问方式则没有支持~一个不大不小的问题：两边ICON不对齐问题智酷君之前尝试了各种解决方法发现有一个问题就是现在手机屏幕太多种多样有 传统头部、宽/窄刘海屏、水滴屏等等 无法八门很多解决方案都无法解决特殊头部系统 “胶囊按钮” 和 自定义按钮在Android屏幕可能有 几像素不对齐 的问题（强迫症的噩梦）。下面分享下一个相对比较完善的解决方案：小程序代码段DEMOLink: https://developers.weixin.qq.... ID: cuUaCimT72cH智酷君做了一个demo代码段方便大家直接用IDE工具查看源码~页面配置1、页面JSON配置{  \"usingComponents\": {    \"NavComponent\": \"/components/nav/common\"  //以插件的方式引入  },  \"navigationStyle\": \"custom\"  //自定义头部需要设置}如果需要自定义头部需要设置navigationStyle为 “custom”2、页面代码<!-- home 类型的菜单 --><NavComponent v-title=\"自定义头部\" bind:commonNavAttr=\"commonNavAttr\"></NavComponent><!-- 搜索菜单 --><NavComponent is-search=\"true\" bind:commonNavAttr=\"commonNavAttr\"></NavComponent>可以在自定义导航标签上添加属性配置来设置功能具体按照实际需要来3、目录结构│├─components│  └─nav│          common.js│          common.json│          common.wxml│          common.wxss│├─images│      back.png│      home.png│└─index        index.js        index.json        index.wxml        index.wxss        search.js        search.json        search.wxml        search.wxss仅供参考插件对应的JS部分components/nav/common.js部分const app = getApp();Component({  properties: {    vTitle: {      type: String,      value: \"\"    },    isSearch:{      type: Boolean,      value: false    }  },  data: {    haveBack: true, // 是否有返回按钮true 有 false 没有 若从分享页进入则没有返回按钮    statusBarHeight: 0, // 状态栏高度    navbarHeight: 0, // 顶部导航栏高度    navbarBtn: { // 胶囊位置信息      height: 0,      width: 0,      top: 0,      bottom: 0,      right: 0    },    cusnavH: 0, //title高度  },  // 微信7.0.0支持wx.getMenuButtonBoundingClientRect()获得胶囊按钮高度  attached: function () {    if (!app.globalData.systeminfo) {      app.globalData.systeminfo = wx.getSystemInfoSync();    }    if (!app.globalData.headerBtnPosi) app.globalData.headerBtnPosi = wx.getMenuButtonBoundingClientRect();    console.log(app.globalData)    let statusBarHeight = app.globalData.systeminfo.statusBarHeight // 状态栏高度    let headerPosi = app.globalData.headerBtnPosi // 胶囊位置信息    console.log(statusBarHeight)    console.log(headerPosi)    let btnPosi = { // 胶囊实际位置坐标信息不是左上角原点      height: headerPosi.height,      width: headerPosi.width,      top: headerPosi.top - statusBarHeight, // 胶囊top - 状态栏高度      bottom: headerPosi.bottom - headerPosi.height - statusBarHeight, // 胶囊bottom - 胶囊height - 状态栏height （胶囊实际bottom 为距离导航栏底部的长度）      right: app.globalData.systeminfo.windowWidth - headerPosi.right // 这里不能获取 屏幕宽度PC端打开小程序会有BUG要获取窗口高度 - 胶囊right    }    let haveBack;    if (getCurrentPages().length != 1) { // 当只有一个页面时并且是从分享页进入      haveBack = false;    } else {      haveBack = true;    }    var cusnavH = btnPosi.height + btnPosi.top + btnPosi.bottom // 导航高度    console.log( app.globalData.systeminfo.windowWidth, headerPosi.width)    this.setData({      haveBack: haveBack, // 获取是否是通过分享进入的小程序      statusBarHeight: statusBarHeight,      navbarHeight: headerPosi.bottom + btnPosi.bottom, // 胶囊bottom + 胶囊实际bottom      navbarBtn: btnPosi,      cusnavH: cusnavH    });    //将实际nav高度传给父类页面    this.triggerEvent('commonNavAttr',{      height: headerPosi.bottom + btnPosi.bottom    });  },  methods: {    _goBack: function () {      wx.navigateBack({        delta: 1      });    },    bindKeyInput:function(e){      console.log(e.detail.value);    }  }})解决不同屏幕头部不对齐问题的终极办法是 wx.getMenuButtonBoundingClientRect()这个方法从微信7.0.0开始支持通过这个方法我们可以获取到右边系统胶囊的top、height、right等属性这样无论是水滴屏、刘海屏、异形屏都能完美对齐右边系统默认的胶囊bar完美治愈强迫症~APP.js 部分//app.jsApp({  /**   * 加载页面   * @param {*} options    */  onShow: function (options) {     },  onLaunch: async function () {    let self = this;    //设置默认分享    this.globalData.shareData = {      title: \"智酷方程式\"    }    // this.getSysInfo();  },  globalData: {    //默认分享文案    shareData: {},    qrCodeScene: false, //二维码扫码进入传参    systeminfo: false,   //系统信息    headerBtnPosi: false,  //头部菜单高度  }});将获取的参数存储在一个全局变量globalData中可以减少反复调用的性能消耗。插件HTML部分<view class=\"custom_nav\" style=\"height:{{navbarHeight}}px;\">    <view class=\"custom_nav_box\" style=\"height:{{navbarHeight}}px;\">        <view class=\"custom_nav_bar\" style=\"top:{{statusBarHeight}}px; height:{{cusnavH}}px;\">            <!-- 搜索部分-->            <block wx:if=\"{{isSearch}}\">                <input class=\"navSearch\"                    style=\"height:{{navbarBtn.height-2}}px;line-height:{{navbarBtn.height-4}}px; top:{{navbarBtn.top+1}}px; left:{{navbarBtn.right}}px; border-radius:{{navbarBtn.height/2}}px;\"                    maxlength=\"10\" bindinput=\"bindKeyInput\" placeholder=\"输入文字搜索\" />            </block>            <!-- HOME 部分-->            <block wx:else>                <view class=\"custom_nav_icon {{!haveBack||'borderLine'}}\"                    style=\"height:{{navbarBtn.height}}px;line-height:{{navbarBtn.height-2}}px; top:{{navbarBtn.top}}px; left:{{navbarBtn.right}}px; border-radius:{{navbarBtn.height/2}}px;\">                    <view wx:if=\"{{haveBack}}\" class=\"icon-back\" bindtap='_goBack'>                        <image src='/images/back.png' mode='aspectFill' class='back-pre'></image>                    </view>                    <view wx:if=\"{{haveBack}}\" class='navbar-v-line'></view>                    <view class=\"icon-home\">                        <navigator class=\"home_a\" url=\"/pages/home/index\" open-type=\"switchTab\">                            <image src='/images/home.png' mode='aspectFill' class='back-home'></image>                        </navigator>                    </view>                </view>                <view class=\"nav_title\" style=\"height:{{cusnavH}}px; line-height:{{cusnavH}}px;\">                    {{vTitle}}                </view>            </block>        </view>    </view></view>主要是对几种状态的判断和定位的计算。插件CSS部分/* components/nav/test.wxss */.custom_nav {    width: 100%;    background: #3a7dd7;    position: relative;    z-index: 99999;}.custom_nav_box {    position: fixed;    width: 100%;    background: #3a7dd7;    z-index: 99999;    border-bottom: 1rpx solid rgba(255, 255, 255, 0.3);}.custom_nav_bar {    position: relative;    z-index: 9;}.custom_nav_box .nav_title {    font-size: 28rpx;    color: #fff;    text-align: center;    position: absolute;    max-width: 360rpx;    overflow: hidden;    text-overflow: ellipsis;    white-space: nowrap;    top: 0;    left: 0;    right: 0;    bottom: 0;    margin: auto;    z-index: 1;}.custom_nav_box .custom_nav_icon {    position:absolute;    z-index: 2;    display: inline-block;    border-radius: 50%;    vertical-align: top;    font-size:0;    box-sizing: border-box;}.custom_nav_box .custom_nav_icon.borderLine {    border: 1rpx solid rgba(255, 255, 255, 0.3);    background: rgba(0, 0, 0, 0.1);}.navbar-v-line {    width: 1px;    margin-top: 14rpx;    height: 32rpx;    background-color: rgba(255, 255, 255, 0.3);    display: inline-block;    vertical-align: top;}.icon-back {    display: inline-block;    width: 74rpx;    padding-left: 20rpx;    vertical-align: top;    /* margin-top: 12rpx;    vertical-align: top; */    height: 100%;}.icon-home {    /* margin-top: 8rpx;    vertical-align: top; */    display: inline-block;    width: 80rpx;    text-align: center;    vertical-align: top;    height: 100%;}.icon-home .home_a {    height: 100%;    display: inline-block;    vertical-align: top;    width: 35rpx;}.custom_nav_box .back-pre,.custom_nav_box .back-home {    width: 35rpx;    height: 35rpx;    vertical-align: middle;}.navSearch {  width: 200px;  background: #fff;  font-size: 14px;  position: absolute;  padding: 0 20rpx;  z-index: 9;}总结通过微信API:getMenuButtonBoundingClientRect(),结果各类手机屏幕的适配问题将算好的参数存储在全局变量中一次计算全局使用爽YY~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发中各种跳转方式的区别               小程序技能进阶回忆录 - 如何自主实现拦截器                                                        原作者:  智酷方程式                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序入门看这篇就够了 ", "author": "                  Rolan                  2019-11-7 00:10                ", "text": "                                                                                                                                                                                     文章为实战中踩坑经历以及解决方案。同时是自己的一个项目回顾在这里分享给大家希望能帮助到大家如果觉得文章对你有用请点个赞:+1:谢谢！原谅我也是个标题党：）登录授权授权（基本信息手机号码 ）必须使用小程序原生的的button组件然后指定open-type 后通过回调才能拿到用户信息。代码入下：index.wxml<view class=\"authorization\" wx:if=\"{{!getUserInfo}}\">       <view class=\"clue\">你还未登录请先授权登录</view>            <button open-type=\"getUserInfo\" lang=\"zh_CN\" bindgetuserinfo=\"bindGetUserInfo\">                授权登录            </button>        </view>        <view class=\"authorization\" wx:if=\"{{getUserInfo && !getPhone}}\">            <view class=\"clue\">你还未绑定手机号请先去绑定</view>            <button open-type=\"getPhoneNumber\" bindgetphonenumber=\"getPhoneNumber\">                立即绑定            </button></view>index.jspage({    // ...     data: {        hasUserInfo: false,        canIUse: wx.canIUse('button.open-type.getUserInfo'),        userInfo: {},        getUserInfo: false,        getPhone: false,        hasAuth: false    },    onLoad: async function () {        var that = this;        // 查看是否授权        wx.getSetting({            success: function (res) {                if (res.authSetting['scope.userInfo']) {                    wx.login({                        success: loginRes => {                            // 获取到用户的 code 之后：loginRes.code                            wx.getUserInfo({                                success: async function (res) {                                    // 这里处理业务逻辑                                }                            })                        }                    })                } else {                    // 用户没有授权                }            }        });    },    bindGetUserInfo: function (e) {        // 需要什么信息都从e中拿到 以下部分业务逻辑        if (e.detail.userInfo) {            //用户按了允许授权按钮            var that = this;            // 获取到用户的信息            wx.login({                success: async res => {                    const aUserModel = new UserModel();                    const params = {                        code: res.code,                        encryptedData: e.detail.encryptedData,                        iv: e.detail.iv                    }                    const { data } = await aUserModel.login({ ...params })                    if(data.roles){                        // do ...                    }                    if (data.mobile) {                        // do ...                    }                }            });            //授权成功后,通过改变 isHide 的值让实现页面显示出来把授权页面隐藏起来            that.setData({                isHide: false            });        } else {            //用户按了拒绝按钮            wx.showModal({                title: '警告',                content: '拒绝授权您将无法使用小程序',                showCancel: false            });        }    },    getPhoneNumber: async function (e) {        if (e.detail.encryptedData) {            //用户按了允许授权按钮            const aUserModel = new UserModel();            const params = {                userId: userInfo.id,                encryptedData: e.detail.encryptedData,                iv: e.detail.iv            }            // do ...        } else {            //用户按了拒绝按钮            wx.showModal({                title: '警告',                content: '拒绝授权您将无法使用小程序',                showCancel: false            })        }    },    // ...})复制代码路由路由跳转的各个方法可以去官网学习这里提遇到的坑navigateTo路由跳转最多只能10层所以使用的时候需要考虑是不是确定需要历史记录。为什么要这么说呢。 场景：一个列表页面（如下图）用户的档案是可以修改的如果用navigateTo跳转（/page/archivesEdit?id=1923XXXX）,修改保存用navigateTo（/page/archivesList）这样来回编辑跳转10次就不让点击跳转了。解决：思考那我用2个redirectTo 行不行？redirectTo是关闭当前历史记录跳转到下一页面。造成了我跳转到修改页面点击微信自带的返回是直接跳过列表页面跳转到首页。这个时候测试小姐姐就又要提bug单了。。。完美姿势： 就是用navigateTo和navigateBack。我再编辑保存的时候返回用navigateBack返回。这样小程序的路由栈就一会在2-3层之间。当然有时候在列表页面会遇到要重新条用接口这时候路由跳转提供了几个重要的钩子函数onShowonHide我们可以在onShow的时候可以条用一下列表的接口。这2个钩子函数足够我们简单的跳转更复杂的场景下可以通过存Storage这种存取参数来返回到上一个页面进行操作感觉不是优雅但是没有好的办法解决了。Storage场景：storage有2种方式获取当你直接wx.getStorageSync('xxx')获取一个id去请求接口的可能是获取不到就已经发送请求了导致出现bug。因为wx.getStorageSync('xxx')是异步的 我们可以利用 async/await去方便的使用onLoad: async function (options) {        const editListParams = await wx.getStorageSync('editListParams')        this.findReportDetails(editListParams)}复制代码webViewwebview不是在某个页面使用的当时我以为是类似iframe这种东西嵌入到页面。正确的使用态度是新建一个page页面然后跳转到这个page去使用。例如跳转到小程序关联的公众号文章：other.wxml<navigator url=\"/pages/webView/webView\"  hover-class=\"none\">跳转到webView</navigator>webView.wxml<web-view src=\"https://mp.weixin.qq.com/s/xxxx\"></web-view>复制代码request微信自带的网络下的request虽然能拿来就用如果不封装就会造成代码冗余。大家可自行参考如下封装ajax.jsimport { baseURL } from '../config/interfaceURL' // baseUrlclass AJAX {    AJAX ({ url, methods = 'GET', data = {} }) {        return new Promise((resolve, reject) => {            this.request(url, resolve, reject, methods, data)        })    }    request (url, resolve, reject, methods, data) {        wx.request({            url: baseURL + url,            method: methods,            data: data,            header: {                'content-type': 'application/json'            },            success: res => {                const code = res.statusCode.toString()                if (code.startsWith('2')) {                    resolve(res)                } else {                    reject()                    const errorMessage = res.data.message                    AJAX.showError(errorMessage)                }            },            fail: err => {                reject()                AJAX.showError(\"网络异常请稍后重试！\")            }        })    }    static showError (errorMessage) {        wx.showToast({            title: errorMessage,            icon: 'error',            duration: 2000        })    }    static serializeLink (obj) { // 序列化get请求        let temp = '?'        for (let index in obj) {            if(obj.hasOwnProperty(index)){                temp += (index + '=' + obj[index] + '&')            }        }        return temp.substr(0, temp.length - 1)    }}export default AJAX// model层调用UserModel.jsimport AJAX from '../utils/AJAX'export class UserModel extends AJAX {    // 小程序授权登陆    login (params) {        return this.AJAX({            url: `/service/api/users/applet/login`,            data: params,            methods: 'POST'        })    }}// control调用index.jsasync onLoad (options){    const aUserModel = new UserModel()    const params = {        code: loginRes.code,        encryptedData: res.encryptedData,        iv: res.iv    }    const { data } = await aUserModel.login({ ...params })    // 其他}复制代码npm生态以及第三方ui框架直接通过初始化的微信小程序项目里面没有package.json文件。所以在使用npm install xxx 是没有卵用。所以我们要自己在文件夹根目录下执行npm init 。这时候才能通过微信开发者工具构建npm构建成功会生成一个目录。推荐用有赞的vant小程序版,社区较活跃使用起来不会有很多坑。双向绑定对于习惯使用vue的开发者来说少了这个v-model语法糖。在处理表单的双向绑定会显得比较蛋疼。所以还是有必要说下小程序里面的双向绑定是怎么样的。file:index.jsPage({    data: {       list: []    },    onLoad: function (options) {      // do ...    },    onInput (e) {        let value = e.detail.value        let temp = e.target.dataset.name.split(',')        let tempKey = temp[1]        let tempIndex = temp[0]        let tempSubIndex = temp[2]        let targetKey = `list[${tempIndex}].children[${tempSubIndex}].${tempKey}`        this.setData({            [targetKey]: value        })    }})file:index.wxml<block  wx:for=\"{{item.children}}\"  wx:for-item=\"subItem\"  wx:key=\"{{index}}\">    <view class=\"td\" style=\"height: {{ 100 / item.children.length}}%;\">      <input placeholder-style=\"color:#ccccccc;\"  type=\"text\" placeholder=\"未填写\" value=\"{{subItem.testResult}}\" data-name=\"{{idx}},testResult,{{index}}\"  bindinput=\"onInput\"/>    </view></block>复制代码下载图片和下载图片授权这里场景是下载一个固定的静态资源图片网络图片需先配置download域名才能生效,方法如下：savePhoto () {        const _this = this;        wx.getImageInfo({            src: '/static/images/home/Qr.png',            success: function (res) {                wx.saveImageToPhotosAlbum({                    filePath: res.path,                    success (result) {                        _this.setData({ show: false });                        wx.showToast({                            title: '保存成功',                            icon: 'success',                            duration: 2000                        })                    },                    fail (err) {                        if (err.errMsg === \"saveImageToPhotosAlbum:fail auth deny\") {                            wx.openSetting({                                success (settingdata) {                                    if (settingdata.authSetting['scope.writePhotosAlbum']) {                                        _this.savePhoto()                                    } else {                                        wx.showToast({                                            title: '获取权限失败,无法保存图片',                                            icon: 'success',                                            duration: 2000                                        })                                    }                                }                            })                        }                    }                })            }        })    }复制代码保存图片也是需要授权的看代码就完事了。其他textarea 在ios上表现会有padding值。我曹 这个就坑了。我采用要不全是textarea或者全是input 这种去实现表单的填写。 其他样式问题也蛮多的有点ie的味道。:smiley:！！ 多用flex float去解决一些差异吧~结语文章每个点都是开发小程序的时候遇到的问题本人能力有限欢迎大家提出自己的问题也可以加入微信群和我们团队一起交流学习。小程序坑还是蛮多的而且写博客也蛮难得码子不易点个赞吧！ :）逃~~~~~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)w偏偏是大67wJack.Chen15                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发注意指南和优化实践               uni-app微信小程序开发之引入腾讯视频小程序播放插件                                                        原作者:  yosun                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序导航栏选择每一项居中(scroll-view) ", "author": "                  Rolan                  2019-11-14 00:41                ", "text": "                                                                                                                                                                                     前言在项目中遇到点击scroll-view中每一项使其居中查看文档后发现有scroll-view有属性scroll-into-view可以根据id来定位每一项但是无法居中于是我想到了使用scroll-left来计算滚动距离是使一项居中.查看效果完成思路获取屏幕宽度的一半（srceenHalfWidth）获取元素宽度的一半（即subHalfWidth）获取元素到手机屏幕左边的距离（即元素的subLeft）计算scroll-view需要滚动的距离：needScroll = subLeft - srceenHalfWidth + subHalfWidth监听scroll-view滚动获取上次滚动的距离（prevDistance）计算scroll-left属性的值 scroll-left= needScroll + prevDistancewxml代码<scroll-view class=\"power-view\" scroll-x=\"true\" scroll-with-animation=\"true\" scroll-left=\"{{scrollLeft}}\" bindscroll=\"scrollMove\">    <block wx:for=\"{{powerList}}\" wx:key>        <view class=\"item {{index == activeIdx?'active':''}}\" bindtap=\"chooseSub\" id=\"v{{index}}\" data-index=\"{{index}}\">          <view class=\"icon\"></view>          <view class=\"text\">全年海量优惠</view>        </view>    </block>  </scroll-view>复制代码js代码data: {    powerList: ['v1', 'v2', 'v3', 'v4', 'v5', 'v6', 'v7', 'v8', 'v9', 'v10', 'v11', 'v12'],    activeIdx: 0, //选中的index  },  /**   * 生命周期函数--监听页面加载   */  onLoad: function (options) {    let scrollInfo = {      prevDistance: 0, //滚动条的距离（默认为0）      screenHalfwidth: wx.getSystemInfoSync().windowWidth / 2,     }    this.data.scrollInfo = scrollInfo;   },  //选择某一项类目  chooseSub: function(e) {    let index = e.currentTarget.dataset.index;    this.setData({      activeIdx: index    })    this.getRect(index);  },  //获取类目的宽高  getRect: function (index) {    let that = this;    let query = wx.createSelectorQuery();    query.select(\"#v\" + index).boundingClientRect(function (rect) {      that.data.scrollInfo.subLeft = rect.left; //元素一半宽度      that.data.scrollInfo.subHalfWidth = rect.width / 2;       that.moveTo();    }).exec()  },  //移动导航栏  moveTo: function() {    let subLeft = this.data.scrollInfo.subLeft;    let subHalfWidth = this.data.scrollInfo.subHalfWidth;    let prevDistance = this.data.scrollInfo.prevDistance;    let screenHalfwidth = this.data.scrollInfo.screenHalfwidth;    let needScroll = subLeft - screenHalfwidth + subHalfWidth;    let scrollLeft = needScroll + prevDistance;    this.setData({      scrollLeft: scrollLeft    })  },  //记录滚动的距离  scrollMove: function(e) {    let distance = e.detail.scrollLeft;    this.data.scrollInfo.prevDistance = distance  },复制代码结尾有两种特殊情况当scroll-left < 0scroll-view会滚动到 scroll-left = 0;当scroll-left > maxScrollscroll-view会滚动到 scroll-left = maxScroll;所以还是正常运行.                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    【微信小程序】图片压缩-纯质量压缩非长宽裁剪压缩               微信小程序开发者自助解绑小程序                                                        原作者: 阳光宅男酱                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序技能进阶回忆录 - 在缺少组件化的日子里 ", "author": "                  Rolan                  2019-10-21 00:23                ", "text": "                                                                                                                                                                                     战争信念意志和情感这些散发着光芒和硝烟的词汇象一枚枚炮弹轰入我们现在的生活。历史的记忆不会被抹灭。当我们在各自项目里幸福的拷贝着官方代码 demo在 componnets 文件夹里使用 Component方法书写一个个组件时不要忘记在 2018 年上半年以前小程序是没有提供组件化方案的。当时主要有两种解决方法一种是 WePY 拷贝法另一种则是 template 法。WePY 拷贝法比如有个最简单的按钮组件：<!-- components/button.wpy --><template>  <view class=\"button\">    <button @tap=\"onTap\">点这里</button>  </view></template><!-- pages/index.wpy --><template>  <view class=\"container\">    <wpy-button /> // button 组件1    <wpy-button2 /> // button 组件2  </view></template>复制代码经过编译后结果如下：<view class=\"container\">  <view class=\"button\">    <button bindtap=\"$wpyButton$onTap\">点这里</button>  </view>  <view class=\"button\">    <button bindtap=\"$wpyButton2$onTap\">点这里</button>  </view></view>复制代码为了方便变量隔离所以引入到页面中的组件得单独命名：import wepy from 'wepy'import Button from '@/components/button'export default class Index extends wepy.page {  components = {    'wpy-button': Button,    'wpy-button2': Button  }  ...}复制代码如果多个页面引入同一组件会拷贝多份有一些不便的地方但也很好的解决了当时组件化缺失的问题。template 法有心的同学可能记得当初我们发了这篇文章： 微信小程序组件化解决方案wx-component 当时主要讲了如何使用这次讲讲技术的细节。主要利用小程序当时提供的 template 模板方法使用方式如下：<!-- pages/template/login.wxml --><template name=\"login\">  <view class=\"login\">这是登录组件</view></template>复制代码<!-- pages/login/index.wxml --><import src='../../components/login/index.wxml'/><view class=\"login-box\">  <template is=\"login\" data=\"{{...}}\"></template></view>复制代码由于知道这只是临时的解决方法最终还会迁移到微信官方组件化方案。了解到微信团队正在开发就死皮赖脸找了微信研发同学要下技术方案以便后期迁移成本做到最低。最后微信同学不耐烦的扔给我们如下代码并特别嘱咐 不要泄露出去 -_-：Component({  // 组件名  name: '',  // 为其他组件指定别名  using: {},  // 类似mixins组件间代码复用  behaviors: [],  // 组件私有数据  data: {  },  // 外部传入的组件属性  propties: {  },  // 当组件被加载  attached () {  },  // 当组件被卸载  detached () {  },  // 组件私有方法  methods: {  }})复制代码一目了然依照此文档实现一个简单的组件化方案也有了思路。如何引入组件由于没有办法在小程序全局注入 Component 方法可以将组件代码以模块方式导出在页面的 Page 方法里引入：// components/login/index.wxml<template name=\"login\">  <form bindsubmit=\"onLoginSubmit\">    ...    <button type=\"primary\" formType=\"submit\">{{btnText}}</button>  </form></template>复制代码// components/login/index.jsmodule.exports = {  name: 'login',  data: {    btnText: ''  }  ....}复制代码// pages/index/index.jsPage({  data: {    ...  },  components: {    login: {      btnText: '开始',      onLoginCallback() { ... }    }  }})复制代码<!-- pages/index/index.wxml --><import src='../../components/login/index.wxml'/><view class=\"login-box\">  <template is=\"login\" data=\"{{...login}}\"></template></view>复制代码在 Page 的传参里多了 components 属性传入了组件名 login 以及组件对应的属性值和方法。为了使这些新增传参生效那势必需要对 Page 进行改造。改造 Page如何用一行代码毁掉你的小程序在小程序根目录的 app.js 里加入这段代码即可：Page = funtion() {}复制代码这样核心的 Page 的方法就被覆盖掉了所以利用这个“特性”可以改造 Page 方法：// utils/wx.jsvar page = function() {  // 改造代码  ...}module.exports = {  page}复制代码// app.jsPage = require('./utils/wx').page复制代码这就完成了独一无二的自定义的小程序 Page 的方法。Component 怎么写精简了核心的代码如下：function noop() {}class Component {  constructor (config) {    // 兼容 onLoad onUnload 的写法    config.onLoad = config.onLoad || config.attached || noop    config.onUnload = config.onUnload || config.detached || noop    this.data = config.data || {}    this.config = config    this.methods = config.methods || {}    for (let name in this.methods) {      // 为了使组件事件绑定生效直接挂在到 this 下      this[name] = methods[name]    }  }  setData (data, deepExtend) {    let name = this.name    let parent = this.parent    let mergeData = extend(deepExtend !== false, parent.data[name], data)    let newData = {}    newData[name] = mergeData    this.data = mergeData    // 更新页面的 data    parent.setData(newData)  }  setName (name) {    this.name = name  }  setParent (parent) {    this.parent = parent  }}复制代码主要完成了三件事：配置了组件的生命周期事件 attached 和 detached绑定了组件的事件使得 template 的 bindtap 等代码生效实现了组件的 setData 功能有个细节为了让大家容易理解分享到外部用 onLoad 、 onUnload 代替了 attached 、 detached 但内部早就开始用微信命名的这两个属性名才有了代码中的兼容写法。自定的 Page 怎么写整理了大致的核心代码如下：// 缓存下微信的 Pageconst originalPage = Page// 组件生命周期const LIFETIME_EVENT = [  'onLoad',  'onUnload']class MyPage {  constructor (origin) {    this.origin = origin    this.config = {}    this.children = {}    this.childrenEvents = {}    // 是否需要`components`    let components = this.components = origin.components    if (components) {      this.config.data = {}      for (let item in components) {        let props = components[item] || {}        let component = new Component(require(`../components/${item}/index`))        this.children[name] = component        // 合并组件的 data        extend(component.data, component.props)        // ...        // 合并组件的 method        for (let fnName in component.methods) {          this.config[fnName] = component.methods[fnName].bind(component)        }        // ...        let childrenEvents = this.childrenEvents[item] = {}        LIFETIME_EVENT.forEach((prop) => {          childrenEvents[item][prop] = component.config[prop]        })      }            // 合并所有依赖组件的生命周期函数      LIFETIME_EVENT.forEach((prop) => {        this.config[prop] = () => {          for (let item in this.components) {            this.childrenEvents[item][prop].apply(this.component, arguments)          }          this.origin[prop] && this.origin[prop].apply(this, arguments)        }      })      // 把新生成的 config 传给原始的微信的 Page 方法      originalPage(this.config)    } else {      // 没有依赖组件直接透传给微信的 Page 方法      originalPage(origin)    }  }}复制代码可能有点乱其实就是不断 merge data 和 method 的过程。最终所有组件自定的数据和方法都被挂在到了 Page 的传参里。最后导出自定义的 page ：// utils/wx.jsconst page = function (config) {  return new MyPage(config)}module.exports = {  page}复制代码在 app.js 中覆盖掉原有的 Page 方法：// app.jsPage = require('./utils/wx').page复制代码不完善的地方虽然满足业务了但也是有些问题的例如上面 MyPage 方法里的这段：for (let fnName in component.methods) {  this.config[fnName] = component.methods[fnName].bind(component)}复制代码可以看出直接把组件内部定义的方法挂在到 config 中去了这就要求页面的方法和组件的方法不能重名这是为了方便 template 可以直接绑定组件定义的事件只能通过把组件事件转移到页面的事件方法里。也有很多其他不完善的地方但早期通过内部约束代码规范也基本可以解决。结语这种近乎 Hack 的方式支撑了摩拜单车小程序业务大半年的时间期间产出了大大小小十多个组件。而由于组件内部基本是按照微信官方组件化 api 书写待官方推出组件化方案后全部迁移过去的成本也大大减小。传送门小程序技能进阶回忆录 - 也许你并不需要小程序框架小程序技能进阶回忆录 - 在缺少组件化的日子里小程序技能进阶回忆录 - 如何自主实现数据侦听器和计算器 （待发布）小程序技能进阶回忆录 - 如何自主实现拦截器（待发布）小程序技能进阶回忆录 - globalData 的那些事儿（待发布）小程序技能进阶回忆录 - 什么时候执行 onLoad（待发布）小程序技能进阶回忆录 - 增强型的 wx.navigateBack（待发布）广告时间美团单车事业部（摩拜单车）诚招前端 / 小程序研发工程师有兴趣可以发简历到 zhangshibing@mobike.com ）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序 - 自定义导航栏重要步骤               微信小程序开发中各种跳转方式的区别                                                        原作者:  摩拜单车前端团队                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序 - 可搜索的地址选择 ", "author": "                  Rolan                  2019-11-20 00:41                ", "text": "                                                                                                                                                                                     最终实现效果：新建index文件夹index.wxml<!--pages/index/index.wxml--><view class='container'>  <view bindtap='onChangeAddress'>    <input value=\"{{address}}\" name=\"address\" placeholder=\"选择地点\">  </view></view>index.js// pages/index/index.jsPage({  data: {    address: ''  },  onChangeAddress() {    var _page = this;    wx.chooseLocation({      success: (res) => {        _page.setData({          address: res.name        });      },      fail: (err) => {        console.log(err);      }    });  }})新建map文件夹map.wxml<!--pages/map/map.wxml--><view class=\"container\">  <map    id=\"myMap\"    style=\"width: 100%; height: 100%;\"    latitude=\"{{latitude}}\"    longitude=\"{{longitude}}\"    markers=\"{{markers}}\"    show-location  ></map></view>map.js// pages/map/map.jsPage({  data: {    latitude: 31.22786,    longitude: 121.46658,    markers: [{      id: 1,      latitude: 31.22786,      longitude: 121.46658,      name: '上海招商局广场'    }]  },  onReady(e) {    this.mapCtx = wx.createMapContext('myMap')  }})                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发者自助解绑小程序               微信小程序 模拟打电话 实践                                                        原作者: 可怜的小黑兔                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "服务端使用 nodejs 获取带参微信小程序码图片 ", "author": "                  Rolan                  2019-4-23 00:25                ", "text": "                                                                                                                                                                                     服务器使用 nodejs 请求获取微信小程序图片的教程附详细代码。此文于2018.09.19完成无法保证现在微信小程序的接口没有改变。调研首先看微信小程序的 获取二维码 文档可以看到微信支持三种接口其中只有B接口没有生成个数限制长远来看我选择使用 B 接口。根据文档要使用 B 接口生成小程序码就需要一个 access_token这个 token 可以通过另一个接口传入appId和密钥来获得。详情看 该接口文档。实现获取 access_tokennodejs 的版本为 8.x。考虑到服务端发送的请求并不多不打算引入 request、axios 之类的三方库用原生 https 模块实现（其实我只是想学习 nodejs 的原生 api 哈）。首先要获取 access_token要用到 appid 和 appsecret。const https = require('https');https.get(`https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=${appid}&secret=${appsecret}`, res => {    let resData = '';    res.on('data', data => {        resData += data;    });    res.on('end', () => {        resData = JSON.parse(resData);    })})复制代码通过 end 事件我们获得了返回的完整的 JSON 对象 resData。如果参数正确的话会返回 {\"access_token\":\"ACCESS_TOKEN\",\"expires_in\":7200} 这样的 JSON 对象。expires_in 指的是 token 的有效期时间单位是秒获取了这个对象后我添加了一个 timestamp 属性存储当前时间来确定这个 access_token 什么时候过期。这个对象你可以存在 global 下但最好存到 redis这样即使你重启服务器就不需要重新获取 access_token 了。获取小程序码图片有了 access_token我们就可以通过 post 请求来获取图片二进制流了。发送 post 请求要用到 https.request 方法比 https.get 要复杂一点。首先我们用自带的 url 模块将 url 字符串转换为 URL 对象。因为我们要用到 post 方法并指定一些headers所以还要给这个对象追加一些属性。 url 字符串转为对象有两种方法一种是 new URL(<urlString>)还有一个是 url.parse(<urlString>)。请不要使用第一种方式因为给转换后的对象添加属性然后转为 JSON 对象时不会存在（具体原因不明有空我研究下。）第二种方式生成的对象则没有这些问题。具体代码如下：const url = require('url');let options = url.parse(`https://api.weixin.qq.com/wxa/getwxacodeunlimit?access_token=${access_token}`);// 添加必要的属性options = Object.assign(options, {    method: 'POST',    headers: {        // 'Content-Length': Buffer.byteLength(post_data),        'Content-Type': 'application/json',        'Content-Length': post_data.length,    }});复制代码这里的 post_data 其实就是请求主题里的数据。注意获取二维码的 api 文档里的 Bug & Tip 明确说明了, POST 参数需要转成 json 字符串不支持 form 表单提交。const post_data = JSON.stringify({    scene: '你要传的参数',      // 最多32个字符。    width: 200,               // 生成的小程序码宽度。});复制代码然后我们就可以用 https.request 方法去请求图片了let req = https.request(options, (res) => {    let resData = '';    res.setEncoding(\"binary\");    res.on('data', data => {        resData += data;    });    res.on('end', () => {        // 微信api可能返回json也可能返回图片二进制流。这里要做个判断。        // errcode:42001 是指 token 过期了需要重新获取。40001 是指token格式不对或很久之前的token。        const contentType = res.headers['content-type'];        if ( !contentType.includes('image') ) {            console.log('获取小程序码图片失败微信api返回的json为：')            console.log( JSON.parse(resData) )            return resolve(null);        }        const imgBuffer = Buffer.from(resData, 'binary');        resolve( {imgBuffer, contentType} );    });});req.on('error', (e) => {    console.log('获取微信小程序图片失败')    console.error(e);});req.write(post_data);   // 写入post请求的请求主体。req.end();复制代码注意点：这里比较重要的是这个 res.setEncoding(\"binary\");因为服务器默认返回的数据会编码为 utf8 格式但我们只需要二进制且二进制转 utf8 再转回二进制貌似会丢失数据（具体我还不知道为什么）。另外这个返回的 req 对象可以诸如 setHeader(name, value), getHeader(name), removeHeader(name) 的api直到你使用 request.end() 才真正把请求发送出去。如果你忘了调用 request.end 而执行了代码过了一段时间会报一个超时错误。考虑到返回的不一定是图片也有可能返回 JSON所以做了一些判断。如果参数比较固定你可以把图片下载下来将图片路径映射到 redis 上做个缓存。用户第二次访问的时候直接传对应的图片就行了。完整代码（仅供参考）下面是完整代码和一些简单的注释另外因为使用了 Koa 框架需要用到 async/await 的同步方式我把请求包装成了 Promise。const https = require('https');const url = require('url');const uid = '你要传的参数';const S_TO_MS = 1000;  // 秒到毫秒的转换。if (!global.access_token || global.access_token.timestamp + global.access_token.expires_in * S_TO_MS <= new Date() - 300) {    // 过期获取新的 token    const appid = '小程序的appId';    const appsecret = '密钥';    const accessTokenObj = await new Promise( (resolve, reject) =>{        https.get(`https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=${appid}&secret=${appsecret}`, res => {            let resData = '';            res.on('data', data => {                resData += data;            });            res.on('end', () => {                resolve( JSON.parse(resData) );            })        })    }).catch(e => {        console.log(e);    });        // 这里应该加一个判断的因为可能请求失败返回另一个 JSON 对象。    global.access_token = Object.assign(accessTokenObj, {timestamp: +new Date()});}const access_token = global.access_token.access_token;const post_data = JSON.stringify({    scene: uid,     // 最多32个字符。    width: 200,     // 生成的小程序码宽度。});let options = url.parse(`https://api.weixin.qq.com/wxa/getwxacodeunlimit?access_token=${access_token}`);options = Object.assign(options, {    method: 'POST',    headers: {        'Content-Type': 'application/json',        'Content-Length': post_data.length,    }});// 获取图片二进制流const {imgBuffer, contentType} = await new Promise((resolve, reject) => {    let req = https.request(options, (res) => {        let resData = '';        res.setEncoding(\"binary\");        res.on('data', data => {            resData += data;        });        res.on('end', () => {            // 微信api可能返回json也可能返回图片二进制流。这里要做个判断。            const contentType = res.headers['content-type'];            if ( !contentType.includes('image') ) {                console.log('获取小程序码图片失败微信api返回的json为：')                console.log( JSON.parse(resData) )                return resolve(null);            }            const imgBuffer = Buffer.from(resData, 'binary');            resolve( {imgBuffer, contentType} );        });    });    req.on('error', (e) => {        console.log('获取微信小程序图片失败')        console.error(e);    });    req.write(post_data);   // 写入 post 请求的请求主体。    req.end();}).catch(() => {    return null;});if (imgBuffer == null) {    ctx.body = {code: 223, msg: '获取小程序码失败'};    return;}ctx.res.setHeader('Content-type', contentType);ctx.body = imgBuffer;复制代码后面的话原生 api 有点繁琐建议使用一些流行的请求库可读性高且方便修改。微信 api 返回的图片流是先获取到完整的二进制数据再返回到客户端的。如果可以直接把传回来的每一个数据块直接发到客户端无疑可以缩短响应时间貌似这里可以进行优化。涉及到了编码和解码的问题这块内容要多学习。参考www.cnblogs.com/chyingp/p/c…www.ruanyifeng.com/blog/2007/1…                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    上传小程序的代码时自动压缩               微信小程序Page对象重写                                                        原作者: Fstar_                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序之自定义倒计时组件 ", "author": "                  Rolan                  2019-4-29 00:11                ", "text": "                                                                                                                                                                                     最近写小程序写上瘾了,业务上需要实现一个倒计时的功能,考虑到可拓展以及使用方便,便将其封装成组件(写习惯了JSX不得不吐槽小程序自定义组件的繁琐)萌新第一次在掘金写东西,东西比较简单可能拉低整个掘金的文章水平了(求轻喷~)需求可配置倒计时的时间倒计时结束后执行事件可配置倒计时时间的格式步骤先定义自定义组件的 properties ,这里有两个父组件传给该倒计时组件的参数 target 倒计时的时间, format 倒计时时间的格式properties: {    target: {      type: String,    },    format: {      type: Function,      default: null    }},复制代码定义组件生命周期函数lifetimes: {    attached() {      //组件创建时      this.setData({        lastTime: this.initTime(this.properties).lastTime,  //根据 target 初始化组件的lastTime属性      }, () => {        //开启定时器        this.tick();        //判断是否有format属性 如果设置按照自定义format处理页面上显示的时间 没有设置按照默认的格式处理        if (typeof this.properties.format === 'object') {          this.defaultFormat(this.data.lastTime)        }      })    },    detached() {      //组件销毁时清除定时器 防止爆栈      clearTimeout(timer);    },},复制代码微信小程序自定义组件的生命周期指的是指的是组件自身的一些函数这些函数在特殊的时间点或遇到一些特殊的框架事件时被自动触发。其中最重要的生命周期是 created attached detached 包含一个组件实例生命流程的最主要时间点。具体微信自定义组件学习参考官方文档定义组件自身的状态/** * 组件的初始数据*/data: {    d: 0, //天    h: 0, //时    m: 0, //分    s: 0, //秒    result: '',  //自定义格式返回页面显示结果    lastTime:''  //倒计时的时间错},复制代码组件自身的方法methods: {    //默认处理时间格式    defaultFormat: function(time) {      const day = 24 * 60 * 60 * 1000      const hours = 60 * 60 * 1000;      const minutes = 60 * 1000;      const d = Math.floor(time / day);      const h = Math.floor((time - d * day) / hours);      const m = Math.floor((time - d * day - h * hours) / minutes);      const s = Math.floor((time - d * day - h * hours - m * minutes) / 1000);      this.setData({        d,        h,        m,        s      })    },    //定时事件    tick: function() {      let {        lastTime      } = this.data;      timer = setTimeout(() => {        if (lastTime < interval) {          clearTimeout(timer);          this.setData({              lastTime: 0,              result: ''            },            () => {              this.defaultFormat(lastTime)              if (this.onEnd) {                this.onEnd();              }            }          );        } else {          lastTime -= interval;          this.setData({              lastTime,              result: this.properties.format ? this.properties.format(lastTime) : ''            },            () => {              this.defaultFormat(lastTime)              this.tick();            }          );        }      }, interval);    },    //初始化时间    initTime: function(properties) {      let lastTime = 0;      let targetTime = 0;      try {        if (Object.prototype.toString.call(properties.target) === '[object Date]') {          targetTime = Number(properties.target).getTime();        } else {          targetTime = new Date(Number(properties.target)).getTime();        }      } catch (e) {        throw new Error('invalid target properties', e);      }      lastTime = targetTime - new Date().getTime();      return {        lastTime: lastTime < 0 ? 0 : lastTime,      };    },    //时间结束回调事件    onEnd: function() {      this.triggerEvent('onEnd');    }  }复制代码defaultFormat :默认时间处理函数 tick :定时事件 initTime 初始化时间 onEnd :时间结束的回调倒计时组件 countDown.js 完整代码var timer = 0;var interval = 1000;Component({  /**   * 组件的属性列表   */  properties: {    target: {      type: String,    },    format: {      type: Function,      default: null    }  },  lifetimes: {    attached() {      //组件创建时      this.setData({        lastTime: this.initTime(this.properties).lastTime,  //根据 target 初始化组件的lastTime属性      }, () => {        //开启定时器        this.tick();        //判断是否有format属性 如果设置按照自定义format处理页面上显示的时间 没有设置按照默认的格式处理        if (typeof this.properties.format === 'object') {          this.defaultFormat(this.data.lastTime)        }      })    },    detached() {      //组件销毁时清除定时器 防止爆栈      clearTimeout(timer);    },  },  /**   * 组件的初始数据   */  data: {    d: 0, //天    h: 0, //时    m: 0, //分    s: 0, //秒    result: '',  //自定义格式返回页面显示结果    lastTime:''  //倒计时的时间错  },  /**   * 组件的方法列表   */  methods: {    //默认处理时间格式    defaultFormat: function(time) {      const day = 24 * 60 * 60 * 1000      const hours = 60 * 60 * 1000;      const minutes = 60 * 1000;      const d = Math.floor(time / day);      const h = Math.floor((time - d * day) / hours);      const m = Math.floor((time - d * day - h * hours) / minutes);      const s = Math.floor((time - d * day - h * hours - m * minutes) / 1000);      this.setData({        d,        h,        m,        s      })    },    //定时事件    tick: function() {      let {        lastTime      } = this.data;      timer = setTimeout(() => {        if (lastTime < interval) {          clearTimeout(timer);          this.setData({              lastTime: 0,              result: ''            },            () => {              this.defaultFormat(lastTime)              if (this.onEnd) {                this.onEnd();              }            }          );        } else {          lastTime -= interval;          this.setData({              lastTime,              result: this.properties.format ? this.properties.format(lastTime) : ''            },            () => {              this.defaultFormat(lastTime)              this.tick();            }          );        }      }, interval);    },    //初始化时间    initTime: function(properties) {      let lastTime = 0;      let targetTime = 0;      try {        if (Object.prototype.toString.call(properties.target) === '[object Date]') {          targetTime = Number(properties.target).getTime();        } else {          targetTime = new Date(Number(properties.target)).getTime();        }      } catch (e) {        throw new Error('invalid target properties', e);      }      lastTime = targetTime - new Date().getTime();      return {        lastTime: lastTime < 0 ? 0 : lastTime,      };    },    //时间结束回调事件    onEnd: function() {      this.triggerEvent('onEnd');    }  }})复制代码倒计时组件 countDown.wxml 完整代码<wxs src=\"../wxs/utils.wxs\" module=\"utils\" /><wxs src=\"../../comm.wxs\" module=\"comm\" /><view class=\"count-down\">  <text wx:if=\"{{result!==''}}\">{{result}}text>  <block wx:else>    <text wx:if=\"{{comm.numberToFixed(d)>0}}\">{{d}}天text>    <text>{{utils.fixedZero(h)}}text>    <text style=\"font-weight: 500\">:text>    <text>{{utils.fixedZero(m)}}text>    <text style=\"font-weight: 500\">:text>    <text>{{utils.fixedZero(s)}}text>  block>view>复制代码其中引入了两个wxs文件中的函数WXS（WeiXin Script）是小程序的一套脚本语言结合 WXML可以构建出页面的结构。官方文档function fixedZero(val) {  return val * 1 < 10 ? '0' + val : val;}//保留 pos位小数function numberToFixed(number, pos) {  if (number === null || number === '' || number < 0) return ''  return parseFloat(number).toFixed(pos)}复制代码组件使用引入方式\"usingComponents\": {    \"countDown\": \"../../../components/countDown/countDown\"  },复制代码代码演示<countDown bind:onEnd=\"getPageList\" format=\"{{formatTime}}\" target=\"{{creatTargetTime}}\" />复制代码const formatChinaDate = mss => {  let days = parseInt(mss / (1000 * 60 * 60 * 24));  let hours = parseInt((mss % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));  let minutes = parseInt((mss % (1000 * 60 * 60)) / (1000 * 60));  let seconds = parseInt((mss % (1000 * 60)) / 1000);  return days + ' 天 ' + hours + ' 小时 ' + minutes + ' 分钟 ' + seconds + ' 秒 ';};data:{    formatTime:formatChinaDate,    creatTargetTime:1556428889000, //时间戳}getPageList:function(){    //倒计时结束啦    console.log('倒计时结束啦')}复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    适用于小程序的 ES6               在微信小程序与小游戏中使用 LeanCloud                                                        原作者: ahwgs                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序 swiper 如何多页面高度自适应 ", "author": "                  Rolan                  2019-11-18 00:40                ", "text": "                                                                                                                                                                                     轮播这个概念只要做过 UI 的都不会陌生盲猜市场上 90% 的应用都有这个需求在 iOS 和 Android 上都有很完善的控件比如 Android 的 ViewPager 和 iOS 的 UIScrollview。小程序这么牛逼肯定也要有控件支持这个特性啊 swiper 就这么诞生了。但是 swiper 有一个很严重的问题就是高度默认 150px且不可以自适应内容调整高度。这就有问题了我现在有一个多 Tab 的页面最少高度要满屏还要超出内容可以往下滚动此时就蒙蔽了怎么给 swiper 设置高度呢？首先看一下我搜索到的一些方法：在初始化的时候获取到屏幕的高度然后将高度设置到 swiper 上至于滚动的问题在里面再嵌入一个 scroll-view这个问题有很多坑首先 屏幕的高度要比内容区的高度大这么设置以后就算内容较少页面也能滑动一点；其次小程序的 scroll-view 在实现上拉加载更多的时候坑更多。每个 item 的高度都一致根据 item 的数量和统一的高度计算出内容的高度然后设置进去这个方案感觉完全是 zz 方案局限性太大了我的方案一句话解释：给 swiper-item 内部添加三个锚点最上面一个最下面一个还有一个锚点始终位于屏幕最底下。根据这三个锚点计算出内容高度和内容显示区高度。PS：锚点宽高为 0 的不可见的 view用于获取定位如果还有不理解可以看下面这个示意图：这三个锚点的具体作用是用来计算 swiper 内容高度和 swiper 距离屏幕底部的具体计算方式如下：使用 swiper-item 内部的两个锚点计算出内容区高度通过屏幕底部和 swiper-item 顶部的锚点计算出离屏幕底部的距离接下来看看代码具体实现代码实现page.wxml<view>\t<swiper style=\"height: {{anchor.deviceHeight + 'px'}}\">\t\t<swiper-item>\t\t\t<view class=\"anchor-top\"></view>\t\t\t<!-- 你的内容 -->\t\t\t<view class=\"anchor-bottom\"></view>\t\t</swiper-item>\t</swiper>\t<view class=\"anchor-screen-bottom\"></view></view>复制代码page.wxss.anchor-top {    width: 0;    height: 0;}.anchor-bottom {    width: 0;    height: 0;}.anchor-screen-bottom {    position: absolute;    bottom: 0;    width: 0;    height: 0;}复制代码page.jsPage({\tdata: {\t\tanchor: {\t\t\tdeviceHeight: 0,      anchorTop: 0,      anchorBottom: 0,      anchorScreenBottom: 0\t\t}\t},\tonReady: function() {\t\tthis.computeSwiperHeight(0)\t},\tcomputeSwiperHeight(pageIndex) {\t  let getSwiperHeight = () => {      let min = this.data.anchor.anchorScreenBottom - this.data.anchor.anchorTop;      let value = this.data.anchor.anchorBottom - this.data.anchor.anchorTop      return Math.max(min, value)\t  }\t  wx.createSelectorQuery()      .select('.anchor-screen-bottom')      .boundingClientRect()      .selectViewport()      .scrollOffset()      .exec(res => {        this.data.anchor.anchorScreenBottom = res[0].bottom      })\t  wx.createSelectorQuery()      .selectAll('.anchor-top')      .boundingClientRect()      .selectViewport()      .scrollOffset()      .exec(res => {        this.data.anchor.anchorTop = res[0].top        this.setData({          'anchor.deviceHeight': getSwiperHeight()        })      })\t  wx.createSelectorQuery()      .selectAll('.anchor-bottom')      .boundingClientRect()      .selectViewport()      .scrollOffset()      .exec(res => {        this.data.anchor.anchorBottom = res[0].bottom        this.setData({          'anchor.deviceHeight': getSwiperHeight()        })      })\t},})复制代码适配多页面当然肯定要适配每个页面的高度不一样的情况。方案也很简单屏幕底部的锚只需要一个了给每个 swiper-item 的都添加两个锚点和之前一样一个在上面一个在下面在切换页面的时候根据当前页面的锚点重新计算一下高度然后设置进去。只需要在原有基础上改一下代码：page.wxml<view>\t<swiper style=\"height: {{anchor.deviceHeight + 'px'}}\" bindchange=\"swiperChange\">\t\t<swiper-item>\t\t\t<view class=\"anchor-top\"></view>\t\t\t<!-- 你的内容 -->\t\t\t<view class=\"anchor-bottom\"></view>\t\t</swiper-item>\t\t<swiper-item>\t\t\t<view class=\"anchor-top\"></view>\t\t\t<!-- 你的内容 -->\t\t\t<view class=\"anchor-bottom\"></view>\t\t</swiper-item>\t</swiper>\t<view class=\"anchor-screen-bottom\"></view></view>复制代码page.wxssCSS 不需要改动page.jsPage({\tdata: {\t\tanchor: {\t\t\tdeviceHeight: 0,      anchorTop: 0,      anchorBottom: 0,      anchorScreenBottom: 0\t\t}\t},\tonReady: function() {\t\tthis.computeSwiperHeight(0)\t},\tswiperChange(e) {    this.computeSwiperHeight(e.detail.current)  },\tcomputeSwiperHeight(pageIndex) {\t  let getSwiperHeight = () => {      let min = this.data.anchor.anchorScreenBottom - this.data.anchor.anchorTop;      let value = this.data.anchor.anchorBottom - this.data.anchor.anchorTop      return Math.max(min, value)\t  }\t  wx.createSelectorQuery()      .select('.anchor-screen-bottom')      .boundingClientRect()      .selectViewport()      .scrollOffset()      .exec(res => {        this.data.anchor.anchorScreenBottom = res[0].bottom      })\t  wx.createSelectorQuery()      .selectAll('.anchor-top')      .boundingClientRect()      .selectViewport()      .scrollOffset()      .exec(res => {        this.data.anchor.anchorTop = res[0][pageIndex].top        this.setData({          'anchor.deviceHeight': getSwiperHeight()        })      })\t  wx.createSelectorQuery()      .selectAll('.anchor-bottom')      .boundingClientRect()      .selectViewport()      .scrollOffset()      .exec(res => {        this.data.anchor.anchorBottom = res[0][pageIndex].bottom        this.setData({          'anchor.deviceHeight': getSwiperHeight()        })      })\t},})复制代码实现效果swiper 的高度高度根据内容自适应swiper 的高度最小占满屏幕最大和内容一样高（为了用户滑动体验（如果划页后高度突然变小用户在原来的位置就划不回去了）适配不同高度的页面这个方案是了实现为自己的需求而写的应该不适应全部的场景不过希望可以为你提供一点思路。感想小程序里的坑真的很多而且有些 API 设计的很奇怪真的不知道当初开发人员怀着怎样的心路历程设计出的 API。个人感觉小程序就是给前端新造了一个轮子更新还很不及时有很多陈年老 Bug比如本文讲的 swiper。前端娱乐圈发展这么快感觉小程序可能会跟不上潮流。最后给我正在开发的小程序预热一下～欢迎关注～                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    闲鱼前端基于 serverless 的一种多端开发解决方案               微信小程序开发技巧                                                        原作者: 南波万                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序 template 模版使用方法 ", "author": "                  Rolan                  2019-4-15 00:36                ", "text": "                                                                                                                                                                                     小程序开发语言虽然只能运行在微信小程序中 但是它的设计同样遵循了主流前端框架的主要特征——组件化在小程序中组件化的实现有两种方式: template 模版 和 Component 组件 。 这两种方式分别适用于不同的场景。template 模版 主要用于展示模版中不涉及事件处理 需要处理的事件逻辑放在调用模版的页面中。 一个 template 模版 只包含 wxml wxss 文件。Component 组件 作为一个单独的功能模块不仅可以包含页面展示还可以包含该模块的事件逻辑处理。 像一个页面一样 Component 组件 可以包含 wxml wxss js json 文件。1. 创建 template 模版不同于 page 和 Component 的创建 在开发者工具中并不能快速创建一个 template 模版 。所以需要单独创建 wxss wxml 文件。template.wxml 文件语法一个 template.wxml 文件中使用 <template> 标签包含一个模版 一个 template.wxml 文件可以包含多个 <template> 模版 使用 name 属性作为模版的名称。在模版中可以接受变量 使用 {{}} 展示。 为变量的传递者由调用该模版的页面传递。<template name=\"A\">    <text>template name: {{name}}</text></template><template name=\"B\">    <text>template name: {{name}} {{msg}}</text></template>复制代码template.wxss 模版样式文件模版可以拥有自己的样式文件text{    color: #cccccc;}复制代码2. 引用 template 模版template 模版的引用需要使用 <import> 标签。 该标签的 src 属性为需要引用模版的路径。template 模版的使用用 <template> 标签。 使用 is 属性来区别模版文件中定义的模版。使用 data 传入模版中的数据。index.wxml<import src=\"../tpls/template.wxml\" /><view>    <template is=\"A\" data=\"{{name}}\"/>    <template is=\"B\" data=\"{{name, msg}}\"/><view>复制代码3. 引用模版样式在 调用页面的 wxml 中引用了 template.wxml 后模版的样式并不会引用 需要在调用页面的 wxss 中单独引用 template.wxss 文件。index.wxss@import \"./tpls/template.wxss\"复制代码4. 模版文件中的事件处理在模版中定义的事件, 需要调用页面中执行。 template.wxml<template name=\"A\">    <text bindtap=\"handleTap\">template name: {{name}}</text></template>复制代码index.jsPage({    data: {},    handleTap() {        console.log('template 模版 click')    }})复制代码5. import 有作用域import 有作用域的概念即只会 import 目标文件中定义的 template而不会 import 目标文件中 import 的 template简言之就是 import 不具有递归的特性。例如：C 引用 BB 引用A在C中可以使用B定义的 template在B中可以使用A定义的 template 但是C不能使用A定义的template6. include 配合 template 模版如同使用 <import src=\"xx/xx/xx.wxml\"> <tempalte is=\"A\" /> 引用和使用模版一样 同样也可以使用 <include src=\"xx/xx/xx.wxml />\" 来引用一个模版。需要注意的是：使用 <include> 引用模版文件时 并不能分别出模版文件的模版块 所以使用 <include>引用的模版文件中只能定义一个模版块。include 可以将目标文件中除了 <template/> <wxs/> 外的整个代码引入相当于是拷贝到 include 位置。<!-- index.wxml --><include src=\"header.wxml\"/><view> body </view><include src=\"footer.wxml\"/>复制代码<!-- header.wxml --><view> header </view>复制代码<!-- footer.wxml --><view> footer </view>复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    [博客小程序]评论通知功能实现(二)——实战过程中的坑               从0开始搭建微信小程序(前后端)的全过程                                                        原作者:  闲不住的李先森                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "玩玩微信小程序（多图预警） ", "author": "                  Rolan                  2019-6-21 00:21                ", "text": "                                                                                                                                                                                     趁着最近下班比较早还是有时间看下其他知识点。于是自己屁颠屁颠的玩了下微信小程序。环境安装我使用的是 mac 电脑来开发那我简单说下我自己的准备工作吧～首先你需要一个良好的编辑器工具我这里下载了 sublime、vscode和微信开发者工具 。我选择使用 微信开发者工具 进行开发因为对开发者友好。有说vscode比较友好的需要配置些东西这就要百度一下了。然后如果你的小程序要上线或需要使用里面比较完整的功能你需要注册一个微信小程序获取 appId 。我这里是学习而已所以只是用微信提供的测试 appId 这个测试 appId 在使用 微信开发者工具 新建项目的时候有得选择。嗯～就是这么简单惊喜不～意外不:hushed:项目结构当你使用 微信开发者工具 新建项目的时候它会自动帮你新建一个规范的项目目录结构。当然我们也可以从零开始进行搭建啦。我下面简单罗列下我项目中的结构(截止2019年06月21日)：- app.js- app.json- assets  - tabbar\t- home_active.png\t- home.png\t- profile_active.png\t- profile.png- pages  - home\t- home.js\t- home.json\t- home.wxml\t- home.wxss  - profile\t- profile.js\t- profile.json\t- profile.wxml\t- profile.wxss- page.wxss- project.config.json- README.md复制代码也许你已经注意到了文件后缀名 js, json, wxml, wxss 。那么它们具体是干什么用的呢？js后缀名的文件是你写 javascript 的地方了项目的一些逻辑代码。json后缀名的文件是你写页面的配置的地方 app.json 是应用的整体配置 home.json 是 home 页面的配置 profile.json 是 profile 页面的配置。wxml后缀名的文件是你写页面骨架的地方类似我们的 html 。wxss后缀名的文件是你写页面样式的地方类似我们的 css 。练手项目在看了文档百度了些资料就开始想一个练手的项目 -- github信息展示 。首先我们搭建好项目的目录之后就是根据文档啥的进行我们的项目构思的实现了。具体的过程我这里就不赘述了毕竟在文章后面会配上项目代码的github地址啦:dog:～我们来看下效果吧：                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    在小程序中实现 Mixins 方案               5个套路看懂微信小程序开发                                                        原作者:  call_me_R                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "uni-app微信小程序接入人脸核身SDK ", "author": "                  Rolan                  2019-8-19 00:37                ", "text": "                                                                                                                                                                                     这几天使用uni-app开发某银行的一个微信小程序需要集成接入腾讯云的人脸核身SDK如上图所示记录下整合接入过程及踩的一些坑帮助后面需要的朋友们。关于uni-app接入人脸核身SDK有不懂的地方可以在下面提问看到会及时回复。申请服务不是所有的企业都能够申请的需要符合以下行业要求的客户才能申请政务：政府机构或事业单位金融：银行、保险医疗：公立医疗机构运营商：电信运营商教育：公立教育机构交通：航空、客运、网约车、交通卡、共享交通、轨道交通、租车旅游：酒店物流：快递、邮政、物流由于SDK会调用小程序原生的 wx.startFacialRecognitionVerify 方法所以总共得申请2个服务SDK服务： 申请人脸核身服务小程序： 查看申请流程 （需要发送邮件申请使用该服务的小程序的appid后面开发也是用的这个）重要的事情说3遍以上这2个服务都需要申请缺一不可。以上这2个服务都需要申请缺一不可。以上这2个服务都需要申请缺一不可。下载SDK由于不是我申请的所以怎么下载我也不知道听群里的人说的是SDK腾讯云下发给客户的。SDK目录结构SDK接入参考腾讯云文档的接入方法： https://cloud.tencent.com/document/product/1007/31071文档是针对原生小程序写的所以页面引入的方法有所不同由于uni-app不支持直接引入小程序的原生页面所以这里能想到的就是将它当作成一个微信小程序的组件然后uni-app的页面引入这个组件解压引入SDK在uni-app项目中新建 wxcomponents 目录将SDK解压后放到该目录pages.json 中 globalStyle 中全局引入小程序的组件注意引用的路径\"usingComponents\": {  \"verify-mpsdk\": \"/wxcomponents/verify_mpsdk/index/index\"}新建人脸核身页面pages 中新建人脸核身的页面 face (名字可以随意根据自己的需要起名)pages.json 中配置页面face 页面中引入 verify-mpsdk 组件最终的人脸核身的页面访问就是 /pages/face/face初始化SDK在需要的页面初始化SDK如有个页面需要点击按钮进行人脸核身就在这个页面进行初始化。这个直接照着文档 快速入门 中的来就行了这里就直接使用uni-app默认的 index 页面适当修改下即可大概代码如下：<template>  <view class=\"content\">    <button type=\"primary\"      @tap=\"gotoVerify\">      进入人脸核身    </button>  </view></template><script>    export default {        data() {            return {                BizToken: ''            }        },        onLoad() {            // 初始化慧眼实名核身组件            const Verify = require('@/wxcomponents/verify_mpsdk/main.js')            Verify.init()        },        methods: {            // 单击进入人脸核身按钮时触发该函数            gotoVerify () {                this.BizToken = '' // 这里需要我们去客户后端调用DetectAuth接口获取BizToken                // 调用实名核身功能                wx.startVerify({                        data: {                            token: this.BizToken // BizToken                        },                        success: (res) => { // 验证成功后触发                                // res 包含验证成功的token, 这里需要加500ms延时防止iOS下不执行后面的逻辑                                setTimeout(() => {                                    // 验证成功后拿到token后的逻辑处理具体以客户自身逻辑为准                                    console.log(res)                                }, 500)                        },                        fail: (err) => {  // 验证失败时触发                                // err 包含错误码错误信息弹窗提示错误                                setTimeout(() => {                                        console.log(err)                                        wx.showModal({                                            title: \"提示\",                                            content: err.ErrorMsg,                                            showCancel: false                                        })                                }, 500)                        }                })            }        }    }</script>注意下这里的 BizToken ,需要调用后端服务接口来获取需要后端的同学调用腾讯云提供的 DetectAuth 来返回前端需要的 BizToken 调试开发阶段我们可以先通过腾讯云提供的工具API 3.0 Explorer直接来获取这个 BizToken 如果服务申请成功后控制台一般能找到 SecretId  SecretKey  RuleId 注意 Endpoint 和 Region 选择的地区得保持和申请时选择的地区一致。填写完成后点击 在线调用 中的 发送请求 按钮如果填的都对的话返回信息里面会有 BizToken 拿到 BizToken 后就可以直接使用了修改下上面的代码：xxxxxxxxxxxxxxxxx就是拿到的 BizTokenthis.BizToken = 'xxxxxxxxxxxxxxxxx' // 这里需要我们去客户后端调用DetectAuth接口获取BizToken开发调试上面都做完后就可以进行调试了需要先在项目中 manifest.json 中配置上小程序的appid这个appid就是上面 申请服务 中的appid不然无法开启调试。然后运行到微信开发工具（这里就不多说了）如果提示不是开发人员就让该appid的管理员将你加到开发组里面就行了。运行成功后点击开发者工具的真机调试扫描二维码开启真机调试模式。接下来就是踩坑了会出现各种问题。踩坑及解决方法Component is not found in path这里开发者工具里面都是显示正常的不会报这个错手机扫码进入调试后控制台会出现这个报错提示组件找不到但是我们的路径都是对的Component is not found in path \"wxcomponents/verify_mpsdk/index/index\" 问题出在这里将 verify_mpsdk 当成自定义组件了小程序自定义组件引入的时候需要在文件JSON中指定 \"component\": true 找到 wxcomponents\\verify_mpsdk\\index\\index.json 文件加入 \"component\": true 即可重新开启调试扫码后上面的报错就没了。 navigateTo:fail page点击按钮调用 gotoVerify 后会报一个页面找不到的错navigateTo:fail page \"verify_mpsdk/index/index?isNotice=false\" is not found SDK默认的是跳转验证页面的地址是 verify_mpsdk/index/index 文档找了半天也没找到相应的配置地址最后在SDK里面搜索找到了这个地址。所以只需要把这个地址改成我们所需要的地址就行了。找到 wxcomponents\\verify_mpsdk\\main.js 里面搜索 verify_mpsdk/index/index ,找到后修改成上面 人脸核身页面 的地址 pages/face/face 保存后重试就能跳转到人脸核身的页面了。无操作、无报错大坑进入人脸核身的页面后会发现啥操作都没控制台也没报错一度认为我自己弄的有问题搞了好久也没弄好也提了个工单（腾讯云工单反馈率还是很快的几分钟后就有人回复了这点赞一个）将代码和相关操作在工单里描述了下对方也觉得的没问题按照快速入门的代码应该是没问题的对方也没找到啥问题就让我加了一个腾讯云慧眼小助手的微信本想着下午加人家看看啥问题的中午吃完饭闲着的时候将SDK里面的文件都格式化后终于在 index.js 里面找到问题所在了。wxcomponents\\verify_mpsdk\\index\\index.js 文件中有个 onLoad 生命周期正常原生微信小程序进入到这个页面的时候会执行 onLoad 里面的代码但是我们上面将这个SDK当作是一个自定义组件了在uni-app中组件是不存在 onLoad 这个生命周期的这个是页面所属的生命周期。找到问题所在就好解决了我们可以在人脸核身的页面 pages/face/face 手动执行 onLoad 修改下 pages/face/face 的代码如下：<template>  <view class=\"face\">    <verify-mpsdk ref=\"verifyMpsdk\"></verify-mpsdk>  </view></template><script>    export default {        data() {            return {                            }        },        onLoad(i) {            // 页面onLoad的时候手动调用            this.$refs.verifyMpsdk.onLoad(i)        }    }</script>保存后重试就能正常显示了SDK图片异常点击快速验证进入下一步及后面的步骤的时候发现页面的图片都挂掉了不显示一开始我一直用的真机调试页面上也不会出现破图控制台也不会报图片异常的错误导致我不知道怎么进行拍摄身份证以为会自动识别身份证然后自动下一步最后在开发者工具里面跑了一遍才知道是图片找不到了然后拍照的图片按钮自然也就显示不了了。最后在SDK里面搜索 /verify_mpsdk/images 在下面文件中找到关键词wxcomponents\\verify_mpsdk\\templates\\ocr\\ocr.wxml 既然这种形式导致运行的时候图片找不到我们可以把SDK所用的图片都复制到项目的 static目录里在 static 中新建 verify_mpsdk 目录将SDK中的图片即 wxcomponents\\verify_mpsdk\\images 复制到 static\\verify_mpsdk 中最终形成以下目录形式最后将 wxcomponents\\verify_mpsdk\\templates\\ocr\\ocr.wxml 中的 /verify_mpsdk/images 批量替换成/static/verify_mpsdk/images 后重试即可然后就都正常了。完整流程最后用真机调试完整跑一把备注：如果最上面的 wx.startFacialRecognitionVerify 服务没有申请到此时点击下一步的会弹出一个无权限的弹窗无法进行下一步这里就是活体人脸检测了需要将脸对准框框点击开始后需要读几个数字最后验证通过后会回到之前的页面（调用gotoVerify()方法的页面）验证成功后会拿到一个 BizToken 可以在 wx.startVerify 回调函数 success 中打印自行查看。拿到 BizToken 后可以调用后端的接口后端通过调用  GetDetectInfo 接口获取并返回本次核身的详细信息包括身份证上的信息和身份证证图片等信息。前端拿到这些信息后根据自己的程序需要做处理。结语整合过程中遇到不少问题百度加google也找不到相关的详细信息人脸核身的相关文档都很简单出现问题后无从下手只能慢慢自己摸索解决了最后写篇文章记录下整个过程也能帮到后面需要集成这个SDK的朋友们。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发之页面分享 onShareAppMessage 分享参数用处               微信小程序canvas绘制圆角base64图片                                                        原作者:  寻梦无痕                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "如何处理小程序独立分包的数据共享问题 ", "author": "                  Rolan                  2020-1-10 00:55                ", "text": "                                                                                                                                                                                     小程序2.3.0版本开始支持独立分包。对于短期的活动落地页我们会选择使用独立分包这可以大大提升活动落地页的加载速度。但与此同时由于独立分包中不能依赖主包和其他分包中的内容独立分包的使用也带来了一些数据共享问题。遇到的问题公用数据处理复杂对于页面间的公用数据我们原本的处理方式是将数据挂在App对象上。但引入了独立分包后判断的逻辑就变得复杂了。例如我们想设计一个计数器counter能够在小程序的各个地方调用。我们将结果记录在app.globalData.count这时候需要分三种场景考虑：主包和普通分包页面中通过getApp()来获取App对象;在App对象中通过this来获取App对象;在独立分包或App对象注册前通过getApp({ allowDefault: true })来获取App对象（新的逻辑）;另外对于3的情况由于App对象可能未初始化还要判断globalData、count属性是否存在。事件被重复绑定通过wx.onError、wx.onPageNotFound等方法可以监控小程序的运行情况我们把这些能力封装在npm包中。export function report() {  // 各种处理逻辑  // ....}wx.onError(report);复制代码当独立分包和主包都引入了这个npm包而npm包中调用wx.onXXXX方法进行了绑定我们可以想到当用户在独立分包和主包页面之间跳转时事件的处理函数会被绑定不止一次（主包一次每个独立分包一次）。解决思路对于需要在主包、独立分包公用数据的情况我们考虑将不同场景下读写app对象的能力封装起来这类似于一个SessionStorage我们可以在任意场景操作SessionStorage里的公用数据而数据会在小程序从冷启动到销毁的运行过程中一直保留。对于事件重复绑定的问题我们使用sessionStorage中的一个key来加锁。实现一个once方法保证同一个key的逻辑只执行一次通过如下的方式来调用export function report() {  // 各种处理逻辑  // ....}once('_wx_onerror_key_', () => { wx.onError(report); });复制代码具体实现为了不与原有的globalData冲突我们使用一个新的BASIC_KEY作为App对象上的属性名来存储sessionStorage的内容。默认以getApp({ allowDefault: true })获取App对象为了满足在App()内调用时也能取到正确的App对象我们可以在App.onLaunch方法时将this传入sessionStorage.setApp(this)。暴露的api对齐浏览器的sessionStorage实现如下：const BASIC_KEY = '_imwxutils_sessionStorageData_';let app = getApp({ allowDefault: true }) || {};app[BASIC_KEY] = app[BASIC_KEY] || {};export function setApp(customApp) {  customApp[BASIC_KEY] = customApp[BASIC_KEY] || app[BASIC_KEY] || {};  app = customApp;}export function setItem(key, value) {  app[BASIC_KEY][key] = value;}export function getItem(key) {  return app[BASIC_KEY][key];}export function removeItem(key) {  app[BASIC_KEY][key] = null;}export function clear() {  app[BASIC_KEY] = {};}复制代码基于sessionStorage我们又可以实现once方法：import * as sessionStorage from './session-storage';const ONCE_BASIC_KEY = '_imwxutils_once_record_';/** * 全局只执行一次的方法 */function once(key, func) {  if (!key) {    return;  }  const record = sessionStorage.getItem(ONCE_BASIC_KEY) || {};  if (record[key]) { // 之前执行过了    return;  }  record[key] = true;  sessionStorage.setItem(ONCE_BASIC_KEY, record);  func();}复制代码以上通过实现sessionStorage和once方法我们解决了独立分包与主包之间数据共享以及事件绑重复定的问题。欢迎交流                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序摸爬滚打之路               微信小程序 动态加载swiper时不显示的问题（爬坑）                                                        原作者: 馒头点心                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序初实践总结 ", "author": "                  Rolan                  2019-12-31 00:05                ", "text": "                                                                                                                                                                                     近期组内接了小程序项目也是有幸能够加入到项目中做一些简单的开发。之前对小程序有所接触但是仅限于自己了解和书写demo真正项目开发还是第一次~开发过程中也是遇到了一些不熟悉和自己觉得是小坑的地方做个简单总结给自己做个记录同时给需要的小伙伴一些小小参考。一、添加一个新组建控制台报错“Component is not found in path '../../components/xx/xx'”。答：这个问题开始是很迷茫的仔细检查了文件名称、引用路径以及父组件usingComponents都没有发现有问题但是控制台依旧提示找不到对应组件。后面经过大老提示： 对于一个新的组件必须在对应的js里添加Component({})json文件里也要写上component:true。加上相关配置后控制台就不会飘红了。二、text组件默认会出现上内边距。答：使用text组件展示文字内容看上去并没有什么技术而言直接引用就好了（心里默默开森）<text>  this is component</text>复制代码但是看到效果之后显然有点蒙圈为什么上边会出现那么大的距离啊？！第一个想法是去看css是否有默认内边距样式然而并没有；通过padding、margin去设置值也没什么用；然后。。然后。。。我就不知道怎么办了只好请教度娘。网上有小伙伴给出了答案其实并不是样式问题而是text组件本身问题要修改这个问题只需要把text标签和内容写在一行就可以了。<text>this is component</text>复制代码三、小程序分享功能页面分享和按钮分享功能。答：众所周知小程序是可以进行分享的有两种方式一个是自带的分享功能另一个是页面上按钮点击分享。本质上他们调用的是同一个方法即onShareAppMessage可以通过options参数的options.from区分是来自按钮还是原生分享可以通过设置对应字段修改分享展示的内容不设置则默认分享当前页。onShareAppMessage (res) {  // 来自页面内转发按钮      if (res.from === 'button') {     return {        title: `标题`,      //分享标题                path: shareUrl,    //分享的链接                imageUrl:‘’        //分享展示的图片                };       } else {           return {               title: `分享标题`,               imageUrl:''         };   }}复制代码按钮分享只需要给button添加一个open-type即可<button open-type=\"share\"></button>。但是此时按钮会有默认样式可以通过控制台查看进行css修复样式分享回调同样调用上边方法。四、小程序内获取某个元素或者组件距离顶部初始高度答：实际开发中我们基本会遇到需要获取某个元素位置信息的需求早在jq一把梭的时代获取这些属性值是很容易的直接一个api就可以了。同样的小程序里也有比较实用的方法我们可以给需要获取位置的元素/组件一个id然后通过下面方法即可获取：let query = wx.createSelectorQuery().in(this);query.select('#testId').boundingClientRect(function(rect){    //rect即包含了所需要的各种位置信息如top、left、right、bottom等})复制代码如果在页面初始化时需要获取到位置可以在onLoad方法里使用（最好使用setTimeout否则可能会取不到）获取对应值之后就可以进行后续的处理了。五、scroll-view组件使用答：滚动组件的使用在开发中可以说很普遍了。小程序也封装了scroll-view组件并提供了一些封装好的方法使用起来可以说很方便了但是也不可避免的有一些需要注意的地方。1、scroll-view的绑定scroll事件不触发当页面组件按照文档方法书写完成后去滚动页面发现页面滚动事件并没有触发后面经过仔细查看确定问题原因是scroll-view没有设置高度而且必须是精准高度不能用百分比。2、scroll-view滚动到某一位置我们开发时可能需要用到点击后滚动到某一位置或者初始化时滚动到对应位置过去通常是通过锚点方式进行触发同样的scroll-view为我们封装了一个很好用的方法scroll-into-view对应的值也是一个id值具体使用方法及注意事项可以参考文档（ scroll-view ）。3、scroll-view中包含fixed定位元素滚动时fixed定位元素闪动这个问题算是比较坑了在scroll-view里面我们设置某个元素或者组件为fixed定位在滚动页面时会发现定位的元素会消失一下然后再出现虽然不是什么严重问题但是很影响用户体验。这个问题我看到社区里也有很多人在问但是目前官方还没有给出合理方法。目前简单的应对方法我总结了两点：一是把定位元素放到scroll-view外部此类方法可以完美避开上述问题但是某些场景下可能不太适用；二是在使用scroll-view时我们通常会设置scroll-with-animation=true即开启滚动过度动画效果当我们把这个值设置为false时上述问题也能很好的解决即使定位元素在scroll-view内部也不会有闪现问题。但是此方法牺牲的也是用户体验如果有短距离的页面滚动可以使用此类方法。欢迎遇到此类问题的小伙伴进行补充在官方给出完美方案之前我们也能有自己的应对方案。六、小程序checkbox样式这个就不得不吐槽一下UI了其他的都还好但是对于表单相对应的样式真的是丑爆了！而且当你想通过css样式覆盖方法修改的时候会发现你的修改根本就是不起作用的！！根本原因就是你所看见的wxml结构与内容和样式所定义的根本不是一个样子！！！当然也有机智的小伙伴探究出了方案（以checkbox为例）：//wxml<label>    <checkbox>aaa</checkbox></label>//wxss//修改checkbox大小checkbox .wx-checkbox-input{}//修改checkbox选中后的样式checkbox .wx-checkbox-input.wx-checkbox-input-checked{}//修改checkbox选中图标样式checkbox .wx-checkbox-input.wx-checkbox-input-checked::before{}复制代码当然如果你不喜欢原组件不想去修改css完全可以自己仿写一个checkbox样式自己写切换效果通过点击事件（参数e获取data）自己控制就好。关于表单内容后面会再总结一个自定义表单及自定义校验方法及自己进行的优化。七、小程序页面跳转跳转到其他域名页面小程序页面跳转我们可以通过wx.navigateTo()方法进行但是当需要跳转到不同域页面时直接跳转链接的方式就不好用了。小程序也为我们提供了方法即webb-view( 使用方法见文档)。以上就是在初次开发中遇到的问题及总结的使用方法后面随着使用的增多肯定还会有更多的问题出现随时进行添加吧算是对小程序使用自己的一个总结有不足和错误之处还希望各位大大提出宝贵意见。ps：前期初次接触小程序书写demo时也遇到了一些小问题付个传送门：初试微信小程序遇到的问题总结                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    uni-app微信小程序开发之引入腾讯视频小程序播放插件               如何一人五天开发完复杂小程序（前端必看）                                                        原作者:  木风622                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序常用样式汇总 ", "author": "                  Rolan                  2019-6-17 00:13                ", "text": "                                                                                                                                                                                                                                                                 小程序特点：用完即走、低频使用、性能要求低不支持webview；以iphone6尺寸（750*1334）为视觉稿进行设计；iphone6下1px=1rpx=0.5pt     iphone6 plux下1px=0.6rpx；使用rpx小程序会自动在不同的分辨率下进行转换而使用px为单位不会；1.设置全局字体样式app.wxss：text{font-family:MicroSoft yahei;}2.设置弹性盒子模型：.container{/*弹性模型*/display:flex;/*垂直方向 列方向 排布*/flex-direction:column;/*居中*/align-items:center;/*要从整体解决排布的问题是最好的方案*/}3.设置页面全屏样式及背景色：page{height:100%;background:#b3d4db;}4.全局设置导航条颜色app.json：\"window\": {\"navigationBarBackgroundColor\": \"#405f80\"}5.页面设置导航条颜色和标题*.json:{\"navigationBarBackgroundColor\": \"#405f80\",\"navigationBarTitleText\":\"文与字\"}6.设置字体属性：.user-name{font-size:32rpx;font-weight:bold;}7.创建圆角矩形边框：.moto-container{border:1px solid #405f80;width:200rpx;height:80rpx;border-radius:5rpx;text-align:center;}8.外边距设置：margin-top:20rpx;margin-bottom:40rpx;9.内边距设置：padding-bottom:20rpx;10.上、下边线设置：border-bottom:1px solid #ededed;border-top:1px solid #ededed;11.文字间距设置：letter-spacing:2rpx;12.垂直居中（此元素放置在父元素的中部）：vertical-align: middle; 13.设置子元素Image样式：.circle-img image{    width:90rpx;    height: 90rpx}14.最底层垂直居中横线样式：.horizon{    width:660rpx;    height: 2rpx;    background-color: #e5e5e5;    vertical-align: middle;    position:relative;    top:46rpx;    margin: 0 auto;    z-index: -99}15.图片居中覆盖:.audio{    width:102rpx;    height:110rpx;    position: absolute;    left: 50%;    margin-left: -51rpx;//经典水平居中方式    top:180rpx;    margin-top: 20rpx;    opacity:0.6;//透明度}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            小程序模板和组件的使用和区别               微信小程序实战教程——1.基础知识                                                        原作者: chenzheng8975                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "腾讯上线新冠肺炎症状自查工具并开放接入 ", "author": "                  Rolan                  2020-2-5 00:27                ", "text": "                                                                                                                                                                                     腾讯科技讯 继1月27日国家卫生健康委宣传司联合腾讯发布“新型冠状病毒感染的肺炎医疗救治定点医院和发热门诊导航地图”后腾讯再上线新冠肺炎症状自查工具帮助遇到发热、咳嗽等症状的用户自我评估病情做出合理的就医安排。打开微信“支付”页进入“医疗健康”服务或者长按二维码即可找到这个“发热自查”工具。这个“发热自查”小工具使用了腾讯AI能力严格遵照国家卫生健康委员会办公厅和国家中医药管理局办公室联合印发的《新型冠状病毒感染的肺炎诊疗方案(试行第四版)》为用户提供风险评估。按照系统提示用户只需要回答相应的问题并会持续根据权威指南等知识更新。如是否有发热、咳嗽等不适症状或者近期是否到过武汉等信息“发热自查”工具即可给出风险评估。针对患新冠肺炎风险较低的情况依照《诊疗方案》“发热自查”工具会给出居家观察、自主报备等指引。遇到风险较高时则会建议建议用户前往发热门诊就诊结合“新型冠状病毒感染的肺炎医疗救治定点医院和发热门诊导航地图”为用户推荐并导航到距离最近的门诊。而随着“发热自查”工具的上线腾讯此前与国家卫生健康委宣传司联合发布的“新型冠状病毒感染的肺炎医疗救治定点医院和发热门诊导航地图”也进入了2.0版本的升级：除了实现“发热自查”和就诊指南外还可查看部分医院的实时详情包括医院实时人流查询找出附近排队最快的医院；查看医院开诊时间及动态公告方便用户规划自己的就诊安排。这两项查询能力也同时向医院开放有意接入向群众提供便捷查询服务的医院可联系liamzhou@tencent.com或者zeyusun@tencent.com提出接入申请。此外“发热自查”工具也公布了开放接入指南方便各地卫健委、医院等机构以及各类资讯服务商通过便捷的微信公众号、小程序等方式为更广泛的用户提供智慧自查帮助降低因求诊不当而引起交叉感染的风险。按照以下指南即可接入“发热自查”工具。一、公众号接入1、关联腾讯健康小程序关联小程序的两种方式方式1：搜索“腾讯健康”方式2：输入Appid：wxb032bc789053daf42、关联后在自定义菜单或公众号推文中添加链接1）自定义菜单：选择跳转小程序-选择腾讯健康-输入小程序路径小程序路径：pages/index/home/main?chanel=AAFM0zwA4qJjIx6syQ6q0JAz&navigate_uri=%2Fpages%2Fwebview%2Fmain%3Fsrc%3Dhttps%253A%252F%252Ffeiyan.wecity.qq.com%252Fwuhan%252Fdist%252Findex.html%2523%252Fselftest%253Ffrom%253Dlung%2526channel%253DAAFM0zwA4qJjIx6syQ6q0JAz%2526_scope%253Dsnsapi_base备用网页（可使用自定链接或使用如下链接）：https://card.wecity.qq.com/v2/social-insurance/base-info?channel=AAEngZ_b9-g2Na-G2sT6HH4n&cityCode=4403002、小程序接入微信官方接口文档链接：https://developers.weixin.qq.com/miniprogram/dev/api/open-api/miniprogram-navigate/wx.navigateToMiniProgram.htmlappId：wxb032bc789053daf4小程序路径：pages/index/home/main?chanel=AAFM0zwA4qJjIx6syQ6q0JAz&navigate_uri=%2Fpages%2Fwebview%2Fmain%3Fsrc%3Dhttps%253A%252F%252Ffeiyan.wecity.qq.com%252Fwuhan%252Fdist%252Findex.html%2523%252Fselftest%253Ffrom%253Dlung%2526channel%253DAAFM0zwA4qJjIx6syQ6q0JAz%2526_scope%253Dsnsapi_base此外我们还支持对新冠肺炎自查工具中部分组件进行自定义配置适配各类应用场景如需个性化配置请发送邮件至 helenlu@tencent.com或1870316620@qq.com申请, 我们将尽快处理配置需求。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序中设置缓存过期               支付宝刚刚发布的“抗疫召集令”开发者能“捞到”啥好处？ ...                                                        原作者: 腾讯科技                   来自: 腾讯科技                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序 接入 腾讯云验证码 ", "author": "                  Rolan                  2020-1-7 00:06                ", "text": "                                                                                                                                                                                     前言：最近做了一个小程序抽奖的活动出现了部分用户恶意薅羊毛的现象因此考虑接入腾讯云的验证码。其实腾讯的官方文档写的相当清晰： https://cloud.tencent.com/doc...不想啃文档的筒子们的就往下继续看吧~（虽然大同小异）整体效果1、小程序触发验证跳转到验证码小程序2、在验证码小程序内通过验证并携带参数跳回原来的小程序3、在原来的小程序内监测携带回的参数并作后续操作前提条件验证码接入前需要先在 验证码控制台 中注册 AppID 和 AppSecret注册完成后您可以在控制台的 基础配置 中查看 AppID (下文extraData中使用) 以及 AppSecret。注意这里的 appId 和 appSecret 和小程序后台的是不一致的！接入步骤1、在你需要的地方唤起验证码小程序首先在 app.json 配置 navigateToMiniProgramAppIdList如下：{  \"navigateToMiniProgramAppIdList\": [\"wx5a3a7366fd07e119\"]}这个appId是官方文档中直接提供的搬上去就好。假设你的唤起方式是通过一个这样的按钮事件：<button bindtap=\"toTCaptcha\">验证</button>toTCaptcha: function () {    wx.navigateToMiniProgram({      appId: 'wx5a3a7366fd07e119',      path: '/pages/captcha/index',      extraData: {        appId: 'appId' //您申请的验证码的 appId      }    })  }2、在 app.js 获取验证结果由于小程序间相互跳转过程中产生的数据仅能在 app.js 中获取到故需要在 app.js 的 onShow 中添加以下代码来捕获验证结果 captchaResultApp({  // ...  onShow: function(options) {    // 解决各类回调的兼容问题    if (!this.captchaTicketExpire) this.captchaTicketExpire = {};    if (options.scene === 1038 && options.referrerInfo.appId === 'wx5a3a7366fd07e119') {      const result = options.referrerInfo.extraData;      if (result.ret === 0) {        const ticket = result.ticket;        if (!this.captchaTicketExpire[ticket]) {          this.captchaResult = result;          this.captchaTicketExpire[ticket] = true;        }      } else {        // 用户关闭了验证码        // 这里可以加上一些验证失败提示      }    }  },  // ...});验证结果（captchaResult） 参数说明：3、将验证结果返回至服务端校验在小程序页面的 onShow 阶段将验证结果及待提交的表单数据一起提交到服务器进行校验。// page.jsconst app = getApp()Page({  data: {    // ...  },  onShow() {    const captchaResult = app.captchaResult;    app.captchaResult = null; // 验证码的票据为一次性票据取完需要置空    if (captchaResult && captchaResult.ret === 0) {      // 将验证码的结果返回至服务端校验以及后续的操作      // const ticket = captchaResult.ticket;      // const randstr = captchaResult.randstr;    }  },  // ...});用一个词描述这个开发过程：搬上去！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)wAllen23                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序长按保存图片               小程序跨页面交互的作用与方法                                                        原作者:  smile1213                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序技能进阶回忆录 - 如何自主实现拦截器 ", "author": "                  Rolan                  2019-10-23 00:23                ", "text": "                                                                                                                                                                                     窗外是5月明媚的阳光澄澈蔚蓝的天空有炮弹欢快地叫着飞过。50多年过去了我依然如此清晰地记得。在一些框架中发现会提供一个很实用的功能：拦截器（interceptor）。例如要实现这个需求：小程序每次获取到定位后都存到\tglobalData 里：wx.getLocation({  // ..  success(res) {    getApp().globalData.location = res    // ...  }})复制代码如果每一处使用\twx.getLocation 的地方都这么写也没啥大问题但总显得不够“智能”一方面是多了重复代码另一方面如果需求变动获取到定位后存到别的地方那要改很多次。优雅的拦截器有了拦截器可以更优雅的实现它：intercept('getLocation', {  success(res) {    getApp().globalData.location = res  }})复制代码只要在一处定义如上的拦截器其他地方直接用\twx.getLocation 即可。那么如何实现上面的方式呢？实现 intercept 方法// utils/intercept.js// 存储拦截器定义var interceptors = {}function intercept(key, config) {  intercept[key] = config}export {  intercept,  interceptors}复制代码很简单暴露出\tintercept 方法定义一个存储器也一并暴露出去。代理 wx要实现使用\twx.getLocation 自动应用拦截器就必须基于原有方法重新定义它。import { interceptors } from './intercept'// 备份原有微信方法var wxBackup = {}[  'getLocation'  // 还可以有很多其他方法 ...].forEach((key) => {  wxBackup[key] = wx[key]  wx[key] = (config) => {    if (interceptors[key]) {      // 备份业务代码传入的回调方法      var backup = {}      var interceptor = interceptors[key]      [        'success',        'fail',        'complete'      ].forEach((k) => {        backup[k] = config[k]        config[k] = (res) => {          interceptor[k](res)          backup[k](res)        }      })    }    wxBackup[key](config)  }})复制代码当然上述代码用数组列出了所有可能被定义拦截器的微信函数也可以使用\tObject.keys(wx) 通用处理。更多使用场景上面的场景比较简单拦截器的应用还有更多场景。比如每次请求传参带上公参经纬度接口返回的数据都会约定包裹在\tobject 中请求回来需要取一遍。数据异常时还要针对错误码做特定处理就可以很方便的用拦截器处理：intercept('request', {  data(data) {    var location = getApp().globalData.location    data.location = location.latitude + ',' + location.longitude    return data  },  success(res) {    if (res.code == 200) {      return res.object    } else {      if (res.code == 'xxx') {        // 登录失效重新登录        // ....      }    }  }})复制代码注意拦截器函数里多了返回值具体实现方法就不多写基于上述实现完善代码即可。总结细心的读者可能发现我们代理或者改造了很多微信提供的方法有些开发者可能不喜欢这样希望保持原有代码的纯洁性。这要看团队喜好吧基于此考虑主要是不想定义太多新的方法或 api尽量以大家最为熟悉的方式书写代码。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序自定义头部导航栏“完美”解决方案               实战分享: 小程序云开发玩转订阅消息                                                        原作者:  摩拜单车前端团队                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "云开发如何实现管理员通知消息 ", "author": "                  Rolan                  2019-11-19 00:03                ", "text": "                                                                                                                                                                                     需求描述小程序目前的主要能力还都在小程序端实现但是我们在进行开发的小程序不可能只有小程序端能力我们也会有一些管理端能力。比如说当用户在小程序中提交了消息以后我们的小程序应该可以通知到小程序的管理员以便让管理员进行下一步操作。解决方案架构说明由于小程序本身不支持长久性的消息通知能力因此我们可以考虑借助一些第三方的服务和能力来完成我们自己的需求。这个需求很适合使用小程序新发布的 长期订阅消息 能力但是目前该能力开放的类目还不足以支持我们的需要。一般而言使用短信是我们目前到达率比较高的能力且更为普遍的能力其他通道的能力大多受限或不符合国情为了确保通知信息的到达率我们这篇文章就使用短信来完成需求。架构图示具体操作1. 开通腾讯云短信服务并获取配置信息我们想要发送短信就需要先有一个短信服务用于发送短信这里我们可以使用腾讯云提供的云短信服务来发送短信。开通腾讯云短信并创建应用首先你需要访问 https://console.cloud.tencent... ,点击开通腾讯云·云短信。在开通完成后点击界面中的【 添加应用 】添加一个新的短信应用你可以根据自己的实际情况添加短信应用的名称和简介。获取 AppID、App Key添加完成后点击你创建好的应用进入到应用详情页,在应用的详情页中的应用信息栏目中你可以找到 AppID 和 AppKey 复制并保存这两个值稍候我们会用到。2. 配置短信模板、短信签名开通了腾讯云短信服务以后我们需要去创建短信模板以及短信签名短信签名则是原来让收到短信的用户知道他所收到的短信来自于他的那一个服务一般来说设置为产品的品名。在腾讯云控制台中进入到【云短信】控制台创建短信签名首先点击【 国内短信 】进入到短信的页面点击【 创建签名 】然后在弹出的窗口中输入你的签名的具体信息比如这里我就是以公众号【程序百晓生】来创建签名。签名创建完成后你需要等待腾讯云官方的审核审核通过以后你添加的签名才可以被使用。创建短信模板创建完签名你需要创建一个短信的正文模板用于发送短信。输入模板名称、短信类型然后选择标准模板中的模板这里我们选择“您有新的{1}订单请注意查收！”这个模板。除了使用标准模板你也可以自己编写一个模板为了方便文章撰写这里使用标准模板。然后点击提交等待审核就可以了。3.编写云函数发送短信在完成了基础的配置后我们在微信开发者工具中实现一个云函数用于调用腾讯云的短信服务实现具体的通知。首先我们创建一个新的云函数名为 notifyAdmin 意为用于通知管理员的云函数。然后选择我们刚刚创建的 notifyAdmin 云函数在函数上右击选择【在终端中打开】进入到控制台并输入如下命令安装所需的短信 SDK。npm install --save sms-node-sdk然后修改云函数的 index.js 加入如下代码// 云函数入口文件const cloud = require('wx-server-sdk')const {  SmsClient} = require('sms-node-sdk');const AppID = 1400286810;  // SDK AppID是1400开头// 短信应用SDK AppKey 替换为你自己的 AppKeyconst AppKey = 'xxxx';// 需要发送短信的手机号码const phoneNumber = '10000000';// 短信模板ID需要在短信应用中申请const templId = 476457;// 签名替换为你自己申请的签名const smsSign = '程序百晓生';// 实例化smsClientcloud.init()// 云函数入口函数exports.main = async (event, context) => {  let orderId = event.orderId;  let smsClient = new SmsClient({ AppID, AppKey });  return await smsClient.init({    action: 'SmsSingleSendTemplate',    data: {      nationCode: '86',      phoneNumber,      templId: templId,      params: [orderId],      sign: smsSign // 签名参数未提供或者为空时会使用默认签名发送短信    }  })}完成代码的修改后就可以部署你的云函数了右键你的云函数选择【上传并部署云函数：云端安装依赖】4. 在小程序端触发短信在前面我们提到在一些特定的场景下我们希望用户的操作可以给管理员发送消息通知。在具体的实现的时候我们可以根据自己的实际业务需求来设定我们的通知发送的条件比如说在用户支付成功后发送消息则相关代码如下：let orderId = 'this is a orderId';wx.requestPayment({    success:res => {        console.log(\"User Payment Success\");        // 调用云函数发送短信        wx.cloud.callFunction({            name:\"notifyAdmin\",            data:{                orderId: orderId            }        });    }})总结经过本次的分享我们了解到了如何借助短信服务实现云开发的后台通知能力实际上除了短信服务你还可以借助一些其他的工具比如邮件、企业微信机器人等能力实现后台管理信息的推送。明天我们将分享 如何借助通过微信发送订单消息 。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发技巧               简单说说微信小程序的底层原理                                                        原作者:  Bestony                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "基于Proxy的小程序状态管理 ", "author": "                  Rolan                  2019-6-21 00:34                ", "text": "                                                                                                                                                                                     作者：wwayne原文： 基于Proxy的小程序状态管理Fundebug经授权转载版权归原作者所有。微信小程序的市场在进一步的扩大而背后的技术社区仍在摸索着最好的实践方案。我在帮助Nike沃尔玛以及一些创业公司开发小程序后依旧认为使用小程序原生框架是一个更高效稳定的选择而使用原生框架唯独缺少一个好的状态管理库如果不引入状态管理则会让我们在模块化项目结构以及单元测试上都有些捉襟见肘。目前相对比较稳健的做法是针对redux或者mobx做一个adaptor应用到小程序中但这样需要自己想办法打包引入外部库还要想怎么去写这个adaptor总显得有些麻烦。于是我迸发出一个想法去写一个专用于小程序的状态管理库它使用起来足够简单并且可以通过小程序自己的npm机制安装。目前我已经用这个开源库开发了两个电商小程序在提高我开发效率的同时亦保证了程序的性能所以接下来我想谈谈这背后的理念以启发更多开发者尝试新的解决方案。基于Proxy的状态管理实现Proxy在小程序中已经得到了足够好的支持目前并没有发现在任何iPhone或者Android上不能使用Proxy的情况。而基于Proxy的状态管理其实也就是订阅监听的模式一方面监听数据的变化另一方面将这些变化传达给订阅的小程序页面。举一个比较常见的例子当一个用户从自己的主页进入用户编辑页面然后更改了自己的用户名点击保存后用户主页和用户编辑页上的用户名这时候都应该被更新。这背后的程序逻辑则是：更新这个行为将触发Proxy去通知状态管理库然后状态管理库负责检查此时还在页面栈中的所有页面更新订阅了用户名这个数据的页面如下图：Part1: 监听数据变化监听数据变化其实就是监听各个Store的属性变化实现上就是在各个Store前面加了一层Proxy用更直观的图片来表示就是这样：当一个Store被观察以后它的属性就都变成了Proxy实例当这个属性值是Object或者Array的时候它内部的值也会被包装成Proxy实例这样无论多深层的数据变动都能被监听到。而在Proxy的后面Store的属性其实是被另一套数据(紫色部分)所维护这套数据不负责监听它就是纯数据针对属性的任何变动最后都会应用到这套数据上来它的作用是维护和返回最新的数据。实现细节： https://github.com/wwayne/min…Part2: 页面数据绑定因为小程序每个页面的js都是向Page中传递一个对象这就让我们有机会包装这个对象从而实现：进入页面后将页面保存在页面栈中将来自状态管理库的数据映射到这个页面的data上来页面退出时将页面从页面栈中移除实现细节： https://github.com/wwayne/min…Part3： 页面订阅更新当数据被监听到变化后我们需要依次做两件事先是找到所有存储在页面栈里的页面然后根据各个页面订阅的数据来检查变化如果有变化就通知这些页面从而让它们去触发setData更新页面。实现细节： https://github.com/wwayne/min…使用状态管理的例子有了状态管理库现在我们就来实现一开始举例的更新用户信息的操作我们的文件路径如下：stores/  user.jspages/  userEdit/     index.js     index.wxml1. 首先我们创建一个Store保存用户的信息并且监听它的变化：// stores/user.jsimport { observe } from 'minii'Class UserStore {  constructor () {     this.name = 'bob'  }  changeName (name) {     this.name = name  }}export default observe(new UserStore(), 'user')2. 接着在我们的小程序页面订阅Store的信息// pages/userEdit/index.jsimport { mapToData } from 'minii'import userStore from '../../stores/user'const connect = mapToData(state => (({  myName: state.user.name}))Page(connect({  updateNameToJames () {    userStore. changeName('james')  }}))3. 完成现在可以在页面中使用和更新数据了// pages/userEdit/index.wxml<text>{{ myName }}</text><button bindtap=\"updateNameToJames\">update name to James</button>最后小程序因为有体积的限制所以我希望在代码量上也尽量做到轻量和便捷所以目前这个状态管理库并没有太多很复杂的功能在小程序打包后所占用的体积也不到1kb颇有点够用就好的意思。我也已经用它开发了两款小程序在经历了一段时间的用户使用后我也更有信心说这个方案在小程序中是可行的。如果你有任何想法和建议都欢迎告诉我。项目Github: https://github.com/wwayne/minii关于作者Hi, 我是wwayne是一名居住在上海的独立软件工程师我正在开发我的新产品 talk-to-kim , 你可以在 Github 或者专栏 一个人写代码 找到我                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    5个套路看懂微信小程序开发               小程序框架原理综合分析和 fard 的新思路                                                        原作者: wwayne                   来自: fundebug                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序 - 输入起点、终点获取距离并且进行路线规划（腾讯地图） ... ... ", "author": "                  Rolan                  2019-8-14 00:49                ", "text": "                                                                                                                                                                                      更新：2018-9-19 腾讯官方经纬度转详细地址详细地址转经纬度 index.wxml<map id=\"myMap\" style=\"width: 100%; height: 300px;\" longitude=\"{{longitude}}\" latitude=\"{{latitude}}\" scale='{{scale}}' polyline=\"{{polyline}}\" markers=\"{{markers}}\" covers=\"{{covers}}\" show-location>map>起点：<input placeholder='请输入起点' bindinput='getStart'>input>终点：<input placeholder='请输入终点' bindinput='getEnd'>input>两点之间的距离：{{resultDistance}}<button bindtap=\"driving\" disabled='{{openNav}}'>开始导航button> 　　index.wxssinput{  border: 1px solid #aaa;} 　　index.js   1 // let coors;  2 // // 引入SDK核心类  3 let QQMapWX = require('./qqmap-wx-jssdk.min.js');  4   5 // 实例化API核心类  6 let qqmapsdk = new QQMapWX({  7   key: '填写地图key'  8 });  9  10 Page({ 11  12   /** 13    * 页面的初始数据 14    */ 15   data: { 16     openNav: true 17   }, 18  19   /** 20    * 生命周期函数--监听页面加载 21    */ 22   onLoad: function (options) { 23     let _page = this; 24  25     wx.getLocation({ 26       type: 'gcj02', //返回可以用于wx.openLocation的经纬度 27       success: function (res) { 28         _page.setData({ 29           latitude: res.latitude, 30           longitude: res.longitude, 31           scale: 10 32         }); 33       } 34     }) 35     wx.clearStorageSync('latlngstart'); 36     wx.clearStorageSync('latlngend'); 37   }, 38  39   /** 40    * 生命周期函数--监听页面初次渲染完成 41    */ 42   onReady: function () { 43  44   }, 45  46   /** 47    * 起点 48    */ 49   getStart(e) { 50     let _page = this; 51      52  53     /** 54      * 修改：以前示例(2018-09-15)地址转经纬度用错接口了 55      */ 56     qqmapsdk.getSuggestion({ 57       keyword: e.detail.value, 58       success: function (res) { 59         let lat = res.data[0].location.lat; 60         let lng = res.data[0].location.lng; 61  62         wx.setStorageSync('latlngstart', { 63           lat: lat, 64           lng: lng 65         }); 66       }, 67       fail: function (res) { 68         console.log(res); 69       }, 70       complete: function (res) { 71         console.log(res); 72       } 73     }); 74  75  76     /** 77      * 修改为（2018-09-19） 78      */ 79  80     qqmapsdk.geocoder({ 81       address: res.address, 82       success: function(res) { 83         let lat = res.result.location.lat; 84         let lng = res.result.location.lng; 85         wx.setStorageSync('latlngendSend', { 86           lat: lat, 87           lng: lng 88         }); 89  90         // 起点经纬度 91         let latStart = wx.getStorageSync('latlngstartSend').lat; 92         let lngStart = wx.getStorageSync('latlngstartSend').lng; 93  94         // 终点经纬度 95         let latEnd = wx.getStorageSync('latlngendSend').lat; 96         let lngEnd = wx.getStorageSync('latlngendSend').lng; 97  98         qqmapsdk.calculateDistance({ 99           to: [{100             latitude: latStart,101             longitude: lngStart102           }, {103             latitude: latEnd,104             longitude: lngEnd105           }],106           success: function(res) {107             console.log(res, '两点之间的距离(代送)：', res.result.elements[1].distance);108             wx.setStorageSync('kmSend', res.result.elements[1].distance + \"\");109           }110         });111       }112     });113 114 115 116     // 如果输入地点为空：则不规划路线117     if (e.detail.value == '') {118       _page.setData({119         openNav: true,120         resultDistance: ''121       });122     } else {123       _page.setData({124         openNav: false125       });126     }127   },128 129   /**130    * 终点131    */132   getEnd(e) {133     let _page = this;134     // 输入地点获取经纬度,我取得是数据的第一条数据.135     qqmapsdk.getSuggestion({136       keyword: e.detail.value,137       success: function (res) {138         let lat = res.data[0].location.lat;139         let lng = res.data[0].location.lng;140 141         wx.setStorageSync('latlngend', {142           lat: lat,143           lng: lng144         });145       },146       fail: function (res) {147         console.log(res);148       },149       complete: function (res) {150         console.log(res);151       }152     });153     // 如果输入地点为空：则不规划路线154     if (e.detail.value == '') {155       _page.setData({156         openNav: true,157         resultDistance: ''158       });159     } else {160       _page.setData({161         openNav: false162       });163     }164   },165   //事件回调函数166   driving: function () {167 168     let _page = this;169 170     // 起点经纬度171     let latStart = wx.getStorageSync('latlngstart').lat;172     let lngStart = wx.getStorageSync('latlngstart').lng;173 174     // 终点经纬度175     let latEnd = wx.getStorageSync('latlngend').lat;176     let lngEnd = wx.getStorageSync('latlngend').lng;177 178 179     _page.setData({180       latitude: latStart,181       longitude: lngStart,182       scale: 16,183       markers: [{184         id: 0,185         latitude: latStart,186         longitude: lngStart,187         // 起点图标188         iconPath: '../image/location.png'189       },190       {191         id: 1,192         latitude: latEnd,193         longitude: lngEnd,194         // 终点图标195         iconPath: '../image/location.png'196       },197       ]198     });199     ``200 201     /**202      * 获取两点的距离203      */204     qqmapsdk.calculateDistance({205       to: [{206         latitude: latStart,207         longitude: lngStart208       }, {209         latitude: latEnd,210         longitude: lngEnd211       }],212       success: function (res) {213         console.log(res, '两点之间的距离：', res.result.elements[1].distance);214         _page.setData({215           resultDistance: res.result.elements[1].distance + '米'216         });217       },218       fail: function (res) {219         console.log(res);220       },221       complete: function (res) {222         console.log(res);223       }224     });225 226     //网络请求设置227     let opt = {228       //WebService请求地址from为起点坐标to为终点坐标开发key为必填229       url: `https://apis.map.qq.com/ws/direction/v1/driving/?from=${latStart},${lngStart}&to=${latEnd},${lngEnd}&key=${qqmapsdk.key}`,230       method: 'GET',231       dataType: 'json',232       //请求成功回调233       success: function (res) {234         let ret = res.data235         if (ret.status != 0) return; //服务异常处理236         let coors = ret.result.routes[0].polyline,237           pl = [];238         //坐标解压（返回的点串坐标通过前向差分进行压缩）239         let kr = 1000000;240         for (let i = 2; i < coors.length; i++) {241           coors[i] = Number(coors[i - 2]) + Number(coors[i]) / kr;242         }243         //将解压后的坐标放入点串数组pl中244         for (let i = 0; i < coors.length; i += 2) {245           pl.push({246             latitude: coors[i],247             longitude: coors[i + 1]248           })249         }250         //设置polyline属性将路线显示出来251         _page.setData({252           polyline: [{253             points: pl,254             color: '#FF0000DD',255             width: 4256           }]257         })258       }259     };260     wx.request(opt);261   }262 })                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序实现语音识别转文字坑路历程               微信小程序开发之页面分享 onShareAppMessage 分享参数用处                                                        原作者: Sunsin                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "【微信小程序】图片压缩-纯质量压缩，非长宽裁剪压缩 ", "author": "                  Rolan                  2019-11-13 00:17                ", "text": "                                                                                                                                                                                     原理：利用canvas来实现将图片绘制到canvas上然后canvas转图片时微信提供的一个方法wx.canvasToTempFilePath(Object object, Object this)此方式可以指定生成图片的质量下图是从官方API截的图：其中quality可以指定图片的质量quality的值越小图片越模糊通过此方法可以实现图片的压缩注意：1.quality设置只对jpg格式的图片有效使用时要将fileType设置为“jpg” 此举可能会导致其它格式的图片变为jpg格式2.透明背景的png图片绘制到canvas上使用此方式导出的图片是黑色背景有需求的话是需要canvas先设置背景色的请小伙伴们注意爬坑。有了这个参数压缩就简单很多了下面是代码：wxml<view>  <button bindtap=\"chooseImage\">选择图片</button></view><!-- 展示压缩后的图片 --><view style=\"display: flex;justify-content: center;flex-direction: column\">  <image width=\"50\" mode=\"widthFix\" src=\"{{imagePath}}\"></image></view><button wx:if=\"{{imagePath.length>0}}\" bindtap=\"save\">点击下载压缩后的图片</button><!-- 用来渲染的canvas --> <canvas canvas-id='attendCanvasId' class='myCanvas' style='width:{{cWidth}}px;height:{{cHeight}}px;position: fixed;top: -9999px;left: -9999px;'></canvas>jsPage({  data: {    imagePath: '',    quality: 0.2  },  onLoad: function (options) {    },  /**  * 选项添加图片事件  */  chooseImage: function (e) {    var that = this;    wx.chooseImage({      sizeType: ['compressed'],  //可选择原图或压缩后的图片      sourceType: ['album', 'camera'], //可选择性开放访问相册、相机      success: result => {        wx.getImageInfo({          src: result.tempFilePaths[0],          success: function (res) {            that.setData({              cWidth: res.width,              cHeight: res.height            })            that.getCanvasImg(result.tempFilePaths, res.width, res.height, that.data.quality, function (res) {              that.setData({                imagePath: res.tempFilePath              });            });          }        })      }    })  },  /**   * 质量压缩   */  getCanvasImg(tempFilePaths, canvasWidth, canvasHeight, quality, callback) {    var that = this;     const ctx = wx.createCanvasContext('attendCanvasId');    ctx.clearRect(0, 0, canvasWidth, canvasHeight);    ctx.drawImage(tempFilePaths[0], 0, 0, canvasWidth, canvasHeight);    ctx.draw(false, function () {      wx.canvasToTempFilePath({        canvasId: 'attendCanvasId',        fileType: 'jpg',        quality: quality,        success: function success(res) {          callback && callback(res)        }, fail: function (e) {          wx.showToast({            title: '图片上传失败请重新上传！',            icon: 'none'          })        }      });    });  },  /**   * 图片保存到相册   */  save(e) {    let that = this;    wx.saveImageToPhotosAlbum({      filePath: that.data.imagePath,      success: function (res) {        console.log('图片已保存');      },      fail: function (res) {        console.log('保存失败');      }    })  },})注意点：注意设置canvas-id='attendCanvasId'canvas要离屏渲染就是移出屏幕之外但是元素还是显示的position: fixed;top: -9999px;left: -9999px; 不能使用 display: none; 这样是获取不到canvas元素的。最后h5页面中也有提供这样的方法例如这样子：let canvas = document.createElement('canvas');let ctx = canvas.getContext('2d');ctx.drawImage(imagePath, 0, 0, w, h);canvas.toDataURL('image/jpeg', quality);需要的小伙伴也可以自己研究研究哈...源码-欢迎star感谢ok, 结束                                               .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    当小程序的flex布局遇到button时justify-content不起作用的原因及解决方案 ...               小程序导航栏选择每一项居中(scroll-view)                                                        原作者:  orangleLi                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "闲鱼前端基于 serverless 的一种多端开发解决方案 ", "author": "                  Rolan                  2019-11-18 00:27                ", "text": "                                                                                                                                                                                     背景前端的发展太快了前端框架和技术的发展也层出不穷还包括不同智能设备的出现对前端开发同学来说是个很大的跳转简单列举下：前端框架：vue、react、angular小程序：微信小程序、支付宝小程序、字节跳动小程序智能设备：苹果设备、天猫精灵、小度这样就滋生了一些问题比如我要开发一个通用的页面兼容不同的端侧和小程序显然目前是做不到的我们只能开发多套页面去适配不同的场景这样的话成本就太高了。很多同学都在尝试解决这个问题也催生了类似 taro 这样的多端统一开发框架这是一个好的解决方案但是比较被动缺乏一定的扩展性。这篇文章我们要探讨的是看能不能换个角度去解决这个问题提升开发效率。ViewModel当我们在开发一个页面的时候不管用的是哪一种框架通常都会抽象出一层 viewmodel 层它主要有 2 个作用和服务端进行交互接受后台返回的数据进行加工并传递给 view 层渲染接受 view 层的回调加工数据并返回给 view 层渲染从上图中我们可以看出viewmodel 是一段独立的通用代码逻辑起到了承前启后的作用。它和 view 层关系更加紧密因此通常会放在前端测。既然 viewmodel 是独立的那我们能不能把它放在后端呢？这样一个最大的好处就是 viewmodel 可以进行复用不需要在重复编写而且只需要改动一个 viewmodel就可以全量生效。似乎是一个很美好的想法但是这部分代码由谁去开发呢总不可能寄希望于后端同学吧当然只能是我们自己也感谢于 serverless 架构的出现让这件事情变成了可能。有些同学可能会问既然 viewmodel 后移了那 view 呢？后续会考虑结合我们的 ui2code 技术那真的就比较完美了。什么是 serverless我们先简单介绍一下什么是 serverlessserverless 的基础是云技术它是云技术发展到一定阶段而出现的一种革命性的高端架构。serverless 并不是说不需要服务器而是指不需要开发者去关心底层服务器的状态、资源和扩容等开发者只需要关注于业务逻辑实现。架构上我们可以把 serverless 分为 FaaS 和 BaaS。FaaS 是用于创建、运行、管理函数服务的计算平台它支持多种开发语言比如 java、nodejs、dart 等这有利于不同端侧的开发同学介入开发。FaaS 是基于事件驱动的思想只有当一个函数被事件触发时才会占用服务器资源执行不然都是无需占用服务器资源的。BaaS 提供了用于函数调用的第三方基础服务比如身份校验、日志、数据库等它是由服务商直接提供开发者无需关系实现直接调用即可。业务落地我们是通过 gaia 平台 开发后端接口gaia 可以理解为上文提到的 FaaS 平台。日常开发中有这样一个需求下面是这个需求的一个页面。因为这个页面上的数据比较多先把它切分成一个个小的模块后台返回数据的时候也根据模块来返回数据。我们是根据 viewmodel 来设计接口首先肯定有一个首屏数据接口；然后是页面上的交互比如切换卡片、切换芝麻信用按钮切换会引起页面数据变化我们可以统一封装一个页面更新的接口；最后是一个开通的接口。后端接口前后端交互最重要的数据结构的设计我们省略了中间的业务逻辑处理看下接口的数据结构。首屏接口返回的数据主要有几个特征：根据前端的页面模块定义返回结构字段的颗粒度很细页面上的每个元素都对应一个字段值有两个字段来控制模块的显示和刷新更新接口的返回数据结构和首屏接口类似但是入参有所不同主要包括 2 个字段：data：当前页面的数据为了避免数据的重复获取action: 定义的页面操作前端处理从后端返回的数据可以看到数据是及其详细的无需我们做任何的业务逻辑处理直接映射到页面即可。这样前端已经变成了很薄的一层数据没有任务的业务逻辑处理变的很简单当需要迁移到其他端时只需要迁移视图层即可。当有任何的业务变动时只需要修改后端的接口就能生效。收益与总结通过具体的实践我们发现对于前端开发同学来说变的简单了开发效率有很大的提升前端同学甚至都不需要去理解具体的业务逻辑就能完成页面的开发。而且提取的 viewmodel 可以复用到不同的端侧设置还包括 native 端。我们还可以将 viewmodel 拆分成更小粒度的 viewmodel方便在不同的页面接口中进行复用。我们有同学还在 FaaS 侧基于 redux 的思想封装了一个通用的状态管理框架规范了前后端的交互。后面 还有一些问题待我们去解决比如开发成本、viewmodel 的逻辑拆分、具体接口问题定位等。本文转载自公众号闲鱼技术（ID：XYtech_Alibaba）。原文链接：https://mp.weixin.qq.com/s/VLsVTe4ZyOJ9rNyVf5aXyg                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    开始你的uniapp之旅:写出你的第一个微信小程序               小程序 swiper 如何多页面高度自适应                                                        原作者: 还休                   来自: 微信                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序 - 自定义导航栏重要步骤 ", "author": "                  Rolan                  2019-10-21 00:09                ", "text": "                                                                                                                                                                                     几个要点：statusBarHeight 用来获取手机状态栏的高度()调用 wx.getSystemInfo 获取还有注意的在写样式距离和大小时建议都用px因小程序右边的胶囊也是用的px不是rpx。wx.getMenuButtonBoundingClientRect() 获取胶囊信息用来计算 导航栏高度单个页面配置自定义导航记得把基础库 调节到 2.8.0 之上, 仅支持 微信客户端7.0.0 向上官方链接：自定义导航页面配置：navigationStyle状态栏高度 wx.getSystemInfo()胶囊 wx.getMenuButtonBoundingClientRect()根据需求来设计（可以计算各种高度）wx.getSystemInfo --> res.statusBarHeight胶囊高度 + ( 胶囊距离顶部距离 - 状态栏高度) * 2data：{        statusHeight: 0,  //状态栏高度        navHeight: 0      //导航栏高度    }    /**     * 获取状态栏|导航栏高度,     */    getStatusBarHeight: function(){        let capsule = wx.getMenuButtonBoundingClientRect() ; //胶囊信息        wx.getSystemInfo({            success(res) {                that.setData({                    statusHeight: res.statusBarHeight,                    navHeight: capsule.height + (capsule.top - res.statusBarHeight) * 2                })            }        })          },复制代码<view class=\"status-height\" style=\"height:{{ statusHeight }}px\">  //状态栏    cc</view><view class=\"nav-height\"  style=\"height:{{ navHeight }}px\">       //导航栏    bb</view>    复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    如何实现微信小程序换头像？三步帮你搞定！               小程序技能进阶回忆录 - 在缺少组件化的日子里                                                        原作者:  北风丶                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序 模拟打电话 实践 ", "author": "                  Rolan                  2019-11-20 00:50                ", "text": "                                                                                                                                                                                     模拟电话模拟打电话功能拨下指定的号码如10086等待1.5秒后开始播放本地音频文件并计时。使用小程序官方API createInnerAudioContext()创建 InnerAudioContext对象。小程序官方推荐使用更为强大的音频上下文对象InnerAudioContext官方已经停止了对组件的维护。上述这个demo效果的具体实现如下代码：<template><view class=\"task\">  <view class=\"call\">    <!-- 顶部区域 -->    <view class=\"top\" wx:if=\"{{phone.length > 0}}\">      <view class=\"phone\">{{phone}}</view>      <view class=\"tip\" wx:if=\"{{calling}}\">        <view wx:if=\"{{tipShow}}\">正在呼叫...</view>        <view wx:else>{{formatMmSs}}</view>      </view>    </view>    <!-- 中间区域 -->    <view class=\"middle\">      <view class=\"nums\" wx:if=\"{{showNums}}\" @tap=\"numClick\">        <view class=\"row\">          <view class=\"num\" data-num='1'>1</view>          <view class=\"num\" data-num='2'>2</view>          <view class=\"num\" data-num='3'>3</view>        </view>        <view class=\"row\">          <view class=\"num\" data-num='4'>4</view>          <view class=\"num\" data-num='5'>5</view>          <view class=\"num\" data-num='6'>6</view>        </view>        <view class=\"row\">          <view class=\"num\" data-num='7'>7</view>          <view class=\"num\" data-num='8'>8</view>          <view class=\"num\" data-num='9'>9</view>        </view>        <view class=\"row\">          <view class=\"num\" data-num='*'>*</view>          <view class=\"num\" data-num='0'>0</view>          <view class=\"num\" data-num='#'>#</view>        </view>          </view>      <view class=\"icons\" wx:else>        <view class=\"icon\">          <image src=\"{{img.ringIcon1}}\"></image>          <view>静音</view>        </view>        <view class=\"icon\">          <image src=\"{{img.ringIcon2}}\" @tap=\"handle('back')\"></image>          <view>拔号</view>        </view>        <view class=\"icon\">          <image src=\"{{img.ringIcon3}}\"></image>          <view>免提</view>        </view>      </view>    </view>    <!-- 底部区域 -->    <view class=\"bottom\">      <image wx:if=\"{{!calling}}\" class=\"btn\" src=\"{{img.call}}\" @tap=\"handle('call')\"></image>      <image wx:else class=\"btn\" src=\"{{img.cancel}}\" @tap=\"handle('cancel')\"></image>      <image wx:if=\"{{!calling && phone.length>0}}\" class=\"del\" src=\"{{img.delete}}\" @tap=\"handle('delete')\"></image>    </view>  </view></view> </template><script>import wepy from 'wepy'import img from '@/assets'export default class Test extends wepy.page {  config = {    navigationBarTitleText: '模拟电话'  }  data = {    img: img,    phone: '',        // 10086    tipShow: false,   // 显示呼叫中    calling: false,   // 是否拔通电话    showNums: true,   // 显示数字面板    seconds: 0        // 计时  }  computed = {    // 通话计时 格式化    formatMmSs() {      return this.mmss(this.seconds)    }  }  // 格式化时间  mmss(count) {    count = count % 3600  // 不考虑 HH    let mm = Math.floor(count / 60)    let ss = count % 60    if (mm < 10) mm = '0' + mm    if (ss < 10) ss = '0' + ss    return mm + ':' + ss  }  onLoad() {    // 音频上下文    wepy.setInnerAudioOption({      mixWithOther: false,    // 终止其他应用或微信内的音乐      obeyMuteSwitch: false   // 在静音模式下也能播放声音    })    let ctx = wepy.createInnerAudioContext()    ctx.src = '/assets/media/10086.mp3'    ctx.loop = true    ctx.onPlay(() => {      console.log('开始播放')    })    ctx.onError((res) => {      console.log(res.errMsg)    })    this.ctx = ctx  }  methods = {    // 点击数字    numClick(e) {      console.log(e)      console.log(e.target.dataset.num)      const num = e.target.dataset.num      this.phone = this.phone + num    },    handle(type) {      switch (type) {        case 'call':          // 拔打电话          if (this.phone !== '10086') {            wepy.showToast({ title: '请拔打10086', icon: 'none' })          } else {            this.calling = true            this.tipShow = true            // 延迟1.5秒后开始计时并播放音频文件            setTimeout(() => {              this.ctx.play()              this.showNums = false              this.timer = setInterval(() => {                this.tipShow = false                this.seconds = this.seconds + 1                this.$apply()              }, 1000)            }, 1500)          }          break        case 'cancel':          // 挂掉电话          clearInterval(this.timer)          this.ctx.seek(0)          this.ctx.stop()          this.phone = ''          this.calling = false          this.showNums = true          this.seconds = 0          break        case 'delete':          // 删除电话号码的最后一位          let phone = this.phone          let arr = phone.split('')          arr.pop()          this.phone = arr.join('')          break        case 'back':          // 返回至数字键盘          this.showNums = true          break        default:          break      }    }  }}</script><style lang='less'>.task {  position: absolute;  top: 0;  bottom: 0;  left: 0;  right: 0;  overflow: hidden;  background: rgba(0, 0, 0, 1);  // 打电话区域  .call {    position: absolute;    top: 0;    right: 0;    bottom: 0;    left: 0;    z-index: 2;    .top {      position: absolute;      top: 48rpx;      left: 0;      right: 0;      color: #FDFDFD;      text-align: center;      .phone {        font-size: 72rpx;        line-height: 100rpx;      }      .tip {        font-size: 36rpx;        line-height: 54rpx;      }    }    .middle {      position: absolute;      top: 232rpx;      left: 0;      right: 0;      // 数字面板      .nums {        .row {          width: 540rpx;          margin: 0 auto;          height: 158rpx;          overflow: hidden;          .num {            float: left;            margin: 0 30rpx;            width: 120rpx;            height: 120rpx;            border-radius: 50%;            background:rgba(229,229,229,1);            text-align: center;            line-height: 120rpx;            font-size: 60rpx;            color: black;          }          .num:active {            background:rgba(229,229,229,0.5);          }        }      }      // 免提等      .icons {        margin: 0 auto;        width: 540rpx;        height: 250rpx;        overflow: hidden;        padding-top: 196rpx;        .icon {          float: left;          width: 120rpx;          margin: 0 30rpx;          &>image {            display: block;            width: 120rpx;            height: 120rpx;            border-radius: 50%;          }          &>image:active {            opacity: 0.7;          }          &>view {            font-size: 32rpx;            color: #FDFDFD;            text-align: center;            line-height: 68rpx;          }        }      }    }    .bottom {      position: absolute;      top: 940rpx;      left: 0;      right: 0;      text-align: center;      .btn {        display: inline-block;        width: 120rpx;        height: 120rpx;        border-radius: 50%;      }      .del {        display: inline-block;        width: 75rpx;        height: 56rpx;        position: absolute;        top: 46rpx;        right: 138rpx;      }      .btn:active {        opacity: 0.7;      }      .del:active {        opacity: 0.7;      }    }  }}</style>                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序 - 可搜索的地址选择               小程序包大小优化(uni-app)                                                        原作者: 夏海峰                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "上传小程序的代码时自动压缩 ", "author": "                  Rolan                  2019-4-22 00:34                ", "text": "                                                                                                                                                                                     为了节省开发时间我们尽量整合现有业务线小程序代码减少业务改动。目录结构同时为了后期计算各业务占用空间情况方便我们直接将各业务线小程序工程代码拷贝到各自业务线目录下最终的目录结构如下：.├── common # 通用模块/公共业务├── home   # 首页├── flight # 机票├── train  # 火车票├── bus    # 汽车票├── hotel  # 酒店└── ticket # 门票common 模块即工程的复用部分具体业务代码都在各自目录下。总体架构如下：公共组件、API微信小程序其实并没有提供组件化开发的方式。只是提供了 template 的方式所以我们只提供了为数不多的页面及组件例如：城市定位、日历组件等。但是收益却是非常明显的像这些页面大小都在 20KB~30KB如果每个业务自己整一套可能将徒增上百 KB 代码。公共 API 我们提供了统一的 Watcher 监控、 Requester 请求、 Loading 加载转态、 Navigation 导航等。这些公共逻辑的抽取为整个项目整合节省了巨大的空间使 size 达标看起来不那么难了。工程复用上节省了很大一部分空间。但是空间是有限的业务需求是无限的。而且size 的大小会影响用户加载的速度包括下载最新版本代码的速度和小程序初始化的速度所以还需要进一步进行代码压缩。打包压缩工具微信开发者工具我们知道微信小程序开发者工具本身提供了『代码压缩上传』功能。但是个人觉得它是个『假的压缩选项』。因为在阅读开发者工具的源码逻辑之后发现它的压缩只是将 JavaScript 用 uglify 进行混淆压缩。而对 WXML、WXSS 没有进行任何压缩处理。同时对资源路径中的无用文件也没有做处理。小程序的构建在小程序开发者工具的 Sources 面板查看 JavaScript 脚本会发现：项目中所有的 JavaScript 都会被 同步加载 不管是否被 require 。每个脚本都会被套上如下代码：define(\"some.js\", function(require,module){    // 原本的代码});这种加载方式类似 AMD但是跟标准的 AMD 又有些不同缺少了依赖部分的声明。而对于 WXSS 和 WXML 文件则被开发者工具自动转换为 JavaScript 后加载其中：WXSS：主要处理的是 import 逻辑然后生成的 CSS通过脚本的形式插入页面使用。WXML：类似于 React Naitive 的 JSX被编译成 createElement 类似的形式。一些技巧在 MacOS 系统中右键开发者工具『Show Contents』（显示包内容）就能在 Resources/app.nw/ 下找到相应的源码完成路径如下： /Applications/wechatwebdevtools.app/Contents/Resources/app.nw/ 。源码都是压缩过后的 JavaScript 脚本可以使用 js-beautity 进行格式化以便于阅读。// 在源码目录的 app 目录下执行find . -type f -name '*.js' -exec js-beautify -r -s 2 -p -f '{}' \\;在资源目录下: app/dist/app.js 的第 37 行 window.addEventListener(\"resize\", function() {}) 之前加入 nw.Window.get().showDevTools(); 。之后每次打开微信开发者工具时会自动启动针对『开发者工具』的开发者工具并可以通过它调试微信的开发者工具。在打印日志时不要用 console.log 请使用 global.contentWindow.console.log 。这样才能输出到上面所说的开发者工具的开发者工具的控制台里。（NW.js 的 Node JS Context 和 Webkit JS Context 是分开的 JavaScript 脚本运行在 Node 的 JS Context 中因此打印其实打印在 Node 的输出中并不在  Webkit 的开发者工具的控制台中。 global.contentWindow 获取的是 Webkit 的 JS Context 里的 Window）使用这两点技巧读者们可以优雅地去阅读微信开发者工具的源码了。在阅读源码知道微信小程序的内部加载构建方式之后我们可以针对性的对 JavaScript、WXML、WXSS 等代码文件进行打包压缩。压缩 JavaScript由于微信只是将 js 进行了混淆压缩并没有打包合并成一个文件。所以我们提供了打包压缩工具将 js 文件合并压缩成一个 bundle.js 文件。合并成一个文件有以下好处：require 的长路径没了脚本压缩效率变高代码合并在一起混淆性越大文件合并减少了 IO 次数提升了加载效率上文说了 JavaScript 都会被同步加载所以不用担心打包成一个文件后会延长小程序加载时间。那么打包压缩工具具体做了什么工作呢？小程序有一个统一的入口是 app.js 而每个页面都有自己的入口 page.js利用 AST将 page.js 里页面注册 Page(pageOpt) 代码改成 global.YPage(pageName, pageIndex)(pageOpt)pageName 页面路由pageIndex 是打包工具根据页面路由内部自动维护的// global.YPage 函数global.YPage = (pageName, index)=> {    return (pageOpt) => {        // 其他处理逻辑        global['p' + index] = ()=> {            Page(pageOpt);        }    }}这样 page.js 里实际是这样的代码global['p' + index] = ()=> {       Page(pageOpt);}这样并不会执行 Page(pageOpt) 页面也没注册啊。这就是要达到的目的继续往后看。将所有这些入口 require 到一个统一的入口文件中然后用 webpack 打包压缩输出到 bundle.js 。require('app.js')require('page1.js')require('page2.js')...现在 page.js 里的代码都打包到单一文件 bundle.js 里了。将 page.js 内容替换成 global['p' + index]() 这样第三步中的 Page(pageOpt) 不就可以执行注册页面了。最后一步替换 app.js 内容为 require('./bundle.js') 即大功告成。压缩 WXML、WXSS、JSONWXML/<!--((.|\\n|\\r)*?)-->/gm 去除注释/\\\"\\n\\s*/g 去除换行WXSS直接用 uglifycssJSON直接 JSON.stringify(JSON.parse(...))这里有些读者会可能提出两个疑问：空白字符、换行能有多少减不了多少吧？开发者工具为什么不做对这些文件的压缩？关于第一个问题一个约 1000KB 的代码空白字符和换行大概有 10KB。在有上限的情况之下10 KB 也是要珍惜的。关于第二个问题个人认为微信开发者工具的开发者觉得没有必要去做。因为WXML 和 WXSS 都会被转义成 JavaScript 脚本在此过程中不管 WXML 和 WXSS 是否被压缩它们的转化结果是相同的。因此压缩与否对于最终产物是没有影响的（最终产物指在服务器二次打包后的结果也是用户真正使用的）。但是Size 是以本地打包上传的内容进行计算的不进行此步压缩会使微信服务端判定的 Size 增大。删除无用文件工程庞大了肯定会存在很多无用的空目录空文件没有被 import 的 js 、 wxml 、 wxss 文件。删除这些无用文件不仅可以减小 size还可以提升小程序加载时间。上文说了这些文件都会被转成 JavaScript 进行加载的是会占用加载时间的。删除无用 JavaScript由于通过 webpack 打包除了 page.js 、 bundle .js 文件其他 js 文件都可以删掉。删除无用 WXML打包压缩工具在打包时已经记录了所有页面的路由。遍历分析所有路由下的 wxml 文件通过 xmldom 解析代码记录其他被 import 的 wxml 文件。最后遍历所有 wxml 文件删除不在 import 列表里的无用 wxml 文件。删除无用 WXSS类似处理 WXML。遍历分析所有路由下的 wxss 文件通过正则 /@import\\s*[\"']([^\"']+)[\"']/g 分析代码记录其他被 import 的 wxss 文件。最后遍历所有 wxss 文件删除不在 import 列表里的无用 wxss 文件。代码级优化除了利用工具进行压缩在编写代码时也可以通过一些方法来减小体积在这里简单列几点：使用 ES6 时尽量不使用依赖 Runtime/Polyfill 的语法例如 import 和 class 。图标使用 Iconfont。等等…最终效果经过打包工具的极限压缩处理还有代码设计上的可复用性目前我们七个业务线的微信小程序整合后代码编译包大小维持在 1300KB 左右。还剩余 730KB 的可用空间。结语希望此次在微信小程序整合上做的工程化抽取公共逻辑、规范业务代码通过工具进行针对性的代码打包压缩的实践能给大家带来一定的帮助再宏伟的目标拆分下来也只是一串串的代码而已；一串串的代码细分来看也只是一个一个的字母而已！也许我做不到一晚上完成大神一小时随便敲打的项目但为这一目标每天添砖加瓦我想我应该是可以完成的！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 封装路由 mini-router               服务端使用 nodejs 获取带参微信小程序码图片                                                        原作者: 0C°                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "[博客小程序]评论通知功能实现(二)——实战过程中的坑 ", "author": "                  Rolan                  2019-4-15 00:22                ", "text": "                                                                                                                                                                                     上一篇 小程序发送模板消息的几种实现 主要介绍了实现评论通知功能最重要的一环这篇文章主要介绍实现该功能的具体实战。实现流程思路其实很简单简单画了个流程图如下：这里有两个比较坑的地方一个是微信本身发送模板消息的限制：当用户在小程序内发生过提交表单行为且该表单声明为要发模板消息的开发者需要向用户提供服务时可允许开发者向用户在7天内推送有限条数的模板消息（1次提交表单可下发1条多次提交下发条数独立相互不影响）另外一个就是管理员如何初始化自己的formId的问题而且自身的formId需求量比较大读者评论完之后就要向管理员推送消息。所以无奈增加了一个后台配置的功能定期手动触发去生成自己的FormId「自动不行只能手动泪奔中」另外补充下网上说的通过嵌套穿透的方式无限获取formId的方式已经行不通了生成出来的formId都是一样的。评论提交收集FormId首先我们需要收集用户的 FormId ,有FormId才能发送对应的模板消息在表单标签上加上 report-submit 属性即可。<form catchsubmit=\"formSubmit\" report-submit=\"true\">这样我们在提交评论表单的时候会获取到对应的 FormId , 我们将这个FormId保存至我们的云函数中。//评论提交按钮部分代码console.info(e.detail.formId)if (e.detail != undefined && e.detail.formId != undefined) {    var data = {        formId: e.detail.formId,        author: 0,        timestamp: new Date().getTime()      }    wxApi.insertFormIds(data).then(res => {        console.info(res)      })    }    //调用云数据库function insertFormIds(data) {  return db.collection('openid_formids').add({    data: data  })}这样管理员在接收到评论之后回复时就可以到 openid_formids 的集合中找到对应的formId来进行评论回复的模板消息推送了。管理员生成FormId为了让管理员能有更多的 FormId 来接收评论通知因此我在小程序中搭建了个生成FormId的小页面。这样偶尔登录自己的小程序查看下自己FormId的使用情况若没有了可以手动生成几个。当然这里会有一个权限问题理论上这个页面只有管理员才可以展示而其他人是没有权限访问的因此需要提供个验证权限的云函数。这里可以使用云函数的环境变量来简单做个验证将你的管理员的openId配置在环境变量中云函数验证下openId是否一致即可。云函数代码如下这样代码中不会存放敏感信息开源的代码上传 github 也不会泄露。/** * 验证 * @param {} event  */async function checkAuthor(event) {  if (event.userInfo.openId == process.env.author) {    return true;  }  return false;}发送模板消息最后就是发送模板消息的实现了方法在上一篇说的比较具体了基于我的博客小程序使用云调用是最方便的。主要逻辑是根据传入的openId（如果为空默认取管理员的openId）到云数据库中取对应的formId。然后基于openId和formId发送相应的模板消息发送后从云数据库中移除「发送一次后FormId就已经失效了」具体代码实现如下：/** * 发送通知消息 * @param  event  */async function sendTemplateMessage(event) {  var touser = \"\";  var form_id = \"\";  var openId = event.tOpenId == \"\" ? process.env.author : event.tOpenId  //1.获取formId  var openIdformIds = await db.collection('openid_formids').where({    _openid: openId  }).limit(1).get()  if (openIdformIds.code) {    return;  }  if (!openIdformIds.data.length) {    return;  }  touser = openIdformIds.data[0]['_openid']  form_id = openIdformIds.data[0]['formId']  //2.取到后从云数据库中移除  const removeResult = await db.collection('openid_formids').doc(openIdformIds.data[0]['_id']).remove()  console.info(event.nickName + \":\" + event.message)    //3.发送模板消息  const sendResult = await cloud.openapi.templateMessage.send({    touser: touser,    templateId: template,    formId: form_id,    page: 'pages/detail/detail?blogId=' + event.blogId,    data: {      keyword1: {        value: event.nickName // keyword1 的值      },      keyword2: {        value: event.message // keyword2 的值      }    },  })  return sendResult}到这里具体实现流程就介绍完了过程中还是会遇到些编码问题「主要还是对前端不是很熟悉基本功问题」总结虽然功能基本实现也已经上线了但其实还是有一些细节问题的。比如通知消息点进去之后应该自动转到对应的评论区域formId过期需要定时清理管理员FormId需要通知管理员等可以利用小程序的定时触发器等功能慢慢优化后期优化后再来写文章总结。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    [博客小程序]评论通知功能实现(一)——小程序发送模板消息的几种实现 ...               小程序 template 模版使用方法                                                        原作者: bug2048                   来自: bug2048                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序canvas绘制圆角base64图片 ", "author": "                  Rolan                  2019-8-19 00:47                ", "text": "                                                                                                                                                                                     接口返回base64格式小程序二维码以往的做法是需要再调一个接口去拿到jpg/png格式的图片。如果没有这个接口呢是不是也可以？然而小程序canvas并不支持直接使用base64绘制好在小程序的文件系统提供了方法可以把base64经过进一步处理转成本地图片。获取base64格式图片getXcxQrcode() {\twx.request({\turl: app.globalData.globalUrl + \"/get_wx_code\",\tdata: {\t\ttoken: app.globalData.weixin_token,\t\tscene: app.globalData.page_key,\t\tpage: \"pages/index/index\"\t},\tsuccess: (res) => {\t\tif (data.data.success) {\t\t\tthis.base64src(data.data)\t\t}\t}\t})}base64格式图片转换成本地图片base64src(base64data) {\tconst filePath = `${wx.env.USER_DATA_PATH}/tmpbase64.png`;\tconst buffer = wx.base64ToArrayBuffer(base64data.buffer);\tlet that = this;\tfsm.writeFile({\t  filePath,\t  data: buffer,\t  encoding: 'binary',\t  success() {\t    that.setData({\t      qrcodeUrl: filePath  // 得到http://usr/tmpbase64.png\t    })\t  },\t  fail() {\t    reject(new Error('ERROR_BASE64SRC_WRITE'));\t  },\t});},使用获得的本地图片绘制圆角二维码var qrW = 150; //绘制的二维码宽度var qrH = 150; //绘制的二维码高度var qr_x = 540; //绘制的二维码在画布上的位置var qr_y = 960; //绘制的二维码在画布上的位置ctx.save();ctx.beginPath(); //开始绘制//先画个圆   前两个参数确定了圆心 （x,y） 坐标  第三个参数是圆的半径  四参数是绘图方向  默认是false即顺时针ctx.arc(qrW / 2 + qr_x, qrH / 2 + qr_y, qrW / 2, 0, Math.PI * 2, false);ctx.clip(); //画好了圆 剪切  原始画布中剪切任意形状和尺寸。一旦剪切了某个区域则所有之后的绘图都会被限制在被剪切的区域内 这也是我们要save上下文的原因ctx.drawImage(this.data.qrcodeUrl, qr_x, qr_y, qrW, qrH);ctx.draw()                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    uni-app微信小程序接入人脸核身SDK               扫小程序码实现网站登陆,提供源代码                                                        原作者: xiaojiecong                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "在小程序中实现 Mixins 方案 ", "author": "                  Rolan                  2019-6-20 00:20                ", "text": "                                                                                                                                                                                     原文来自我的博客：jrainlau.github.io/#/article?n…在原生开发小程序的过程中发现有多个页面都使用了几乎完全一样的逻辑。由于小程序官方并没有提供 Mixins 这种代码复用机制所以只能采用非常不优雅的复制粘贴的方式去“复用”代码。随着功能越来越复杂靠复制粘贴来维护代码显然不科学于是便寻思着如何在小程序里面实现 Mixins。什么是 MixinsMixins 直译过来是“混入”的意思顾名思义就是把可复用的代码混入当前的代码里面。熟悉 VueJS 的同学应该清楚它提供了更强大了代码复用能力解耦了重复的模块让系统维护更加方便优雅。先看看在 VueJS 中是怎么使用 Mixins 的。// define a mixin objectvar myMixin = {  created: function () {    this.hello()  },  methods: {    hello: function () {      console.log('hello from mixin!')    }  }}// define a component that uses this mixinvar Component = Vue.extend({  mixins: [myMixin]})var component = new Component() // => \"hello from mixin!\"复制代码在上述的代码中首先定义了一个名为 myMixin 的对象里面定义了一些生命周期函数和方法。接着在一个新建的组件里面直接通过 mixins: [myMixin] 的方式注入此时新建的组件便获得了来自 myMixin 的方法了。明白了什么是 Mixins 以后便可开始着手在小程序里面实现了。Mixins 的机制Mixins 也有一些小小的细节需要注意的就是关于生命周期事件的执行顺序。在上一节的例子中我们在 myMixin 里定义了一个 created() 方法这是 VueJS 里面的一个生命周期事件。如果我们在新建组件 Component 里面也定义一个 created() 方法那么执行结果会是如何呢？var Component = Vue.extend({  mixins: [myMixin],  created: function () {    console.log('hello from Component!')  }})var component = new Component()// =>// Hello from mixin!// Hello from Component!复制代码可以看运行结果是先输出了来自 Mixin 的 log再输出来自组件的 log。除了生命周期函数以外再看看对象属性的混入结果：// define a mixin objectconst myMixin = {  data () {    return {      mixinData: 'data from mixin'    }  }}// define a component that uses this mixinvar Component = Vue.extend({  mixins: [myMixin],  data () {    return {      componentData: 'data from component'    }  },  mounted () {    console.log(this.$data)  }})var component = new Component()复制代码在 VueJS 中会把来自 Mixins 和组件的对象属性当中的内容（如 data, methods等）混合以确保两边的数据都同时存在。经过上述的验证我们可以得到 VueJS 中关于 Mixins 运行机制的结论：生命周期属性会优先执行来自 Mixins 当中的后执行来自组件当中的。对象类型属性来自 Mixins 和来自组件中的会共存。但是在小程序中这套机制会和 VueJS 的有一点区别。在小程序中自定义的方法是直接定义在 Page 的属性当中的既不属于生命周期类型属性也不属于对象类型属性。为了不引入奇怪的问题我们为小程序的 Mixins 运行机制多加一条：小程序中的自定义方法优先级为 Page > Mixins即 Page 中的自定义方法会覆盖 Mixins 当中的。代码实现在小程序中每个页面都由 Page(options) 函数定义而 Mixins 则作用于这个函数当中的 options 对象。因此我们实现 Mixins 的思路就有了——劫持并改写 Page 函数最后再重新把它释放出来。新建一个 mixins.js 文件：// 保存原生的 Page 函数const originPage = PagePage = (options) => {  const mixins = options.mixins  // mixins 必须为数组  if (Array.isArray(mixins)) {    delete options.mixins    // mixins 注入并执行相应逻辑    merge(mixins, options)  }  // 释放原生 Page 函数  originPage(options)}复制代码原理很简单关键的地方在于 merge() 函数。merge 函数即为小程序 Mixins 运行机制的具体实现完全按照上一节总结的三条结论来进行。// 定义小程序内置的属性/方法const originProperties = ['data', 'properties', 'options']const originMethods = ['onLoad', 'onReady', 'onShow', 'onHide', 'onUnload', 'onPullDownRefresh', 'onReachBottom', 'onShareAppMessage', 'onPageScroll', 'onTabItemTap']function merge (mixins, options) {  mixins.forEach((mixin) => {    if (Object.prototype.toString.call(mixin) !== '[object Object]') {      throw new Error('mixin 类型必须为对象！')    }    // 遍历 mixin 里面的所有属性    for (let [key, value] of Object.entries(mixin)) {      if (originProperties.includes(key)) {        // 内置对象属性混入        options[key] = { ...value, ...options[key] }      } else if (originMethods.includes(key)) {        // 内置方法属性混入优先执行混入的部分        const originFunc = options[key]        options[key] = function (...args) {          value.call(this, ...args)          return originFunc && originFunc.call(this, ...args)        }      } else {        // 自定义方法混入        options = { ...mixin, ...options }      }    }  })}复制代码Mixins 使用在小程序的 app.js 里引入 mixins.jsrequire('./mixins.js')复制代码撰写一个 myMixin.jsmodule.exports = {  data: { someData: 'myMixin' },  onShow () { console.log('Log from mixin!') }}复制代码在  page/index/index.js 中使用Page({  mixins: [require('../../myMixin.js')]})复制代码大功告成！此时小程序已经具备 Mixins 的能力对于代码解耦与复用来说将会更加方便。作者：Jrain链接：https://juejin.im/post/5d0a07eb6fb9a07eba2c4142来源：掘金著作权归作者所有。商业转载请联系作者获得授权非商业转载请注明出处。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    mpVue + 云开发微信小程序之旅               玩玩微信小程序（多图预警）                                                        原作者:  Jrain                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序摸爬滚打之路 ", "author": "                  Rolan                  2020-1-10 00:12                ", "text": "                                                                                                                                                                                     上面这张图相信接触过小程序的开发者多多少少都有看到过小程序的渲染层和逻辑层分别由 2 个线程管理：视图层的界面使用了 WebView 进行渲染逻辑层采用 JsCore 线程运行 JS脚本。那么为什么要这样设计呢为了管控和安全我们需要阻止开发者使用一些例如浏览器的window对象跳转页面、操作DOM、动态执行脚本的开放性接口。我们可以使用客户端系统的 JavaScript 引擎iOS 下的 JavaScriptCore 框架安卓下腾讯 x5 内核提供的 JsCore 环境。这个沙箱环境只提供纯 JavaScript 的解释执行环境没有任何浏览器相关接口。2.双线程之间的通信既然小程序的模型是双线程模型那么是如何实现双线程之间的通信呢由上图可以看出逻辑层和视图层是通过Native层来进行转发的这也就是说我们可以把 DOM 的更新通过简单的数据通信来实现类似于虚拟DOM的实现用JS对象模拟DOM树然后进行diff,然后把差异在视图层进行渲染这一系列在Native之间的转化则由小程序的基础库来完成。3.组件系统--Exparser框架Exparser是微信小程序的组件组织框架内置在小程序基础库中为小程序的各种组件提供基础的支持。小程序内的所有组件包括内置组件和自定义组件都由Exparser组织管理。DOM模型：模型上与WebComponents的ShadowDOM高度相似但不依赖浏览器的原生支持也没有其他依赖库；实现时还针对性地增加了其他API以支持小程序组件编程。可在纯JS环境中运行：这意味着逻辑层也具有一定的组件树组织能力。高效轻量：性能表现好在组件实例极多的环境下表现尤其优异同时代码尺寸也较小。当前Web Component已经支持局部作用域、slot插槽等等现有框架所提供的组件化方法学习Web Component也是我接下来自己学习的目标之一 Orz 。4.setData干了些什么小程序的视图层目前使用 WebView 作为渲染载体而逻辑层是由独立的 JavascriptCore 作为运行环境。在架构上WebView 和 JavascriptCore 都是独立的模块并不具备数据直接共享的通道。当前视图层和逻辑层的数据传输实际上通过两边提供的 evaluateJavascript 所实现。即用户传输的数据需要将其转换为字符串形式传递同时把转换后的数据内容拼接成一份 JS 脚本再通过执行 JS 脚本的形式传递到两边独立环境。而 evaluateJavascript 的执行会受很多方面的影响数据到达视图层并不是实时的。5.运行机制小程序启动会有两种情况一种是「冷启动」一种是「热启动」。假如用户已经打开过某小程序然后在一定时间内再次打开该小程序此时无需重新启动只需将后台状态的小程序切换到前台这个过程就是热启动；冷启动指的是用户首次打开或小程序被微信主动销毁后再次打开的情况此时小程序需要重新加载启动。小程序开发日常问题1.wx.request()的promise化小程序框架自带的网络请求和Ajax请求非常相似都是异步请求请求参数中需要送入url、method、data、header等参数还要设置success成功的回调函数和fail失败的回调函数如下图所示通过回调函数处理就很容易造成回调地狱所以Promise化还是很有必要的class request {  constructor() {    this._baseUrl = 'https://xxx.com/api';    this._token = wx.getStorageSync('token');    this._header = {}  }  /**   * GET类型的网络请求   */  getRequest(url, data, header = this._header) {    return this.requestAll(url, data, header, 'GET')  }  /**   * DELETE类型的网络请求   */  deleteRequest(url, data, header = this._header) {    return this.requestAll(url, data, header, 'DELETE')  }  /**   * PUT类型的网络请求   */  putRequest(url, data, header = this._header) {    return this.requestAll(url, data, header, 'PUT')  }  /**   * POST类型的网络请求   */  postRequest(url, data, header = this._header) {    return this.requestAll(url, data, header, 'POST')  }    requestAll(url, data, header, method) {    return new Promise((resolve, reject) => {      wx.request({        url: this._baseUrl + url,        data: data,        header: header,        method: method,        success: (res => {          if (res.statusCode === 200) {            resolve(res)          } else {            //其它错误提示用户错误信息            reject(res)          }        }),        fail: (res => {          reject(res)        })      })    })  }}export default request复制代码2.小程序的WXS在小程序的日常开发中大家肯定会遇到需要对数据进行过滤转义的场景而微信小程序没有像Vue一样的filter过滤器功能大多数人会在渲染之前对数据进行一次清洗而WXS就是为了解决这一痛点什么是WXS是小程序出的一套脚本语言用于 wxml 模板文件中在模板文件中可以完成页面的结构。不依赖于运行时的基础库脚本可以在所有版本的小程序中运行。WXS 中不能调用 javascript 中定义的函数或者变量也不能调用小程序提供的 API他的运行环境和 javascript 是隔离的。小程序的条件渲染和循环渲染对 WXS 是无效的就是说如果 WXS 代码包裹在未渲染的代码中只要渲染的 wxml 部分调用了此模块此段 WXS 代码依然会被加载。由于运行环境的差异在 ios 设备上小程序的 WXS 会比 javascript 快 2~20 倍在 android 设备上运行效率无异。模块想要暴露自己的私有变量和方法只能通过 module.exports 实现。 若在模块中想要引用其他模块只能通过 require 实现。只能使用 var 来定义变量表现形式和 javascript 一样会有变量提升。WXS 模块只能在定义模块的 wxml 文件中被访问到使用 或 时WXS 模块不会被引入到对应的 wxml 文件中。不能使用 new Date() 应该使用 getDate() 。WXS最常见的用处可能就是实现一个过滤器如下所示<wxs module=\"filter\">    function getFullPath(url) {        return \"https://shiyuanjieyi.cn\" + url    }    module.exports.getFullPath = getFullPath</wxs><image src=\"{{filter.getFullPath(url)}}\"></image>复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)荔枝很甜                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    探索小程序实现               如何处理小程序独立分包的数据共享问题                                                        原作者:  我切图贼快                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序模板和组件的使用和区别 ", "author": "                  Rolan                  2019-6-14 00:53                ", "text": "                                                                                                                                                                                                                                                                 不得不说微信小程序的官方文档还是有很多坑啊(⊙﹏⊙)使用模板和组件的目的：实现代码复用template（模板）相对于component而言template更加轻量级它的功能有限主要是用于展示。模板只有两个以.wxml 和.wxss结尾的文件定义模板新建一个与pages同级的文件夹 => templates,在templates下创建templateItem文件夹然后在这个文件夹里创建同名的.wxml和.wxss的文件使用name属性作为模板的名字然后在<template/> 内定义代码片段template必须要写templateItem.wxml :<template name=\"msgItem\">        <view class=\"content\">我是模板的内容</view></template>复制代码可以在templateItem.wxss中添加一些好看的样式.content {       width: 100%;        height: 400rpx;       background-color: yellowgreen;        display: flex;        justify-content: center;        align-items: center;}复制代码接下来就可以在页面中使用模板了使用模板要使用模板首先得在要使用的页面引入模板使用import标签导入使用is属性声明需要使用的模板比如在index.wxml中使用：index.wxml :<!-- index.wxml --><import src=\"../../templates/templateItem/templateItem.wxml\" /><view>        <template is=\"msgItem\" /></view>复制代码注意： import标签不能省略  /,不然会报错现在模板的内容可以显示在页面上了但是模板的样式却没有生效。想要让样式生效必须在index.wxss 中引入模板的样式文件：/** index.wxss **//** 如果下面还有样式 这里的分号不能省略 **/@import \"../../templates/templateItem/templateItem.wxss\";复制代码现在模板的颜色也出来啦~                            到这里一个最简单的模板就完成了模板传值模板除了可以写代码片段外is属性可以使用Mustache语法来动态决定具体需要渲染哪个模板在index.js中的data中添加一些数据// index.js​//获取应用实例cosnt app = getApp()​;Page({        data: {            hero: {               name: '盖伦'             profession： '战士',             skill: '得玛西亚正义'        }    }})复制代码修改一下模板：<template name=\"msgItem\">    <view class=\"content\">        <view class=\"content\">我是模板的内容</view>        <view>                        <text>{{ name }}</text>---                        <text>{{ professios }}</text>---                        <text>{{ skill }}</text>                 </view>       </view></template>复制代码在模板原理的样式基础上中增加：flex-direction: column;复制代码保存并运行此时就多了好多内容了(#^.^#)                                     模板的作用域模板拥有自己的作用域只能使用data 传入的数据以及模板文件中定义的<wxs />模块component（组件）从小程序基础库版本 1.6.3 开始小程序支持简洁的组件化编程。所有自定义组件相关特性都需要基础库版本 1.6.3 或更高。开发者可以将页面内的功能模块抽象成自定义组件以便在不同的页面中重复使用；也可以将复杂的页面拆分成多个低耦合的模块有助于代码维护。自定义组件在使用时与基础组件非常相似。自定义组件在pages的同级目录下创建components文件夹类似于页面一个自定义组件由json wxml wxss js 4个文件组成。要编写一个自定义组件首先需要在json文件中进行自定义组件声明（将component字段设为true)使用微信开发者工具创建component会自动生成。{    \"component\": true}复制代码在组件文件中编写一些看起来很厉害的代码<!-- 这是自定义组件内部的内容 --><view class=\"herocontainer\">        <view>姓名：{{ hero.name }}</view>        <view>职业：{{ hero.profession }}</view>        <view>技能：{{ hero.skill }}</view></view>复制代码在自定义组件的js文件中需要使用 Component 来注册组件并提供组件的属性定义、内部数据和自定义方法// 这是自定义组件内部的js文件Component({        properties: {                // hero收一个对象                hero: Object        },        data: {           //这里是一些组件内部数据       },    methods： {            //这里是自定义方法    }})复制代码也给它添加一些看起来很厉害的样式/** 这是自定义组件内部的wxss文件 **/.herocontainer {        width: 750rpx;        height: 200rpx;        background-color: yellow;        color: hotpink;}复制代码注意：在组件wxss中不应该使用ID选择器、属性选择器和标签名选择器自定义组件中写了wxss和 js使用时无需在页面中导入只需导入组件即可使用自定义组件使用自定义组件前首先要在要使用的页面的json文件中进行引用声明此时需要提供每个自定义组件的标签名和对应的自定义组件文件路径{        \"usingComponents\": {       \"my-component\": \"../../components/mycomponent/mycomponent\"        }}复制代码这样在页面的wxml 中就可以像使用基础组件一样使用自定义组件啦节点名就是自定义组件的标签名节点属性就是自定义组件的属性值<view>        <my-component hero=\"{{hero }}\" /></view>复制代码黄色部分为组件的内容：            自定义组件传值页面 ----->  组件\t组件中通过proprtties写上要接受的值\t页面通过属性名称和值的方式传递上面就是页面传值到组件组件 -----> 页面\t页面中写监听事件\t组件中写触发事件在自定义组件中添加一个事件<button bindtap=\"onTap\">点击按钮触发事件</button>复制代码在组件的js文件methods中添加方法,通过this.triggerEvent()给也面传值在data中定义一个数据用来传给页面data: {     message: '欢迎来到英雄联盟'  },onTap(){        const message = this.data.message        this.triggerEvent('myevent',message)}复制代码在页面的js中添加一个与data同级的方法通过事件对象的e.detail拿到传过来的值Page({        onMyEvent(e){        console.log(e.detail)        }})复制代码在页面中绑定事件<my-component hero=\"{{ hero }}\" bindmyevent=\"onMyEvent\" />复制代码点击按钮之后控制台会输出组件传过来的值不出意外就是 ==>  欢迎来到英雄联盟 注意坑点因为wxml节点标签只能是小写字母、中划线和下划线组合自定义组件也只能是这样自定义组件也是可以引用自定义组件的引用方法类似于页面引用自定义组件的方式自定义组件和页面所在项目根目录名不能以wx-为前缀否则会报错总结template 和 components 的共性： 不能单独呈现出来必须依附显示在页面不同点：template比较轻量级没有自己的逻辑处理能力只能来着页面显示值组件要重量级一些它有自己的逻辑处理能力                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            ［插件使用］wepy 微信小程序使用 腾讯视频插件               微信小程序常用样式汇总                                                        原作者: 404的魔咒                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序中设置缓存过期 ", "author": "                  Rolan                  2020-1-15 00:23                ", "text": "                                                                                                                                                                                     需求是两张图片在这个时间段内交替显示当天只弹一次图片。后端返回的数据格式：{    \"start\": \"2019/10/08 00:00:00\",    \"end\": \"2019/10/30 23:59:59\",    \"ads\": [        {            \"image\": \"xxxx\",            \"uri\": \"wechat:zhizhuxy666\"        },        {            \"image\": \"xxx\",            \"uri\": \"wechat:zhizhuxy666\"        }    ]}复制代码小程序中缓存没有过期时间也就是说存储进去的缓存要自己手动清除那么如何保证两张图片能够交替显示呢？需求分析一天只弹一次广告图片轮流显示只在时间范围内显示这里有个关键是如何知道时间有没有到第二天？思路需要用到两个缓存：showAdvert：用于检测弹窗时间是否在有效期内showAdvert${currentDay}：用于检测当天是否弹过弹窗为什么要用到两个？因为这里有两个状态检测：一个是否在有效期内一个是当天是否弹过弹窗。如何判断时间有没有到第二天？将所有天数的时间戳加上一天保存起来（ps：这个方法很蠢）。然后每次进入小程序都获取下当前的时间对比下当天的时间是否大于保存的时间戳。如果超过就说明已经到了第二天。为什么要加上一天？因为后端返的开始时间是当天的凌晨而真正要过完这一天是24点之后。一天的毫秒数：24 * 60 * 60 * 1000。代码实现变量的声明声明需要使用的时间戳const startTempStamp = new Date(item.start).getTime()       const endTempStamp = new Date(item.end).getTime()const oneDayTempStamp = 24 * 60 * 60 * 1000     // 一天的时间戳const now = (new Date('2019/09/28 00:00:01')).getTime()复制代码声明需要一共多少天以及当天是第几天；这里使用Math.ceil()向上取整const allDay = Math.ceil((endTempStamp - startTempStamp) / oneDayTempStamp)const currentDay = Math.ceil((now - startTempStamp) / oneDayTempStamp)复制代码判断当前时间是否在时间有效期内内如果在时间有效期内就弹弹窗如果不在就不弹if (now > startTempStamp && now < endTempStamp) {    ... //下面弹窗逻辑的实现}else {    this.setData!({showAdvert: false})    wx.setStorageSync('showAdvert', false) }复制代码接下来开始写弹出弹窗的逻辑。弹窗逻辑的实现首先判断当天的时间戳是否大于前一天的时间戳如果大于就说明到第二天了如果小于说明今天还没有过去。然后清除前一天的缓存const table = []for (let i = 1; i <= allDay; i++) {    table.push(startTempStamp + oneDayTempStamp * i)}if (now > table[currentDay - 2]) {    wx.removeStorageSync(`showAdvert${table[currentDay - 2]}`)}复制代码图片交替显示let n = 0if (currentDay % item.ads.length === 0) {    n = 1} else if (currentDay % item.ads.length === 1) {    n = 0}复制代码检查当天广告是否弹出过const advert = wx.getStorageSync(`showAdvert${table[currentDay - 1]}`) || false       if (!advert) {    this.setData!({showAdvert: true})    wx.setStorageSync('showAdvert', true)}复制代码弹出广告并设置缓存const timeStamp = Math.floor(new Date().getTime() / 10000).toString()this.setData!({    advertLink: item.ads[n].image + `?timeStamp=${timeStamp}`,    copyWechat: item.ads[n].uri,}, () => {    wx.setStorageSync(`showAdvert${table[currentDay - 1]}`, true)})复制代码一进入页面读下本地缓存是否要弹出弹窗。onShow(){    const showAdvert = wx.getStorageSync('showAdvert')    this.setData!({showAdvert})}复制代码总结这里最大的问题是如何判断当前的时间有没有过24点自己一直没有想到比较好的解决方法限于自己的水平没有更好的方案这里我只是记录下实现的过程不喜勿喷如果有更好的方案欢迎指点。另外可添加微信ttxbg180218交流                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序搜索优化指南               腾讯上线新冠肺炎症状自查工具并开放接入                                                        原作者: 天天天天天                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "如何一人五天开发完复杂小程序（前端必看） ", "author": "                  Rolan                  2019-12-31 00:21                ", "text": "                                                                                                                                                                                     随着业务需求的不断累加、小程序追求快速产出。在人手不足且开发周期较短的情况下我们需要找到一个最大化开发效率的方法。而高效率的开发离不开规范化、工程化、组件化。为此整理写下总结细数小程序中的坑与实践。介绍我们对小程序高效率开发的思考与探索。布局方案导航栏TabBarBasicPage用户系统登录方案初始化登录鉴权优化及 Bug 追踪日志收集数据分析常用优化方案preLoad独立分包加载布局方案我们首先思考的是在小程序中如何快速且高还原产出页面。为此我们封装了一套页面组件。导航栏目前小程序有如下两种导航栏：常规、自定义导航栏自定义导航栏布局下我们可以完全控制导航栏样式赋予导航栏更多交互及 UI 设计上的可能。如上图所示Readhub 在导航栏中加入了设置按钮喜茶在个人页中标题渐隐及沉浸式导航栏效果。常规布局下顶部导航栏部分直接使用小程序提供导航栏。可根据具体业务选择具体布局方案在我们小程序中我们选择了全部使用自定义导航栏的方式并对其进行了一定封装。在确定使用自定义导航栏方案后我们对导航栏进行了拆解拆解后我们发现可以将自定义导航栏分为两个部分：StatusBar 及 NavigationBar 。通过查阅微信 API 我们分别通过 wx.getSystemInfoSync 及 wx.getMenuButtonBoundingClientRect 获取到 StatusBarHeight 及 MenuButton 的布局信息。由拆解图可知1 NavigationBarPaddingTop = MenuButtonTop - StatusBarHeight3 NavigationBarPaddingBottom = NavigationBarPaddingTop5 NavigationBar = StatusBarHeight + NavigationBarPaddingTop + NavigationBarPaddingBottom + MenuButtonHeight复制代码得到上述数据后结果简单封装 我们得到如下方案StatusBar 部分 我们使用 PaddingTop 填充。可在此基础上可再进一步封装一些通用 NavigationBar 组件。我们封装了一些常用 NavigationBar 组件 如下所示：沉浸式导航栏自定义 TabBar目前小程序 TabBar 中也存在两种方案。常规 TabBar ：微信提供方案可修改 icon 、 文字及其对应选中状态。自定义 TabBar ：小程序基础库 2.5.0 开始支持。可通过其实现异形 TabBar 或各种自定义样式。在我们小程序中我们选择全部使用自定义 TabBar 来实现业务。由于小程序基础库 2.5.0 之后官方才开始支持自定义 TabBar 。我们此处不直接选择使用 custom-tab-bar 方案。选择结合 custom-tab-bar 、 自定义组件及 wx.hideTabBar 的方案实现。具体方案为放置空节点 custom-tab-bar 文件。在页面中按需引入自定义 TabBar 组件。在页面初始化完成后调用 wx.hideTabBar 隐藏原 TabBar 。这样做的好处在于在基础库 2.5.0 及更高版本时正常显示在低版本时以最小代价兼容。在 iPhone X 系列下的底部安全区兼容方案如下 1@mixin media-style() { 2  .tab { 3    padding-bottom: 84px; 4  } 5} 6// 适配iPhone X系列下巴 7@media screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) { 8    @include media-style(); 9}1011@media only screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio:3) {12    @include media-style();13}1415@media only screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio:2) {16    @include media-style();17}18// 下面代码只为适配iPhone X在微信调试模拟器中为724px19@media screen and (device-width: 375px) and (device-height: 724px) and (-webkit-device-pixel-ratio: 3) {20    @include media-style();21}复制代码推荐如无特殊需求建议直接使用微信提供方案在自定义 TabBar 方案中 安卓手机下拉刷新时 TabBar 会被拉出可视区域。需自定义下拉刷新组件解决方案整合 BasicPage以上方案在线上运行一段时间后稳定后。对自定义导航栏及自定义 TabBar 方案进行了整合。封装了 BasicPage 组件。以我们线上典型页面为例我们可以将页面分为两大类。基于以上分析结合线上需求我们对此基础组件进行封装。Taro 框架伪代码可根据各自使用框架进行封装思路一致 1class BasicPage extends Taro.Component { 2 3  state = { 4    menuButtonHeight: 32, 5    menuButtonTop: 48, 6    statusBarHeight: 44, 7  }; 8 9  componentDidMount() {10        // ...获取并设置 menuButtonHeight 、 menuButtonTop 、 statusBarHeight11  }1213  render() {14    return (15      <View className='basic-page'>16        {17          this.props.header && <View className={`basic-page-header${this.props.fixed ? ' fixed' : ''}`} style={{18            paddingTop: `${this.state.statusBarHeight}px`,19            height: `${(this.state.menuButtonTop - this.state.statusBarHeight) * 2 + this.state.menuButtonHeight}px`,20          }}21          >22            {this.props.renderHeader}23          </View>24        }25        <View className={`basic-page-body${this.props.tab ? ' tab' : ''}`}>26          {this.props.renderBody}27        </View>28        {this.props.tab && <TabBar active={this.props.tabActive} />}29      </View>30    );31  }32}3334BasicPage.defaultProps = {35  fixed: false, // header 是否浮动36  tab: false,37  header: false,38  tabActive: 'template',39};40复制代码使用中会经常用到 自定义 TabBar 、 自定义 NavigationBar 布局数据。再封装一个工具类获取。 1import Taro from \"@tarojs/taro\"; 2 3function rpx2px(rpx, windowWidth) { 4  return rpx / 750 * windowWidth; 5} 6 7export default class customConfig { 8 9  static fetchAllConfig() {10    const menuButton = Taro.getMenuButtonBoundingClientRect();11    const systemInfo = Taro.getSystemInfoSync();1213    const statusBarHeight = systemInfo.statusBarHeight;14    const headerHeight = (menuButton.top - systemInfo.statusBarHeight) * 2 + menuButton.height;15    const footerHeight = systemInfo.model.indexOf('iPhone X') === -116      ?17      rpx2px(100, systemInfo.windowWidth)18      :19      rpx2px(168, systemInfo.windowWidth);  // 50  8420    const bodyHeight = systemInfo.windowHeight - statusBarHeight - headerHeight - footerHeight;21    const noTabBodyHeight = systemInfo.windowHeight - statusBarHeight - headerHeight;2223    let data = {24      source: {25        menu: menuButton,26        system: systemInfo,27      },28      height: {29        statusBar: statusBarHeight,30        header: headerHeight,31        body: bodyHeight,32        noTabBody: noTabBodyHeight,33        footer: footerHeight,34      },35    };36    Taro.setStorageSync('customConfig', data);37    return data;38  }3940  static get config() {41    let storageInfoSync = Taro.getStorageSync('customConfig');42    if(!storageInfoSync) {43      storageInfoSync = this.fetchAllConfig();44    }45    return storageInfoSync;46  }47}复制代码到此我们完成对基础页面组件的封装。目前线上运行小程序所有页面都基于该组件进行开发。开发新页面时只需要引用该组件即可。1<BasicPage header tab tabActive='index' 2        renderHeader={ 3          <View 4            className='my-index-header' 5          > 6            <Text>Title</Text> 7          </View> 8        } 9        renderBody={10          <View className='my-index-header'>11            Body12          </View>13        }14/>复制代码用户系统在一个应用中用户系统是至关重要的。我们通过数个小程序的开发整理了一套我们目前正在使用的用户系统实践。登录、获取用户信息如上图所示我们将小程序登录及获取用户信息拆分为两部分。主要有如下考虑：降低用户使用门槛可先让用户体验部分功能。后续分享或互动时提示授权完善用户信息保证始终持有用户登录态方便程序处理。如把用户登录及完善用户信息放置一起在未授权时无法获取自定义登录态。判断变得复杂且无法提前收集 formId同一开发者账号下多小程序互通时如有一小程序用户授权过可通过返回 unionid 直接同步信息无需再授权提升用户体验。处理注意点授权获取用户信息时如果服务端未记录用户 sessionKey 在 Button type = getUserInfo 回调事件中使用 wx.login 方法获取 code 的话会导致 sessionKey 变化。从而导致 getUserInfo 时使用 sessionKey 与新 sessionKey 不匹配。从而导致解密用户信息失败。解决方案有如下两种：Button type = getUserInfo 回调事件中使用 wx.login 方法后再次调用 wx.getUserInfo 方法重新获取加密用户信息。服务端记录 sessionKey Button type = getUserInfo 回调后无需调用 wx.login 直接提交供服务端处理。第一种方案适合简单改造旧项目、快速开发但强烈建议使用服务端处理方式解决。完善用户信息时解密用户信息部分请查看官方文档这里不叙述具体流程https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.htmlunionid 机制另外在登录流程中服务端向微信换取 sessionKey 过程中如果满足一定条件会直接返回 unionid 。同开发者账号下多个小程序时可用 unionid 做用户信息同步无需再授权。提升用户体验。unionid 机制: https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/union-id.html小程序初始化及页面初始化处理在日常开发中我们通常会把登录获取 token 操作放置在小程序初始化中即 app.js 定义的 onLaunch 中。而该生命周期与页面初始化生命周期为同步进行。此时如果在页面初始化中需要携带用户登录态请求接口获取信息时可能出现如下情况因为小程序初始化及页面初始化是同步进行的。若页面初始化时小程序初始化中登录请求仍未完成。会导致未携带 token 或其他鉴权信息鉴权失败。最开始我们通过在组件中挂载一个特殊事件 componentDidInit 待小程序初始化登录请求后获取当前页面实例进行调用。但该方案对代码侵入性太强最终我们选择维护一个登录请求队列。用上队列的原因在于在产品需求上经常会有先跳入首页再从首页跳入二级页的需求这样能让用户回退一次后仍然能回到首页。但会导致在不同页面中近乎同时调用 login 方法。在第一种方案中解决该问题需要获得所有页面实例进行调用。而引入队列后只需要轮询消费队列中函数执行即可。上述流程可解决此问题。伪代码如下：代码仅供理解思路 1let loginDoing = false; 2const loginEvent = []; 3 4const userProfile = observable({ 5  user: { 6    avatar: '', 7    isCompleted: false, 8    nickname: '', 9    uid: 0,10    token: '',11  },12  async loginProcess() {13    if(this.user.token) {14      return this.user;15    }16    loginDoing = true;17    let code;18    try {19      const codeResult = await Taro.login();20      if(codeResult.errMsg !== 'login:ok') {21        throw new Error('Taro.login 失败');22      }23      code = codeResult.code;24    } catch (e) {25      loginDoing = false;26      throw e;27    }28    const result = await post(URL().user.login, {29      code,30    });31    let user = {32      ...result.user,33      token: result.token,34    };35    this.user = user;36    loginDoing = false;37    setTimeout(() => {38      let length = loginEvent.length;39      for(let i = 0; i < length; i++) {40        loginEvent.pop()(user);41      }42    });43    return user;44  },45  login() {46    if(loginDoing) {47      return new Promise((resolve) => {48        loginEvent.push(resolve);49      });50    } else {51      return this.loginProcess()52    }53  },54});复制代码鉴权业务需求中通常存在某些操作需要 【 用户授权完善信息 】 后才能继续进行早期项目中都是各自页面中写鉴权代码。因而会涉及大量重复代码也不利于快速开发。为此我们封装了一套鉴权方案。BasePage通过所有页面基础一个基类 BasePage 。在 BasePage 中写入鉴权逻辑来实现。配合在主页面中使用 AuthorizationModal 组件实现鉴权。代码仅供理解思路1 export default class BasePage extends Component { 2 3    state = { 4        // 鉴权相关 5        showAuthorizationModal: false, 6    }; 7 8    /** 9     * 鉴权相关10     */11    // 授权成功事件12    authSuccessEvent() {13    }1415    // 取消授权事件16    authFailEvent() {17    }1819    async checkAuthorization() {20        // 当前是否有已验证21        let globalData = getGlobalData(STORAGE_KEY.VERIFY);22        if(globalData) {23            return {24                isNew: false,25            };26        } else {27            Taro.showLoading({28                title: '检查授权中...',29                mask: true,30                showTicketModal: false,31            });32            // 如果本地不存在时先请求接口33            // 未登录过或新机器34            // 请求token及授权状态35            let res;36            try {37                res = await Taro.login();38            } catch() {39                Toast.fail('登录失败~');40                Taro.hideLoading();41                throw new Error('Taro.login 失败');42            }43            // 请求授权接口44            const result = {};45            if(result.errno === 0) {46                resolve({47                    isNew: false,48                });49            } else {50                // 未授权过51                // 弹窗提示授权52                this.setState({53                    showAuthorizationModal: true,54                });55                this.authSuccessEvent = () => {56                    this.setState({57                        showAuthorizationModal: false,58                    });59                    resolve({60                        isNew: true,61                    });62                };63                this.authFailEvent = () => {64                    this.setState({65                        showAuthorizationModal: false,66                    });67                    reject();68                };69            }70        }71    }72}复制代码页面继承该基类1 class LaunchIndex extends BasePage {}复制代码在页面中置入组件1 {this.state.showAuthorizationModal &&2 <AuthorizationModal onSuccess={this.authSuccessEvent} onFail={this.authFailEvent}/>}3复制代码AuthorizationModal 组件接下来我们只需要在需要鉴权的操作中如下使用即可1this.checkAuthorization()2  .then((res) => {3   // 授权成功逻辑4       console.log('是否新用户', res.isNew);5   })6   .catch(() => {7    // 授权失败逻辑8    })复制代码该方案好处在于授权由状态驱动只需在代码中调用 checkAuthorization 方法即可。AuthorizationView后来由于第一种方案过于重对页面代码侵入性较强。为此我们又封装了一套较轻的组件。大部分逻辑中需要用户主动点击时才进行鉴权我们基于此思路封装了 AuthorizationView 。对外暴露 onAgree 、 onDeny 方法实现对部分区域的点击鉴权操作。代码仅供理解思路1 class AuthorizationView extends Taro.Component { 2 3  state = { 4    showLoginPanel: false, 5  }; 6 7  /** 8   * 登录 9   */10  click() {11    const { userProfile: { user, }, } = this.props;12    if(user.isCompleted) {13      this.props.onAgree(user);14    } else {15      // 显示登录框16      this.setState({17        showLoginPanel: true,18      });19    }20  }2122  /**23   * 授权登录24   * @param e25   */26  async bindGetUserInfo(e) {27    if(e.detail.errMsg === 'getUserInfo:ok') {28      const { userProfile, } = this.props;29      const userResult = await userProfile.login(true);30      this.setState({31        showLoginPanel: false,32      });33      this.props.onAgree(userResult);34    } else {35      this.props.onDeny();36    }37  }3839  cancel() {40    this.setState({41      showLoginPanel: false,42    });43  }4445  render() {46    return (47      <Block>48        <View onClick={this.click}>{this.props.children}</View>49        {50          this.state.showLoginPanel && <View className='login-panel'>51            <View className='login-panel-main'>52              <View className='login-panel-main-title'>您还未登录</View>53              <View className='login-panel-main-subtitle'>请先登录再进行操作</View>54              <Image className='login-panel-main-image' src='https://p0.ssl.qhimg.com/t01a1e495cc2be1e651.png' />55              <View className='login-panel-main-footer'>56                <View className='login-panel-main-footer-button cancel' onClick={this.cancel.bind(this)}>暂不登录</View>57                <Button className='btn-reset' openType='getUserInfo' onGetUserInfo={this.bindGetUserInfo}>58                  <View className='login-panel-main-footer-button confirm'>立即登录</View>59                </Button>60              </View>61            </View>62          </View>63        }64      </Block>65    );66  }67}6869AuthorizationView.defaultProps = {70  onAgree: () => {71  },72  onDeny: () => {73  },74};7576export default AuthorizationView;77复制代码代码中只需要使用该组件包裹子组件即可使用1 <AuthorizationView onAgree={this.onAgree.bind(this)} onDeny={this.onDeny.bind(this)}>2  <View>生成海报</View>3</AuthorizationView>4复制代码以上两种方案都有在线上业务中使用具体选型看业务决定优化及Bug追踪在维护阶段我们会更加关注于用户反馈 bug 时如何复现场景及数据分析。日志收集在小程序基础库版本 2.1.0 后微信提供了一套日志相关接口：LogManager 。在用户反馈时通过该接口记录的日志会同步上传至微信后台可下载查看追踪 Bug。我们通过简单的对其封装实现一套日志收集机制。1 const _logger = Taro.getLogManager({ level: 0, }); 2 3const Logger = { 4  debug(...args) { 5    _logger.debug(`${dayjs().format('YYYY-MM-DD HH:mm:ss')}                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w゛鸽子40                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序初实践总结                                                                       原作者: 花椒技术                   来自: 掘金                                                                                      /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "在微信小程序与小游戏中使用 LeanCloud ", "author": "                  Rolan                  2019-4-29 00:37                ", "text": "                                                                                                                                                                                     微信小程序是一个全新的跨平台移动应用平台小游戏是小程序的一个类目在小程序的基础上开放了游戏相关的 API。LeanCloud 为小程序提供一站式后端云服务为你免去服务器维护、证书配置等繁琐的工作大幅降低你的开发和运维成本。本文说明了如何在微信小程序与小游戏中使用 LeanCloud 提供的各项服务。+Demo我们在小程序上实现了 LeanTodo 应用。在这个 Demo 中你可以看到：+如何集成 LeanCloud 用户系统包括自动登录、unionid 绑定以及如何在登录后设置账号与密码以供用户在其他平台的 LeanTodo 应用上登录如何对云端数据进行查询、增加、修改与删除如何将查询结果数组绑定到视图层进行展示以及如何在点击事件中得到对应的数组项如何使用 LiveQuery 实现对查询结果的实时更新和多端同步如何集成微信支付你可以通过微信扫描以下二维码进入 Demo。 Demo 的源码与运行说明请参考 https://github.com/leancloud/leantodo-weapp。+准备工作创建应用如果你还没有创建过 LeanCloud 应用请登录 LeanCloud 控制台 创建一个新应用。如果你还没有小程序帐号请访问 微信公众平台 注册一个小程序帐号。如果你不需要进行真机调试可以跳过这一步。下载 小程序开发工具按照 小程序开发教程 创建一个项目。配置域名白名单请按照 小程序域名白名单配置 的步骤配置。如果你不需要进行真机调试可以跳过这一步（可在开发者工具的 详情 > 项目设置 中勾选不校验安全域名、TLS 版本以及 HTTPS 证书）。+安装与初始化 SDK要使用 LeanCloud 的结构化对象存储、文件存储、用户系统等功能需要使用 LeanCloud 存储 SDK。存储 SDK 的安装与初始化请请参阅《JavaScript SDK 安装指南》中对应平台的说明。+安装存储 SDK 后即可在 app.js 中初始化应用：+// 获取 AV 命名空间的方式根据不同的安装方式而异这里假设是通过手动导入文件的方式安装的 SDKconst AV = require('./libs/av-weapp-min.js');AV.init({  appId: '{{appid}}',  appKey: '{{appkey}}',}); 要使用 LeanCloud 的即时通讯服务实现聊天等功能需要使用 LeanCloud 即时通讯 SDK。即时通讯 SDK 是与存储 SDK 独立的 SDK我们在单独的 即时通讯 章节介绍其安装与初始化的步骤。+结构化对象存储所有的结构化对象存储 API 都能正常使用详细的用法请参考 JavaScript 数据存储开发指南。+数据绑定AV.Object 实例是一些携带很多信息与方法的对象而小程序的存放渲染用数据的 data 字段需要的是 JSON 类型的数据因此我们需要将 AV.Object 实例处理为 JSON 数据后再设置给 data。+以 LeanTodo Demo 中的 Todo 列表为例要实现「将 AV.Query 查询结果 Todo 列表中的 content 与 done 字段展示为列表」的功能我们可以定义一个 getDataForRender 来做上面说的「处理」：+const getDataForRender = todo => ({  content: todo.get('content'),  done: todo.get('done')});Page({  data: {    todos: []  },  onReady() {    new AV.Query('Todo')      .find()      .then(todos => this.setData({        todos: todos.map(getDataForRender)      }))      .catch(console.error);  }});AV.Object 提供了一个 #toJSON() 方法以 JSON 的形式返回其携带的有效信息。因此如果不考虑渲染性能getDataForRender 可以简化为：+const getDataForRender = todo => todo.toJSON();使用 #toJSON() 会比手动 pick 需要的数据带来更多的性能消耗。这是因为小程序的 data 在逻辑层与渲染层之间是通过序列化后的字符串格式通讯的过大的 data 结构会造成渲染耗时过久。因此对于结构复杂的 AV.Object特别是如果是一个列表手动 pick 需要的数据设置为 data 是一种常见的优化方法。+当然每次 setData 时遇到不同结构中的 AV.Object 都要进行这样的处理会让代码充斥噪音你可以使用各种技巧对此进行优化。这里分享一个 Demo 中使用的一个统一对 setData 的对象进行「处理」的 utility 方法 jsonify：+const isPlainObject = target =>  target &&  target.toString() == '[object Object]' &&  Object.getPrototypeOf(target) == Object.prototype;const _jsonify = target => {  if (target && typeof target.toJSON === 'function') return target.toJSON();  if (Array.isArray(target)) return target.map(_jsonify);  return target;};const jsonify = target =>  isPlainObject(target)    ? Object.keys(target).reduce(      (result, key) => ({        ...result,        [key]: _jsonify(target[key])      }),      {}    )    : _jsonify(target);jsonify 能正确的处理 AV.Object、AV.Object 数组以及其他类型的数据。使用时可以简单的在所有的 setData 之前对数据调用一次 jsonify 方法：+this.setData(jsonify({  todos, // AV.Object list  user, // AV.Object}));值得注意的是从 AV.Object 到 JSON 数据的处理是不可逆的如果在之后还需要用到查询结果的 AV.Object我们可以将其保存到 Page 实例上：+Page({  // todos 存放的是 AV.Object 列表后续可以这些对象进行操作（比如调用其 save 方法）不参与渲染  todos: [],  data: {    // data.todo 存放的是 JSON 数据供 WXML 页面渲染用    todos: []  },  onReady() {    new AV.Query('Todo')      .find()      .then(todos => {        this.todos = todos;        this.setData(jsonify({          todos        });      })      .catch(console.error);  },  saveAll() {    // 可以在这里获取到 this.todos 进行操作    return AV.Object.saveAll(this.todos)  }});你可能会在某些过时的文档或者 Demo 中看到直接使用 this.setData() 将 AV.Object 对象设置为当前页面的 data 的用法。我们 不再推荐这种用法。这是 SDK 针对小程序做的特殊「优化」利用了小程序渲染机制中的一个未定义行为目前已知在使用了自定义组件（usingComponents）时这种用法会失效。+文件存储在小程序中可以将用户相册或拍照得到的图片上传到 LeanCloud 服务器进行保存。首先通过 wx.chooseImage 方法选择或拍摄照片得到本地临时文件的路径然后按照下面的方法构造一个 AV.File 将其上传到 LeanCloud：+wx.chooseImage({  count: 1,  sizeType: ['original', 'compressed'],  sourceType: ['album', 'camera'],  success: function(res) {    var tempFilePath = res.tempFilePaths[0];    // 使用本地临时文件的路径构造 AV.File    new AV.File('file-name', {      blob: {        uri: tempFilePath,      },    })      // 上传      .save()      // 上传成功      .then(file => console.log(file.url()))      // 上传发生异常      .catch(console.error);  }});上传成功后可以通过 file.url() 方法得到服务端的图片 url。+关于文件存储更详细的用法请参考 JavaScript 数据存储开发指南 · 文件。+用户系统小程序中提供了登录 API 来获取微信的用户登录状态应用可以访问到用户的昵称、性别等基本信息。但是如果想要保存额外的用户信息如用户的手机号码、收货地址等或者需要在其他平台使用该用户登录则需要使用 LeanCloud 的用户系统。+一键登录LeanCloud 的用户系统支持一键使用微信用户身份登录。要使用一键登录功能需要先设置小程序的 AppID 与 AppSecret：+登录 微信公众平台在 设置 > 开发设置 中获得 AppID 与 AppSecret。前往 LeanCloud 控制台 > 组件 > 社交保存「微信小程序」的 AppID 与 AppSecret。这样你就可以在应用中使用 AV.User.loginWithWeapp() 方法来使用当前用户身份登录了。+AV.User.loginWithWeapp().then(user => {  this.globalData.user = user;}).catch(console.error);使用一键登录方式登录时LeanCloud 会将该用户的小程序 openid 与 session_key 等信息保存在对应的 user.authData.lc_weapp 属性中你可以在控制台的 _User 表中看到：+{  \"authData\": {    \"lc_weapp\": {      \"session_key\": \"2zIDoEEUhkb0B5pUTzsLVg==\",      \"expires_in\": 7200,      \"openid\": \"obznq0GuHPxdRYaaDkPOHk785DuA\"    }  }}如果用户是第一次使用此应用调用登录 API 会创建一个新的用户你可以在 控制台 > 存储 中的 _User 表中看到该用户的信息如果用户曾经使用该方式登录过此应用（存在对应 openid 的用户）再次调用登录 API 会返回同一个用户。+用户的登录状态会保存在客户端中可以使用 AV.User.current() 方法来获取当前登录的用户下面的例子展示了如何为登录用户保存额外的信息：+// 假设已经通过 AV.User.loginWithWeapp() 登录// 获得当前登录用户const user = AV.User.current();// 调用小程序 API得到用户信息wx.getUserInfo({  success: ({userInfo}) => {    // 更新当前用户的信息    user.set(userInfo).save().then(user => {      // 成功此时可在控制台中看到更新后的用户信息      this.globalData.user = user;    }).catch(console.error);  }});authData 默认只有对应用户可见开发者可以使用 masterKey 在云引擎中获取该用户的 openid 与 session_key 进行支付、推送等操作。详情的示例请参考 支付。+小程序的登录态（session_key）存在有效期可以通过 wx.checkSession() 方法检测当前用户登录态是否有效失效后可以通过调用 AV.User.loginWithWeapp() 重新登录。+使用 unionid微信开放平台使用 unionid 来区分用户的唯一性也就是说同一个微信开放平台帐号下的移动应用、网站应用和公众帐号（包括小程序）用户的 unionid 都是同一个而 openid 会是多个。如果你想要实现多个小程序之间或者小程序与使用微信开放平台登录的应用之间共享用户系统的话则需要使用 unionid 登录。+要在小程序中使用 unionid 登录请先确认已经在 微信开放平台 绑定了该小程序+在小程序中有很多途径可以 获取到 unionid。不同的 unionid 获取方式接入 LeanCloud 用户系统的方式也有所不同。+一键登录时静默获取 unionid当满足以下条件时一键登录 API AV.User.loginWithWeapp() 能静默地获取到用户的 unionid 并用 unionid + openid 进行匹配登录。+微信开放平台帐号下存在同主体的公众号并且该用户已经关注了该公众号。微信开放平台帐号下存在同主体的公众号或移动应用并且该用户已经授权登录过该公众号或移动应用。要启用这种方式需要在一键登录时指定参数 preferUnionId 为 true：+AV.User.loginWithWeapp({  preferUnionId: true,});使用 unionid 登录后用户的 authData 中会增加 _weixin_unionid 一项（与 lc_weapp 平级）：+{  \"authData\": {    \"lc_weapp\": {      \"session_key\": \"2zIDoEEUhkb0B5pUTzsLVg==\",      \"expires_in\": 7200,      \"openid\": \"obznq0GuHPxdRYaaDkPOHk785DuA\",      \"unionid\": \"ox7NLs5BlEqPS4glxqhn5kkO0UUo\"    },    \"_weixin_unionid\": {      \"uid\": \"ox7NLs5BlEqPS4glxqhn5kkO0UUo\"    }  }}用 unionid + openid 登录时会按照下面的步骤进行用户匹配：+如果已经存在对应 unionid（authData._weixin_unionid.uid）的用户则会直接作为这个用户登录并将所有信息（openid、session_key、unionid 等）更新到该用户的 authData.lc_ewapp 中。如果不存在匹配 unionid 的用户但存在匹配 openid（authData.lc_weapp.openid）的用户则会直接作为这个用户登录并将所有信息（session_key、unionid 等）更新到该用户的 authData.lc_ewapp 中同时将 unionid 保存到 authData._weixin_unionid.uid 中。如果不存在匹配 unionid 的用户也不存在匹配 openid 的用户则创建一个新用户将所有信息（session_key、unionid 等）更新到该用户的 authData.lc_ewapp 中同时将 unionid 保存到 authData._weixin_unionid.uid 中。不管匹配的过程是如何的最终登录用户的 authData 都会是上面这种结构。+LeanTodo Demo 便是使用这种方式登录的如果你已经关注了其关联的公众号（搜索 AVOSCloud或通过小程序关于页面的相关公众号链接访问）那么你在登录后会在 LeanTodo Demo 的 设置 - 用户 页面看到当前用户的 authData 中已经绑定了 unionid。+需要注意的是：+如果用户不符合上述静默获取 unionid 的条件那么就算指定了 preferUnionId 也不会使用 unionid 登录。如果用户符合上述静默获取 unionid 的条件但没有指定 preferUnionId那么该次登录不会使用 unionid 登录但仍然会将获取到的 unionid 作为一般字段写入该用户的 authData.lc_weapp 中。此时用户的 authData 会是这样的：+{  \"authData\": {    \"lc_weapp\": {      \"session_key\": \"2zIDoEEUhkb0B5pUTzsLVg==\",      \"expires_in\": 7200,      \"openid\": \"obznq0GuHPxdRYaaDkPOHk785DuA\",      \"unionid\": \"ox7NLs5BlEqPS4glxqhn5kkO0UUo\"    }  }}通过其他方式获取 unionid 后登录如果开发者自行获得了用户的 unionid（例如通过解密 wx.getUserInfo 获取到的用户信息）可以在小程序中调用 AV.User.loginWithWeappWithUnionId() 投入 unionid 完成登录授权：+AV.User.loginWithWeappWithUnionId(unionid, {  asMainAccount: true}).then(console.log, console.error);通过其他方式获取 unionid 与 openid 后登录如果开发者希望更灵活的控制小程序的登录流程也可以自行在服务端实现 unionid 与 openid 的获取然后调用通用的第三方 unionid 登录接口指定平台为 lc_weapp 来登录：+const unionid = '';const authData = {  openid: '',  session_key: ''};const platform = 'lc_weapp';AV.User.loginWithAuthDataAndUnionId(authData, platform, unionid, {  asMainAccount: true}).then(console.log, console.error);相对上面提到的一些 Weapp 相关的登录 APIloginWithAuthDataAndUnionId 是更加底层的第三方登录接口不依赖小程序运行环境因此这种方式也提供了更高的灵活度：+可以在服务端获取到 unionid 与 openid 等信息后返回给小程序客户端在客户端调用 AV.User.loginWithAuthDataAndUnionId 来登录。也可以在服务端获取到 unionid 与 openid 等信息后直接调用 AV.User.loginWithAuthDataAndUnionId 登录成功后得到登录用户的 sessionToken 后返回给客户端客户端再使用该 sessionToken 直接登录。关联第二个小程序这种用法的另一种常见场景是关联同一个开发者帐号下的第二个小程序。+因为一个 LeanCloud 应用默认关联一个微信小程序（对应的平台名称是 lc_weapp）使用小程序系列 API 的时候也都是默认关联到 authData.lc_weapp 字段上。如果想要接入第二个小程序则需要自行获取到 unionid 与 openid然后将其作为一个新的第三方平台登录。这里同样需要用到 AV.User.loginWithAuthDataAndUnionId 方法但与关联内置的小程序平台（lc_weapp）有一些不同：+需要指定一个新的 platform需要将 openid 保存为 uid（内置的微信平台做了特殊处理可以直接用 openid 而这里是作为通用第三方 OAuth 平台保存因此需要使用标准的 uid 字段）。这里我们以新的平台 weapp2 为例：+const unionid = '';const openid = '';const authData = {  uid: openid,  session_key: ''};const platform = 'weapp2';AV.User.loginWithAuthDataAndUnionId(authData, platform, unionid, {  asMainAccount: true}).then(console.log, console.error);获取 unionid 后与现有用户关联如果一个用户已经登录现在通过某种方式获取到了其 unionid（一个常见的使用场景是用户完成了支付操作后在服务端通过 getPaidUnionId 得到了 unionid）希望与之关联可以在小程序中使用 AV.User#associateWithWeappWithUnionId()：+const user = AV.User.current(); // 获取当前登录用户user.associateWithWeappWithUnionId(unionid, {  asMainAccount: true}).then(console.log, console.error);启用其他登录方式上述的登录 API 对接的是小程序的用户系统所以使用这些 API 创建的用户无法直接在小程序之外的平台上登录。如果需要使用 LeanCloud 用户系统提供的其他登录方式如用手机号验证码登录、邮箱密码登录等在小程序登录后设置对应的用户属性即可：+// 小程序登录AV.User.loginWithWeapp().then(user => {  // 设置并保存手机号  user.setMobilePhoneNumber('13000000000');  return user.save();}).then(user => {  // 发送验证短信  return AV.User.requestMobilePhoneVerify(user.getMobilePhoneNumber());}).then({  // 用户填写收到短信验证码后再调用 AV.User.verifyMobilePhone(code) 完成手机号的绑定  // 成功后用户的 mobilePhoneVerified 字段会被置为 true  // 此后用户便可以使用手机号加动态验证码登录了}).catch(console.error);验证手机号码功能要求在 控制台 > 存储 > 设置 > 用户账号 启用「用户注册时向注册手机号码发送验证短信」。+绑定现有用户如果你的应用已经在使用 LeanCloud 的用户系统或者用户已经通过其他方式注册了你的应用（比如在 Web 端通过用户名密码注册）可以通过在小程序中调用 AV.User#associateWithWeapp() 来关联已有的账户：+// 首先使用用户名与密码登录一个已经存在的用户AV.User.logIn('username', 'password').then(user => {  // 将当前的微信用户与当前登录用户关联  return user.associateWithWeapp();}).catch(console.error);即时通讯要使用 LeanCloud 的即时通讯服务实现聊天等功能需要使用 LeanCloud 即时通讯 SDK。+安装与初始化请参阅《JavaScript SDK 安装指南》中对应平台的说明。+安装 SDK 后即可在 app.js 中初始化应用：+// Realtime 类获取的方式根据不同的安装方式而异这里假设是通过手动导入文件的方式安装的 SDKconst { Realtime } = require('./libs/realtime.weapp.min.js');const realtime = new Realtime({  appId: '{{appid}}',  appKey: '{{appkey}}',}); 需要特别注意的是小程序对 WebSocket 连接的数量是有限制的因此推荐的用法是初始化 Realtime 一次挂载到全局的 App 实例上然后在所有需要的时候都使用这个 Realtime 实例。+// app.jsconst { Realtime } = require('./libs/realtime.weapp.min.js');const realtime = new Realtime({  appId: '{{appid}}',  appKey: '{{appkey}}',});App({  realtime: realtime,  // ...});// some-page.jsconst realtime = getApp().realtime; 即时通讯 SDK 的详细用法请参考 即时通讯开发指南。+富媒体消息要在小程序中使用即时通讯 SDK 的富媒体消息插件有一些额外的约束：+安装存储 SDK 至 libs 目录并将文件重命名为 leancloud-storage.js。安装即时通讯 SDK 至 libs 目录并将文件重命名为 leancloud-realtime.js。下载 leancloud-realtime-plugin-typed-messages.js移动到 libs 目录。必须保证三个文件在同一目录中。在 app.js 中依次加载 leancloud-storage.js、leancloud-realtime.js 和 leancloud-realtime-plugin-typed-messages.js。const AV = require('./libs/leancloud-storage.js');const Realtime = require('./libs/leancloud-realtime.js').Realtime;const TypedMessagesPlugin = require('./libs/leancloud-realtime-plugin-typed-messages.js').TypedMessagesPlugin;const ImageMessage = require('./libs/leancloud-realtime-plugin-typed-messages.js').ImageMessage;在 app.js 中初始化应用：// 初始化存储 SDKAV.init({ appId: '{{appid}}', appKey: '{{appkey}}',});// 初始化即时通讯 SDKconst realtime = new Realtime({ appId: '{{appid}}', appKey: '{{appkey}}', plugins: [TypedMessagesPlugin], // 注册富媒体消息插件}); 富媒体消息的用法请参考 即时通讯开发指南 - 富媒体消息。+数据绑定使用即时通讯 SDK一个常见的需求是将 Conversation 与 Message 类型的数据绑定到视图层进行渲染。这里会遇到一些与结构化数据存储 SDK 一样的问题其解决方案与最佳实践请参考结构化数据存储的 数据绑定 章节（Conversation 与 Message 都实现了 #toJSON 方法上文中介绍的 jsonify 方法同样适用于Conversation 与 Message 实例）。+支付配置在开始之前请确保已经在微信小程序后台开启了「微信支付」功能然后按照下面的步骤配置云引擎环境变量：2进入应用控制台 - 云引擎 - 设置设置应用的二级域名并保存添加并保存以下环境变量WEIXIN_APPID：小程序 AppIdWEIXIN_MCHID：微信支付商户号WEIXIN_PAY_SECRET：微信支付 API 密钥（微信商户平台 - 账户设置 - API安全 - 密钥设置）WEIXIN_NOTIFY_URL：https://.leanapp.cn/weixin/pay-callback其中 yourdomain 是第二步中设置的二级域名查看示例服务端开发首先确认本机已经安装 Node.js 运行环境和 LeanCloud 命令行工具然后执行下列指令下载示例项目：+$ git clone https://github.com/leancloud/weapp-pay-getting-started.git$ cd weapp-pay-getting-started安装依赖：+npm install登录并关联应用：+lean loginlean switch启动项目：+lean up之后你就可以在 localhost:3001 调试云函数了。+示例项目中与支付直接相关代码有三部分：+order.js：对应 Order 表定义了部分字段的 getter/setter以及 place 方法用于向微信 API 提交订单。cloud.js：其中定义了名为 order 的云函数这个云函数会获取当前用户的 openid以其身份创建了一个 1 分钱的 order 并下单最后返回签名过的订单信息。routers/weixin.js：其中定义了 pay-callback 的处理函数当用户支付成功后微信调用这个 URL这个函数将对应的订单状态更新为 SUCCESS。请根据你的业务需要修改代码。参考文档：+微信支付统一下单 API 参数与错误码微信支付结果通知参数完成开发后部署到预备环境（若无预备环境则直接部署到生产环境）：+lean deploy客户端开发客户端完成一次支付需要分两步：+用户登录后调用名为 order 的云函数下单返回签名过的订单信息。调用支付 API（wx.requestPayment）传入上一步返回的订单信息发起支付。AV.Cloud.run('order').then((data) => {  data.success = () => {    // 支付成功  });  data.fail = ({ errMsg }) => {    // 错误处理  });  wx.requestPayment(data);}).catch(error => {  // 错误处理})客户端的示例代码参见 Demo 打赏功能。参考文档：2小程序客户端发起支付 APIFAQ配置 download 合法域名时显示「该域名因违规被禁止设置。」请前往 控制台 > 存储 > 设置 > 文件 配置你自己的文件域名。+Access denied by api domain white list如果你的应用启用并配置了 Web 安全域名你可能会 catch 到 Access denied by api domain white list 异常请将提示的域名添加至应用的 Web 安全域名列表。+小程序真机上传数据时控制台存储中显示的 Class 表名被压缩为单个字母。例如新建一个名为「Todo」的表上传数据成功后进入控制台查看其表名称显示为像 i、u 这样的单个字母。这是因为真机上代码会被压缩解决办法是在创建 Class 后向 SDK 注册该 Class 的名字：AV.Object.register(Todo, 'Todo');。+反馈如果在微信小程序中使用 LeanCloud 时遇到问题欢迎通过我们的 论坛 进行反馈。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序之自定义倒计时组件               手把手教你写一个微信小程序日历组件                                                        原作者: leancloud                   来自: leancloud                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "实战分享: 小程序云开发玩转订阅消息 ", "author": "                  Rolan                  2019-10-24 00:15                ", "text": "                                                                                                                                                                                     微信官方为提升小程序模板消息能力的使用体验对模板消息的下发条件进行了调整。原有的小程序模板消息接口于 2020 年 1 月 10 日下线届时将无法使用旧的小程序模板消息接口发送模板消息取而代之的是新的一次性订阅消息和长期订阅消息。订阅消息给小程序开发者带来了更好的触达用户的能力在具体实施过程中开发者如何把模板消息换成新的订阅消息是否需要购买服务器来实现服务器鉴权怎样才能在用户订阅之后一段时间后给用户发送长期或一次性订阅消息呢？小程序·云开发最近支持了通过云调用免 access_token 发送订阅消息还新增支持了在定时触发器中实现云调用这些能力可以帮助开发者轻松玩转小程序订阅消息。我们今天会利用小程序·云开发进行一个小程序中实现订阅开课提醒的实战帮助大家了解如何基于小程序·云开发快速接入小程序订阅消息。整体时序图环境准备注册小程序帐号开通云开发服务获取订阅消息模板 ID在微信小程序管理后台中新增一个订阅消息的模板这里我们新增了一个开课提醒的模板。引导用户订阅微信小程序提供了wx.requestSubscribeMessage 接口来发起申请订阅权限界面。在 \"订阅开课提醒\" 的按钮上绑定 tap 事件事件处理器我们这里用的 onSubscribeindex.wxml<button  class=\"btn\"  data-item=\"{{ item }}\"  bindtap=\"onSubscribe\"  hover-class=\"btn-hover\">  订阅开课提醒</button>复制代码在 onSubscribe 函数内我们会调用微信 API wx.requestSubscribeMessage 申请发送订阅消息权限当用户在弹窗同意订阅之后我们会收到 success 回调将订阅的课程信息调用云函数 subscribe 存入云开发数据库云函数 subscribe 的实现在下文会讲。index.jsonSubscribe: function(e) {    // 获取课程信息    const item = e.currentTarget.dataset.item;    // 调用微信 API 申请发送订阅消息    wx.requestSubscribeMessage({      // 传入订阅消息的模板id模板 id 可在小程序管理后台申请      tmplIds: [lessonTmplId],      success(res) {        // 申请订阅成功        if (res.errMsg === 'requestSubscribeMessage:ok') {          // 这里将订阅的课程信息调用云函数存入云开发数据          wx.cloud            .callFunction({              name: 'subscribe',              data: {                data: item,                templateId: lessonTmplId,              },            })            .then(() => {              wx.showToast({                title: '订阅成功',                icon: 'success',                duration: 2000,              });            })            .catch(() => {              wx.showToast({                title: '订阅失败',                icon: 'success',                duration: 2000,              });            });        }      },    });  },复制代码将订阅消息存入云开发数据库接下来我们创建一个云函数 subscribe 这个云函数的作用是将用户的订阅信息存入云开发数据库的集合 messages 中等待将来需要通知用户时进行调用。在微信开发者工具的云开发面板中创建数据库集合 messages创建一个 subscribe 云函数在云函数中我们将小程序端发送过来的课程订阅信息存储在云开发数据库集合中开发完成后在微信开发者工具中右键上传并部署云函数。cloudfunctions/subscribe/index.jsconst cloud = require('wx-server-sdk');cloud.init();const db = cloud.database();exports.main = async (event, context) => {  try {    const {OPENID} = cloud.getWXContext();    // 在云开发数据库中存储用户订阅的课程    const result = await db.collection('messages').add({      data: {        touser: OPENID, // 订阅者的openid        page: 'index', // 订阅消息卡片点击后会打开小程序的哪个页面        data: event.data, // 订阅消息的数据        templateId: event.templateId, // 订阅消息模板ID        done: false, // 消息发送状态设置为 false      },    });    return result;  } catch (err) {    console.log(err);    return err;  }};复制代码利用定时触发器来定期发送订阅消息接下来我们需要实现一个定时执行的云函数send来检查数据库中是否有需要发送给用户的订阅消息。如果有需要发送的订阅消息会通过云调用 cloud.openapi.subscribeMessage.send 将订阅消息发送给用户。创建一个名叫 send 的云函数首先要配置云函数在 config.json 的 permissions 中新增 subscribeMessage.send的云调用权限然后新增一个 sendMessagerTimer 的定时触发器定时触发器的语法和 linux 的 crontab 类似比如我们配置的 \"0 * * * * * *\" 代表每分钟执行一次云函数。cloudfunctions/send/config.json{  \"permissions\": {    \"openapi\": [\"subscribeMessage.send\"]  },  \"triggers\": [    {      \"name\": \"sendMessagerTimer\",      \"type\": \"timer\",      \"config\": \"0 * * * * * *\"    }  ]}复制代码接下来是实现发送订阅消息的云函数这个云函数会从云开发数据库集合messages中查询等待发送的消息列表检查数据库中是否有需要发送给用户的订阅消息发送条件可以根据自己的业务实现比如开课提醒可以根据课程开课日期来检查是否需要发送订阅消息在我们下面的代码示例里做了简化筛选条件只检查了状态为未发送。查询到待发送的消息列表之后我们会循环消息列表依次发送每条订阅消息发送成功后将数据库中消息的状态改为已发送。cloudfunctions/send/index.jsconst cloud = require('wx-server-sdk');exports.main = async (event, context) => {  cloud.init();  const db = cloud.database();  try {    // 从云开发数据库中查询等待发送的消息列表    const messages = await db      .collection('messages')      // 查询条件这里做了简化只查找了状态为未发送的消息      // 在真正的生产环境可以根据开课日期等条件筛选应该发送哪些消息      .where({        done: false,      })      .get();    // 循环消息列表    const sendPromises = messages.data.map(async message => {      try {        // 发送订阅消息        await cloud.openapi.subscribeMessage.send({          touser: message.touser,          page: message.page,          data: message.data,          templateId: message.templateId,        });        // 发送成功后将消息的状态改为已发送        return db          .collection('messages')          .doc(message._id)          .update({            data: {              done: true,            },          });      } catch (e) {        return e;      }    });    return Promise.all(sendPromises);  } catch (err) {    console.log(err);    return err;  }};复制代码最终效果源代码github.com/binggg/tcb-…关于我binggg(Booker Zhao) @腾讯- 先后就职于迅雷、腾讯等个人开源项目有 mrn.js 等- 创办了迅雷内部组件仓库 XNPM 参与几个迅雷前端开源项目的开发- 热衷于优化和提效是一个奉行“懒惰使人进步”的懒人工程师复制代码社交资料                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序技能进阶回忆录 - 如何自主实现拦截器               小程序技能进阶回忆录 - globalData 的那些事儿                                                        原作者: binggg                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序长按保存图片 ", "author": "                  Rolan                  2020-1-2 00:43                ", "text": "                                                                                                                                                                                     微信浏览器打开h5页面如果是img标签的话长按会弹出保存图片的选项。但是微信小程序里面不可以需要自己写这个功能。这个功能有两个点一个是长按一个是保存图片到本地。1. 微信小程序关于图片长按的解释有两种：因此我们选用 bindlongpress 事件2. 微信小程序同样提供了保存图片的接口是wx.saveImageToPhotosAlbum()3. 值得说的是保存的接口两个需要注意的地方：1、需要先授权调用 wx.getSetting()方法2、保存的图片路径参数不支持网络路径而在我们渲染页面时用到的图片有很大可能是网络路径这时候我们需要先把网络路径转为可用的本地路径wx.getImageInfo()方法可以满足需要4. 最后再走个心吧毕竟我这么可爱1、长按后直接保存未免潦草了些考虑到用户体验加入 wx.showActionSheet()2、如果用户拒绝授权 或者 以前拒绝过授权这时候也应该给他提示或者展示再次打开授权的入口将将！然后就可以开始写代码了：<image src=\"{{url}}\" data-url=\"{{url}}\" bindlongpress=\"saveImage\"></image>// 长按保存功能--授权部分saveImage (e) {    let _this = this    wx.showActionSheet({        itemList: ['保存到相册'],        success(res) {            let url = e.currentTarget.dataset.url;            wx.getSetting({                success: (res) => {                    if (!res.authSetting['scope.writePhotosAlbum']) {                        wx.authorize({                            scope: 'scope.writePhotosAlbum',                            success: () => {                                // 同意授权                                _this.saveImgInner(url);                            },                            fail: (res) => {                                console.log(res);                                wx.showModal({                                    title: '保存失败',                                    content: '请开启访问手机相册权限',                                    success(res) {                                        wx.openSetting()                                    }                                })                            }                        })                    } else {                        // 已经授权了                        _this.saveImgInner(url);                    }                },                fail: (res) => {                    console.log(res);                }            })           },        fail(res) {            console.log(res.errMsg)        }    })},// 长按保存功能--保存部分saveImgInner (url) {    wx.getImageInfo({        src: url,        success: (res) => {            let path = res.path;            wx.saveImageToPhotosAlbum({                filePath: path,                success: (res) => {                    console.log(res);                    wx.showToast({                        title: '已保存到相册',                    })                },                fail: (res) => {                    console.log(res);                }            })        },        fail: (res) => {            console.log(res);        }    })},文章写的比较正序参考的是这篇倒序文章喜欢倒序的筒子们可以去看下这篇： https://www.jianshu.com/p/e59...（虽然很痛恨没有视频效果的文章可是录好了视频的我 实在找不到上传视频的按钮！我好难！！！）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序canvas生成海报 文字自动换行 canvas高度动态设置               微信小程序 接入 腾讯云验证码                                                        原作者:  smile1213                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "简单说说微信小程序的底层原理 ", "author": "                  Rolan                  2019-11-19 00:12                ", "text": "                                                                                                                                                                                     小程序选择了 Hybrid 的渲染方式将UI渲染跟 JavaScript 的脚本执行分在了两个线程。双线程模型小程序的渲染层和逻辑层分别由两个线程管理：渲染层：界面渲染相关的任务全都在\tWebView 线程里执行。一个小程序存在多个界面所以渲染层存在多个\tWebView 线程。逻辑层：采用\tJsCore 线程运行JS脚本在这个环境下执行的都是有关小程序业务逻辑的代码。双线程之间的通信我们都知道小程序是避免DOM操作而是采用数据驱动来渲染页面的那么他到底是怎么通过更改数据来更新DOM呢。逻辑层和渲染层的通信会由 Native （微信客户端）做中转逻辑层发送网络请求也经由 Native 转发。通过把 WXML 转化为数据通过 Native 进行转发来实现逻辑层和渲染层的交互和通信。在渲染层会把WNML转化成Js对象Js对象会模拟DOM树逻辑层更新数据的时候通过setData方法将数据从逻辑层转发到Native,Native再转发到渲染层这时候比较两虚拟DOM树的差异最后将差异应用到真实DOM树上更新页面。Virtual DOM 相信大家都已有了解大概是这么个过程：用JS对象模拟DOM树 -> 比较两棵虚拟DOM树的差异 -> 把差异应用到真正的DOM树上。小程序的生命周期小程序的生命周期借鉴了Android的生命周期如果你了解过Android的APP开发那么理解小程序的就会很简单。界面线程有四大状态：初始化状态：初始化界面线程所需要的工作包括工作机制基本和我们开发者没有关系等初始化完毕就向“服务线程”发送初始化完毕信号然后进入等待传回初始化数据状态。首次渲染状态：收到“服务线程”发来的初始化数据后（就是 json和js中的data数据）就开始渲染小程序界面渲染完毕后发送“首次渲染完毕信号”给服务线程并将页面展示给用户。持续渲染状态：此时界面线程继续一直等待“服务线程”通过this.setdata（）函数发送来的界面数据只要收到就重新局部渲染也因此只要更新数据并发送信号界面就自动更新。结束状态：结束渲染。服务线程五大状态：初始化状态：无需和其他模块交流跟小程序开发也没多大关联此阶段就是启动服务线程所需的基本功能比如信号发送模块。系统的初始化工作完毕就调用自定义的onload和onshow 然后等待界面线程的“界面线程初始化完成”信号。onload是只会首次渲染的时候执行一次onshow是每次界面切换都会执行简单理解这就是唯一差别。等待激活状态：接收到“界面线程初始化完成”信号后将初始化数据发送给“界面线程”等待界面线程完成初次渲染。激活状态：收到界面线程发送来的“首次渲染完成”信号后就进入激活状态既程序的正常运行状态并调用自定义的onReady()函数。此状态下就可以通过 this.setData 函数发送界面数据给界面线程进行局部渲染更新页面。后台运行状态：如果界面进入后台服务线程就进入后台运行状态从目前的官方解读来说这个状态挺奇怪的和激活状态是相同的也可以通过setdata函数更新界面的。毕竟小程序的框架刚推出应该后续会有很大不同吧。运行机制启动热启动：假如用户已经打开过某小程序然后在一定时间内再次打开该小程序此时无需重新启动只需将后台态的小程序切换到前台这个过程就是热启动；冷启动：用户首次打开或小程序被微信主动销毁后再次打开的情况此时小程序需要重新加载启动即冷启动。销毁只有当小程序进入后台一定时间或者系统资源占用过高才会被真正的销毁。更新机制开发者在后台发布新版本之后无法立刻影响到所有现网用户但最差情况下也在发布之后 24 小时之内下发新版本信息到用户。小程序每次冷启动时都会检查是否有更新版本如果发现有新版本将会异步下载新版本的代码包并同时用客户端本地的包进行启动即新版本的小程序需要等下一次冷启动才会应用上。所以如果想让用户使用最新版本的小程序可以利用\twx.getUpdateManager 做个检查更新的功能。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    云开发如何实现管理员通知消息               使用Taro小程序框架开发一个学习做题聊天交流的微信小程序                                                        原作者:  HeyWyy                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序框架原理综合分析和 fard 的新思路 ", "author": "                  Rolan                  2019-6-24 00:07                ", "text": "                                                                                                                                                                                     halo大家好我是 132 好久不贱~今天给大家带来的是一个 fre 转小程序的新框架叫 fard它使用了非常精彩的思路将 fre 代码跑到小程序环境里背景当下国内前端环境中几乎每一个框架作者最终都会研究小程序如 nerv 和 taroanu 和 nanachi加上前阵子某人发微博说出 “hooks 无法用于别处想用就得重新实现” 这种膝盖言论我急迫的想要给 fre 一个归宿寻找适用于 fre 的小程序方案现有方案在做 fard 之前我看了几乎所有的小程序框架以下：编译型封装型tarowepynanachimpxmpvueuniappchameleon以上列举的只是常见的还有很多小众的没有写出小程序框架比小程序还多::>_<::编译型对于编译型框架基本上就是 AST 转译写 react/vue 的语法编译出小程序的语法这样做的好处是理论上无所不能啥都能转甚至使用 parcel 的策略能让编译速度很快但是致命缺陷是全程写的不是真的 reactreact 内部的遍历过程根本没走而且还需要制定足够严格的语法约定我认为这个方向是走投无路的方向封装型封装型框架基本就是对小程序的 API 进行封装使其长得像 vue优点是能够最大程度的接近原生缺点是没有足够的抽象层无法跨端跨端了解完两种类型的框架我们来探讨一下“跨端”跨端一直是很多人乐此不疲的事情跨端的关键点在于寻找一个【抽象中间层】比如 taro 等使用 AST 作为抽象中间层flutter 使用各个端都支持的渲染引擎作为抽象中间层RN 自己搞了个 bridge把桥作为抽象中间层weex 利用 v8 搞了个 runtime 作为抽象中间层(以上仅仅是举例不要深究他们的原理)所以fard 只需要寻找一个中间层就完事了Fard 原理好吧通篇就这段是重点 ::>_<::首先fard 是 fre 转小程序的框架fre 是 react like 框架它包含了整个 reconcilerreconciler 全程都是 js 的遍历行为能够跑在任何 js 环境中小程序也不例外所以最终 fard 的方案就和 RN 类似在小程序端跑 fre reconciler 过程跑完再通过某个【桥】反馈给小程序视图好吧上图如图首先在小程序里跑 fre reconciler 的所有逻辑hooks 就位于这个阶段所以 hooks 所有逻辑都是在 fre 中跑完的跑完后就好说了我们拿到了一个 vdom (也可以说 fiber但是我们只需要子集 vdom )拿到这个 vdom 后就去 setData附加给 Page好的到这里可以说全程 js 逻辑该拿到的都拿到了就差怎么反馈给视图了小程序自身也是 vdom 机制的如果说它默认提供 vdom 的接口的话我们直接将 vdom 附加过去即可但是并没有小程序开放的唯一的修改视图的方法就是 template所以我们需要根据 vdom 改造 template使其成为桥梁这个也非常简单比如 vdom 长这个样子：let vdom = {    name:'@2',    type:'view',    children:[        {            name:'@1',            type:'text'        }    ]}复制代码我们完全可以通过 template 模拟出来<template is=\"@2\">    <view>        <block wx:for=\"{{props.children}}\" wx:key=\"\">            <template is=\"{{item.name}}\"></template>      </block>    </view></template><template is=\"@1\">    <text></text></template>复制代码我们可以通过 template 模拟出整个 vdom很好bridge 就这么搞定了其实到这里fard 就搞定了剩下的就是增加更多的 case封装更多的通用 API提高性能了综合分析我们看到 fard 是类似 RN 的原理我们高度抽象 fre 的 reconciler 层和小程序的 template bridge使得整个设计非常的简单却精彩而且它能够完美的支持 jsx 和 hooks API不存在任何约定任何限制任何规范毕竟这才是 jsx 真正的意义同样的hooks API 自出现以来关于它内部的黑魔法也一直令人津津乐道我用实际行动证明hooks API 完全可以用到任何端也包括 webgl前提是要有设计精巧的抽象中间层                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    基于Proxy的小程序状态管理               小程序生成海报代码分享                                                        原作者:  132                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "开始你的uniapp之旅:写出你的第一个微信小程序 ", "author": "                  Rolan                  2019-11-18 00:07                ", "text": "                                                                                                                                                                                     uni-app 是一个使用 Vue.js 开发所有前端应用的框架开发者编写一套代码可发布到iOS、Android、H5、以及各种小程序（微信/支付宝/百度/头条/QQ/钉钉）等多个平台。引用官方介绍 , 为什么它可以做到这点 ? uniapp 内置了 Vue.js 如果你熟悉 Vue.js ,  就知道 Vue 的核心只是完成的只是在数据变更后 , 自动帮你把用到这个数据的 \" 对象 \" 中的数据进行更新 , 在浏览器器上它对应着浏览器 dom , 在不同的平台上它可以对应不同的东西 , 这就赋予了 Vue.js 的跨平台能力刚刚说的\"对象\"并不是 Javascript 中 的 Object , 理解成 面向对象编程中的对象更为合适 , 无论它是虚拟的还是现实中的东西 , 它都可以被描述为对象 . 你可以想象吗, 有人已经把 Vue 移植到了带有显示屏的底层硬件上 , 每当 Vue 代码中的数据更新时 , 显示屏上的数据也会被通知更新 .你知道这点就行了 : uniapp 编译时 , 把 Vue template中的基础组件对应不同平台上的基础组件 ,完成了跨平台的工作 .uniapp 跨平台是不是很多坑?你一定会怀疑 unipp 的能力 . 是的 , 必然是有坑的 . 但是坑的层面不是数据层面 , Javascript引擎在不同平台上的解析都是符合规范的  ,一般是 css 样式 或者 api 层面的 , 每个平台对 css和api 的支持不同 ,这个必须你自己去做兼容 , 再好的编译也不可能完全消除原生上带来的差距 . 因此 , 它的坑并不是因为自身的原因 , 而是你对这个平台本身不是很了解 , 写出了不兼容的代码 .如果你不考虑兼容的话 , 我可以说它写小程序是没有坑的 . 你最后写起来会感觉跟小程序差不多 , 但是写起来更爽 .为什么我一定推荐你用 uniapp 写微信小程序?微信小程序用它的语法写不好吗 ? 为什么一定要用 uniapp 呢 . uniapp有几大优势微信的所有api都可以用Vue 的几乎所有语法的支持内置 Vuex 和 Vue-router可以用浏览器调试其他类似于css动画 , vue单文件的优势就不一一说了 .  加粗的每一点都值得你去使用 uniapp .第一点:用 Vue 来写程序 , 你的 Vue 水平和了解程度也会上升不少 , 将来写网页或者其他东西时候 , 用 Vue 也是胸有成竹 .第二点: 微信小程序没有内置 类似 Vuex 的功能 , 导致跨页面 , 跨多级组件的共享数据会非常麻烦 .第三点: 如果你调试过微信小程序就知道 , 每次修改完后编译是多慢 ,展开 dom 是多么麻烦 , 查看数据只能一个 console.log 或者 debugger 来调试 . 但是用 chrome来调试就完全不同了 , 它编译很快 , 可以用 Vue 官方插件 dev-tool 来 查看 v-node 树 , 数据状态和 Vuex , 这个真的是在开发体验和效率上是**降维打击 . **版本较新的浏览器对 css 的支持是一个超集 , 在小程序中的能使用的样式在 chrome 完全兼容, 调试效率也会高一些 , 不过自定义组件要注意一下 , 它的宽高只能由内部撑起 .uniapp 来写小程序有没有缺点呢?有 .微信限制小程序包的大小为 2mb , 但是 uniapp 编译的小程序因为自带 Vue Vuex 等原因 , 会稍稍多几十kb不过不是特别大的问题 . 2. 首次渲染页面速度不如小程序 . 毕竟是要多一层 Vue 的传递所以, 首次加载不如原生 .但是后续的数值更新 , 特别是大量数据的更新 , 因为 Vue 中有 diff 算法使渲染的效率大大提升 .开启 uniapp 的学习第一步:首先下载安装 hbuiderx(标准版) 和 微信开发者工具第二步: hbuilderx 安装完后安装 uniapp 插件 , 其他的插件 比如 scss 编译 等等也可以安装一下 , 全装也没问题哈第三步:微信开发者工具和 uniapp 都安装完后打开微信开发者工具 , 登录账号等等操作设置服务端口 , 先打开你的微信开发者工具 -> 上栏 -> 设置 -> 安全设置 -> 服务端口 -> 开启接着 hbuilderx导航栏 工具 -> 设置 -> 源码视图 这里可以看到右边有设置的json 找到最后一行-> \"weApp.devTools.path\":\"\" 这里填上微信开发者工具的绝对路径 比如我的 : \"weApp.devTools.path\":\"E:/微信web开发者工具\"第四步:两个都设置完后 , hbuilderx 导航栏左上角:文件 -> 新建 -> 项目 -> 选择 uniapp ->选择模板 : Hello uniapp 演示模板 创建-> 导航栏中间:运行 -> 运行到小程序 , 你就可以啦~接下来的学习可以到官方的文档去学习哦~官方的文档                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序后端开发流程               闲鱼前端基于 serverless 的一种多端开发解决方案                                                        原作者:  前端小星星o一闪一闪亮晶晶                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "当小程序的flex布局遇到button时，justify-content不起作用的原因及解决方案 ... ", "author": "                  Rolan                  2019-11-12 11:23                ", "text": "                                                                                                                                                                                     在做小程序的时候要实现下面的搜索历史界面下面的搜索很明显的想到是用flex布局然后把justify-content设置为justify-content: flex-start; 代码如下：<!--wxml--><view class=\"flex\"><button class=\"item\">1</button><button class=\"item\">2</button><button class=\"item\">3</button><button class=\"item\">4</button><button class=\"item\">5</button><button class=\"item\">6</button><button class=\"item\">7</button></view><!--wxss-->.flex{  display: flex;  flex-wrap: wrap;   justify-content: flex-start;}.flex .item{  width: 216rpx;  background-color: red;  margin-bottom: 34rpx;}可效果却不尽人意发现justify-content不起作用无论怎么设置都是space-around的效果。 经过排查发现原因是小程序button中的默认样式中的margin-left: auto;margin-right: auto;所引起的。flex 格式化上下文中在通过 justify-content 和 align-self 进行对齐之前任何正处于空闲的空间都会分配到该方向的自动 margin 中去。参考自探秘 flex 上下文中神奇的自动 margin原因找到了具体修改就容易多了我们可以覆盖button的margin-left和margin-right的默认值或者在button外面包裹一层view。在遇到这个问题之前我也没想到过flex和margin之间还能这么用涨姿势了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)wJePerdre.27                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序实现A-Z导航的Slidebar               【微信小程序】图片压缩-纯质量压缩非长宽裁剪压缩                                                        原作者: lkkwxy                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序包大小优化(uni-app) ", "author": "                  Rolan                  2019-11-28 00:24                ", "text": "                                                                                                                                                                                     在开发微信小程序的过程中随着业务逻辑日渐庞大之后突显了一些问题。首先我们发现在 dev mode 时本地包大小已经达到了 4m+这种情况下已经无法在 dev mode 使用真机调试了。其次此时小程序 build 后也有 1.8M 左右。而且后续还有相当多的业务需求需要开发包大小肯定会更大。这时候就想要优化小程序包大小。下面分享一下我的定位过程和解决思路。尽管我们使用 uni-app 开发但思路是通用的希望能给大家一些帮助吧。如何减小包大小代码分析首先分析包大在哪儿了。打开本地代码目录查看文件大小。可以发现 common/vendor.js 和 page,components 中 js 占了大部分。在 build 编译模式下代码压缩已经启用了需要思考别的优化方式。这时候可以使用\twebpack-bundle-analyzer 插件\t。它可以帮助分析 vendor.js 中都有哪些 js 模块哪些模块比较大以便我们进一步优化代码通过这个插件发现了下面两个问题。问题一: uni-app 自定义组件模式编译 tree shaking 无效如果不是使用 uni-app 开发可以跳过这一段通过代码分析发现有些模块应该被 tree shaking 但却被打包进来了。基本确定是 tree shaking 没有生效。同样是 webpack4 + babel7。在不使用 uni-app直接使用 vue-cli create 项目的前提下tree shaking 是没有问题的。而使用 uni-app 去新建项目tree shaking 却无效。排查 babel 配置时发现是由于 uni-app 在创建项目的时候设置了 modules: 'commonjs'导致。修改后demo 的 tree shaking ok。但是回到项目里一编译又出错了。继续定位发现是\tuni-app 自定义组件模式编译问题 。目前uni-app\t已经修复 了我提的bug虽然还未正式发布。当然你不使用 uni-app 自定义组件模式编译也可以解决uni-app 还支持\ttemplate模板模式 但是会有一些开发差异和性能差距有兴趣可以看下\t这篇文章问题二：部分库不支持 tree shaking有些库(比如 lodash)本身并没有使用 import/export所以 webpack 并不能对它们 tree shaking。这些库我们可以分情况优化。首先可以找下网上是否有库对应的 esm 版本可以替代如 lodash-es。其次可以从代码分析中看出如果库的每个模块都在不同文件中入口文件只是一个统一入口那么我们就可以通过修改写法按需加载如import add from \"lodash/add\";import Button from 'ant-design-vue/lib/button';复制代码我们也可以使用\tbabel-plugin-import 插件针对那些库统一实现按需加载它的本质是在编译时统一按配置修改加载路径不需要自己手动去修改代码。最后如果都不行那要么接受要么自己重写为社区做贡献~规范模块开发为了免除无法 tree shaking 的烦恼我们在开发 npm 模块的时候也需要遵循一定的规范从而减少模块打包后的大小。同时支持 commonjs 和 es module我们的模块需要同时支持 commonjs 和 es module。这样才能既满足 commonjs 开发的用户又支持 tree shaking。如何实现呢？如果你的代码是 typescript,以@sentry/browser 为例可以在编译时编译 cjs 和 esm 两种规范代码如下// package.json\"build\": \"run-s build:dist build:esm build:bundle\",\"build:bundle\": \"rollup --config\",\"build:dist\": \"tsc -p tsconfig.build.json\",\"build:esm\": \"tsc -p tsconfig.esm.json\",复制代码然后在 package.json 中指定两个入口以及无副作用标识\"main\": \"dist/index.js\",  \"module\": \"esm/index.js\",  \"sideEffects\": false,复制代码这样当 webpack 解析模块(\t解析规则 )就会按需优先解析 esm 目录。并且当识别到无副作用时进行 tree shaking。如果你的代码本身就是 es6你也可以这样\"module\": \"src/index.js\",复制代码第三方自定义组件如果使用了第三方\t微信自定义组件 由于引用是在 json 文件所以 webpack 在编译时并不能通过 entry 分析到相关文件因此不会对其进行编译、压缩等。这时候就需要我们自己处理。而且由于 webpack 不处理tree shaking 自然也无法支持因此建议\t尽量避免 这种方式引用组件。分包小程序分包 也是一种常规的优化方案。通过分析后可以将一些较大的页面划分为子包。如果有单页依赖第三方自定义组件而且第三方组件还挺大也可以考虑将该页面划分为子包。也因此\t尽量避免将第三方自定义组件放在 globalStyle 不然没法将它放到子包去。大图不要打包小程序中的大图尽量避免打包进来应该放到 CDN 通过 url 加载。我们的做法是在开发时加载本地图片在 CI/CD 环节自动化发布图片并改写地址。如何解决真机调试问题首先还是查看编译后的文件发现\tcommon/vendor.js 巨大足有 1.5M。其次\tpages 和\tcomponents 也有 1.4M而这其中占了 js 的大小又占了绝大部分。为什么 js 文件这么大呢？主要是因为在 dev mode 默认并没有压缩当然也没有 tree shaking。我的选择是\t修改编译配置在 dev mode 压缩 js 代码 。本地代码减少到了 2M。预览大小则是减少到了 1.4M。参考配置如下：// vue.config.js    configureWebpack: () => {        if (isDev && isMp) {            return {                optimization: {                    minimize: true,                },            }        }    }复制代码这看上去并不是个好方案但确实简单有效。也考虑过分包但分包并不能解决 common/vendor.js 巨大的问题预览时包还是很大。如果有其它好的办法也欢迎留言~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 模拟打电话 实践               如何使用不到50行代码实现一个小而美的依赖收集库？                                                        原作者:  张块块                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "如何实现微信小程序换头像？三步帮你搞定！ ", "author": "                  Rolan                  2019-10-17 00:52                ", "text": "                                                                                                                                                                                     背景2019年10月1日在祖国70周年大庆之际微信朋友圈被大家纷纷@微信官方要国旗的景象给刷屏了在为祖国庆生的同时玩的不亦乐乎。在9月25日我心血来潮决定在国庆前开发一个换头像的微信小程序为祖国70周年献礼！最终在国庆前夕上线发布了制作头像的小程序-【海豚趣图】帮助10000多名小伙伴成功换上了国旗头像。小程序虽然已经上线但在【海豚趣图】这个小程序开发过程中的一些有意思的技术点我希望能总结一下和大家进行分享。主要步骤获取用户头像图片模板图片合成获取用户头像制作自定义头像的第一步就是先选择图片。在【海豚趣图】的交互设计中用户有三种选择图片的方式：微信头像、本地相册和相机拍摄。获取用户头像的产品设计如下图所示：由于微信官方不再支持通过 wx.getUserInfo 接口来获取用户信息我们必须通过使用 button 组件并将 open-type 指定为 getUserInfo 类型来获取或展示用户信息。为优化用户体验使用 wx.getUserInfo 接口直接弹出授权框的开发方式将逐步不再支持。从2018年4月30日开始小程序与小游戏的体验版、开发版调用 wx.getUserInfo 接口将无法弹出授权询问框默认调用失败。正式版暂不受影响。上图中弹出底部菜单的交互方式无法通过 wx.showActionSheet 来实现（因为该接口只能指定字符串文本不能使用 button, navigator 等组件）。因此只能通过自定义 actionSheet 组件来实现以上功能。mmp-action-sheet 组件以下是 mmp-action-sheet 组件的代码。index.wxml<view hidden=\"{{!actionShow}}\" class=\"mask {{mask}}\" bindtap=\"actionHide\">  <view class=\"actionSheet animated {{animation}}\">    <slot></slot>    <button class=\"close\" bindtap=\"actionHide\">{{closeText}}</button>  </view></view>复制代码通过 slot 在 action-sheet 中插入自定义的内容比如 button、navigator 等。index.wxss.mask{  position: fixed;  top: 0;  left: 0;  width:100%;  height: 100%;  background: rgba(0, 0, 0, 0.5);  z-index: 999;}.actionSheet{  width: 100%;  position: absolute;  top: 100%;  z-index: 1000;  overflow: hidden;}.actionSheet button,.actionSheet navigator{  color: #000;  text-align: center;  background: #fff;  border-radius: 0;  line-height: 3.5;  font-size: 32rpx;  border-bottom: 1rpx solid rgb(236, 236, 236);  opacity: 1;}.actionSheet button:active,.actionSheet navigator:active{  color:#000;  background: rgb(236, 236, 236);}.actionSheet button::after,.actionSheet navigator::after{  border: none;  border-radius: 0;}.actionSheet .close{  border-bottom: none;  border-bottom: 50rpx solid #fff;  border-top: 16rpx solid rgb(236, 236, 236);}.animated {  animation-timing-function: ease-out;  animation-duration: 0.2s;  animation-fill-mode: both;}@keyframes fadeInBottom {from{   transform: translate3d(0, 0, 0); }  to {    transform: translate3d(0, -100%, 0);  }}.fadeInBottom {  animation-name: fadeInBottom;}@keyframes fadeOutBottom {from{   transform: translate3d(0, -100%, 0); }  to {    transform: translate3d(0, 0, 0);  }}.fadeOutBottom {  animation-name: fadeOutBottom;}@keyframes fadeIn {from{   opacity: 0; }  to {     opacity: 1;  }}.fadeIn {  animation-name: fadeIn;}@keyframes fadeOut {from{   opacity: 1; }  to {     opacity: 0;  }}.fadeOut {  animation-name: fadeOut;}复制代码index.jsComponent({  properties: {    actionSheetStatus: {      type: Boolean,      value: false,      observer(newVal) {        if (newVal) {          this.setData({            actionSheetStatus: true,            animationMask: 'fadeIn',            animationSheet: 'fadeInBottom'          })        } else {          this.setData({            actionSheetStatus: false,            animationMask: 'fadeOut',            animationSheet: 'fadeOutBottom'          })        }      }    },    closeText: {      type: String,      value: '取消'    }  },  data: {    animationMask: 'fadeIn',    animationSheet: 'fadeInBottom'  },  methods: {    closeActionSheet() {      this.setData({        animationMask: 'fadeOut',        animationSheet: 'fadeOutBottom'      })      setTimeout(() => {        this.setData({actionSheetStatus: false})      }, 300)    }  }})复制代码组件只有两个参数：actionSheetStatus 指定组件的初始展示状态默认为false表示不显示组件。closeText 指定关闭按钮的名字默认为 取消。index.json{  \"component\": true,  \"usingComponents\": {}}复制代码接下来在页面中调用组件在组件中插入了3个 button 组件来实现来获取用户头像：<action-sheet actionSheetStatus=\"{{actionSheetStatus}}\">    <button open-type=\"getUserInfo\" bindgetuserinfo=\"bindGetUserInfo\">使用微信头像</button>    <button bindtap=\"pickPic\" data-source-type=\"album\">使用本地相册</button>    <button bindtap=\"pickPic\" data-source-type=\"camera\">拍照</button>  </action-sheet>复制代码以上我们通过自定义组件 mmp-action-sheet 就解决了原生的 actionsheet 无法指定 button从而无法获取用户微信头像的问题。该组件我已经发布到 npm 包需要用到的同学可以通过 npm 安装也可以在 github 上查看源码和使用文档。图片模板有了原图接下来我们需要选择图片模板。如果模板数量不多或者模板变化不频繁我们可以直接把模板放在本地。鉴于我提供的模板比较多放在本地会增大小程序源码的大小我把模板上传到了小程序的云存储中通过云函数来动态获取图片模板方便以后模板扩展。云函数 tpl 的代码如下：// 云函数入口文件const cloud = require('wx-server-sdk')cloud.init()// 云函数入口函数exports.main = async (event, context) => {  const wxContext = cloud.getWXContext()  // 1. 获取数据库引用  const db = cloud.database()  const MAX_LIMIT = 100  // 2. 构造查询语句  const countResult = await db.collection('template').count()  const total = countResult.total  // 计算需分几次取  const batchTimes = Math.ceil(total / 100)  const tasks = []  for (let i = 0; i < batchTimes; i++) {    const promise = db.collection('template').skip(i * MAX_LIMIT).limit(MAX_LIMIT).get()    tasks.push(promise)  }  return (await Promise.all(tasks)).reduce((acc, cur) => {    return {      data: acc.data.concat(cur.data),      errMsg: acc.errMsg,    }  })}复制代码页面中调用云函数拉取模板：getTpl() {    const self = this    // 调用云函数获取图片模板    wx.cloud.callFunction({      name: 'tpl'    }).then(res => {      self.setData({        templates: res.result.data      })    })}复制代码问题到这里模板的获取逻辑已经没有问题了但在开发过程中遇到了一个问题。模板图片的链接我使用的是云文件ID当有大量图片并行加载的时候只有部分图片能够显示我看了一下dom节点其实都已经存在了image的src的地址也都是正确的。微信官方自2.3.0开始已经支持在image中使用云文件ID。云文件ID的格式为： cloud://xxx.xxx/templates/01.png。我猜测可能是对微信云存储并发请求过多导致的（有知道的同学可以告知）因为我试了一下将云文件ID换成正常的HTTPS的链接是没问题的。由此可知可以想到有三种可行的解决方案：将图片模板存储到外部OSS使用https协议的链接。使用 wx.getTempFileURL 用云文件 ID 换取真实链接也就是https形式的链接。控制图的并行加载数量。我的实践是将并行加载数量控制在20当用户滚动的时候再发起下一次请求。总结以上主要分享了用户头像获取以及图片模板功能的实现及所遇到的一些问题。关于图片的合成是整个小程序的核心功能下一篇单独拉出来说一下实现思路和潜在的问题。敬请期待！扫码体验读者可以扫码体验我们所讲述的两个功能点：自定义actionsheet组件图片模板加载                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    你期待的微信小程序表格组件来咯               小程序 - 自定义导航栏重要步骤                                                        原作者: 快狗打车前端团队                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "[博客小程序]评论通知功能实现(一)——小程序发送模板消息的几种实现 ... ", "author": "                  Rolan                  2019-4-15 00:06                ", "text": "                                                                                                                                                                                     这两天抽空把评论通知的功能给基本实现了主要解决读者评论后我无法及时看到并回复的痛点。这篇主要说说模板消息发送的坑。使用前准备准备的话就是先读下文档了解下模板消息怎么发送和怎么接入的然后到你的后台去选择你想要的消息模板记录好对应的模板ID即可。最初看文档的时候感觉挺简单的无非先调用个接口获取 ACCESS_TOKEN , 然后调用发送模板消息的接口就完事了当然事实也确实如此但其中还是有些小坑的。后端实现后端实现对于我来说最轻松毕竟是搞后端开发的嘛我用 .net core 的方式实现了一把轻松搞定贴下代码至于 java 或者 php ,其实差不多。/// <summary>/// 获取新的 AccessToken/// </summary>/// <returns></returns>public static async Task<string> GetAccessToken(){    var url = $\"{WechatApiHost}/cgi-bin/token\";    var response = await HttpRequestHelper.GetAsync<dynamic>(url, new    {        grant_type = \"client_credential\",        appid = WechatAppId,        secret = WechatSecret    }, null, GlobalRequestConfig);    return response.IsSucceed && response.Data != null ? response.Data.access_token : null;}/// <summary>/// 发送模板消息/// </summary>/// <returns>The template message.</returns>/// <param name=\"openId\">Open identifier.</param>public static async Task<ResponseResult> sendTemplateMessage(String openId){    //先从redis获取token    var accessToken = await RedisInstance.Get<string>(MiniAccessTokenRedisKey);    if(string.IsNullOrWhiteSpace(accessToken))    {        accessToken =await GetNewAccessToken();        if (string.IsNullOrWhiteSpace(accessToken))            return new ResponseResult { Result = false, ErrorMessage = \"token获取失败\", Code = ResponseCode.InvalidParameters };        //保存到redis默认1小时        await RedisInstance.Set<string>(MiniAccessTokenRedisKey, accessToken, 1 * 60 * 60);    }    var url = $\"{WechatApiHost}/cgi-bin/message/wxopen/template/send?access_token={accessToken}\";    var tempData = new    {        touser = openId,        template_id = MiniMessageTemplate,//申请的模板消息id        page = \"/pages/detail/detail?blog=1\",        form_id = FormId,        data = new        {            keyword1 = new            {                value = \"元素1\"            },            keyword2 = new            {                value = \"元素2\"            },            keyword3 = new            {                value = \"元素3\"            }        },        //emphasis_keyword= \"keyword1.DATA\"    };    var response = await HttpRequestHelper.PostAsync<dynamic>(url, tempData, null, GlobalRequestConfig);    var sendResult = \"\";    if (!response.IsSucceed)        return new ResponseResult { Result = false, ErrorMessage = response.ErrorMessage, Code = ResponseCode.UnknownException };    return new ResponseResult { Result = true, ErrorMessage = \"\", Code = ResponseCode.Success };}js实现js的实现方式和后端代码实现也差不多也是调用两个接口逻辑一致这里主要介绍util函数避免重复造轮子。#github地址https://github.com/lcxfs1991/wx-js-utils对应的微信开放平台接口都基本已经封装好了文档也比较详细有兴趣的可以自己体验下。云调用实现这才是我想要的本身我的博客小程序部分功能是基于云开发的同时云调用实现的方式省去了获取 ACCESS_TOKEN 的步骤使用起来比较方便。具体实现文档还是比较详细的在使用前一定要在你的云函数目录下添加 config.json 文件声明好所需调用的接口并上传到云端。#声明使用发送模板消息接口{  \"permissions\": {    \"openapi\": [\"templateMessage.send\"]  }}这样就可以正常使用啦贴下我的发送模板消息的代码：const sendResult = await cloud.openapi.templateMessage.send({    touser: touser,    templateId: template,    formId: form_id,    page: 'pages/detail/detail?blogId=' + event.blogId,    data: {      keyword1: {        value: event.nickName // keyword1 的值      },      keyword2: {        value: event.message // keyword2 的值      }    },  })本以为一切顺利但终究好事多磨上传到云端之后一直提示:function has no permission to call this API首先怀疑我的 config.json 没有上传上去通过云开发后台去下载对应的函数发现已经上传同时也确定配置没有问题。再次仔细看文档看到这样一句话：版本要求：wx-server-sdk >= 0.4.0、开发者工具 >= 1.02.1903251 （ 目前需开发版或测试版）于是尝试下载了开发版重新上传了云函数问题解决了「泪奔中」所以有使用云调用实现的小伙伴一定要注意自己的开发中工具。其他使用 ACCESS_TOKEN 的时候一定要注意建议使用统一的服务来获取和刷新 access_token其他业务逻辑所使用的 access_token 均来自于该服务不应该各自去刷新否则容易造成冲突导致 access_token 覆盖而影响业务。另外开发版工具支持本地调试云函数了同时云开发的管理界面也有很大改动有兴趣的可以尝试下载看看。最后下一篇文章讲讲我的博客小程序中评论通知功能的具体实现。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发早知道               [博客小程序]评论通知功能实现(二)——实战过程中的坑                                                        原作者: bug2048                   来自: bug2048                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "扫小程序码实现网站登陆,提供源代码 ", "author": "                  Rolan                  2019-8-19 00:51                ", "text": "                                                                                                                                                                                     使用扫小程序码登陆网站网络上关于实现本本功能的文章很多但是给出案列的几乎没有今天笔者实现用小程序码实现网站登陆体验地址如下idea.techidea8.com/open/login.…思路关键流程建立场景sceneid和websocket的绑定关系获得sceneid场景ID可以前端生成也可以后端生成只需要保证sceneid的同一时间唯一性即可。前端生成可以采用随机数加时间戳的形式,也可以用uuid算法//时间戳var sceneid =\"scend-\" +  new Data().getTime() + Math.ceil(Math.random()*888888+1000000);复制代码建立websocketvar ws = new WebSocket(\"ws://192.168.0.106/websocket?clientid=\"+sceneid )ws.onopen=function(env){\tconsole.log(env)} ws.onmessage=function(env){\tvar data = env.data;\t//这个data 就是后端发来的用户数据} 复制代码后端建立websocket后端采用go语言github.com/gorilla/websocket包建立websocket.因为golang 非常适合高并发场景。func (ctrl *PushCtrl) websocket(w http.ResponseWriter, req *http.Request) {\t//fmt.Printf(\"%+v\",request.Header)\t//todo 检验接入是否合法\t//checkToken(userId int64,token string)\tquery := req.URL.Query()\tclientid := query.Get(\"clientid\")\tconn, err := (&websocket.Upgrader{\t\tCheckOrigin: func(r *http.Request) bool {\t\t\treturn true\t\t},\t}).Upgrade(w, req, nil)\tif err != nil {\t\tlog.Println(err.Error())\t\treturn\t}\tclientMap.Store(clientid, conn)\tgo func(clientId string, conn *websocket.Conn) {\t\t//处理出错信息\t\tdefer func() {\t\t\tconn.Close()\t\t\tclientMap.Delete(clientid)\t\t}()\t\tfor {\t\t\t_, _, err := conn.ReadMessage()\t\t\tif err != nil {\t\t\t\tlog.Println(err.Error())\t\t\t\treturn\t\t\t}\t\t}\t}(clientid, conn)}复制代码我们采用sync.map建立sceneid和websocket的对应关系clientMap.Save(sceneid,conn)复制代码对于因为异常断开的con我们需要移除clientMap.Delete(sceneid)复制代码获得小程序二维码获得小程序的accesstoken小程序access 请求接口如下``该接口日使用频率有限制因此我们需要将这些数据缓存起来,缓存方案很多有redis,也有内存我们这里直接用一个变量即可存储accesstoken :=\"\"func GetAccessToken() string{\treturn accesstoken }func RefreshAccessToken()string{\turl = \"\"\tresp := httpget(url)\t//resp 是一个包含accesstoken的json字符串,我们解析这个json即可\taccesstoken = decodeaccesstokenfromjson(resp)\treturn accesstoken }复制代码我们还需要一个滴答计数器用来刷新accesstoken,accesstoken 的有效期是7200秒我们4000秒刷新一次accesstoken 即可func refreshAccessToken(){\tticker := time.NewTicker(time.Second *4000)\tfor{\t\tselect {\t\t\tcase <-ticker.C:\t\t\t\tRefreshAccessToken()\t\t}\t}}复制代码在init.go 中的init方法中启动协程go refreshAccessToken()复制代码小程序二维码编程技巧小程序二维码请求接口如下https://api.weixin.qq.com/wxa/getwxacodeunlimit?access_token=ACCESSTOKEN由于该链接会返回俩种结果错误返回Json{\"errcode\":400001,\"errmsg\":\"什么什么原因\"}复制代码正确返回j图片buffer这是一个二进制码流因此我们需要对返回结果进行标准化处理我们建议一种标准化结果{code:0,data:\"\",msg:\"结果说明\"}复制代码参数说明code标识成功或者失败,200为成功,400为失败data图片的base64格式编码msg结果说明,或者出错提示代码示例如下url := fmt.Sprintf(\"https://api.weixin.qq.com/wxa/getwxacodeunlimit?access_token=%s\", token)ret, err := util.PostJSON(url, arg)if err != nil {\t\tutil.FailMsg(w, err.Error())\t\treturn}jsonstr := string(ret)if strings.Contains(jsonstr, \"errmsg\") {\tutil.FailMsg(w, jsonstr)\treturn} else {\tbase64data := base64.StdEncoding.EncodeToString(ret)\tutil.RespOk(w, \"data:image/png;base64,\"+base64data)}复制代码其中util是笔者封装的常用工具包前端请求成功后获得data,可以利用$(\"#qrcode\").attr(\"src\",res.data)刷新图片二维码function refreshqrcode(){    clientId = \"scene-\"+new Date().getTime();    var api = restgo.buildapi(\"miniapp/getwxacodeunlimit\")    restgo.post(api,{\"scene\":clientId}).then(res=>{        if(res.code==200){            $(\"#qrcode\").attr(\"src\",res.data)        }else{            alert(res.msg)            }        intiwebsocket()    },res=>{        alert(res.msg)    })}复制代码小程序处理关键点采用好的框架我们编程过程才用了uniapp这个框架不错,完全是vue的语法一套代码可以生成H5/小程序/android/ios我们采用了vue的watch特性,通过监听userid来确定是否发送信息watch:{\t userid:function(a,b){\t\t\t\t\t\tif(a==0){\t\t\t\treturn \t\t\t}\t\t\t\t\t\tthis.loaddata()\t\t\t//如果clientid是空的说明不是扫码进来的\t\t\t\tif(!this.clientid){\t\t\t\treturn \t\t\t}//如果是扫码进来的,那么我们还需要推送消息到服务器后端server.PublishMsg(this.clientid,this.userid,this.role,this.avatarUrl,this.nickName).then(res=>{\t\t\t\ttip.error(res.msg)\t\t\t},res=>{\t\t\t\ttip.error(res.msg)\t\t\t})\t\t\t\t }  }复制代码获取sceneid我们通过onload方法获得sceneidonLoad(arg) {\t\tif(!!arg && !!arg.scene){\t\t\t\t\tthis.clientid = decodeURIComponent(arg.scene)\t\t}\t\t\t\t\t},复制代码核心代码如下通过gotUserInfo获得用户头像、昵称等,通过uni.login获得codegotUserInfo :function(e) {\t\t\t //获得用户头像、昵称、\t\t\t  uni.login(\t\t\t  {\t\t\t\t  success:(res) =>{\t\t\t\t\t        //通过wx.login获得code\t\t\t      \t\t\tuserInfo.code = res.code                                                //统一传递到后端      \t\t\t\t\t\tthis.authwithcode(userInfo)\t\t\t\t  }\t\t\t  }\t\t\t  )\t\t\t}\t\t  },\t\tauthwithcode:function(userInfo){                        //code获得openid在后端做,做了后继续去查User表\t\t\tserver.AuthWithCode(userInfo).then(res=>{\t\t\t\t\t//如果这个openid绑定了用户\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(res.data.id>0){\t\t\t\t\t\t//这里res.data 就是user对象,可以继续操作\t\t\t\t\t\treturn ;\t\t\t\t\t}\t\t\t\t\t//如果没有那么注册\t\t\t\t\tserver.RegisterWithOpenId(res.data.mini_openid,userInfo.avatarUrl,userInfo.nickName)#.then(res=>{\t\t\t\t\t\t//注册成功则返回\t\t\t\t\t\t//这里res.data 就是user对象可以继续操作\t\t\t\t\t\t\t\t\t\t\t},res=>{\t\t\t\t\t\ttip.error(res.msg)\t\t\t\t\t})\t\t\t\t},res=>{\t\t\t\t\ttip.error(res.msg||\"\");\t\t\t\t})\t\t\t}\t\t},\t复制代码体验地址本文所有应用体验地址如下互联网行业解决方案吧https://idea.techidea8.com/open/idea.shtml?id=5关于代码代码获得地址小程序码登陆代码配置请认真阅读readme.md                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序canvas绘制圆角base64图片               微信小程序支持 webP 的 WebAssembly 方案                                                        原作者: 非正式解决方案                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序 封装路由 mini-router ", "author": "                  Rolan                  2019-4-22 00:38                ", "text": "                                                                                                                                                                                     1.介绍mini-router 是一个在微信小程序中使用的路由模块主要用于在小程序中的路由模块化和解耦解决小程序中的路由地址的硬编码。 Github: https://github.com/hellolad/mini-router原生路由：// 用法：1wx.navigateTo({  url: \"/pages/logs/logs\"})// 用法：2wx.navigateTo({  url: \"/pages/logs/logs\",  success(res) {    console.log(\"success\", res)   },  fail(err) {    console.log(\"fail\", err)  },  complete() {    console.log(\"complete\")  }})// 用法：3（传参）wx.navigateTo({  url: \"/pages/logs/logs?key=value\",})mini-router// 用法：1app.$router.push(\"logs\")// 用法：2app.$router.push(\"mine\")  .success(res => {    console.log(\"success: \", res)  })  .fail(err => {    console.log(\"fail: \", res)  })  .complete(_ => {    console.log(\"complete\")  })// 用法：3 (传参)app.$router.push(\"logs\", { key: value })2.使用方法// 第一步：导入router模块并且在app.js里 给app设置一个属性$router// app.jsimport MiniRouter from './route/router'onLaunch: function () {  this.$router = new MiniRouter()},// 第二步：配置route文件夹中的pages模块 （url 直接复制app.json里的pages）export default [  {    url: 'pages/index/index',    name: 'index'  },  {    url: 'pages/article/article',    name: 'article'  },  {    url: 'pages/mine/mine',    name: 'mine'  },  {    url: 'pages/logs/logs',    name: 'logs'  },  {    url: 'pages/login/login',    name: 'login'  },  {    url: 'pages/next/next',    name: 'next'  }]// 第三步：在需要的文件里 使用app.$router.push(\"logs\")3.支持的方法目前mini-router支持微信小程序里的路由的所有方法函数名对比:4.函数介绍push(name, params = null) 保留当前页面跳转到应用内的某个页面。但是不能跳到 tabbar 页面reLaunch(name, params = null) 关闭所有页面打开到应用内的某个页面 可传递参数 可跳转到Tabbar页面redirect(name, params = null) 关闭所有页面打开到应用内的某个页面 可传递参数 不可重定向到Tabbar页面switchTab(name) 跳转到指定的Tabback(delta = 1, params = null) 关闭当前页面返回上一页面或多级页面。 没有参数 代表返回上一页backHome(params = null) 关闭所有页面返回到首页5.错误处理当你输入一个在pages模块中找不到的路由时(log)mini-router会抛出错误例如：app.$router.push(\"log\", { log: \"这是一个Log\" })// 打印/*!! Not found page ->：[log] !!; [Component] Event Handler Error @ pages/index/index#bound handlePushLogs*/6.获取传递的参数mini-router内置了一个属性params它会根据你跳转的页面动态的更换当前属性的值。// 当我传递了一个参数 { log: \"这是一个Log\" }app.$router.push(\"logs\", { log: \"这是一个Log\" })// 然后我在下一个界面的onShow/onLoad里接收const params = app.$router.paramsparams.log // 这是一个Log参数存储在storage里你可以通过小程序调试工具看到:mini-router params获取参数时你不必知道它存储在storage里的key是什么你只要拿app.$router.params就可以了7.反向传值mini-router 通过back或者backHome函数实现反向传值（反向携带参数）app.$router.back(1, { isLogin: false })// 中间页传值给最后一页最后一页携带值给首页const { data } = app.$router.paramsapp.$router.backHome({ data })当你选择不携带参数返回时在首页你将拿不到app.$router.params,因为mini-router会把params软删除如果你需要的话你还是可以从storage里拿到它。8.状态处理mini-router同小程序一样提供三种状态success fail complete 不同于小程序mini-router使用链式调用来处理这三种状态app.$router.push(\"mine\")  .success(res => {    console.log(\"success: \", res)  })  .fail(err => {    console.log(\"fail: \", res)  })  .complete(_ => {    console.log(\"complete\")  })9.query方式传参上面的都是通过params传参传的参数缓存在了storage里新增加的query类型传参将参数拼接到了url后面:/** * Query 方式传递参数 */handlePushLogsQuery() {  app.$router.push(\"logs\", { log: \"这是一个Log\", name: \"hellolad\"}, 'query')},handlePushLoginQuery() {  app.$router    .push(\"login\", { phoneNumber: \"1561900000000\" }, 'query')    .success(res => {      console.log(\"success: \", res)    })},handleReLaunchArticleQuery() {  app.$router.reLaunch(\"article\", { articleId: '10002' }, 'query')    .success(res => {      console.log(\"success: \", res)    })},handleRedirectLoginQuery() {  app.$router.redirect(\"login\", { phoneNumber: '1561900000000' }, 'query')    .success(res => {      console.log(\"success: \", res)    })},// 获取参数和普通的params传参获取参数一样:const { phoneNumber } = app.$router.params// 也可以在onLoad(options)里获取console.log(\"login options\", options)// 生成的url类似：/pages/login/login?phoneNumber=1561900000000寄语：对于前端来说可以说初窥门径想要更深入一步还是要坚持不断的学习和看源码。mini-router可以实现小程序里路由的跳转也将成为我下一个小程序使用的路由模块如果有不足的地方欢迎题issuse如果有好的想法欢迎pull request。Github: https://github.com/hellolad/mini-router                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序组建通信               上传小程序的代码时自动压缩                                                        原作者: Hellolad                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序实现语音识别转文字，坑路历程 ", "author": "                  Rolan                  2019-8-14 00:43                ", "text": "                                                                                                                                                                                     最近为小程序增加语音识别转文字的功能坑路不断特此记录。微信开发者工具开发者工具上的录音文件与移动端格式不同暂时只可在工具上进行播放调试无法直接播放或者在客户端上播放debug的时候发现工具上录音的路径是http://tmp/xxx.mp3客户端上录音是wxfile://xxx.mp3。 忽悠呢不是格式不同是映射路径不同。其实做个兼容也不难每次提示一行文字很丑。采样率与编码码率限制每种采样率有对应的编码码率范围有效值设置不合法的采样率或编码码率会导致录音失败。详细看这个https://developers.weixin.qq.com/miniprogram/dev/api/media/recorder/RecorderManager.start.html一开始没有留意导致录音不成功。试过几次后采用这样的配置感觉录音识别率和体积之间比较好平衡：123sampleRate: 16000, //采样率numberOfChannels: 1, //录音通道数encodeBitRate: 96000, //编码码率单通道基本是必选的。因为asr只支持单通道。frameSize也是可以的但是要考虑截断对识别的影响。暂时没有用上。录音优化因为可能误按于是对小于500ms的录音直接忽略。另外松开录音按键后再延迟一点时间才真正stop录音。录音文件格式微信录音文件支持mp3和aac。这2种格式文件都比较小aac文件体积更小。这对上传来说是件好事情速度更快。但是对语音识别转文字就不友好了。因为百度、阿里云ASR、讯飞的语音转文字接口都不支持aac和mp3通常要求是pcm或者wav格式。如果微信录音能提供wav格式那么就不用服务器做格式转换了但是wav格式体积是mp3、aac的5到10倍至少短期是没戏了这也是很多人吐槽的地方。服务器转换录音文件格式可以用java第三方库转换也可以用Process调用ffmpeg转换。要注意的是根据识别API的要求来做转换。比如阿里云asr的要求是：支持音频编码格式：pcm(无压缩的pcm文件或wav文件)、opus16bit采样位数的单声道(mono)；支持音频采样率：8000Hz、16000Hz；java ProcessBuilder要使用数组传参转换音视频习惯用ffmpeg。安装完ffmpeg之后用java新建进程调用。1Process = new ProcessBuilder(\"ffmpeg -i in.mp3 out.wav\").start();一直提示CreateProcess error。 后来看文档才发现要以数组的形式传入参数。1Process = new ProcessBuilder(\"ffmpeg\", \"-y\", \"-i\", \"in.mp3\", \"out.wav\").start();这样就启动成功了。关于java启动进程不是本文重点以后再写篇文章总结。阿里云asr sdk使用问题这个问题困扰了一天时间回想起来真是吐血。问题表现是微信录制的语音很多都识别不了。最初是直接把录音mp3文件转换为pcm文件本地能播放但是用阿里云asr sdk却识别不了。 一开始以为是文件编码问题。特意查了asr支持的文件格式用ffprobe检查potplayer看属性都没有看出问题。甚至把启动ffmpeg进程转换也改了用了java的库去做还是不行。后来为了方便测试问题用asr的restful接口测试录音文件都能识别！ 似乎是sdk的问题。于是打开官方文档例子对比。发现用的是sdk 2.x老铁啊你复制粘贴过来的代码竟然少了！欲哭无泪。1234// TODO  重要提示：这里是用读取本地文件的形式模拟实时获取语音流并发送的因为read很快所以这里需要sleep// TODO  如果是真正的实时获取语音则无需sleep, 如果是8k采样率语音第二个参数改为8000int deltaSleep = getSleepDelta(len, sampleRate);Thread.sleep(deltaSleep);也少了对sampleRate的设置。阿里云asr token过期因为用的是免费版asr没有给福报厂充值因此token一天失效导致联调的时候突然报错。最后实在受不了写了个定时任务每小时更新token。这就是beggar VIP                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序页面通信解决方案               微信小程序 - 输入起点、终点获取距离并且进行路线规划（腾讯地图） ... ...                                                        原作者: ycwu314                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": null, "author": "", "text": ""},{"title": "mpVue + 云开发微信小程序之旅 ", "author": "                  Rolan                  2019-6-20 00:46                ", "text": "                                                                                                                                                                                     本文是使用mpVue + 小程序云开发构建的mini型的微信小程序小程序加载过程会稍微比较慢如存在问题望各路大神指教。 小程序分为三个部分：1. 首页主要是展示发布的内容；2. 写日记是提供添加数据的项；3. 详情页是浏览内容正文的具体详情喜欢的小伙伴动动您的小手给个小星星哦谢谢！！ 小程序源码小程序二维码首页先看首页效果图顶部是一个轮播 此轮播是获取预览人数排名第一个的发布的图片 中间部分是内容展示区 全部最新我的 。直接上代码吧// index.vuemethods： {    // 跳转详情    navigateTo (id) {      wx.navigateTo({        url: '../diaryDetail/main?id=' + id      })    },    // 切换 全部 最新 我的    switechNav (index) {      this.isActive = index      if (index === 0) {        this.getDiaryList()      }      if (index === 1) {        this.getNewList()      }      if (index === 2) {        this.getOpenId()      }    },    // 最近发布的按时间排序前10条    getNewList () {      const that = this      wx.showLoading({        title: '加载中'      })      wx.cloud.callFunction({        name: 'diaryList'      }).then(res => {        let infoList = res.result.data.reverse()        setTimeout(function () {          wx.hideLoading()        }, 2000)        that.diaryList = infoList.slice(0, 10)      })    },    // 获取自己发布的    getMyList () {      const that = this      const db = wx.cloud.database()      const diary = db.collection('diary')      wx.showLoading({        title: '加载中'      })      diary.where({        _openid: that.openId      }).get({        success: function (res) {          setTimeout(function () {            wx.hideLoading()          }, 2000)          if (res.data.length === 0) {            toast('您暂时没有发布文章日记', 'none')          }          that.diaryList = res.data.reverse()        }      })    },    // 通过云函数获取日记的list    getDiaryList () {      const that = this      wx.showLoading({        title: '加载中'      })      wx.cloud.callFunction({        name: 'diaryList'      }).then(res => {        setTimeout(function () {          wx.hideLoading()        }, 2000)        let infoList = res.result.data        that.diaryList = infoList.sort(function (a, b) {          return b.preview - a.preview        })        that.imgUrls = that.diaryList[0].imagesList      })    }    // 获取openid    getOpenId () {      const that = this      wx.cloud.callFunction({        name: 'user'      }).then(res => {        that.openId = res.result.OPENID        that.getMyList()      })    }}复制代码工具函数工具函数在 utils/index.js做时间格式化和弹出提示function addZero (n) {  return n > 10 ? n : '0' + n}// toast 弹出提示export function toast (title = '成功', icon = 'success', duration = 2000) {  wx.showToast({    title: title,    icon: icon,    duration: duration  })}// 时间格式化export function getNowFormatDate () {  const now = new Date()  const year = now.getFullYear()  const month = addZero(now.getMonth() + 1)  const day = addZero(now.getDate())  const hh = addZero(now.getHours())  const mm = addZero(now.getMinutes())  const ss = addZero(now.getSeconds())  const timer = year + '-' + month + '-' + day + ' ' + hh + ':' + mm + ':' + ss  return timer}export default {  toast,  getNowFormatDate}复制代码详情页展示内容详情顶部轮播是作者上传的图片可以点击查看原图有为日记点赞以及评论功能// diaryDetail.vuemethods: {    // id 是文章id通过首页跳转传过来 page页面可以用 this.$root.$mp.query.id 获取    getDiaryDetail (id) {      const that = this      const db = wx.cloud.database()      const diary = db.collection('diary')      diary.doc(id).get().then(res => {        that.detailInfo = res.data        that.detailImgs = res.data.imagesList      })    },  // 点赞    dianZan () {      const that = this      const db = wx.cloud.database()      const _id = this.$root.$mp.query.id      const dianzan = db.collection('dianzan')      dianzan.where({        textId: _id,        _openid: that.openId      }).get({        success: function (res) {          if (res.data.length === 0) {            that.addDZ()            return false          }          toast('不能重复点赞哦！', 'none')        }      })    },    // 添加点赞人以便可以判断是否重复点赞    addDZ () {      const that = this      const _id = this.$root.$mp.query.id      const db = wx.cloud.database()      const dianzan = db.collection('dianzan')      dianzan.add({        data: {          textId: _id, // 文字id          isZan: 1 // 1 为点赞        }      }).then(res => {        that.isAnimate = true        that.changeDZCount(_id)      })    },    // 调用点赞云函数自增点赞数    changeDZCount (id) {      const that = this      wx.cloud.callFunction({        name: 'dianzan',        data: {          _id: id        }      }).then(res => {        toast('谢谢您的认可哦！', 'none')        that.getDiaryDetail(id)      })    },    // 判断阅读的人是否对这篇文章已经点过赞如果点过赞进入页面心直接变红    getZan () {      const that = this      const db = wx.cloud.database()      const _id = this.$root.$mp.query.id      const dianzan = db.collection('dianzan')      dianzan.where({        textId: _id,        _openid: that.openId      }).get({        success: function (res) {          if (res.data.length) {            that.isAnimate = true          }        }      })    },    // 获取评论    getComment (id) {      const that = this      const db = wx.cloud.database()      const comment = db.collection('comment')      comment.where({        textId: id      }).get({        success: function (res) {          that.commentList = res.data.reverse()        }      })    },    // 添加评论    addComment () {      if (this.content === '') {        toast('请输入评论内容', 'none')        return false      }      const that = this      const db = wx.cloud.database()      const comment = db.collection('comment')      comment.add({        data: {          textId: this.$root.$mp.query.id, // 正文id          user: that.userInfo, // 用户信息          content: that.content, // 评论内容          time: getNowFormatDate() // 评论时间        }      }).then(res => {        that.contentCount = 0        that.getComment(this.$root.$mp.query.id)      })    },    // 判断用户是否发表过评论    getIsComment () {      const that = this      const db = wx.cloud.database()      const comment = db.collection('comment')      comment.where({        _openid: that.openId,        textId: this.$root.$mp.query.id      }).get().then(res => {        if (res.data.length === 0) {          that.addComment()          toast('发表成功')          that.content = ''          return false        }        toast('不能重复发表评论哦！', 'none')      })    },    // 绑定评论字数    handleContentInput (e) {      this.contentCount = e.target.value.length    },    // 发表评论    onGotUserInfo (e) {      this.userInfo = e.target.userInfo      this.getIsComment()    },    // 轮播图 全屏预览图片 调用微信API wx.previewImage    handleImagePreview (e) {      let idx = e.target.dataset.idx      let images = this.detailImgs      wx.previewImage({        current: images[idx],        urls: images      })    }}复制代码写日记将 wx.chooseImage() 生成的临时图片保存到微信云存储主要掉用 wx.cloud.uploadFile()方法// write.vuemethods: {    // 上传图片并将临时图片保存到云存储中    chooseImage () {      const that = this      wx.chooseImage({        count: 9,        sizeType: ['original', 'compressed'],        sourceType: ['album', 'camera'],        success: function (res) {          // 将选择的图片上传到云存储          for (let i = 0; i < res.tempFilePaths.length; i++) {            const filePath = res.tempFilePaths[i]            const name = Math.random() * 1000000            const cloudPath = name + filePath.match(/\\.[^.]+?$/)[0]            wx.cloud.uploadFile({              cloudPath,              filePath,              success: res => {                let images = that.imagesList.concat(res.fileID)                that.imagesList = images.length <= 9 ? images : images.slice(0, 9)              }            })          }        }      })    },    // 限制标题字数    handleTitleInput (e) {      this.titleCount = e.target.value.length    },    // 限制标题字数    handleContentInput (e) {      this.contentCount = e.target.value.length    },    // 全屏预览图片    handleImagePreview (e) {      console.log(e)      let idx = e.target.dataset.idx      let images = this.imagesList      wx.previewImage({        current: images[idx], // 当前预览的图片索引        urls: images // 所有要预览的图片      })    },    // 移除不想要的图    removeImage (e) {      const that = this      const idx = e.target.dataset.idx // 当前需要移除的图片索引      wx.showModal({        title: '提示',        content: '您确定删除这张照片吗？',        success (res) {          if (res.confirm) {            that.imagesList.splice(idx, 1)            toast('删除成功')          } else if (res.cancel) {            console.log('用户点击取消')          }        }      })    },    // 发布文章    onGotUserInfo (e) {      if (this.title === '') {        toast('请输入文章标题', 'none')        return false      }      if (this.content === '') {        toast('请输入文章内容', 'none')        return false      }      if (this.imagesList.length === 0) {        toast('您还没上传图片', 'none')        return false      }      this.userInfo = e.target.userInfo      this.getOpenId()    },    // 往数据库里写数据    sendMessage () {      const that = this      const db = wx.cloud.database()      const diary = db.collection('diary')      diary.add({        data: {          title: that.title, // 正文标题          content: that.content, // 正文内容          imagesList: that.imagesList, // 上传图片 list          avatarUrl: that.userInfo.avatarUrl, // 头像          nickname: that.userInfo.nickName, // 名字          preview: 0, // 预览数          fabulous: 0, // 点赞数          creatTime: getNowFormatDate()        }      }).then(res => {        toast('发布成功')        that.title = that.content = ''        that.titleCount = that.contentCount = 0        that.imagesList = []      })    },}复制代码末尾在使用云开发中需要将如下代码放到根目录的 src/main.js中wx.cloud.init({  env: '云开发环境ID'})复制代码app.json 文件下添加 \"cloud\": true 告诉小程序使用云开发, project.config.json文件下添加 \"cloudfunctionRoot\": \"static/functions/\", 指定存放云函数的目录                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    [填坑手册]小程序目录结构和组件化使用心得               在小程序中实现 Mixins 方案                                                        原作者:  Jerry_Zeng                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "探索小程序实现 ", "author": "                  Rolan                  2020-1-6 00:15                ", "text": "                                                                                                                                                                                     随着小程序的发展与功能的逐步完善越来越多的产品需要小程序与 APP 的功能能有一些共性社区跨平台的解决方案越来越多比如 taro 等为代表的把一套代码编译成多端运行的机制本文会使用 Swift 作为原生语言在 iOS 应用上运行一个小程序 Demo 使用 Android && React Native 也可以采用同样的思路实现。相关代码仓库： https://github.com/taixw2/rmini编译层编译的目的是为了抹平小程序的与 H5 的差异利用 Vue 实现数据绑定利用 Web Component 实现小程序的组件功能。从官网文档中可以看出来运行一个小程序需要框架（数据绑定渲染）、组件（小程序渲染单元）、api（与原始交互的能力）。框架实现转换成单页应用（一种可行的方案）把所有页面打包成一个 js 再由 js 管理所有的路由和状态这种方案适合在 web 端运行并且是单引擎的方案在模拟原生的右滑返回等效果也会不尽人意。转换成多页面众所周知小程序是一个双引擎的框架上面的方案显然不能达到要求, 双引擎的特点是在运行 javascript 的黑盒子中无法访问到 DOM && BOM 等。将所有的逻辑代码在原生的 JavascriptCore 中运行WebView 中的 Javascript 引擎负责数据绑定需要解决的难点是 JavascriptCore 中的 setData 怎么通知 WebView 渲染 WebView 的事件怎么执行 JavascriptCore接着往下看。抹平WXMLwxml 是一种类 html 标记语言他负责所有的渲染规则包括条件渲染、列表渲染、数据绑定等与其再实现一种框架还不如直接利用 Vue 实现同样的功能再利用各种转换库将 wxml 中的事件转换成 Vue 能够识别的事件如利用 post-html 可以做到如下的转换:每一个事件绑定的方法全都在原生的 JSContext 中运行所以此时的事件只需要传递给 JSContext 的作用。抹平WXSSwxss 作为小程序的样式语言其余 css 的主要区别就是多了一个 rpx 单位以下是官网的换算表：根据上表可得知 rpx = (750 / 屏幕宽度) * px ;在传统的移动端页面我们的高清方案一般需要获取 dpr 然后修改动态修改 viewport 和 html 上的 font-size但是小程序的代码因为是放在了设备本地所以可以在下载小程序页面之后我们还有一次编译机会这时就可以把 rpx 根据当前设备的屏幕宽度替换成对应的 px。还有一个 @import 则利用 scss 或 less 就可以合并到同一个 css 文件中,而全局样式则可以在构建 WXML 的时候再植入进入抹平组件组件具有独特的功能和自己的渲染规则比如 scroll-view 具有 scroll-x 和 scroll-y 等属性控制滚动条。在 HTML5 中有一个重大的功能 web-component 它能够自定义 html 元素并且能够监控属性的变化非常适合实现小程序组件。如：（使用了 lit-element 框架）这里用了 lit-element 这个框架能够简化一些操作。抹平 Page 和 AppApp 负责整个应用的生命周期以及存一些全局的数据 getApp 能获取到 app 的信息。 所以类似的结构可能是这样的：getApp 能够直接访问到内部对象并且在最顶层声明这样每一个的地方都能访问到 getApp。初始化一个页面都需要是实例化 PageClass, 即使再次进入（不是返回到这个页面）这个页面页需要再次重新实例化每次实例化都需要关联一个 webviewId, 这个 ID 与原始的 webview 关联这样每个 PageClass 中的 setData 都能找到对应的 webview 进行再次渲染所以对应的代码可能是这样的：抹平 API通过 API 能够直接调用原生的功能比如 wx.request  如果直接在 webview 中的 JSContext 中运行的话则可能存在跨域但是放在原生就不会存在这个问题。实现JSContext 调用原生代码的功能需要给 JSContext 中植入一个 JSBridge如： JSBridge.invoke 和 JSBridge.on , invoke 负责同步任务on 负责异步任务原生再利用反射（原生的反射真麻烦）调用对应的原生方法原生可以利用 while(true) 挂起 JSContext既可以达到同步和异步的方法。打包 JavascriptJavascript 代码打包后被放在 JavascriptCore 中运行唯一与 Webview 中的 JSContext 打交道的只有 setData , 先看一下打包流程：利用 App.json 构建入口文件利用 rollup 等工具将所有 Javascript 打包成一个文件（目前没有分包）打包流程及其简单接下来看一下两个 Javascript 引擎的交互过程。打通 JSContext 到 WebView JavascriptCore每次进入一个页面的时候都需要为这个页面的 webview 分配一个 id, 这个 id 至关重要作为 native 与 JSContext (原生运行 javascript 的上下文对象) 与 webview 交互的唯一标识JSContext 中需要实例化一个新的 PageClass 关联这个 id native 中通过 id 保留 webview 的引用。在 JSContext 中植入一个 JSBridge 用于与原生交互如： JSBridge.setData(webviewId, appId, data), 当 JSBridge 的 setData 被调用后通过 appId + webviewId 就能找到对应的 webview, 再将 setData 传入 webview 中在 Vue 接收到 data 后进行渲染 整个过程如图：打通 Webview JavascriptCore 到 JSContext有了前面的铺垫接下来再看 webview 如何调用 JSContext 的方法 Webview 唯一能与 JSContext 交互的方式只有事件事件触发后需要通过某种方式触发 JSContext 中的方法最后调用 setData 再返回来重新渲染 webview。webview 中绑定的方法名众多如： bindtap=\"a\", bindtap=\"b\", bindtap=\"c\" 等但是可以通过 “抹平 WXML” 的时候最终只保留一个出口如:v-on:click=\"callClick('a', $event)\" 等这样 vue 中的 method 只需要实现对应的几个事件便可：结尾利用原生作为桥梁在两个引擎之间通信webview 中的 JSContext 负责接收渲染通知以及发送事件到 Native 的 JSContext 中JSContext 独立运行所以既访问不到 window 对象也访问不到 document 对象。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序wifi能力解读与实践               小程序摸爬滚打之路                                                        原作者: mro                    来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序搜索优化指南 ", "author": "                  Rolan                  2020-1-14 00:12                ", "text": "                                                                                                                                                                                     有流量抢夺的的地方就会自然有战场小程序搜索能力升级后现在用户可通过关键词的搜索即可直达小程序页面内的服务这将缩短用户使用小程序所提供的服务之间的时间提升搜索效率的同时也帮助优质的小程序获得更多的曝光。微信在2019年重点对搜索进行了升级开放了小程序基于页面的搜索搜索将不再局限于搜索具体的某一个小程序名称“小程序名称”的优势已经下落神坛。目前搜索是当下小程序唯一的自然流量来源用户在使用搜索的情况下用户需求十分精准所以搜索场景的流量价值非常高带来的用户在后续的留存的表现中也会高出其他场景很多。有流量抢夺的的地方就会自然有战场小程序搜索能力升级后现在用户可通过关键词的搜索即可直达小程序页面内的服务这将缩短用户使用小程序所提供的服务之间的时间提升搜索效率的同时也帮助优质的小程序获得更多的曝光。微信公开课PRO 张小龙也说道做小程序希望是搜索能进入到每一个小程序内部这样海量的小程序可以支撑起各种长尾的搜索需求。下面一起来看看微信近期最新发布的小程序页面收录规则希望能够助你瓜分部分流量。一、利用配置文件引导爬虫抓取小程序页面收录通过管理后台页面收录开关来配置其小程序页面是否允许微信索引。后续小程序相关页面内容可以通过 sitemap.json文件进行配置该文件用来配置小程序及其页面是否允许被微信索引。如果小程序目录没有该文件打开“页面收录”后就会默认小程序所有页面都可以被索引。微信会通过爬虫的形式为小程序的页面内容建立索引同时会带上1129的场景值。当用户的搜索词条触发该索引时小程序的页面将可能展示在搜索结果中。如果直接关闭收录能力微信将不会进一步收录你小程序内的任何内容意味着你的小程序内容（包含已收录内容）无法在搜索和扫条码场景下展现这将减少你的小程序曝光机会。当存在不便于被微信收录的页面时也可利用sitemap文件进行配置将一些用户个人信息、通信信息、商业秘密等敏感内容设置成不允许索引状态。sitemap文件配置目前包含以下5种规则：特指某个页面不索引其余页面均允许被索引；特指某个页面被索引其余页面不被索引；包含 a 和 b 参数的 页面会被优先索引其他页面都会被索引；包含 a 和 b 参数的 页面会被优先索引其他页面不被索引；不做其它设置时默认情况下所有页面都会被微信索引。如果小程序想突出一些主打的价值页面可利用页面路径推送能力让部分页面被优先且及时的收录进而提高小程序内容的曝光机会并且缩短用户体验路径。二、设置清晰的标题和页面缩略图页面标题和缩略图对于微信理解页面和提高曝光转化有重要的作用那么何为“清晰的标题”个人猜测是根据页面标题进行语义识别分词后划分各词权重配合缩略图来进行收录以及搜索结果展示。比如页面标题为“精选日签推荐”假设分词结果为“精选”、“日签”、“推荐”那么假设“日签”的权重为88其余为45、33。使用页面路径推送能力直接搜索关键词“日签”搜索结果就有可能包含该页面。以上个人猜测是头部流量的情况根据关键词权重进行收录及优先排序。还有一种情况是尾部流量微信公开课PRO 张小龙也说道做小程序希望是搜索能进入到每一个小程序内部这样海量的小程序可以支撑起各种长尾的搜索需求。尾部流量指的是一些流量比较低的一些关键词但尽管这些关键词搜索量很低但它们加起来的可能占总数的一大半。比如做的是一款“壁纸类小程序”发现“新年壁纸”以及一些“娱乐明星壁纸”占据很多搜索量。对于一些初创企业想竞争一些头部关键词比较难。但如果利用尾部浏览比如聚焦于“NBA球星”就有可能撕开一个口子。当然以上例子仅供参考微信并没有明确的公布搜索结果排序规则只能靠猜。实际情况最好配合“微信指数”以及小程序页面访问情况来进行优化如果发现局部页面比起其他页面访问量明显高一个档次该页面对应的微信指数又不是很高的情况下那么我认为可以使用该策略。如果不自定义转发图片的情况下默认会取当前页面从顶部开始高度为 80% 屏幕宽度的图像作为页面缩略图转发出去。个人建议小程序核心页面还是自定义为佳因为微信默认截取的部分很可能缺失部分画面。其次用户转发时缩略图也有刺激用户打开的欲望通过好友转发打开是目前小程序流量top3的来源。此外最好也给 video、audio 组件补齐视频封面属性用于给搜索等场景作为视频封面展示建议使用无播放 icon 的视频封面图微信之所以要求没有播放icon应该是避免icon的遮挡导致视频封面的识别不佳。三、合理的微信授权微信一直提倡的“一切以用户价值为依归”所谓合理即在必要的时候才要求用户授权比如浏览动态可以匿名而发表评论需要留名从而用户在发表评论时才请求授权。如果某类小程序一启动就必须注册成功后才能使用从业务上考虑注册操作不能滞后那么大概率该类型小程序与收录无缘因为可能会发生收录错误。四、微信不收录web-view如果小程序某些页面是嵌入web-view而不是小程序原生页面无法收录里面的任何内容微信团队称目前做法做到长期来看也可能做不到。毕竟还是把时间和力气花在刀刃上从布局和趋势来看猜测小程序还有更多有价值的事情值得去做。比如“在微信搜索商品”这些功能可以很好的满足微信用户对商品的信息获取诉求同时也能为商家小程序带来曝光流量和建立用户品牌认知的机会。五、微信其它收录规则规则1：小程序里跳转的页面 (url) 可被直接打开小程序页面内的跳转url是微信爬虫发现收录页面的重要来源且搜索引擎召回的结果页面 (url) 是必须能直接打开不依赖上下文状态的。特别建议页面所需的参数都包含在url以保证每个独立页面能够打开便于爬虫收录。规则2：清晰简洁的页面参数结构清晰、简洁、参数有含义的 querystring 对抓取以及后续的分析都有很大帮助但是将 JSON 数据作为参数的方式是比较糟糕的实现。这里是建议不要将json作为url的参数过于冗长但是和第一条是有点相互矛盾即想页面跳转不依赖上下文又想参数简洁。多的不说抽屉多准备点零食给研发大佬吧。规则3：页面跳转优先采用navigator组件微信建议页面之间的跳转使用navigator组件目前小程序提供了两种页面路由方式。第一种就是navigator 组件第二种是路由 API包括 navigateTo / redirectTo / switchTab / navigateBack / reLaunch。微信所提倡的是使用 第一种navigator 组件。两种的区别应该就是我骑着自行车和开一辆大奔回丈母娘家开大奔必然要走机动车道走机动车道必然会被摄像头捕捉而骑自行车可以走胡同小道胡同小道难以被摄像头捕捉。第一种更方便微信爬虫捕捉。参考资料：https://developers.weixin.qq.com/community/develop/doc/000a0a1191c3a817e7a9c6f1e51409?page=1#comment-list#专栏作家#动物园园长微信公众号：首席吹牛官人人都是产品经理专栏作家。互联网圈十八线作词人国家一级退堂鼓表演艺术家。颜良而文丑欢迎交流。本文原创发布于人人都是产品经理。未经许可禁止转载题图来自Unsplash基于CC0协议                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    张小龙与其说是“未完成”不如说是“没想好”               小程序中设置缓存过期                                                        原作者: 首席吹牛官                   来自: 人人都是产品经理                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序canvas生成海报 文字自动换行 canvas高度动态设置 ", "author": "                  Rolan                  2020-1-2 00:24                ", "text": "                                                                                                                                                                                     在微信小程序中分享官网只提供分享给好友和群聊的能力未提供分享到朋友圈的api。因此小程序分享到朋友圈通常做法就是利用canvas生成一张动态海报上面贴一个小程序码图片分享到朋友圈长按识别小程序码进入小程序以达到在朋友圈推广小程序的功能。初始化canvas1.在.wxml中 创建一个canvas, canvasWidth 和 canvasWidth 分别为创建的canvas的宽高。比如我们需要保存的海报尺寸为750px * 1350px; 我们就可以设置canvasWidth = 750；canvasWidth = 1350；这样导出来的图片比较清晰。<view class=\"canvas-box\">    <canvas canvas-id=\"canvas\" class=\"canvas\" style=\"width: {{canvasWidth}}px; height: {{canvasHeight}}px;\"></canvas><view>2.在小程序中canvas层级最高。因此我们需要隐藏canvas,在窗口中不可见。.canvas-box{    position: fixed;    top: 1000px;    left: 1000px;    z-index: -10;  }在js中获得canvas上下文const ctx = wx.createCanvasContext('canvas'); // canvas-id绘制图片小程序绘制图片的api比较简单一般可直接使用下面的方式const img = '/assets/images/bg.png';const imgX = 0;      // 绘制图片在canvas中起点X坐标const imgY = 0;      // 绘制图片在canvas中起点Y坐标const imgWidth = 0;  // 绘制图片在canvas中宽度const imgHeight = 0; // 绘制图片在canvas中高度ctx.drawImage(img, imgX, imgY, canvasWidth, canvasHeight);本地图片小程序绘制本地图片可直接使用例如上面的 /assets/images/bg.png' 可直接绘制到canvas上面。网络图片小程序不能直接绘制网络图片到canvas中。1.需要通过 wx.getImageInfo 获取图片信息或 wx.downloadFile 下载到本地。2.获取图片信息。网络图片需先配置download域名才能生效。如果需要绘制微信用户头像也需要将腾讯的域名加入到白名单。这里使用wx.getImageInfo在页面初始化的时候就请求所有需要绘制到canvas的网络图片.const localImgInfo = {}; // 存储所有网络图片请求到本地的对象const imgList = [    img1,  avatar,];  imgList.forEach((item, index) => {    wx.getImageInfo({      src: item,    success: function (res) {        // 保存到本地数组    localImgInfo[item] = res.path;    }    })  })... (确保网络图片加载完毕后)绘制网络图片ctx.drawImage(localImgInfo[avatar], imgX, imgY, canvasWidth, canvasHeight);绘制文字ctx.setFontSize(30);          // 文本字体大小ctx.setFillStyle(\"#E1E6F0\");  // 颜色const text = '我是文字';const textX = 0;  const textY = 0;ctx.fillText(text, textStartX, textY);绘制文字和图片有一个小区别需要注意一下起始的x,y坐标不一致。绘制图片的x,y坐标是从图片的 左上角 开始计算位置的。绘制文字的x,y坐标是从文字的 右下角 开始计算位置的。文字自动换行ctx.measureText() 能够获取canvas中文字的宽度可通过此方法手动给文字换行// 将文字绘制到行 长文本自动换行 并返回行数  /\\*  \\* params  \\* @text 需要绘制的文本字符  \\* @startX 第一行文本的起始X坐标  \\* @startY 第一行文本的起始Y坐标  \\* @lineHeight 文本行高  \\* @MAX\\_WIDTH 单行文字最大宽度超过临界值自动换行  \\*  \\* return rowLength 返回绘制文本的行数  \\* \\*/function drawText(text, startX, startY, lineHeight, MAX\\_WIDTH) {    let allAtr \\= text.split('');    let rowArr \\= \\[\\]; // 拆分出来的每一行    let rowStrArr \\= \\[\\]; // 每一行的文字数组    for (let i \\= 0; i < allAtr.length; i++) {      const currentStr \\= allAtr\\[i\\];    rowStrArr.push(currentStr);    const rowStr \\= rowStrArr.join('');    if (ctx.measureText(rowStr).width \\> MAX\\_WIDTH) {        rowStrArr.pop(); // 删除最后一个    rowArr.push(rowStrArr.join('')); // 完成一行    rowStrArr \\= \\[currentStr\\];    continue;    }      // 最后一个字母 直接添加到一行    if (i \\=== allAtr.length \\- 1) {        rowArr.push(rowStr); // 完成一行    }    }      for (let i \\= 0; i < rowArr.length; i++) {      ctx.fillText(rowArr\\[i\\], startX, startY \\+ i \\* lineHeight);    }    return rowArr.length;  }drawText() 函数主要的作用就是绘制传入的文本使用 ctx.measureText() 判断单行文字的宽度是否超过单行最大宽度如果超过就将ctx绘制文本的startY坐标设置为当前startY+文本行高实现切换到下一行的效果canvas高度动态设置由于项目中生成的海报图片高度随内容变化导致不同的内容生成的海报高度不一致所以这边只需要将canvas的高度放在data中然后根据不同的内容动态计算最终海报的高度然后设置data中canvas的高度即刻。下面是项目中的实际效果在这里海报由三个部分组成头部内容底部。其中头部和底部高度固定中间的内容高度由后台返回的书籍数量决定其中可能需要换行的就是书籍的名称和副标题。这里简单的将每一本书作为一块区域高度固定因此 内容区域的高度 = 书籍数量 * 书籍高度通过此方法简单计算出中间内容区的高度然后动态设置canvas的高度。源码https://github.com/zhaosheng808/canvasPoster提供简单的微信小程序测试号demo包含请求用户保存canvas图片的授权逻辑。测试号需要将不校验合法域名打开不然无法下微信头像和外部图片。正式号需要在微信公众平台配置下载域名                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序使用自定义组件导航实现当前页面高亮               微信小程序长按保存图片                                                        原作者:  ZHAO_                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "手把手教你写一个微信小程序日历组件 ", "author": "                  Rolan                  2019-5-6 00:24                ", "text": "                                                                                                                                                                                     今天我们一起写一个微信小程序日历组件微信小程序日历组件github.com/749264345/w…好我们先看一下要实现的模样如下图由以上截图我们可以看到1.日历可以通过按钮【切换展示效果】改变日历的呈现效果上图是平铺模式下图是收起滚动模式。2.通过点击具体的日期可以在页面上显示当前选中的具体日期。3.点击【今天】快速回到当日视图。4.点击【◀】和【▶】切换月份。上面的四点也是基本的交互需求我们马上开始。首先我们先结构后样式做出最基本的界面结构这边我们把整体结构分成上中下操作显示区星期显示区日期显示区。<view class='calendar'>    <!--显示当前年月日-->    <view class='calendar-title'>        <view class='item ctrl' bindtap='lastMonth'>{{lastMonth}}</view>        <view class='item title'>{{title}}</view>        <view class='item ctrl' bindtap='nextMonth'>{{nextMonth}}</view>        <view class='item ctrl today' bindtap='today'>今天</view>    </view>    <!--星期-->    <view class='calendar-week'>        <view class='item'>{{item}}</view>    </view>    <!--日期-->    <view class='calendar-container'>        <!--上个月占位格子-->        <view class='grid gray'>{{item}}</view>        <!--当月格子-->        <view class='grid'>            <view class=\"wrap\">{{item.date}}</view>        </view>        <!--下个月占位格子-->        <view class='grid gray'>{{item}}</view>    </view></view>复制代码这是我们基本的日历结构机智的小伙伴已经从布局中知道我们实现的大致逻辑了是的我们先获取当月有多少天上月和下月有多少天这样我们的日历就出来了。好慢慢来下面我们详细说我们先写上基本的样式。.calendar {    width: 100%;    text-align: center;    font-size: 30rpx;    box-sizing: border-box;}/* 标题 */.calendar-title {    line-height: 70rpx;    font-size: 30rpx;    text-align: left;    padding: 0 20rpx;    box-sizing: border-box;}.calendar-title .ctrl {    display: inline-block;    padding: 0 20rpx;    background: #f5f5f5;    border-radius: 10rpx;}.calendar-title .item {    display: inline-block;    vertical-align: middle;    line-height: 50rpx;}.calendar-title .title {    min-width: 300rpx;    text-align: center;}.calendar-title .today {    float: right;    margin-top: 10rpx;}/* 星期 */.calendar-week {    display: flex;    text-align: center;    padding: 20rpx 10rpx;    box-sizing: border-box;    border-top: 1rpx solid #e0e0e0;    border-bottom: 1rpx solid #e0e0e0;    background: #f5f5f5;}.calendar-week .item {    flex: 1;}/* 日期 */.calendar-container {    display: flex;    flex-wrap: wrap;    padding: 20rpx 10rpx;    box-sizing: border-box;}.calendar-container .grid {    display: inline-block;    width: 14.28571428571429%;    line-height: 70rpx;    position: relative;    z-index: 1;}.calendar-container .grid.gray {    color: #ccc;}.calendar-container .grid .wrap.select {    background: rgb(49, 120, 228);    border-radius: 10rpx;    color: #fff;    width: 80%;    margin: 0 auto;}复制代码以上我们基本试下了日历的界面下面我们来实现星期和日期的展示。好我们先显示星期我们先在组件中定义一个数组用来遍历显示星期的标题；Component({    properties: {        //星期数组        weekText: {            type: Array,            value: ['周日', '周一', '周二', '周三', '周四', '周五', '周六']        }    },    ...})复制代码我们将星期的标题定义为可配置的模式默认显示如上的文字之后我们可以在组件外自定义个性化显示。于是我们调整下wxml的代码。    <!--遍历星期-->    <view class='calendar-week'>        <view wx:for='{{weekText}}' class='item' wx:key='{{item}}'>{{item}}</view>    </view>复制代码这样我们就能看到我们想要的效果。下面我们开始日期的显示我们先获取当月有几天这里的核心代码是new Date(year, month, date).getDate();由此我们做如下尝试我们如期获得了返回值而当我们传入日期为0时返回了31为当月的全部天数。由于JavaScript中day的范围为1~31中的值所以当设为0时会向前 一天也即表示上个月的最后一天通过这种方式可以得到每个月份的天数。知道了获取当月天数的原理我们还需要知道当月1号是星期几。我们使用如下的方法：new Date(Date.UTC(year, month-1, date)).getDay();我们同样在控制台做出调试；需要注意的是上面的month是实际的月份而下面这个方法需要在实际的月份上减去1。于是我们获取0-6之间的值分别对应周日~周六。值为6是周六值为0是周日。由于日历的第一天是周日周日对应的是0于是传入每月1日返回值为多少就是星期几也就说明当月1日前面空几格。知道了当月就几天当月前面有几天我们做一下算法就可以得出当月后面有几天于是我们建立如下函数：    // 组件的初始数据    data: {        //当月格子        thisMonthDays: [],        //上月格子        empytGridsBefore: [],        //下月格子        empytGridsAfter: [],},methods: {        //获取当月天数        getThisMonthDays: function (year, month) {            return new Date(year, month, 0).getDate();        },        // 绘制当月天数占的格子        createDays: function (year, month) {            let thisMonthDays = [],                days = this.getThisMonthDays(year, month);            for (let i = 1; i <= days; i++) {                thisMonthDays.push({                    date: i,                    dateFormat: this.zero(i),                    monthFormat: this.zero(month),                    week: this.data.weekText[new Date(Date.UTC(year, month - 1, i)).getDay()]                });            }            this.setData({                thisMonthDays            })        },        //获取当月空出的天数        createEmptyGrids: function (year, month) {            let week = new Date(Date.UTC(year, month - 1, 1)).getDay(),                empytGridsBefore = [],                empytGridsAfter = [],                emptyDays = (week == 0 ? 7 : week);            //当月天数            var thisMonthDays = this.getThisMonthDays(year, month);            //上月天数            var preMonthDays = month - 1 < 0                 ? this.getThisMonthDays(year - 1, 12)                 : this.getThisMonthDays(year, month - 1);            //空出日期            for (let i = 1; i <= emptyDays; i++) {                empytGridsBefore.push(preMonthDays - (emptyDays - i));            }            var after = (42 - thisMonthDays - emptyDays) - 7 >= 0                         ? (42 - thisMonthDays - emptyDays) - 7                         : (42 - thisMonthDays - emptyDays);            for (let i = 1; i <= after; i++) {                empytGridsAfter.push(i);            }            this.setData({                empytGridsAfter,                empytGridsBefore            })        },        //补全0        zero: function (i) {            return i >= 10 ? i : '0' + i;        },}复制代码我们同样修改下wxml代码同时我们为上月下月今天三个按钮添加相关事件监听。    <!--显示当前年月日-->    <view class='calendar-title'>        <view class='item ctrl' bindtap='lastMonth'>{{lastMonth}}</view>        <view class='item title'>{{title}}</view>        <view class='item ctrl' bindtap='nextMonth'>{{nextMonth}}</view>        <view class='item ctrl today' bindtap='today'>今天</view>    </view>复制代码<!--上个月占位格子--><view class='grid gray' wx:for='{{empytGridsBefore}}' wx:key='{{item}}'>{{item}}</view><!--当月格子--><view class='grid' wx:for='{{thisMonthDays}}' wx:key='{{indx}}'>   <view class='self' wx:if=\"{{ format === year+'-'+item.monthFormat+'-'+item.dateFormat }}\"></view>   <view class=\"wrap {{ select === year+'-'+item.monthFormat+'-'+item.dateFormat ? 'select' :''}}\" bindtap='select' data-date='{{item.date}}'>{{item.date}}</view></view><!--下个月占位格子--><view class='grid gray' wx:for='{{empytGridsAfter}}' wx:key='{{item}}'>{{item}}</view>复制代码相关的事件监听：//默认选中当天 并初始化组件today: function () {    let DATE = this.data.defaultValue ? new Date(this.data.defaultValue) : new Date(),        year = DATE.getFullYear(),        month = DATE.getMonth() + 1,        date = DATE.getDate(),        select = year + '-' + this.zero(month) + '-' + this.zero(date);    this.setData({        format: select,        select: select,        year: year,        month: month,        date: date,        YEAR: year,        MONTH: month,        DATE: date,    })    //初始化日历组件UI    this.display(year, month, date);    //发送事件监听    this.triggerEvent('select', select);},//上个月lastMonth: function () {    let month = this.data.month == 1 ? 12 : this.data.month - 1;    let year = this.data.month == 1 ? this.data.year - 1 : this.data.year;    //初始化日历组件UI    this.display(year, month, 0);},//下个月nextMonth: function () {    let month = this.data.month == 12 ? 1 : this.data.month + 1;    let year = this.data.month == 12 ? this.data.year + 1 : this.data.year;    //初始化日历组件UI    this.display(year, month, 0);},复制代码代码中我们使用this.display(year, month, 0)为组件统一初始化；同时在today函数中我们添加事件监听函数将选中的日期发送到页面我们通过事件订阅来获取的相关值。<Calendar id=\"Calendar\" bind:select=\"select\"></Calendar>复制代码//组件监听事件select(e) {    this.setData({        selectVal:e.detail    })},复制代码最后我们为切换显示效果的按钮添加事件：    toggleType(){        this.selectComponent('#Calendar').toggleType();    }复制代码组件中对应的方法每当切换展示效果组件都需要初始化        //切换展示        toggleType(){            this.setData({                toggleType: this.data.toggleType == 'mini' ? 'large' :'mini'            })            //初始化日历组件UI            this.display(this.data.year, this.data.month, this.data.date);        },复制代码以上基本上是小程序日历组件实现的基本逻辑介于篇幅太长还有很多实现上的细节不在此一一细说大家可以移步我的github微信小程序日历组件github.com/749264345/w…上文中有不足之处请给出建议或更优的实现方案谢谢~最后祝大家五一快乐~~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    在微信小程序与小游戏中使用 LeanCloud               小程序富文本解析的「伪需求」从wxParse到towxml的坑                                                        原作者: 易在掘金                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序实现A-Z导航的Slidebar ", "author": "                  Rolan                  2019-11-12 00:41                ", "text": "                                                                                                                                                                                     微信小程序实现A-Z导航的Slidebar效果代码slidebar.wxml<view id=\"s-bar\" class=\"slidebar\" bindtouchstart=\"_onTouchStart\" bindtouchmove=\"_onTouchMove\" bindtouchend=\"_onTouchEnd\">  <view wx:for=\"{{data}}\" class=\"slide-item\" id=\"item-{{index}}\" wx:key=\"{{index}}\">    <text class=\"t {{item.selected ? 'slide-item-selected' : ''}}\">{{item.key}}</text>  </view></view><view class=\"dialog\" hidden=\"{{currentKey == '' || closeKeyDialog}}\" animation=\"{{animationData}}\" bindtransitionend=\"_onAnimationend\">  {{currentKey}}</view>slidebar.wxss  /* components/slidebar/slidebar.wxss */.slidebar{  position: absolute;  right: 0rpx;  height: 98vh;  width: 60rpx;  border-radius: 30rpx;}.slide-item{  display: flex;  justify-content: center;  justify-items: center;  height: 3.9vh;  width: 60rpx;  font-size: 24rpx;  color: #222222;  text-align: center;  line-height: 3.9vh;  font-weight: 400;}.slide-item .t{  width: 40rpx;  height: 40rpx;  display: inline-block;}.slide-item-selected{  font-weight: 500;  color: #ffffff;  background: #07C160;  border-radius: 50%;}.dialog{  position: absolute;  top: 50%;  margin-top: -180rpx;  left: 50%;  margin-left: -125rpx;  width: 250rpx;  height: 250rpx;  text-align: center;  font-size: 72rpx;  line-height: 250rpx;  color: #ffffff;  background: grey;  border-radius: 15%;}slidebar.js  // components/slidebar/slidebar.jsComponent({  /**   * 组件的属性列表   */  properties: {    data: {      type: Array,      value: [        { key: \"A\" },        { key: \"B\" },        { key: \"C\" },        { key: \"D\" },        { key: \"E\" },        { key: \"F\" },        { key: \"G\" },        { key: \"H\" },        { key: \"I\" },        { key: \"J\" },        { key: \"L\" },        { key: \"M\" },        { key: \"N\" },        { key: \"O\" },        { key: \"P\" },        { key: \"Q\" },        { key: \"R\" },        { key: \"S\" },        { key: \"T\" },        { key: \"U\" },        { key: \"V\" },        { key: \"W\" },        { key: \"X\" },        { key: \"Y\" },        { key: \"Z\" }      ]    }  },  /**   * 组件的初始数据   */  data: {    selectedIndex: -1,    currentKey: \"\",    closeKeyDialog: false,    animationData: {},  },  lifetimes: {    attached: function () {      // 在组件实例进入页面节点树时执行      this.isTouch = false;    },    ready: function(){      this.data.data.forEach((d,i)=>{        this._wxQueryElementInfo(\"#item-\" + i).then(res => {          d.top = res[0].top;          d.left = res[0].left;          d.height = res[0].height;          d.width = res[0].width;        });      });      this.animation = wx.createAnimation({        duration: 1000,        timingFunction: 'ease',      });    },    detached: function () {      // 在组件实例被从页面节点树移除时执行    },  },  /**   * 组件的方法列表   */  methods: {    _onTouchStart: function(e){      this.isTouch = true;      this.setData({        closeKeyDialog: false,        animationData: this.animation.opacity(1).step().export()      });      this._markSlideItemSeleted(e.touches[0].clientY);    },    _onTouchMove: function(e){      this._markSlideItemSeleted(e.touches[0].clientY);    },    _onTouchEnd: function(e){      this.isTouch = false;      this.setData({        animationData: this.animation.opacity(0).step().export()      })    },    /**     * 通过selector查询元素信息     */    _wxQueryElementInfo: function(selector){      return new Promise((resolve, reject)=>{        var query = wx.createSelectorQuery().in(this);        query.select(selector).boundingClientRect();        query.selectViewport().scrollOffset();        query.exec(function (res) {          resolve(res);        });      });    },    /**     * 根据y的位置标记SlideItem的selected状态     */    _markSlideItemSeleted: function(y){      for(var i=0; i<this.data.data.length; i++){        var d = this.data.data[i];        if (y >= d.top && y <= d.top + d.height) {          if(this.data.selectedIndex == i){            return;          }          this._setSlideItemSelectStatus(d,i);          console.log(\"当前选中=>\" + d.key);          this.triggerEvent(\"selected\",d);          return;        }      }    },    _setSlideItemSelectStatus(d,i){      d.selected = true;      if (this.data.selectedIndex != -1) {        this.data.data[this.data.selectedIndex].selected = false;      }      this.setData({        data: this.data.data,        currentKey: d.key,        selectedIndex: i      });    },    _onAnimationend: function(e){      if (this.isTouch){        return;      }      console.log(\"动画结束\")      this.setData({        closeKeyDialog: true      });    },    /**     * 通过key更新slidebar选择的item     */    updateItemSelectedByKey: function(key){      this.data.data.forEach((d,i)=>{        if(d.key == key){          this._setSlideItemSelectStatus(d,i);          return;        }      });    },    /**     * 通过index更新slidebar选择的item     */    updateItemSelectedByIndex: function(index){      if(index > 0 && index < this.data.data.length){        this._setSlideItemSelectStatus(this.data.data[index], index);      }    }  }})                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)問天地好在                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序swiper组件非居中对称滑动解决方案               当小程序的flex布局遇到button时justify-content不起作用的原因及解决方案 ...                                                        原作者: DrJasonZhang                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "使用Taro小程序框架开发一个学习做题聊天交流的微信小程序 ", "author": "                  Rolan                  2019-11-19 00:41                ", "text": "                                                                                                                                                                                     项目介绍当代大学生上课缺少积极性学习缺乏效率。同为大学生的我深有体会。所以特别开发出这样一款学习类的微信小程序帮助学生进行学习、巩固知识同时增加对战PK模块来加强学生们的学习积极性。这是一个为学生提供在线学习课程、题库练习、考试答题、做题PK、上课签到、资料查阅、成绩分析等功能的微信小程序希望大佬们走过路过给个star~技术选型前端：Taro + 微信小程序 + Echarts后端：Node.js + MySql + websocket其他：七牛云存储项目功能在线学习课程专项题库练习课程考试答题知识趣味竞赛上课签到系统专业资料查阅学生成绩分析运行截图1. 主页2. 个人中心3. 课程详情4. 做题练习5. 学习交流群6. 聊天室7. 课程列表8. 习题列表9. 排行榜10. 论坛项目分析项目采用前后端分离的技术前端采用了Taro微信小程序框架因为本人比较喜欢React所以采用了Taro这款类React语法的框架后端则采用了Node.js,koa2框架。聊天室页面采用websocket来进行连接今天我们首先来聊一聊聊天室使用的小技巧（并不）首先我们的后端数据库采用的是mysql我们建了一个聊天记录的表（萌新勿喷~）1. 后端部分数据库部分我们将所有的聊天记录存放到一张表上方便管理因为我们有多个聊天群组我们该如何区分这些不同的聊天群组呢？答案是通过room_name来区分获取聊天记录的时候就直接查询这个群组名即可这样就不用开很多的表将不同的群聊记录存放到不同的表中啦！同时因为我们的聊天记录内需要存储emoji等信息所以我们需要将数据库的字符集调整为 utf8mb4 -- UTF-8 Unicode 排序规则选择 utf8mb4_unicode_ci 这个可以通过自行百度或者navicat中设置。然后我们将数据表以及字段类型也设置为 utf8mb4 便于存储emoji信息后端处理聊天记录的方法。router.get('/chatlog/:to', async (ctx) => {  const to = ctx.params.to  const response = []  const res = await query(`SELECT * FROM chatlog WHERE room_name = '${to}' ORDER BY current_time DESC`);  res.map((item, index) => {    const { room_name, user_name, user_avatar, current_time, message } = item    response[index] = {      to: room_name,      userName: user_name,      userAvatar: user_avatar,      currentTime: formatTime(current_time),      message,      messageId: `msg${current_time}${Math.ceil(Math.random() * 100)}`    }  })  ctx.response.body = parse(response)})这是获取指定群聊的后端接口to代表的是群组名使用get的方法即可获取到指定群聊的聊天记录啦！继续聊聊我们如何为所有连接到聊天室的网友们发送信息这里我们采用的是广播的方式不同于socket.io内已经封装好广播的方法小程序规定只能使用websocket所以我粗略的封装了一下广播（十分丑陋的代码）let onlineUserSocket = {}let onlineUserInfo = {}const handleLogin = (ws, socketMessage) => {  const { socketId, userName, userAvatar } = socketMessage  onlineUserSocket[socketId] = ws  onlineUserInfo[socketId] = { userName, userAvatar }  ws.socketId = socketId}// 广播消息const broadcast = (message) => {  const { from, userName } = message  Object.values(onlineUserSocket).forEach((socket) => {    socket.send(JSON.stringify({      ...message,      isMyself: userName === onlineUserInfo[socket.socketId].userName    }))  })}我们再登录的时候就将前端传来的消息存入对象中以及他的socket对象然后广播的时候就可以遍历所有的socket对象为所有在线用户广播消息其中的 isMyself 代表的是否为本人例如我发的消息自己的socket对象接受广播的时候就是 true 。别人的就是 false 这样做是为了方便区分自己的聊天消息和被人的聊天消息2. 前端部分接下来聊聊前端的聊天室部分handleSocketMessage(): void {    const { socketTask } = this    socketTask.onMessage(async ({ data }) => {      const messageInfo: ReceiveMessageInfo = JSON.parse(data)      const { to, messageId, isMyself, userName, userAvatar, currentTime, message } = messageInfo      const time: string = formatTime(currentTime)      this.messageList[to].push({        ...messageInfo,        currentTime: time      })      /* 设置群组最新消息 */      this.contactsList.filter(contacts => contacts.contactsId === to)[0].latestMessage = {        userName, message, currentTime: time      }      this.scrollViewId = isMyself ? messageId : ''      await Taro.request({        url: 'http://localhost:3000/chatlog',        method: 'PUT',        data: {          to,          userName,          userAvatar,          currentTime,          message,        }      })    })  }我们先接受消息然后先更新指定群组名的聊天群组的聊天记录然后再使用 PUT 的方式访问接口添加聊天记录到数据库中。可以看到我们的聊天记录是分为左边以及右边的自己发的消息即为右边我们可以通过简单的flex布局来实现// 这里是覆盖默认样式显示自己消息的样式.myself {  justify-content: flex-end;  .avatar {    order: 1;  }  .info {    display: flex;    flex-direction: column;    align-items: flex-end;    .header {      justify-content: flex-end;      .username {        order: 1;        margin-right: 0 !important;        margin-left: .5em;      }    }    .content {      color: #333 !important;      border: #e7e7e7 1px solid;      background: #fff !important;      box-shadow: 0 8px 20px -8px #d7d7d7;    }  }}// 以下是默认样式就是左边的样式.message-wrap {  display: flex;  margin: 20px 0;  .avatar {    width: 14vw;    height: 14vw;    margin: 10px;    border-radius: 50%;    background-image: linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%);  }  .info {    .header {      display: flex;      align-items: center;      max-width: 40vw;      padding: 10px 0;      color: #666;      font-size: .8em;      .username {        overflow: hidden;        text-overflow: ellipsis;        white-space: nowrap;        max-width: 40vw;        margin-right: .5em;        color: #555;        font-size: 1.2em;        font-weight: bold;      }    }    .content {      display: inline-block;      max-width: 60vw;      padding: 10px 20px;      color: #fff;      word-break: break-all;      border-radius: 20px;      background: #66a6ff;    }  }}最后我们聊一下websocket的断线重连handleSocketClose(): void {    const { socketTask } = this    socketTask.onClose((msg) => {      this.socketTask = null      this.socketReconnect()      console.log('onClose: ', msg)    })  }  handleSocketError(): void {    const { socketTask } = this    socketTask.onError(() => {      this.socketTask = null      this.socketReconnect()      console.log('Error!')    })  }我们这里先监听一下websocket关闭或者异常的情况调用重连方法以及清空socketTask的对象接下来是重连的方法socketConnect() {    // 生成随机特有的socketId    this.generateSocketId()    /* 使用then的方法才能正确触发onOpen的方法暂时不知道原因 */    Taro.connectSocket({      url: 'ws://localhost:3000',    }).then(task => {      this.socketTask = task      this.handleSocketOpen()      this.handleSocketMessage()      this.handleSocketClose()      this.handleSocketError()    })  }  socketReconnect(): void {    this.isReconnected = true    clearTimeout(this.timer)    /* 3s延迟重连减轻压力 */    this.timer = setTimeout(() => {      this.socketConnect()    }, 3000)  }我们每三秒调用一遍socket连接的方法重新再设置好socketId以及socketTask重新监听各种方法。这里有一个奇特的地方就是Taro的connectSocket方法不能使用 async/await 的方法来获取socketTask也就是说不能这样 const socketTask = await Taro.connectSocket({...}) 来获取socketTask只能通过then的方法才能获取到卑微的我暂时不知道如何解决这个问题......具体后续请关注一下我的github将持续更新项目！猛戳~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    简单说说微信小程序的底层原理               开发|微信小程序与tensorflow.js准备工作                                                        原作者:  zhcxk1998                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序技能进阶回忆录 - globalData 的那些事儿 ", "author": "                  Rolan                  2019-10-24 00:38                ", "text": "                                                                                                                                                                                     小程序中除了每个页面有自己的 data还有个全局数据存储地方：globalData获取方式如下：let globalData = getApp().globalData复制代码实际业务代码中总会遇到这种情况：写着写着发现需要用全局数据但是不能直接就在当前函数里直接写上面的一段代码因为要和别的函数共用所以返回 js 文件顶部添加一段代码再返回刚刚断掉的地方继续写类似这样：// 省略12行let globalData = getApp().globalData// 省略15行Page({  data: { ... }  //.. 省略863行  onButtonTap(e) {    // ...    let myData = globalData.myData    // ...  }})复制代码经过这么一折腾可能刚刚的代码思路都没了。那能不能直接在想用的函数里直接方便的获取这个 globalData 呢？比如：// 省略27行Page({  data: { ... }  //.. 省略863行  onButtonTap(e) {    // ...    let myData = this.globalData.myData    // ...  }})复制代码或者换种方式获取和设置 myData：let myData = this.$global('myData')// ...this.$global('myData', 2)复制代码实现 global 方法function global(name, value) {  var globalData = getApp().globalData  var data = {}  // this.$global()  if (arguments.length === 0) {    return globalData  }  // this.$global('myData')  if (arguments.length === 1) {    if (is.string(name)) {      return globalData[name]    }    // this.$global({    //   name: 1    // })    if (is.object(name)) {      data = name    }  }  // this.$global('myData', 2)  if (arguments.length === 2) {    data[name] = value  }  return extend(data, data)}复制代码其中is.string 和 is.object 是类型判断函数。简单实现了多种操作 globalData 的方法详细见注释。挂载到 this函数有了那么怎么挂在到小程序页面的 this 中呢看过前几篇可能知道要对小程序原有的 Page 函数进行改造。有两种方式一种是直接添加到 config 里：var originPage = Pagevar global = require('../utils/global')function MyPage(config) {  // ...  config.$global = global  // ...  originPage(config)}function page (config) {  return new MyPage(config)}复制代码或者在代理后的 onLoad 函数里定义：var originPage = Pagevar global = require('../utils/global')function MyPage(config) {  this.watch = config.watch  this.lifetimeBackup = {    onLoad: config.onLoad  }  config.onLoad = function(options) {    this.$global = global    // 其他代码    this.lifetimeBackup.onLoad.call(this, options)  }    // ...  originPage(config)}复制代码总结利用这种方式可以定义很多通用的小程序页面的方法比如在摩拜小程序内部封装了 this.$util、this.$navigate等适合自身业务的工具方法等。传送门小程序技能进阶回忆录 - 也许你并不需要小程序框架小程序技能进阶回忆录 - 在缺少组件化的日子里小程序技能进阶回忆录 - 如何自主实现数据侦听器和计算器小程序技能进阶回忆录 - 如何自主实现拦截器小程序技能进阶回忆录 - globalData 的那些事儿小程序技能进阶回忆录 - 什么时候执行 onLoad（待发布）小程序技能进阶回忆录 - 增强型的 wx.navigateBack（待发布）广告时间美团单车事业部（摩拜单车）诚招前端 / 小程序研发工程师位置北京有兴趣可以发简历到 zhangshibing@mobike.com ）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)天下钞票                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    实战分享: 小程序云开发玩转订阅消息               从 WeRequest 登陆态管理来聊聊业务代码 原 荐                                                        原作者: 摩拜单车前端团队                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序后端开发流程 ", "author": "                  Rolan                  2019-11-13 00:42                ", "text": "                                                                                                                                                                                     1、前端调用 wx.login 返回了code然后调用wx.getUserInfo获取到用户的昵称 头像 2、服务端根据code去微信获取openid 接口地址： developers.weixin.qq.com/miniprogram…微信小程序后端接口开发controller层public class OauthController {    @Autowired    private WeChatService weChatService;    /**     * 微信授权用js_code换取openId     * @param code     * @return     */    @GetMapping(\"/code2Session\")    public BaseResponse code2Session(String code) {        log.info(\"code2Session,code={}\", code);        if (StringUtil.isEmpty(code)) {            return BaseResponse.buildFail(\"参数异常\");        }        Code2SessionResponse res = weChatService.code2Session(code);        log.info(\"code2Session,res={}\", res);        if (!res.isSuccess()) {            return BaseResponse.buildFail(res.getErrCode(), res.getErrMsg());        }        return BaseResponse.buildSuccess(res);    } /**     * 解密获取手机号     * @param request     * @param response     * @param param     * @return     */    public BaseResponse decryptGetPhone(HttpServletRequest request, HttpServletResponse response,                                    @RequestBody OauthParam param) {               if (!StringUtil.isEmpty(param.getOpenId())) {//微信授权登录                String sessionKey = weChatService.getSessionKey(param.getOpenId());                if (StringUtil.isEmpty(sessionKey)) {                    return BaseResponse.buildFail(\"会话不存在\");                }                Sha1Utils sha = new Sha1Utils();                // 获取用户信息                log.debug(\"微信登陆 sessionKey = {}\", sessionKey);                String userInfoStr = sha.decryptWXAppletInfo(sessionKey, param.getEncryptedData(), param.getIv());                if (StringUtil.isEmpty(userInfoStr)) {                    return BaseResponse.buildFail(\"无法获取用户信息\");                }                JSONObject json = JSONObject.parseObject(userInfoStr);                //绑定微信的手机号                String tel = json.getString(\"purePhoneNumber\");                Assert.isTrue(!StringUtils.isEmpty(tel), \"无法获取用户手机号\");                BaseResponse baseResponse=new BaseResponse();                baseResponse.setResultInfo(tel);                baseResponse.setState(0);                return baseResponse;            }    }}复制代码接口public interface WeChatService {    /**     * 用code换取openid     *     * @param code     * @return     */    Code2SessionResponse code2Session(String code);    /**     * 获取凭证     *     * @return     */    String getAccessToken();    /**     * 获取凭证     *     * @param isForce     * @return     */    String getAccessToken(boolean isForce);    String getSessionKey(String openId);}复制代码实现类public class WeChatServiceImpl implements WeChatService {    //获取配置文件数据    @Value(\"${wechat.miniprogram.id}\")    private String appId;    @Value(\"${wechat.miniprogram.secret}\")    private String appSecret;    @Reference    private SysUserService sysUserService;    @Override    public Code2SessionResponse code2Session(String code) {        String rawResponse = HttpClientUtil                .get(String.format(WechatConstant.URL_CODE2SESSION, appId, appSecret, code));        log.info(\"rawResponse====={}\", rawResponse);        Code2SessionResponse response = JSON.parseObject(rawResponse, Code2SessionResponse.class);        if (response.isSuccess()) {            cacheSessionKey(response);        }        return response;    }    private void cacheSessionKey(Code2SessionResponse response) {        RedisCache redisCache = RedisCache.getInstance();        String key = RedisCacheKeys.getWxSessionKeyKey(response.getOpenId());        redisCache.setCache(key, 2147483647, response.getSessionKey());    }    @Override    public String getAccessToken() {        return getAccessToken(false);    }    @Override    public String getAccessToken(boolean isForce) {        RedisCache redisCache = RedisCache.getInstance();        String accessToken = null;        if (!isForce) {            accessToken = redisCache.getCache(RedisCacheKeys.getWxAccessTokenKey(appId));        }        if (StringUtil.isNotEmpty(accessToken)) {            return accessToken;        }        String rawResponse = HttpClientUtil                .get(String.format(WechatConstant.URL_GET_ACCESS_TOKEN, appId, appSecret));        AccessTokenResponse response = JSON.parseObject(rawResponse, AccessTokenResponse.class);        log.info(\"getAccessToken:response={}\", response);        if (response.isSuccess()) {            redisCache.setCache(RedisCacheKeys.getWxAccessTokenKey(appId), 7000, response.getAcessToken());            return response.getAcessToken();        }        return null;    }    @Override    public String getSessionKey(String openId) {        RedisCache redisCache = RedisCache.getInstance();        String key = RedisCacheKeys.getWxSessionKeyKey(openId);        String sessionKey = redisCache.getCache(key);        return sessionKey;    }}复制代码用到的解密工具类public class Sha1Utils {    public static String decryptWXAppletInfo(String sessionKey, String encryptedData, String iv) {        String result = null;        try {            byte[] encrypData = Base64.decodeBase64(encryptedData);            byte[] ivData = Base64.decodeBase64(iv);            byte[] sessionKeyB = Base64.decodeBase64(sessionKey);            AlgorithmParameterSpec ivSpec = new IvParameterSpec(ivData);            Cipher cipher = Cipher.getInstance(\"AES/CBC/PKCS5Padding\");            SecretKeySpec keySpec = new SecretKeySpec(sessionKeyB, \"AES\");            cipher.init(Cipher.DECRYPT_MODE, keySpec, ivSpec);            byte[] doFinal = cipher.doFinal(encrypData);            result = new String(doFinal);            return result;        } catch (Exception e) {            //e.printStackTrace();            log.error(\"decryptWXAppletInfo error\",e);        }        return null;    }}复制代码网络请求工具类public class HttpClientUtil {    // utf-8字符编码    public static final String                        CHARSET_UTF_8          = \"utf-8\";    // HTTP内容类型。    public static final String                        CONTENT_TYPE_TEXT_HTML = \"text/xml\";    // HTTP内容类型。相当于form表单的形式提交数据    public static final String                        CONTENT_TYPE_FORM_URL  = \"application/x-www-form-urlencoded\";    // HTTP内容类型。相当于form表单的形式提交数据    public static final String                        CONTENT_TYPE_JSON_URL  = \"application/json;charset=utf-8\";    // 连接管理器    private static PoolingHttpClientConnectionManager pool;    // 请求配置    private static volatile RequestConfig requestConfig;    private static CloseableHttpClient getNewHttpClient() {        CloseableHttpClient httpClient = HttpClients.custom()            // 设置连接池管理            .setConnectionManager(pool)            // 设置请求配置            .setDefaultRequestConfig(getRequestConfig())            // 设置重试次数            .setRetryHandler(new DefaultHttpRequestRetryHandler(0, false)).build();        return httpClient;    }    /**     * 发送 post请求     *     * @param httpUrl     *            地址     */    public static String post(String httpUrl) {        // 创建httpPost        HttpPost httpPost = new HttpPost(httpUrl);        return request(httpPost);    }    public static byte[] postRaw(String httpUrl) {        // 创建httpPost        HttpPost httpPost = new HttpPost(httpUrl);        return requestRaw(httpPost);    }    /**     * 发送 get请求     *     * @param httpUrl     */    public static String get(String httpUrl) {        // 创建get请求        HttpGet httpGet = new HttpGet(httpUrl);        return request(httpGet);    }    /**     * 发送 post请求（带文件）     *     * @param httpUrl     *            地址     * @param maps     *            参数     * @param fileLists     *            附件     */    public static String post(String httpUrl, Map<String, String> maps, List<File> fileLists,                              String fileName) {        HttpPost httpPost = new HttpPost(httpUrl);// 创建httpPost        MultipartEntityBuilder meBuilder = MultipartEntityBuilder.create();        if (maps != null) {            for (String key : maps.keySet()) {                meBuilder.addPart(key, new StringBody(maps.get(key), ContentType.TEXT_PLAIN));            }        }        if (fileLists != null) {            for (File file : fileLists) {                FileBody fileBody = new FileBody(file);                meBuilder.addPart(fileName, fileBody);            }        }        HttpEntity reqEntity = meBuilder.build();        httpPost.setEntity(reqEntity);        return request(httpPost);    }    public static String post(String httpUrl, Map<String, String> maps, List<File> fileLists) {        return post(httpUrl, maps, fileLists, \"file\");    }    public static String post(String httpUrl, List<File> fileLists) {        return post(httpUrl, Collections.emptyMap(), fileLists, \"file\");    }    /**     * 发送 post请求     *     * @param httpUrl     *            地址     * @param params     *            参数(格式:key1=value1&key2=value2)     *     */    public static String post(String httpUrl, String params) {        HttpPost httpPost = new HttpPost(httpUrl);// 创建httpPost        try {            // 设置参数            if (params != null && params.trim().length() > 0) {                StringEntity stringEntity = new StringEntity(params, \"UTF-8\");                stringEntity.setContentType(CONTENT_TYPE_FORM_URL);                httpPost.setEntity(stringEntity);            }        } catch (Exception e) {            e.printStackTrace();        }        return request(httpPost);    }    /**     * 发送 post请求     *     * @param maps     *            参数     */    public static String post(String httpUrl, Map<String, String> maps) {        String param = convertStringParamter(maps);        return post(httpUrl, param);    }    /**     * 发送 post请求 发送json数据     *     * @param httpUrl     *            地址     * @param content     *     *     */    public static String post(String httpUrl, String content, String contentType) {        //        HttpPost httpPost = new HttpPost(httpUrl);// 创建httpPost        //        try {        //            // 设置参数        //            if (StringUtils.isNotEmpty(content)) {        //                StringEntity stringEntity = new StringEntity(content, \"UTF-8\");        //                stringEntity.setContentType(contentType);        //                httpPost.setEntity(stringEntity);        //            }        //        } catch (Exception e) {        //            e.printStackTrace();        //        }        //        return request(httpPost);        return new String(postRaw(httpUrl, content, contentType), StandardCharsets.UTF_8);    }    public static byte[] postRaw(String httpUrl, String content, String contentType) {        HttpPost httpPost = new HttpPost(httpUrl);// 创建httpPost        try {            // 设置参数            if (StringUtils.isNotEmpty(content)) {                StringEntity stringEntity = new StringEntity(content, \"UTF-8\");                stringEntity.setContentType(contentType);                httpPost.setEntity(stringEntity);            }        } catch (Exception e) {            e.printStackTrace();        }        return requestRaw(httpPost);    }    /**     * 发送 post请求 发送json数据     *     * @param httpUrl     *            地址     * @param paramsJson     *            参数(格式 json)     *     */    public static String postJson(String httpUrl, String paramsJson) {        return post(httpUrl, paramsJson, CONTENT_TYPE_JSON_URL);    }    public static byte[] postJsonRaw(String httpUrl, String paramsJson) {        return postRaw(httpUrl, paramsJson, CONTENT_TYPE_JSON_URL);    }    /**     * 发送 post请求 发送xml数据     *     * @param url   地址     * @param paramsXml  参数(格式 Xml)     *     */    public static String postXml(String url, String paramsXml) {        return post(url, paramsXml, CONTENT_TYPE_TEXT_HTML);    }    /**     * 将map集合的键值对转化成：key1=value1&key2=value2 的形式     *     * @param parameterMap     *            需要转化的键值对集合     * @return 字符串     */    public static String convertStringParamter(Map parameterMap) {        StringBuilder parameterBuffer = new StringBuilder();        if (parameterMap != null) {            Iterator iterator = parameterMap.keySet().iterator();            String key = null;            String value = null;            while (iterator.hasNext()) {                key = (String) iterator.next();                if (parameterMap.get(key) != null) {                    value = (String) parameterMap.get(key);                } else {                    value = \"\";                }                parameterBuffer.append(key).append(\"=\").append(value);                if (iterator.hasNext()) {                    parameterBuffer.append(\"&\");                }            }        }        return parameterBuffer.toString();    }    /**     * 发送请求     *     * @param request     * @return     */    public static byte[] requestRaw(HttpRequestBase request) {        CloseableHttpClient httpClient;        CloseableHttpResponse response = null;        // 响应内容        //        String responseContent = null;        byte[] rawResponse = null;        try {            // 创建默认的httpClient实例.            httpClient = getNewHttpClient();            // 配置请求信息            request.setConfig(requestConfig);            // 执行请求            response = httpClient.execute(request);            // 得到响应实例            HttpEntity entity = response.getEntity();            // 可以获得响应头            // Header[] headers = response.getHeaders(HttpHeaders.CONTENT_TYPE);            // for (Header header : headers) {            // System.out.println(header.getName());            // }            // 得到响应类型            // System.out.println(ContentType.getOrDefault(response.getEntity()).getMimeType());            // 判断响应状态            if (response.getStatusLine().getStatusCode() >= 300) {                throw new Exception(\"HTTP Request is not success, Response code is \"                                    + response.getStatusLine().getStatusCode());            }            if (HttpStatus.SC_OK == response.getStatusLine().getStatusCode()) {                rawResponse = EntityUtils.toByteArray(entity);                //                responseContent = EntityUtils.toString(entity, CHARSET_UTF_8);                EntityUtils.consume(entity);            }        } catch (Exception e) {            e.printStackTrace();        } finally {            try {                // 释放资源                if (response != null) {                    response.close();                }            } catch (IOException e) {                e.printStackTrace();            }        }        return rawResponse;    }    private static String request(HttpRequestBase req) {        return new String(requestRaw(req), StandardCharsets.UTF_8);    }    private static RequestConfig getRequestConfig() {        if (requestConfig == null) {            synchronized (HttpClientUtil.class) {                if (requestConfig == null) {                    try {                        //System.out.println(\"初始化HttpClientTest~~~开始\");                        SSLContextBuilder builder = new SSLContextBuilder();                        builder.loadTrustMaterial(null, new TrustSelfSignedStrategy());                        SSLConnectionSocketFactory sslsf = new SSLConnectionSocketFactory(                            builder.build());                        // 配置同时支持 HTTP 和 HTPPS                        Registry<ConnectionSocketFactory> socketFactoryRegistry = RegistryBuilder                            .<ConnectionSocketFactory> create()                            .register(\"http\", PlainConnectionSocketFactory.getSocketFactory())                            .register(\"https\", sslsf).build();                        // 初始化连接管理器                        pool = new PoolingHttpClientConnectionManager(socketFactoryRegistry);                        // 将最大连接数增加到200实际项目最好从配置文件中读取这个值                        pool.setMaxTotal(200);                        // 设置最大路由                        pool.setDefaultMaxPerRoute(2);                        // 根据默认超时限制初始化requestConfig                        int socketTimeout = 10000;                        int connectTimeout = 10000;                        int connectionRequestTimeout = 10000;                        requestConfig = RequestConfig.custom()                            .setConnectionRequestTimeout(connectionRequestTimeout)                            .setSocketTimeout(socketTimeout).setConnectTimeout(connectTimeout)                            .build();                    } catch (NoSuchAlgorithmException e) {                        e.printStackTrace();                    } catch (KeyStoreException e) {                        e.printStackTrace();                    } catch (KeyManagementException e) {                        e.printStackTrace();                    }                    // 设置请求超时时间                    requestConfig = RequestConfig.custom().setSocketTimeout(50000)                        .setConnectTimeout(50000).setConnectionRequestTimeout(50000).build();                }            }        }        return requestConfig;    }}复制代码常量public interface WechatConstant {    Integer OK_STATUS            = 0;    String  URL_CODE2SESSION     = \"https://api.weixin.qq.com/sns/jscode2session?appid=%s&secret=%s&js_code=%s&grant_type=authorization_code\";    String  URL_GET_ACCESS_TOKEN     = \"https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=%s&secret=%s\";    String URL_GET_IMAGE = \"http://file.api.weixin.qq.com/cgi-bin/media/get?access_token=%s&media_id=%s\";            /**     * 给公众号发送信息。参考https://mp.weixin.qq.com/advanced/tmplmsg?action=faq&token=708366329⟨=zh_CN     */    String  URL_SEND_TO_CHANNEL  = \"https://api.weixin.qq.com/cgi-bin/message/template/send?access_token=%s\";    String  URL_SEND_MESSAGE     = \"https://api.weixin.qq.com/cgi-bin/message/custom/send?access_token=%s\";        /**     * 发送模板消息。参考https://developers.weixin.qq.com/miniprogram/dev/api-backend/sendMiniTemplateMessage.html     */    String URL_SEND_TEMPLATE_MESSAGE = \"https://api.weixin.qq.com/cgi-bin/message/wxopen/template/send?access_token=%s\";    String  URL_QR_CODE_UNLIMTED = \"https://api.weixin.qq.com/wxa/getwxacodeunlimit?access_token=%s\";        String  URL_QR_CODE = \"https://api.weixin.qq.com/wxa/getwxacode?access_token=%s\";    /**     * 获取标签下粉丝列表     */    String URL_ALL_FANS_OPENID = \"https://api.weixin.qq.com/cgi-bin/user/tag/get?access_token=%s\";    /**     * 获取公众号已创建的标签     */    String URL_ALL_TAGS = \"https://api.weixin.qq.com/cgi-bin/tags/get?access_token=%s\";}复制代码使用到的实体类public class Code2SessionResponse implements Serializable {    public static Integer RESPONSE_OK = 0;    @JSONField(name = \"openid\")    private String       openId;    @JSONField(name = \"session_key\")    private String       sessionKey;    @JSONField(name = \"unionid\")    private String       unionId;    @JSONField(name = \"errcode\")    private Integer      errCode;    @JSONField(name = \"errmsg\")    private String      errMsg;    public boolean isSuccess() {        return this.errCode == null || RESPONSE_OK.equals(this.errCode);    }}复制代码总结：微信小程序的后端开发主要就是对用户进行授权  1、前端调用 wx.login 返回了code然后调用wx.getUserInfo获取到用户的昵称 头像 2.首先通过微信授权用js_code换取openId来获取openId前端传微信的参数 code字段 3.然后解密获取手机号 前端需要传openId encryptedData iv 等字段来获取用户的的授权手机号这些信息都获取后 接着就是调用后端的登陆接口登陆接口如果只有授权登录就是我们将接口参数为下图最后三个字段为前端必填字段主要步骤是根据前端的openId获取sessionKey 然后根据sessionKey 和其他参数进行解密获取用户手机号通过解密获取授权登录的手机号然后根据自己的业务逻辑处理即可这样我们就可以根据授权的手机号进行授权登录                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序实现去抖音视频水印               开始你的uniapp之旅:写出你的第一个微信小程序                                                        原作者:  CoderZS                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序生成海报代码分享 ", "author": "                  Rolan                  2019-6-24 00:26                ", "text": "                                                                                                                                                                                     今天下午花了一下午时间把之前项目添加了对海报生成的支持,本代码已提交到微信已通过审核已发布已经过本人验收以下功能可用需要的同学可以移步下面链接https://gitee.com/jgl1210/eas...本代码实现功能1、海报上添加图片2、海报上添加文字3、海报下载4、海报保存到本地                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序框架原理综合分析和 fard 的新思路               微信小程序自定义组件boundingClientRect获取到的rect值为null                                                        原作者:  小时光                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发早知道 ", "author": "                  Rolan                  2019-4-4 00:24                ", "text": "                                                                                                                                                                                     小程序没有跳转公众号、跳转公众号图文素材的能力。除非用户通过扫描二维码进入小程序的情景可以显示关注公众号组件。公众号菜单、公众号图文素材可以打开小程序网页无法直接打开小程序。小程序内嵌网页、内嵌网页中跳转链接、iframe 嵌套的页面都必须在安全域名内否则无法访问。如果想在小程序内加入第三方广告要注意这点因为安全域名修改是有次数限制的并要求验证服务器。还要注意网页中嵌套 iframe 的情况例如网页内嵌了腾讯视频 iframe由于腾讯视频不在安全域名内会造成页面无法访问。用户信息授权、手机号码授权需要用户通过点击操作。小程序间跳转需要用户点击操作跳转前需要用户确认可跳转小程序数量不超过10个。小程序分为开发版、体验版、审核版、线上版：开发版是开发工具编辑过的最新版本；开发工具上传后成为体验版具备体验权限的用户都可以查看；将开发版提交给官方审核后成为审核版；审核成功后才可以发布成为线上版本。官方「小程序助手」小程序可以很方便打开各版本小程序。每次发布新版本用户都需要重新下载新版本。小程序仍在不断更新和完善旧代码可能会因不符合新政策在下次发布的时候无法正常运行。为避免这种情况的发生应多关注官方公告。版本回退功能可以将线上版本回退成上一个版本小程序使用 CommonJS 规范对 ES6 有很好的支持小程序没有官方状态管理工具页面间通讯靠 query string 传递参数。如果有复杂状态管理的需求的话建议引入一些设计模式或使用第三方框架。用户微信支付后需要后台推送消息到服务器才能确认支付成功。小程序的 DOM 操作只能查询属性无法设置属性。小程序基础库版本与微信版本有关 基础库版本与客户端版本对应关系 。小程序也存在兼容性问题对待不愿更新微信的用户要像对待忠实的IE6用户一样 小程序基础库版本分布 。小程序页面只有 onLoad、onShow、onReady、onHide、onUnload 生命周期没有更新视图相关的生命周期小程序不能直接渲染 HTML string要用 rich-text 组件但组件使用 HTML string 性能会有所下降。小程序有很多原生组件如 Vedio、Map。原生组件位于最上层会遮挡所有非原生组件还存在诸多限制如无法改变大小、无法添加动画效果等等。不过有些组件在最新版本已经可以同层渲染了。小程序不支持摇一摇功能但可以通过监听加速度传感器来实现。小程序有官方的广告组件广告收入官方会抽走一部分。想到再更欢迎补充.                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序框架的简单封装               [博客小程序]评论通知功能实现(一)——小程序发送模板消息的几种实现 ...                                                        原作者:  notebin                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "你期待的微信小程序表格组件来咯 ", "author": "                  Rolan                  2019-10-17 00:32                ", "text": "                                                                                                                                                                                     背景在做H5开发中表格table是最常见的标签如此好用的标签在微信小程序中却没有无奈叹息绝望！！！奔着利国利猿的使命我*开始了造轮之路。功能主要用于展示大量结构化数据。支持分页自定义操作长表格宽表格滚动等功能。实现前言暴露必要属性例如表头数据。支持外部样式控制表格。手机端的列表较轻暂时不需要暴露事件。细节通过properties暴露了三个属性官方说明Component({  properties: {       list: {  // 表格数据      type: Array,      value: []    },    headers: {  //表头      type: Array,      value: []    },    hasBorder: {  // 表格中间边框      type: String,      value: \"no\"    },     height: { //table的高度      type: Number || String,      value: ''    },    width: {      type: Number,      value: 0    },    tdWidth: {      type: Number,      value: 35    }        }})通过externalClasses支持外部样式官方说明/*s-class-header // 外部定义表头样式s-class-row  // 外部定义行数据样式*/Component({  externalClasses: ['s-class-header', 's-class-row']})index.wxml文件通过嵌套循环动态渲染表格<view class=\"table table-noborder\">    <view class=\"tr thead s-class-header\">      <view wx:for=\"{{headers}}\" class=\"td td-{{hasBorder}}border\">{{item.display}}</view>        </view>    <block wx:for-item='i' wx:for=\"{{list}}\">      <view class=\"tr s-class-row\">        <view wx:for-item='j' wx:for=\"{{headers}}\" class=\"td td-{{hasBorder}}border\">{{i[j['text']]}}</view>              </view>    </block>  </view>index.wxss 使用者对于很个性的样式可以自行修改源代码index.wxss文件.table {  border: 1px solid #ccc;  font-size: 28rpx;  background: #fff;    border-right:none;}.table-noborder {  border-right:1rpx solid #ccc;} .tr{  display: flex;} .td {  text-align: center;  border: 1px solid #ccc;  display: inline-block;    border-bottom: none;  flex: 1;  padding: 16rpx;    border-left: none;}.td-noborder{    border-right: none;} .thead .td{  border-top: none;  padding: 16rpx;  font-weight: bold;}#### 快速上手.json文件引入组件 {  \"usingComponents\": {    \"s-table\": \"实际路径/table/index\"  }} index.wxml 文件使用组件<s-table hasBorder='no' width='200' tdWidth='100' height='200' s-class-header='my-class' s-class-row='my-class-row' headers='{{headers}}' list='{{row}}'></s-table>完整源代码和使用说明见githubgithub地址更多更好的组件持续更新中...                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序 input 数据双向绑定实现方法之一               如何实现微信小程序换头像？三步帮你搞定！                                                        原作者:  s249359986                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "如何使用不到50行代码实现一个小而美的依赖收集库？ ", "author": "                  Rolan                  2019-12-2 00:02                ", "text": "                                                                                                                                                                                     现代web开发大多数都遵循着视图与逻辑分离的开发原则一反面使得代码更加易懂且易扩展另一方面带来的问题就是如何优雅的管理数据。因而社区诞生了很多优秀的状态管理库比如为React而生的 Redux 专为 Vue 服务的 Vuex 还有不限定框架的 Mobx 等等。在为使用这些库提升开发效率而叫好的同时我觉得我们也应该从内部去真正的了解它们的核心原理就比如今天这篇文章的主题 依赖收集 就是其中的一个很大的核心知识。这篇文章将会带您一步一步的以最少的代码去实现一个小而美的依赖收集库同时给您展现如何将这个库运用到小程序中去实现跨页面的状态共享。二 实现过程1. 基本原理依赖收集的基本原理可以概括为以下3步：创建一个可观察（observable）对象视图或者函数（effect）引用这个对象的某个属性触发依赖收集改变数据视图或者函数自动更新或运行我们要实现的例子：import { observable, observe } from \"micro-reaction\";const ob = observable({    a: 1});observe(() => console.log(ob.a));// logs: 1// logs: 2ob.a = 2;复制代码下面开始我将一步一步的进行实现过程讲解2. 创建一个可观察对象首先我们需要创建一个可观察对象其本质就是将传入的对象进行代理并且返回这个代理对象这里我们使用 es6 的 Proxy 来修改对象的一些行为从而实现在返回真正对象前作一些拦截操作。我们定义了一个名叫 observable 方法来代理对象代码如下：export function observable(obj = {}) {    return createObservable(obj)}function createObservable(obj) {    const proxyObj = new Proxy(obj, handlers());    return proxyObj}复制代码可以看到 observable 方法内部就是通过 new Proxy（obj,handler） 生成一个代理对象传参分别是原始对象和代理操作方法 handlers  handlers 返回一个对象定义了对象的原始方法例如 get 、 set 通过重新定义这两个方法我们可以修改对象的行为从而完成代理操作我们来看看 handlers 方法。function handlers() {    return {        get: (target, key, receiver) => {            const result = Reflect.get(target, key, receiver);            return result        },        set: (target, key, value, receiver) => {            const result = Reflect.set(target, key, value, receiver);            return result        }    }}复制代码如上我们在 get 和 set 方法里面没有做任何操作取值赋值操作都是原样返回。3. 关联副作用函数effect完成了对数据的初始定义我们明确下我们的目的我们的最终目的是数据改变副作用函数 effect 自动运行而这其中的关键就是必须有个地方引用我们创建的代理对象从而触发代理对象内部的 get 或者 set 方法方便我们在这两个方法内部做一些依赖收集和依赖执行的工作。因而这里我们定义了一个 observe 方法参数是一个 Function 我们先看看这个方法的实现：export function observe(fn) {    <!--这一行可以先忽略后面会有介绍-->    storeFns.push(fn);    <!--Reflect.apply()就相当于fn.call(this.arguments)-->    Reflect.apply(fn, this, arguments)}复制代码可以看到内部执行了传入的函数而我们传入的函数是 () => console.log(ob.a.b) 函数执行输出 ob.a 引用了代理对象的 a 属性值就触发了代理对象内部的 get 方法。 在 get方法内部我们就可以进行依赖收集。function handlers() {    return {        get: (target, key, receiver) => {            const result = Reflect.get(target, key, receiver);            <!--触发依赖收集-->            depsCollect({ target, key })            return result        },        set: (target, key, value, receiver) => {            const result = Reflect.set(target, key, value, receiver);            return result        }    }}复制代码depsCollect 依赖收集方法需要做的操作就是将当前的依赖也就是 () => console.log(ob.a)这个函数 fn 保存起来那 fn 怎么传过来呢？ get 方法本身的入参是没有这个 fn 的回顾之前的 observe 方法这个方法有传入 fn 其中内部有个 storeFns.push(fn) 这样的操作就是通过一个数组将当前依赖函数临时收集起来。可光收集没用我们还要和对应的属性进行映射以便后续某个属性变化时我们能够找出对应的 effect 故我们定义了一个 Map 对象来存储相应的映射关系那需要怎样的一个映射关系呢？一个对象有多个属性每个属性可能都有对应的 effect 结构看起来应该是这样的：{    obj:{        \"key-1\":fn1,        \"key-2\":fn2,        ....    }}复制代码我们定义了一个全局变量 storeReactions 来存储整个映射关系它的 key 是 obj 就是原始对象 obj 的值也是个 Map 结构存储了其属性和 effect 的映射关系。我们的最终目的其实也就是建立一个这样的关系。理清楚了数据存储再来看看我们的 depsCollect 方法其实就是将临时保存在 storeFns 里面的函数取出和属性 key 映射。// 存储依赖对象const storeReactions = new WeakMap();// 中转数组用来临时存储当前可观察对象的反应函数完成收集之后立即释放const storeFns = [];function depsCollect({ target, key }) {    const fn = storeFns[storeFns.length - 1];    if (fn) {        const mapReactions = storeReactions.get(target);        if (!mapReactions.get(key)) {            mapReactions.set(key, fn)        }    }}复制代码至此我们的依赖收集算是完成了接下来就是要实现如何监听数据改变对应 effect 自动运行了。4. 数据变更effect自动运行数据变更就是重新设置数据类似 a=2 的操作就会触发代理对象里面的 set 方法我们只需要在 set 方法里面取出对应的 effect 运行即可。set: (target, key, value, receiver) => {        const result = Reflect.set(target, key, value, receiver);        executeReactions({ target, key })        return result    }    function executeReactions({ target, key }) {    <!-- 一时看不懂的回顾下我们的映射关系 -->    const mapReactions = storeReactions.get(target);    if (mapReactions.has(key)) {        const reaction = mapReactions.get(key);        reaction();    }}复制代码ok我们的例子的实现过程讲解完了整个实现过程还是很清晰的最后看看我们的整个代码去掉空行不到50行代码。const storeReactions = new WeakMap(),storeFns = [];export function observable(obj = {}) {  const proxyObj = new Proxy(obj, handlers());  storeReactions.set(obj, new Map());  return proxyObj}export function observe(fn) {  if (storeFns.indexOf(fn) === -1) {    try {      storeFns.push(fn);      Reflect.apply(fn, this, arguments)    } finally {      storeFns.pop()    }  }}function handlers() {  return {    get: (target, key, receiver) => {      depsCollect({ target, key })      return Reflect.get(target, key, receiver)    },    set: (target, key, value, receiver) => {      Reflect.set(target, key, value, receiver)      executeReactions({ target, key })    }  }}function depsCollect({ target, key }) {  const fn = storeFns[storeFns.length - 1];  if (fn) {    const mapReactions = storeReactions.get(target);    if (!mapReactions.get(key)) {      mapReactions.set(key, fn)    }  }}function executeReactions({ target, key }) {  const mapReactions = storeReactions.get(target);  if (mapReactions.has(key)) {    const reaction = mapReactions.get(key);    reaction();  }}复制代码5. 多层级数据结构到目前为止我们实现的还只能观察单级的对象如果一个对象的层级深了类似 ob.a.b 的结构我们的库就无法观察数据的变动 effect 也不会自动运行。那如何支持呢？核心原理就是在 get 方法里面判断返回的值如果返回的值是个对象就递归调用 observable 方法递归调用完接着运行 observe 方法就会构建出完整的一个属性 key 和反应 effect 的映射关系。function handlers() {    return {        get: (target, key, receiver) => {            const result = Reflect.get(target, key, receiver);            depsCollect({ target, key })            if (typeof result === 'object' && result != null && storeFns.length > 0) {                return observable(result)            }            return result        }    }}复制代码回到 ob.a.b 这样的结构此时实际的代理对象应该是这样的 {proxy(proxy(c))} 如果这个时候我们去修改数据比如 ob.a.b = 2 这样。ob.a.b = 2 的运行过程会是怎样？要知道js这门语言是先编译后执行的所以js引擎首先会去分析这段代码（编译阶段）先分析左边的表达式 ob.a.b 故先会编译 ob.a 触发了第一次 get 方法在 get 方法中 result 得到的值是个对象如果按照上述代码又去重新观察这个对象会导致 observe 方法中构建好的映射关系丢失其中就是对象 {b:1} 中 key 为 b 对应的 fn 丢失因为我们存储 fn 是在 observe 方法中执行的那怎么办呢？方法是我们应该在第一次 observable 方法执行的时候将每一个 key 对应的代理对象都保存起来在赋值操作再一次触发 get 方法的时候如果已经代理过直接返回就行不需要重新代理。// 存储代理对象const storeProxys = new WeakMap();export function observable(obj = {}) {    return storeProxys.get(obj) || createObservable(obj)}function createObservable(obj) {    const proxyObj = new Proxy(obj, handlers());    storeReactions.set(obj, new Map())    storeProxys.set(obj, proxyObj)    return proxyObj}function handlers() {    return {        get: (target, key, receiver) => {            const result = Reflect.get(target, key, receiver);            depsCollect({ target, key })            <!--如果代理存储中有某个key对应的代理直接返回即可-->            const observableResult = storeProxys.get(result);            if (typeof result === 'object' && result != null && storeFns.length > 0) {                return observable(result)            }            return observableResult || result        }    }}复制代码如此 ob.a.b = 2 控制台就会依次输出 1 和 2 另外说一句数组也是对象故动态增加数组的值或者赋值操作都能触发响应的 effect 。const ob = observable({  a: {    b: 1,    c: []  }});observe(() => console.log(ob.a.c.join(\", \")));//logs: 2ob.a.c.push(2);复制代码三 如何结合小程序使用全部完整代码我已发布到我的github中名字叫做 micro-reaction 这个库完全无依赖的纯粹的故可以为其它界面框架状态管理提供能量由于小程序跨页面状态共享相关的库不多故这里以小程序举例如何结合 micro-reaction 实现跨页面状态共享。1. 核心原理描述下场景有两个页面 A 和 B 全局数据 C  A 和 B 都引用了 C 之后页面 A 中某个交互改变了 C  A 和 B 都需要自动渲染页面。结合我们的库 C 肯定是需要 observable的 observe 方法传入的 fn 是会动态执行的小程序渲染页面的方式是 setData 方法故 observe 方法里面肯定执行了 setData() 因而只要我们在 observe 方法里面引用 C 就会触发依赖收集从而在下次 C 改变之后 setData 方法重新运行渲染页面。2. 关键步骤首先我们需要拿到每个小程序页面的 this 对象以便自动渲染使用故我们需要代理 Page方法里面传入的参数我们定一个了 mapToData 方法来代理代码如下：<!--全局数据-->import homeStore from \"../../store\"<!--将数据映射到页面同时出发依赖收集保存页面栈对象-->import { mapToData } from \"micro-reaction-miniprogram\"const connect = mapToData((store) => ({ count: store.credits.count }), 'home')Page(connect({  onTap(e) {    homeStore.credits.count++  },  onJump(e) {    wx.navigateTo({      url: \"/pages/logs/logs\"    })  }}))复制代码mapToData 方法返回一个函数 function mapToData(fn,name){return function(pageOpt){}}这里用到了闭包外部函数为我们传入的函数作用是将全局数据映射到我们的页面 data 中并触发依赖收集内部函数传入的参数为小程序页面本身的参数里面包含了小程序的生命周期方法因而我们就可以在内部重写这些方法并拿到当前页面对象并存储起来供下一次页面渲染使用。import { STORE_TREE } from \"./createStore\"import { observe, observable } from 'micro-reaction';function mapToData(fn, name) {  return function (pageOpt) {    const { onLoad } = pageOpt;    pageOpt.onLoad = function (opt) {      const self = this      const dataFromStore = fn.call(self, STORE_TREE[name], opt)      self.setData(Object.assign({}, self.data, dataFromStore))      observe(() => {        <!--映射方法执行触发依赖收集-->        const dataFromStore = fn.call(self, STORE_TREE[name], opt)        self.setData(Object.assign({}, self.data, dataFromStore))      })      onLoad && onLoad.call(self, opt)    }    return pageOpt  }}export { mapToData, observable }复制代码然后页面 A 改变了数据 C  observe 方法参数 fn 自动执行触发 this.setData 方法从而页面重新渲染完整代码点击 micro-reaction-miniprogram 也可以点击查看 在线Demo。四 总结希望我的文章能够让您对依赖收集的认识更深以及如何举一反三的学会使用此外最近在学习周爱民老师的《JavaScript核心原理解析》这门课程其中有句话对我触动很深引用的是金庸射雕英雄传里面的文本： 教而不得其法学而不得其道 意思就是说传授的人没有用对方法学习的人就不会学懂其实我自己对学习的方法也一直都很困惑前端发展越来越快什么 SSR 什么 serverless 什么 前端工程化 什么 搭建系统 各种知识概念越来越多不知道该怎么学习说不焦虑是不可能的但坚信只有一个良好的基础理解一些技术的本质才能在快速发展的前端技术浪潮中不至于被冲走与局共勉！最后在贴下文章提及的两个库欢迎star试用提pr感谢~依赖收集库 micro-reaction小程序状态管理库 micro-reaction-miniprogram                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)問天地好在                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序包大小优化(uni-app)               小程序图像处理：图片配色分析                                                        原作者:  skinner                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序页面通信解决方案 ", "author": "                  Rolan                  2019-8-14 00:18                ", "text": "                                                                                                                                                                                     小程序页面通信解决方案有很多本地缓存、全局变量、手写订阅发布。本文着重介绍另一个解决方案就是暂存当前页面的执行上下文然后在另一个页面调用。github地址简介主要是想解决小程序跨页面通信的问题我想用一种最简单最优雅并且让用户可以很方便的使用的小工具。安装将 store.js 文件放在 utils 文件夹( 可以是任意文件夹 )下即可然后引入文件。引入import store from \"path/store.js\"复制代码使用推荐的使用流程是这样的比如 b 页面需要用到 a 页面里的数据。先在 a 页面引入 store 然后在 onload 方法里使用 store.addData(this, \"a\") 来将当前页面的执行上下文加载到 store 的数据池里。在 b 页面引入 store 然后就可以在 b 页面通过 store.a.数据名 来获取相应数据的值也可以通过 store.a.数据名 = \"balabala\" 来给相应的数据赋值这里注意这样的赋值方式是响应式的不需要通过 setData 函数来赋值就可以达到效果。(暂未实现 setData 方式赋值推荐使用直接赋值)方法简介添加页面数据store.addData( context, name )复制代码参数说明：context执行上下文也就是当前页面的 thisname命名当前页面也就是在别的页面取值的时候 store.name.属性默认值为当前页面的路径移除页面数据store.removeData( name )复制代码参数说明name希望删除的页面数据的名字获取数据let value = store.页面name.属性复制代码这样既可获取数据后台是用代理封装了数据池从而方便用户使用修改数据store.页面name.属性 = value复制代码这样赋值即可后台使用的依然是封装的 setData检测属性是否存在property in store.页面name复制代码代码/**   * @author xiaoheng   * @time 2019/8/1   * @github https://github.com/xiaoheng21   * @tip 还在找工作有机会望告知坐标北京   *//**   * 状态管理类   * @constructor 构造函数   * @_data  内部数据用来保存页面数据   * @addData 添加页面数据的方法   * @removeData 移除不需要的页面数据减小内存压力   */  class Store {    constructor() {      this._data = {};    }      /**     * 向数据池里添加数据     * @param { Object<this> } context 保存当前页面的执行上下文也就是当前页面的 this     * @param { String } name 当前页面数据的名字用于在别的页面读取数据,默认值为当前页面的路径     */    addData(context, name) {      // 如果传了 name 就用传过来的如果未传就用页面路径      let routeName = name ? name : context.route;      //设置代理用于简化操作      let proxyContext = new Proxy(context, {        // 获取数据,如果数据在外层,返回外层数据        get: function(context, property) {          if (property in context) {            return context[property];          } else {            // 如果外层找不到数据, 就在 \"this.data\" 里找,若有返回数据            if (property in context.data) {              return context.data[property];            } else {              //若没有,报错              console.error(`${name}页面没有此属性`);            }          }        },        // 改变数据, 封装 \"this.setData\", 简化操作        set: function(context, property, value) {          context.setData({            [property]: value          });          return true;        },        // 判断数据是否存在        has: function(context, property) {          return property in context.data;        }      });      // 将代理对象添加进数据池      this._data[routeName] = proxyContext;    }      /**     * 从数据池里移除页面数据     * @param { String } name 需要移除的页面的名字     */    removeData(name) {      if (name in this._data) {        delete this._data[name];      } else {        console.error(`希望删除的属性不存在`);      }    }  }    // 创建单例对象,全局共享一个数据池  const store = new Store();    // 创建代理, 私有化 _data, 简化用户操作, 提高安全性  let proxyStore = new Proxy(store, {    // 若访问的属性为 add remove 函数, 直接返回函数    get: function(store, property) {      if (property in store) {        return store[property];      } else {        // 若访问的数据为页面数据, 则返回页面代理对象        if (property in store._data) {          return store._data[property];        } else {          // 若没有页面信息, 报错          console.error(\"访问的页面数据未载入数据池\");        }      }    }  });    export default proxyStore;                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    也许你并不需要第三方小程序框架               小程序实现语音识别转文字坑路历程                                                        原作者: 小恒21                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序组建通信 ", "author": "                  Rolan                  2019-4-22 00:22                ", "text": "                                                                                                                                                                                     子组件传递父组件需要用到triggerEvent方法当子组件（自定义组件）点击button的时候调用triggerEvent方法传递一些数据首先第一个属性为自定义名称（myevent）对应父组件（bind:myevent）名字是个标识必须相同第二个参数就是要传递的数据第三个参数是一些配置具体参考（https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/events.html）。父组件bind:myevent=\"onMyEvent\"事件绑定通过e.detail.count来获取数据。//父组件引用component-tag-name<component-tag-name bind:myevent=\"onMyEvent\" />//index.jsComponent({    onMyEvent(e) {        e.detail.count // 自定义组件触发事件时提供的detail对象结果为1    }})//子组件<button bindtap=\"onTap\">点击这个按钮将触发“myevent”事件</button>//index.jsComponent({  properties: {},  methods: {    onTap() {      const myEventDetail = {count:1} // detail对象提供给事件监听函数      const myEventOption = {} // 触发事件的选项      this.triggerEvent('myevent', myEventDetail, myEventOption)    }  }})                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序：wxml中增加wxs脚本实现手机号/身份证等隐私信息显示 ...               微信小程序 封装路由 mini-router                                                        原作者: 空瓶子装满了                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "张小龙与其说是“未完成”，不如说是“没想好” ", "author": "                  Rolan                  2020-1-14 00:04                ", "text": "                                                                                                                                                                                     题图｜虎嗅“公开课”这个古典互联网时代的名字如果不是微信可能早就寿终正寝了。同样的“微信公开课Pro”如果没有张小龙加持可能也无法Pro了。1月9日的2020微信公开课Pro主题叫“未完成”。尽管张小龙“故意”缺席了这场微信每年最隆重的开发者大会这几天还是获得了各媒体同仁从产业、行业、产品、人性等各方面、各种姿势的赞美篇篇貌美如花。有人赞美张小龙的克制有人盛赞微信取得的成绩有人说他说了12分钟的视频丝毫不亚于去年4个小时的演讲有人把他捧成了“上帝”亦有人说张小龙进化了……我先旗帜鲜明地表明我的态度：他们的观点我都举双手认同。根据微信2019年度报告微信月活跃用户数突破11.5亿同比增长6%。在这个庞大的数据支撑下在克制的张小龙故意没来的情况下微信公开课的各个讲师轮流上阵从小程序到小游戏从微信AI到微信支付交上了一份让人亢奋的答卷——小程序。小程序的活跃用户数突破了3亿用户人均使用小程序的个数增加了1倍2019小程序累计创造了8000亿交易总额同比去年的数额增长160%。小游戏。微信表示小游戏平台累计注册量超过10亿小游戏平台商业规模的总量相较于2018年增长35%。经过一年的时间创意小游戏已有47款通过其中14款产品MAU峰值超过100万4款产品累计流水过千万创意小游戏开发者多获得了超过6000万的现金激励其中优秀产品《消灭病毒》开发者分成超过2亿《动物餐厅》累计用户和流水均破亿。微信支付。主要讲了微信支付分——类似于支付宝芝麻信用分主要功能是免押金——微信表示2019年微信支付分服务了1亿的用户原本的押金用户中80%的用户再也不用使用押金服务这一年微信支付分为用户减少了押金千亿。尽管如此我依然认为今年的腾讯公开课Pro是最平庸的一届或者说乏善可陈。开场前的前菜依然是小游戏。工作人员提示连接现场Wi-Fi下载最新版微信7.0.10抢先体验最新功能但现场Wi-Fi根本连不上由于人群密度极高连4G下都扫不了二维码向来以注重用户体验为荣的微信奉献了一场让人恍惚回到2G时代的开场。张小龙在开场视频结束后很多慕名而来的观众就带着失落走了。现场不到11点就有不少人陆续离场11点半后会场最后面那些座位几乎都空了。显然张小龙的缺席还是让那些来“朝圣”的人失望了本以为花了钱买了门票可以隔着人山人海看张小龙本尊一眼结果这个中国最牛的产品经理任性地没来。不过这倒是没影响堵着会场门口卖票的黄牛们。在会场入口处十几个黄牛大哥不停地问路人买不买门票价格好商量“没有门票进不去晚上的微信之夜”据说门票价格1699元一张。有一位黄牛以为我在拍他跑过来要看我手机嘱咐我千万别拍他们这些人每年都会准时出现在微信公开课的门口有的已经连续好几年了。相比往年微信公开课Pro推出小程序和小游戏等产品今年没有什么新东西几乎都是更新最新的数据来吸引开发者。但虎嗅作者南七道在《 6人年入2.6亿但微信小游戏创业者却不开心 》一文里指出微信小游戏抄袭成风——“没有版权的概念所以现在是小游戏一大抄。国内的抄国外的国外的也彼此抄袭。国内没火的抄火了的。如果小团队被大团队抄了基本上就是等死。”这是李超入行之后最大的感受。即使最火的小游戏“消灭病毒“也是在国外热门游戏《Ball Blast》上进行了二次改编。这款游戏一年的分成高达2.6亿。成为了整个微信小游戏的头部标杆。创始人周巍曾经分析这款游戏诞生的过程“看看市场上哪些产品表现比较好做二次加工产生新的玩法。像《消灭病毒》的商业化模型就是《Ball Blast》。”“基于《Ball Blast》的核心玩法我们在操作题材、手感和目标设计上做了大量的二次加工。”……即使抄好了游戏上架能不能火谁都不知道。因为微信小游戏是一个完全去中心化的平台没有入口没有推荐位完全靠用户搜索和开发者自己推广。从好的一面来看就是没有人工干预很难舞弊但从坏的一面来看即使很好的游戏也没法得到推荐要看运气了。希望微信重视这个现象。下午4点多我走进搭建的“未完城”闲逛依然是白色的统一风格除了微信官方的We Store展区其他各厂商的展区门可罗雀。本来想在We Store买点儿东西但发现无论是卫衣、T恤还是各种玩偶、配件都跟去年展出的一模一样没有更新手机壳是iPhone 8的有一套公仔套装还是猪年的。张小龙说：“微信作为一个基础的信息传递的工具或者说平台我们一个不经意的动作可能会引起信息洪流的流向的变化。”深以为然。大家应该还记得2019年12月26日微信公众号后台出现故障导致无法登录后台、亦无法打开公众号文章给人带来的短暂“恐惧”。感佩张小龙的谨慎但显然他也在谨慎地妥协。在微信公开课开始前的2019年12月23日微信按照惯例更新到7.0.9版支持朋友圈评论区发布自定义表情包结果很快有人发现有些不可描述的表情包陆续出现两天后微信官方宣布此为灰度测试随之关闭。还有人在微信公开课前发现微信好友上限已经允许突破5000个不过超过5000后再加别人微信好友则只允许聊天无法查看对方朋友圈等正常功能这显然对新“好友”不友好。“之前我们限定一个人最多5000个好友现在有将近一百万人已经接近5000好友。虽然不是真正意义上的好友但也促使我们要扩大好友数目了。”张小龙在视频里隐隐不安地说“我们扩大5000好友这个限定非常容易但是对于它带来的影响说实话诚惶诚恐我们会反复思考。”显而易见张小龙还没想好要不要讨好用户。所以与其说微信公开课今年的主题是“未完成”不如说是“没想好”。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    产品经理项目实录：怎样从0到1做一款微信小程序？               微信小程序搜索优化指南                                                        原作者: 虎嗅网                   来自: 虎嗅网                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序swiper组件非居中对称滑动解决方案 ", "author": "                  Rolan                  2019-11-12 00:02                ", "text": "                                                                                                                                                                                     一、前言在公司的项目中遇到了非居中对称的类banner滑动需求如下图：每次滑动的距离并非一屏的宽度而是要根据实际情况来控制。二、解决方案一开始看文档由于swiper组件的配置项并不多我估计能解决这个需求的大概只有previous-marginnext-margin和display-multiple-items三个参数。在经过一系列尝试之后放弃了display-multiple-items这个参数如果使用这个参数很多时候基本上触发不了bindchange事件并不符合预期也不合理。于是开始研究previous-margin和next-marginprevious-margin可以露出前一项的一小部分next-margin可以露出后一项的一小部分。于是在初始化时我把previous-margin设置为28next-margin设置为400就可以完美展现图banner1的效果。（slide宽度为300rpx）<swiper  class=\"swiper-container\"  previous-margin=\"{{swiperDis.previous}}rpx\"  next-margin=\"{{swiperDis.next}}rpx\"  bindchange=\"handleSwiperChange\">  <block wx:for=\"{{ImgList}}\" wx:key=\"{{index}}\">    <swiper-item class=\"slide-item\">      <navigator>        <view class=\"slide-content\">          <image class=\"slide-bg\" src=\"{{item.bg}}\" />        </view>      </navigator>    </swiper-item>  </block></swiper>swiperDis设置为：swiperDis: {  previous: 28,  next: 400}这时候如果滑动的话会发现后面两个slier并不如我们所想而是每次都会滑到最前面所以我就想如果我在每次bindchange的时候改变previous-margin和next-margin呢？于是我加入了这种傻瓜式的代码：handleSwiperChange(e) {  const currentIndex = e.detail.current  if(currentIndex == 0) {    this.setData({      swiperDis: {        previous: 28,        next: 400      }    })  }else if(currentIndex == 1) {    this.setData({      swiperDis: {        previous: 214,        next: 214      }    })  }else if(currentIndex == 2) {    this.setData({      swiperDis: {        previous: 400,        next: 28      }    })  }}得到的效果如我所想。唯一不够完美的就是这样设置不如swiper自适应滑动的效果那么自然稍微有那么一点点的卡顿但我觉得在没有更好的解决办法前这是个又快速又好的方法。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序页面统计埋点设计思路               微信小程序实现A-Z导航的Slidebar                                                        原作者:  Peggy7                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序使用自定义组件导航实现当前页面高亮 ", "author": "                  Rolan                  2020-1-2 00:18                ", "text": "                                                                                                                                                                                     最近开发小程序需要做一个导航导航可以通过template写出来但是这个项目需要在导航中处理一些逻辑做成组件更方便些。首先新建header文件夹里面新建对应的js、json、wxml、wxss文件。<!-- 公共头部组件 --><view class='headers'>     <navigator open-type=\"redirectTo\" class='logo' url=\"../index/index\" hover-class=\"none\">        <image src=\"../../assets/img/logo2.png\" mode=\"widthFix\"></image>     </navigator>    <view class=\"phone_nav_switch\" bindtap=\"controlNav\">        <view class=\"iconfont icon-daohang\" hidden=\"{{navIsShow}}\"></view>        <view class=\"iconfont icon-guanbi\" hidden=\"{{!navIsShow}}\"></view>    </view>    <view class=\"nav\">        <view class=\"shadow {{navIsShow ? 'active':''}}\" bindtap=\"controlNav\"></view>        <view class=\"bg {{navIsShow ? 'active':''}}\">            <view class='con' wx:for=\"{{navs}}\" wx:key=\"item.url\">                 <navigator open-type=\"redirect\" data-index=\"{{index}}\" class=\"{{index === navActive ? 'active' : ''}}\" url=\"{{item.url}}\" hover-class=\"none\">                    {{item.text}}                 </navigator>            </view>        </view>    </view>    <!-- 返回顶部 -->    <view class=\"backTop\" bindtap=\"goTop\" hidden='{{floorstatus}}'>        <text class=\"icon iconfont icon-iconfonticontrianglecopy\"></text>    </view></view>header.js里的导航数据/**   * 组件的属性列表   */  properties: {    // 当前导航高亮    navActive: {      // 类型      type: Number,      // 默认值      value: 0    }  },  data: {     // 导航开关     navIsShow: false,    currentIndexNav: 0,    // floorstatus: false,    navs: [      {        text: '网站首页',        url: '../index/index'      },      {        text: '招商加盟',        url: '../join/join'      },      {        text: '关于煮田',        url: '../about/about'      },      {        text: '煮田美食',        url: '../food/food'      },      {        text: '最新资讯',        url: '../news/news'      },      {        text: '门店查询',        url: '../search/search'      },      {        text: '联系我们',        url: '../contact/contact'      },      {        text: '视频列表',        url: '../videoItem/videoItem'      }    ]  },导航放在class=\"nav\"中header.json文件中写入{  \"component\": true}需要引入组件的页面的json文件写入比如index.json{  \"component\": true,  \"usingComponents\": {    \"header\":\"../header/header\"  }}然后在index.wxml引入组件,navActive是传给组件的值目的是为了对应导航组件内的导航每一项的index比如首页的index为0那我在首页内定义的navActive就是0<!-- 头部组件 -->    <view class='header'>         <!-- 导航高亮传值 -->         <header navActive='0'></header>    </view>如果相等当前页面就会高亮需要在在heaer.js设置navActive的类型通过上面的操作我是能够实现当前页面导航高亮的希望能帮到需要的人如果觉得我上面写的不清楚的话这是我的githubhttps://github.com/mazixiao/w...,这个是我做好了的                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    给你的头像加个圣诞帽吧               微信小程序canvas生成海报 文字自动换行 canvas高度动态设置                                                        原作者:  我的一个道姑朋友                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序富文本解析的「伪需求」，从wxParse到towxml的坑 ", "author": "                  Rolan                  2019-5-9 00:48                ", "text": "                                                                                                                                                                                     本文主要谈谈小程序的富文本解析和目前我的博客小程序用到的两款开源组件 wxParse 和 towxml富文本「伪需求」在进入正题之前想先聊聊「伪需求」这三个字。其实有很多场景会用到富文本框「通常后台维护一长串html文本前台进行渲染展示」。但由于小程序的一些特殊性无法直接渲染html因此类似 wxParse 的开源组件诞生了「原理无非是穷举标签进行替换差异在于覆盖是否全面和是否更加高效」在小程序刚出来的时候富文本的问题也一直被吐槽直到 web-view 的出现「承载网页的容器。会自动铺满整个小程序页面」。小程序终于可以「直接」渲染网页了很多公司也利用这一点很多页面都直接采用H5的方式开发嵌套进小程序中。然而比较悲催的是 web-view 有个限制：个人类型与海外类型的小程序暂不支持使用。所以对于个人开发的小程序来说依旧需要依赖类似 wxParse 的开源组件。wxParse还是towxml在基于 ghost 的博客小程序中我用的是 wxParse 截止到发文该项目已有6071个star很多教程也是基于 wxParse 的但作者似乎已经弃坑了两年多没有再进行迭代了所以该组件也存在很多问题。自己的项目也是在 wxParse 基础之上进行了很多改动。所以在开发新版的小程序时候果断找个替换它可惜的是目前这类的开源组件不多「比较小众吧只有个人开发者才会用吧」比较之后发现还是 towxml 最佳。首先解析比较全面样式也比较完美对于公众号花哨的排版基本支持「只能是基本后面会说到坑」。另外一点支持服务端解析「云函数可以利用起来」。唯一遗憾的是体积还是比较大的后面功能完善后打算看下它的源码进行相应的瘦身。如何使用towxml使用 towxml 还是比较简单的网上有很多教程这里简单说下基于服务端解析、小程序端直接渲染的方式：首先下载源码将 towxml 整个文件夹放到小程序的根目录下。然后在 app.js 中引入并初始化：const Towxml = require('/towxml/main'); App({             onLaunch: function () {    ...  },  towxml:new Towxml(),  checkUserInfo: function(cb) {    ...  },  globalData: {    openid: \"\",    userInfo: null  }})接着在需要使用的地方引入模板比如我的 detail.wxml 下：<import src=\"/towxml/entry.wxml\" />//post.content是解析后的文本<template is=\"entry\" data=\"{{...post.content}}\" />在云函数端首先安装 towxml :npm install towxml然后申明后直接进项解析代码如下：/** * 获取文章明细 * @param {} id  */async function getPostsDetail(event) {  let post = await db.collection(\"mini_posts\").doc(event.id).get()  if (post.code) {    return \"\";  }  if (!post.data) {    return \"\";  }  let content = await convertPosts(post.data.content, \"html\");  //直接赋值towxml解析后的文本  post.data.content = content;  console.info(result)  return post.data}/** * 转换下程序文章 * @param {} isUpdate  */async function convertPosts(content, type) {  let res  if (type === 'markdown') {    res = await towxml.toJson(content || '', 'markdown');  } else {    res = await towxml.toJson(content || '', 'html');  }  return res;}到这里文章应该可以正常渲染了使用起来相对还是比较简单的。towxml的坑准确来说是公众号文章的html一些特殊性和复杂性导致在解析渲染的时候样式上存在一些问题。首先遇到的问题图片展示不了如下截图：在查看解析后的文本json后发现 img 的 src 属性是空的。再回过头看公众号文章原始的 html 的时候发现原始的 img 标签下的属性都是 data-src 开始的难怪无法解析。<img class=\"\"data-ratio=\"2.1638888888888888\" data-src=\"https://mmbiz.qpic.cn/mmbiz_jpg/ibT18LpyNmXqYXfbcbQ7N4kIeJYWSEzDHMDwmbNMUBvaRP7U2zwib9ladYZ2v5mZ1rLRFP2NnCtEuPzs3ibrsKqGQ/640?wx_fmt=jpeg\"data-type=\"jpeg\" data-w=\"1080\"title=\"image\">水平不够无法改 towxml 的源码只能在同步文章的时候做下手脚,将 data-src 替换成 src//替换图片data-urlcontent=content.replace(/data-src/g,\"src\")然后发现公众号自带的代码片段样式解析之后也存在问题截图如下,在代码上方多了很多点。有了图片不展示的经验就比较容易定位问题了应该是towxml在解析代码序号的时候生成 ul 和 li 标签了但在样式上没有做好处理。<ul class=\"code-snippet__line-index code-snippet__js\"><li></li></ul>于是在同步文章的时候也进行一些替换：//移除公众号代码片段序号let content=content.replace(<ul class=\"code-snippet__line-index code-snippet__js\".*?<\\/ul>/g,'')目前解析过程中还有两个问题不太友好后期需要尝试解决：第一个是部分图片依旧不会展示原因已经定位到 img 标签之外嵌套了以下 span 标签之后图片就不会展示「使用新媒体管家进行排版时会出现」<span style=\"color:rgba(0, 0, 0, 0);\"><span style=\"line-height: inherit;margin-right: auto;margin-left: auto;border-radius: 4px;\">另一个是部分解析出来的代码片段没有换行「使用 Md2All 进行样式转换的文章」总结但愿小程序后期官方出个比较全面的富文本组件吧这样可以少绕很多弯路去实现简单的功能。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    手把手教你写一个微信小程序日历组件               小程序的一些小知识总结                                                        原作者: 玄冰                   来自: Bug生活2048                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "开发|微信小程序与tensorflow.js准备工作 ", "author": "                  Rolan                  2019-11-20 00:01                ", "text": "                                                                                                                                                                                     本文首发于微信公众号： \"算法与编程之美\"欢迎关注及时了解更多此系列文章。问题描述这篇文章主要讲解如何将 t ensorflow 与微信小程序结合使得 t ensorflow 的模型能够在微信小程序上呈现出来。解决方案下载微信小程序稳定版版本号最新的就行。新建一个小程序项目, AppID 必须是正式的没有可以注册一个。打开项目后点击右上角详情 — > 本地设置 - -> 调试基础库 -- > 选择最新版本并勾选使用 n pm 模块。打开以下网址登录自己的小程序账号添加 t ensorflowJS 插件。安装 t ensorflowJS 库安装 L TS 版本 ( 安装过程不需要配置一直点下一步即可 )https://nodejs.org/en/安装成功后打开 P owerShell( 管理员 ) 如下图输入 node –version 和 npm –version 查看版本号检测是否安装成功接下来使用 n pm 安装 t fjs 所用的一些包先切换到小程序项目的目录下输入 npm init 对环境进行初始化之后会要求输一些配置信息没什么特别需求直接回车最后输入 y es 即可分别安装以下包npm install @tensorflow/tfjs-corenpm install @tensorflow/tfjs-converternpm install fetch-wechat回到微信小程序页面点击工具 -- > 构建 npm进入 p ackage.json 可以查看已经安装的包每次新建项目都要重复初始化和安装包的操作删除一些微信小程序自带的代码 a pp.js 内的代码可以都删除。删除 Index.js 内的内容删除 l ogs 文件夹app.json 内指向 l ogs 的部分也删除 , 删除代码时前后相应的逗号别忘了删除不然会报错。之后用代码导入包进入之前添加 t ensorflowJS 插件的网页下方有引入插件的代码及相关说明复制到 a pp . json 内只复制红线部分复制红线内代码到 a pp.js之后用 t ensorflow 打印一个常量检测是否能正常运行结语导入 tfjs 需要注意的地方基础库需要切换到2.7.0以上的版本（一般是最新版本）Npm 的初始化和安装需要在项目目录下操作每次安装 n pm 包之后需要重新构建 n pmEND实习编辑   |   王文星责       编   |   马原涛 where2go 团队微信号： 算法与编程之美                                                     .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    使用Taro小程序框架开发一个学习做题聊天交流的微信小程序               uni-app对微信小程序云函数的适配                                                        原作者: 马原涛                   来自:  算法与编程之美                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "[填坑手册]小程序目录结构和组件化使用心得 ", "author": "                  Rolan                  2019-6-20 00:14                ", "text": "                                                                                                                                                                                     小程序目录结构关于小程序的目录结构可以说一开始大家都有各自的开发习惯和命名规则但一旦项目变得复杂庞大的时候你就发现管理起来和后期维护变得很麻烦如果是 协同开发 的话更容易出现 “互坑” 的情况。智库君在一年多的小程序开发中也跳过不少的坑总结了一套还算好维护的目录结构跟大家分享（仅供 参考 觉得好拿去觉得不好欢迎提出意见）以下是实战项目中的结构示例：├─  app.js    --- 小程序加载时优先加载的入口JS├─  app.json   ---入口文件和公共配置├─  app.wxss     ---公共样式表├─  project.config.json     ---小程序全局配置文件├─  sitemap.json     ---允许微信索引文件│  ├─cloud-functions     ---云函数│  └─setCrypto      ---数据加密模块用户加密一些数据│          index.js│          package.json│          ...│          ...│          ├─components      ---小程序自定义组件│  ├─plugins      --- （重点）可独立运行的大型模块可以打包成plugins│  │  ├─comment         ---评论模块│  │  │  │  index.js│  │  │  │  index.json│  │  │  │  index.wxml│  │  │  │  index.wxss│  │  │  │  services.js    ---（重点）用来处理和清洗数据的service.js配套模板和插件│  │  │  │      │  │  │  └─submit    ---评论模块子模块：提交评论│  │  │          index.js│  │  │          index.json│  │  │          index.wxml│  │  │          index.wxss│  │  │      │  │  └─canvasPoster     ---canvas海报生成模块│  │          index.js│  │          index.json│  │          index.wxml│  │          index.wxss│  │          services.js    ---（重点）用来处理和清洗数据的service.js配套模板和插件│  │     ...│  │     ...│  │          │  └─templates   ---（重点）模板通过外部传参的容器不做过多的数据处理│      │      │      ├─slideshow     ---滚屏切换模板│      │      index.js│      │      index.json│      │      index.wxml│      │      index.wxss│      │      service.js    ---（重点）用来处理和清洗数据的service.js配套模板和插件│      │      │      └─works       ---作品模板│          │  index.js│          │  index.json│          │  index.wxml│          │  index.wxss│          │  service.js│          │  │          ├─articlePlugin    ---作品模板中的文章类型│          │      index.js│          │      index.json│          │      index.wxml│          │      index.wxss│          │      │          ├─galleryPlugin    ---作品模板中的九宫格类型│          │      index.js│          │      index.json│          │      index.wxml│          │      index.wxss│          │      │          └─videoPlugin     ---作品模板中的视频类型│                  index.js│                  index.json│                  index.wxml│                  index.wxss│                  ...│                  ...│                  ├─config     ---自定义配置文件│      config.js    ---存放基础配置│      constants.js   ---存储常量│      weui.wxss   ---第三方文件wxssjs等│      ...│      ...│      ├─pages     ---小程序页面│  ├─user      ---用户页面│  │      index.js│  │      index.json│  │      index.wxml│  │      index.wxss│  ├─news      ---新闻页面│  │      index.js│  │      index.json│  │      index.wxml│  │      index.wxss│  │      │  └─home      ---首页│         index.js│         index.json│         index.wxml│         index.wxss│         ...   │         ...   │          ├─request      ---https请求管理（根据switch tab分类会比较好）│      common.js    ---一些公共请求获取如兑换openId,unionId 等│      news.js│      uri.js     --- （重点）总的URI请求管理方便切换和配置DEV,QA,PROD环境│      user.js│      ...│      ...│      └─utils       ---功能组件        logger.js    ---日志管理        util.js       ---公共小组件库        ...        ...        复制代码例如微信自己的wepy的官方文档现在也添加了目录结构说明：为什么一定要写这个目录结构呢？不知道大家有没有发现在以往的老项目交接和多人协同开发中容易遇到别人写的模块变量命名不准确或者资料缺损一次十来个方法/组件间的互相调用直接把接（盘）手的人整懵逼了所以智库君觉得无论是独立开发还是协同开发留一份完整的目录说明文档是很有必要的 勿坑他人 OR 未来的自己~~~component使用心得大家在开发过程中肯定会去看官方文档但不可能全看完才开始写代码大多数情况都是用到了再看本人也是所以下面抽一些开发中遇到的重点来讲：一、引用组件模板页面的自定义组件模板的写法与页面模板相同。组件模板与组件数据结合后生成的节点树将被插入到组件的引用位置上。 在组件模板中可以提供一个 节点用于承载组件引用时提供的子节点。<!-- 组件模板 --><view class=\"wrapper\">  <view>这里是组件的内部节点</view>  <slot></slot></view>复制代码<!-- page页/父页面引用组件的页面模板 --><view>  <component-tag-name>    <!-- 这部分内容将被放置在组件 <slot> 的位置上 -->    <view>这里是插入到组件slot中的内容</view>    <view>在加载组件的页面里自定义内容将没有复用性的内容写在这里</view>  </component-tag-name></view>复制代码页面自定义部分默认是加载在组件 上方 。为什么要在引用组件的页面添加这些内容呢？因为组件其中一个重要的特点是 复用性 但是有的时候可能要根据不同场景做一些 自定义 如果在组件中写大量的场景/逻辑判断会增加组件的冗余而且这些方法只是被 复用一次 的话完全可以不写到组件里。二、“一键换肤”根据不同场景给组件引入外部样式<!-- 外部引用组件的页面传入样式 --><WorkComponent extra-class=\"style1\" j-data=\"{{workData}}\"></WorkComponent>复制代码//组件中jsComponent({    /**    * 引入外部样式可传多个class    */    externalClasses: ['extra-class','extra-class2'],})复制代码extra-class从外部引入父级css可用根据不同场景配置不同的样式方案这样使得组件自定义能力更强。三、数据清洗与容错//service.js  思路示例module.exports = {    /**     * 功能：处理作者列表     * @param list     * @returns {Array}     */    authorList: function (list = []) {        let result = [];        list.forEach(item => {            result.push({                guid: item.recommend_obj_id || '',                type: item.recommend_type || '',                logo: (item.theme_pic || '').trim() || '',                title: item.title || ''            });        });        return result;    }};复制代码如果外部传入的数据要分别导入多个组件中可以在组件中建立一个对应的service.js有2个作用：清洗数据避免setData()的时有过多的脏数据错误数据的兼容添加数据缺省值增加代码健壮性四、canvas在component组件中无法选中的问题//这里只需要在后面 添加this对象    let ctx = wx.createCanvasContext('myCanvas', this);复制代码其他一些默认组件遇到类似的问题一般只要引用时传入this对象即可解决。五、组件之间的通讯在实际生产环境中我们常常需要控制各个组件之间的互相通信/传参下面介绍下具体的用法：WXML 数据绑定：用于父组件向子组件的指定属性设置数据仅能设置 JSON 兼容数据（自基础库版本 2.0.9 开始还可以在数据中包含函数）。具体在 组件模板和样式 章节中介绍。事件：用于子组件向父组件传递数据可以传递任意数据。如果以上两种方式不足以满足需要父组件还可以通过 this.selectComponent 方法获取子组件实例对象这样就可以直接访问组件的任意数据和方法。设置监听事件：<!-- wxml 中 当自定义组件触发“myevent”事件时调用“onMyEvent”方法 --><component-tag-name bindmyevent=\"setMyEvent\" /><!-- 或者可以写成 --><component-tag-name bind:myevent=\"setMyEvent\" />复制代码// index.js 父页面中Page({  setMyEvent: function(e){    let self = this;    if (e.detail) { // 自定义组件触发事件时提供的detail对象      switch (e.detail) {        case \"hidden\":  //隐藏 悬浮框上的评论          this.setData({            isFixCommentShow: false          });          break;        case \"fixRefresh\":   //刷新悬浮框          this.setData({            fixRefresh: true          });          break;        case \"commentRefresh\":  //刷新评论          this.setData({            commentRefresh: Math.random()          });          break;        case \"createPoster\":  //生成海报组件          self.setPosterSave();          break;      }    }  }})复制代码父页面引用子组件子组件发送的信息可以通过bind的方法监听到来获取到具体的传参值。触发事件自定义组件触发事件时需要使用 triggerEvent方法指定事件名、detail对象和事件选项：<!-- 页面 page.wxml --><another-component bindcustomevent=\"pageEventListener1\">   <my-component bindcustomevent=\"pageEventListener2\"></my-component></another-component><!-- 组件 another-component.wxml --><view bindcustomevent=\"anotherEventListener\">   <slot /></view><!-- 组件 my-component.wxml --><view bindcustomevent=\"myEventListener\">  <slot /></view>复制代码//组件中jsComponent({  properties: {},  methods: {    onTap: function(){        var myEventDetail = {} // detail对象提供给事件监听函数        var myEventOption = {} // 触发事件的选项        this.triggerEvent('myevent', myEventDetail, myEventOption)        //myEventOption的一些配置：        this.triggerEvent('customevent', {}, { bubbles: true }) // 会依次触发 pageEventListener2 、 pageEventListener1        this.triggerEvent('customevent', {}, { bubbles: true, composed: true }) // 会依次触发 pageEventListener2 、 anotherEventListener 、 pageEventListener1    }  }});复制代码myEventOption 的配置：bubbles（Boolean）：事件是否冒泡composed（Boolean）：事件是否可以穿越组件边界为false时事件将只能在引用组件的节点树上触发不进入其他任何组件内部capturePhase（Boolean）：事件是否拥有捕获阶段需要强调一点：建议大家不要在组件上bind太多的监听一方面以后管理起来会比较麻烦另一方面首次加载如果调用过多方法会引起数据渲染的卡顿。Component官方文档： developers.weixin.qq.com/miniprogram…往期回顾：[填坑手册]小程序Canvas生成海报（一）[拆弹时刻]小程序Canvas生成海报（二）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    通过json用canvas生成分享海报,支持微信小程序和web               mpVue + 云开发微信小程序之旅                                                        原作者:  智酷方程式                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序wifi能力解读与实践 ", "author": "                  Rolan                  2020-1-3 00:28                ", "text": "                                                                                                                                                                                     背景小程序wifi系列接口为系统原生能力。早在2015年微信就推出了「微信连Wi-Fi」微信连Wi-Fi是为商家的线下场所提供一套完整和便捷的微信连Wi-Fi的方案。现在已经是一套完整的便捷的解决方案。顾客通过扫码的方式连接wifi同时微信还可以向用户下发消息。方案在官方文档已经阐述得很详细本文就不再赘述。本文重点在于讲解小程序中使用wifi能力遇到的问题和心得。【微信连wifi】传送门wifi能力解读wifi能力简介在小程序中使用wifi模块都需要先调用wx.startWifi()来初始化wifi模块。以下能力的使用均需要在wx.startWifi的success回调中使用。连接wifiwx.connectWifi({    SSID: 'mx 的iphone', // Wi-Fi 设备 SSID    BSSID: '', // Wi-Fi 设备 BSSID    password: 'xxxxxxxx',    success(){},    fail(){},    complete(){}})复制代码connectWifi为我们提供了直连wifi的能力 仅 Android 与 iOS 11 以上版本支持需要基础库1.6.0以上。这个一般是我们使用wifi功能的核心API了。在ios中会出现系统弹框询问用户是否要连接wifi只有用户点击确定connectWifi才会继续进行否则就走fail回调了。在安卓（以小米note3为例Anroid9）中则会出现微信连一连的toast。获取当前已经连接的wifiwx.getConnectedWifi({    success(WifiInfo){        // WifiInfo    }})复制代码从社区中获取的信息得知：signalStrength表示信号强度iOS 是系统返回的取值 0-1安卓经过转换取值 0-100。数值与信号强度为正比例关系。获取wifi列表wx.getWifiList({    success(e) {        wx.onGetWifiList((res) {            // res.wifiList:wifiInfo[]        })    }})复制代码获取周围的wifi列表需要先使用getWifiList后使用onGetWifiList进行监听。在ios中getWifiList会跳到ios系统界面这是由于ios系统的限制 目前是无法避免的（其实这么做也无可厚非wifi信息本来就是敏感的但是对用户体验有一定的影响）。在安卓中getWifiList需要获取用户的位置信息因为可以利用小程序嗅探周边Wi-Fi热点来推断用户所在的位置信息。为了确保用户的隐私不受侵犯自微信android客户端 7.0.4 起需要先获取用户地理位置（scope.userLocation）。详情请见wx.getWifiList接口需获取用户位置信息授权后使用设置AP相关信息wx.onGetWifiList(function(res) {    wx.setWifiList({      wifiList: [{        SSID: res.wifiList[0].SSID,        BSSID: res.wifiList[0].BSSID,        password: '123456'      }]    })})复制代码这个接口也挺牛逼ios特有的。通过设置wifiList我们在系统页可以直接看到已设置的wifi列表点了就直接连上了。其他wx.stopWifi 关闭wifi模块wx.onWifiConnected(function callback)监听连接上 Wi-Fi 的事件wx.offWifiConnected 取消监听连接上 Wi-Fi 的事件wx.offGetWifiList(function callback) 取消监听获取到 Wi-Fi 列表数据事件。安卓连接wifi连接指定 Wi-Fi 接口调用时序：Android：startWifi —> connectWifi —> onWifiConnected复制代码连周边 Wi-Fi 接口调用时序：Android：startWifi —> getWifiList —> onGetWifiList —> connectWifi —> onWifiConnected复制代码IOS连接wifi连接指定 Wi-Fi 接口调用时序：(与安卓一致)iOS（仅iOS 11及以上版本支持）：startWifi —> connectWifi —> onWifiConnected复制代码连周边 Wi-Fi 接口调用时序：iOS（iOS 11.0及11.1版本因系统原因暂不支持）：startWifi —> getWifiList —> onGetWifiList —> setWifiList —> onWifiConnected复制代码实践笔者在项目中接触到了使用小程序提供的硬件（wifi）能力的场景。利用wifi与socket的能力我们可以为物联网设备连接wifi。流程如下:刚好在开发者社区找到类似的代码片段：小程序跟设备数据传输(websocket);小程序跟设备数据传输(udpsocket);wx.request/wx.connectSocket/wx.uploadFile/wx.downloadFile 的 url 参数允许为 {PORT}/${PATH} 的格式当且仅当 IP 与手机 IP 处在同一网段且不与本机 IP 相同（一般来说就是同一局域网如连接在同一个 wifi 下）时请求/连接才会成功。在这种情况下不会进行安全域的校验不要求必须使用 https/wss也可以使用 http/ws。局域网通信中不会进行安全域校验因此无需在mp后台添加安全域域名。总结借助小程序提供的硬件能力(wifi,蓝牙NFC)小程序有了更加广阔的场景。比如【摩拜单车】小程序有的车需要用户开一下蓝牙小程序提供的操作原生系统的蓝牙功能便为我们赋能。通过小程序我们也可以实现与物联网设备通信通过连接设备热点利用http/wss/udp传输数据。当然现在wifi能力还是存在着问题比如兼容问题可能有部分安卓手机在连接时会莫名其妙的报错。此时需要对着官方提供的errcode查看具体的原因。踩过的坑安卓部分机型已经连接wifi使用connectWifi重新连接即使传错密码还是能连上。A：这个问题目前还没有解决的办法。ios在getWifiList会跳到系统设置页在connectWifi会出现modal确认是否连接。A：无法避免。ios系统的限制调试wifi功能时无法在开发者工具中调试wifi能力。A: 目前开发者工具无法进行模拟。并且真机调试时连接设备热点后会报错。（毕竟真机调试时需要能够访问网络一般设备热点都不具备访问网络的能力）。目前可以通过 预览+ vconsole解决还是比较麻烦。可以主动断开wifi吗？A: 从文档上看没有提供这个能力。但是可以尝试连接一个不存在的wifi。来自文档的注意事项：Reference微信开放文档 - wifi微信开放文档 - 局域网通信小程序WIFI接口和WebSocket创建局域网数据通讯                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序中解决网络请求缓存               探索小程序实现                                                        原作者: Mekhi                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序框架的简单封装 ", "author": "                  Rolan                  2019-2-27 00:38                ", "text": "                                                                                                                                                                                     解决的问题app onLaunch 等周期函数以及登录请求和 page 的周期函数的执行是异步的导致两者不能衔接的问题page 周期函数中 返回页面和进入页面以及挂起后重回页面 onshow 周期函数无法区分的问题第三方埋点操作侵入性过强的问题App.ready - Promise一个 Promise 实例成功表示登录流程和初始信息加载流程完成；一般不需要显式调用新增的onCreated和onForward生命周期函数在内部使用该 Promise 实例Frame用于初始化注入并返回 Main 函数import Frame from './frame/index';const Main = Frame({  env,  init: () => {},  loginToSite: () => {},});Main({});注入 env, 详见 env注入 init 方法非必填： App 登录之后需要执行的初始操作； 一般可以在这里做初始信息加载等操作； 每次启动app该方法都会执行如果没有登录该方法会在登录后执行并接收登录接口的结果作为参数； 返回一个 Promise 实例；注入登录到服务器 loginToSite 方法非必填： 返回一个 promise 实例；该方法会接收到一个参数：data = {  code,  encrypted_data, // 授权后才会有  iv, // 授权后才会有}Main对 App 函数的封装添加的功能函数methodCaptured: page实例或component实例中任何函数的执行都会触发该函数的执行并传递参数到该函数不包含生命周期函数； 该函数可以实现代码无侵入埋点等操作options = {  route, // page 里为 this.route comp 里为 this.is  name, // 函数名  event, // 事件对象  result, // 函数执行的返回值  scope, // page 或者 component 实例}App.Page - Method对 Page 函数的封装App.Page({});删除的生命周期函数onLoadonShow添加的生命周期函数：onCreated: 替代 onLoad小程序登陆流程和初始信息加载流程完毕后触发在内部使用 App.readyonAppear: 替代 onShow如果想有和onCreated一样的触发时机则可以使用 App.ready 实例onForward: 页面进入并显示时触发小程序登陆流程和初始信息加载流程完毕后触发在内部使用 App.readyonBackward: 返回到当前页面并显示时触发onReappear: 切换到后台又恢复显示时触发注：其他配置和原框架一致App.Comp - Method替代 Component 函数组件需使用 lifetimes 字段来管理生命周期写在外部的生命周期函数将不起作用App.Comp({});Network以下方法都进行了 promisify 除了 App.FC 其他方法都在 promise 实例上挂载了 task 对象App.FC - Object小程序请求接口的封装用法类似 axios提供拦截器和默认设置等操作const FC = App.FC;FC.defaults = {};// 拦截器支持链式调用// middleware: async function | common function | common function with promise// reqWall callback 参数为 options 请求配置并且需要返回 options// resWall callback 参数为 res 请求结果并且需要返回 res// callback 返回为 promise 时promise 的 resolve 必须相应的传递 options 或 res// callback 绑定了请求实例FC.reqWall  .add(middleware)  .remove(middleware)FC.resWall  .add(middleware)  .remove(middleware)FC.fetch(options);const ins = FC.create(defaults);ins.defaults = {}; // 会覆盖 create 方法里的 defaultsins.reqWall  .add(middleware)  .remove(middleware)ins.resWall  .add(middleware)  .remove(middleware)ins.fetch(options);// 选项options = {  baseURL: '',  url: '',  data: Object.create(null),  header: Object.create(null),  method: 'GET',  dataType: 'json',  responseType: 'text',  validateStatus: status => status >= 200 && status < 300 || status === 304,};App.DL - Method小程序下载接口的封装App.UL - Method小程序上传接口的封装App.WS - Method小程序双工通讯接口的封装envAPP_STORE_KEY: '', // 存储app信息的 localStorege keyBASE_TOKEN: '', // 基础 tokenLOGIN_URL: '',  // 登录到站点的urlLOGIN_TYPE: '', // 登录类型 both_login | auth_login | silent_login 默认 both_loginINDEX_ROUTE: '', // 主页路径没有前置/默认 pages/index/indexCHECK_SESSION_TYPE: '', // 检测session的方式 api | store 默认 apiNAV_BAR_MODE: '', // 自定义组件nav-bar模式 dark | light  默认 darkstoreapp.store 相当于 app.globalData默认有：systemInfo, // wx.getSystemInfoSync 的结果navBarInfo, // 导航栏相关布局信息userInfo, // 默认为空对象runtime添加了以下内容的支持async functionPromise.prototype.finally在需要使用 async 函数的文件里顶部添加如下代码：  const regeneratorRuntime = App.regeneratorRuntime;Login在 config 文件里配置登录类型除 login 方法外的其他三个方法已挂载到 app 实例上authLogin: 授权登录只有授权后才会调用登录流程并获取用户微信信息silentLogin: 静默登录不需要用户授权执行静默登录bothLogin: 兼容登录授权情况下调用authLogin没有授权调用silentLoginlogin: 该方法在内部调用做了是否登录的判断。通过 config 来配置登录方式 (both_login | auth_login | silent_login)并默认调用 both_login注意：自定义登陆态下当前页面请求时session_key 过期则会重新登录并重新加载页面在做授权登录时如果需要自行调用上述三个登录函数则需要按照下面的方式操作：  App.ready = app.authLogin();  // or  App.ready = app.silentLogin();  // or  App.ready = app.bothLogin();  App.ready    .then()    .catch();Methods各种工具函数已挂载到 app 实例上// 对 wx.xxxSync 同步api的封装getStorage,setStorage,removeStorage,clearStorage,getKey, // 获取app存储的某一个数据setKey, // 设置app存储的某一个数据removeKey, // 删除app存储的某一个数据getSession, // 获取 tokensetSession, // 设置tokenremoveSession, // 删除tokenstoreCheckSession, // 基于是否存储 token 判断是否过期wxCheckSession, // 基于 wx.checkSession 接口判断token是否过期checkSession, // 上两个方法的封装updateApp, // 更新appgetSystemInfo, // 获取系统信息getPage, // 获取当前pagerpx2px, // rpx 转换到 pxgetUserInfo, // promisify 'wx.getUserInfo' apicheckAuth, // promisify 权限鉴定loginToWx, // promisify 登陆到 微信服务器loginToSite, // promisify 登陆到自家服务器内部组件以下两个组件均已添加到全局组件nav-bar: 自定义导航组件@props title // 非必填标题@props color // 非必填标题颜色@props background // 非必填导航栏背景@props fill // 非必填是否占据空间@props back // 非必填是否显示 back 按钮@props home // 非必填是否显示 home 按钮@props mode // 非必填按钮样式dark | lightuser-info: 授权 getUserInfo 组件@props visibility // 非必填外部控制是否显示@event userinfo // 点击授权按钮事件@event success // 授权成功事件@event fail // 授权失败事件注意登录流程和初始信息加载流程在 App 启动时只会执行一次因此除了初始显式的页面其他页面的 onCreated 等有类似启动时机的周期函数将会很快被执行因此无需担心新的周期函数会增加页面打开时间；对于全局数据建议只在app启动时调用一次获取接口并把数据放到全局数据中然后其他接口更新相关数据后也一并更新全局数据即可好处是不需要每个页面都要获取数据加快页面显示；                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    java后台的微信小程序支付的解决方案               微信小程序开发早知道                                                        原作者: jiankafei                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序实现去抖音视频水印 ", "author": "                  Rolan                  2019-11-11 00:52                ", "text": "                                                                                                                                                                                     先放效果图可以扫码或者微信搜索 “ 和水印说拜拜 ” 小程序体验一下。有效再继续往下看吧。实现原理抖音视频上传后是有2个视频地址（长视频还会多一个）一个是无水印的一个是有水印的万能的网友经过爬虫后拿到了这个链接那就可以实现保存无水印的视频了（去水印）。先上代码1、里面是一个PHP文件把你输入的抖音链接转为无水印的链接输出。不建议把这个转换算法写死在本地因为这个转换算法随时会变所以用PHP实现然后客户端或者微信小程序调用。<?phpheader('Content-type: application/json');$_u = $_GET['_u'];function _g($_u, $_n = 0) {    $_h = curl_init();    curl_setopt($_h, CURLOPT_URL, $_u);    curl_setopt($_h, CURLOPT_RETURNTRANSFER, 1);    curl_setopt($_h, CURLOPT_HEADER, false);    curl_setopt($_h, CURLOPT_HTTPHEADER, array(        'user-agent:Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Mobile Safari/537.36'    ));    if ($_n == 1) {        curl_setopt($_h, CURLOPT_NOBODY, 1);        curl_setopt($_h, CURLOPT_FOLLOWLOCATION, 1);        curl_exec($_h);        $_r = curl_getinfo($_h, CURLINFO_EFFECTIVE_URL);    } else {        $_r = curl_exec($_h);    }    curl_close($_h);    return $_r;}if (strpos($_u, 'com') !== false) {    $_u = _g(_g($_u, 1));    preg_match('/class=\\\"video-player\\\" src=\\\"(.*?)\\\" preload/is', $_u, $_m);    $_m = str_replace(\"line=0\", \"line=1\", str_replace(\"playwm\", \"play\", $_m[1]));    $_v = _g($_m, 1);    if ($_v == '') {        $_c = 0701.1;        $_s = 'error';    } else {        $_c = 0;        $_s = 'success';    }} else {    $_c = 0701.2;    $_s = 'url does not match';}echo json_encode(array(    \"code\" => $_c,    \"errMsg\" => $_s,    \"videoUrl\" => $_v,    \"tmp\" => time()) , JSON_UNESCAPED_SLASHES);?> 把这个PHP文件丢到你的服务器然后访问https://xxxx.com/douyin.php?_u=https://sss抖音链接 然后就会返回对应的信息例如：{    \"code\": 0,    \"errMsg\": \"success\",    \"videoUrl\": \"https://aweme.snssdk.com/aweme/v1/play/?s_vid=93f1b41336a8b7a442dbf1c29c6bbc56827bba338da58fff9d414d5e0e891260a1c391d356de42072e5c7b4c15e93325052710f7923662532737d5c3f25a856e&amp;line=1\",    \"tmp\": 1568018629}这个videoUrl就是无水印的视频地址可以直接在小程序 标签里面播放但是在小程序里面这个是保存不了的很奇怪我试了很多次都是提示类型无效。所以我是直接让用户复制这个链接然后在QQ浏览器打开就能下载视频。（如果有人知道小程序怎样能保存这个视频请联系我我做了一个微信小程序的代码片段你们可以拿去试下。地址：https://developers.weixin.qq.com/s/f5e4RbmR7kbH）如果是客户端使用的话是可以直接保存的后缀名为mp4能直接下载保存。核心代码    $_u = _g(_g($_u, 1));    preg_match('/class=\\\"video-player\\\" src=\\\"(.*?)\\\" preload/is', $_u, $_m);    $_m = str_replace(\"line=0\", \"line=1\", str_replace(\"playwm\", \"play\", $_m[1]));    $_v = _g($_m, 1);上面的PHP其实主要就是这里把接收的抖音链接进行一个正则转换替换字符然后再输出链接。最后说几句这个转换的算法应该是抖音随时更换的不保证永远有效但截至发帖都是有效的建议大家去扫一下小程序看看能不能转换能的话即表明还能用。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    uni-app中picker组件“确定”和“取消”文字的修改               微信小程序后端开发流程                                                        原作者: 在寻找雪见的景天                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序支持 webP 的 WebAssembly 方案 ", "author": "                  Rolan                  2019-8-20 00:24                ", "text": "                                                                                                                                                                                     相信不少人听说过 WebAssembly它是由 Google、Microsoft、Mozilla、Apple 等几家大公司合作发起的一个关于面向 Web 的通用二进制和文本格式的项目。本文我们将跟随作者一步步揭开 WebAssembly 的神秘面纱并了解 WebAssembly 是如何应用在实际业务中的。引言实践检验真理让我们一起动手将 WebAssembly 应用在微信小程序场景中让微信小程序环境支持解码 webP 格式（不了解或没听过 webP 的各位同仁请先移步到 “探究 WebP 的一些事儿” ）。WebAssembly 工作流程动手之前让我们先来了解下如何加载和运行 WebAssembly 的代码：C / C++ / Rust / Java 等高级语言开发的代码或功能库 -> Emscripten 编译 -> wasm 文件 -> 结合 WebAssembly JS API -> 浏览器环境中运行如下图所示：简单来说编译前端 LLVM / Emscripten 流程可以获得 wasm 文件和胶水 js。然后通过胶水 js 来加载 wasm 并转为 arrayBuffer 格式。紧接着进行编译和实例化后即可用 JavaScript 与 WebAssembly 通信。详细过程以及每个过程调用的 API 如下图所示：浏览器环境支持 webP了解完 WebAssembly 的工作流程后是不是还不清楚要从哪开始搞起？你可以去 github 官网上看一下 libwebp 开源项目 Google 已经完全支持把 libwebp 源码编译为 wasm 和 asm.js 两个版本了。针对不支持 WebAssembly 的系统或不兼容 WebAssembly 的浏览器可以在损失一点性能的情况下降级为使用 asm.js。具体编译步骤如下图所示：待编译完之后我们便可获得 wasm 文件和胶水 JS。然后我们可以用“python -m SimpleHTTPServer 8080”启动一个本地服务在浏览器地址栏输入 http://localhost:8080 后就能看到 webP 解码后的图片。最后让我们来总结下整个流程。（1）用 LLVM / Emscripten / CMake 工具对 libwebp 解码库进行编译获得 wasm 文件和胶水 JS。（2）胶水 JS 申请内存对 wasm 文件进行编译、加载和实例化后导出 Module 对象。（3）利用 Module 对象上的 WebpToSDL 方法对 webP 进行解码并转成 Canvas 在浏览器渲染显示出来呈现最终的图片。微信小程序环境支持 webP微信小程序在 Android / iOS 上用于执行脚本以及渲染组件的环境都不尽相同。在 Android 上微信小程序逻辑层的 JavaScript 代码运行在 V8 中视图层是由自研 XWeb 引擎基于 Mobile Chrome 67 内核来渲染天然支持 webP 格式；在 iOS 上微信小程序逻辑层的 JavaScript 代码运行在 JavaScriptCore 中视图层是由 WKWebView 来渲染宿主 Safari 浏览器内核不支持 webP 格式。通过第 3 节内容我们知道浏览器环境已经能够支持 webP 了那直接把之前编译好的 wasm 文件和胶水 JS 扔进微信小程序的运行环境然后跑起来不就搞定了？Too young too simple!浏览器环境支持 webP 的思路是 libwebp 解码 webP -> jpg / png / gif 的 canvas 图片渲染显示这已经改变了原来 image 组件的结构。而微信小程序提供给开发者的组件不允许去改变它原来的结构因此换种思路是 libwebp 解码 webP -> jpg / png / gif 的 rgb data -> jpg / png / gif base64 -> 回传给 JS 并赋值给 image src 进行渲染显示。下面我罗列下从 libwebp 编译 wasm 文件和胶水 JS 开始直到在微信小程序环境跑通为止整个过程中遇到的一些坑点和优化点：（1）编译 CMakeLists.txt 时需加上“-O3”选项大大提升编译速度。（2）编译 CMakeLists.txt 时需加上“-s USE_PTHREADS=0”选项因为 iOS Safari 浏览器不兼容 ShareArrayBuffer 共享缓冲区。（3）编译 CMakeLists.txt 时需加上“-s ALLOW_MEMORY_GROWTH=1”选项目的是为了解决解码超大分辨率的 webP 图片时出现的 OOM 问题。（4）由于微信小程序环境的兼容性问题去除胶水 JS 代码中 libwebp 编译时加上的 SDL 相关代码能节省 100KB 左右的空间。（5）去除胶水 JS 中 ENVIRONMENT_IS_NODE / ENVIRONMENT_IS_SHELL 相关的代码因为微信小程序环境并未使用到。（6）由于 iOS Safari 浏览器的兼容性问题将胶水 JS 中流式编译和实例化的方法去掉替换成非流式编译和实例化的方法。（7）由于 WebAssembly 还没有和 <script type='module'> 或 ES6 的 import 语句集成因此将 wasm 文件先转成 base64 字符串。等胶水 JS 运行加载逻辑时再将 base64 转成 ArrayBuffer 并编译和实例化后导出 Module 对象节省从服务器下载 wasm 文件的时间。（8）编译 CMakeLists.txt 时需加上“-s USE_LIBPNG=1”选项编译 libpng.a 库然后将 webP 解码获得的 rgb 数据通过 png 解码库转成 png 内存数据紧接着转成 base64 回传给 JS最后赋值给 image src 进行渲染显示。难点是 rgb 转成 png 内存数据这一步出了点问题但是 wasm 无法调试代码只能通过搭建 libpng 的 VS 工程进行断点调试最终定位到是 rgb 转 png data 时传入的 data_size 为 0 导致。（9）胶水 JS 里的 new WebAssembly.Memory 代码在微信小程序环境运行时会报“refused to create a webassembly object without ‘unsafe-eval’”的错误必须在 page-frame.html 里的 CSP 设置里加上 unsafe-eval 才能解决。踩了这么多坑之后终于能在微信小程序环境里支持 webP 了。实测 WebAssembly 在解码不同格式不同分辨率的 webP 时性能都完胜 JavaScript。写在最后虽然 WebAssembly 的解码性能比 JavaScript 快不少但遇到超大分辨率（如 1920 x 1080 等）的 webP 时却远远落后于客户端的解码性能。综合对比各种方案的性能和兼容性之后我们还是采用了基于 iOS 客户端自定义协议 webphttps 的方案大致步骤如下：（1）首先微信小程序基础库判断开发者在 image 组件使用的是 webP 格式时则在 image src 里加上 webp 头部如 webphttps://example.png。（2）然后客户端通过 NSURLProtocol 协议挟持 webphttps 的请求并下载相应的 webP 数据进行解码。（3）最后再把解码后的 image 数据回吐给浏览器进行渲染显示。到最后我们完成了微信小程序环境支持 webP 的方案落地。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    扫小程序码实现网站登陆,提供源代码               微信小程序 webview 与 h5 实时通讯的实现                                                        原作者: infoq                   来自: infoq                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序：wxml中增加wxs脚本实现手机号/身份证等隐私信息显示 ... ", "author": "                  Rolan                  2019-4-19 00:34                ", "text": "                                                                                                                                                                                     在js中我们需要将手机号带星号显示是很容易的事情只需要调用字符串截断与拼接就可以了；但是在wxml中我们如何处理呢？微信小程序开发框架中有一个wxs就是为了解决类似问题的只需要在wmxl中引入wxs就可以调用该类的方法这一点和网页开发html中通过script引入js类似。wxs.jpg首先在pages同一级有个wxs目录（没有的可以自己创建）所有的wxs都可以放在这里。subutil.wxs在subutil.wxs中新建一个sub方法用于根据特定需求截取字符串并显示为带 * 号的字符串（前startLength + 四个 * 号 + 后endLength位）如果字符串长度小于startLength + endLength则返回原始字符串：/** * 处理字符串为****格式中间显示四个*号 * str 需要处理的字符串 * startLength 前面显示的字符串长度 * endLength 后面显示的字符串长度 */var sub = function (str, startLength, endLength) {  if (str.length == 0 || str == undefined) {    return \"\";  }  var length = str.length;  if (length >= startLength + endLength) {    return str.substring(0, startLength) + \"****\" + str.substring(length - endLength, length);  } else {    return str;  }}module.exports = {  sub: sub}wxml引用使用以下代码引入wxs脚本：<!-- 引入wxs脚本 --><wxs src=\"../../wxs/subutil.wxs\" module=\"tools\" />在需要的地方通过以下方式调用即可：{{tools.sub(phoneNum, 3, 4)}}一个简单的手机号/身份证等隐私信息显示方法实现了通过wxs还可以在wxml中实现更多的内容；当然建议尽量在js中把数据处理好少在wxml中处理逻辑wxs中也只定义少量工具方法...                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    安卓手机微信7.0.4调试小程序抓包https请求失败的问题和解决               微信小程序组建通信                                                        原作者: ThinkinLiu                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序 input 数据双向绑定，实现方法之一 ", "author": "                  Rolan                  2019-10-17 00:34                ", "text": "                                                                                                                                                                                     小程序 input 数据双向绑定实现方法之一我们都知道 vue 中可以使用 modal 来实现 input 内容数据的双向绑定。小程序好像没有提供相应的方法支持就需要我们自己写了。原理很简单在 input 上先绑定需要取值的变量如这个变量名是 name然后再定义一个用于指向变量名的属性 data-modal 这个属性值设置为 name在 input 的绑定方法中将这个属性值取出就会知道这个 input 绑定了哪个变量然后再将 input 的当前值赋给这个变量即可。实现wxml<input id='name'     name=\"name\"    type='text'     value='{{name}}'  <!-- input 从 js 中的 data.name 取值 -->    data-modal='name'  <!-- 这里通过 data-xx 的形式传递一个需要绑定的变量名之后可以通过 event.dataset.xxx 轻松取到 -->    bindinput='handleInputChange' <!-- 这里绑定 input 内容变化时的处理方法 -->    ></input>wxsPage({  data: {    name: String  },  handleInputChange: function(e){      // 取出定义的变量名    let targetData = e.currentTarget.dataset.modal;     // 取出定义的变量名    let currentValue = e.detail.value;          // 将 input 值赋值给 定义的变量名this.name 可以直接取到在 data 中定义的 name 值其效果跟 this[变量名] 是对等的这是 js 基础    this[targetData] = currentValue;        }}效果如下图：                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序之Flex容器详解               你期待的微信小程序表格组件来咯                                                        原作者:  KyleBing                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "从 WeRequest 登陆态管理来聊聊业务代码 原 荐 ", "author": "                  Rolan                  2019-10-30 00:12                ", "text": "                                                                                                                                                                                     在开发微信小程序之前个人从来没有接触过开发中涉及到第三方服务器交互的流程。在开发的过程本身倒是没有什么太大的意外只是在维护服务器登陆状态这一点很讨厌。因为涉及到自身服务器的登录状态以及微信官方服务器登陆状态三方的关系。下图是微信登陆机制:在这种场景下个人非常关注的点在于: 如何能够无感知的进行登陆(并且无多余请求)。微信的登陆状态倒是还好解决可以利用 wx.checkSession 来进行判定但是在与后台服务器交互时候如果后台交互中返回 HTTP 状态码 401 (未授权)或者其他未登陆指示时候。则需要对其进行额外处理。当时记得为了优雅的解决这个问题想了很多方案也与一些伙伴讨论过这个问题。虽然当时的确实现了无感知的登陆但是要么需要多请求服务器要么就是代码上实现逻辑过于复杂代码维护。虽然不满意但是在当时也没想到什么非常好的解决方法。weRequest 自带状态管理的请求组件后面经过老大的介绍看到这个组件时我顿时眼前一亮这正是我所需要的解决方案,该方案的图示如下:只需要配置一些初始化项目便可以直接拿去使用了。// 导入import weRequest from 'we-request';weRequest.init({    // [可选] 存在localStorage的session名称且CGI请求的data中会自动带上以此为名称的session值；可不配置默认为session    sessionName: \"session\",    // [可选] 请求URL的固定前缀；可不配置默认为空    urlPerfix: \"https://www.example.com/\",    // [必填] 触发重新登录的条件res为CGI返回的数据    loginTrigger: function (res) {        // 此处例子：当返回数据中的字段errcode等于-1会自动触发重新登录        return res.errcode == -1;    },    // [必填] 用code换取session的CGI配置    codeToSession: {        // [必填] CGI的URL        url: 'user/login',        // [可选] 调用改CGI的方法；可不配置默认为GET        method: 'GET',        // [可选] CGI中传参时存放code的名称此处例子名称就是code；可不配置默认值为code        codeName: 'code',        // [可选] 登录接口需要的其他参数；可不配置默认为{}        data: {},        // [必填] CGI中返回的session值        success: function (res) {            // 此处例子：CGI返回数据中的字段session即为session值            return res.session;        }    },    // [可选] 登录重试次数当连续请求登录接口返回失败次数超过这个次数将不再重试登录；可不配置默认为重试3次    reLoginLimit: 2,    // [必填] 触发请求成功的条件    successTrigger: function (res) {        // 此处例子：当返回数据中的字段errcode等于0时代表请求成功其他情况都认为业务逻辑失败        return res.errcode == 0;    },    // [可选] 成功之后返回数据；可不配置    successData: function (res) {        // 此处例子：返回数据中的字段data为业务接受到的数据        return res.data;    },    // [可选] 当CGI返回错误时弹框提示的标题文字    errorTitle: function(res) {        // 此处例子：当返回数据中的字段errcode等于0x10040730时错误弹框的标题是“温馨提示”其他情况下则是“操作失败”        return res.errcode == 0x10040730 ? '温馨提示' : '操作失败'    },    // [可选] 当CGI返回错误时弹框提示的内容文字    errorContent: function(res) {        // 此处例子：返回数据中的字段msg为错误弹框的提示内容文字        return res.msg ? res.msg : '服务可能存在异常请稍后重试'    },    // [可选] 当出现CGI错误时统一的回调函数这里可以做统一的错误上报等处理    errorCallback: function(obj, res) {        // do some report    },    // [可选] 是否需要调用checkSession验证小程序的登录态过期可不配置默认为false    doNotCheckSession: true,    // [可选] 上报耗时的函数name为上报名称startTime为接口调用开始时的时间戳endTime为接口返回时的时间戳    reportCGI: function(name, startTime, endTime, request) {        //wx.reportAnalytics(name, {        //    time: endTime - startTime        //});        //request({        //    url: 'reportCGI',        //    data: {        //        name: name,        //        cost: endTime - startTime        //    },        //    fail: function() {        //        //    }        //})        console.log(name + \":\" + (endTime - startTime));    },    // [可选] 提供接口的mock若不需使用请设置为false。url为调用weRequest.request()时的url。mock数据的格式与正式接口提供的数据格式一致。    mockJson: {        url1: require(\"../../mock1.json\"),        url2: require(\"../../mock2.json\"),        url3: require(\"../../mock3.json\")    }    // [可选] 所有请求都会自动带上globalData里的参数    globalData: function() {        return {            version: getApp().version        }    },    // [可选] session本地缓存时间(单位为ms)可不配置默认不设置本地缓存时间    sessionExpireTime: 24 * 60 * 60 * 1000,    // [可选] session本地缓存时间存在Storage中的名字可不配置默认为 sessionExpireKey    sessionExpireKey: \"sessionExpireKey\"})export default weRequest;使用时候直接拿到 weRequest 既可使用weRequest.request({    url: 'order/detail',    data: {      id: '107B7615E04AE64CFC10'    }    method: 'GET'}).then((data)=>{    // 省略...})代码浅析简单的介绍一下 weRequest 库的实现机制, 在这里代码简化一下,只会说明最主要调用的三个函数。requestHandler.request 管理请求即每一次请求都要执行该函数sessionManager.main 管理 session 状态。session 的设置与删除同时也在第一次确认拥有 session 时设置标识符即只会在第一次缺失登陆态或者错误时候才会执行。responseHandler.response 管理返回数据对返回数据进行解析如果没有登陆态删除 session重新请求结合第二个 sessionManager.main 来做。// requestHandler.request 方法function request(obj: IRequestOption): any {  return new Promise((resolve, reject) => {        // 传入 api 请求对象进行处理    obj = preDo(obj);    // 读取 session, 如果 session 没有问题。成功的话进行业务请求    sessionManager.main().then(() => {        // 进行业务请求        return doRequest(obj)    }).then((res) => {      // 对 返回的数据进行解析 responseHandler.response 方法      let response = responseHandler(res as wx.RequestSuccessCallbackResult, obj, 'request');      if (response != null) {        // 返回请求结果        return resolve(response);      }    }).catch((e) => {        // 异常处理机制        catchHandler(e, obj, reject)    })  })}// sessionManager.main 方法function main() {    return new Promise((resolve, reject) => {              // 检查登陆态并返回 如果登陆态过期直接登陆登陆成功后返回成功        return checkLogin().then(() => {           // 如果登陆态 ok 把 config.doNotCheckSession 设置为 true。避免下次再次执行检查            return config.doNotCheckSession ? Promise.resolve() : checkSession()        }, ({title, content}) => {            errorHandler.doError(title, content);            return reject({title, content});        }).then(() => {           // 对checkSession 进行检查操作            return resolve();        }, ({title, content})=> {            errorHandler.doError(title, content);            return reject({title, content});        })    })}// responseHandler.response 方法function response ( res: wx.RequestSuccessCallbackResult,    obj: IRequestOption,    method: \"request\") {      if (res.statusCode === 200) {        // ... 省略代码                // 登录态失效且重试次数不超过配置        if (config.loginTrigger!(res.data) &&         obj.reLoginCount !== undefined &&         obj.reLoginCount < config.reLoginLimit!) {                 // 删除session            sessionManager.delSession();            if (method === \"request\") {              // 重新请求                return requestHandler.request(obj as IRequestOption);            }        }      }}我们可以利用结合官方网站的图示进行代码分析如果用户从来没有登陆过时或者 checkSession 过期：request 直接请求需要的 apisessionManager.main 检查登陆态即 checkSession 是否过期isSessionExpireOrEmpty 如果 session 过期或者为空(当前为空)wx.login -> code2Session 登陆两个服务器成功后设置标识符 doNotCheckSession 继续 request 请求用户登陆态未过期再次打开小程序:request 直接请求需要的 apisessionManager.main 检查登陆态看到 doNotCheckSession继续第一步 request 请求如果是请求成功后的第二次请求直接会取得内存中的 session,而并非 getStorage所以不必担心用户某次登陆后端后端登陆态过期:request 直接请求需要的 apisessionManager.main 检查登陆态即 checkSession 是否过期isSessionExpireOrEmpty 如果 session 过期或者为空(当前为不为空)成功后设置标识符 doNotCheckSession 继续 第一步 request 请求后台返回错误码通过 responseHandler.response 解析。发现错误删除session,重复请求。提个点一定要设定 reLoginCount 至少1次否则该业务无法完成。new Promise 内部封装异步操作之前在写关于异步代码操作时候通常是基于 axios 直接返回 api 请求响应数据对其进行正常和错误处理。当时多次异步操作从而返回正确与错误的流程却很少进行梳理。如果在一次请求内有多个异步操作：代码就会变得难以维护。事实上我们可以把 Promise 看成状态机。只有在某些情况下才会返回正确。// 异步操作封装function asyncCompnent(opt: any) {  return new Promise((resolve, reject) => {    // 传入的 opt 异步操作    // 多个 异步操作 在最后一个异步操作成功后执行    reslove(result)    // 多个 异步操作中的 catch 在每个错误中执行    reject(error)  })  }asyncComponent(data).then(result => {  // 正常流程}).catch(error => {  // 错误流程})写出如上的代码就可以在很多业务项内进行操作诸如某些操作有前置权限请求或者某些错误代码需要重新请求或者埋点等操作。可能会有人认为在http 请求框架中都会有 interceptor 拦截器, 完全用不到 new Promise 来判断与操作。但是往往来说拦截器对于代码是全局的如果是单单对于某些模块在拦截器中写大量 if 判断以及业务处理这绝不是一件好事。因为场景上业务的易变性使得全局代码被大量修改不利于项目的维护但是如果该方案使用不当则又会造成业务代码的可控性降低。当然以上代码也可以使用 async 与 await 来处理建议多研究一下 async 错误处理这里推荐两篇关于 async 错误处理的博客(因为个人一直不喜欢 async 函数需要配合回调函数或者 Promise.reject 来处理错误所以一般来说我更多用 async 来处理非 api 请求的异步操作这样的话基本上不太需要处理错误)。如何在Javascript中优雅的使用Async和Await进行错误的处理?从不用 try-catch 实现的 async/await 语法说错误处理之前在阅读 《MobX Quick Start Guide》 时候我看到一个公式VirtualDOM = fn (props, state)只要输入等同的 属性和状态得到的一定是 相同的 VirtualDOM 数据。但是我想说的是对于一个业务而言如果不考虑界面美观性以及必要的中间状态我认为符合以下公式:前端业务封装 = 管理 (交互状态 数据状态 配置项)其中结合交互状态和数据状态面向的是最终用户用户看到怎样的界面取决于前两个。而后一个配置项是面向于开发者你的代码能究竟支持多少种场景。能够通过配置来减少多少的代码量。难道只要输入等同的交互以及数据就能的到同样的业务吗？当然并非如此因为对于前端而言始终有不知道的数据状态。我们只能通过防御式编程与错误处理来搞定不清楚的数据状态(通过增加各种交互状态来解决数据数据状态未知情况)。对于 weRequest 这个库而言整个 微信的登陆态是保存在 storage 中整个库都在维护微信的登陆状态(和后台的交互状态并没有保存只要出现没有权限状态时就会删除微信登陆状态重新login)。那么除去代码整个的交互状态就是被存到内存以及 Storage 中的 sessiondoNotCheckSession 。数据状态是我们需要请求的api配置以及我们未知的后端状态。session doNotCheckSession // 可变的交互状态weRequest.init({  // 固定的交互状态(配置项)  // ...})     {  url: '../'} // 数据状态这里也推荐了一篇关于前端 axios 重新请求的方案参考相比于 weRequest 更加清晰:axios请求超时,设置重新请求的完美解决方法同样对于我们的业务代码而言(组件内部实现)往往有些数据也是配置项目。如果你对于这三者清楚的了解并且管理的很好那么写出来的业务代码一定不会差。\"无状态\"的优势在 request 代码中很容易发现代码能够维护和后端的状态并不是因为持有了后端的 session而是一种试错机制只要上一次请求和下一次请求之间的数据没有变过那么在错误处理中重复请求就没有问题。同时呢虽然是有 sessiondoNotCheckSession 这个数据在但是被移除到非业务中只作为交互使用。所以我在这里想说的是思考如何减少中间状态也就是销毁新建的模型更简单。在刚开始处理业务代码时候我总是较多处理 state总是使用组件的显隐来控制 Dialog有时候填写 form 表单很麻烦因为当时组件的一些机制不够完善在处理完一个form后reset并不能清除 上一次数据的验证错误需要多写一部分代码来搞定开发后来开始转变了对于大部分场景而言不如直接销毁新建无需管理中间态。其实前端业务中其实很多这样的例子处理子组件与父组件的关系甚至来说架构端把单页面应用改成基于业务的多页面应用也是一种销毁新建的模式。利用浏览器本身的机制去除大部分的中间态。当我们费劲心思去维护一个中间状态的时候利用各种工具提升性能不妨多思考以下去除是否是一种更简单的方案。之所以会有这样的感慨: 是因为在我刚毕业时曾经做过一个需求里面有 56 个复杂的功能点现在还要增加一个功能点。但是当时完全无法通过增加代码来解决问题必须把代码拆分重组才可以搞定。遇到这种事情有小伙伴可能会想是不是当时的代码写的不好。其实并不是该代码写的不好而是之前的代码写的相当好契合的非常好完全不知道怎么搞定初出茅庐的我完全无法控制(需要对所有功能点通盘考虑复杂度很高)因此我在这个需求上完全失控了。所以能契合复杂的代码考虑到各种可能是能力。能解析复杂的的代码做一定的牺牲决策化繁为简也是一种能力。前者的能力是个人能力的强大是不可复制和替代的。后者则是让团队实现更加简单快速的实现各种功能。对于一个成熟的程序员而言两者的提升都是很重要的。如果对于前端来说无状态的优势是简单的话web 后端的无状态的利好就更多了可以通过外部扩展实现水平扩容其实质也是把交互状态(用户数据)移除到其他介质上来实现请求可以打到不同的服务器上而不是单服务器。同时实现了每次请求都是独一无二的完全不需要考虑中间状态的迁移有利于开发速度与正确性。weRequest 源码结构解析weRequest 是一个非常小而美的库代码非常简单干练,我个人非常喜欢他的源码结构所以列出来:apigetConfig.ts 获取配置信息把代码中配置的数据导出getSession.ts 获取 sessioninit.ts 初始化设置配置 同时读取 storage 中的 session 与 session 过期时间 放入呢次login.ts 直接调用 sessionManager.main()request.ts 直接调用 requestHandler.request(obj)setSession.ts 直接 setSession(内部接管了不建议调用可能是一个用户两个小程序之间的特殊需求)uploadFile.ts 上传文件modulecacheManager.ts api 基于 api 与参数 进行缓存管理目前没有过期时间只适合不变化的数据catchHandler.ts 异常处理durationReporter.ts 耗时上报errorHandler.ts 错误处理mockManager.ts mock 假数据接口requestHandler.ts 请求处理格式化上传文件等responseHandle.ts 响应处理从请求等sessinManager.ts session 管理对于登陆态进行控制设置与删除storeconfig.ts 默认配置在 init 时候会使用 Object.assign 来进行默认配置覆盖status.ts session 在 init 时候会从 storage 中设置typings 小程序的接口 .d.tsutilloading.ts 请求中显示 loading 配置url.ts 根据传入的对象来构造 get 请求urlindex.ts 所有 api 的导出interface.ts weRequest 接口version.ts 版本信息题外话很难有人能一次搞定业务需求,只有在它出现后才知道什么他是它最需要的。业务代码也一样。同时 weRequest 不是万能的它符合大众的需求但不一定符合每个业务的需求。你也可以根据代码改造甚至改进。鼓励一下如果你觉得这篇文章不错希望可以给与我一些鼓励在我的 github 博客下帮忙 star 一下。 博客地址参考weRequest如何在Javascript中优雅的使用Async和Await进行错误的处理?从不用 try-catch 实现的 async/await 语法说错误处理axios请求超时,设置重新请求的完美解决方法                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序技能进阶回忆录 - globalData 的那些事儿               小程序模块曝光埋点方法                                                        原作者: jump--jump                   来自: 开源中国                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序页面统计埋点设计思路 ", "author": "                  Rolan                  2019-11-7 00:02                ", "text": "                                                                                                                                                                                     需要对小程序的页面访问进行统计但小程序并没有页面或者路由拦截如果要重写page或者写mixs函数太麻烦所以希望有个之后扩展方便改动成本低的方式进行页面埋点统计。思路埋点页面中的请求方法我们知道在不同页面中写入同一功能的代码是件很烦恼的事情重复的工作量各个页面间的差异性处理都很糟心。所以在小程序这资源有限的环境里我们希望尽量减少这部分的工作量最好每个页面的功能代码都一样并且精。考虑到每个页面的差异可以用路由体现并且能拿到当前页面的路由参数于是采用了这个策略。page({    ...    onLoad() {        app.countViewer(this.route) //数据埋点        ...    }    ...})复制代码路由——页面id映射表后端接口需要格式大概是：{    id: 0, // 页面id    detailId: 255 // 具体业务情况下的id例如商品的id、广告的id等}复制代码所以我们需要维护的映射表大概会长这样：const RouteList = [    {      id: 1,      route: 'page/index/index',      name: '活动专题',    },    {      id: 2,      route: 'page/active/inde',      name: '活动专题',    },]复制代码封装成个类构造函数接受当前页的route和具体的业务id作为参数并向外提供获得完整RouteList的方法和当前页面对映信息的方法：// router.jsclass Route {    RouteList = [    {      id: 1,      route: 'page/index/index',      name: '活动专题',    },    {      id: 2,      route: 'page/active/inde',      name: '活动专题',    }]        constructor(route, detailId) {        const currentRoute = this.RouteList.find(item => item.route === route) || {} // 查找符合的当前route的对象 如果没找到返回空对象避免报错        this.page_id = currentRoute.id        this.page_detail_id = page_detail_id    }        getRouteList() { // 返回完成对映表        return RouteList    }        getData() { // 返回当前对映项        return {          page_id: this.page_id,          page_detail_id: this.page_detail_id        }    }}module.exports = Route复制代码发送方法// countViewer.js 假设$request是已经封装好的方法let Router = require('./router.js')export default function countViewer(router, detailId = 0) { // 给业务id一个默认值  const app = getApp() // 获得全局的$request封装好的小程序请求  const params = new Router(router, detailId).getData() //获得当前路由对映的参数信息  app.$request('countviewer', params)}复制代码并将该方法绑定到全局的app实例上页面中使用就不用引入了。页面深度不同小程序里引入真的很麻烦。// app.jsimport countViewer from \"./utils/countViewer.js\"App({    ...    countViewer,    ...})复制代码结尾好久不更新了最近正好来了个需求想想之前刚接手这个小程序的时候想写个路由/页面拦截器发现网上提供的方法都挺麻烦的每个页面戳进去改一大段page简直难过所以一开始听到这个需求是有点想哭的。当任务真砸到头上还是能想出办法的。怎么说呢开发原则大概就是避免去戳页面和糟糕的重复代码实在要重复就尽量抽出公共部分把之后更改的时候的工作量降低扒。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序周边配套的实现               微信小程序swiper组件非居中对称滑动解决方案                                                        原作者:  普通人A                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序图像处理：图片配色分析 ", "author": "                  Rolan                  2019-12-2 00:10                ", "text": "                                                                                                                                                                                     背景小程序的canvas是微信基于原生组件自行封装的因此接口跟web的canvas有不少区别早期更是没有支持像素级的处理能力。在18年初的小程序基础库1.9.0版本更新中出现了wx.canvasGetImageData和wx.canvasPutImageData两个重要的API补全了像素处理能力因此小程序在客户端进行图片处理成为了可能。具体可以参考：偷偷迭代的重磅功能---小程序的像素处理能力wx.canvasGetImageData图片配色分析小程序：小色卡为了尝试小程序的图像处理能力我做了个用于图片配色分析的小程序-小色卡。功能主要是：用户选择一张图片程序会分析图片的配色并把配色展示为一张色卡给用户。用户可以保存、编辑、复制自己的色卡。这个功能对初级的UI设计师有一定的帮助（可能吧...）。源码：github：mini-color-card体验小程序：原理小程序实现配色分析主要步骤如下：用户选择图片拿到imgPath后绘制到canvas上。通过wx.canvasGetImageData这个接口读取图片数据对图片数据进行预处理剔除alpha比较小并且不是白色的点。（非必要）对图片像素数据进行聚类。每个像素的颜色可以作为一个三维向量来看。基本逻辑如下：wx.chooseImage({  count: 1,  sizeType: ['original', 'compressed'],  sourceType: ['album', 'camera'],  success: (res) => {    wx.getImageInfo({      src: res.tempFilePaths[0],      success: (imgInfo) => {        let {          width,          height,          imgPath        } = imgInfo;        let ctx = wx.createCanvasContext(this.canvasID);        ctx.drawImage(imgPath,0,0,width,height);        ctx.draw(false,()=>{          wx.canvasGetImageData({            canvasId: this.canvasID,            x: 0,            y: 0,            width: width,            height: height,            success(res) {              var pixels = res.data;              var pixelCount = width*height;              var pixelArray = [];              // 对像素数据进行预处理              for (var i = 0, offset, r, g, b, a; i < pixelCount; i = i + quality) {                offset = i * 4;                r = pixels[offset + 0];                g = pixels[offset + 1];                b = pixels[offset + 2];                a = pixels[offset + 3];                if (a >= 125) {                  if (!(r > 250 && g > 250 && b > 250)) {                    pixelArray.push([r, g, b]);                  }                }              }              var cmap = MMCQ.quantize(pixelArray, colorCount);//聚类MMCQ是个用于图像分析的库              var palette = cmap ? cmap.palette() : null;              console.log('配色为：',palette);            }          })        })      }    })  }})复制代码小结一开始我是不想把canvas显示出来的只想用它获取图像内容但是实践下来是不可行的。小程序的canvas并不允许离屏渲染想要用它进行图片处理就要老老实实用它进行展示。这里只实践了wx.canvasGetImageData读取数据进行图像分析不过结合wx.canvasPutImageData滤镜之类的图像处理应该都是可以做了。小程序的想象空间还是挺大的。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    如何使用不到50行代码实现一个小而美的依赖收集库？               最简单的小程序状态管理方案! - mobx-mini                                                        原作者: 胖胖二师兄                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "也许你并不需要第三方小程序框架 ", "author": "                  Rolan                  2019-8-13 00:10                ", "text": "                                                                                                                                                                                     这里说的去除小程序框架其实并不严谨因为小程序本身也算是一个框架而且是一个功能更加完善的框架系统。在前端的概念中我们一般说一个框架是指一个用来帮助开发者构建用户界面的框架而小程序框架本身不仅仅包含了 UI 层的功能还提供了 API 能力、服务端的能力所以说小程序框架本身是一个比常规的前端框架更完善的东西或者说是一个完善的构建应用系统。在小程序的世界里原生小程序框架已经足够好它就是那把给你雕刻小而美应用的雕刻刀而不必要去寻找一把屠龙刀。框架的取舍最近 Vue 作者尤大关于\t框架设计平衡 的分享中也提到了框架的取舍问题。当我们去构建一个复杂的前端应用的时候如果没有工具而是使用原生 JavaScript 去开发的话那只会花费更多的时间。然而 web 应用的开发环境是否也适用于小程序开发呢？小程序框架在小程序生态发展的初期的确起到了很大的促进作用然而随着小程序原生框架的不断完善这些小程序框架的作用已经不再具备优势。框架的确给前端带来了生产力的提高也带动了前端界生态的发展。所以在小程序出现之后一股框架之风也很快的出现微信小程序刚推出之后就出现了两个比较出名的小程序开发框架wepy、mpvue。这两个框架都带着一个共同的出发点那就是将前端框架的开发体验移植到小程序开发中从语法层做了改动使用用户可以采用类似 Vue.js 风格的语法去开发微信小程序。这些小程序框架初期主要做的是对小程序原生开发体验的增强随着小程序生态的发展又增加了跨端开发能力的支持。然而我们框架的引入真的增强了开发体验吗？我们是否真的需要跨端能力？是否需要通过引入框架的形式来实现跨端支持？答案是否定的引入框架对于小程序开发来说只会带来更多的问题。原生小程序 VS Web 框架如下是原生小程序与 Web 框架功能的对比情况可以看到 Web 框架具备的能力原生小程序也具备。小程序出现的时候 Web 框架已经发展的比较成熟所以可以简单猜测小程序的框架借鉴了许多 Web 框架的特性这也是为什么小程序开发方式与前端开发方式如此接近的原因。功能对比模块Vue.jsReact.js原生小程序数据监听支持支持支持组件式开发支持支持支持组件库开源组件库丰富开发组件库丰富原生小程序组件支持数据状态管理vuexreduxglobalData 可实现基本的数据管理路由vue-routerreact-router原生支持模块开发npmnpmnpm（有轻微的约束限制）在开发前端应用的时候Vue 和 React 技术栈是比较流行的两种类型而对于选择什么样的生态工具时许多开发者并不确定选择什么样的技术栈所以一般都会选择 Vue 全家桶和 React 全家桶。原生小程序框架从能力上就考虑了小程序场景所需的技术栈这也是笔者推崇原生小程序开发方式的原因如果你对你当前构建的应用场景需要什么样的技术栈特别清晰那么就用原生的好了因为原生小程序框架就是基于小程序场景开发的。选择什么样的技术栈提供什么样的框架能力这应该是小程序平台团队去思考的问题。原生小程序的优势从上面的功能层级对比我们可以发现原生小程序与框架相比功能是非常接近的简单来说就是同一个物种只不过是花猫、白猫的区别。那么除此之外原生小程序还有哪些优势呢？稳定安全可靠原生小程序由专业的小程序团队维护更新这是社区开源项目无法比拟的。即使是热门的开源项目也难保不会出现停滞更新维护的情况也许有一天你就发现代码中的坑只得你自己的修复。原生小程序还处于快速发展的阶段每过一段时间就会发布新功能如果使用原生小程序开发的话就可以及时的享用而如果依赖于三方框架的话只得依赖于框架作者更新之后才能使用。作为一个开发人员有时候选择一个什么样的框架是很难的如果你想正确的选择框架就得必须要了解框架所做的一些内部权衡你必须知道这个框架朝着哪个方向发展并且知道它与你构建的东西是否一致。而对于小程序来说上述的问题其实不存在小程序框架就是小程序平台团队为你量身打造的。想了解更多小程序框架可以查看如下三个框架：WePY 让小程序支持组件化开发的框架 WePY 框架在开发过程中参考了 Vue 等现有框架的一些语法风格和功能特性对原生小程序的开发模式进行了再次封装更贴近于 MVVM 架构模式, 并支持ES6/7的一些新特性。mpvue 是一个使用 Vue.js 开发小程序的前端框架目前支持 微信小程序、百度智能小程序头条小程序 和 支付宝小程序。 框架基于 Vue.js修改了的运行时框架 runtime 和代码编译器 compiler 实现使其可运行在小程序环境中从而为小程序开发引入了 Vue.js 开发体验。Taro 是一套遵循 React 语法规范的 多端开发 解决方案。使用 Taro我们可以只书写一套代码再通过 Taro 的编译工具将源代码分别编译出可以在不同端（微信/百度/支付宝/字节跳动/QQ小程序、快应用、H5、React-Native 等）运行的代码。小程序跨端需求继微信小程序推出后阿里百度头条也推出了自己的小程序平台这就给小程序开发者带来一个问题是每个平台开发一套还是寻求代码复用的技术方案。其实跨端方案很多现有的小程序框架大多都内置了跨端能力支持对于跨端支持能力要求并不是特别高的团队也可以搭建自己的跨端方案因为这些小程序框架都很类似所以说搭建一套针对特定场景的跨端方案也变得可行。Antmove - 编译型小程序跨端解决方案Antmove 是一个致力于提供通用型小程序跨端的解决方案通过代码编译的手段和 runtime 的处理实现小程序跨平台的目的Antmove 与其它小程序开发框架的区别就是它尽可能的通过代码编译的方式来解决多端差异问题（一个平台的代码转换到另一个平台）编译方式难以处理的才会进行运行时的抹平而这部分只有简单的数据转换处理不会引入特定的编码约束。以微信小程序转支付宝小程序为例微信小程序和支付宝小程序底层设计不同导致双方组件机制不一样微信小程序组件间的通信是基于事件的而支付宝小程序是基于\tprops 的。在将使用了微信小程序事件能力的小程序应用转换为支付宝小程序应用的过程中Antmove 不会去构造一套事件机制它尽可能的避免任何不必要的运行时开销而是利用支付宝小程序的 props 机制去实现同样的功能。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)307217648                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序中图片/等款高圆变形问题解决(安卓端)               小程序页面通信解决方案                                                        原作者:  高德应用生态团队                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "给你的头像加个圣诞帽吧 ", "author": "                  Rolan                  2019-12-31 00:43                ", "text": "                                                                                                                                                                                     看着大伙都在弄这个我自己也来试一哈我分别用了两种方式来实现一种是普通的方式一种是wxs方式普通方式效果图如下：思路获取头像选择素材缩放移动旋转素材生成canvas生成图片保存图片实现方式首先是获取头像这个不用说大家应该都会的。选择素材这里我准备了三张圣诞帽的素材这个网上有很多可以自己找下然后我还做了一个选择手机相册的功能如果你自己有素材的话也可以直接选择这个功能。缩放移动旋转素材都是通过触摸函数去实现的这里是先将布局做好然后在标签上面绑定各个触摸事件通过返回的值在标签的style里设置实现各个效果。调整好了之后点击保存头像会获取所有参数并将头像画出来再通过 wx.canvasToTempFilePath() 将canvas生成图片最后通过 wx.saveImageToPhotosAlbum() 保存图片。主要代码主要的函数就是下面这几个代码片段我会放在文末没有什么比较难的地方就是要注意下计算的时候不要算错就行。需要注意的点由于素材的大小可能会有不同所以在重新选择素材的时候高度要重新设置一下这里我用了一个方法来重置高度主要是每次重新选择素材的时候就用 wx.getImageInfo() 这个api去获取图片素材的宽高再计算出宽高比。wxs实现方式实现方式思路跟普通方式是一样的不同的是这里将绑定事件通过 wxs 去实现直接设置标签的参数而不通过逻辑层去处理在性能上会比较好一点不过这种实现方式在进行旋转的时候最后生成的图片会有不准后面会说到。参数的获取是通过在标签上设置style然后点击保存的时候用  wx.createSelectorQuery() 获取各个参数的获取旋转的值由于 wx.createSelectorQuery() 并不能获取到 rotate 这个参数所以我是通过下面这种方式来拿到旋转的值的将旋转值以宽度的形式赋值给 .vo-ro但是我发现旋转之后生成的图片不是正确的原因是旋转之后通过 wx.createSelectorQuery() 拿到的宽高并不是图片大小的宽高而是旋转之后的宽高按理来说不应该是这样的即使通过样式旋转它的宽高应该保持不变才对这样就造成了参数上的错误所以画出来的图片是不准确的。因为加了旋转之后画出来的图片会不准确暂时想不出别的方法我把旋转的按钮先注释掉了只支持缩放跟拖拽。总结两种方式wxs性能要更好但是效果没第一种的好看你要哪种了最后祝大家圣诞节快乐祝你生活愉快developers.weixin.qq.com/s/Cizd1RmY7…                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序标签展开收起功能实现               微信小程序使用自定义组件导航实现当前页面高亮                                                        原作者: _鹅不食草_                   来自: 掘金                                                                                      /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序自定义组件boundingClientRect获取到的rect值为null ", "author": "                  Rolan                  2019-6-24 00:36                ", "text": "                                                                                                                                                                                     解决办法：在自定义组件内获取必须用SelectorQuery.in()Component({  lifetimes: {    ready() {      const query = wx.createSelectorQuery().in(this)      const num = Math.ceil(this.data.picList.length / LINE_LENGTH)      query.select('.tab-content-item').boundingClientRect((rect) => {        this.setData({          swiperHeight: rect.height * num + 'rpx'        })      }).exec()    }  },})const query = wx.createSelectorQuery().in(this)这一句是最重要的要用.in(this)this传入的是自定义组件的实例。否则获取到的rect值为null                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序生成海报代码分享               微信小程序组件化开发框架WePY                                                        原作者: Peggy7                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序的一些小知识总结 ", "author": "                  Rolan                  2019-5-9 00:51                ", "text": "                                                                                                                                                                                     小程序很多方法都是异步的原因刚接触小程序的时候发现很多微信提供的api都是异步的如路由跳转设置和读取缓存还有获取节点信息等微信的api都是异步的需要传入回调函数才能获得结果在我们正常的前端开发中这些都不是异步的当时很奇怪为什么是这样的最近看了微信的一个开发教程之后总算是明白了。 微信小程序开发教程小程序的底层架构是双线程模式逻辑层和渲染层是分开的两个线程渲染层指的就是渲染wxml和wxss逻辑层指的是执行js文件两个线程分开运行通过微信客户端进行通信调用微信的api的时候其实就是执行js的线程和微信客户端通信下图是微信官方文档里渲染页面的一个流程图注意事项：上述说了小程序的渲染层和逻辑层是分开的两个线程执行js逻辑的只有一个线程所以在js里声明了的函数只要有调用就算页面卸载了最终都会执行所以要注意的是一些interval或者一些注册的其他函数如果不想在页面离开后继续执行的话在页面卸载的时候要注销掉。发布和订阅模式先补充一个知识点：在小程序的appjs的onLaunch里给全局变量wx添加的属性是全局有效的能在其他页面中调用比如：onLaunch: function () {    wx.aaa = '123456';     wx.bbb = function () { console.log('541521') }}onLoad: function () {    console.log(wx.aaa);    wx.bbb();}之前对发布和订阅一直没什么概念但是多学点东西总没坏处近期自己花了点时间专门看了一下大概明白了一点。订阅：订阅就是在某个地方注册一个自定义的事件供其他地方调用发布：触发已经订阅的函数下面是我写的一个方法可能会有一些bug但是目前没有发现要是有问题的话欢迎交流一下var MyEvent = (function () {  // 声明方法  var pub, sub, remove;  // 订阅缓存记录  var subCache = {};  // 发布缓存记录  var pubCache = {};  // 参数缓存  var paramCache = {};  // 订阅事件  sub = function (key, fn) {    if (!subCache[key]) {      subCache[key] = [];    }    // 添加到订阅缓存中    subCache[key].push(fn);    // 如果有发布记录则直接执行函数    if (pubCache[key]) {      if (paramCache[key]) {        fn.apply(null, paramCache[key]);      } else {        fn.apply(null);      }      pubCache[key] = undefined;    }  };  pub = function () {    var key = Array.prototype.shift.call(arguments);    var fns = subCache[key];    // 没有订阅过则将参数缓存待订阅的时候直接执行    if (!fns || fns.length === 0) {      pubCache[key] = true;      paramCache[key] = Array.prototype.slice.call(arguments, 0);      return;    }    // 有订阅记录则直接执行    for (let fn of fns) {      fn.apply(null, arguments);    }  };  remove = function (key) {    // 把所有的缓存全部清除    subCache[key] = undefined;    pubCache[key] = undefined;    paramCache[key] = undefined;  };  return {    pub: pub,    sub: sub,    remove: remove  };})();module.exports = MyEvent;使用方法如下：在appjs里引入MyEvent并挂载在wx对象上App({  onLaunch: function () {    const MyEvent = require('myEvent的路径');    wx.myEvent = MyEvent;  }})在其中页面页面1的onShow里订阅test1事件发布test2事件onLoad: function(){    wx.myEvent.sub('test1', function () {        console.log('test1');    });},onShow: function () {    wx.myEvent.pub('test2', 'test2' + new Date().getTime());}在页面2的onLoad事件里发布test1事件订阅test2事件onLoad: function(options) {    wx.myEvent.pub('test1');    wx.myEvent.sub('test2', function(a){      console.log(a);    });}一. 在页面1的时候执行了订阅test1事件发布了test2事件但是test1没有发布订阅的事件不会执行test2事件没有订阅也不会执行。二. 从页面1跳转到页面2发布了test1事件直接执行之前已经注册好的test1事件订阅test2事件因为有test2的发布事件订阅之后直接执行结果是打印一次test1打印一次test2。三. 从页面2返回到页面1执行onShow事件再次发布test2事件打印一次test2四. 从页面1到页面2发布了test1事件事件test2重复订阅了订阅了两次打印一次test1。五. 从页面2返回页面1发布test2因为test2事件订阅了两次所以打印了两次test2所以要注意在不需要的地方把事件注销。在页面2的onUnload事件里把事件test2注销掉在从页面2回到页面1的时候事件test2已经注销了不会再执行。onUnload: function() {    wx.myEvent.remove('test2');}原理和用法说明：原理：全局只有一个wx对象将myEvent挂载在wx上所以全局也只有一个wx.myEvent对象myEvent里用到了闭包订阅的函数和参数都有保存在内存里所以能实现订阅和发布的功能。目前事件订阅是用的数组存储可实现同一个事件订阅多次如果不需要的话可自行修改成只能订阅一次的方法。用法：一般用于跨页面的操作比如在某个页面订阅某个事件在另一份页面执行了某项操作之后发布该事件会直接执行订阅的事件实现页面间的一些数据传递。还有也可用于异步请求先订阅某个事件异步请求数据请求数据回来之后再发布。待补充......                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序富文本解析的「伪需求」从wxParse到towxml的坑               从 VantComponent 谈 小程序维护                                                        原作者:  上帝遗忘之子                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "uni-app对微信小程序云函数的适配 ", "author": "                  Rolan                  2019-11-20 00:05                ", "text": "                                                                                                                                                                                     版权说明本文首发于个人博客-指尖魔法屋（www.thinkmoon.cn)。原文地址： uni-app对微信小程序云函数的适配引言熟悉uni-app的人应该都知道uni-app并未对微信小程序云函数（本文统称云函数）进行相应的适配。但是如果我们在某些业务场景的下需要使用云函数呢？我们知道云函数可以复制到微信开发者工具这样的话我们不得不每次编译一次就手动复制一次不得不说麻烦至极。本文就问题做出以下解决方案。本文环境Hbuilder X微信开发者工具创建云函数目录首先我们需要在uni-app项目文件夹下创建一个云函数目录路径随意我这里是 functions 。然后先随便在里面放一些文件这里以 new_file.css 为例。修改 manifest.json在uni-app根目录下修改 manifest.json 中的微信小程序项结构如下\"mp-weixin\" : {        /* 小程序特有相关 */        \"appid\" : \"wxd7de467f6e6cf741\",        \"cloudfunctionRoot\": \"./functions/\", // 这一行就是标记云函数目录的字段        \"setting\" : {            \"urlCheck\" : false        },        \"usingComponents\" : true    }编写 vue.config.jsvue.config.jsconst path = require('path')const CopyWebpackPlugin = require('copy-webpack-plugin')module.exports = {    configureWebpack: {        plugins: [            new CopyWebpackPlugin([                {                    from: path.join(__dirname, 'functions'),                    to: path.join(__dirname, 'unpackage/dist', process.env.NODE_ENV === 'production' ? 'build' : 'dev', process.env.UNI_PLATFORM, 'functions')                }            ])        ]    }}编译运行发现提示如下内容说明未安装 copy-webpack-plugin 插件我们手动安装一下。然后编译运行发现微信开发者工具里面出现以下内容。截止目前已打通Hbuilder X到微信开发者工具的自动复制即已解决本文的核心内容。以下为进一步测试。创建云函数我们在云函数根目录上右键在右键菜单中可以选择创建一个新的 Node.js 云函数我们将该云函数命名为check。开发者工具在本地创建出云函数目录和入口 index.js 文件同时在线上环境中创建出对应的云函数。创建成功后工具会提示是否立即本地安装依赖确定后工具会自动安装 wx-server-sdk。我们会看到以下内容。创建好后将其同步复制到uni-app项目即可为以后自动同步行方便又可避免在输出文件夹中云函数的意外丢失。至此相关文件编写工作转至 Hbuilder X 云函数上传部署依旧在微信开发者工具。编写云函数默认的云函数只是一个返回用户基本数据的内容我们将其修改至满足我们的业务需求以内容安全云调用为例。在云函数文件中写入以下内容// 云函数入口文件const cloud = require('wx-server-sdk')cloud.init()// 云函数入口函数exports.main = async(event, context) => {  try {    console.log('待检测文本:' + event.content);    let result = await cloud.openapi.security.msgSecCheck({      content: event.content    })    console.log('result:' + JSON.stringify(result));    if (result && result.errCode.toString() === '87014') {      return {        code: 300,        msg: '内容含有违法违规内容',        data: result      }    } else {      return {        code: 200,        msg: 'ok',        data: result      }    }  } catch (err) {    if (err.errCode.toString() === '87014') {      return {        code: 300,        msg: '内容含有违法违规内容',        data: err      }    }    return {      code: 400,      msg: '调用security接口异常',      data: err    }  }}权限申明在函数目录下创建一个 config.json ,文档说会自动创建但是我实际操作时未自动创建。 config.json 内容如下。{    \"permissions\": {        \"openapi\": [            \"security.msgSecCheck\"        ]    }}然后在函数目录右键上传并部署。小程序调用云函数wx.cloud.init()                wx.cloud.callFunction({                    name: 'check',                    data: {                        \"content\": this.contents.join()                    }                }).then(res => {                    console.log(res.result)                    if (res.result.code == 300) {                        uni.showModal({                            title: \"温馨提示\",                            content: \"你所输入的内容可能含有违法违规内容不支持进行下一步操作\"                        })                        return                    } else {                        ... // 你要进行的操作                    }                })效果展示                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    开发|微信小程序与tensorflow.js准备工作               在腾讯Q3财报中站C位的品牌小程序BAT态度大不同！                                                        原作者:  醉月思                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "产品经理项目实录：怎样从0到1做一款微信小程序？ ", "author": "                  Rolan                  2020-1-13 00:05                ", "text": "                                                                                                                                                                                     市面上有很多关于微信小程序的文章但大多都是一些宏观的分析或者框架式的方法论却没有讲到底怎么去落地、以及实际项目过程中会遇到哪些问题。所以在本文中我将以自己亲手做过的一款小程序为载体以整个项目流程为主线系统地解构怎样从0到1做一款微信小程序。概述过去几个月我们团队一直在做一款关于互联网保险业务的小程序这不仅是自己第一次从0到1负责一款新产品也是第一次做微信小程序在整个项目过程中积累了诸多经验和体悟因此需要经过一次系统的复盘才能真正内化到自己的产品思维体系中。这里有两个重点：一是怎么去做一款新产品；二是怎么做一款微信小程序。我将分三部分讲述从0到1做一款小程序的整个流程：定位、规划、落地。定位想做一款微信小程序一定要先了解微信生态明白服务号、订阅号和小程序之间的关系并且基于自己公司的实际业务情况将小程序嵌入到业务流程中去所以我将分为微信生态和业务架构两部分进行分析。规划把产品做复杂了容易但做简单了难。尤其是新产品第一个版本的设计非常考验一个产品经理的功力。哪些该第一版做哪些该后续迭代这都要基于产品经理对整体业务的理解进行系统规划。落地从一个概念和框架落地为实际的产品是最难的真正做小程序时会遇到很多的坑不只是小程序自己的各种坑也有与自己业务打通时的诸多问题因此必须要对小程序的特点有所了解我将把做小程序过程中需要注意的问题一一道来。1. 定位1.1 微信生态为什么要用微信小程序这种载体？做小程序前要先回答这个问题否则选择了不适合自己业务的载体只能是浪费资源。而要回答这个问题得先了解微信的生态并结合自己的实际业务流程去权衡。在微信生态中通信功能+朋友圈所构建的社交关系是基本盘并基于这个巨大的流量池衍生出公众号和小程序两大子生态系统。其中公众号又分为订阅号和服务号订阅号提供的是内容以内容沉淀用户个人和企业均可开通；服务号则专门提供给企业给用户提供各种商家服务。服务号和订阅号大概有三点不同：（1）服务号在消息列表这个一级页面直接单独展示订阅号则折叠在“订阅号消息”的二级页面中。这就导致了服务号的曝光能力优于订阅号。（2）服务号每个月能推送4条消息订阅号每天都可以推送1条消息。因此订阅号更适合做内容来吸引用户并运营用户而服务号更聚焦于提供服务功能并且尽量少地打扰用户。（3）经过认证的服务号支持微信支付功能和高级开发而订阅号不支持。这进一步强化了服务号的B端属性和服务能力。从这三点区别可以看到其实服务号和订阅号之间的差别其实非常模糊。订阅号使用H5或者小程序同样可以提供商家服务这样就兼具内容沉淀和企业服务能力了但服务号依旧有不能做内容的短板唯一的优势只剩可以更容易获得曝光。因此订阅号和服务号的定位可以概括为：订阅号偏向获客、服务号负责服务。也就是说在前期订阅号可以起到吸引流量的作用可以当做获客渠道用内容教育和转化用户当用户变成客户后就可以引向服务号专门提供售后的各种长期服务。那又为什么会出现小程序呢？没有小程序之前公众号的各种功能是由H5网页提供的在服务工具或者说服务媒介这一环节不由微信掌控而且H5的体验也较差。因此微信推出了小程序自己制定了一套“H5”规范这不但可以在技术层面与微信打通可以提供更多服务接口也能够把控工具载体的质量为用户提供更好的服务体验。更关键的是这也打通了整个服务链条公众号和小程序形成了业务闭环企业在为用户提供某项服务时全程都停留在微信的平台上不用离开微信这个大生态系统。打个比方这就像微信是一个大商场各个公众号是一个个店铺在以前当你进入某个商铺时因为这是一个个H5所以微信无法了解每个商铺的装修质量和服务能力也不知道你在里面都做了什么像一个个黑盒子。但现在有了小程序也就是说微信这个大商场为每个商铺统一装修并且把控了他们的服务质量也都安上了安全监控不但提高了你的服务体验还能获取你的全程数据。其中能收集并打通全程数据非常有意义因为数据分析是一个系统化工程碎片化的数据是没有价值的。比如用户的购物行为没有小程序时微信只能知道你点击商家入口了多少次进入商家自己提供的H5后微信就不知道用户在H5中都有哪些行为了比如浏览了哪些商品、把哪些商品放进了购物车。在最后用户付款时使用了微信支付微信才知道这个用户转化成功了但是中间购买流程上的每一步转化率怎么样微信一无所知。也就是说微信只能获取入口的流量数据和最后的支付数据其他的数据则在商家自己手中微信没有收集到全流程的数据自然也无法对用户有深入的了解。只有以人为中心获取到其全流程数据才有可能做出精准的用户画像。分析其属性和行为特征后便可在后续为每个用户提供人性化服务以及精准化营销。小程序不但对微信的意义重大而且对开发者来说也非常友好。由于手机操作系统是割裂的分为iOS和Android两大阵营所以要想开发一款APP需要两套人马开发两个APP分别适配两套手机操作系统。而且Android的适配问题非常令人头疼因为Android是开源的很多手机厂商的系统也有很大差异所以光处理适配问题又要花费大量的开发资源。现在微信已经成为一款10亿量级的国民级应用渗透率极高基本是互联网行业的基础设施像生活中的水电煤一样。基于这个条件在微信上搭载了各种服务后其实微信本身就可以承担手机操作系统的角色。手机上的一个个APP也就是一个个企业提供的服务现在微信将自己生态系统中承载的服务统一化和标准化最后呈现的载体便是小程序。这是小程序的另一个优势：开发成本低只需要一套代码就能适配所有机型。背靠微信这个巨大的流量池开发成本也不高小程序这个子生态系统便开始迅速成长起来如今已经成为首选的载体。但是小程序也存在短板因为小程序的定位是轻量、用完即走更像是一个个小工具具有很强的工具属性虽然用户的体验很好但是没有办法沉淀下来最终还是要引向企业自己的APP或者是公众号。这也就是现在经常说的私域流量。只有变成了自己的私域流量企业才能更直接地触达到用户对这些用户进行运营和营销最终实现转化。至此订阅号、服务号和小程序之间的关系和定位就非常清晰了：在订阅号用内容沉淀用户、使用服务号在中后期服务用户、小程序则承担工具和媒介的作用。1.2 业务架构小程序也只是载体不要跟风做小程序不要把手段当做目的。小程序一定是服务公司业务的属于业务流程中的一环。我最近在做互联网保险业务因此所做的小程序也和保险相关：保单管理。先谈谈保险业务可能近半的互联网人不了解保险也不关心保险因为互联网行业兴起也没多少年互联网从业者好多是二十多岁的年轻人群体。对于二十出头的年轻人不关心保险很自然：一是觉得自己年轻力壮人也常常有侥幸心理不觉得自己会得什么病或者发生什么意外；二是因为没有家庭所以也没有那么强的责任感一人吃饱全家不饿。但是一旦有了家庭尤其是有了孩子自己也步入中年时就会有很强的风险意识开始考虑买保险了。毕竟就算不考虑自己也要考虑自己的老婆孩子比如得一场大病不但很可能会掏空家底而且也没有了收入来源家里没有了经济支柱上有老下有小的该咋办？所以保险业务的目标客户群体一般是中年人而且一旦买保险一定是家庭为单位进行保障规划的给自己的父母、伴侣、孩子都购置保险。购买保险后保险公司就会给你一张保单也就是保险合同。一个人一般会配置重疾险、医疗险、意外险、寿险有的人还会为自己养老考虑购买年金险也叫商业养老保险这些保险具体都有什么作用就不展开了。也就是说按照一个人平均有4张保单那一个家庭包括双方父母、先生太太、孩子最少7个人计算一家人就要有28张保单了。这些还很可能不是一个保险公司买的所以对保单的管理就是一个很大的问题了也是一个痛点。了解了保单管理的背景那它在整个业务流程中处于什么节点呢？对于一个卖保险的公司底层商业逻辑和其他行业是一致的核心是两点：获客和转化。无论是电商平台还是线下的商铺都要解决流量从哪里来、又怎么转化客户以获取商业价值的问题。关于获客虽然现在已经有诸多平台和各种类型的获客方式比如近几年比较火的今日头条的信息流广告、抖音的短视频广告或者是传统的SEO/SEM到最后才发现最有效的还是微信公众号平台。在微信公众号投放广告的转化效果要明显优于其他平台。首先是因为公众号具有聚集效应。每个公众号定位不同因此关注的用户也明显有分类比如母婴号的关注用户大部分都是宝妈或者怀孕的准宝妈、军事类的公众号的关注用户比例最高的是中年男性。因此只要找准自己业务的目标人群再去目标人群聚集的地方投放广告自然会有很好的转化率。比如卖体育用品的公司可以将广告投放健身类的公众号卖化妆的可以投放美妆类或情感类的公众号等等。更关键的是公众号文章不同于普通的硬广可能不读到最后根本就不知道这是一篇广告 因此用户不会有天然的抗拒心理而且代入感更强 不知不觉读完之后会被文章丰富的图文和自洽的逻辑所教育即使不能立即转化也会对投放的广告产生品牌认知。这也是为什么经常会有一家公司会和某一个公众号长期签约定期多次投放相同的广告。重复能起到固化认知的作用。用户价值不会一次释放完可能第一次没有转化成功的用户经过多次教育后就能够转化直至一个公众号的用户群体的价值被充分压榨转化率下降此时公司可以转战下一个公众号了如此循环往复。我们所做保险业务也正是采用了这样的获客方式有了客户之后转化环节就要靠保险销售了把不同质量的用户分给不同转化能力的销售。用户质量也就是购买能力可根据年收入划分为不同层次。年收入10万以下的客户不但转化困难而且成交后能获取的收益也很低保险销售都不太愿意接这样的客户；年收入10万到20万的客户群体则是中坚力量这也是保险销售群体比较喜欢的客户群体；年收入再高的话超过50万以上则属于高净值人群很多对保险或者一些资产配置产品有比较深入的了解普通的保险销售驾驭不了适合分配给资深的销售。转化环节其实是一整条服务流程对于保险业务可以细分为投前、投中、投后。（即投保前、投保中和投保后）投前的核心是做家庭财务规划投中则是协助核保投后需要的是保单管理和理赔协助。基于整个业务架构便可构建出相应的产品架构即不同的产品所对应的业务环节和承载的功能。（1）保险业务后台：主要分为产品、客户和交易三大模块。产品管理也就是我们公司所售卖的保险产品库接入的是第三方渠道或者直接对接不同的保险公司。客户管理包括客户的标签数据和流转数据也就是用户是从哪里来的（来源渠道）、现在在哪（所处的环节）、又将往哪里去（购买意愿）。交易管理则是连接了产品和客户核心是订单的相关信息包括订单的各类状态比如未支付、已支付、已出单、退保、核保、理赔等全流程状态。（2）家庭财务智能规划系统：将转化流程标准化根据客户的财务状况自动计算风险缺口并给出保险配置方案。不但可以体现出公司的专业性还可以为保险销售节省大量的精力让其更聚焦于为客户讲解保险知识和财务知识。（3）保单管理小程序：则承担售后服务客户不但可以查看自己家庭购置的保单也可以使用申请退保或理赔、续期续保提醒、保单检视等功能。2. 规划2.1 用户路径了解了保险业务的业务架构和产品架构后也就知道保险管理小程序在业务流程中所处的位置和发挥的作用了。但这也只是保单管理小程序的完整态真正实现时需要分步迭代。为什么说一款新产品的第一版一定要足够简单？一方面讲第一版足够简单是一种实验思维一旦发现存在问题可以快速调整。甚至发现产品不受用户认可、产品方向存在根本性问题时即使迅速抛弃现有的产品浪费的资源也不算非常大沉没成本在可接受范围内。另一方面这也不只是为了开发资源考虑更关键的是需要快速开发、快速进入市场、然后再快速迭代。互联网行业常常讲究先发优势目前互联网保险行业的入局者越来越多竞争也是日益激烈所以尽快地抢先市场并占领用户认知就非常重要了。当然产品的第一版足够简单是不够的也要足够有用。怎么才能有用呢？一定要找到一个核心的业务节点把这个产品嵌入到业务流程中也就是用户必经路径上才能真正发挥作用。经常会出现的情况是做了一款产品然后没有在用户核心路径上用户可用可不用用了固然有帮助不用也没有什么影响那这款产品也就发挥不了什么价值了。可以拿腾讯相册小程序举例在初期腾讯相册只是打通了小程序内的QQ账号体系用户主要是查看自己在QQ的相册。而在18年5月做了从QQ分享到微信的照片由小程序来承载这个功能后数据量才开始爆发性增长。也就是说从QQ分享照片到微信这个核心使用场景中用户原来的路径是直接分享照片即可不会是进入小程序再去分享这个路径反而变长。但是用小程序承载后也就是把小程序这个载体嵌入到用户分享的必经路径中了使用量比以前自然会有大幅上涨。其负责人曾提到过腾讯相册小程序的用户增量主要来自于QQ空间用户的分享在小程序的新用户来源中80%是分享进入的也就是说每5个使用用户有4个是通过分享路径进来的。由此可见一款新产品想要“有用”必须要嵌入到用户的核心使用路径中。对于保单管理来说客户在我们公司买完保险后一定是想要直接能够看到保单的而不是让保险销售手动发给客户一个文件或者让客户自己登录网站去查看自己的保单。所以这也正是保单管理小程序在业务流程中出现的第一个节点：客户买完保险后可以直接在微信小程序中查看自己购买的保单并可以获得一系列的售后服务。2.2 功能范围查看保单功能是保单管理小程序最基础也是最核心的一个功能但是客户的保单其实分为两部分：在我们自己公司购买的保险和在其他公司购买的保险。在我们公司购买的保险我们有相关的保险数据所以可以直接在小程序中展示那客户在其他公司买的保险我们也没有相关数据那该怎么办？尤其是自然流量的用户不是我们平台的客户他们又怎样使用保单管理小程序呢？这就是我们产品的另一个核心功能：上传保单。有了上传功能后不但小程序可以独立使用了同时自己平台的保单数据和客户自己上传的保单数据合在一起构成了客户的完整保单信息。当然这个功能也应该在客户的核心路径上。客户在做保障规划时需要纳入客户的已购保险的不但可以将家庭财务智能规划系统计算出的风险缺口减去客户已有的保额也可以将客户的已购保险和我们推荐的保险进行对比最终实现让客户买到性价比最高保险的目的。也就是说保单管理小程序在业务流程中的位置前置了不但可以在购买保险后（投后）查看保单也可以在投前的保障规划阶段起到录入已购保单的作用。至此可以看到保单管理小程序需要两个核心功能：查看并分享在我们公司购买的保单和上传在其他地方已经购买的保单。其实这个也可以类比腾讯相册小程序。对于腾讯来说一个人的照片分为两部分：一部分是在QQ空间和微信朋友圈的照片也就是用户在腾讯自己公司的数据；另一部分则是用户在其他平台的照片可能大部分都是在用户自己的手机相册中。那么腾讯相册小程序的核心功能也需要两个：用户可以查看并分享在QQ空间和微信的照片、用户可以上传手机相册中的照片。这和保单管理小程序的功能逻辑基本相同。明确了产品的核心功能后再回到最初的问题：第一版要上哪些功能呢？哪些需要后续迭代呢？我们选择了第一版先实现用户可以查看和分享在我们公司购买的保单也就是将保险业务后台的保单数据同步至小程序。已成交客户作为我们新产品的种子用户可以先将小程序用起来检验一下产品的使用效果并优化使用过程中存在的一些问题。上传保单功能则放在第二个大版本进行迭代有了上传功能就不仅是一个内部应用了可以单独使用成为一个独立的小程序应用。这样也就有机会去获取自然流量成为获客的另一个渠道。不过小程序的核心定位还是形成公司的业务闭环服务好自有客户而所谓获客只是锦上添花其实还是很困难的只是提供了获客的可能。3. 落地3.1 交互设计明确了业务架构和产品架构后也确定了产品的迭代路径接下来就要考虑产品的具体信息架构了。信息架构也就是界面层即展现在用户面前的视觉效果比如不同功能的组织页面布局等等。经常说小程序的特点是用完即走那怎么才能达到这样的效果呢？第一原则：使用路径清晰且单一。这样用户一旦进入了小程序就知道自己要怎么做、下一步点哪里。因为小程序有很强的工具属性用户在进入小程序前带有明确的目的和预期那么好的小程序一定要让用户进入小程序时就能使他产生一种：“嗯这就是我想要的。”的感觉并且顺畅和快速地让用户解决要完成的事。摩拜单车的小程序就是很好的例子：扫一扫、点击解锁、骑车即走用户只需要三步动作即可完成任务小程序在整个流程中的存在是完美连接线上和线下的顺畅无阻塞甚至是无感知的。不好的做法是堆砌很多偏离业务主线的功能找半天才找到能解决自己问题的功能入口也就是把小程序做成了一个很重的APP。如果业务比较复杂可以拆分为一个个独立业务或者功能点做成小程序矩阵典型如几个互联网巨头美团、京东、百度等。第二原则：交互方式简单且统一。这里有两个关键词：简单和统一。对于简单而言最重要的就是不要用太多复杂的交互更不要用太多页面跳转这么重的交互方式。不用复杂交互可以理解因为用户打开小程序是为了快速解决问题如果各种操作使用复杂交互效果反而会造成使用不便。这个和PPT类似在做汇报时如果加入各种动效不仅会造成喧宾夺主听众的注意力被动效吸引而且动效过程也会浪费很多时间。简单直接往往最有效。那又为什么说页面跳转这种交互比较重不推荐在小程序中使用呢？原因有两个：一是新页面加载需要等待；尤其是生活中经常会有弱网或者无网的场景出现比如地铁、电梯、地下停车场等因此跳转新页面会出现长时间加载情况所以操作能在现有页面完成就尽量不要跳转。二是过多层级的页面路径会对用户认知造成混乱；本身小程序就属于微信的子页面至少是二级页面如果在小程序内的页面也有很多层级或者是要经常跳转就非常容易让用户产生疑惑或者焦虑感。同样这也违背了第一原则。反面案例就是京东APP拿签到模块举例其页面层级有非常多层。关于交互的统一本身就是一款合格的产品应该具备的。虽然一款产品可能有很多模块、很多业务可能是由多个产品经理分工负责但是一定要注意交互一致性、布局一致性、设计一致性。在同一款产品中如果使用不同的功能或者模块时发现视觉效果明显不同那就很可能是不同产品经理做的也说明没有一个产品负责人去整体把控这款产品。关于小程序微信本身提供了一套标准的小程序设计规范比如启动页加载样式、页面下拉刷新样式等等不但可以减少很多开发量也提供了一套通用标准但是依旧要注意交互的一致性问题。建议先通读一下微信小程序关于设计部分的官方文档：在实际的项目中最好由产品经理和交互设计师或者UI设计师一起基于微信小程序的设计指南制定好一套适用于自己产品的设计规范。拿微信APP自己举例对比其设置页的编辑态会发现复杂的编辑操作或者重要的编辑操作都会有“完成”按钮进行二次确认而一般的编辑操作可直接操作。虽然这只是一个简单交互但是说明其对设计的规范性。小程序中几个典型的交互方式总结一下：能不跳转就不跳转（多用底部弹窗）能不输入就不输入（多用自动填入、勾选等）键盘自动调起（注意不同情况下的不同键盘类型）第三原则：请严格遵守第一原则和第二原则。3.2 数据支撑做功能一定先要考虑到数据从哪里来能不能支撑功能。很多时候把功能设计得非常好用但是往往难以落地或者是实际使用时出现了各种问题一个很重要的原因就是数据支持没跟上。拿我之前想做的一个关于电商比价产品举例：因为现在电商平台比较多商家也比较多我想买一款电视相同品牌或者相同型号的在哪里买便宜呢？所以我就会去不同的电商平台看看比如天猫、京东、苏宁、唯品会、甚至拼多多在这个过程中我需要不断切换不同的应用去对比花费大量的时间。这个场景在生活中经常会出现我观察到很多人也都有过相似的经历。要是从场景和需求来看似乎电商比价这个功能非常有用很多人肯定也非常想用要是真的做出来了万一大受欢迎说不定我还可以去创个业、拿个融资从此走向人生巅峰。但是等一下既然这个功能既然这么有用为什么没人做呢？我从美好的幻想中被拉了出来细想后发现这里存在一个关键的问题几乎难以解决：数据从哪里来？每个电商平台都有自己的价格机制和调控平台那商品数据和价格数据是否会开放出去呢？显然是不可能的这些数据是电商自己的数字资产也是自己的优势所以一个个电商平台之间树立起了数据壁垒。从这个例子可以看到不同公司之间的数据打通是极其困难的不只是技术问题更多是意愿问题。除了不同公司间的数据壁垒问题相同公司的不同部门的数据打通同样存在种种困难。拿腾讯相册小程序举例其功能其实也非常简单但是难点一定是在数据上：QQ空间相册的数据、微信数据和从本地上传的数据的打通问题。因此技术不是问题重点在于不同部门能否通力合作去解决问题。对于腾讯这种巨头公司经常会出现的大公司病就是“各立山头”而QQ和微信就隶属于不同的事业群这大大增加了数据整合、信息流通和资源共享的难度。所以不要把一个公司当做一个整体也不要觉得一个公司是铁板一块大家都会优先考虑公司的整体利益毕竟一个公司是由不同的人组成的位置不同利益自然也不同。因此从下往上推动一个项目往往是很难的只能从上往下去贯彻一个目标由更高层的人去牵头才有可能成事。说完公司管理层面的问题回到数据打通本身真正在落地时很难处理的是数据格式问题。虽然对于保险业务数据格式相对来说已经比较规范了但是依旧存在一些细微的差别。就拿我们公司叫的“保障期限”来说也就是买一个保险能保障你多长时间行业中不同公司的叫法有：保障期限、保险期限、保险期间、保障年限等那么来自不同公司的保险产品数据在打通时就会存在问题。因此数据格式统一是数据打通的第一原则。尤其是现在我们做的这个微信小程序是一款新产品需要使用保险业务后台的现有数据那么在新产品中的数据字段名称和格式一定要与原系统保持一致。在实际的工作中数据格式这一块儿就耗费了我们非常多的精力因为原有业务后台也存在诸多问题很多地方的数据格式也没有统一或者现有的数据格式不规范因此需要先梳理现有系统的数据格式并纠正其中的一些数据问题。数据格式问题解决之后然后还要依照不同的维度解决接下来的一系列数据问题：数据来源：数据都是由哪些人或者系统产生的可以分为线上系统同步和线下人工录入只有搭建起自动收集数据的自循环才有对数据分析和应用的可能；数据查看：不同的数据都是有哪些角色查看、不同角色的数据权限有哪些、查看的终端有哪些、目前查看数据的流程和方式是怎样的；数据应用：数据可以用到哪些具体的功能中比如数据异常预警机制、数据展板等；数据更新：目前不同类型的数据是怎么更新的、更新频率是多久、有哪些数据长期未更新、未更新的原因是什么、未来建立的数据系统需要怎样支持数据更新（频次、实时性等）。3.3 用户授权在以前进入一个APP时需要输入账号和密码进行登录即使是现在主流的也是输入手机号然后通过短信验证码登录没有注册时还经常要先去注册整个路径非常长。但是在微信生态中就不一样了进入小程序时是静默登录的在小程序后台直接完成了登录操作企业可以获取到用户在此应用中的唯一标识OpenID用户不需要进行任何操作。这个也好理解用户进入微信APP时已经进行过一次登录那再使用微信内的应用时自然不需要登录。那我们为什么还会在各种小程序中看到“登录”按钮呢？其实这里的“登录”本质是授权是为了获取你的各种信息因此是两回事。可能许多应用为了延续用户在APP生态中的使用习惯所以依旧使用“登录”这种叫法。微信本身就有你的手机号、身份证、年龄、性别、地域等关键信息但是不会直接开放给其他企业需要用户手动授权。其中手机号信息又从用户信息中抽离出来需要用户单独授权毕竟手机号是一个非常关键的用户信息可谓是现在的互联网通行证。所以微信的信息授权分为两种：一种是手机号授权、另一种是用户其他信息授权。这两种授权非常简单只需要一步点击操作即可触发微信登录底部弹窗直接授权手机号或者用户基本信息比传统的登录操作要便捷很多这也正是微信生态的优势所在。但是出于对用户信息保护的考虑也为了避免打扰用户微信对用户信息授权的触发方式做了各种限制。这不得不提微信的审核机制。微信的小程序生态和苹果的应用生态非常类似新开发的应用都需要审核通过才能上架开放出去。开发iOS版本的应用时很多开发者经常会遇到审核不通过的情况因为苹果制定了一套审核标准必须符合苹果的设计规范和基本要求才能通过否则要被打回修改。微信沿用了苹果的审核机制同样制定了一系列的标准。我们在这个项目中就遇到审核不通过的情况被打回的原因就是：授权方式不规范。“你好小程序帐号登录功能暂未符合规范要求请在用户了解体验小程序功能后再要求用户进行帐号登录。请整改后再重新提交审核具体登录规范及整改可参考：https://developers.weixin.qq.com/community/operate/doc/000640bb8441b82900e89f48351401请根据上述原因对小程序进行修改并重新提交代码审核。若对上述原因无法理解可前往反馈页面进行反馈。我们原来的设计方案是：用户进入小程序后会显示启动页手机号和用户基本信息授权成功后才能进入小程序主页面。但这是微信不允许的简单说就是不能一进入小程序就直接弹窗提示用户登录必须要让用户看到小程序的主体内容后并手动点击按钮去触发登录弹窗。就连我们这种用启动页过渡的方式也是不允许的必须要进入小程序并看到一级页面才行。最后我们不得不临时改动产品方案在首页和“我的”页中分别增加了授权手机号、授权用户信息两个触发按钮。3.4 用户标识用户授权的底层是和用户标识有关。为什么我们需要用户标识呢？有两方面作用：一是微信用户数据与外部数据的打通也就是与自己的已有业务数据打通比如某个用户已经在我们的后台有了购买数据那么我们只要确定了他的身份然后和我们后台的客户标识进行对比就可以知道他到底是不是我们的已有客户。目前用户唯一性的通用标识是手机号因为手机号是实名的与身份证绑定在一起。确定了一个用户是我们后台的已有客户时就可以直接把他的购买数据推到小程序端这个用户也就可以看到自己的保单数据了。二是微信内部不同应用数据之间的打通确定了用户的唯一性后其在不同微信应用的行为数据或业务数据就可以串在一起了比如在订阅号的阅读数据、在小程序中的行为数据等。每一个人都是一个数据源无时无刻不在创造着各种数据只不过这些数据要么没有被收集到、要么散落在不同的应用中所以我们若能收集到这些在不同场景中的碎片化数据并想办法归类到创造这些数据的同一个人身上我们就能更加全面的和深刻地了解这个人。这也就是所谓用户画像的由来只不过现在大多数的用户画像还非常单薄可能只有性别、年龄、地域、手机设备型号等属性数据而没有更加深入的、更加细节的信息。比如从一个人的外卖数据中可以了解到他的饮食习惯也可以知道他的长住地公司或者家庭地址等；从一个人的购物数据中可以获取到他的最近生活方式变化像开始买纸尿布推测其有了孩子后来又买了童装则说明他的孩子长大了；从一个人的聊天记录数据和通信录数据中可以抽离出更多的有效信息这个人的说话方式、关系网、最近的心理状态等等。唯一的问题就是这些不同场景的数据在不同的平台中而且是非格式化的数据包括文字、视音频等主动数据和点击查看等被动数据。那么我们就需要每个用户都有唯一的标识并将其在不同的应用中的不同唯一标识串起来。在一个应用内比如小程序、订阅号或服务号每个用户都会打上唯一标识这个就是OpenID为什么叫Open呢？因为这个ID会提供给应用所属的企业但是为了保护用户隐私也是为了保护自己的数据资产微信肯定不会直接把手机号、微信号等重要信息给其他企业所以这个公开的ID是经过特殊规则转换过的一个特殊字符串不包含任何明文信息。但此时也会出现问题要是一个企业有多个小程序还有订阅号或服务号那一个用户在同时使用这些应用时在每个应用内都有一个唯一标识也就是会有多个OpenID那到底有多少真实用户呢？而且单个用户在不同应用中的行为数据怎么串起来呢？总不能一个用户在订阅号中标识为用户A跳转到小程序后就标识成用户B然后数据也就被割裂开吧？于是便有了UnionID就像字面上的意思联合的标识。有了UnionID同一用户在不同应用中的不同OpenID就可以映射到唯一的UnionID上了。简单总结：OpenID是同一用户同一应用的唯一标识。UnionID是同一用户不同应用的唯一标识。OpenID是不需要授权的在公众号中关注公众号时企业可以获取用户的OpenID在小程序中进入小程序时即可直接获取。但是UnionID则不同在公众号中不仅需要用户关注我们的公众号还需要开发者去微信开放平台绑定公众号后才可以获取UnionID；小程序获取UnionID的规则更复杂一些用户进入小程序时如果用户已经关注了与小程序同一主体的公众号而且公众号已经获取了用户的UnionID而不需再次授权否则的话需要在小程序中单独授权才能获取UnionID。3.5 数据埋点在项目完成到最后阶段时数据指标一定不能忘数据指标是量化评估你所做需求的实际效果的关键。关于数据埋点分两种情况：一种公司和产品已经比较成熟也比较稳定也有现成的数据分析工具有完善的数据埋点规范埋点的成本比较低那就可以全面埋点；另一种是公司处于草莽时期只是想赶紧迭代赶紧推上线关于数据埋点没有统一规范但此时依旧不能没有数据支撑因为没有设置好基本的监控数据就上线产品就像飞机的盲飞你可能飞起来了却不知道还有多少油、数据情况怎么样、是变好还是变差如果要改动要改哪里。事无巨细地追踪所有用户行为需要全面铺上数据埋点工作量巨大对于正在快速迭代的初创企业确实不太现实可能几个月后才能看到数据所以建议采取分级分步的方法优先定义出最重要的几个事件追踪然后再做其次重要的事件。不过好在微信小程序本身就提供了基本的数据统计而且还有直接配置的埋点方式无需代码这样就简单很多了。在微信小程序后台整体可分为常规分析和自定义分析。常规分析就是不需要自己数据埋点微信直接就能收集到的数据分为三类：（1）新增、活跃、留存等概况数据对应“使用分析”模块（2）页面流量数据又分成了实时和非实时分别在“使用分析中的页面分析”和“实时分析”两个模块（3）用户画像数据包括性别、年龄、地区和终端机型自定义分析也就是数据埋点分了两种方式：直接配置和API上报。1）直接配置只需要填写事件名称、触发动作和页面元素的ID即可不需要添加代码也不需要上线这种埋点方式适合统计功能的使用情况比如多少人点击了签到按钮、多少人进入设置页面等。2）API上报适用于收集事件下的具体属性数据比如点击商品这个事件如果我们想要知道用户具体点击了什么商品、商品的价格是多少等信息就需要这种添加代码的数据埋点方式了。从另一个维度看数据又可以分为两大类： 用户数据和业务数据。用户数据包括用户画像和行为数据业务数据则是和业务直接相关的数据比如购买金额、购买频率等。对不同类型数据的分析要在不同平台处理微信小程序提供的数据分析更多是集中在用户数据部分业务数据则主要在公司自己的业务后台。“如果你从头开始建立用户行为追踪计划建议先找到3个最重要的一级事件这3个一级事件应该代表了用户从初次接触产品到最终成功使用产品的最重要的里程碑。”这是我之前在书中看到的埋点理论把这个理论用到我们的产品中最关键的3个一级事件是：进入小程序（PV/UV）、关键功能1的按钮点击（PV/UV）、关键功能2的按钮点击（PV/UV）。当我按照之前在书中看到的这套理论梳理了三个关键指标后才发现实际情况没有这么简单。先是leader直接就发现了问题：这不是关键指标应该和业务结合目前最重要的是要让保险销售知道自己名下哪个客户有没有使用小程序然后推动客户去使用如果用简单的PV、UV、按钮点击等等对业务没有什么帮助适合后期再去完善。之后又深入思考了现状：我们现在有2个微信公众号和即将上线的2个小程序已经构建起了一个微信生态服务矩阵因此要考虑到4个应用之间的互联互通而不只是我现在负责的这个小程序需要收集使用情况的数据其他两个公众号和另一个小程序同样需要。那我们怎么把这几个微信生态应用的数据使用情况集合到一起呢？我们了解到另一个产品经理正在保险业务系统中做用户行为轨迹模块即收集一个用户从接触到我们的品牌、到使用我们的服务、再到满足需求整个业务流程的数据。这两个小程序的使用数据也正是整个业务流程中的一部分他现在已经收集了公众号的使用情况因此可以把两个小程序的使用情况也放到这个模块中。也就是说我们把我们想要的数据需求提交给另一个负责用户行为轨迹的产品经理把数据融合在他所做的模块中然后我们这边再做一个用户是否使用小程序的提醒功能即可这就实现了一个新小程序的初步数据统计需求之后再按正常流程提数据埋点需求把核心页面和关键流程都铺上点。我们产品内部策划好这个需求后再与程序员沟通时又遇到了一个问题。因为没有事前规划好已经临近小程序上线即使需求较小现在再改代码会打乱发版节奏所以开发建议在上线后一周内紧接着迭代一个小版本把一些上线后暴露出来的问题和这个埋点需求整合在一版中。经过评估这也在可接受的范围内所以就按照这个节奏执行了。这才是实际业务场景中遇到的真实情况而不是书上讲的那么清晰和简单。所以并不是知道了一个方法论或者一个道理就可以直接套用而是要结合实际的业务再次深入思考并根据实际情况及时调整才能真正解决问题。总结从定位、到规划、再到落地一款微信小程序历经打磨后终于上线了。根据线上的数据和用户反馈然后开始进行下一版的迭代不但要解决线上的一些问题还有可能要修正原来的规划方向毕竟真实的效果和自己最初的设想常常会有非常大的出入。目前这个项目已经迭代了两个大版本。真实的项目不是闭门造车在实操的过程中一定会有大量的细节问题和业务问题所以我梳理了整个项目后在这里写下的文字略去了诸多细节只保留了整体的框架、核心的流程和关键的问题。如果问我在这个项目中收获最大的是什么？还是最开始时说的：首先是从0到1做了一款新产品这让我对整个产品的规划能力有了很大提升也对公司内部不同系统之间的协同与配合有了更深的理解；其次才是做了一款微信小程序对微信生态有了更多的思考对小程序的特点有了更多了解只有先掌握好小程序这个工具才能更好地服务实际业务。做产品和拍电影或写东西一样形式与内容两者不可偏废。本文由 @岳小鱼 原创发布于人人都是产品经理未经许可禁止转载。题图来自 Unsplash基于CC0协议                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    张小龙微信公开课PRO演讲：信息互联的7个思考               张小龙与其说是“未完成”不如说是“没想好”                                                        原作者: 岳小鱼                   来自: 人人都是产品经理                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序中解决网络请求缓存 ", "author": "                  Rolan                  2019-12-30 00:45                ", "text": "                                                                                                                                                                                     需求提交小程序审核时有一个体验测评产品让我们根据小程序的体验测评报告去优化小程序。其中有一项是网络请求的优化给我们出了很大的难题。文档中是这样解释的：3分钟以内同一个url请求不出现两次回包大于128KB且一模一样的内容看到这个问题的时候首先想到的是在响应头上加上cache-control经过测试发现小程序并不支持网路请求缓存。搜索发现官方明确答复小程序不支持网络请求缓存：wx.request不支持http缓存既然官方不支持网络请求缓存那只能自己想办法解决这个问题了。先来看一下需求：3分钟内同一请求只能请求一次。分析分析：只需做GET请求的网络缓存。缓存时间如何控制。做了缓存之后如何知道3分钟这个请求在服务端数据有没更新。提交GET请求前先检查本地有没有缓存前两点比较好实现虽然小程序不支持网络请求缓存但我们还是可以利用cache-control来实现这个功能。首先网络请求需不需要情缓存统一交给服务端去做服务端在处理GET请求时统一加上响应头cache-control如果需要缓存就用max-age=180如果不需要做网络请求就用no-cache。前端根据响应头信息自己做前端缓存。其中的难点是前端如何知道服务端数据有没更新如果服务端数据更新了前端还是使用缓存这是有问题的。经过一番思考后发现前端提交数据后相应的GET请求数据会更新也就是说前端只要有数据提交就应该把缓存清空。这有一个难点当前端提交数据时前端是不知道哪些GET请求会因此更新数据所以这个问题我们没有解决我的方法比较粗暴：只要前端提交了数据就将所有缓存清空。这是一个治标不治本的问题。实现公司项目封装了HTTP请求拦截请求如果是GET请求检查缓存如果缓存没过期将缓存返回出去不再发请求如果缓存过期发请求if (request.method.toLowerCase() === \"get\"){  // param 请求信息  const cache = this.handleCatchControl(request)  if (!cache.isRequest)    return this.listener.onApiResponse(request, 200, cache.data), sequence;   //将缓存返回给对应的请求}复制代码缓存网络请求// param 响应头上下文响应数据this.setCatchControl(headers, context, response.data)复制代码两个工具函数处理网络缓存设置网络缓存设置网络请求GET请求缓存数据其他请求清空数据数据格式：//如果同时发起多个`GET`请求需要拼接之前缓存数据ApiAgent.cacheData = Object.assign(ApiAgent.cacheData,{  [context.request.url]: {    //api    data,   //响应数据    expireTime: Number(cacheControl.split(\"=\")[1] + '000'),   //过期时间    cacheTime: new Date().getTime(),    //缓存时间  }})复制代码// param 响应头上下文响应数据setCatchControl(responseHeader: any, context: any, data: any) {  if (context.request.method.toLowerCase() === \"get\") {    const headers = HandleHeaders.get(responseHeader)    const cacheControl = headers[\"cache-control\"]    if (cacheControl && cacheControl !== \"no-cache\") {      ApiAgent.cacheData = Object.assign(ApiAgent.cacheData,{        [context.request.url]: {          data,          expireTime: Number(cacheControl.split(\"=\")[1] + '000'),          cacheTime: new Date().getTime(),        }      })    }  } else {    ApiAgent.cacheData = {}  }}复制代码处理网络缓存判断缓存是否存在判断缓存有没过期在设置缓存时比对当前时间和缓存时间是否小于失效时间// param 请求信息handleCatchControl(request): any {  const cacheArr = ApiAgent.cacheData  if (Object.keys(cacheArr).length === 0)    return { isRequest: true }  let cache = {}  Object.keys(cacheArr).forEach(cacheArrKey => {    if (cacheArrKey === request.url) {      cache = cacheArr[cacheArrKey]    }  })  const newDate = new Date().getTime()  if (newDate - cache.cacheTime < expireTime){    return { isRequest: false, data: cache.data }  }  return { isRequest: true}}复制代码响应头全部变成小写在小程序中无法确定响应头的大小写会导致报错所以统一处理响应头class HandleHeaders {  static get(headers: { [key: string]: string }) {    const headersData: any = {}    Object.keys(headers).forEach(key => {      headersData[key.toLowerCase()] = headers[key]    })    return headersData  }}复制代码总结有一点没有说就是这个缓存是保存在哪里的？既没有用localStorage也没有用globalapp用的是类的静态属性。这样做有3个好处：使用localStorage数据不好清除后期可维护性也较差缓存挂在globalapp和请求无直接联系无需在退出小程序时手动清理缓存我在使用时遇到一个坑是因为自己没有理解：类能保存数据的不能保存状态但类的对象是既可以保存数据也可以保存状态的。最后此方法还是有很大的优化空间。另外可添加微信ttxbg180218交流                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从CSS角度来做一个模态框               小程序wifi能力解读与实践                                                        原作者: 天天天天天                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "uni-app中picker组件“确定”和“取消”文字的修改 ", "author": "                  Rolan                  2019-11-11 00:45                ", "text": "                                                                                                                                                                                     本文为uniapp中picker组件“确定”和“取消”文字的修改的教程包括颜色和文字需要清楚的是颜色在H5和微信小程序下非常容易修改但是“确定”和“取消”文字是无法修改的因为在uniapp中这些都是写死在uniapp源码中的目前没有找到更好的方式去修改！前言首先需要确定的几点* 在uniapp中picker组件是webview（无论是小程序还是APPh5是dom）* 需要清楚自己需要修改的是什么版本的H5和APP以及小程序不一样* 是需要修改文字还是颜色* 没有源码阅读能力者请谨慎操作H5修改颜色非常方面但是修改文字目前只能改uniapp源码* 修改文字找到你安装HBuilderX的目录D:\\Program Files\\HBuilderX\\plugins\\uniapp-cli\\node_modules\\@dcloudio\\uni-h5\\src\\platforms\\h5\\view\\components\\picker\\index.vue// D:\\Program Files为你安装的HBuilderX目录// 在index.vue中16-25行代码中        <div          class=\"uni-picker-header\"          @click.stop>          <div            class=\"uni-picker-action uni-picker-action-cancel\"            @click=\"_cancel\">取消</div>          <div            class=\"uni-picker-action uni-picker-action-confirm\"            @click=\"_change\">确定</div>        </div>修改颜色可以直接在上面的index.vue里面修改但是这样做会带来一个问题就是每次升级HBuilderX的时候就需要修改这个文件// 在index.vue中550-558行代码中.uni-picker-container .uni-picker-action.uni-picker-action-cancel {  float: left;  color: #888;}.uni-picker-container .uni-picker-action.uni-picker-action-confirm {  float: right;  color: #007aff;}在App.vue中修改颜色uni-picker .uni-picker-action.uni-picker-action-confirm{color: #FF725C;}App和小程序在app和小程序中 H5版本的修改方法全部失效修改文字// 在D:\\Program Files\\HBuilderX\\plugins\\weapp-tools\\template\\common\\__uniapppicker.html// 第 5562-5577是“取消”和“确定”的文字}, [t._v('取消')]), e(\"div\", {    staticClass: \"uni-picker-action uni-picker-action-confirm\",    on: {    click: t._change    }}, [t._v('确定')])]), t.visible ? e(\"picker-view\", {    staticClass: \"uni-picker-content\",    attrs: {    value: t.valueArray},    on: {    \"update:value\": function(i) {        t.valueArray = i    }}},修改样式// 第14行css代码中.uni-picker-action.uni-picker-action-cancel[data-v-1c1d4578]{float:left;color:#888} // 取消.uni-picker-action.uni-picker-action-confirm[data-v-1c1d4578]{float:right;color:#57DBD0} //确定注意事项此方法在升级更新HBuilderX里面的文件就会重置请注意再次修改最好把自己项目需要修改的文件修改后备份                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序工程化之路               微信小程序实现去抖音视频水印                                                        原作者:  Fakin's                    来自:  Fakin's Blog                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序 webview 与 h5 实时通讯的实现 ", "author": "                  Rolan                  2019-8-21 00:07                ", "text": "                                                                                                                                                                                     在做 React Native 应用时如果需要在 App 里面内嵌 H5 页面那么 H5 与 App 之间可以通过 Webview 的 PostMessage 功能实现实时的通讯但是在小程序里面虽然也提供了一个\twebview 组件但是在进行\tpostMessage 通讯时官方文档里面给出了一条很变态的说明：网页向小程序\tpostMessage 时会在特定时机（小程序后退、组件销毁、分享）触发并收到消息。\te.detail = { data } \tdata 是多次\tpostMessage 的参数组成的数组这里面已经说的很明白了不管我们从 H5 页面里面\tpostMessage 多少次小程序都是收不到的除非：用户做了回退到上一页的操作组件销毁用户点击了分享这里面其实我没有完全说对官方其实说的是\t小程序后退 并没有说是用户做回退操作经过我的实测确实人家表达得很清楚了我们通过微信官方的SDK调起的回退也是完全可行的：wx.miniProgram.navigateBack()大体思路从上面的分析和实测中我们可以知道要实现无需要用户操作即可完成的通讯第三种情况我们是完全不需要考虑了的那么来仔细考虑第 1 和第 2 种场景。第 1 种方式：回退当我们想通过网页向小程序发送数据同时还可以回退到上一个页面时我们可以在\twx.miniProgram.postMessage 之后立马调用一次\twx.miniProgram.navigateBack() 此时小程序的操作是：postMessage我们在处理\tpostMessage 的时候做一些特殊操作可以将这些数据保存下来第 2 种方式：组件销毁这是我感觉最合适的一种方式可以让小程序拿到数据同时还保留在当前页面只需要销毁一次\twebview 即可大概的流程就是：小程序\tpostMessage小程序\tnavigateTo 将小程序页面导向一个特殊的页面小程序的那个特殊页面立马回退到\twebview 所在的页面webview 所在的页面的\tonShow 里面做一次处理将\twebview 销毁然后再次打开触发\tonMessage 拿到数据H5 页面再次被打开这种方式虽然变态但是至少可以做到实时拿到数据同时还保留在当前 H5 页面唯一需要解决的是在做这整套操作前H5 页面需要做好状态的缓存要不然再次打开之后H5 的数据就清空了。第 1 种方式：通过回退将数据提交给小程序之后传递给\twebview 的上一页面这种方式实现起来其实是很简单的我们现在新建两个页面：sandbox/canvas-by-webapp/index.jsconst app = getApp();Page({  data: {    url: '',    dimension: null,    mime: '',  },  handleSaveTap: function() {    wx.navigateTo({      url: '/apps/browser/index',      events: {        receiveData: data => {          console.log('receiveData from web browser: ', data);          if (typeof data === 'object') {            const { url, mime, dimension } = data;            if (url && mime && dimension) {              this.setData({                url,                dimension,                mime,              });              this.save(data);            }          }        }      }    })  },  save: async function({ url, mime, dimension }) {    try {      await app.saveImages([url]);      app.toast('保存成功！');    } catch (error) {      console.log(error);      app.toast(error.message || error);    }  },});上面的代码中核心点就在于\twx.navigateTo 调用时里面的\tevents 参数这是用来进行与\t/apps/browser/index 页面通讯接收数据用的。apps/browser/index.js我省略了绝大多数与本文无关的代码保存最主要的三个：Page({  onLoad() {    if (this.getOpenerEventChannel) {      this.eventChannel = this.getOpenerEventChannel();    }  },  handleMessage: function(message) {    const { action, data } = message;    if (action === 'postData') {      if (this.eventChannel) {        this.eventChannel.emit('receiveData', data);      }    }  },  handlePostMessage: function(e) {    const { data } = e.detail;    if (Array.isArray(data)) {      const messages = data.map(item => {        try {          const object = JSON.parse(item);          this.handleMessage(object);          return object;        } catch (error) {          return item;        }      });      this.setData({        messages: [...messages],      });    }  },})其实\tonLoad 方法中我们使用了自微信 SDK\t2.7.3 版本开始提供的\tgetOpenerEventChannel 方法它可以创建一个与上一个页面的事件通讯通道这个我们会在\thandleMessage 中使用。handlePostMessage 就是被\tbindmessage 至\twebview 上面的方法它用于处理从 H5 页面中\tpostMessage 过来的消息由于小程序是将多次\tpostMessage 的消息放在一起发送过来的所以与其它的Webview不同点在于我们拿到的是一个数组：\te.detail.data \thandlePostMessage的作用就是遍历这个数组取出每一条消息然后交由\thandleMessage 处理。handleMessage 在拿到\tmessage 对象之后将\tmessage.action 与\tmessage.data 取出来（*这里需要注意这是我们在 H5 里面的设计的一种数据结构你完全可以在自己的项目中设计自己的结构）根据\taction 作不同的操作我在这里面的处理是当\taction === 'postData' 时就通过\tgetOpenerEventChannel 得到的消息通道\tthis.eventChannel 将数据推送给上一级页面也就是\t/sandbox/canvas-by-webapp 但是不需要自己执行\tnavigateBack 因为这个需要交由H5 页面去执行。H5 页面的实现我的 H5 主要就是使用\thtml2canvas 库生成 Canvas 图（没办法自己在小程序里面画太麻烦了）但是这个不在本文讨论过程中我们就当是已经生成了\tcanvas 图片了将其转为\tbase64文本了然后像下面这样做：wx.miniProgram.postMessage({  data: JSON.stringify({    action: 'postData',    data: 'BASE 64 IMAGE STRING'  })});wx.miniProgram.navigateBack()将数据\tpostMessage 之后立即\tnavigateBack() 来触发一次回退也就触发了\tbindmessage 事件。使用销毁\twebview 实现实时通讯接下来咱就开始本文的重点了比较变态的方式但是也没想到更好的办法所以大家将就着交流吧。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序支持 webP 的 WebAssembly 方案               解决小程序中webview页面多层history返回问题                                                        原作者: 魑魅魍魉                   来自: pantao                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "通过json用canvas生成分享海报,支持微信小程序和web ", "author": "                  Rolan                  2019-6-19 00:39                ", "text": "                                                                                                                                                                                     需求在项目里写过几个canvas生成分享海报页面后,觉得这是个重复且冗余的工作.于是就想有没有能通过类似json直接生成海报的库.然后就在github找到到两个项目:wxa-plugin-canvas ,不太喜欢配置文件的写法.就没多去了解mp_canvas_drawer ,使用方式就比较符合直觉,不过可惜功能有点少.然后就想着能不能自己再造个轮子.于是就有了这个项目 json2canvas ,你可以简单的理解为是mp_canvas_drawer的增强版吧.json2canvas canvas绘制海报,写个json就够了.项目的canvas绘制是基于 cax 实现的.所以天然的带来一个好处,json2canvas同时支持小程序和web功能支持缩放. 如果设计稿是750,而画布只有375时.你不需要任何换算,只需要将scale设置为0.5即可.支持图片圆角支持圆型,矩形,矩形圆角(背景色支持线性渐变)长文本自动换行(感谢 coolzjy@v2ex 提供的正则 https://regexr.com/4f12l ,优化了换行的计算方式(不会粗暴的折断单词))支持分组(cax里很好用的一个功能)同时支持小程序和web示例demo-web 界面左边的json,可以进行编辑,直接看效果哟~小程序demogit clone https://github.com/willnewii/json2canvas.git微信开发者工具导入项目 example/weapp/小程序安装npm i json2canvas微信开发者工具->工具->构建npm在需要使用的界面引入Component{  \"usingComponents\": {    \"json2canvas\":\"/miniprogram_npm/json2canvas/index\"  }}举个例子想要生成一个这样的海报,需要怎么做？(红框是图片元素,蓝框是文字元素,其余的是一张背景图。)简单,一个json搞定.具体支持的元素和参数,请查看项目 readme{        \"width\": 750,        \"height\": 1334,        \"scale\": 0.5,        \"children\": [            {                \"type\": \"image\",                \"url\": \"http://res.mayday5.me/wxapp/wxavatar/tmp/bg_concerts_1.jpg\",                \"width\": 750,                \"height\": 1334            }, {                \"type\": \"image\",                \"url\": \"http://res.mayday5.me/wxapp/wxavatar/tmp/wxapp_code.jpg\",                \"width\": 100,                \"x\": 48,                \"y\": 44,                \"isCircular\": true,            }, {                \"type\": \"circle\",                \"r\": 50,                \"lineWidth\": 5,                \"strokeStyle\": \"#CCCCCC\",                \"x\": 48,                \"y\": 44,            }, {                \"type\": \"text\",                \"text\": \"歌词本\",                \"font\": \"30px Arial\",                \"color\": \"#FFFFFF\",                \"x\": 168,                \"y\": 75,                \"shadow\": {                    \"color\": \"#000\",                    \"offsetX\": 2,                    \"offsetY\": 2,                    \"blur\": 2                }            }, {                \"type\": \"image\",                \"url\": \"http://res.mayday5.me/wxapp/wxavatar/tmp/medal_concerts_1.png\",                \"width\": 300,                \"x\": \"center\",                \"y\": 361            }, {                \"type\": \"text\",                \"text\": \"一生活一场 五月天\",                \"font\": \"38px Arial\",                \"color\": \"#FFFFFF\",                \"x\": \"center\",                \"y\": 838,                \"shadow\": {                    \"color\": \"#000\",                    \"offsetX\": 2,                    \"offsetY\": 2,                    \"blur\": 2                }            }, {                \"type\": \"text\",                \"text\": \"北京6场郑州2场登船上班听到你想听的歌了吗？\",                \"font\": \"24px Arial\",                \"color\": \"#FFFFFF\",                \"x\": \"center\",                \"y\": 888,                \"shadow\": {                    \"color\": \"#000\",                    \"offsetX\": 2,                    \"offsetY\": 2,                    \"blur\": 2                }            }, {                \"type\": \"rect\",                \"width\": 750,                \"height\": 193,                \"fillStyle\": \"#FFFFFF\",                \"x\": 0,                \"y\": \"bottom\"            }, {                \"type\": \"image\",                \"url\": \"http://res.mayday5.me/wxapp/wxavatar/tmp/wxapp_code.jpg\",                \"width\": 117,                \"height\": 117,                \"x\": 47,                \"y\": 1180            }, {                \"type\": \"text\",                \"text\": \"长按识别小程序二维码\",                \"font\": \"26px Arial\",                \"color\": \"#858687\",                \"x\": 192,                \"y\": 1202            }, {                \"type\": \"text\",                \"text\": \"加入五月天 永远不会太迟\",                \"font\": \"18px Arial\",                \"color\": \"#A4A5A6\",                \"x\": 192,                \"y\": 1249            }]    }问题反馈有什么问题可以直接 提issue                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    基于uni-app的缓存器               [填坑手册]小程序目录结构和组件化使用心得                                                        原作者: 诗人的咸鱼                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "java后台的微信小程序支付的解决方案 ", "author": "                  Rolan                  2019-2-21 00:45                ", "text": "                                                                                                                                                                                     java的后台主要就写两个controller一个是 ----------------(1)调用支付统一下单API 生成 prepay_id二个是 ----------------(2)微信支付完成的回调controller第一个controller需要传入的参数有如下如图：然后发送到微信端把返回的结果里面的prepay_id给解析出来然后看微信文档传5个参数到前台去。然后前台小程序把这些参数调个函数wx.requestPayment传到微信端。就ok了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    认识小程序云开发               小程序框架的简单封装                                                        原作者: TaylorLambert                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序之Flex容器详解 ", "author": "                  Rolan                  2019-10-15 00:21                ", "text": "                                                                                                                                                                                     Flex 是 W3C 提出的一种新的布局方案可以非常方便的完成响应式页面布局到目前为止几乎所有浏览器都支持Flex 是 Flexible Box 的缩写翻译过来是\"弹性布局\"的意思下面一起来学习 Flex 布局的使用。基础概念flex容器属性flex项目属性总结基础概念采用 Flex 布局的元素称为 Flex 容器所有子元素将自动成为容器成员也可以称之为 Flex 项目也就是该 Flex 布局的子 View ,下面是 Flex 布局默认设置下的示意图：如上图所示默认的 Flex 容器的存在两个轴：水平的主轴(main axis)和垂直的交叉轴(cross axis)主轴和交叉轴的方向不是绝对的而是会因为设置的不同而不同下面是与主轴和交叉轴相关的几个位置：主轴起始点(main start):主轴的开始位置主轴的结束点(main end):主轴的结束位置主轴空间(main size):单个 Flex 项目占据的主轴空间交叉轴的起始点(cross start):交叉轴的起始点交叉轴的结束点(cross end):交叉轴的结束点交叉轴空间(cross size):单个 Flex 项目占据的交叉轴空间flex容器属性flex-direction：设置主轴的方向可设置的值如下：row：默认值设置主轴为水平方方向起点在左边row-revarse：设置主轴为水平方向起点在右边column：设置主轴为垂直方向起点在上边column-revarse：设置主轴为垂直方向起点在下边flex-wrap：设置如何换行可设置的值如下：nowrap：默认值不换行wap：自动换行wrap-revarse：自动换行在第一行的上一行nowrapwapwrap-revarseflex-flow：flex-direction 属性和 flex-wrap 属性的简写形式默认值为 row nowrap。justify-content：设置项目在主轴上的对齐方式可设置的值如下：flex-start：默认值左对齐flex-end：右对齐center：居中对齐space-between：两端对齐space-around：每个项目两侧的间隔相等与屏幕边缘的间隔是其他项目之间间隔的一半space-evenly：平均分布各个项目与屏幕边缘的间隔与其他项目之间的间隔相等flex-startflex-endcenterspace-betweenspace-aroundspace-evenlyalign-items：设置项目在交叉轴上如何对齐可设置的值如下：:默认值如果没有项目未指定高度或设置为auto,则项目会占满整个容器的高度可设置的值如下：stretch：默认值如果没有项目未指定高度或设置为auto,则项目会占满整个容器的高度下面图示中项目 1 就未指定高度其余项目都指定了高度就未指定高度flex-start：设置与交叉轴的起点对齐flex-end：设置与交叉轴的结束点对齐center：设置与交叉轴的重点对齐baseline：设置项目与项目中第一行文字基线对齐stretchflex-startflex-endcenterbaselinealign-content：设置多根轴线的对齐方式如果只有一个轴则该属性不生效可设置的属性如下：stretch：默认值轴线占满整个交叉轴flex-start：设置与与交叉轴的起点对齐flex-end：设置与交叉轴的终点对齐center：设置与交叉轴的中点对齐space-between：设置与交叉轴两端对齐轴线之间的间隔平均分布space-around：设置每根轴线两侧的间隔都相等轴线与轴线的间隔是轴线到交叉轴边缘间隔的两倍stretchflex项目属性order：默认值为0设置项目的排列顺序数值越小排列越靠前如下图所示：flex-grow：设置项目的放大比例默认值为0如果存在剩余空间也不放大如下图所示：flow-grow=0flow-grow=1flow-grow设置不同值flex-shrink：设置项目的缩小比例默认值为 1如果项目空间不足则项目将缩小如下图所示：flow-shrink=1flow-shrink=0flow-shrink设置不同值上面图示中当 flex-shrink 全设置为 0每个项目不会缩放所以第四个方块被挤出去了而相应的设置 flex-shrink 为 1则可以在空间不足是进行一定程度的缩放。flex-basis：项目所占的主轴空间如下图所示：align-self：定义元素自身的对齐方式该属性与 align-items 属性差不多具体就不一一介绍了直接上效果图如下：autostretchflex-startflex-endcenterbaseline上面的效果中设置 auto 会跟随 flex 容器中 align-items 的设置。flex：flex 是 flex-grow, flex-shrink 和 flex-basis 的简写默认值为0 1 auto这里就不在贴效果图了。总结最近尝试了一下微信小程序感觉开发起来难度也不是很大觉得本篇文章的内容也是微信小程序中最重要的内容了本来打算继续进行小程序系列的学习但是看了一下后面的内容无非就是小程序各个组件的使用了如果有其他项目的开发经验实在没必要一个组件一个组件去验证学习所以小程序的学习就到此为止最后说一点微信小程序最重要的我觉得还是 Flex 布局。可以选择关注个人微信公众号：jzman-blog 获取最新更新一起交流学习!                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序九九八十一坑之头像模糊谁的锅？               小程序 input 数据双向绑定实现方法之一                                                        原作者: jzman                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "安卓手机微信7.0.4调试小程序抓包https请求失败的问题和解决 ", "author": "                  Rolan                  2019-4-19 00:57                ", "text": "                                                                                                                                                                                     注意：阅读本文需要一台已经root的安卓手机！说明系统：MacOS 10.13.6手机：小米6（已root）抓包工具：Charles微信版本：7.0.4现象安卓手机无法通过Charles代理抓包https请求我前天（2019年04月16日）用的7.0.3不知道为什么能抓到昨天手残更新到7.0.4就不行了。而iOS（iPhone5S 12.1.4）没有问题。查找相关资料都说微信升级到版本7之后就限制了用户证书凭据。根据网上较多的推荐方案建议把证书放在系统证书存放目录下那这就 需要Root手机 了如果没有以下内容不适合阅读。接下来我尝试将Charles生成的证书放在手机的系统证书中并没有那么顺利很失败！我慢慢来讲解一下。步骤生成Charles证书我们要生成一个可以存放在系统证书目录下的可被识别的证书。手机代理设置好了后手机访问：<chls.pro/ssl>下载下来证书名称是这样的 charles-proxy-ssl-proxying-certificate.pem （你把这个文件搞到电脑上假设该证书存在电脑的路径： ~/charles-proxy-ssl-proxying-certificate.pem ）。在你的电脑 终端 通过这个命令生成一个hash值：openssl x509 -subject_hash_old -in ~/charles-proxy-ssl-proxying-certificate.pem可以看到输出了类似如下P750TM:webs whidy$ openssl x509 -subject_hash_old -in ~/certificate.pem 07e87b3d-----BEGIN CERTIFICATE-----MIIFYjCCBEqgAwIBAgIGAWeQpfWHMA.......77JclxPc0UdJHi5rOf7w+LU8YZFPdMTLa/c2JjMlspt08UeQVDE=-----END CERTIFICATE-----将证书更名 07e87b3d.0 注意后缀！接下来你可以用任意手段将该文件拷贝至手机的 /system/etc/security/cacerts/ 目录如果成功则再次尝试抓包如果失败请继续看。超级终端操作如果不嫌麻烦的话你完全可以在安卓手机上面的超级终端（自行下载的工具）进行以下操作但是我没有这样我在MacOSX中启用adb连接操作手机如果你正有此意请按照我的方式操作。电脑终端执行以下命令（这里不介绍brew不理解的自行学习）brew cask install android-platform-tools装好后数据线连上手机测试一下adb devices没报错且大概出现以下信息则正常：List of devices attached* daemon not running; starting now at tcp:5037* daemon started successfullyfa8a05fd    device然后获取root权限尝试将文件 07e87b3d.0 拷贝到 /system/etc/security/cacerts/adb root获得权限后直接执行下面命令将证书放入系统目录。push ~/07e87b3d.0 /system/etc/security/cacerts/如果成功了请尝试抓包。如果提示失败比如权限不足只读啥的反正大概错误信息如下：P750TM:/ whidy$ adb push ~/07e87b3d.0 /system/etc/security/cacerts/adb: error: failed to copy '/Users/whidy/07e87b3d.0' to '/system/etc/security/cacerts/07e87b3d.0': remote couldn't create file: Read-only file system/Users/whidy/07e87b3d.0: 0 files pushed. 0.0 MB/s (1947 bytes in 0.119s)那就要继续折腾了。网上抄到的chmod 777目前是不管用的。要通过mount的相关操作来解决这个问题。装载可写的system目录查看当前system目录挂载在哪里 mount 可以得到大致如下：rootfs on / type rootfs (ro,seclabel,size=2828452k,nr_inodes=707113)tmpfs on /dev type tmpfs (rw,seclabel,nosuid,relatime,size=2912600k,nr_inodes=728150,mode=755)devpts on /dev/pts type devpts (rw,seclabel,relatime,mode=600)proc on /proc type proc (rw,relatime,gid=3009,hidepid=2)sysfs on /sys type sysfs (rw,seclabel,relatime)selinuxfs on /sys/fs/selinux type selinuxfs (rw,relatime)/dev/block/dm-0 on /system type ext4 (ro,seclabel,relatime,discard,data=ordered)debugfs on /sys/kernel/debug type debugfs (rw,seclabel,relatime)none on /acct type cgroup (rw,relatime,cpuacct)none on /dev/stune type cgroup (rw,relatime,schedtune)tmpfs on /mnt type tmpfs (rw,seclabel,relatime,size=2912600k,nr_inodes=728150,mode=755,gid=1000)none on /config type configfs (rw,relatime)none on /dev/memcg type cgroup (rw,relatime,memory)注意到 /dev/block/dm-0 on /system type ext4 (ro,seclabel,relatime,discard,data=ordered) 这一行后面括号有个ro代表readonly！接下来尝试修改为可写（ rw ）状态：mount -o rw,remount /dev/block/dm-0 /system如果成功了就试试将文件拷贝进去失败了例如提示： '/dev/block/dm-0' is read-only请继续阅读。这里参考 Android O, failed to mount /system, /dev/block/dm-0 is read only 一顿操作！我这边是这样的：adb disable-verityadb reboot关闭验证是要重启设备的。执行重启后继续：adb rootadb remountadb shell再执行 mount 发现结果跟刚才不一样了找到有system的那一行发现这样的/dev/block/sde43 on /system type ext4 (rw,seclabel,relatime,discard,data=ordered)已经可写了我试试拷贝进去。执行 adb push ~/07e87b3d.0 /system/etc/security/cacerts/出现以下结果：P750TM:/ whidy$ adb push ~/07e87b3d.0 /system/etc/security/cacerts//Users/whidy/07e87b3d.0: 1 file pushed. 0.1 MB/s (1947 bytes in 0.022s)应该就完成了。再去我的小米6手机里面的 设置 > 更多设置 > 系统安全 > 加密与凭据 > 信任的凭据 > 系统 里面看看滚到最低部ok证书导入成功了。再去抓包看看~我这文章是边写边记录的现在可以看到https请求的抓包已经Ok啦~最后我建议最后还原之前操作的 disable-verity 这样操作一下：adb rootadb enable-verityadb reboot行了差不多就这些了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序ColorUI框架完成3d轮播效果               微信小程序：wxml中增加wxs脚本实现手机号/身份证等隐私信息显示 ...                                                        原作者:  whidy                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序周边配套的实现 ", "author": "                  Rolan                  2019-10-24 00:50                ", "text": "                                                                                                                                                                                     一 需求分析：以该小区为中心实现周边配套的检索切换不同种类的检索条件刷新页面并以气泡的方式显示出来效果如下~二 实现方式：底部我是用的vant组件的tabbar来实现切换显示 下载微信小程序JavaScriptSDK 引入SDK并且实例化API核心类var QQMapWX = require('../../../libs/qqmap-wx-jssdk.js')var app = getApp()// 实例化API核心类var qqmapsdk = new QQMapWX({  key: app.globalData.map_key // 必填});当切换底部标签时获取要搜索的关键字调用接口实现搜索// 事件触发调用接口  nearby_search: function() {    var _this = this;    // 调用接口    qqmapsdk.search({      keyword: _this.data.kewWord, //搜索关键词      location: {        latitude: _this.data.lat,        longitude: _this.data.lng      }, //设置周边搜索中心点      success: function(res) { //搜索成功后的回调        var mks = []        //在此将小区的位置坐标点加载出来        mks.push({          latitude: _this.data.lat,          longitude: _this.data.lng        })        for (var i = 0; i < res.data.length; i++) {          mks.push({ // 获取返回结果放到mks数组中            title: res.data[i].title,            id: res.data[i].id,            latitude: res.data[i].location.lat,            longitude: res.data[i].location.lng,            iconPath: _this.data.img, //图标路径            width: 24,            height: 28,            callout : {              color : \"#fff\",              padding : 8,              content: res.data[i].title,              borderRadius : 5,              bgColor: \"#3072f6\",              fontSize : 12            }          })        }        _this.setData({ //设置markers属性将搜索结果显示在地图中          markers: mks        })      },      fail: function(res) {        console.log(res);      },      complete: function(res) {        console.log(res);      }    });  },到这里基本上就实现了周边配套的需求现在你需要做的不过是规整一下整体逻辑和交互当点击图标会出现气泡框具体气泡的显示方式参照微信小程序的map组件即可作者：DevinZ                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序登录、支付（小程序、微信H5、非微信H5）即请求加密方法 ...               小程序页面统计埋点设计思路                                                        原作者: DevinZ                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序模块曝光埋点方法 ", "author": "                  Rolan                  2019-10-30 00:22                ", "text": "                                                                                                                                                                                     我们在处理模块曝光埋点时需要根据页面滚动的位置判断模块是否可见（被曝光）。Web 上传统方法是增加页面 scroll 监听事件根据滚动位置与模块位置进行对比判断小程序上也可以使用这种方法但现在有更便捷优雅的替代方案 —— IntersectionObserver 对象。IntersectionObserver 对象IntersectionObserver 对象用于推断某些节点是否可以被用户看见下面将介绍相关的 API：(1) 创建通过\tthis.createIntersectionObserver  创建该方法可传入的参数有三个：thresholds ：数值数组代表相交比例的阈值（可有多个取值范围\t[0,1] ）当相交到达该阈值时会触发一次监听回调在曝光埋点场景下设置为中间位置 \t[0.5] 即可；initialRatio ：初始相交比例如果方法调用时检测到的相交比例与这个值不相等且达到阈值则会触发一次监听器的回调函数在曝光埋点的场景下设置为默认值0即可；observeAll ：是否同时观测多个目标节点；(2) 设置参考区域设置参考区域的方法有两个：\tio.relativeToViewport() 和\tio.relativeTo('selector', { ...margins }) 如果判断相交参考区域是窗口则使用前者曝光埋点的场景下就使用这个；后者可用选择器设置其他节点作为相交的参考区域。(3) 监听开始监听方法：\tio.observe(selector, callback) selector代表目标模块的选择器当它和参考区域相交达到阈值比例时会触发 callback 回调函数回调函数接受如下几个参数（在该场景中暂时都不会用到）：intersectionRatio ： 两者相交比例；time ：相交检测时的时间戳；各种边界：intersectionRect ：相交区域的边界；boundingClientRect ：目标边界；relativeRect ：参照区域的边界； (4) 取消监听当页面退出时记得要取消监听：io.disconnect()。监听相交区域类我们可以设计一个类用来处理监听相交区域的逻辑。构造函数首先来看构造函数代码如下：class IntersectionObserver {  constructor(options) {    this.$options = {      context: null,      threshold: 0.5,      initialRatio: 0,      observeAll: false,      selector: null,      relativeTo: null,      onEach: res => res.dataset,      onFinal: () => null,      delay: 200,          ...options,    }    this.$observer = null  }}复制代码显然构造函数传入了一些重要的参数包括\tcreateIntersectionObserver  所需要的三个参数：\tthresholds, initialRatio, observeAll 和上下文\tcontext ；设置参考区域所需的\trelativeTo ；监听方法所需的目标模块选择器\tselector 。最后还有 IntersectionObserver 类监听调用时需要的三个参数：onEach：每一次触发监听调用时也会调用\tonEach 方法；onFinal：在触发监听调用一段时间\tdelay 后会调用一次\tonFinal 方法。在模块曝光埋点场景下如果页面在快速滚动时每次的监听触发都上报埋点一时间请求会堆积很多所以需要\tonFinal 方法在一段时间后统一上报曝光埋点；delay：调用\tonFinal 方法的间隔时间；监听要想开始监听相交区域需要先创建监听器设置完相交区域后再开始监听关键代码如下：_createObserver() {  const opt = this.$options  const observerOptions = {    thresholds: [opt.threshold],    observeAll: opt.observeAll,    initialRatio: opt.initialRatio,  }  // 创建监听器  const ob = opt.context    ? opt.context.createIntersectionObserver(observerOptions)    : wx.createIntersectionObserver(null, observerOptions)  // 相交区域设置  if (opt.relativeTo) ob.relativeTo(opt.relativeTo)  else ob.relativeToViewport()  // 开始监听  let finalData = []  let isCollecting = false     ob.observe(opt.selector, res => {    const { intersectionRatio } = res    const visible = intersectionRatio >= opt.threshold    if (!visible) return    const data = opt.onEach(res)    finalData.push(data)    if (isCollecting) return    // 正在收集监听结果不会调用 onFinal    isCollecting = true        // 设置延迟调用 onFinal    setTimeout(() => {      opt.onFinal.call(null, finalData)      finalData = []      isCollecting = false    }, opt.delay)  })  return ob}复制代码对外暴露的公用方法封装对外的\t_createObserver 方法：connect() {  if (this.$observer) return this  this.$observer = this._createObserver()  return this}复制代码封装停止监听的方法：disconnect() {  if (!this.$observer) return  const ob = this.$observer  if (ob.$timer) clearTimeout(ob.$timer)  ob.disconnect()  this.$observer = null}复制代码使用方法import IntersectionObserver from './intersection-observer.js';const ob = new IntersectionObserver({...})ob.connect()复制代码详见代码片段：\tdevelopers.weixin.qq.com/s/lqUakfmM7…总结当然曝光埋点也可以使用传统 Web 的监听 scroll 事件的方式。不过既然小程序提供了 IntersectionObserver API 并且几乎所有客户端都已支持那自然就用这种更方便的方式。另外在百度小程序和支付宝小程序上也有支持相关的API跨端开发也不用考虑其他小程序不支持。关于兼容性支付包小程序兼容性有待考证百度可以使用\tIntersectionObserver 不过需要注意\tthis.createIntersectionObserver 非组件是没有的只能使用\tswan.createIntersectionObserver(this)；第二点\tcreateIntersectionObserver 的参数\tobserveAll 需要改成\tselectAll （百度小程序代码片段：\tswanide://fragment/142c0f60156b1e850dc239553ecffe7b1571810456384 ）。参考文档官方文档 ；谈谈IntersectionObserver懒加载 （Web API 表现形式详解和小程序上相同）；                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从 WeRequest 登陆态管理来聊聊业务代码 原 荐               借助云开发实现互动打卡｜实战                                                        原作者:  w_西城                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序中图片/等款高圆变形问题解决(安卓端) ", "author": "                  Rolan                  2019-8-12 00:39                ", "text": "                                                                                                                                                                                     在项目中遇到 zfb小程序 在安卓端变形问题 等款高圆、icon会有此问题问题话不多说贴代码<view class=\"circle\"></view>复制代码原样式.circle {  width: 24rpx;  height: 24rpx;  border-radius: 12rpx;  background-size: 24rpx 24rpx;  background-color: green;}复制代码解决将background-color换成background-image 然后外部盒子变大, 可解决.circle {  width: 26rpx;  height: 26rpx;  border-radius: 12rpx;  background-size: 24rpx 24rpx;  background-repeat: no-repeat;  background-image: url('/imgs/icon/up.png');  background-position:  center;}复制代码官方回复最后原创文章文笔有限有更好的方式方法欢迎大家评论区留言讨论                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    撸一个微信小程序记事本备忘录-随微记               也许你并不需要第三方小程序框架                                                        原作者: ^—^                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序标签展开收起功能实现 ", "author": "                  Rolan                  2019-12-27 00:41                ", "text": "                                                                                                                                                                                     先看效果主要结构我用的mpvue如用原生标签直接转换成原生即可<div id=\"labelBox\">    <div class=\"label userLabel\" v-for=\"(label,inx) in labelList\" :key=\"inx\">{{label}}</div>    <div class=\"more\" v-show=\"showLabel===1\" id=\"moreLabel\" @click=\"openMore\">        <div>全部{{allLabel.length}}个</div>        <img class=\"icon ml5\" src=\"/static/img/i_label_down.png\" />    </div>    <div class=\"more\" v-show=\"showLabel===2\" @click=\"closeMore\">        <div>收起</div>        <img class=\"icon ml5\" src=\"/static/img/i_label_up.png\" />    </div></div>export default {    data() {        return {                    labelList: [],  // 视图显示的标签集合            allLabel: [],   // 所有的标签集合            firstLabel: [], // 默认显示的标签集合            showLabel: 1,   // 0 两个按钮都不显示1 显示展开2 显示收起        }    },    ...}思路利用小程序api NodesRef.boundingClientRect 获取节点的位置与大小信息主要用到 width,left,right循环所有标签(.userLabel)看是否有多行通过所有节点的 left 去判断如果 left 相同的有多个就证明有多行获取标签父级(#labelBox)的宽度 width获取到按钮(#moreLabel)的宽度过滤第一行节点的 right如果与按钮的width相加小于等于父级盒子的width就保留 具体的代码 wxp为微信接口Promise化会在之后列出用到的 export default {    data() {        return {                    labelList: [],  // 视图显示的标签集合            allLabel: [],   // 所有的标签集合            firstLabel: [], // 默认显示的标签集合            showLabel: 1,   // 0 两个按钮都不显示1 显示展开2 显示收起        }    },    methods: {        async loadPageData(){            // 请求后台数据            const res = ...            // 设置            this.allLabel = res.labes;          // 记录所有的标签            this.labelList = this.allLabel;     // 先插入所有表情            // 设置状态            if(this.allLabel.length>0){                await wxp.timeout(300); // 插入视图之后不会马上获取到节点信息延迟获取                this.setLabelStauts();            }                    },        // 设置标签状态        async setLabelStauts(){            const boxDom = await wxp.getElementById('#labelBox');            const labelDoms = await wxp.getElementsByClassName('.userLabel');            const btnDom = await wxp.getElementById('#moreLabel');            const left = labelDoms[0].left;            // 分行转为二维数组            let lineArr = [];                   let lineIndex = -1;            labelDoms.forEach(v => {                if(v.left==left){                    lineIndex++;                    lineArr[lineIndex] = [];                }                lineArr[lineIndex].push(v);            })            // 超过一行            if(lineArr.length>1){                // 默认显示加载更多按钮                this.showLabel = 1;                const firstTr = lineArr[0].filter(v => (v.right+btnDom.width+(left/15*15)) <= boxDom.width);                this.firstLabel = this.allLabel.slice(0,firstTr.length);                this.labelList = this.firstLabel;            }else{                this.showLabel = 0;            }        },        // 展开        openMore(){            this.showLabel = 2;            this.labelList = this.allLabel;        },        // 收起        closeMore(){            this.showLabel = 1;            this.labelList = this.firstLabel;        }    }}wxp.js相关代码/** * 延时 * @param {*} delay  */export const timeout = delay => new Promise(resolve => setTimeout(resolve, delay));/** * 根据ID获取dom的盒模型信息 * @param {*} id  */export const getElementById = (id='') => {    return new Promise((resolve, reject) => {        if ((typeof id).toLowerCase() !=='string'){            const err = {                errMsg: '请输入字符串例如 #box'            }            reject(error(err.errMsg,err));        } else if (id.indexOf('#') < 0) {            const err = {                errMsg: '请输入ID例如 #box'            }            reject(error(err.errMsg,err));        }else{            var query = wx.createSelectorQuery()            query.select(id).boundingClientRect();            query.selectViewport().scrollOffset();            query.exec(rect => {                if (rect[0]){                    let info = rect[0];                    info.position = {                        left: rect[1].scrollLeft + info.left,                        top: rect[1].scrollTop + info.top                    };                    resolve(info);                }else{                    const err = {                        errMsg: '没有获取到信息'                    }                    reject(error(err.errMsg,err));                }            })        }    })}/** * 根据类名获取dom信息 * @param {*} className  */export const getElementsByClassName = (className = '') => {    return new Promise((resolve, reject) => {        if ((typeof className).toLowerCase() !== 'string') {            const err = {                errMsg: '请输入字符串例如 .box'            }            reject(error(err.errMsg,err));        } else if (className.indexOf('.') < 0) {            const err = {                errMsg: '请输入类名例如 .box'            }            reject(error(err.errMsg,err));        } else {            wx.createSelectorQuery().selectAll(className).boundingClientRect(rects => {                resolve(rects);            }).exec();        }    })}作者：不二很纯洁链接：https://www.jianshu.com/p/87f3c14038a6                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    纯CSS实现圆环型进度条               给你的头像加个圣诞帽吧                                                        原作者: 不二很纯洁                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "最简单的小程序状态管理方案! - mobx-mini ", "author": "                  Rolan                  2019-12-2 09:15                ", "text": "                                                                                                                                                                                     写在前面状态管理可以说是现代前端开发中最核心的一环。为了解决前端应用的复杂度生态圈里诞生了各式各样的状态管理方案按编程范式分类有函数式（redux）响应式（rxjs）透明的函数响应式（mobx）按状态存储分类有单 store 和 多 store 的有专门处理异步代码的（rxjs）还有连异步都不处理的（redux）.....基本上可以满足各种场景的前端应用。然而受制于小程序封闭的生态各种状态方案的绑定库都无法在小程序内使用。已有的绑定库不能用？那就写一个呗。状态管理的目标在迈入正文前先说一下我们对状态管理方案的一些诉求：基于已有的状态管理方案redux, mobx, rxjs最大程度复用现有生态Typescript 友好（ts 真香）API 简单清晰性能基线高无需手动优化就能达到不错的性能。少模板代码代码敲多了手疼（说的就是 redux）rxjs 学习曲线过于陡峭也没定义状态如何存储划掉；redux 概念挺多模板代码和概念一样多不要。那就剩下 mobx 了。API首先定义 store并连接到页面。observer(context, mapState)import { observable } from 'mobx';import { observer } from 'mobx-mini';const rootStore = observable({  title: 'mobx-app'});const store = observable({  count: 0,  get isOdd() {    return this.seconds % 2 === 1;  },  tick() {    this.count += 1;  }});const mapState = () => ({  count: store.count,  seconds: store.isOdd,  title: rootStore.title,});// pagePage({  add() {    store.tick();  },  onLoad() {    observer(this, mapState);  },});复制代码直接在 axml 中使用吧<view>count</view>复制代码实现原理如果你还没有对 mobx 有所了解建议看一下它的中文文档 了解一下前置知识。原理就是 observer  APi 会对参数 mapState 中的 observable 对象注册 autorun 函数在 autorun 内部监听到 observable 变动后直接对页面  setData 。小程序的 data 就会动态更新了。总结提醒一下暂时只支持支付宝小程序且未在生产环境中使用过。源码在这里只有100行不到。github.com/luv-sic/mob…参考cn.mobx.js.org/github.com/b5156/mobx-…                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序图像处理：图片配色分析               微信小程序把base64的图片保存到手机相册                                                        原作者: Richoooo                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序组件化开发框架WePY ", "author": "                  Rolan                  2019-6-24 00:48                ", "text": "                                                                                                                                                                                     compilers： compilers为1.3.1版本之后的功能如果需要使用其它语法请先配置compilers然后再安装相应的compilers。目前支持wepy-compiler-less wepy-compiler-postcsswepy-compiler-sass、wepy-compiler-babel、wepy-compiler-pug其他compiler持续开发中......plugins： plugins为1.1.6版本之后的功能目前支持js压缩wepy-plugin-ugliyjs、图片压缩wepy-plugin-imagemin其他plugin持续开发中......lang决定了其代码编译过程src决定是否外联代码<style lang=\"less\" src=\"page1.less\"></style><template lang=\"wxml\" src=\"page1.wxml\"></template><script>    // some code</script><script>import wepy from 'wepy';export default class extends wepy.app {    config = {        \"pages\":[            \"pages/index/index\"        ],        \"window\":{            \"backgroundTextStyle\": \"light\",            \"navigationBarBackgroundColor\": \"#fff\",            \"navigationBarTitleText\": \"WeChat\",            \"navigationBarTextStyle\": \"black\"        }    };    onLaunch() {        console.log(this);    }}</script><style lang=\"less\">/** less **/</style><script>import wepy from 'wepy';import Counter from '../components/counter';export default class Page extends wepy.page {    config = {};    components = {counter1: Counter};    data = {};    methods = {};    events = {};    onLoad() {};    // Other properties}</script><template lang=\"wxml\">    <view>    </view>    <counter1></counter1></template><style lang=\"less\">/** less **/</style><template lang=\"wxml\">    <view>  </view></template><script>import wepy from 'wepy';export default class Com extends wepy.component {    components = {};    data = {};    methods = {};    events = {};    // Other properties}</script><style lang=\"less\">/** less **/</style>import wepy from 'wepy';// 声明一个App小程序实例export default class MyAPP extends wepy.app {}// 声明一个Page页面实例export default class IndexPage extends wepy.page {}// 声明一个Component组件实例export default class MyComponent extends wepy.component {}import wepy from 'wepy';export default class MyAPP extends wepy.app {    customData = {};    customFunction ()　{ }    onLaunch () {}    onShow () {}    config = {}  // 对应 app.json 文件    globalData = {}}在Page页面实例中可以通过this.$parent来访问App实例。import wepy from 'wepy';export default class MyPage extends wepy.page {// export default class MyComponent extends wepy.component {    customData = {}  // 自定义数据    customFunction ()　{}  //自定义方法    onLoad () {}  // 在Page和Component共用的生命周期函数    onShow () {}  // 只在Page中存在的页面生命周期函数    config = {};  // 只在Page实例中存在的配置数据对应于原生的page.json文件    data = {};  // 页面所需数据均需在这里声明可用于模板数据绑定    components = {};  // 声明页面中所引用的组件或声明组件中所引用的子组件    mixins = [];  // 声明页面所引用的Mixin实例    computed = {};  // 声明计算属性（详见后文介绍）    watch = {};  // 声明数据watcher（详见后文介绍）    methods = {};  // 声明页面wxml中标签的事件处理函数。注意此处只用于声明页面wxml中标签的bind、catch事件自定义方法需以自定义方法的方式声明    events = {};  // 声明组件之间的事件处理函数}// 错误示例import wepy from 'wepy';export default class MyComponent extends wepy.component {    methods = {        bindtap () {            let rst = this.commonFunc();            // doSomething        },        bindinput () {            let rst = this.commonFunc();            // doSomething        },        //错误：普通自定义方法不能放在methods对象中        customFunction () {            return 'sth.';        }    };}// 正确示例import wepy from 'wepy';export default class MyComponent extends wepy.component {    methods = {        bindtap () {            let rst = this.commonFunc();            // doSomething        },        bindinput () {            let rst = this.commonFunc();            // doSomething        },    }    //正确：普通自定义方法在methods对象外声明与methods平级    customFunction () {        return 'sth.';    }}/**project└── src    ├── components    |   └── child.wpy    ├── pages    |   ├── index.wpy    index 页面配置、结构、样式、逻辑    |   └── log.wpy      log 页面配置、结构、样式、逻辑    └──app.wpy           小程序配置项（全局公共配置、公共样式、声明钩子等）**/// index.wpy<template>    <!-- 以`<script>`脚本部分中所声明的组件ID为名命名自定义标签从而在`<template>`模板部分中插入组件 -->    <child></child></template><script>    import wepy from 'wepy';    //引入组件文件    import Child from '../components/child';    export default class Index extends wepy.page {        //声明组件分配组件id为child        components = {            child: Child        };    }</script><template>    <view class=\"child1\">        <child></child>    </view>    <view class=\"child2\">        <anotherchild></anotherchild>    </view></template><script>    import wepy from 'wepy';    import Child from '../components/child';    export default class Index extends wepy.page {        components = {            //为两个相同组件的不同实例分配不同的组件ID从而避免数据同步变化的问题            child: Child,            anotherchild: Child        };    }</script>/**project└── src    ├── components    |   └── child.wpy    ├── pages    |   ├── index.wpy    index 页面配置、结构、样式、逻辑    |   └── log.wpy      log 页面配置、结构、样式、逻辑    └──app.wpy           小程序配置项（全局样式配置、声明钩子等）**/// index.wpy<template>    <!-- 注意使用for属性而不是使用wx:for属性 -->    <repeat for=\"{{list}}\" key=\"index\" index=\"index\" item=\"item\">        <!-- 插入<script>脚本部分所声明的child组件同时传入item -->        <child :item=\"item\"></child>    </repeat></template><script>    import wepy from 'wepy';    // 引入child组件文件    import Child from '../components/child';    export default class Index extends wepy.page {        components = {            // 声明页面中要使用到的Child组件的ID为child            child: Child        }        data = {            list: [{id: 1, title: 'title1'}, {id: 2, title: 'title2'}]        }    }</script>  data = {      a: 1  }  // 计算属性aPlus在脚本中可通过this.aPlus来引用在模板中可通过{{ aPlus }}来插值  computed = {      aPlus () {          return this.a + 1      }  }通过监听器watcher能够监听到任何属性的更新。监听器在watch对象中声明类型为函数函数名与需要被监听的data对象中的属性同名每当被监听的属性改变一次监听器函数就会被自动调用执行一次。 data = {      num: 1  }  // 监听器函数名必须跟需要被监听的data对象中的属性num同名  // 其参数中的newValue为属性改变后的新值oldValue为改变前的旧值  watch = {      num (newValue, oldValue) {          console.log(`num value: ${oldValue} -> ${newValue}`)      }  }  // 每当被监听的属性num改变一次对应的同名监听器函数num()就被自动调用执行一次  onLoad () {      setInterval(() => {          this.num++;          this.$apply();      }, 1000)  }props = {    fromShopCar: Number  }props传值静态传值为父组件向子组件传递常量数据因此只能传递String字符串类型。在父组件template模板部分的组件标签中使用子组件props对象中所声明的属性名作为其属性名来接收父组件传递的值。<child title=\"mytitle\"></child>// child.wpyprops = {    title: String};onLoad () {    console.log(this.title); // mytitle}// parent.wpy<child :title=\"parentTitle\" :syncTitle.sync=\"parentTitle\" :twoWayTitle=\"parentTitle\"></child>data = {    parentTitle: 'p-title'};// child.wpyprops = {    // 静态传值    title: String,    // 父向子单向动态传值    syncTitle: {        type: String,        default: 'null'    },    twoWayTitle: {        type: String,        default: 'nothing',        twoWay: true    }};onLoad () {    console.log(this.title); // p-title    console.log(this.syncTitle); // p-title    console.log(this.twoWayTitle); // p-title    this.title = 'c-title';    console.log(this.$parent.parentTitle); // p-title.    this.twoWayTitle = 'two-way-title';    this.$apply();    console.log(this.$parent.parentTitle); // two-way-title.  --- twoWay为true时子组件props中的属性值改变时会同时改变父组件对应的值    this.$parent.parentTitle = 'p-title-changed';    this.$parent.$apply();    console.log(this.title); // 'c-title';    console.log(this.syncTitle); // 'p-title-changed' --- 有.sync修饰符的props属性值当在父组件中改变时会同时改变子组件对应的值。}wepy.component基类提供emit、$invoke三个方法用于组件之间的通信和交互import wepy from 'wepy'export default class Com extends wepy.component {    components = {};    data = {};    methods = {};    // events对象中所声明的函数为用于监听组件之间的通信与交互事件的事件处理函数    events = {        'some-event': (p1, p2, p3, $event) => {               console.log(`${this.$name} receive ${$event.name} from ${$event.source.$name}`);        }    };    // Other properties}@表示事件修饰符customEvent 表示事件名称.user表示事件后缀。目前总共有三种事件后缀：.default: 绑定小程序冒泡型事件如bindtap.default后缀可省略不写；.stop: 绑定小程序捕获型事件如catchtap；.user: 绑定用户自定义组件事件通过$emit触发。注意如果用了自定义事件则events中对应的监听函数不会再执行。// index.wpy<template>    <child @childFn.user=\"parentFn\"></child></template><script>    import wepy from 'wepy'    import Child from '../components/child'    export default class Index extends wepy.page {        components = {            child: Child        }        methods = {            parentFn (num, evt) {                console.log('parent received emit event, number is: ' + num)            }        }    }</script>// child.wpy<template>    <view @tap=\"tap\">Click me</view></template><script>    import wepy from 'wepy'    export default class Child extends wepy.component {        methods = {            tap () {                console.log('child is clicked')                this.$emit('childFn', 100)            }        }    }</script>slot 组件内容分发插槽在Panel组件中有以下模板：<view class=\"panel\">    <slot name=\"title\">默认标题</slot>    <slot name=\"content\">默认内容</slot></view>在父组件中使用Panel子组件时可以这样使用：<panel>    <view slot=\"title\">新的标题</view>    <view slot=\"content\">        <text>新的内容</text>    </view></panel>// mixins/test.jsimport wepy from 'wepy';export default class TestMixin extends wepy.mixin {    data = {        foo: 'foo defined by page',        bar: 'bar defined by testMix'    };    methods = {    tap () {      console.log('mix tap');    }  }}// pages/index.wpyimport wepy from 'wepy';import TestMixin from './mixins/test';export default class Index extends wepy.page {    data = {        foo: 'foo defined by index'    };    mixins = [TestMixin ];    onShow() {        console.log(this.foo); // foo defined by index        console.log(this.bar); // bar defined by testMix    }}// mixins/test.jsimport wepy from 'wepy';export default class TestMixin extends wepy.mixin {    methods = {        tap () {            console.log('mixin tap');        }    };    onShow() {        console.log('mixin onshow');    }}// pages/index.wpyimport wepy from 'wepy';import TestMixin from './mixins/test';export default class Index extends wepy.page {    mixins = [TestMixin];    methods = {        tap () {            console.log('index tap');        }    };    onShow() {        console.log('index onshow');    }}// index onshow// mixin onshow// ----- when tap// index tap// mixin tapimport wepy from 'wepy';export default class extends wepy.app {    constructor () {        // this is not allowed before super()        super();        // 拦截request请求        this.intercept('request', {            // 发出请求时的回调函数            config (p) {                // 对所有request请求中的OBJECT参数对象统一附加时间戳属性                p.timestamp = +new Date();                console.log('config request: ', p);                // 必须返回OBJECT参数对象否则无法发送请求到服务端                return p;            },            // 请求成功后的回调函数            success (p) {                // 可以在这里对收到的响应数据对象进行加工处理                console.log('request success: ', p);                // 必须返回响应数据对象否则后续无法对响应数据进行处理                return p;            },            //请求失败后的回调函数            fail (p) {                console.log('request fail: ', p);                // 必须返回响应数据对象否则后续无法对响应数据进行处理                return p;            },            // 请求完成时的回调函数(请求成功或失败都会被执行)            complete (p) {                console.log('request complete: ', p);            }        });    }}WePY脏数据检查流程// 原生代码:wx.request({    url: 'xxx',    success: function (data) {        console.log(data);    }});// WePY 使用方式, 需要开启 Promise 支持参考开发规范章节wepy.request('xxxx').then((d) => console.log(d));// async/await 的使用方式, 需要开启 Promise 和 async/await 支持参考 WIKIasync function request () {   let d = await wepy.request('xxxxx');   console.log(d);}// 原生的事件传参方式:<view data-id=\"{{index}}\" data-title=\"wepy\" data-other=\"otherparams\" bindtap=\"tapName\"> Click me! </view>Page({    tapName: function (event) {        console.log(event.currentTarget.dataset.id)// output: 1        console.log(event.currentTarget.dataset.title)// output: wepy        console.log(event.currentTarget.dataset.other)// output: otherparams    }});// WePY 1.1.8以后的版本只允许传string。<view @tap=\"tapName({{index}}, 'wepy', 'otherparams')\"> Click me! </view>methods: {    tapName (id, title, other, event) {        console.log(id, title, other)// output: 1, wepy, otherparams    }}// 原生代码:<view> {{ message }} </view>onLoad: function () {    this.setData({message: 'hello world'});}// WePY<view> {{ message }} </view>onLoad () {    this.message = 'hello world';}// 原生代码:<!-- item.wxml --><template name=\"item\">  <text>{{text}}</text></template><!-- index.wxml --><import src=\"item.wxml\"/><template is=\"item\" data=\"{{text: 'forbar'}}\"/><!-- index.js -->var item = require('item.js')// WePY<!-- /components/item.wpy --> <text>{{text}}</text><!-- index.wpy --><template>    <com></com></template><script>    import wepy from 'wepy';    import Item from '../components/item';    export default class Index extends wepy.page {        components = { com: Item }    }</script>请点赞！因为你的鼓励是我写作的最大动力！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序自定义组件boundingClientRect获取到的rect值为null               mpvue框架使用记录                                                        原作者: 达叔小生                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "从 VantComponent 谈 小程序维护 ", "author": "                  Rolan                  2019-5-14 00:45                ", "text": "                                                                                                                                                                                     在开发小程序的时候我们总是期望用以往的技术规范和语法特点来书写当前的小程序所以才会有各色的小程序框架例如 mpvue、taro 等这些编译型框架。当然这些框架本身对于新开发的项目是有所帮助。而对于老项目我们又想要利用 vue 的语法特性进行维护又该如何呢？在此我研究了一下youzan的 vant-weapp。而发现该项目中的组件是如此编写的。import { VantComponent } from '../common/component';VantComponent({  mixins: [],  props: {    name: String,    size: String  },  // 可以使用 watch 来监控 props 变化  // 其实就是把properties中的observer提取出来  watch: {    name(newVal) {       ...    },    // 可以直接使用字符串 代替函数调用    size: 'changeSize'  },  // 使用计算属性 来 获取数据可以在 wxml直接使用  computed: {    bigSize() {      return this.data.size + 100    }  }  data: {    size: 0  },  methods: {    onClick() {      this.$emit('click');    },    changeSize(size) {       // 使用set       this.set(size)    }  },  // 对应小程序组件 created 周期  beforeCreate() {},  // 对应小程序组件 attached 周期  created() {},  // 对应小程序组件 ready 周期  mounted() {},  // 对应小程序组件  detached 周期  destroyed: {}});复制代码居然发现该组件写法整体上类似于 Vue 语法。而本身却没有任何编译。看来问题是出在了导入的 VantComponet 这个方法上。下面我们开始详细介绍一下如何利用 VantComponet 来对老项目进行维护。TLDR (不多废话先说结论)小程序组件写法这里就不再介绍。这里我们给出利用 VantComponent 写 Page 的代码风格。import { VantComponent } from '../common/component'; VantComponent({  mixins: [],  props: {    a: String,    b: Number  },  // 在页面这里 watch 基本上是没有作用了因为只做了props 变化的watchpage不会出现 props 变化  // 后面会详细说明为何  watch： {},  // 计算属性仍旧可用  computed: {    d() {      return c++    }  },  methods: {    onLoad() {}  },  created() {},  // 其他组件生命周期})复制代码这里你可能感到疑惑VantComponet 不是对组件 Component 生效的吗？怎么会对页面 Page 生效呢。事实上我们是可以使用组件来构造小程序页面的。在官方文档中我们可以看到 使用 Component 构造器构造页面事实上小程序的页面也可以视为自定义组件。因而页面也可以使用 Component 构造器构造拥有与普通组件一样的定义段与实例方法。代码编写如下:Component({    // 可以使用组件的 behaviors 机制,虽然 React 觉得 mixins 并不是一个很好的方案    // 但是在某种程度该方案的确可以复用相同的逻辑代码    behaviors: [myBehavior],       // 对应于page的options与此本身是有类型的而从options 取得数据均为 string类型    // 访问 页面 /pages/index/index?paramA=123&paramB=xyz     // 如果声明有属性 paramA 或 paramB 则它们会被赋值为 123 或 xyz而不是 string类型    properties: {        paramA: Number,        paramB: String,    },    methods: {        // onLoad 不需要 option        // 但是页面级别的生命周期却只能写道 methods中来        onLoad() {            this.data.paramA // 页面参数 paramA 的值 123            this.data.paramB // 页面参数 paramB 的值 ’xyz’        }    }})复制代码那么组件的生命周期和页面的生命周期又是怎么对应的呢。经过一番测试得出结果为： (为了简便。只会列出 重要的的生命周期)// 组件实例被创建 到 组件实例进入页面节点树component created -> component attched -> // 页面页面加载 到  组件在视图层布局完成page onLoad -> component ready -> // 页面卸载 到 组件实例被从页面节点树移除page OnUnload -> component detached复制代码当然 我们重点不是在 onload 和 onunload 中间的状态因为中间状态的时候我们可以在页面中使用页面生命周期来操作更好。某些时候我们的一些初始化代码不应该放在 onload 里面我们可以考虑放在 component create 进行操作甚至可以利用 behaviors 来复用初始化代码。某种方面来说如果不需要 Vue 风格我们在老项目中直接利用 Component 代替 Page 也不失为一个不错的维护方案。毕竟官方标准不用担心其他一系列后续问题。VantComponent 源码解析VantComponent此时我们对 VantComponent 开始进行解析// 赋值根据 map 的 key 和 value 来进行操作function mapKeys(source: object, target: object, map: object) {  Object.keys(map).forEach(key => {    if (source[key]) {      // 目标对象 的 map[key] 对应 源数据对象的 key      target[map[key]] = source[key];    }  });}// ts代码也就是 泛型function VantComponent<Data, Props, Watch, Methods, Computed>(  vantOptions: VantComponentOptions<    Data,    Props,    Watch,    Methods,    Computed,    CombinedComponentInstance<Data, Props, Watch, Methods, Computed>  > = {}): void {  const options: any = {};  // 用function 来拷贝 新的数据也就是我们可以用的 Vue 风格  mapKeys(vantOptions, options, {    data: 'data',    props: 'properties',    mixins: 'behaviors',    methods: 'methods',    beforeCreate: 'created',    created: 'attached',    mounted: 'ready',    relations: 'relations',    destroyed: 'detached',    classes: 'externalClasses'  });  // 对组件间关系进行编辑但是page不需要可以删除  const { relation } = vantOptions;  if (relation) {    options.relations = Object.assign(options.relations || {}, {      [`../${relation.name}/index`]: relation    });  }  // 对组件默认添加 externalClasses但是page不需要可以删除  // add default externalClasses  options.externalClasses = options.externalClasses || [];  options.externalClasses.push('custom-class');  // 对组件默认添加 basic封装了 $emit 和小程序节点查询方法可以删除  // add default behaviors  options.behaviors = options.behaviors || [];  options.behaviors.push(basic);  // map field to form-field behavior  // 默认添加 内置 behavior  wx://form-field  // 它使得这个自定义组件有类似于表单控件的行为。  // 可以研究下文给出的 内置behaviors  if (vantOptions.field) {    options.behaviors.push('wx://form-field');  }  // add default options  // 添加组件默认配置多slot  options.options = {    multipleSlots: true,// 在组件定义时的选项中启用多slot支持    // 如果这个 Component 构造器用于构造页面 则默认值为 shared    // 组件的apply-shared可以研究下文给出的 组件样式隔离    addGlobalClass: true   };  // 监控 vantOptions  observe(vantOptions, options);  // 把当前重新配置的options 放入Component  Component(options);}复制代码内置behaviors组件样式隔离basic behaviors刚刚我们谈到 basic behaviors代码如下所示export const basic = Behavior({  methods: {    // 调用 $emit组件 实际上是使用了 triggerEvent    $emit() {      this.triggerEvent.apply(this, arguments);    },    // 封装 程序节点查询    getRect(selector: string, all: boolean) {      return new Promise(resolve => {        wx.createSelectorQuery()          .in(this)[all ? 'selectAll' : 'select'](selector)          .boundingClientRect(rect => {            if (all && Array.isArray(rect) && rect.length) {              resolve(rect);            }            if (!all && rect) {              resolve(rect);            }          })          .exec();      });    }  }});复制代码observe小程序 watch 和 computed的 代码解析export function observe(vantOptions, options) {  // 从传入的 option中得到 watch computed    const { watch, computed } = vantOptions;  // 添加  behavior  options.behaviors.push(behavior);  /// 如果有 watch 对象  if (watch) {    const props = options.properties || {};    // 例如:     // props: {    //   a: String    // },    // watch: {    //   a(val) {    //     // 每次val变化时候打印    //     consol.log(val)    //   }    }     Object.keys(watch).forEach(key => {            // watch只会对prop中的数据进行 监视      if (key in props) {        let prop = props[key];        if (prop === null || !('type' in prop)) {          prop = { type: prop };        }        // prop的observer被watch赋值也就是小程序组件本身的功能。        prop.observer = watch[key];        // 把当前的key 放入prop        props[key] = prop;      }    });    // 经过此方法    // props: {    //  a: {    //    type: String,    //    observer: (val) {    //      console.log(val)    //    }    //  }    // }    options.properties = props;  }  // 对计算属性进行封装  if (computed) {    options.methods = options.methods || {};    options.methods.$options = () => vantOptions;    if (options.properties) {            // 监视props如果props发生改变计算属性本身也要变      observeProps(options.properties);    }  }}复制代码observeProps现在剩下的也就是 observeProps 以及 behavior 两个文件了这两个都是为了计算属性而生成的这里我们先解释 observeProps 代码export function observeProps(props) {  if (!props) {    return;  }  Object.keys(props).forEach(key => {    let prop = props[key];    if (prop === null || !('type' in prop)) {      prop = { type: prop };    }    // 保存之前的 observer也就是上一个代码生成的prop    let { observer } = prop;    prop.observer = function() {      if (observer) {        if (typeof observer === 'string') {          observer = this[observer];        }        // 调用之前保存的 observer        observer.apply(this, arguments);      }      // 在发生改变的时候调用一次 set 来重置计算属性      this.set();    };    // 把修改的props 赋值回去    props[key] = prop;  });}复制代码behavior最终 behavior也就算 computed 实现机制// 异步调用 setDatafunction setAsync(context: Weapp.Component, data: object) {  return new Promise(resolve => {    context.setData(data, resolve);  });};export const behavior = Behavior({  created() {    if (!this.$options) {      return;    }    // 缓存    const cache = {};    const { computed } = this.$options();    const keys = Object.keys(computed);    this.calcComputed = () => {      // 需要更新的数据      const needUpdate = {};      keys.forEach(key => {        const value = computed[key].call(this);        // 缓存数据不等当前计算数值        if (cache[key] !== value) {          cache[key] = needUpdate[key] = value;        }      });      // 返回需要的更新的 computed      return needUpdate;    };  },  attached() {    // 在 attached 周期 调用一次算出当前的computed数值    this.set();  },  methods: {    // set data and set computed data    // set可以使用callback 和 then    set(data: object, callback: Function) {      const stack = [];      // set时候放入数据      if (data) {        stack.push(setAsync(this, data));      }      if (this.calcComputed) {        // 有计算属性同样也放入 stack中但是每次set都会调用一次props改变也会调用        stack.push(setAsync(this, this.calcComputed()));      }      return Promise.all(stack).then(res => {        // 所有 data以及计算属性都完成后调用callback        if (callback && typeof callback === 'function') {          callback.call(this);        }        return res;      });    }  }});复制代码写在后面js 是一门灵活的语言(手动滑稽)本身 小程序 Component 在 小程序 Page 之后就要比Page 更加成熟好用有时候新的方案往往藏在文档之中每次多看几遍文档绝不是没有意义的。小程序版本 版本2.6.1 Component  目前已经实现了 observers可以监听 props data 数据监听器,目前 VantComponent没有实现当然本身而言Page 不需要对 prop 进行监听因为进入页面压根不会变而data变化本身就无需监听直接调用函数即可所以对page而言observers 可有可无。该方案也只是对 js 代码上有vue的风格并没在 template 以及 style 做其他文章。该方案性能一定是有所缺失的因为computed是每次set都会进行计算而并非根据set 的 data 来进行操作在删减之后我认为本身是可以接受。如果本身对于vue的语法特性需求不高可以直接利用 Component 来编写 Page选择不同的解决方案实质上是需要权衡各种利弊。如果本身是有其他要求或者新的项目仍旧推荐使用新技术如果本身是已有项目并且需要维护的同时又想拥有 Vue 特性。可以使用该方案因为代码本身较少而且本身也可以基于自身需求修改。同时vant-weapp是一个非常不错的项目推荐各位可以去查看以及star。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序的一些小知识总结               小程序开发前的准备工作之【深入封装Component】                                                        原作者: jump_jump                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "张小龙微信公开课PRO演讲：信息互联的7个思考 ", "author": "                  Rolan                  2020-1-10 00:02                ", "text": "                                                                                                                                                                                     划重点：之前我们限定一个人最多5000个好友现在有将近一百万人已经接近5000好友。虽然不是真正意义上的好友但也促使我们要扩大好友数目了。作为平台因为我们有大量的数据什么该用什么不该用其实是我们一直思考的问题。我们在这里也倡导同行一起重视这个问题。虽然头部大号会有最大的浏览量但是在一个人人皆可创作的年代我们希望长尾的小号都有自己的生存空间。朋友圈之所以默认是发照片视频的是因为当时我有一个认知对于十亿人来说让每个人发文字是不容易的但是发照片是每个人都可以做到的。公开课的朋友们大家好。又到了一年一度的微信公开课。很抱歉这次没有来到现场在这里跟大家打个招呼。其实我是故意不来现场的。记得第一次公开课我提到说参加各种会议可能是很浪费时间的。我还说过用产品说话才是我们应该做的。大家也看到微信从来没有开过发布会。我认为新版本的启动页就是微信的发布会它直接覆盖几亿用户。但同事们说服我说公开课不是发布会而是面向开发者的会议。确实外界可能也会对微信有好奇甚至误解所以公开课确实是一个微信对外阐述自己想法、理念的一个很好的机会。但去年我就想微信团队现在这么大了我们面临的问题从早期的“怎么做”到现在的“做什么”。早期我们聚焦于每一项功能思考怎么做才是最完美的。现在是思考什么才是我们应该去尝试的以及如何组织起来做。对团队来说早期是考验我们的产品能力现在更考验的是我们的组织能力。我希望我们团队在每一个领域都有杰出的深入的思考者。所以去年我就在想我不一定每年都来公开课讲。今年我更乐意把时间让给我的同事们让他们来给大家带来我们团队的思考。当然我个人也有一些小的思考点可以在这里分享给大家。信息互联的影响可能从来没有一个时代每天有数亿人花这么多时间花在手机里面浏览各种信息。而微信可能是人们花时间最多的应用。所以我也经常会思考微信作为一个基础的信息传递的工具或者说平台我们一个不经意的动作可能会引起信息洪流的流向的变化。我们知道基因编辑是一种非自然的选择。因为人类强行的改变了自然进化的进展。类似的技术的进步同样改变了自然的选择。人们看到屏幕上的视觉信息超过了现实中眼睛看到的信息。人们看到的是远方的图像听到的是远方的声音。从前一个人的世界他的大小是由他的脚的行走半径来决定的现在一个人的世界的大小是由他所获得的信息的宽广度来决定的。信息的宽广度和质量一直是微信要解决的问题。但人类对于信息的广泛连接带来的影响的思考是落后于网络的发展速度的。网络的发展尤其是最近几年移动互联网的发展使得人人都随时在线并且面临海量的信息。这在历史上甚至十年前都是难以想象的。人们真的能驾驭这种信息互联吗？还是说技术在引导甚至控制人们的生活方式？可以从几个维度来看一看这种影响包括隐私的出让信息获取的被动社会关系的扩大和复杂信息传播的快速信息选择的困难、信息的多样性搜索的困难。一. 隐私的出让从历史来看科技越发达个人隐私会越少。人们在获取便利性的同时其实也在不知不觉地一点一点把自己的隐私范围缩小。比如精准广告和用户隐私其实是有矛盾的。作为平台因为我们有大量的数据什么该用什么不该用其实是我们一直思考的问题。我们在这里也倡导同行一起重视这个问题。二. 信息获取的被动你所看见的或者说你所阅读的决定你是什么样的人会有什么样的想法。互联网让信息唾手可得。可是从信息的海洋中获取什么样的信息是个很有挑战的问题。事实上很多人并不愿意主动去获取信息而是更倾向于被动获取。记得好几年前我说过一句话“推送改变世界因为用户更懒了”。包括微信也是基于推送的。你收到的每一条消息都被你把优先级排得比你要真正要获取的信息的优先级要更高一些。那么推送什么信息决定了用户会看什么信息决定了他在一个什么样的世界里。这是一个我们要经常思考的问题也是我们在努力的方向。所以我很少说分发这个词我觉得推荐可能更尊重一些。三. 社会关系的扩大和复杂人是社会关系的总和。而如今社会关系越来越多地体现在微信好友群朋友圈的互动里面。比如中学、大学同学因群而活跃起来。过去学术上有个词叫邓巴数是说一个人最多有150个好友。但在微信里显然它被打破了。人们对于好友的维系能力和移动互联网之前的年代相比突然增大了很多。之前我们限定一个人最多5000个好友现在有将近一百万人已经接近5000好友。虽然不是真正意义上的好友但也促使我们要扩大好友数目了。我记得附近的人上线时我自己其实都有隐隐的不安因为从前我们和附近的人的界限将被打破我不知道它是好是坏。这种思考其实会一直贯穿在微信的进化里面。就像我们扩大5000好友这个限定非常容易但是对于它带来的影响说实话诚惶诚恐我们会反复思考。四. 信息传播的快速一方面是信息比之前更快速地传播可能一个瞬间一个事件就可以迅速在很多个群里面迅速的几何级数的传播。另一方面有一句话叫“谣言传千里”耸人听闻的内容可能能获得更大的传播机会。这是人性使然。我们可能很难用技术手段作为一个判定内容的质量的标准但作为信息传递的平台我们也有很多办法譬如说用更多的参与者和强大的机制来帮助平台作出仲裁就像我们对待原创和抄袭的做法很类似。五. 信息选择的困难看似我们面对海量信息可以自由选择哪一些看、哪一些不看但事实上我们不可能有时间去一一筛选导致我们看到的总是局部。包括公众号看似可以随便关注但是你的选择其实是有限空间的。我们在看一看里实验了社交推荐看起来效果还不错。它是一种通过好友之间的互相推荐来扩大人的选择范围。六. 信息的多样性虽然头部大号会有最大的浏览量但是在一个人人皆可创作的年代我们希望长尾的小号都有自己的生存空间。这也是之前公众号一个忽略了的部分。等一下会再讲一下。七. 搜索的困难与web互联网相比移动互联网的各个app更加割裂信息难以打通、搜索。我们做小程序就有一个梦想希望搜索能进入到每一个小程序的内部这样海量的小程序可以支撑起各种长尾的搜索需求。当然小程序仍然是我们一直要改进的领域只有小程序足够繁荣才能支撑起搜索的内容的丰富度。关于“信息的多样性”的延伸这里讲了我们对于信息普及、对于生活的影响其中提到信息的多样性。这里也要说一下。在微信的起步阶段我就说过我们基于手机来做app不基于pc来做。pc端只是辅助。如果不是这样的话我们没有办法将我们的产品普及到每一个人都能用。回过头来看我们当年有两个小小失误一个是公众平台。很长时间都只有pc web版这限制了内容创作者的范围。另一个是也是更重要的公众平台的原始想法是取代短信成为一种基于连接品牌和订户的群发工具并且有效地避免垃圾短信。群发的内容并不是重点应该是各种各样的形式的内容都应该是可以的如文字图片视频等。但我们一不小心把它做成了文章作为内容的载体使得其他的短内容的形式没有呈现出来那使得我们在短内容方面有一定的缺失。这也是为什么之前我说公众号本身并不是为媒体准备的这样一个原因。我们很重视人人都可创造的内容。朋友圈之所以默认是发照片视频的是因为当时我有一个认知对于十亿人来说让每个人发文字是不容易的但是发照片是每个人都可以做到的。所以相对公众号而言我们缺少了一个人人可以创作的载体。因为不能要求每个人都能天天写文章。所以就像之前在公开课所说的一样微信的短内容一直是我们要发力的方向顺利的话可能近期也会和大家见面。毕竟表达是每个人天然的需求。所以这里也是作为一个对新版本的小预告吧。春节即将到来我们在红包上也有一些新的创造可能也会吸引你来发挥你的创造力这里也预告一下。今天我的分享就到这里。虽然这次我没有参与现场的演讲但是我相信我的同事们同样会给你带来精彩的报告。再次感谢大家。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    阿拉丁发布2019年小程序年度生态白皮书：小程序互联网时代到来 ...               产品经理项目实录：怎样从0到1做一款微信小程序？                                                        原作者: 腾讯科技                   来自: 腾讯科技                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "在腾讯Q3财报中站C位的品牌小程序，BAT态度大不同！ ", "author": "                  Rolan                  2019-11-22 00:12                ", "text": "                                                                                                                                                                                     昨天腾讯2019年Q3财报如“约”而至。其中小程序数据格外亮眼不仅日活跃用户超过3亿商业化也表现强劲中长尾小程序日均商业交易笔数同比增加超过一倍。值得注意的是这组数据中“品牌”二字尤其“夺目”财报显示：品牌自营类小程序数量同比增长1倍以上；8%的品牌自营类小程序交易额同比增长100倍以上、56%的品牌自营类小程序交易额同比增长50%以上在头部领跑下中腰部正在崛起；超过1亿人次访问品牌自营类小程序。这一定程度上说明了越来越多的品牌选择了微信小程序作为重要阵地。因此要让用户在众多品牌中一眼就能发现自己品牌曝光是首要环节。对于企业而言如果没做好品牌曝光自家品牌就会淹没在“芸芸众生”之中而这一局面在搜索场景下尤为突出。比如用户输入一个关键词结果“数不胜数”无论用户看多少眼也不一定会注意到。于是BAT三巨头接踵而至地基于自家搜索推出一个能力：品牌主页。直白点说“品牌主页”就是：在搜索结果页中将企业各类信息与服务放在一起整体展示比如企业认证信息、小程序、服务等等入口更直接。微信“品牌主页”叫作品牌官方区于去年4月基于搜一搜推出在公众号后台便可开通；相比之下支付宝与百度则慢了好几拍都是最近才推出小程序能力前者叫品牌直达后者称百度品牌名片。虽然叫法不同（以下统称时称为“品牌主页”）但其目的是一致的都是为了帮助企业更好地建立品牌效应、将服务充分触达用户从而提升收益。但BAT三平台的属性不同“品牌主页”的能力开放程度、玩法等也有所差异并非都能满足所有企业的需求企业们在选择上也就“不知所云”。对此晓程序观察（yinghoo-tech）就来一次测评与PK帮助企业们选择适合自己的“品牌主页”。1流量曝光：微信品牌官方区完胜？既然“品牌主页”是用来帮助企业更好地触达用户对于企业与品牌而言最关心的还是流量比如：用户输入哪些关键词才能直达“品牌主页”？如果品牌名称输入错误“品牌主页”能不能显示？“品牌主页”在搜索结果中是怎么排序的？实际上对于搜索平台来说这些都是影响流量曝光不可忽略的因素。流量曝光第一环：入口微信：三种样式、三种入口A级最突出在搜一搜的搜索结果页中微信品牌官方区的有三种展示样式如图依次为A、B、C三种：A级与B级的品牌官方区可以添加公众号、小程序、服务和商品；C级样式仅允许将公众号展示。此外A级与B级都有品牌详情页C级样式并没有。在众多搜索结果中A级样式会有一种“鹤立鸡群”的感觉更容易建立品牌认知尤其是小程序、公众号、服务、商品等都是卡片形式入口更加“抢眼”。不过A级样式并不是所有品牌都能开通的三种样式各有不同的门槛。如图要求中包括公众号与官方区点击量、是否有微信认证与商标认证、公众号注册时间等条件。值得注意的是开通A级样式还有推广搜一搜的要求即品牌主在投放广告时或在自有宣传渠道上要有“微信搜一搜”搜索框露出。线上线下渠道都可以比如：电梯间广告、户外大屏广告、易拉宝、门店宣传、自有小程序曝光、公众号文章广告、朋友圈广告等等。 支付宝&百度：品牌主页没有特殊展示入口很“隐蔽”相较于微信官方区支付宝品牌直达与百度品牌名片的样式则显得尤为“简陋”。展示上支付宝品牌直达与其他搜索结果并无差别而百度品牌名片本身即是一个小程序。所以在入口上支付宝品牌直达与百度品牌名片都不够突出。对于企业来说“品牌主页”的作用就是为了让用户在众多搜索结果中一眼就能看到自家品牌而“与众不同”的样式入口也就更“夺目”这一点微信官方区是合格的。从品牌曝光来看支付宝与百度的“品牌主页”在入口上都没有明显优势。如此看来微信品牌官方区完胜。流量曝光第二环：关键词配置对比完三家“品牌主页”的样式再来看关键词配置。毕竟用户输入什么关键词才能将“品牌主页”搜索出来才是最重要的。微信：级别越高可配置关键词数量越多刚刚提到微信品牌官方区有A、B、C三种不同级别。所以可配置的关键词数量也是不一样的分别为5个、3个、1个。所以这对企业来说可操作空间不大但仍旧需要将与品牌相关的常见关键词都加上。比如开通A级官方区的“同程旅游网”其相关的关键词有同程旅游、同程、同程艺龙等但晓程序观察（yinghoo-tech）测试后发现输入“同程艺龙”并不会出现“同程旅游网”品牌官方区说明其没有配置关键词“同程艺龙”。同样的问题也出现在开通B级官方区的“麦当劳”上搜索英文名称McDonald就不会出现其品牌官方区。支付宝&百度：“关键词要与品牌名称完全一致”支付宝品牌直达与百度品牌名片的关键词完全不用主动配置但是对企业、对用户都极其不友好。因为只有在用户精确搜索品牌词时搜索结果中才会出现“品牌主页”。百度品牌名片更甚据百度官方介绍用户需要输入“品牌名+品牌名片”（如齐家网品牌名片）或者输入开发者在后台填写的企业全称。对此晓程序观察也测试了一番输入“齐家网”后在搜索结果中整个第一页都没有看到“齐家网品牌名片”的身影。因此在“品牌主页”的关键词配置上微信有一定的运营空间而百度与支付宝则完全没有。流量曝光第三环：搜索排名对于搜索平台的逻辑来说决定流量价值的除了关键词当然就是搜索结果页排名了。BAT三家“品牌主页”的排名规则又有什么不一样？微信：“品牌主页”始终占据首位在搜一搜结果页中微信官方区始终是以首位展示。比如输入“同程”后结果页中排在第一位的便是“同程旅游网”品牌官方区而后才是文章、公众号、小程序、朋友圈等内容。当然前提是需要针对特定搜索词才能保证官方区首位展示。不同级别的官方区指定关键词数量也是不一样的。此外搜索词申请也有一定的要求：须为品牌词汇：针对通用词汇比如汉堡、保险等不开放置顶申请；须具有品牌独占性：针对非品牌独占词汇比如阿拉丁等不开放置顶申请。支付宝：可通过运营手段来提升搜索排名相比于微信官方区首位展示支付宝品牌直达的搜索排名则由算法决定。算法维度主要包括：搜索结果中品牌直达的访问和点击用户数、开通品牌直达后搜索带来的增量用户数等而这些数据都可以利用运营手段来提升。需要注意的是支付宝品牌直达内包括了小程序、生活号等内容；所以企业们只需运营品牌直达即可这样便能同时提升小程序与生活号的排名竞争力。比如在运营活动中就可以引导用户“上支付宝搜XXX”从而改善搜索UV、搜索UV增量数据。百度：广告排在品牌主页前面作为一个搜索引擎平台百度品牌名片的排名同样根据算法得到至于逻辑目前还不太清楚。不过据我们的测试来看百度品牌名片并不会排在首位“取而代之”的则是与关键词相关的广告内容。如图输入“齐家网品牌名片”之后出现在首位是与齐家网毫无关系的广告内容。综上微信官方区首位展示显然是最能帮助企业实现品牌曝光的。而支付宝与百度还需要开发者在运营规范中自行摸索算法。比如支付宝品牌直达的搜索UV就是其算法中一个很重要的因素。2在至关重要的拉新与转化上百度输了？对于企业而言“品牌主页”能带来流量曝光是远远不够的其更加看重的仍是拉新与转化。这一点目前只有微信品牌官方区与支付宝品牌直达能够做到。事实上BAT三家“品牌主页”看似差别不大都可以在“品牌主页”内添加小程序等入口但在拉新与转化上百度则略逊一筹。原因是微信与支付宝“品牌主页”具备以下两个能力：1.可在品牌主页内直接添加服务与商品在微信与支付宝的“品牌主页”内开发者能够配置其小程序的服务或商品。品牌在搜索结果页中就能直接触达用户转化能力更强。用户点击服务或商品后落地页都是品牌关联的小程序比如在NIKE的微信品牌官方区内点击商品进入的就是“Nike耐克”小程序的商品详情页。目前微信品牌官方区最多可在搜索结果页展示4个服务与3个商品；而支付宝品牌直达仅可添加1-2个小程序服务。2.品牌主页可与功能直达打通在微信与支付宝“品牌主页”中可与“功能直达”打通也是其一项重要开放能力。（关于BAT三家功能直达我们此前已有过测评对比请点击阅读）在微信搜一搜中品牌官方区的服务和商品也会出现在相关搜索结果中拥有更多曝光；同样用户在支付宝搜索的关键词与某功能关键词匹配时便会触发功能直达小程序内的服务便可直接出现在结果页中。相比之下百度不仅在搜索结果页没有服务入口在品牌详情页内也不可添加小程序内某个服务目前只能起到展示作用。综上无论是“品牌主页”样式还是流量曝光微信官方区都要更加完善；而支付宝与百度则处于刚刚起步的阶段尤其是百度品牌名片并没有将百度的搜索价值利用至最大化。那么企业开发者们BAT三家“品牌名片”你们会怎么运营？欢迎留言哦~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    uni-app对微信小程序云函数的适配               微信-小程序开发基础知识笔记                                                        原作者:  HENG                   来自: 晓程序观察                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "从CSS角度来做一个模态框 ", "author": "                  Rolan                  2019-12-30 00:42                ", "text": "                                                                                                                                                                                     今天我们从CSS角度来做一个下图这种模态框。先上代码： https://developers.weixin.qq....模态框背后的背景是一个fixed定位四个方向都为0的view主要是怎么实现中间弹窗的垂直水平居中这里提供两个方案。1、定位这种方案是将弹窗设置绝对定位后左边（上边）距设为50%就是弹窗左上角距父级左上角的距离正好是父级的宽度（高度）的50%就是在正中间同时使用 transform 属性将弹窗向左（上）移动自身宽度（高度）的50%来实现弹窗正好在水平（垂直）方向都能居中。position: absolute;top: 50%;left: 50%;transform: translateX(-50%) translateY(-50%);2、flex布局这种方案更简单只需要将父级设置为flex布局的同时设置 justify-content 和 align-items都是 center 就可以了。display: flex;justify-content: center;align-items: center;彩蛋模态框弹出后在父级上加上 catchtouchmove=\"ture\" 就可以阻止背后页面的上下滚动。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    红包小程序小结               小程序中解决网络请求缓存                                                        原作者:  祺爸                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "基于uni-app的缓存器 ", "author": "                  Rolan                  2019-6-19 00:34                ", "text": "                                                                                                                                                                                     在前端开发应用程序中性能一直都是被大家所重视的一点然而判断一个应用程序的性能最直观的就是看页面打开的速度。其中提高页页面反应速度的一个方式就是使用缓存。一个优秀的缓存策略可以缩短页面请求资源的距离减少延迟并且由于缓存文件可以重复利用还可以减少带宽降低网络负荷。前端常用缓存技术在这里我就不再描述下面基于Storage对其进行增强采用Map 基本相同的api。阅读以下内容时遇到不懂的请先科普阮一峰老师的ECMAScript 6 入门下面是基本代码会在此基础上进行增强class MinCache {  // 将数据存储在本地缓存中指定的 name 中  set (name, data) {    try {      uni.setStorageSync(name, data)    } catch (e) {      console.log(e)    }  }  // 从本地缓存中获取指定 name 对应的内容  get (name) {    let data    try {      data = uni.getStorageSync(name)    } catch (e) {      console.log(e)    }    return data  }  // 从本地缓存中移除指定 key  delete (name) {    try {      uni.removeStorageSync(name)    } catch (e) {      console.log(e)    }  }  // 返回一个布尔值表示 name 是否在本地缓存之中  has (name) {    const value    try {      const res = uni.getStorageInfoSync()      value = res.keys.includes(name)    } catch (e) {      console.log(e)    }    return value  }  // 清理本地数据缓存  clear () {    try {      uni.clearStorageSync()    } catch (e) {      console.log(e)    }  }}export default MinCache复制代码我们知道缓存往往是有危害的那么我们最好规定个时间来去除数据。class CacheCell {  constructor (data, timeout) {    this.data = data    // 设置超时时间单位秒    this.timeout = timeout    // 对象创建时候的时间    this.createTime = Date.now()  }}复制代码set (name, data, timeout = 1200) {    const cachecell = new CacheCell(data, timeout)    try {      uni.setStorageSync(name, cachecell)    } catch (e) {      console.log(e)    }  }  get (name) {    let data = null    try {      data = uni.getStorageSync(name)      if (!data) return null      const currentTime = Date.now()      const overTime = (currentTime - data.createTime) / 1000      if (overTime > data.timeout) {        try {          uni.removeStorageSync(name)          data = null        } catch (e) {          console.log(e)        }      }    } catch (e) {      console.log(e)    }    return data  }复制代码使用了过期时间进行缓存的方式已经可以满足绝大部分的业务场景。uni-app的Storage在不同端的实现不同：H5端为localStorage浏览器限制5M大小是缓存概念可能会被清理App端为原生的plus.storage无大小限制不是缓存持久化各个小程序端为其自带的storage api数据存储生命周期跟小程序本身一致即除用户主动删除或超过一定时间被自动清理否则数据都一直可用。微信小程序单个 key 允许存储的最大数据长度为 1MB所有数据存储上限为 10MB。支付宝小程序单条数据转换成字符串后字符串长度最大200*1024。同一个支付宝用户同一个小程序缓存总上限为10MB。百度、头条小程序文档未说明大小限制除此之外H5端还支持websql、indexedDB、sessionStorage；App端还支持SQLite、IO文件等本地存储方案。我们可以看出来Storage在一些端中是有大小限制的其实我们的数据只是想要缓存不一定要持久化。也就是说在应用程序生命周期内使用就行而且直接操作Storage也不是很好。我们知道ES6中有Map可以做缓存下面代码时基于Map封装的let cacheMap =  new Map()let instance = nulllet timeoutDefault = 1200function isTimeout (name) {  const data = cacheMap.get(name)  if (!data) return true  if (data.timeout === 0) return false  const currentTime = Date.now()  const overTime = (currentTime - data.createTime) / 1000  if (overTime > data.timeout) {    cacheMap.delete(name)    return true  }  return false}class CacheCell {  constructor (data, timeout) {    this.data = data    this.timeout = timeout    this.createTime = Date.now()  }}class Cache {  set (name, data, timeout = timeoutDefault) {    const cachecell = new CacheCell(data, timeout)    return cacheMap.set(name, cachecell)  }  get (name) {    return isTimeout(name) ? null : cacheMap.get(name).data  }  delete (name) {    return cacheMap.delete(name)  }  has (name) {    return !isTimeout(name)  }  clear () {    return cacheMap.clear()  }  setTimeoutDefault (num) {    if (timeoutDefault === 1200) {      return timeoutDefault = num    }    throw Error('缓存器只能设置一次默认过期时间')  }}class ProxyCache {  constructor () {    return instance || (instance = new Cache())  }}export default ProxyCache复制代码对Storage和Map封装的缓存进行整合我们来分析一下Storage和Map共用一套api在命名上解决以下划线_开头命名的缓存到Storage并且Map也有副本尽量不操作Storage(读取速度慢)那就必须在应用程序初始化的时候把Storage加载进Map像Vue插件一样使用let cacheMap =  new Map()let timeoutDefault = 1200function isTimeout (name) {  const data = cacheMap.get(name)  if (!data) return true  if (data.timeout === 0) return false   const currentTime = Date.now()  const overTime = (currentTime - data.createTime) / 1000  if (overTime > data.timeout) {    cacheMap.delete(name)    if (name.startsWith('_')) {      try {        uni.removeStorageSync(name)      } catch (e) {        console.log(e)      }    }    return true  }  return false}class CacheCell {  constructor (data, timeout) {    this.data = data    this.timeout = timeout    this.createTime = Date.now()  }}class MinCache {  constructor (timeout) {    try {      const res = uni.getStorageInfoSync()      res.keys.forEach(name => {        try {          const value = uni.getStorageSync(name)          cacheMap.set(name, value)        } catch (e) {          console.log(e)        }      })    } catch (e) {      console.log(e)    }    timeoutDefault = timeout  }  set (name, data, timeout = timeoutDefault) {    const cachecell = new CacheCell(data, timeout)    let cache = null    if (name.startsWith('_')) {      try {        uni.setStorageSync(name, cachecell)        cache = cacheMap.set(name, cachecell)      } catch (e) {        console.log(e)      }    } else {      cache = cacheMap.set(name, cachecell)    }    return cache  }  get (name) {    return isTimeout(name) ? null : cacheMap.get(name).data  }  delete (name) {    let value = false    if (name.startsWith('_')) {      try {        uni.removeStorageSync(name)        value = cacheMap.delete(name)      } catch (e) {        console.log(e)      }    } else {      value = cacheMap.delete(name)    }    return value  }  has (name) {    return !isTimeout(name)  }  clear () {    let value = false    try {      uni.clearStorageSync()      cacheMap.clear()      value = true    } catch (e) {      console.log(e)    }    return value  }}MinCache.install = function (Vue, {timeout = 1200} = {}) {  Vue.prototype.$cache = new MinCache(timeout)}export default MinCache复制代码使用方法name以下划线_开头命名的缓存到Storage并且Map也有副本事件名参数说明返回值setname缓存的key,data缓存的数据,timeout(必须数字单位s)缓存时间默认缓存1200s, timeout设置为0表示永久缓存设置缓存数据Map集合getname缓存的key获取数据(缓存过期将返回null)返回缓存的数据datahasname缓存的key检查值true/falsedeletename缓存的key删除数据true/falseclear-清空Storage和Map缓存数据true/false// 注册缓存器Vue.use(MinCache)// 设置默认缓存时间// Vue.use(MinCache, {timeout: 600})复制代码// 'name'不是以下划线开头的表示会缓存到Map中在程序生命周期内有并且在有效时间内有效this.$cache.set('name', 'MinCache')// 过期时间设置为0表示不会过期// 注意：'test'并不是以下划线命名表示在程序生命周期永久缓存this.$cache.set('test', 'testdemo', 0)// 过期时间设置为0表示不会过期// 注意：'_imgURL'是以下划线命名表示永久缓存到Storagethis.$cache.set('_imgURL', 'data', 0)复制代码// 获取缓存的数据this.imgURL = this.$cache.get('_imgURL')this.name = this.$cache.get('name')this.test = this.$cache.get('test')复制代码具体使用方法可以参考\tgithubuni-app路由的封装                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序登录数据解密               通过json用canvas生成分享海报,支持微信小程序和web                                                        原作者:  _小白_                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "解决小程序中webview页面多层history返回问题 ", "author": "                  Rolan                  2019-8-21 00:15                ", "text": "                                                                                                                                                                                     小程序开发中遇到的问题：小程序中嵌套了一个webview页面webview页面中有静默授权（A1页面静默授权后重定向到A2页面）点小程序原生的返回按钮会返回到A1页面然后页面就会反复静默授权预期表现：点小程序原生的返回按钮后返回到小程序上个页面解决方案：通过\thistory.pushState 添加历史记录名目\thistory.onpopstate 监听历史记录条目发生变化时调用小程序API\twx.navigateBackwindow.addEventListener('popstate', (event) => {    wx.miniProgram.navigateBack();});const code = getSearch('code'); // 伪代码获取查询参数if (!code) { // 页面A1    if (isWeixin()) {        // 微信环境        const redirectUrl = window.location.href + '&code=1';        window.location.href = 'https://open.weixin.qq.com/connect/oauth2/authorize' + '?appid=' + appId +        '&redirect_uri=' + encodeURIComponent(redirectUrl) +        '&response_type=code&scope=snsapi_userinfo' +        '#wechat_redirect'; // 静默授权伪代码    } else {        alert('当前不是微信环境');    }} else { // 页面A2    history.pushState({page: 1}, null, window.location.href);}刚开始想的解决办法是用localStorage跳转到A2时存储一个值返回到A1时获取这个值如果有值就清除这个值并且回退到小程序页面。听起来似乎也可行但小程序的缓存和微信的缓存是同步的如果在微信环境中直接访问A1页面重定向到A2会存值如果直接关闭页面不会被清除那么在小程序中访问时就直接回退了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 webview 与 h5 实时通讯的实现               微信小程序使用车牌号输入法                                                        原作者:  sunny                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序工程化之路 ", "author": "                  Rolan                  2019-11-11 00:30                ", "text": "                                                                                                                                                                                     最近很长一段时间都在和前端项目构建“纠缠”在一起处理了web项目、app项目紧接着便是微信小程序之所以把微信单独拎出来做一篇分享主要是因为小程序的工程化在很多细节上是区别于传统意义上的web项目请往下看准备工作配置一台打包机建议弄一台mini（具体配置根据大家的实际情况来定ps一下我们公司用的16G+128的目前来说资源已经明显不够用了）其次要去搭建一个jenkins服务做任务的集中管理。搭建一个服务主要提供和微信的对接为后期代码上传提审等功能做基础关于微信的对接方式大家可以看官网文档 第三方平台如果有可能的话对接一下各自公司的办公管理工具比如企业微信、钉钉等用来做消息的通知、审核等。最后一点就是微信常用的开发套件了就不做过多阐述。创建和执行工作流首先在Jenkins中创建任务建议同时创建两个一个作为开发预览（DevelopTask）另外一个作为代码上传（ReleaseTask）。Jenkins任务中的配置注意下面这几点。处理微信开发者工具登录过期我们可以通过开发辅助中提供的命令行登录方式来获取到授权二维码提供给管理者去处理。DevelopTask要定时执行因为小程序预览二维码会有过期的问题所以我这里每20分钟会重新生成一张我们可以在Jenkins的构建触发器中设置DevelopTask的脚本配置主要是上传预览、生成二维码资源（Base64）、通知开发者获取新的二维码。ReleaseTask中区别与DevelopTask的是不需要定时执行另外我们需要将脚本中的 cli -p /Users/username/demo --preview-qr-output base64@/Users/username/code.txt 命令替换成 cli -u 1.0.0@/Users/username/demo --upload-desc 'initial release' --upload-info-output /Users/username/info.json开发预览上面说到DevelopTask会生成预览二维码的base64文件如何将这个信息通知给测试或者开发者呢？这里我以企业微信的方式为例首先看下效果通过企业微信中的接受消息功能我们可以将消息做一次中转另外通过消息推送将新的消息推送给指定的用户我们可以在中转服务中将二维码信息推送给用户这里有一张企业微信消息推送的流程大家可以借鉴一下另外企业微信支持配置菜单类似于微信公众号中的菜单。版本发布ReleaseTask执行外之后我们会将代码推送到小程序的草稿库中这里距离真正的提审还有三步骤第一添加草稿到代码模版库第二通过模版ID上传小程序代码第三提交审核。这里的三个步骤由于微信限制我们没办法在Jenkins中去操作我们可以搭建中转服务去管理。总结整体流程创建Jenkins任务处理预览或者上传问题测试：生成预览二维码模版发布：上传草稿利用微信三方服务接口实现模版提交提审等功能如有不足还望指出。愿大家在前端的道路上少走弯路                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序使用echarts实现左右双Y轴动态获取数据生成折线图 ...               uni-app中picker组件“确定”和“取消”文字的修改                                                        原作者:  百叶                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序九九八十一坑之头像模糊，谁的锅？ ", "author": "                  Rolan                  2019-10-15 00:46                ", "text": "                                                                                                                                                                                     「柒留言」更新的换国旗头像小功能获取头像显示模糊...1、头像模糊国庆之前更新了「柒留言」小程序加国旗头像的小功能但是头像模糊这个坑我在发布新版之前还没解决。一直以为是代码出了问题各种搜索巧的是正好也有类似的答案然后我就被带进锅里了弄了半天还是模糊无奈之下弄了个用户自行上传图片生成头像这样生成的头像就能清晰显示先发布新版。发布新版后仔细研究了一下头像发现显示在浏览器上是小图一度以为是自己上传了略缩图于是乎重新上传高清图像然并 L。最后在头像地址上找到了问题。2、默认模糊？这是我的头像地址滑动到最右你发现了啥？1http://wx.qlogo.cn/mmopen/eTBFF2uBxbBTAW8ZrbmMJGuOq7nGZfGicWORE2vcZfsMwXscofgeEwevlSl8L5SFFct2ZKibzxjqNjw94r2wI2xiaibY3TKxVRPC/132/ 后面带了个 132猜想一下这个是头像尺寸于是乎搜一下微信文档果然。是在下输了怪我没有仔细看文档谁知道一个头像获取还要分尺寸的这里把 132 改成 0 就是高清头像了改的逻辑就不用多说了吧我相信你们会的。其实132 的头像用在小程序中已经很清楚了只不过我绘制头像时用的尺寸是 256px差不多是把头像放大了一倍所以显示是模糊的。这个锅我先背为敬。3、肝项目最近公司在肝项目上线尽量压缩中午的午休时间更新一下遇到的坑。大概率不是那么的硬核但希望能帮大家少踩坑。干货都是相对的觉得对你有帮助点个在看吧大佬路过就行。Demo 已更新线上版本未更新加了点好玩的：教程 | 小程序七十二变之 canvas 绘制国旗头像GitHub 获取制作国旗头像源码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    教你制作挂件头像 | 小程序七十二变之 canvas 绘制国旗头像               微信小程序之Flex容器详解                                                        原作者: 我是玖柒后                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "撸一个微信小程序记事本备忘录-随微记 ", "author": "                  Rolan                  2019-8-12 00:37                ", "text": "                                                                                                                                                                                     废话不多说了目的直接点微信上记录一些资料(比如公司信息以及开发票等)方便查看可以随时分享出来可以生成图片海报做一些工具（后续开放）最后总结就是弄它 随微记 是自己想的页面也是自己布局海报的配置可能也有自己的喜好存在目前版本为 V1.0.0 在此篇文章不会有代码的东西认知(需要改善)：没有各种的app好用没有手机自带备忘录的好用微信小程序技术微信小程序原生apiTaroColorUi组件库功能列表还有未完成的功能后续更新界面介绍遇到问题editor云开发云开发数据主要的存储是用户的列表以及用户笔记本和笔记的数据本来想用存图片第一版本的时候遇到了图片size限制的问题因此近期改版为上传至阿里OssNode + koa + mysql 服务 koa-swagger-decorator自动生成api文档 文字笔记海报配置 图文笔记海报配置 分享海报配置 用户同步数据 模板使用情况记录 分享日志记录 https域名部署 node项目部署pm2进程监控 图片删除任务更新 后台session登录 mysql使用 后台未完成功能有点多在此不列了\"dependencies\": {    \"@babel/polyfill\": \"^7.4.4\",    \"axios\": \"^0.19.0\",    \"debug\": \"^4.1.1\",    \"koa\": \"^2.7.0\",    \"koa-bodyparser\": \"^4.2.1\",    \"koa-convert\": \"^1.2.0\",    \"koa-generic-session\": \"^2.0.1\",    \"koa-json\": \"^2.0.2\",    \"koa-logger\": \"^3.2.0\",    \"koa-onerror\": \"^4.1.0\",    \"koa-redis\": \"^4.0.0\",    \"koa-router\": \"^7.4.0\",    \"koa-static\": \"^5.0.0\",    \"koa-swagger-decorator\": \"^1.5.16\",    \"koa-views\": \"^6.2.0\",    \"moment\": \"^2.24.0\",    \"mysql\": \"^2.17.1\",    \"pug\": \"^2.0.3\"  },  \"devDependencies\": {    \"@babel/cli\": \"^7.5.5\",    \"@babel/core\": \"^7.5.5\",    \"@babel/parser\": \"^7.5.5\",    \"@babel/plugin-proposal-class-properties\": \"^7.5.5\",    \"@babel/plugin-proposal-decorators\": \"^7.4.4\",    \"@babel/plugin-proposal-optional-chaining\": \"^7.2.0\",    \"@babel/plugin-transform-object-assign\": \"^7.2.0\",    \"@babel/plugin-transform-runtime\": \"^7.5.5\",    \"@babel/preset-env\": \"^7.5.5\",    \"@babel/register\": \"^7.5.5\",    \"cross-env\": \"^5.2.0\",    \"install\": \"^0.13.0\",    \"nodemon\": \"^1.19.1\",    \"npm\": \"^6.10.2\"  }复制代码路由配置const tag = tags(['WeChat']);@prefix('/api/user')export default class WechatRouter {\t@request('post', '/authorize')  @summary('微信授权登录')  @description('登录之后返回sesscion和openid')  @tag\t@body({\t\tcode: { type: 'string', required: true, default: '', description: '小程序code' },\t})\tstatic async authorize(ctx) {\t\tlet { code } = ctx.request.body;    let str = ctx.request.body?.code;    // console.log('开始访问请求参数2', APPID, APPSECRET, str)    let res = await getOpenId(code);    ctx.body = new SuccessModal(res);\t}}复制代码资源链接koa-generatorkoakoa-swagger-decorator后续开发后续后开发围绕微信和备忘录的一系列的工具或者功能欢迎指出不足和功能改善或者你想要的功能                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序客服消息功能 php               小程序中图片/等款高圆变形问题解决(安卓端)                                                        原作者:  龙荩草                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "认识小程序云开发 ", "author": "                  Rolan                  2019-2-21 00:37                ", "text": "                                                                                                                                                                                     小程序云开发开始公测啦欢呼欢呼。这里针对云开发小程序的能力整理出了一个简单的报告欢迎大家一起来探讨~关于 serverless无服务器运算（Serverless computing）又被称为功能即服务（FaaS）是云计算的一种模型。以平台即服务（PaaS）为基础无服务器运算提供一个微型的架构终端客户不需要部署、配置或管理服务器服务代码运行所需要的服务器服务皆由云端平台来提供。云开发小程序的能力云开发是微信团队和腾讯云团队共同研发的一套小程序基础能力简言之就是：云能力将会成为小程序的基础能力。小程序云开发目前提供三大基础能力支持：云函数：在云端运行的代码微信私有协议天然鉴权开发者只需编写业务逻辑代码数据库：一个既可在小程序前端操作也能在云函数中读写的 JSON 数据库文件存储：在小程序前端直接上传/下载云端文件在云开发控制台可视化管理大家可以去看看小程序的文档也可以参加下公测申请哈：《小程序·云开发》。解决了什么天然鉴权小程序中要使用第三方服务器需要走较多的流程如图（参考官网）：在云开发小程序中使用云函数则无需考虑长长的授权链路可专心写业务代码。零部署零维护一个小程序的上线除了大家看到的小程序背后还有网关、计算服务、基础设施管理、数据库、文件服务、缓存服务等等。日常开发中随便找个后台服务架构之类的交互图都会长这么复杂（图文无关来自随便谷歌的图片）：除去这些服务的部署成本当然少不了还有它们的维护成本。当然也可以选择各种第三方服务来组合实现这里面也会有服务的熟悉、比对等各种烦恼。小程序云开发提供了较完整的服务器架构结合腾讯云团队的云函数、数据库和文件存储都可以是相对可靠的服务。如果业务可以使用小程序云开发完成闭环就能省去不少的开发部署和维护成本。服务稳定性日常开发中除去业务逻辑我们还需要完善很多基础能力：日志、监控、告警、数据安全、系统性能。业务增长需要扩容从前端到后台长链路的定位数据信息的统计都是需要手动操心的事情。小程序云开发提供了数据库和文件存储可在小程序中直接使用也可以通过云函数去调用也可以通过小程序云开发的控制台去管理。同时小程序云开发配备了一些日志、监控和统计分析的功能：数据存储的安全性、服务的稳定性都有专业团队来保障不用自己再操心和踩坑了。弹性的云函数或许很多人都不大理解云函数是什么没关系我也是刚刚才接触。云函数大概是一个可运行的代码管理平台可用把代码存储到平台上并提供好环境供代码运行。自动伸缩大概是云函数最特殊和最好用的一个能力了：无服务器云函数支持毫秒级别的实时弹性伸缩完全根据请求量扩容或缩容动态负载均衡将请求分发至后端近乎无限的函数实例上完全无需任何手动配置和操作满足并发量从 0 到成千上万的不同场景更多的能力可参考腾讯云 SCF。云开发小程序的云函数是通过 Node.js 来执行的。目前来说涉及的依赖和安装包都需要在本地安装后再上传部署方可使用。不过开发小哥哥们说了后续会提供线上安装的功能。便利的权限控制在大多数业务中都会存在权限控制以及身份管理如管理员、用户、数据创建者。而小程序云开发的数据库和文件存储提供了以下的权限管理方式：万能的 Javascript大家都说全栈只是前端里才有的定义。Node.js 其实只是降低了语言的学习成本但做服务搭建该学习的还是学习该掌握的还是得掌握。前端与后台的差距并不在于语言即使是一个很简单的系统架构前端考虑的会欠缺了很多（个人体验不能代表各种大神）。云开发小程序通过提供客户端 API 的方式封装了很多服务处理和管理维护的过程使得服务架构对小程序开发者的门槛大大降低。开发者只需要使用 Javascript 一种语言结合提供的 API可以完成小程序的开发、服务的业务逻辑编写、数据管理、用户管理也省去了很多系统安全、服务搭建、性能维护等工作。还要解决什么依赖性目前来说小程序云开发的服务只能局限在小程序里面使用。存储到数据库和文件存储里的数据暂无法通过其他方式直接获取（当然你也可以在小程序里通过 http/https POST 出去）。这意味着我们暂时还不能依赖小程序云开发的存储来做一些运营端、管理页面、自定义的数据分析等。因为小程序云开发的整个架构设计主要服务于小程序那么不管是数据库的读写、文件存储的读写还是云函数的执行触发都会依赖于小程序。不过后面应该会有规划将小程序云开发通过鉴权或者授权的机制让开发者可以从自己的服务器去获取一些信息的吧。服务局限性小程序以及云开发与外界（其他服务）的连接基本上都只能基于 http/https 的方式来进行。相对于我们常用的服务间 TCP 的连接方式可能会慢一点（其实也可以忽略不计啦）。同时目前的云函数会有超时机制（大概5秒）也就是说一个函数的执行若是超时了函数调用会被返回同时该函数的执行也会被中断。普通的 CGI 超时了也会执行完毕这里会有些不一样。稳定性保障新上线的功能虽然经过了内测未经过大量的实践其稳定性和使用性能都待考证。不踩坑是不可能的这辈子都不会不踩坑的。但相信小程序的开发哥哥们能保证当前功能的稳定和开发的便捷。毕竟走得稳才能走得远。但是新技术或者新功能的上线都需要大量开发者前仆后继地填坑才能一起成为首批吃鸡腿的小伙伴呀。（嗯目前为止踩了一些坑有机会再跟你们分享吧）健全的文档“程序员最讨厌的两件事：1. 别人没有写文档。2. 自己要写文档。”在新功能上线的初期文档建设未免都会有些不够完善当然这也是需要大家多去参与和使用然后给到反馈和建议才能做得越来越好。什么场景适用个人开发者无可厚非地大概是个人开发者最适合使用小程序云开发的模式了。只需要专注于小程序的开发完全不用考虑后台服务搭建、数据存储、系统安全、服务器运维等工作只需要使用云开发提供的一条龙服务就可以开心地完成小程序的开发了。工具类小程序由于小程序云开发的功能目前还只能在小程序里面使用那对于一些小助手、修图工具、阅读工具等一些工具类小程序这类需要一些小数据的存储同时也可以配合 http/https 请求的方式来完成完整的功能。复杂逻辑的函数计算“复杂的逻辑放后台。”不管是以前还是现在虽然前端的能力范围越来越大但在业务中依然免不了会遇到一些复杂的逻辑这时候一般大家都会默认把逻辑放后台计算。因为前端的性能和兼容性总会因环境和平台的变化而变化同时单线程的模式也限制了一些大数据的计算分析能力。小程序里也暂时没有类似 Web Worker 的能力（小游戏已经有了小程序听说在规划中）。现在我们可以把这些复杂的逻辑计算放在云函数中来进行内存分配、计算性能都是云开发来保障我们甚至可以结合一些开源库或是云开发提供的 AI 能力来做一些以前不好做甚至是做不到的功能。长“缓存”服务我们经常会使用小程序的缓存来做一些简单的数据缓存像本地日志、错误信息、告警信息、访问次数等这些数据可能会被用户手动清除掉（也没有关系）但如果有一个免费又能提供不限时间的存储服务是否可以将缓存中的数据定期存到小程序云里然后开发者可以在小程序云开发的控制台里查看这些信息呢？向前看科技在发展技术一直在变化作为一个小开发也还是想要拥抱变化和未来的。小程序云开发提供的能力要改造原有架构来适应或许成本太高但将其列入未来的可用方案也是不错的方式。结束语小程序的开发们都爱低调但好的东西是要让大家知道的呀~就由我来做这个文章的搬运工吧~后面也打算做一系列的小程序相关文章先立个 Flag。懂的东西不够多能做的就是写下来和大家一起分享了。最后小程序团队和腾讯云团队棒棒哒此致敬礼！PS：祝各位开发者写码愉快！成功吃鸡！查看Github有更多内容噢：https://github.com/godbasin                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 短信验证码登录 倒计时 setInterval               java后台的微信小程序支付的解决方案                                                        原作者: 被删                   来自: godbasin                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序ColorUI框架完成3d轮播效果 ", "author": "                  Rolan                  2019-4-19 00:14                ", "text": "                                                                                                                                                                                     一、效果预览二、ColorUI克隆地址https://github.com/weilanwl/C...三、使用方法步骤一需要在红框文件中引入篮框的两个文件如下图：@import 'colorui.wxss';@import 'icon.wxss';步骤二打开下载的文件 打开demo目录3d轮播代码在swiper页面上（卡片式轮播效果）直接复制就好了四、总结其实做这个效果我踩了很多坑 在网上找大牛用微信swiper插件改出的3d轮播效果 已经使用上了 被领导说使用卡顿 又花时间重新想的这个办法 优点：使用流畅不卡顿 缺点：占太多内存 因为微信上传代码规定不能超过两兆 要是本身小程序内容很多可能就不能用这个方法了                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序三种授权登录的方式               安卓手机微信7.0.4调试小程序抓包https请求失败的问题和解决                                                        原作者:  yujiao                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "mpvue框架使用记录 ", "author": "                  Rolan                  2019-6-25 00:16                ", "text": "                                                                                                                                                                                     最近公司接了一个订制小程序是从APP改成微信小程序考虑用 mpvue 框架来开发发现还是有些坑的下面说一下这两天使用下来的感受。template 中不支持 methods 中的函数也没有filter过滤器数据要预先处理比较麻烦突然想到可以用组件来预处理数据比如项目中图片url的拼接和替换域名创建新页面比较繁琐每次创建新页面按常规流程是:新建页面文件夹 → 新建 index.vue  main.js  main.json 并填入页面基本内容 → 在项目 app.json 中添加页面信息。最开始我的解决方法是创建了一个模板页面每次新建页面的时候复制一份重命名。但是还是很麻烦需要手动向 app.json 中添加页面路径干脆用node写了一个快速添加页面的小工具将工具文件 addpage.js 放在mpvue项目根目录运行 node addpage目前有一个参数可以配置新增页面的属性是设置vue文件中用到的预处理器类型用法： node addpage wxss  node addpage sass填入需要创建的页面路径和标题就会在 src/pages/ 下创建页面包含三个基本文件并自动向app.json 中写入本次创建的路径 支持多级目录页面的创建方便分类页面如 demo/demo1 , demo/demo2要注意的是输入的路径下有其他页面时会创建失败比如创建了 demo/demo1 后再创建 demo 就会失败如果改变了目录结构请删除 dist 文件夹重新构建下面是addpage.js的全部代码const fs = require('fs')const readline = require('readline')const path = require('path')const colors = require('colors')const rl = readline.createInterface({  input: process.stdin,  output: process.stdout})//获取运行时附带参数目前只定义了vue文件中的css语言类型和页面标题let arguments = process.argv.splice(2);let caaLang = arguments[0]let appJson = JSON.parse(fs.readFileSync('./src/app.json', 'utf8').toString())rl.question(' 请输入页面路径: '.bgBlue, (pathStr) => {  rl.question(' 请输入页面标题: '.bgBlue, (title) => {    pageTitle = title    pageCreate(pathStr)  })})function pageCreate(pathStr){  let jsonPush = `pages/${pathStr}/main`  let stop = false  appJson.pages.forEach((item) => {    let pathArr = item.split('/')    let pathStrArr = pathStr.split('/')    if (pathArr.length > 3 && pathStrArr.length === 1 && pathArr.indexOf(pathStrArr[0]) !== -1) {      stop = true    }  })  if (stop) {    console.log(' 此路径下有其他页面不可直接作为页面路径 '.bgRed);    rl.close()    return  }  if (appJson.pages.indexOf(jsonPush) !== -1) {    console.log(' 此页面已存在 '.bgRed)    rl.close()    return  }  //app.json pages数组中没有项目结构中有此时已有的文件夹会被删除  deleteFolder('./src/pages/' + pathStr)  try {    mkdirsSync('./src/pages/' + pathStr)  } catch (error) {    console.log(error);  }  if (writePage('./src/pages/' + pathStr)) {    //加入本次创建的页面路径    appJson.pages.push(jsonPush)    //写入app.json    fs.writeFile('./src/app.json', JSON.stringify(appJson, null, \"\\t\"), function (err) {      if (err) {        console.error(err)      }      console.log(' ----------新增成功---------- '.bgGreen)      rl.close()    })  }}//删除文件夹function deleteFolder(path) {  var files = [];  if (fs.existsSync(path)) {    files = fs.readdirSync(path);    files.forEach(function (file, index) {      var curPath = path + \"/\" + file;      if (fs.statSync(curPath).isDirectory()) { // recurse        deleteFolder(curPath);      } else { // delete file        fs.unlinkSync(curPath);      }    });    fs.rmdirSync(path);  }}//创建多级目录function mkdirsSync(dirname) {  if (fs.existsSync(dirname)) {    return true;  } else {    if (mkdirsSync(path.dirname(dirname))) {      fs.mkdirSync(dirname);      return true;    }  }}//写入目标页面的三个文件function writePage(path) {  try {    fs.writeFileSync(path + '/index.vue', `<template>  <div class=\"page-container\">  </div></template><script>export default {  data() {    return {}  }}</script><style lang=\"${caaLang?caaLang:'scss'}\" scoped>.page-container {  min-height: 100vh;  background-color: #f5f5f5;  background-image: linear-gradient(to bottom, #00d164, #00d164);  background-repeat: no-repeat;  background-size: 100% 170rpx;  background-position: top center;  padding-bottom: 65rpx;}</style>`, 'utf8');    fs.writeFileSync(path + '/main.js', `import Vue from 'vue'import App from './index'    const app = new Vue(App)app.$mount()`, 'utf8')    fs.writeFileSync(path + '/main.json', `{  \"navigationBarTitleText\": \"${pageTitle}\"}`, 'utf8')    return true  } catch (error) {    //写入错误删除该文件夹    deleteFolder(path)    console.log(' 创建页面失败 '.bgRed);    throw error  }}复制代码个人博客【花喵电台】                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序组件化开发框架WePY               小程序技术演进史                                                        原作者:  Rongle                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序登录、支付（小程序、微信H5、非微信H5）即请求加密方法 ... ", "author": "                  Rolan                  2019-10-22 00:55                ", "text": "                                                                                                                                                                                     本文档 当中所用到的:\t\tconst $request = this.request\t\tconst post = $request.call('passport/wxLogin',data)\t\tpost.then(res=>{}).catch()\t\t是自己封装的请求方法如axios参考时可自行更改复制代码1、js生成接口请求参数签名加密定义规则：对所有发起请求的参数(包括公共参数)按key进行升序排序 然后组合成key1=value1&key2=value2的形式如： parames = {b:value-b, c:value-c,a:value-a}; 排序后应为： string = \"a=value-a&b=value-b&c=value-c\";排序后对其进行md5: string = md5(string);//注意：这里要过滤掉所有为空的参数空参数不传将md5的串与密钥再做一次md5: sign = md5( string + secret ); //sceret为密钥后端分配/**  * 定义对象排序方法 */objectSort(parames) {     var newkeys = Object.keys(parames).sort();    var newObj = {};    for(var i = 0; i < newkeys.length; i++)     {        newObj[newkeys[i]] = parames[newkeys[i]];     }    return newObj;}/**  * 计算签名方法 */makeSign(params)\t{\t    var sign = '';\t    var parm = '';\t    \t    params = objectSort(params);\t    for (let i in params)\t    {\t        var j = params[i];\t        parm += i + '=' + j + '&';\t    }\t    parm = parm.slice(0,-1);\t    parm.trim();\t    \t    sign = Md5.md5(Md5.md5(parm)+$secret);//$secret为密钥后端分配 \t    return sign;\t},/**  * 过滤data参数中的空字符 */\tfilterData(data){\t\tvar result = {};\t\tfor (let i in data) \t\t{\t\t\tvar value = data[i];\t\t\tif (typeof (value) == 'undefined') {\t\t\t\tvalue = '';\t\t\t}\t\t\tif(typeof(value) == 'string'){\t\t\t\tvalue = value.trim();\t\t\t}\t\t\tif(value)\t\t\t{\t\t\t\tresult[i] = value;\t\t\t}\t\t}\t\treturn result; \t},/**  * 构建data参数 */bulidData(data) {\t\tif(typeof(data) != 'object'){\t\t\tdata = {};\t\t}\t\t//构建参数\t\tdata.timestamp = (new Date()).valueOf();\t\tdata.app_id = Config.app_info.app_id;\t\t//过滤\t\tdata = this.filterData(data);\t\t//检测用户是否登录\t\tvar token = Helper.user.getToken();\t\tif(token)\t\t{\t\t\tdata.token = token;\t\t}\t\tdata.sign = this.makeSign(data);\t\treturn data;\t},复制代码微信登录这里采用 button的开放属性 open-type 触发@getuserinfo事件 获取到code 发送给后台 换取token 存到storge;详细参考微信官方文档<template>\t<button openType=\"getUserInfo\" lang=\"zh_CN\" @getuserinfo=\"getUserInfo\">授权登录</button></template>methods: {    getCode(callback) {    \twx.login({    \t\tsuccess: res => {    \t\t\tconsole.log(res);    \t\t\tif (res.errMsg == 'login:ok') {    \t\t\t\tif (callback) {    \t\t\t\t\tcallback(res.code)    \t\t\t\t}    \t\t\t\tthis.code = res.code    \t\t\t}    \t\t}    \t});    },    getUserInfo(e) {    \tthis.getCode(code => {    \t\tif (e.detail.errMsg !== 'getPhoneNumber:ok') {    \t\t\treturn false;    \t\t}    \t\twx.showLoading({    \t\t\ttitle: '正在登录',    \t\t\tmask: true    \t\t});    \t\tconst data = {    \t\t\tcode:this.code,    \t\t\tiv:e.detail.iv,    \t\t\tencryptedData:e.detail.encryptedData    \t\t}    \t\t    \t\t//发起请求登录    \t\tconst $request = this.request    \t\tconst post = $request.call('passport/wxLogin',data)    \t\tpost.then(res =>{    \t\t\tconsole.log(res)    \t\t\tuni.setStorageSync('_user_login_token', res.data.token)    \t\t}).catch(err => {    \t\t\t\t//常规catch, 一般不用修改    \t\t\t\t$request.callError(err)    \t\t})    \t});    }}复制代码微信小程序支付首先获取code{uni.login()} 然后调后台接口 把code和订单好传给后台后台 返回的数据就是小程序调支付的参数{uni.requestPayment()} 就这么简单const $request = this.requestconst resLogin = await uni.login()if (resLogin[0] !== null || resLogin[1].errMsg !== 'login:ok') {\treturn uni.showToast({\t\ttitle: 'code获取失败',\t\ticon: 'none'\t})}const code = resLogin[1].codeconst post = $request.call('order/doPay', {\torder_id: this.order_id,\tpay_type: '无忌微信小程序支付',\tcode: code})post.then(data => {\t// 返回数据只返回接口中的data\tconst result = JSON.parse(data.data.pay_data)//字符串转对象\tuni.requestPayment({\t\tprovider: 'wxpay',\t\ttimeStamp: result.timeStamp,\t\tnonceStr: result.nonceStr,\t\tpackage: result.package,\t\tsignType: result.signType,\t\tpaySign: result.paySign,\t\tsuccess: res => {\t\t\tconsole.log('success:' + JSON.stringify(res))\t\t\tthis.requestDetail()\t\t},\t\tfail: err => {\t\t\tconsole.log('fail:' + JSON.stringify(err))\t\t}\t})}).catch(function(e) {\t//常规catch, 一般不用修改\t$request.callError(e)复制代码4、H5支付(微信内浏览器/JSPAI)获取code在登录时就获取code后台得到openId将其存起来之后后台在用到openId的地方就不用再获取了（不会过期）getCode(){\tlet appid = {appid}\tlet redirect_uri = encodeURIComponent({url})//回调页面地址\twindow.location.href = \"https://open.weixin.qq.com/connect/oauth2/authorize?appid=\" + appid + \"&redirect_uri=\" + redirect_uri + \"&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect\"}复制代码封装H5支付代码** * 支付 * 这里的 $request.call()为自己封装的请求方法使用时请自行更改 */var payH5 = {\tonBridgeReady: function(url, $params,success) {\t\tconst post_H5 = $request.call(url, $params)\t\tpost_H5.then(data => {\t\t\t// 返回数据只返回接口中的data\t\t\tconst result_H5 = JSON.parse(data.data.pay_data)//后台返回的数据为字符串转换对象\t\t\tWeixinJSBridge.invoke(\t\t\t\t'getBrandWCPayRequest', {\t\t\t\t\t\"appId\": result_H5.appId, //公众号名称由商户传入\t\t\t\t\t\"timeStamp\": result_H5.timeStamp, //时间戳自1970年以来的秒数\t\t\t\t\t\"nonceStr\": result_H5.nonceStr, //随机串     \t\t\t\t\t\"package\": result_H5.package,\t\t\t\t\t\"signType\": result_H5.signType, //微信签名方式：     \t\t\t\t\t\"paySign\": result_H5.paySign //微信签名 \t\t\t\t},\t\t\t\tfunction(res) {\t\t\t\t\tif (res.err_msg == \"get_brand_wcpay_request:ok\") {\t\t\t\t\t\tvar msg = '支付成功';\t\t\t\t\t\tsuccess(msg)\t\t\t\t\t} else {\t\t\t\t\t\tvar msg = '支付失败';\t\t\t\t\t\tsuccess(msg)\t\t\t\t\t}\t\t\t\t});\t\t}).catch(function(e) {\t\t\t//常规catch, 一般不用修改\t\t\t$request.callError(e)\t\t})\t},\tdoPay(url, $params,success) {\t\tif (typeof WeixinJSBridge == \"undefined\") {\t\t\tif (document.addEventListener) {\t\t\t\tdocument.addEventListener('WeixinJSBridgeReady', this.onBridgeReady, false);\t\t\t} else if (document.attachEvent) {\t\t\t\tdocument.attachEvent('WeixinJSBridgeReady', this.onBridgeReady);\t\t\t\tdocument.attachEvent('onWeixinJSBridgeReady', this.onBridgeReady);\t\t\t}\t\t} else {\t\t\tthis.onBridgeReady(url, $params,success)\t\t}\t}}export default payH5复制代码支付调用将这个文件引入需要的页面或者挂载到vue原型上（这里以uni-app中介绍）在main.js中 引入： \t\t\t\timport H5Pay from './api/h5Pay.js'\t\t\t\tVue.prototype.H5Pay = H5Pay页面引用:\t\t\tthis.H5Pay.doPay(url,params,callback)参数：\t \t  url:接口请求地址\t\t\tparams：请求参数\t\t\tcallback:回调方法（回调支付结果）H5pay(){\tthis.H5Pay.doPay('order/doPay', {\t\t\t\t\torder_id: order_id,//订单号\t\t\t\t\tpay_type: '',//支付方式\t\t\t\t}, function(msg) {\t\t\t\t\tuni.showToast({\t\t\t\t\t\ttitle: msg,\t\t\t\t\t\ticon:'none'\t\t\t\t\t})\t\t\t\t\tuni.navigateBack()\t\t\t\t})}复制代码5、H5支付（非微信内置浏览器）相对来说前端简单很多没什么麻烦要求 后台会返回一个mwev_url window.location.href = mwev_url + redirect_uri （这里的redirect_uri 是重定向的页面地址域名要和支付域名一致 ！！！做编译encodeURIComponent(url)）dopayWeb() { //非微信浏览器支付\tconst $request = this.request;\tconst post = $request.call('order/doPay', {\t\torder_id: this.order_id,//订单号\t\tpay_type: 'nweb'//支付方式\t});\tpost.then(res => {\t\tconsole.log(res);\t\tlet url = res.mwev_url\t\tlet redirect_uri = encodeURIComponent(url)\t\twindow.location.href = url + \"&redirect_uri=\" + redirect_uri \t}).catch(function(e) {\t\t$request.callError(e)\t});},复制代码6、 区分是否是微信内置浏览器function isMicroMessenger() {    let result = false;    let userAgent = window.navigator.userAgent;        if(userAgent.indexOf('MicroMessenger') > -1) {        result = true;    }    return result;}复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序技能进阶回忆录 - 自主实现数据侦听器和计算器               微信小程序周边配套的实现                                                        原作者:  兮丶                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "纯CSS实现圆环型进度条 ", "author": "                  Rolan                  2019-12-27 00:07                ", "text": "                                                                                                                                                                                     以下内容来自于去年的一次案例随着微信小程序的不断改版部分条件可能已不再适用请谨慎参考。内容比较短主要都在代码片段里。案例某个项目中需要用到如下图这样的一个圆环行的进度条。一开始的想法是使用canvas来实现但是canvas是原生组件层级最高（当时的情况）实际使用时不方便使用。所以决定尝试用纯CSS来实现这一效果。实现原理先上代码：https://developers.weixin.qq....这里主要用到的是CSS中的clip属性将一个正方形裁剪后只显示右侧一半但是仍然以正方形中心为圆心来旋转来实现需要的角度。clip: rect(0rpx, 46rpx, 92rpx, 0rpx);这样最上面那个进度条就可以由以下三部分叠加在最上面再叠加一个小一号的白色圆形最外层加上圆角后就可以实现。（下图中红线示例了最外层的圆角以及最上层叠加的白色圆形位置）叠加效果用到蓝色圆环小于180度的情况下需要把背景色和前景色对调。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序 input 使用setData触发bindinput事件               小程序标签展开收起功能实现                                                        原作者:  祺爸                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序把base64的图片保存到手机相册 ", "author": "                  Rolan                  2019-12-2 00:17                ", "text": "                                                                                                                                                                                     var file = wx.getFileSystemManager();console.log('1')file.writeFile({    //读写文件路径filePath需要使用wx.env.USER_DATA_PATH + '/tmp.txt'才可以读写成功。    filePath:  wx.env.USER_DATA_PATH + '/poster.png',    data: self.preurl.slice(22),    encoding:'base64',    success:async()=>{        console.log('123')        const res2 = await wepy.saveImageToPhotosAlbum({            filePath: wx.env.USER_DATA_PATH + '/poster.png'        })        wepy.$toast('图片已保存到相册赶紧晒一下吧~')        self.isShow = false        self.$apply();    },    fail:function(e){        console.log(e)    }})wx.getFileSystemManager()  是获取文件管理器对象；aa.writeFile  是写文件详细参数可\t点击查看 官方文档说明。String wx.env.USER_DATA_PATH文件系统中的用户目录路径wx.env.USER_DATA_PATH +'/test.png'  这里是创建一个临时文件的文件名。that.data.scene.slice(22)   这里是把 data:image/png;base64这一段去除需要注意的是去除这一段之后 base64 编码之间放到image组件的src里面是不能显示图片的。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    最简单的小程序状态管理方案! - mobx-mini               用云开发制作教务助手小程序丨实战                                                        原作者:  一统                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "借助云开发实现互动打卡｜实战 ", "author": "                  Rolan                  2019-10-30 00:32                ", "text": "                                                                                                                                                                                     个人介绍大家好我是Zero一名大四的前端开发爱好者目前主要研究微信小程序和iOS开发。这是第二次参加微信小程序应用开发赛2018年我们设计了一款通过二维码寻找丢失物品的小程序《蝴蝶寻物》获得了华北赛区三等奖。今年在小程序云开发功能的大力推广下我决定采用云开发的方式实现一个双人互动打卡互动的小程序《Mango Daily》(中文名称《芒果日常》)。(由于是个人开发者账号所以暂时还未上架)得力于云开发提供的API本项目在较短的时间内就实现了比较理想的效果。接下来我想从本项目入手讲讲我是如何依靠 小程序+云开发平台 将想法快速实现的。1. 技术准备在去年的项目中我们采用ThinkPHP开发了一套API系统其中需要实现小程序的授权登录设置鉴权来保证数据安全等操作。整个过程只有我一名开发人员所以大致就是“先搞定后端其次搞定界面最后进行联调”的一个过程。后来在云+社区看到一篇文章： 《1个开发如何撑起一个过亿用户的小程序》 觉得可以尝试一下新的开发方式。通读小程序云开发文档之后发现并不需要学习新的技术就可以快速上手。2. 开发Mango Daily 使用的是小程序原生开发+云开发结合的方式进行开发的。2.1 界面开发界面没有使用第三方UI框架而是自己将常用的模块封装成了组件。图中比较核心的模块包括 TabBar、Toast、Modal、Nav等。2.2 云开发云开发包括云数据库云函数和云存储。本项目中三个功能均使用到。2.2.1 云数据库云数据库是一个非关系型数据库在实际开发中基本符合本项目的需求。部分表关联查询则是通过分步查询的方式代替。云数据库已经实现了自动鉴权可以保证数据的安全性。目前云数据库只支持以下几种权限：所有用户可读仅创建者可读写仅创建者可读写所有用户可读所有用户不可读写默认情况下是 仅创建者可读写 所以在首次开发时手动插入的测试数据并不一定可以在前端顺利读取需要修改集合的权限。云数据库的调用在前端代码中即可完成。但是从上面几种读写权限来看并没有办法实现对另一个用户创建的数据进行修改或者删除的操作(当然这也是非常不可取的)于是云函数就派上用场了。2.2.2 云函数我理解的云函数则是跑在云端的一个函数脚本文件。在接触云开发之前如果我们想要去调用微信公众平台提供的API(例如发起退款、发送模板消息等)则需要在后端代码去实现然后只需要给前端返回一个JSON表示请求状态即可。或者想要去实现上述描述中修改一条由他人创建的数据的功能时都是有后端工程师去完成的。在本次开发中我深刻体会到了云函数的强大以及微信公众平台工程师设计产品的严谨性。Mango Daily用到了微信公众平台的模板消息功能所以需要在合适的时机请求微信官方提供的API。因为取消了后端的开发所以一开始打算直接在小程序端去请求官方API。但是失败了。因为此请求涉及APPKEY等重要信息禁止在小程序端代码中直接请求官方API。这样就可以通过云函数去代替先前的后端开发最后将状态返回给小程序端即可。例如想给新用户发送一条短信以往的做法是客户端请求后端API然后由后端完成发送短信操作。这里云函数就代替了后端开发。如果仅仅依靠小程序JS代码去发送短信是非常不可取的。另外云函数对云数据库有更高的操作权限所以想要修改、删除他人生成的数据时云函数可以直接进行操作。云函数还提供定时触发功能不过在本项目中暂未涉及。2.2.3 云存储本次开发省去了使用其他服务商的存储服务全部得力于云存储功能。云存储允许上传多种文件类型像图片、音频等文件还可以直接在小程序端调用。这里我们使用云存储实现了文章插图的功能。2.3 优化2.3.1 数据层封装Mango Daily 数据操作进行了两次封装一层是对云数据库API进行封装第二层是每一个数据集合都对应一个Manager管理层。以用户集合 UserArticle 为例项目中的结构如下：util|- db.jsmanager|- Article.js|- User.jsdb.js 是对云数据库API的封装实现了增删查改等操作以更新数据为例。/** * 更新数据 */const update = (collection, _id, data) => {    return new Promise((resolve, reject) => {        if (!exist(collection)) {            reject(401, resCode[401]);        }            db.collection(collection).doc(_id).update({            data: data        }).then(res => {            resolve(res);        }).catch((code, msg) => {            reject(code, msg);        });    });}Article.js是文章集合的管理类同样实现了增删查改等操作不过其是基于 db.js 进行扩展的。以更新文章操作为例：/** * 更新 */const update = (_id, data) => {    return new Promise((resolve, reject) => {        db.update(collection, _id, data).then(res => {            resolve(res);        }).catch((code, msg) => {            reject(db.errMsg);        });    });}之所以封装两层是想尽量减少Page对象中对云数据库的直接调用。这样在页面js文件中只需要调用某一个Manager提供的函数即可。2.3.3 后台上传策略Mango Daily还实现了发送模板消息的功能这就涉及到了FromID的收集。目前FromID的收集大部分采用埋点的方式。如果每次采集到新的FromID都直接上传到数据库存储可能会造成网络资源的浪费所以需要选择合适的时机上传数据。在本项目中每次采集到FromID首先存到 globalData 中当小程序进入后台状态时再进行数据的上传。app.js中的实现：/*** 后台监听*/onHide: function() {    this.uploadFormID();},/*** 上传token*/uploadFormID: function() {    let ids = this.globalData.formIds;            if (ids.length == 0) {      return ;    }        let formId = ids.pop();        this.push.upload(formId).then(_ => {      console.log(\"上传formID:\" , formId);      this.uploadFormID();    }).catch(err => {      console.log(err);    });},3. 维护很遗憾这一部分可能没有太多需要写的。在18年的项目中需要考虑数据库的维护问题。但是使用了云开发之后Serverless的优点就表现出来了。我无须将太多的精力放在后端的维护上。4. 总结在本次项目开发中我深刻体会到了云开发的便捷性。无须自己实现鉴权对接第三方存储。数据方面增删查改功能非常方便。云开发提供的种种便利让我在有新创意的时候优先选择小程序+云开发的方式去实现。你好你的小程序涉及用户自行生成内容的发布/分享/交流属社交范畴为个人主体小程序未开放类目建议申请企业主体小程序另外Mango Daily中的随笔功能属于用户自行生成内容功能所以在上架的时候个人开发者账号是不被允许的所以在考虑上架产品的时候请按照实际情况酌情考虑选择账号主体类型。源码地址https://github.com/TencentCloudBase/Good-practice-tutorial-recommended如果你想要了解更多关于云开发CloudBase相关的技术故事/技术实战经验请扫码关注【腾讯云云开发】公众号～                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序模块曝光埋点方法               小小的支付完成页上腾讯阿里打起来了                                                        原作者:  CloudBase                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "阿拉丁发布2019年小程序年度生态白皮书：小程序互联网时代到来 ... ", "author": "                  Rolan                  2020-1-3 00:18                ", "text": "                                                                                                                                                                                     速途网1月2日消息（报道：吴佳馨）今日阿拉丁小程序统计平台和阿拉丁指数共同发布了2019年小程序互联网发展白皮书。白皮书显示微信生态里有超过150万小程序开发者2019年微信商业化生态不断升级一码一物能力上线；搜一搜品牌官方区全新升级；小程序模板消息能力调整；小程序支持AR效果等为用户带来了许多有温度、有价值的服务同时小程序数据也一路猛增。用户方面过去一年社交裂变加“巨”粉丝群体体量小程序矩阵催“升”用户粘性小程序人均停留时长保持持续增长态势用户对小程序的使用习惯已经形成访问集中早7点至晚22点高峰时段根据报告显示30-39岁的用户占比最多为27.4%而生活服务、网络购物、工具、视频与游戏类小程序在不同年龄用户群体都被广泛应用。随着微信小程序市场的不断开发用户规模和渗透率的逐渐提升2020年微信小程序数据的增长态势将会势不可挡。据本次报告预测显示2020年微信小程序数量将会达到500万、DAU将会达到4.5亿、小程序用户人均单日使用时长有望突破1500秒。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序背后：巨头们各自为阵的四大移动新生态               张小龙微信公开课PRO演讲：信息互联的7个思考                                                        原作者: 吴佳馨                   来自: 速途网                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序登录数据解密 ", "author": "                  Rolan                  2019-6-19 00:13                ", "text": "                                                                                                                                                                                     小程序开发中需要用户授权登陆并获取用户的数据快速对接用户系统。openId与unionid的区别openId : 用户在当前小程序的唯一标识 unionId : 如果开发者拥有多个移动应用、网站应用、和公众帐号（包括小程序）可通过unionid来区分用户的唯一性因为只要是同一个微信开放平台帐号下的移动应用、网站应用和公众帐号（包括小程序）用户的unionid是唯一的。换句话说同一用户对同一个微信开放平台下的不同应用unionId是相同的。详情登录微信开放平台(open.weixin.qq.com) 。GET  https://api.weixin.qq.com/sns/jscode2session?appid=xx&secret=xx&js_code=xx&grant_type=authorization_code属性类型默认值必填说明appid    string    是    小程序 appId    secret    string    是    小程序 appSecret    js_code    string    是    登录时获取的 code    grant_type    string    是    授权类型此处只需填写 authorization_code    Object返回的 JSON 数据包属性类型说明openid    string    用户唯一标识    session_key    string    会话密钥    unionid    string    用户在开放平台的唯一标识符在满足 UnionID 下发条件的情况下会返回详见 UnionID 机制说明。    errcode    number    错误码    errmsg    string    错误信息解密类class WxBizDataCrypt{    private $appid;    private $sessionKey;    /**     * 构造函数     * @param $sessionKey string 用户在小程序登录后获取的会话密钥     * @param $appid string 小程序的appid     */    public function __construct( $appid, $sessionKey)    {        $this->sessionKey = $sessionKey;        $this->appid = $appid;    }    /**     * 检验数据的真实性并且获取解密后的明文.     * @param $encryptedData string 加密的用户数据     * @param $iv string 与用户数据一同返回的初始向量     * @param $data string 解密后的原文     *     * @return int 成功0失败返回对应的错误码     */    public function decryptData( $encryptedData, $iv, &$data )    {        if (strlen($this->sessionKey) != 24) {            return ErrorCode::$IllegalAesKey;        }        $aesKey=base64_decode($this->sessionKey);        if (strlen($iv) != 24) {            return ErrorCode::$IllegalIv;        }        $aesIV=base64_decode($iv);        $aesCipher=base64_decode($encryptedData);        $result=openssl_decrypt( $aesCipher, \"AES-128-CBC\", $aesKey, 1, $aesIV);        $dataObj=json_decode( $result );        if( $dataObj  == NULL )        {            return ErrorCode::$IllegalBuffer;        }        if( $dataObj->watermark->appid != $this->appid )        {            return ErrorCode::$IllegalBuffer;        }        $data = $result;        return ErrorCode::$OK;    }}代码如下仅供参考转载时请注明出处及相应链接本文永久地址：https://blog.yayuanzi.com/25402.html                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序打怪之在线客服自动回复功能(node版)               基于uni-app的缓存器                                                        原作者: user                   来自: blog                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "红包小程序小结 ", "author": "                  Rolan                  2019-12-30 00:33                ", "text": "                                                                                                                                                                                     最近做了一个红包兑换小程序遇到了一些问题这里做一下总结。1、需求：回流用户在游戏客户端获取到口令然后在小程序这边输入口令兑换红包成功之后钱会发到用户微信账户里。2、流程：若未授权显示授权按钮。点击授权登录授权成功后获取到私密字段iv和encryptedData调取登陆接口错误则提示相关信息正确则跳转校验姓名和身份证的页面校验通过就调取提现接口成功则提示提现成功同时显示生成分享图按钮。分享图由用户昵称头像二维码提现金额等等组成。3、框架：uniapp分享图的问题1、 measureText 获取宽度的时候传入的参数如果是数字则会返回0。let money = 10;  //这里需要把数字转成字符串ctx.measureText(money).width;2、绘制图片的时候不要忘了先使用 getImageInfo 转成临时地址再 drawImage 如果不经过这步虽然开发者工具上看到是正常的但是真机是显示不了。3、需要绘制微信头像的时候要在后台配置downloadFile合法域名 https://wx.qlogo.cn 4、最初背景图大概170KB尺寸750*1334最终绘制出来的分享图太大了。解决方法：把背景图片尽量再压缩最终是60多KB。调 canvasToTempFilePath 的时候设置 fileType 为jpgquality范围是(0,1]取个合适的值。 5、小程序里面的保存图片并不是长按保存的需要点击按钮授权。<button  open-type=\"getUserInfo\"  @getuserinfo=\"onGotUserInfo\"></button>、...onGotUserInfo(e){\tuni.saveImageToPhotosAlbum({\t\tfilePath: this.tempPath,\t\tsuccess(res) {\t\t\tuni.showToast({\t\t\t  title: '保存成功',\t\t\t  icon: 'success',\t\t\t  duration: 1500\t\t\t})\t\t},\t\tfail(err){\t\t\t}\t})}...如图：如果用户点击确定就会正常保存图片到本地相册了。如果用户点击取消不授权呢？那还能怎么样点击再弹出原来的弹窗重新授权呗。很遗憾这里并不能像授权登录弹窗一样点了取消之后再次点击授权按钮还会唤起那个弹窗。解决方法：在 saveImageToPhotosAlbum 的fail回调函数里面操作再次获取保存到相册权限。if (err.errMsg === \"saveImageToPhotosAlbum:fail:auth denied\" || err.errMsg === \"saveImageToPhotosAlbum:fail authorize no response\" || err.errMsg === \"saveImageToPhotosAlbum:fail auth deny\") {  uni.showModal({\ttitle: '提示',\tcontent: '需要您授权保存相册',\tshowCancel: false,\tsuccess:res=>{\t  uni.openSetting({\t\tsuccess(settingdata) {\t\t  if (settingdata.authSetting['scope.writePhotosAlbum']) {\t\t\tuni.showModal({\t\t\t  title: '提示',\t\t\t  content: '获取权限成功,再次点击保存图片按钮即可保存',\t\t\t  showCancel: false,\t\t\t})\t\t  } else {\t\t\tuni.showModal({\t\t\t  title: '提示',\t\t\t  content: '获取权限失败将无法保存到相册哦~',\t\t\t  showCancel: false,\t\t\t})\t\t  }\t\t},\t\tfail(failData) {\t\t  console.log(\"failData\",failData)\t\t},\t\tcomplete(finishData) {\t\t  console.log(\"finishData\", finishData)\t\t}\t  })\t}  })}点击取消按钮之后会跳转到这里。打开设置里的“保存到相册”的开关即可。原生微信小程序和uniapp框架的一些对比针对此次项目这里挑两点来写。全局变量的管理1、原生微信小程序可以在app.js的globalData对象中对全局变量进行管理app.jsApp({    globalData: {        session:\"\"    }})pages/index/index.js...const app = getApp()//获取应用实例app.globalData.session = \"xxxx\" //设置app.globalData.session  //读取...2、uniapp用的是vue的那套所以可以用vuex来管理状态import Vue from 'vue'import Vuex from 'vuex'Vue.use(Vuex);const store = new Vuex.Store({\t state : {\t\tsession:\"\"\t },\t mutations : {\t\tgetSession(state, res){\t\t\tstate.session = res;\t\t},\t }});export default store设置this.$store.commit('getSession',res.session) //接口返回res.session获取this.$store.state.session页面获取全局函数返回的值1、原生微信小程序比如在app.js中获取用户信息保存在 globalData 中userInfo字段然后页面在onload的时候获取全局的userInfo你会发现有时候拿不到。由于 getUserInfo 是网络请求可能会在 Page.onLoad 之后才返回所以需要加入 callback 以防止这种情况。app.jsApp({  onLaunch: function() {    this.init()  },  init: function() {    // 获取用户授权结果    wx.getSetting({      success: (res) => {        if (res.authSetting['scope.userInfo']) {          wx.getUserInfo({ // 获取用户信息            success: res => {              this.globalData.userInfo = res.userInfo;              if (this.userInfoReadyCallback) {                this.userInfoReadyCallback(res)              }            },            //拒绝授权            fail: res => {            }          })        } else {        }      }    })  },  globalData: {    userInfo: \"\"  }})pages/index/index.jsconst app = getApp()Page({  data: {\tuserInfo:\"\"  },  onLoad: function() {    if (app.globalData.userInfo) {      this.setData({        userInfo: app.globalData.userInfo,      })    } else{      app.userInfoReadyCallback = res => {        this.setData({          userInfo: res.userInfo,        })      }    }   },})2、uniapp是配合vuex和计算属性computed来处理的APP.vueexport default {\tonLaunch: function() {\t\tthis.getUserInfo();\t},\tmethods:{\t\tgetUserInfo() {\t\t\tuni.getSetting({\t\t\t  success: (res) => {\t\t\t\tif (res.authSetting['scope.userInfo']) {\t\t\t\t  uni.getUserInfo({ // 获取用户信息 \t\t\t\t\tsuccess: res => {\t\t\t\t\t\tthis.$store.commit('userInfo',{\t\t\t\t\t\t\tavatarUrl:res.userInfo.avatarUrl,\t\t\t\t\t\t\tnickName:res.userInfo.nickName\t\t\t\t\t\t})\t\t\t\t\t},\t\t\t\t\tfail: res => {\t\t\t\t\t}\t\t\t\t  })\t\t\t\t} else {\t\t\t\t}\t\t\t  }\t\t\t})\t\t},\t\t}}pages/index/index.vue获取到 userInfo 便可以使用了如果需要还可以使用watch监听。export default {\tdata() {\t\treturn {\t\t} \t},\tonLoad(){\t\t\t},\tcomputed: {\t\tuserInfo() {\t\t\treturn this.$store.state.hasUserInfo\t\t}\t},\twatch:{\t\tuserInfo(val){\t\t\tif(val){\t \t\t \t\t \t\t}\t \t}\t},\tcreated() {\t},\tmethods: {\t\t\t}}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    xquery小程序简易步进器               从CSS角度来做一个模态框                                                        原作者: Jervis                   来自: xiaojiecong                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信-小程序开发基础知识笔记 ", "author": "                  Rolan                  2019-11-22 00:41                ", "text": "                                                                                                                                                                                     绑定事件的方法：1.bindtab和catchtabcatchtab可以阻止事件冒泡<view bindtap='onClick'></view><view catchtap='onClick'></view>2.互斥事件绑定 mut-bind一个 mut-bind 触发后如果事件冒泡到其他节点上其他节点上的 mut-bind 绑定函数不会被触发但 bind 绑定函数和 catch 绑定函数依旧会被触发。在想要规定冒泡区间时可以用到。<view mut-bind:tap='onClick'></view>在基础库版本 2.7.1 以上可以使用 mark 来识别具体触发事件的 target 节点<view mark:myMark=\"last\" bindtap=\"bindViewTap\"><button mark:anotherMark=\"leaf\" bindtap=\"bindButtonTap\">按钮</button></view>在上述 WXML 中如果按钮被点击将触发 bindViewTap 和 bindButtonTap 两个事件事件携带的 event.mark 将包含 myMark 和 anotherMark 两项。Page({bindViewTap: function(e) {e.mark.myMark === \"last\" // truee.mark.anotherMark === \"leaf\" // true}})mark 和 dataset 很相似主要区别在于：1.mark可以冒泡如果存在同名的 mark 父节点的 mark 会被子节点覆盖。2.在自定义组件中接收事件时 mark 不包含自定义组件外的节点的 mark。3.不同于 dataset 节点的 mark 不会做连字符和大小写转换。.wxs文件的应用个人理解 .wxs文件就相当于cocos的prefab。执行起来比js性能要快。但是wxs是一门语言平行于JavaScript。wxs基础语法有频繁用户交互的效果在小程序上表现是比较卡顿的这时建议使用wxs为什么？因为小程序分为视图层和逻辑层比如需要拖动的功能touchmove事件从视图层抛到逻辑层逻辑层经过处理通过this.setData到视图层。1. 一次 touchmove 的响应需要经过 2 次的逻辑层和渲染层的通信以及一次渲染通信的耗时比较大。2. 此外 setData 渲染也会阻塞其它脚本执行导致了整个用户交互的动画过程会有延迟。WXS 函数的除了纯逻辑的运算还可以通过封装好的ComponentDescriptor 实例来访问以及设置组件的 class 和样式对于交互动画设置 style 和 class 很方便。代码示例：var wxsFunction = function(event, ownerInstance) {var instance = ownerInstance.selectComponent('.classSelector') // 返回组件的实例instance.setStyle({\"font-size\": \"14px\" // 支持rpx})instance.getDataset()instance.setClass(className)// ...return false // 不往上冒泡相当于调用了同时调用了stopPropagation和preventDefault}自定义组件上边在分析复杂交互时我们知道频繁的调用this.setData会使页面卡顿甚至导致小程序僵死。那么不想写或者说不会写wxs的开发者该怎么办呢？此时可以通过将页面的 setData 改为 自定义组件 中的 setData 来提升性能。原因：自定义组件中的setData不会进行深复制。（深复制会在这个值被组件间传递时才发生）自定义组件的规范1.在组件wxss中不应使用ID选择器、属性选择器和标签名选择器就只使用class选择器准没错。2.在自定义组件的 js 文件中需要使用 Component() 来注册组件。3.使用已注册的自定义组件前首先要在页面的 json 文件中进行引用声明。4.自定义组件和页面所在项目根目录名不能以“wx-”为前缀否则会报错。5.<slot></slot>相当于react的this.props.children。<!-- component-tag-name组件 --><view class=\"wrapper\"><view>这里是组件的内部节点</view><slot></slot></view><!-- 引用组件的页面模板 --><view><component-tag-name><!-- 这部分内容将被放置在组件 <slot> 的位置上 --><view>这里是插入到组件slot中的内容</view></component-tag-name></view>6.默认情况下一个组件的wxml中只能有一个slot。需要使用多slot时可以在组件js中声明启用。Component({options: {multipleSlots: true // 在组件定义时的选项中启用多slot支持},properties: { /\\* ... \\*/ },methods: { /\\* ... \\*/ }})此时可以在这个组件的wxml中使用多个slot以不同的 name 来区分。<!-- 组件模板 --><view class=\"wrapper\"><slot name=\"before\"></slot><view>这里是组件的内部细节</view><slot name=\"after\"></slot></view>使用时用 slot 属性来将节点插入到不同的slot上。<!-- 引用组件的页面模板 --><view><component-tag-name><!-- 这部分内容将被放置在组件 <slot name=\"before\"> 的位置上 --><view slot=\"before\">这里是插入到组件slot name=\"before\"中的内容</view><!-- 这部分内容将被放置在组件 <slot name=\"after\"> 的位置上 --><view slot=\"after\">这里是插入到组件slot name=\"after\"中的内容</view></component-tag-name></view>7.设置自定义组件的捕获和冒泡机制需要使用 triggerEvent 方法。// 组件 my-component.jsComponent({methods: {onTap: function(){this.triggerEvent('customevent', {}, { bubbles: true, composed: true })}}})组件中的behaviors个人理解：多个页面可能会共用一个功能这个功能抽象后称为组件。多个组件共用一个方法或者多个方法这类方法的集合称为behaviors。就tm理解成高阶组件就完了。组件间关系relations官方说：有时需要实现这样的组件：<custom-ul><custom-li> item 1 </custom-li><custom-li> item 2 </custom-li></custom-ul>说custom-ul 和 custom-li 都是自定义组件它们有相互间的关系相互间的通信往往比较复杂。具体怎么个复杂需要单独拎出来一个ralations属性来处理咱也不知道。使用方法：// path/to/custom-ul.jsComponent({relations: {'./custom-li': {type: 'child', // 关联的目标节点应为子节点linked: function(target) {// 每次有custom-li被插入时执行target是该节点实例对象触发在该节点attached生命周期之后},linkChanged: function(target) {// 每次有custom-li被移动后执行target是该节点实例对象触发在该节点moved生命周期之后},unlinked: function(target) {// 每次有custom-li被移除时执行target是该节点实例对象触发在该节点detached生命周期之后}}},// path/to/custom-li.jsComponent({relations: {'./custom-ul': {type: 'parent', // 关联的目标节点应为父节点linked: function(target) {// 每次被插入到custom-ul时执行target是custom-ul节点实例对象触发在attached生命周期之后},linkChanged: function(target) {// 每次被移动后执行target是custom-ul节点实例对象触发在moved生命周期之后},unlinked: function(target) {// 每次被移除时执行target是custom-ul节点实例对象触发在detached生命周期之后}}}})注意：必须在两个组件定义中都加入relations定义否则不会生效。还有一种情况如果你两个自定义组件都用了相同的behaviors你可以使用这个behavior来代替组件路径作为关联的目标节点。// path/to/custom-form.jsvar customFormControls = require('./custom-form-controls')Component({relations: {'customFormControls': {type: 'descendant', // 关联的目标节点应为子孙节点target: customFormControls}}})组件中的observers官方定义他叫数据监听器呵呵。使用方法：Component({attached: function() {this.setData({numberA: 1,numberB: 2,})},observers: {'numberA, numberB': function(numberA, numberB) {// 在 numberA 或者 numberB 被设置时执行这个函数this.setData({sum: numberA + numberB})}}})如果需要监听所有子数据字段的变化可以使用通配符 。Component({observers: {'some.field.**': function(field) {// 使用 setData 设置 this.data.some.field 本身或其下任何子数据字段时触发// （除此以外使用 setData 设置 this.data.some 也会触发）field === this.data.some.field},},attached: function() {// 这样会触发上面的 observerthis.setData({'some.field': { /* ... */ }})// 这样也会触发上面的 observerthis.setData({'some.field.xxx': { /* ... */ }})// 这样还是会触发上面的 observerthis.setData({'some': { /* ... */ }})}})特别地仅使用通配符 可以监听全部 setData 。**纯数据字段就是局部变量不参与渲染也不会传递。官方说这样声明后再用能提高性能要不我才不用。使用方式：Component({options: {pureDataPattern: /^_/ // 指定所有 _ 开头的数据字段为纯数据字段},data: {a: true, // 普通数据字段_b: true, // 纯数据字段},methods: {myMethod() {this.data._b // 纯数据字段可以在 this.data 中获取this.setData({c: true, // 普通数据字段_d: true, // 纯数据字段})}}})抽象节点又一个新名词呵呵呵。说白了就是有一个父容器组件A因为条件不同有可能A中会渲染组件B也可能渲染组件C。举个例子当页面需要单选和多选组件的时候,方法1是按条件引用两个封装好的组件（<单选/></多选>）方法2是你也可以只引用一个组件<啦啦啦/>只不过这个<啦啦啦/>组件去帮你按需渲染<单选/>或者<多选/>。需要在父容器组件A的.json文件声明：{\"componentGenerics\": {\"selectable\": true}}在使用组件时必须指定父组件具体是渲染哪个子组件：<啦啦啦 generic:selectable=\"单选\" /><啦啦啦 generic:selectable=\"多选\" />在页面的.json文件<啦啦啦/><单选/><多选/>都要引用。代码//page下页面的.json文件中{\"usingComponents\": {\"啦啦啦\": \"path/*/*\",\"多选\": \"*/checkbox\",\"单选\": \"*/radio\"}}当然你也可以在容器组件.json中指定默认用哪个组件：{\"componentGenerics\": {\"selectable\": {\"default\": \"*/checkbox\"// 多选}}}计算属性今天真是开眼了学到了这么多新词汇。。( 计算属性的作用）：是为了解决HTML代码中复杂的js代码（HTML代码中可以嵌套js代码）把复杂的js代码通过计算属性来解决这是计算属性的应用？？？ 听着词这么厉害干这事真是大才小用了。计算属性会使用缓存机制如果这个数据的值没有改变则计算属性将不会调用方法这点应该是它实际有价值的地方。实现原理很简单就是对已有的 setData 进行二次封装在每次 setData 的时候计算出 computed 里各字段的值这期间可以增加缓存机制属性值没有变化的复用。自定义组件拓展在react中想拓展一个组件怎么办会用高阶组件。小程序中自然是使用behaviors。// behavior.jsmodule.exports = Behavior({definitionFilter(defFields) {defFields.data.from = 'behavior'},})// component.jsComponent({data: {from: 'component'},behaviors: [require('behavior.js')],ready() {console.log(this.data.from) // 此处会发现输出 behavior 而不是 component}})Behavior() 构造器提供了新的定义段 definitionFilter 用于支持自定义组件扩展。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    在腾讯Q3财报中站C位的品牌小程序BAT态度大不同！               uniapp登录流程详解uni.login                                                        原作者:  yuezhongbao                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "教你制作挂件头像 | 小程序七十二变之 canvas 绘制国旗头像 ", "author": "                  Rolan                  2019-10-15 00:32                ", "text": "                                                                                                                                                                                     朋友圈被「请给我一面国旗@微信官方」刷屏虽然知道是假的但是从另一个角度来看弄清楚如何实现更有趣。1、canvas这就不得不提到小程序中的 API canvasH5 中也是有 canvas 的不过之前也一直没有机会用这次正好乘机试试水。晚上回家看了下官方文档网上搜了一些类似的功能实现最后写好了一个 demo基本上是能初步绘制国旗头像了。当然以后如果想要绘制其他带挂件的头像只需要更改挂件素材即可提前预约帮你们定做今年的圣诞帽。 2、代码来了实现过程主要分为以下几个步骤：1、新建 canvas 画板2、绘制头像当做背景（demo 目前是自行上传头像制作）3、绘制国旗边框4、保存到手机相册（需授权）废话不多说直接上代码：// wxml 页面<view class=\"container\">  <!-- 头像绘制区域 -->  <canvas canvas-id=\"myAvatar\" class=\"canvas\"></canvas>  <!-- 按钮 -->  <button class=\"btn-save\" bindtap=\"upload\">上传头像</button>  <button disabled=\"{{ !save }}\" class=\"btn-save\" bindtap=\"saveImg\">保存到相册</button></view>// 部分功能 js// 绘制头像背景drawAvatar() {  var that = this;  var p = that.data;  context = wx.createCanvasContext('myAvatar', this);  context.drawImage(p.src, 0, 0, 256, 256);  context.draw(true)  context.save();  context.translate(p.hat.x, p.hat.y)  context.scale(p.hat.b, p.hat.b)  context.rotate(p.hat.rotate * Math.PI / 180)  context.drawImage(p.hat.url, 0, 0, p.hat.w, p.hat.h)  context.draw(true)  this.setData({    save: true  })},// 保存图片saveImg() {  wx.canvasToTempFilePath({    canvasId: 'myAvatar',    success(res) {      wx.saveImageToPhotosAlbum({        filePath: res.tempFilePath,        success(res) {          wx.showToast({            title: '保存成功'          })        },        fail(res) {          wx.showToast({            title: '取消保存...',            icon: 'none'          })        }      })    }  })} 3、最后demo 写完了以小程序的尿性怎么会没有坑呢？发现真相的我眼泪差点掉下来而且这个坑不是一般的坑弄了老半天都没解决。具体是啥坑小程序留言区揭晓感兴趣的欢迎来留言讨论如何解决到发文为止依旧是个巨坑。公众号「我是玖柒后」后台回复「头像」即可获取 demo 源码填坑不忘挖坑人我太南了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    uni-app相关知识总结               小程序九九八十一坑之头像模糊谁的锅？                                                        原作者: 我是玖柒后                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序开发前的准备工作之【深入封装Component】 ", "author": "                  Rolan                  2019-5-14 00:50                ", "text": "                                                                                                                                                                                     在上一篇内容中主要总结了如何扩展小程序中的Page与Component函数在开发过程中减少包的引入这一篇则深入总结小程序自定义组件Component函数还有哪些可以进一步扩展的地方【demo地址】。优化点：优化组件定义默认值时声明的写法自定义watch函数监听全部参数变化编写小程序自定义组件时 你是否是这样？Component({  properties: {    num: {        type: Number,        value: 2    },    name: {        type: String,        value: \"abcdef...\"    },    test: Object // 即使没有默认值也要写上数据类型  },  methods: {    //...  }})复制代码我还是比较喜欢像【data】对象初始化时的写法:arrow_heading_down:Component({  props: {    num: 2,    name: 'abcdef...',    test: {}  },  methods: {    //...  }})复制代码开始改造properties：既然我们已经可以重写Component函数了那就有办法把这个数据【转换】成我们要的那种结构格式打开Init.js Component函数部分实现的步骤大概是：取到参数内名为props的对象 -> 获取每一个数据类型 -> 还原成小程序原来的数据格式 -> 重新赋值给properties// 优化 properties 传入方式let originComponent = Component;Component = (opt) => {  let { props = {} } = opt;  let properties = {};  // 获取自定义关键字【props】中的每一项  Object.keys(props).forEach(item => {    // 重新还原成原有数据格式    properties[item] = {      type: getValueType(props[item]), // 获取数据格式      value: props[item]    }  });  opt.properties = properties; // 还给properties...  //...  return originComponent(opt)}/** * 获取数据类型 * @param value * @returns {*} */function getValueType(value) {  if (typeof value === 'number') return Number;  if (typeof value === 'string') return String;  if (typeof value === 'boolean') return Boolean;  if (value instanceof Object && !value instanceof Array) return Object;  if (value instanceof Array) return Array;  return null;}复制代码组件声明默认数据格式的修改就弄好了其实这个东西并没有对开发上起到多么明显的优化无非就是少写几个字而已但是以此demo 还可以扩展出更多功能。监听组件传入参数变化小程序自定义组件的传入数据上可以声明observer监听器属性用来监听数据变化:arrow_heading_down:Component({  properties: {    num: {        type: Number,        value: 2,        observer (newVal, oldVal, changedPath) {            //...        }    },  },  methods: {    //...  }})复制代码其中observer接收的参数分别是newVal[改变的参数]、oldVal[改变之前的参数]、changedPath[具体改变的参数的key]默认要监听某个参数的时候都是需要写在具体参数的对象内的并且每个要监听的数据都要声明observer函数通过改造后 可以统一监听数据变动:arrow_heading_down:Component({  props: {    num: 2,    name: 'abcdefg....',  },  methods: {    // 自定义添加的监听方法    $watch(newVal, oldVal, changedPath) {        if (changedPath == 'num' && newVal == 5) {            this.data.name = 'five';            return this.triggerEvent(\"isFive\")        }        //...    }  }})复制代码相比每个参数都要监听 这种写法可以减少代码。实现$watch：实现步骤：获取自定义props对象 -> 还原成properties格式 -> 每一个数据内都添加observer函数 -> 函数在触发时 调用自身$watch函数// 优化 properties 传入方式let originComponent = Component;Component = (opt) => {  let { props = {} } = opt;  let properties = {};  // 获取自定义关键字【props】中的每一项  Object.keys(props).forEach(item => {    // 重新还原成原有数据格式    properties[item] = {      type: _util.getValueType(props[item]),      value: props[item],      // 每一个数据都添加observer方法监听      observer: function (newVal, oldVal, changedPath) {        const changeEvent = {          event: item,          newVal, oldVal, changedPath        };        // 传入属性可通过组件内定义的$watch方法统一监听变化        this.$watch && this.$watch(changeEvent);      }    }  });  opt.properties = properties; // 还给properties...  //...  return originComponent(opt)}/** * 获取数据类型 * @param value * @returns {*} */function getValueType(value) {  if (typeof value === 'number') return Number;  if (typeof value === 'string') return String;  if (typeof value === 'boolean') return Boolean;  if (value instanceof Object && !value instanceof Array) return Object;  if (value instanceof Array) return Array;  return null;}复制代码这样就可以实现$watch方法啦！【demo地址】                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从 VantComponent 谈 小程序维护               微信严控学习类产品“打卡”                                                        原作者:  张牧歌                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序使用车牌号输入法 ", "author": "                  Rolan                  2019-8-21 00:21                ", "text": "                                                                                                                                                                                     在做小程序时做了一个关于车的项目然后需要添加车辆信息、添加车牌号使用车牌键盘输入当时我把这个需求给砍了然后在添加车辆信息时老大看到数据库里我乱填的车牌号又让我把他加上了^o^1.效果图2.相关代码使用组件形式实现键盘输入组件代码index.wxml<view class=\"carPlate\" wx:if=\"{{show}}\">  <block wx:if=\"{{type==1}}\">    <view class=\"wordList\">      <view class=\"wordItem\" wx:for=\"{{cityKeyword1}}\" wx:key=\"{{item}}\" bindtap=\"handleClick\" data-type=\"1\" data-item=\"{{item}}\">{{item}}</view>    </view>    <view class=\"wordList\">      <view class=\"wordItem\" wx:for=\"{{cityKeyword2}}\" wx:key=\"{{item}}\" bindtap=\"handleClick\" data-type=\"1\" data-item=\"{{item}}\">{{item}}</view>    </view>    <view class=\"wordList\">      <view class=\"wordItem\" wx:for=\"{{cityKeyword3}}\" wx:key=\"{{item}}\" bindtap=\"handleClick\" data-type=\"1\" data-item=\"{{item}}\">{{item}}</view>    </view>    <view class=\"wordList\">      <view class=\"wordItem\" wx:for=\"{{cityKeyword4}}\" wx:key=\"{{item}}\" bindtap=\"handleClick\" data-type=\"1\" data-item=\"{{item}}\">{{item}}</view>    </view>  </block>  <block wx:else>    <view class=\"wordList\">      <view class=\"wordItem\" wx:for=\"{{keyNumber}}\" wx:key=\"{{item}}\" bindtap=\"handleClick\" data-type=\"2\" data-item=\"{{item}}\">{{item}}</view>    </view>    <view class=\"wordList\">      <view class=\"wordItem\" wx:for=\"{{wordList1}}\" wx:key=\"{{item}}\" bindtap=\"handleClick\" data-type=\"2\" data-item=\"{{item}}\">{{item}}</view>    </view>    <view class=\"wordList\">      <view class=\"wordItem\" wx:for=\"{{wordList2}}\" wx:key=\"{{item}}\" bindtap=\"handleClick\" data-type=\"2\" data-item=\"{{item}}\">{{item}}</view>      <view class=\"wordItem wordClear\" bindtap=\"handleClick\" data-item=\"delete\">        <image src=\"/images/input-clear.png\" class=\"clearImg\"></image>      </view>    </view>    <view class=\"wordList\">      <view class=\"wordItem\" wx:for=\"{{wordList3}}\" wx:key=\"{{item}}\" bindtap=\"handleClick\" data-item=\"{{item}}\">{{item}}</view>      <view class=\"wordItem wordConfirm\" bindtap=\"handleClick\" data-item=\"confirm\">确定</view>    </view>  </block></view>index.css.carPlate{  position: fixed;  padding: 12rpx 12rpx 30rpx;  left: 0;  bottom: 0;  width: 100%;  /* height: 150px; */  font-size: 30rpx;  background: #fff;  box-sizing: border-box;  border-top: 1px solid rgb(211, 207, 207);  z-index: 200;}.wordList{  display: flex;  width: 100%;  justify-content: space-between;  align-items: center;}.wordItem{  margin: 5rpx;  width: 70rpx;  height: 70rpx;  line-height: 70rpx;  text-align: center;  border: 1px solid #eee;  border-radius: 10rpx;}.wordConfirm{  width: 130rpx;  color: #fff;  background: #473af0;}.wordClear{  width: 100rpx;}.clearImg{  width: 60rpx;  height: 60rpx;  vertical-align: middle;}index.jsComponent({  properties: {    type: {      type: Number,      default: 1,    },    show: {      type: Boolean,      default: false,    }  },  data: {    cityKeyword1: '京沪浙苏粤鲁晋冀豫',    cityKeyword2: '川渝辽吉黑皖鄂湘赣',    cityKeyword3: '闽陕甘宁蒙津贵云',    cityKeyword4: '桂琼青新藏港澳台',    keyNumber: '1234567890',    wordList1: 'QWERTYUIOP',    wordList2: 'ASDFGHJKL',    wordList3: 'ZXCVBNM',  },  methods: {    handleClick(e) {      let value = e.currentTarget.dataset.item;      let type = e.currentTarget.dataset.type;      switch(value) {        case 'confirm':          this.triggerEvent('confirm');          break;        case 'delete':          this.triggerEvent('delete');          break;        default:           this.triggerEvent('change', { value, type });      }    }  }})3.父组件引入我想实现点击输入后有上拉的效果开始我想使用offset来实现的但是下班后洗衣服想了下不太好实现我就想到了我以前做购物车时有用到transform原理差不多我就把他用上了然后就是点击键盘外实现收起键盘开始我想到的就是在父组件的最外层定义关闭事件父级里面的盒子都使用catch方法阻止冒泡但想下阻止冒泡好像又有点不合情理就又把阻止冒泡给去掉了父组件index.wxml<view class=\"container\" bindtap=\"handlePlateConfirm\">  <view class=\"translateView\" style=\"transform: translateY({{translateSpace}}px)\">    <view class=\"list\">      <view class=\"item\">        <view class=\"label\">*车牌号码</view>        <view class=\"contentBox\" catchtap=\"handleClick\">          <view class=\"inputBox\" wx:if=\"{{carNo}}\">{{carNo}}</view>          <view class=\"promptText\" wx:else>请输入车牌号</view>        </view>      </view>    </view>  </view></view><car-plate show=\"{{showPlateInput}}\" bindchange=\"handlePlateChange\" type=\"{{inputType}}\" bindconfirm=\"handlePlateConfirm\" binddelete=\"handlePlateDelete\" />父组件index.jsPage({  data: {    carNo: '',    translateSpace: 0,    inputType: 1, // 车牌输入类型1简称2数字或者字母,    showPlateInput: false,  },  /* 用于点击弹出键盘输入space为键盘弹出后向上拉取的距离 */  handleClick(e) {    /* 150为键盘的高度 */    let space = -(e.currentTarget.offsetTop - 150);    /* regExp用于判断当前已输入的车牌号是否是中文并让键盘显示中文还是英文输入 */    let regExp = /^[\\u4e00-\\u9fa5]+/;    let inputType = 1;    if(regExp.test(this.data.carNo)) {      inputType = 2;    }    this.setData({      translateSpace: space,      showPlateInput: true,      inputType    })  },  /* 键盘输入操作 */  handlePlateChange(e) {    let value = e.detail.value;    let type = e.detail.type;    let carNo = this.data.carNo;    carNo += value;    if(type == 1) {      this.setData({        inputType: 2      })    }    this.setData({      carNo    })  },  /* 点击键盘上的确定 */  handlePlateConfirm() {    /* isCarPlate用于判断输入的车牌号是否符合规范 */    if (!this.isCarPlate(this.data.carNo)) {      wx.showToast({        title: '请输入正确的车牌号',        icon: 'none',        duration: 2000      })      return false;    }    this.setData({      translateSpace: 0,      showPlateInput: false,      inputType: 1    })  },  /* 用于键盘输入删除 */  handlePlateDelete(e) {    let carNo = this.data.carNo;    carNo = carNo.substring(0, carNo.length - 1);    if(carNo.length == 0) {      this.setData({        inputType: 1      })    }    this.setData({      carNo,    })  },  /* 判断车牌号 */  isCarPlate(value) {    return /^(([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领][A-Z](([0-9]{5}[DF])|([DF]([A-HJ-NP-Z0-9])[0-9]{4})))|([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领][A-Z][A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳使领]))$/.test(value);  }})父组件index.css.container{  height: 100vh;  background: #fff;}.translateView{  background: #eee;}.list{  margin-bottom: 20rpx;  background: #fff;}.list:last-child{  margin: 0;}.item{  display: flex;  padding: 0 26rpx;  width: 100%;  height: 116rpx;  box-sizing: border-box;  align-items: center;  border-bottom: 1px solid #eee;}.item:last-child{  border: none;}.label{  margin-right: 10rpx;  width: 140rpx;}.contentBox{  display: flex;  width: calc(100% - 150rpx);  height: 90rpx;  align-items: center;  justify-content: space-between;}.promptText{  color: #c7c7c7;}.inputBox{  width: 100%;  height: 80rpx;  line-height: 80rpx;}正在努力学习中若对你的学习有帮助留下你的印记呗（点个赞咯^_^）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    解决小程序中webview页面多层history返回问题               小程序拼接图片链接无底洞探究                                                        原作者: ZJW0215                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": null, "author": "", "text": ""},{"title": "微信小程序使用echarts，实现左右双Y轴，动态获取数据，生成折线图 ... ", "author": "                  Rolan                  2019-11-8 00:52                ", "text": "                                                                                                                                                                                     微信小程序使用echarts实现左右双Y轴动态获取数据生成折线图 本来使用的是wxcharts但发现实现不了左右双y轴的效果就换成echarts效果图展示 要实现这样的效果需要以下几步： （1）去github下载插件放进自己的项目里 呐链接 ===>点击这里 只需要将名称是ec-canvas的文件夹放进自己项目里。 像这样： 图片发自简书App（2）分别写小程序的四个文件 ①//echart.json{  \"usingComponents\": {    \"ec-canvas\": \"../../ec-canvas/ec-canvas\"  }}②<!--echart.wxml--><view class=\"container\">     <ec-canvas id=\"myechart\" canvas-id=\"graph\" ec=\"{{ ec }}\"></ec-canvas></view>③/* echart.wxss*/.container{  margin: 0;  padding: 0}④ echart.js 这里分步写： 第一步：导入 echarts 插件import * as echarts from '../../ec-canvas/echarts';第二步：写在Page外的方法function echart(chart, leftData, rightData) {//leftData是坐标系左边y轴rightData是右边y轴  var option = {    //网格    grid: {      bottom: 80,      show: true,      // containLabel: true    },    //图例    legend: {      data: [{          name: 'leftData',          textStyle: { //设置颜色            color: '#6076FF',            fontSize: '14',          }        },        {          name: 'rightData',          textStyle: {            color: '#FFC560',            fontSize: '14',          }        }      ],      x: 'left',      bottom: 15,      left: 30    },    //x轴    xAxis: {      type: 'category',      boundaryGap: false,      disableGrid: true, //绘制X网格      data: ['', '', '', '', '', '', '', '', ''],      splitLine: {        show: true,        //  改变轴线颜色        lineStyle: {          // 使用深浅的间隔色          color: ['#DDDDDD']        }      },      //去掉刻度      axisTick: {        show: false      },      //去掉x轴线      axisLine: {        show: false      },    },    //y轴    yAxis: [{        name: 'mph',        type: 'value',        min: 0,        // max: 40,        //y标轴名称的文字样式        nameTextStyle: {          color: '#FFC560'        },        //网格线        splitLine: {          show: true,          lineStyle: {            color: ['#DDDDDD']          }        },        //去掉刻度        axisTick: {          show: false        },        //去掉y轴线        axisLine: {          show: false        },      },      {        name: 'g',        type: 'value',        // max: 4,        min: 0,        nameTextStyle: {          color: '#6076FF'        },        //去掉刻度        axisTick: {          show: false        },        //去掉y轴线        axisLine: {          show: false        },      }    ],    series: [{        name: 'leftData',        type: 'line',        animation: true, //动画效果        symbol: 'none',        //折线区域        areaStyle: {          //渐变颜色          color: {            type: 'linear',            x: 0,            y: 0,            x2: 0,            y2: 1,            colorStops: [{              offset: 0,              color: '#6076FF' // 0% 处的颜色            }, {              offset: 1,              color: 'rgba(96,118,255,0.1)' // 100% 处的颜色            }],            global: false, // 缺省为 false          },        },        //折线宽度        lineStyle: {          width: 2        },        color: '#6076FF',        data: leftData // 后台传过来的动态数据        //设置固定的数据        // data: [        //   23, 30, 20, 23, 30, 26, 20, 25, 25        // ]       },      {        name: 'rightData',        type: 'line',        yAxisIndex: 1,        animation: true,        symbol: 'none',        areaStyle: {          color: {            type: 'linear',            x: 0,            y: 0,            x2: 0,            y2: 1,            colorStops: [{              offset: 0,              color: '#FFC560' // 0% 处的颜色            }, {              offset: 1,              color: 'rgba(255, 197, 96,0.3)' // 100% 处的颜色            }],            global: false, // 缺省为 false          },        },        lineStyle: {          width: 2        },        color: '#FFC560',        data: rightData,//后台传过来的动态数据        //设置固定的数据        // data: [        //   2, 1, 0.5, 0.9, 2, 1.0, 0.6, 2, 0.5        // ]      }]  }}第三步：写在Page里的方法（包括onLoad(),初始化）/** * 页面的初始数据 */data: {  ec: {    lazyLoad: true //初始化加载  }},onLoad: function (options) {  let that = this;  this.oneComponent = this.selectComponent('#mychart');  let url = \"xxxxx\";  let params = {    \"openId\": options.id,  };wx.request({    url: \"xxxx\",    method: 'POST'    data: params,    header: header,    success: (res) => {     that.setData({       leftData: xxx,//从后台获取的数据       rightData: xxxx //从后台获取的数据   });    },  //给图表加上数据  that.initGraph(that.data.leftData, that.data.rightData)  })}初始化图表initGraph: function (leftData, rightData) {  this.oneComponent.init((canvas, width, height) => {    const chart = echarts.init(canvas, null, {      width: width,      height: height    });    initChart(chart, leftData, rightData);    this.chart = chart;    return chart;  });}到这就搞定啦                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    在小程序中自定义弹窗组件               微信小程序工程化之路                                                        原作者: 故事外的人呀                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序 短信验证码登录 倒计时 setInterval ", "author": "                  Rolan                  2018-9-14 00:19                ", "text": "                                                                                                                                                                                     需求：输入手机号 -> 点击获取验证码 -> 进入60s倒计时 短信验证码登录  data: {     seconds: 0, // 读秒    timer: '' // 计时器  },       let that = this      // 开始倒计时      that.setData({         seconds: 60,        timer: setInterval(function(){          let seconds = that.data.seconds          that.setData({ seconds: seconds - 1 })          if (that.data.seconds == 0) {            // 读秒结束 清空计时器            clearInterval(that.data.timer)          }        }, 1000)      })                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)niew                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序点赞收藏功能               认识小程序云开发                                                        原作者: 一本大书                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序倒计时深究                                                                                               "},{"title": "微信小程序客服消息功能 php ", "author": "                  Rolan                  2019-8-12 00:21                ", "text": "                                                                                                                                                                                     项目说明：本项目是一个简单微信小程序客服消息类实现客服消息相关功能。官方给的php示例有误这里就不再吐槽了。本示例是采用开发者服务器没有采用云调用的形式。官方文档：客服消息指南客服消息服务端适用场景客户消息流程图使用步骤1、开启客服消息https://mp.weixin.qq.com/wxam...登录-开发-开发设置-消息推送[]( https://raw.githubusercontent...点击“启动”[]( https://raw.githubusercontent...URL(服务器地址)：填开发者服务器对应的url如 https://xxxxxx/demo.phpToken(令牌)：这个随便填要求3-32位。EncodingAESKey(消息加密密钥)：这个点击“随机生成”即可。消息加密方式：可以根据自己需要选择本例选择”兼容模式“。数据格式：json相对于xml来说从压缩效率及传输效率更具优势这里我们选json。注意：以上操作完后先不要提交等配置好开发者服务端后再提交。2、配置开发者服务端检验signature的PHP示例代码：$signature = $_GET[\"signature\"];    $timestamp = $_GET[\"timestamp\"];    $nonce = $_GET[\"nonce\"];    $echostr=$_GET[\"echostr\"];    $token = TOKEN;//这里改成你第一步操作时填写的token    $tmpArr = array($token, $timestamp, $nonce);    sort($tmpArr, SORT_STRING);    $tmpStr = implode( $tmpArr );    $tmpStr = sha1( $tmpStr );    if ($tmpStr == $signature ) {        return $echostr;    } else {        return false;    }官方示例没有返回 $echostr 这个检验开发者服务端是否成功的关键必须返回。3、提交消息推送配置如果没有报错证明配置成功。4、开发者服务端demo<?php//验证signature//$signature = $_GET[\"signature\"];//$timestamp = $_GET[\"timestamp\"];//$nonce = $_GET[\"nonce\"];//$echostr=$_GET[\"echostr\"];////$token = TOKEN;//这里改成你第一步操作时填写的token//$tmpArr = array($token, $timestamp, $nonce);//sort($tmpArr, SORT_STRING);//$tmpStr = implode( $tmpArr );//$tmpStr = sha1( $tmpStr );////if ($tmpStr == $signature ) {//    return $echostr;//} else {//    return false;//}include_once './Xcxmsg.php';$xcxmsg = new Xcxmsg();$postStr = file_get_contents('php://input');if (!$postStr)    return false;$postArr = json_decode($postStr, true);if (!isset($postArr['MsgType']) || !isset($postArr['FromUserName']))    return false;$data = [\"touser\" => $postArr['FromUserName']];$accessToken = $xcxmsg->getAccessToken();$url = \"https://api.weixin.qq.com/cgi-bin/message/custom/send?access_token=\" . $accessToken;switch ($postArr['MsgType']) {    case \"text\":        //如用户发送的是文字信息这里处理        //回复图文链接也可以回复别的类型根据需要        $data['msgtype'] = \"link\";        $data['link'] = [            \"title\" => \"hello\",            \"description\" => \"Is Really A Happy Day\",            \"url\" => \"LINK_URL\",//连接url            \"thumb_url\" =>\"THUMB_URL\" //图片url        ];        $json = json_encode($data, JSON_UNESCAPED_UNICODE);        $xcxmsg->curl($json, $url);        break;    case \"image\": //如用户发送图片消息进入这里        //服务端回复 图片也可以回复别的类型根据需要        $data['msgtype'] = \"image\";        $data['image'] = ['media_id' => 'media_id值']; // 执行 $xcxmsg->upload($accessToken)返回的 media_id        $json = json_encode($data, JSON_UNESCAPED_UNICODE);        $xcxmsg->curl($json, $url);    case \"miniprogrampage\":        //如用户发送小程序卡片进入这里        //这里服务端回复小卡片也可以回复别的类型根据需要        $data['msgtype'] = \"miniprogrampage\";        $data['miniprogrampage'] = [            \"title\" => \"title\",            \"pagepath\" => \"pages/index/index\",            \"thumb_media_id\" => \"media_id值\"];// 执行 $xcxmsg->upload($accessToken)返回的 media_id        $json = json_encode($data, JSON_UNESCAPED_UNICODE);        $xcxmsg->curl($json, $url);        break;    case \"event\":        //如用户进入会话事件        //这里可以回复文本        $data['msgtype'] = \"text\";        $data['text'] = [            \"content\" => \"Hello World\",            ];        $json = json_encode($data, JSON_UNESCAPED_UNICODE);        $xcxmsg->curl($json, $url);        break;    default:}5、小程序前端在需要的地方添加以下代码：<button open-type=\"contact\" >客服消息</button>用微信开发工具的预览生成二维码扫描测试是否成功。项目地址： https://github.com/guyan0319/...在使用中如有任何问题请回复指正谢谢！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序预加载图片以及占位图片               撸一个微信小程序记事本备忘录-随微记                                                        原作者: guyan0319                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小小的支付完成页上，腾讯阿里打起来了 ", "author": "                  Rolan                  2019-10-31 00:02                ", "text": "                                                                                                                                                                                     表面看支付宝似乎在这个页面上和微信越来越趋同这实属意料之中商家们津津乐道的一句流传语可以很好地说明问题：“付款的结束是复购的开始”。作者： Miss豆教授来源：公众号：晓程序观察（ID：yinghoo-tech）支付完成页面一夜之间成为香饽饽。近日支付宝开放了「支付后推荐」能力商家可在用户支付后的成功页添加收藏小程序/关注生活号的组件并通过小程序收藏有礼/生活号关注有礼引导用户点击。收藏小程序有礼关注生活号有礼用大白话说就是商家可在用户支付成功页面通过优惠券鼓励用户收藏小程序或者关注生活号。由此一来支付结果页就成为下一次交易的开始最终形成“从支付到支付”的正向循环。是不是乍一听着实有些似曾相识？因为微信很早之前就推出了类似功能今年4月份微信支付合作伙伴大会上「支付有礼」能力亮相商家可以在“支付结果页发券”最终在用户端的操作场景是在某商家用微信支付完成支付后支付结果页面会推荐该商家的优惠券刺激用户复购。「店外附近发券」能力同时上线而更早之前微信支付在完成页上上线了关注服务号、获取立减金能力等。表面看支付宝似乎在这个页面上和微信越来越趋同这实属意料之中商家们津津乐道的一句流传语可以很好地说明问题：“付款的结束是复购的开始”。但两家平台属性不同能力开放的程度也不相同玩法自然也有不同处所以决定做一次对比PK帮助大家更好地选择。环节一：入驻门槛（线下、线下、线下！）对于开发者而言入驻门槛永远是关注的第一要素。毕竟即便功能被吹得天花乱坠开发者想入驻却难如登天久而久之也不会有太多人耐心地不厌其烦一遍又一遍地尝试接入。从微信的「支付有礼」和支付宝的「支付后推荐」能力门槛也能看出两家想主攻的方向。1. 微信：微信支付商户的专享虽然没有明确规定线下商户才能接入但从能力的选项可以看出 微信的「支付有礼」主要还是针对线下场景 。来看一段微信的官方介绍：支付有礼是面向符合条件的微信支付商户开放的营销能力用户在商家使用微信支付后可以领取微信支付代金券下次回店消费只要符合用券条件即可自动抵扣优惠能有效帮助商户拉动顾客二次购买或完成线下门店－线上商城的连接。这段话里透露了两个信息：首先适合有门店的线下商户其次想使用该能力就必须成为微信支付的商户。据我们了解 该能力目前主要是餐饮和零售两个类目使用 。2. 支付宝：门槛太“鸡贼”支付宝对于「支付后推荐」的门槛规定则更为细化：必须是开通当面付功能的商户；7天内交易平均交易笔数大于300笔。这样的门槛透漏了三个信号：首先由于当面付是针对于支付宝商户的能力因此只有成为支付宝商户才能使用「支付后推荐」功能而非小商贩都可以；其次当面付是针对线下商户的场景能力因此「支付后推荐」和微信一样锁定的是线下场景。此外300笔的周平均交易笔数并不算少并且当面付很难刷量有开发者对我们表示：“这是支付宝的鸡贼心理想用它的能力就必须得先推荐用户使用支付宝付款帮它推广这是支付宝在与相对佛系的微信支付竞争时的一个小伎俩”。截止发稿前支付宝似乎将门槛下调周日均300笔的限制要求下降至周均1笔（当面付or小程序支付笔数）。目前该能力还没有看到类目限制。总的来说两家的门槛限制都不算太高都是必须成为两家的商户。另一个值得注意的门槛是目前这些能力都是免费使用并且代金券、立减金都无需商户提前充值支持免充值使用商家使用多少代金券充多少即可这对于商家而言无疑是大大利好。环节二：留存、复购哪家强？在支付页面的玩法上微信起步早于支付宝。早在微信支付诞生不久就上线了支付完成后一键关注商家服务号的能力。总的来看在微信的支付完成页面上目前共有这些工具可以为商家使用：关注服务号、立减金等再加上今年推出了「支付有礼」、「附近发券」能力。而在支付宝的支付完成页面上主要工具是生活号、小程序。从工具数量上看微信支付明显多于支付宝。但工具数量不等于一切用组合出对用户而言有意思对商户而言有价值的玩法才是王道。玩法上两家有什么迥异？1. 线下拉来的新客放到哪里沉淀？无论是微信还是支付宝由于该能力基本对应线下因此该页面的拉新基本都来源于线下场景但将新客放到哪里去沉淀？微信和支付宝的打法有一些差异。微信支付页目前只能将用户留存到服务号上引导用户一键关注服务号；支付宝则是生活号和小程序都可以沉淀可以引导用户关注生活号、收藏小程序。值得注意的是 虽然看上去支付宝给商户提供的服务更多但关注生活号和收藏小程序商户只能二选一即要么使用「收藏有礼」、要么使用「关注有 礼」 。值得注意的是对于商户而言这两个“有礼”都要做。有些商家认为反正在用户端只会显示一个“有礼”那么在「支付后推荐」上就配置一个功能即可。但事实上「支付后推荐」能力虽然只在用户侧显示其中一个功能但是它会判断该用户是否已经关注过生活号或已收藏小程序。假如该用户已经收藏小程序那么系统则会展示“关注有礼”反之也一样。只有当用户两项“有礼”都已经领取后才不会显示“支付后推荐”。2. 线上+线下的复购玩法在复购毫无疑问对于商家而言留存的目的就是复购。通过微信的支付完成页复购有两个办法：线下二次复购： 在支付完成页直接向用户推送优惠券领券落地页立即使用跳转至扫一扫／付款码用户在门店核销；线上二次复购： 引导用户关注服务号用服务号向用户推送优惠券领券落地页跳转至小程序用户可一键跳转至小程序核销代金券。值得注意的是采用这种模式小程序appid需要跟活动商户号进行绑定。具体使用哪种由商户自行选择配置。支付宝的办法则更为直接无论是关注生活号有礼还是收藏小程序有礼都是一个路数用户点击关注或收藏后弹出代金券。代金券分为两种线上小程序使用或线下门店使用具体到底是线上还是线下由商户自己配置。在领券核销环节微信是领券即可使用支付宝则是收藏领券即可使用对小程序而言微信比较站在用户侧支付宝比较在商家侧。对关注公号/生活号而言微信只是单纯关注优惠券得等到下一次推文支付宝则是关注就有券马上可以用。对比来看线下复购微信更为直接只需一步操作最大化激活用户立刻复购的可能而支付宝则更为强调收藏小程序、关注公众号；线上复购微信的流程多一环用户关注服务号后需要商户通过服务号再次触达用户发送优惠券而支付宝是关注即送少了后续触达的一步。三、线下微信胜支付宝“竞争大”？通过以上可以看到 支付宝的「支付后推荐」目标鲜明就是吸引客户进入生活号、小程序以支付作为切入为生态内其他工具引流从而实现留存、复购的价值 。而微信能实现的场景更多通过服务号+优惠券可以实现线上留存、复购而线下发券可以实现线下的立刻复购。在不少人看来 相比于支付宝微信还多了即时回馈消费者聚焦二次消费的属性 。对于开发者和商户而言巨头生态都至关重要很少有人会二选一多数还是会选择双线布局。在他们看来两家的优点和缺点都很鲜明。微信方面支付完成页的线下复购刺激非常直接有效。事实上这种玩法此前就有很多小程序再玩了多位小程序服务商对我们表示过去送给用户的优惠券会直接发送微信卡包用户到店可以打开卡包进行核销。如若用户是在小程序上完成支付那么就将优惠券发送到小程序账户里之后通过模板消息提醒用户消费。现在通过微信支付完成页来刺激步骤极少对于复购刺激效率很高。但线上则显得薄弱很多“如果能从优惠券一键进入小程序那就非常棒了不然服务号推送优惠券这个流程可能会流失不少用户。”不少开发者对我们表示。支付宝的玩法对线上留存异常友好但也存在一个问题在支付宝的支付完成页上福利过多杂乱使用户体验并不太好：经常在商家的「支付后推荐」优惠券上方还有口碑券、饿了么券、保险基金、优酷7天会员等阿里系其他App的福利。对于用户而言选择了这些阿里“官方”福利后就无法再选择商户的优惠券。“这就是商户和阿里系官方福利竞争不像微信页面干干净净的商户优惠券非常显眼。”有开发者表示。据我们了解由天猫支付宝联合推出专为品牌商打造的「品牌轻店」也将在双十一前接入「支付后推荐」能力介入后用户在品牌商的线下门店支付后可一键收藏「品牌轻店」”程序进而跳转至天猫品牌旗舰店将线下流量导到线上这对同时有线下门店和天猫店铺的品牌商而言尤为重要。作者： Miss豆教授公众号：晓程序观察（ID：yinghoo-tech）来源：https://mp.weixin.qq.com/s/SBuyJmVsGqce_ZklH6yrIA本文由 @晓程序观察 授权发布于人人都是产品经理未经作者许可禁止转载题图来自Unsplash基于CC0协议                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    借助云开发实现互动打卡｜实战               介绍一个小程序预处理器                                                        原作者:  Miss豆教授                   来自: 人人都是产品经理                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序背后：巨头们各自为阵的四大移动新生态 ", "author": "                  Rolan                  2019-12-30 00:01                ", "text": "                                                                                                                                                                                     文｜刘旷“如今小程序的DAU（日活跃用户数量）已经超过了3.3亿到明年年底小程序的DAU可能会超过4.5亿。”阿拉丁创始人兼CEO史文禄近日在其主办的第三届全球小程序生态大会上如此表示。史文禄还提到：“2019年至少有23家小程序单日DAU突破1000万预计明年至少有100家小程序单日DAU突破1000万。小程序今年的交易GMV会突破1万亿元预测明年会超过3万亿元。”回想起来微信小程序在2017年1月才正式上线从零开始的小程序生态已然完美上演了一次爆炸性的增长奇迹。时至今日三年未满小程序从无人问津到日活3.3亿；从一文不值到GMV高达1万亿。小程序用不到三年时间已经打造出了一个万亿级的大生态。但是细究起来小程序的成功并非如我们想的那般顺理成章。1.主角总是在最后出场小程序这种应用形态的起点应该可以追溯到HTML5。HTML5于2007年在W3C立项与iPhone发布同年。乔布斯曾期待HTML5能帮助 iPhone 打造起应用生态系统但是因为HTML5的发展速度不及预期当时没能达到承载优秀移动互联网体验的地步于是苹果只能放弃这趟顺风车专心打造专属于自己的原生应用生态App Store。谷歌在2010年底正式发布Chrome Web store和Chrome OS表明这种区别于原生应用生态的移动互联网应用生态已经产生了一定的根基但是谷歌当时推出这套东西更多的是想用在上网本上而不是手机上。用在手机上的最早“小程序”构想是百度在2013年提出的轻应用（Light App结合了native app的用户体验和webapp可被检索与智能分发的特性）但是百度在移动互联网时代始终没能雄起轻应用最大的意义也就只是为其后来推出的“百度智能小程序”积累了一定的经验教训。当时国内除了百度其他很多巨头也都对这个东西感兴趣。2015 年DCloud联合360 手机推出了业内第一个商用的小程序360 称之为 360 微应用。为了做大生态DCloud 把这套技术标准捐献给了 HTML5 中国产业联盟随后联盟开始推动更多的超级 App 和手机厂商加入。但这件事情并不顺利首先是用户体验还没有做好同时巨头们又各有各的诉求尤其是腾讯直接想要另起炉灶于是张小龙从2015年就开始了对微信小程序的构思。  在国内巨头们开始普遍关注起这件事的2015年谷歌终于提出了PWAs（增强型网页应用Progressive Web Apps简称 PWAs）打算把当初的构想落实到手机上。但是它的动作实在太慢了到2017年2月4日谷歌才正式发布PWAs——比微信小程序还晚了将近一个月。总的来看这场大戏最有分量的两个主角——掌握全球最大web平台和Android系统的谷歌和掌握中国国民级应用的腾讯都是很晚才入场的。2.被游戏带飞的小程序生态张小龙在一开始做这件事的时候就抱有非常大的野心不同于之前“轻应用”和“快应用”在web技术生态上的修修改改。张小龙直接丢弃了国际标准组织W3C的DOM和Window标准仅仅采用基础JavaScript。这意味着他需要重造一个新的开发技术生态。在2016年的微信公开课PRO上张小龙把这种“做到让更多的APP有一种更轻量的形态”的尝试宣称为应用号而在团队内部这东西的代号是“web+”被寄望会诞生一种比web技术生态更牛的技术生态。但是技术这东西不是风口上能被吹飞起来的猪无论Flag立的有多高牛皮吹得有多好听代码都得一行一行敲出来。经过2016年一整年紧锣密鼓的开发测试在2017年1月9日凌晨东西终于被做好并且被定名为小程序正式上线。一经上线微信小程序“无需安装用完即走”的特性就受到了很多用户空前的关注和期待。《你好我是小程序》的文章刷爆朋友圈；网友狂欢“错过了公众号别再错过了小程序”；“干掉APP”的话题成了行业常用谈资……但是期待值过高往往就会更难接受现实落差。在小程序上线不到一个周后作为第一批参与者自媒体人罗振宇高调宣布关闭小程序还神秘兮兮地发布了一句话：“我们决定不做了。我们知道小程序是什么了。哈哈但是不能说。”小程序在应用层面受挫在技术界也受到了程序员们的冷落到2017年2月有报告称35.5%的开发者对小程序感到失望。小程序的前途眼看着越来越暗淡不过当时张小龙团队并不惊慌因为他们之前已经“讨论了小程序会有哪几种死法”。事实上背靠微信的小程序一旦出现就注定不会落寞太久就像腾讯在2012年推出公众号推动了新媒体行业的变革微信作为国民级应用数以亿计的流量红利无论向哪个方向倾斜都足以掀起滔天巨浪。小程序的滔天巨浪就出现在2018年初2017年12月28日微信开放了小游戏同时重点推荐了小游戏“跳一跳”。这款简单至极的小游戏创造了一项夸张的世界纪录截至2018年1月跳一跳已经积累起3.1亿玩家创下有史以来单款游戏用户规模达到的最大水平。而创下这个世界纪录微信小程序只用了一个月的时间。社交网络媒体的病毒式传播恐怖的效率彰显无疑。2018年初伴随着跳一跳那个没脸也没有肢体的“小人儿”在小方格间一步一步跳跃小程序的月活用户规模和渗透率也在呈指数级跃升。当小程序的月活用户数量突破4亿大关产业界就再也无法继续对此保持淡定。3.小程序帮助腾讯推开B端生意大门 2017年共享单车这种“共享经济”最具代表性的产物迎来了史上高光时刻20多个共享单车品牌在战场上相互绞杀。也是在这一年摩拜在一众竞争对手中渐渐脱颖而出追上行业缔造者“ofo”的身影。摩拜成功的秘诀很简单就是率先尝试使用微信小程序。作为最早在线下使用小程序的商家摩拜在2017年2月就上线了小程序当时微信小程序总体月活用户数仅有8万这点流量对那时的摩拜来说同样也是聊胜于无。但是微信小程序的影响力在慢慢扩大摩拜受益也就越来越明显仅两个月的时间过去小程序就为摩拜带来了50%的拉新注册用户增长30倍。张小龙最初对小程序的定义中激活线下流量是真正的核心摩拜完美地帮助张小龙验证了这个构想。这场经典的双赢合作为2018年摩拜被美团收购得到共享单车行业难得一见的善终打下了一定的基础；也为后来蜂拥而至的各类线上、线下商家提供了一个很好的借鉴案例。对腾讯而言更为重要的是为其拓展B端业务提供了一个很好的突破口。腾讯在2017年年报中颇为兴奋的表示在2017年底小游戏的带动之下截至2018年一月已经诞生了58万个小程序这些小程序将用户与众多的线上及线下服务连接涵盖零售、电子商务、生活服务、政务民生及游戏等多个领域。2018年腾讯表示小程序的潜力得到充分释放被用户和企业广泛采用奠定了连接线上用户和线下场景的行业趋势。身为传统的社交娱乐巨头腾讯930改革之所以敢把拥抱B端的口号喊得那么响亮可能也离不开来自小程序的一些底气。  在2018年年报中腾讯宣称其小程序已经覆盖超过200个服务行业2019年的重点任务之一就是利用小程序、微信支付和企业微信加强与企业的联系。在阿拉丁的统计中2018年微信小程序的平均日活超用户过2.3亿人覆盖用户约6亿。在这些数字背后是一个短短两年就成功崛起活力四射的小程序生态。4.技术生态发起者的殊荣在技术生态方面2018年小程序的标准和语言都已经相对成熟美团前端在2018年年初开源的MPVue也比微信自己在2017年发布的的WePY框架更成熟一些。把微信小程序的框架向前推进了一大步。在市场和技术越来越成熟的情况下阿里、百度、头条这些巨头当然不会对这种新的趋势熟视无睹他们参考微信小程序的标准纷纷推出自己的小程序。这个过程中京东Taro 框架诞生很好的解决了多端开发和适配的问题可以帮助开发者实现一次编写多端运行大大节约开发成本。之后的uni-app更进一步实现了自定义组件编译模式并在算法上做了很多优化。甚至可以让开发者一行代码不用改就可以同时发布小程序和 App。至此张小龙当初设想的小程序生态已经奠定好了一个非常坚实的根基。到2018年底超过200万额开发者加入到了小程序的开发这也是多年来中国IT行业里一个真正能够影响到普通程序员的创新成果。甚至小程序生态的成功也进一步提高了我国科技产业界搭建国产操作系统的信心。基于以上种种原因2018年11月7日微信小程序获得“世界互联网领先科技成果”奖。5.拼多多借小程序而起小程序这东西有很多好处对用户和运营商的好处尤其直观。用户“即用即走”的便利性不用多说运营商曝光率得到提高和开发成本降低尤其值得一提。小程序生态的最大受益者除了前面提到已经被美团收购的摩拜还有现在已经跻身为电商三巨头之一的拼多多。拼多多在2017年之前营收主要靠自营生鲜特卖在2017年之后才彻底转型为社交电商平台。它同样也是微信小程序发布早期就稳稳地搭上了这趟顺风车。拼多多的小程序玩法很多“好友帮开你领现金”、“邀请好友开宝箱领取无门槛现金”、“1分钱抽奖天天有惊喜”、“极速砍价1刀砍成不是神话”、“邀请好友打卡天天领红包”……套路层出不穷。这些小程序玩法完全是基于社交拼团砍价的逻辑。一套走完很顺畅就完成了拉新、活跃、留存的流程加上外链的辅助很轻易就把这些用户带入到拼多多自己的APP里成为拼多多真正的用户。得益于此拼多多的用户数量就像吹气球一样快速膨胀不到一年时间拼多多就成长为亿级APP。不仅仅是前面提到过的“跳一跳”这类小游戏、摩拜这类生活服务和拼多多这类电商很多其他内容资讯、休闲娱乐、旅行出行、实用工具类互联网企业也很快在微信生态里脱颖而出。6.小程序帮助中长尾企业缓解流量焦虑对比原生APP小程序的开发成本优势非常明显。从基本开发人员的配置分析小程序最低配备一名设计人员、一名前端人员、一名服务器端开发人员三个人就可以开始干活；做一款原生APP最起码还需要在这个基础上再配备一名ios前端或者 android前端开发人员。同时小程序远比原生应用做起来简单小程序的开发周期就会远比原生应用开发要短的多开发成本也就会进一步降低。对于中长尾企业来说小程序成本优势的意义尤其突出。根据工信部统计2018年我国市场上监测到的App总量达到449万款其中我国本土第三方应用商店（安卓）的App超过268万款苹果商店（中国区）移动应用数约181万款。但是从我国用户的使用习惯来看手机里最高安装APP总量不会超过100个每月最多使用30个每天最多使用不会超过10个。也就是说除了出现在各类榜单上极少数的APP有数百万APP做出来之后就注定会无人问津没有变现的可能而他们的开发成本可能价值数万元甚至更高。小程序的情况则相差迥异在阿拉丁的统计中2018年小程序数量突破230万个介于苹果和安卓之间其中当然也会很多中长尾小程序会沉寂下去但是开发成本要低得多这些中长尾小程序的损失就会小很多。另一方面小程序本身即用即走的零负担用户体验、适用场景广泛、背靠微信等亿级流量池的特性也让中长尾小程序获客难度降低露面出头的机会增多。因此到2019年小程序生态愈加繁荣虽然没能实现当初很多人“干掉APP”的狂想但是已经构建起一个从平台方到运营方再到服务方面面俱到的产业生态。这个小程序生态说要取代原生应用生态尚且为时过早但是一个“头部APP+中长尾小程序”的颇具活力和潜力的联盟生态已经基业牢固。7.繁荣生态背后的巨头霸权由微信发起其他巨头持续推动和跟进的小程序看起来完美的实现了一石数鸟、多方共赢。首先用户得到了“即用即走”的优秀体验对于很多用途单一使用频次低的服务可以做到进入场景立即享受服务退出场景不留下任何痕迹；其次大量中长尾和初创互联网企业获得了一个成本低、效果好的引流新渠道；再者推出小程序的巨头们尤其是先发优势明显的腾讯拥有了更多把触手向B端延伸的机会。但是有一个问题始终让人很在意那就是巨头们花费这么大的功夫构建起小程序生态除了扩大和B端的接触面积还有没有其他更深的图谋？考虑到阿里这个有着深厚B端基因的存在问题的答案呼之欲出。现在努力各自推进小程序的这些巨头尤其是最早构建这个生态的微信有一个最根本的目的就是构建“生态霸权”。什么是“生态霸权”？以谷歌的安卓系统为例IDC最新数据显示2019年Android平台手机的全球市场份额已经达到87%接近9成。这套系统最初由Andy Rubin开发2005年8月被谷歌收购注资2007年11月谷歌与84家硬件制造商、软件开发商及电信营运商组建开放手机联盟共同研发改良Android系统随后谷歌以Apache开源许可证的授权方式发布了Android的源代码。但是谷歌的“开源”显然是假开源真垄断把谷歌服务框架和安卓系统深度绑定在安卓系统中只要是谷歌提供的服务比如GmailYoutube、地图、搜索引擎对于其他服务商都拥有碾压级的优势于是在安卓系统中谷歌自然而然的完成了对自己的升格和对竞争对手的降格。小程序领域还没有形成类似智能手机市场这样的固化格局但是构建小程序生态的腾讯、阿里、百度、字节跳动和没有构建起这种小程序生态的其他玩家当然也会拉开越来越大的差距。这是一道很高的门槛跨过这道门槛就可以构建出“以我为主”的壁垒。比如阿里的小程序以生活服务、商业服务为主头条系的小程序以消费、生活服务、游戏为主。巨头们可以在壁垒内打击异己；与壁垒外的其他巨头展开生态竞争。如果没能跨过这道门槛就只能融入巨头们的生态中。后来的互联网创业者们陷入沉寂的不值一提而最好的结果也不过是像拼多多这样一夜崛起然后接受腾讯这样的巨头控股。经营难度有所降低但成长的上限也同样会降低。这将会成为移动互联网发展的一种新常态。【钛媒体作者介绍：文/刘旷公众号ID：liukuang110】                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    Mpx 小程序框架技术揭秘               阿拉丁发布2019年小程序年度生态白皮书：小程序互联网时代到来 ...                                                        原作者: 刘旷                   来自: 钛媒体                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序技术演进史 ", "author": "                  Rolan                  2019-6-25 00:22                ", "text": "                                                                                                                                                                                     【CSDN 编者按】小程序这个由微信带头的产物格外鲜明地体现了移动互联网的「时机」这个词早在微信小程序之前有力推轻应用的百度有来自 HTML5 中国产业联盟的 DCloud 所主张的流应用但最终却都已经淹没在了移动互联网的历史长河之中。唯有微信小程序风生水起更是带动了巨头们的争相入场。小程序迎来了专属于中国移动互联网的群雄逐鹿的时代。本文作者王安即是流应用的创造者作为移动领域的老兵他依然在矢志不移地构建移动开发工具框架及生态从原生应用到 HTML5 再到如今的小程序他是这段历史的见证者、参与者。从这篇文章中我们能够鲜活地看到小程序的技术演进历程以及对于所有开发者来说终将去往何处。作者 | 王安责编 | 唐小引封图 | CSDN 付费下载自东方 IC出品 | CSDN（ID：CSDNnews）中国特色的移动互联网时代伴随着 QQ 小程序面向用户开放这个手机端月活 7 亿的巨无霸正式入场。小程序终于成为了超级 App 的标配。盘点下已经支持小程序的超级 App：微信、企业微信、QQ、支付宝、高德地图、手机淘宝、百度、百度贴吧、百度地图、今日头条、抖音……这些璀璨耀眼的名字背后都是巨大的流量。在这群超级 App 的支持下中国的移动互联网格局被彻底改变。这个有中国特色的移动互联网时代被称为“小程序时代”。这是继手机支付后中国的移动互联网领先世界的第二个代表事物。中国的技术标准、开发者生态第一次得到大规模的普及应用而且很明显小程序在功能和体验上均超过了 HTML5。中国人能建立开发者生态吗？这个命题曾一度让人怀疑。小程序完成了这一步突破这是一场值得歌颂的中国技术生态发展史。让我们来回顾下这场技术生态革命是如何开始又将要去向何方。罗马不是一天建成的小程序不是一天发明出来的HTML5 于 2007 年在 W3C 立项与 iPhone 发布同年。乔布斯曾期待 HTML5 能帮助 iPhone 打造起应用生态系统。但 HTML5 的发展速度并不如预期它虽然成功地实现了打破 IE+Flash 垄断局面的目标却没有达到承载优秀的移动互联网体验的地步。于是在 iPhone 站稳脚跟后发布了自己的 App Store开启了移动互联网的原生应用时代。随后的 Android本来是基于 Linux 的 OS与之同期的 MeeGo 等竞争对手采用 C + HTML5 的双模应用生态策略然而 C 的开发难度太大HTML5 体验又不行。Android 依靠 Java 技术生态在竞争中脱颖而出。于是 在移动互联网初期应用生态被定了基调 —— 原生开发。在那个时候硬件不行也没有其他办法原生开发才能在低配硬件上带来商用体验。但大家都在怀念 HTML那种无需安装更新、即点即用直达二级页面的特点一直让人迷恋。图源：CSDN 付费下载自东方 IC国内有一批做浏览器的厂商尝试去改进 HTML5他们提出了 轻应用 的概念。通过给 WebView 扩展原生能力补充 JS API让 HTML5 应用可以实现更多功能。不过这类业务没有取得成功HTML5 的问题不止是功能不足性能体验是它更严重的问题而体验问题不是简单地扩展 JS 能力能搞定的。这类业务发展的顶峰是微信的 JS SDK。作为国内事实上最大的手机浏览器微信为它的浏览器内核扩充了大量 JS API让开发者可以用 JS 调用微信支付、扫码等众多 HTML5 做不到的功能。微信 JS SDK 说明文档但微信团队对这套方案的体验仍然不满意微信钱包栏目里打车、理财等很多应用虽然嵌入了 JS SDK但每次点击要等半天白屏让人用着很痛苦他们在业内开始寻找新的解决方案。业内早有专业团队看到了相同的问题。与浏览器不同Hybrid 应用是另一个细分领域。它们为开发者提供使用 JS 编写跨平台应用的工具为了让 JS 应用更接近原生应用的功能体验这个行业的从业者做出了很多尝试。笔者所在的 DCloud 即是其中之一我们 提出了改进 HTML5 的“性工能”障碍的解决方案 —— 通过工具、引擎优化、开发模式调整让开发者可以通过 JS 写出更接近原生 App 体验的应用。多 WebView 模式原生接管转场动画、下拉刷新、Tab 分页预载 WebView……各种优化技术不停迭代终于让 Hybrid 应用取得了性能体验的突破。Hybrid 应用和普通的轻应用相比还有一个巨大的差别：一个是 Client/Server一个是 Browser/Server。简单来说Hybrid 应用是 JS 编写的需要安装的 App而轻应用是在线网页。C/S 的应用在每次页面加载时仅需要联网获取 JSON 数据；而 B/S 应用除了 JSON 数据外还需要每次从服务器加载页面 DOM、样式、逻辑代码所以 B/S 应用的页面加载很慢体验很差。可是这样的 C/S 应用虽然体验好却失去了 HTML5 的动态性仍然需要安装、更新无法即点即用、直达二级页面。那么 C/S 应用的动态性是否可以解决呢？对此我们提出了流应用概念把之前 Hybrid 应用里的运行于客户端的 JS 代码先打包发布到服务器制定流式加载协议手机端引擎动态下载这些 JS 代码到本地并且为了第一次加载速度更快实现了应用的边下载边运行。就像流媒体的边下边播一样应用也可以实现边用边下。在这套方案的保障下终于解决了之前的各种难题： 让 JS 应用功能体验达到原生并且可即点即用、可直达二级页面。如今看来这已经变成了常识。但在当年先驱们做了无数艰辛探索。这套技术需要让客户端引擎提前预置在手机上就像流媒体的普及建立在 Flash 的装机量巨大的基础上那么普及这个客户端引擎就变得很重要。2015 年360 和 DCloud 合作在 360 手机助手里内嵌了这个客户端引擎推出了业内第一个商用的小程序360 称之为 360 微应用。微应用实现了在 360 手机助手的应用下载页面同时出现了“秒开”按钮点击后直接使用。并且在 360 手机助手的扫码里应用的分享里都实现了扫码获得一个应用点击分享消息获得一个应用。在 360 手机助手 3.4 版本中上线的中国第一个小程序为了做大生态DCloud 把这套技术标准捐献给了 HTML5 中国产业联盟随后联盟开始推动更多的超级 App 和手机厂商加入共同推进动态 App 产业的发展。然而事情并不顺利巨头们有自己的利益诉求。虽然有一批厂商同意加入联盟共建生态但最关键的角色真正的国民应用“微信”最终决定自立标准、自研引擎当然技术原理与流应用是基本一致的。2016 年 1 月 11 日微信公开课张小龙罕见露面公布了微信应用号的计划为这个大事件亲自站台。2016 年 9 月 21 日微信宣布更名应用号为小程序面向首批开发者内测。从此这个词被正式定了下来“小程序”成为后续一个时代的代名词。而“流应用”、“微应用”则淹没在历史长河中成为一个令人唏嘘的故事。2017 年 1 月 9 日微信公开课小程序面向用户正式推出。从此后阿里巴巴、手机厂商联盟、百度、今日头条陆续推出了自己的小程序平台其中也有很多波折与故事在有偶然、有必然的过程中形成了今天的局面。小程序大潮卷入了更多人并形成了更大的浪潮最终迎来了不可逆转的小程序时代。生态难难于上青天发明能解决功能体验和动态性的技术方案虽然难但不是最难的事情。最难的是开发者生态的建设。最初 HTML5 中国产业联盟的策略是在 HTML5 上扩展强化复用现有的 HTML5 生态。当微信的标准完全自立重建时业内人士都悬着一颗心。在全球基于 Web 的技术生态已经非常成熟各种开发工具、框架、组件、模板...提升着开发者的效率。小程序丢弃了国际标准组织 W3C 的 DOM 和 Window 标准仅仅采用基础 JavaScript。这意味着 HTML5 生态的各种轮子无法复用要完全重造一个新的小程序开发生态。当初微信推广 JS SDK 时是那么地顺其自然开发者纷纷开始使用因为对于开发者只是在他们的 H5 版本上补充一些 API 而已。而 小程序初期充满了开发者的质疑声 ：我的业务迭代那么久让我重新做一个版本你的生态到底能不能支撑我的投入？微信用持续而快速的版本升级、高管的站台告诉大家微信做小程序的决心并最终通过 2017 年底的跳一跳引爆了小程序。从此大家的问题不再是我要不要做小程序了而转向了：既然要做怎么才能提升小程序的开发效率、降低开发成本？任何一种技术或者开发模式的演进在不断成熟的过程中都遵循着类似的成熟规律：技术标准 -> 基础平台 -> 开发工具 -> 培训市场 -> 框架诞生 -> 周边生态逐步完善 -> 轮子之上的轮子在 HTML5 生态里已经发展到最终极的形态比如 Vue 是一个重要框架而基于 Vue 的各种丰富的 UI 库、测试框架则是轮子之上的轮子。多层轮子代表着生态的繁荣也意味着开发者的开发效率更高。可微信的全新标准出现时它把开发者推回了原始社会一切都要重来。这在当时看来并不是一个必然会成功的事情（ 其实直到现在比如图表类轮子小程序仍然比不过 HTML5 ）。时至今日讨论这个标准的选择对错已经没有意义。当支付宝、百度、今日头条都开始参考这个标准做小程序时时代已经不可阻挡。所幸最终的结果是中国人做成了。 在国际标准之外在中国终于建立起了自己的技术生态。并且这个生态给用户带来了更好的体验给开发者带来了更多流量和变现效率的提升这是一个比 HTML5 更优秀的生态。野蛮的技术生态成长速度两年时间中国的小程序开发者如何从原始社会进阶到现代文明？这也是一段有趣的历史。我们来看看小程序技术生态是如何快速成长走完上面所说的这套技术成熟路线也就是从技术标准到轮子之上的轮子的。在 Web 世界里已经成熟到了原生 JS 用量很少的时代了开发人员大量使用 Vue 等框架并且在 Vue 的基础之上又有更多轮子。当中国的开发人员面临重头开始时他们感受到效率对比的差距既然时代已不可阻挡那就拥抱它。勤劳的中国技术人开始蓬勃地建设起了小程序各种周边技术生态。其中比较重要的是 开发框架的迭代 我们看看每个小程序开发框架为什么会诞生、流行和衰落。最初的微信小程序一片荒蛮一份文档 + 一个难用的 IDE很多效率工具比如 npm、预处理器这些都不支持而这些已经是大型项目离不开的工具。于是第一个标志性的框架出现了 —— WePY。WePY 紧随微信小程序在 2017 年发布原本是腾讯其他部门的一个个人工程师的作品。在那个年代WePY 有效地解决了小程序不支持 npm、预处理器的痛点被引爆后腾讯官方才把这个框架收编到官方的 GitHub 下。不过 WePY 也面临很多问题它使用了私有语法这让它在生态建设上面临很大难度IDE 着色、语法提示、语法校验、格式化、人员招聘培训等各方面问题制约着它的流行和普及。面对这些问题人们开始思考有什么更好的方式可以复用现有技术生态来快速完善小程序生态？这时候下一个重要框架借势诞生美团前端在 2018 年初开源了 MPVue。MPVue 采用 Vue 语法来开发小程序通过对 Vue.js 的底层改造实现了编译到微信小程序。MPVue 良好地借助了 Vue 的技术生态周边工具如 IDE、校验器、格式化等支持直接复用、人员招聘培训等生态建设压力大幅下降受到了大量开发者的欢迎。看着熟悉 Vue 的开发者终于有了趁手的轮子那熟悉 React 的开发者怎会无动于衷？京东团队是 React 的重度用户还自研了 JDreact于是他们开发了 Taro 框架一款基于 React 语法编写小程序的框架。但 Taro 并不是想简单做一个 MPVue 在 React 世界里的翻版Taro 相比 MPVue想要解决更多重要问题。Taro 面世较晚此时微信、支付宝、百度、头条都已发布或宣传了自己的小程序开发者面临一个多端开发和适配的问题。于是 Taro 率先支持多端开发它甚至还能发布到 H5 和 App。图源：京东凹凸实验室当时小程序领域还有一个重要变化微信开始支持小程序自定义组件。组件是一个成熟框架不可缺的东西不管是 Vue 还是 React 都有丰富的组件生态。在过去MPVue 时代是把 Vue 组件也编译成页面模板这带来一个很大的性能问题在复杂页面里（比如长列表）使用组件更新组件状态会导致整个页面的数据全部从 JS 逻辑层向视图层通讯一次大量数据通讯会非常卡顿。注意：小程序的逻辑层运行在 V8 或 JSCore 下和视图层是分离的通讯阻塞很容易引发性能问题。于是 Taro 把 React 组件编译为新出的微信小程序自定义组件这种组件在数据更新时只会更新组件内部的数据而不是整个页面更新数据从而大幅减少了数据通信量。这一轮的后浪推前浪很猛Taro 在性能和多端支持上都超越了 MPVue。看着 React 阵营取得如此成绩Vue 阵营自然会继续追击。我们基于 Vue 开发了 uni-app 它实现了自定义组件编译模式并在算法上做了很多优化。 另外之前 MPVue 对 Vue 的语法支持度不太完善比如过滤器等不支持在 uni-app 中我们进行了解决。同样uni-app 也看到了前浪的其他问题：Taro 虽然迈出了多端的第一步但多端支持能力比较弱每个平台仍然各自开发大量代码。核心原因是Taro 在 H5 端和 App 端并不是一个完整的小程序技术架构无法保持最大程度的统一。于是 uni-app 在 App 端使用了一个技术架构相同的小程序引擎本身就可以直接运行小程序应用这个引擎搭配小程序代码打包为 App开发者一行代码不用改可以同时发布小程序和 App。当然其 App 引擎从 Hybrid 应用起家它提供的 API 要比小程序多很多因为 App 的需求会比小程序丰富它还支持把 WebView 渲染引擎替换为 Weex 渲染引擎。之后 uni-app 又发布了 H5 版的小程序引擎原理与小程序的 PC 模拟器相同实现了良好的跨 H5 版的发布。 于是 uni-app 比较完美地实现了开发一次7 个平台发布。第一层轮子就这样迅速发展了起来Web 世界里最成熟的 Vue、React 技术生态被导入了小程序开发生态中。然后轮子之上的轮子开始如火如荼的建设。以 UI 库为例之前的 UI 库有 Vue 库、React 库有 PC 库、H5 库和小程序库种类繁多甚至说混乱。比如在 Vue 阵营中Vant 和 iView 这两个 UI 库都是同时维护两个版本它们即有 H5 版又有小程序版。不止框架作者麻烦开发者想在多端使用这些 UI 库时会发现在不同端还需要引入不同的 UI 库写法都不一样这让开发者很崩溃。既然已经可以多端开发应用于是 在多端开发的领域里开始出现轮子之上的轮子多端 UI 库 。首先是 Taro 推出了 Taro UI实现了 H5 和小程序 UI 库的统一不过可惜 Taro UI 不支持 App 端。然后 uni-app 推出了 uni UI这个 UI 库同时支持多家小程序、H5、App。由于 uni-app 和 MPVue 同属 Vue 阵营它们的组件是互通的。于是这两家联合举办了一场插件大赛建立了插件市场。在中国的前端开发者领域有很多和国外不一样的地方：一个是国内有小程序第二个是国内 Vue 的开发者体量远超过 React 和 Angular。这里面很大的原因是 Vue.js 的作者尤雨溪是中国人。Vue 和 React 百度指数对比在庞大的 Vue 用户体量支持下uni-app 和 MPVue 的周边生态迅速发展起来开发工具、周边轮子、教育培训等生态快速完善。目前在 Vue 阵营下开发者在 Web 生态下所需的轮子在多端开发下基本也都有了。短短两年时间小程序开发生态里几拨迭代轮子之上的轮子不断涌现快速进入了成熟期。结语产业还在继续发展每当底层有重大技术变更时上层框架世界就会发生新机会。当年 HTML5 标准不统一浏览器兼容性问题严重诞生了 jQurey 的机会。而在移动互联网下半场浏览器兼容已经不再是核心问题jQurey 的地位被更适合移动互联网的 Vue 替代。我们不知道未来还会有什么新的框架出世但我们知道方向：对于开发者而言总是会向着更高的开发效率、更高的性能、更高的投入产出比前进。对于开发商目前的小程序虽然发展了 2 年但流量增长空间仍然巨大微信之外很多超级 App 的势能将逐渐释放整个小程序产业的日活总量有数亿的提升空间。如果开发商能追上这拨红利就能获得更多增长。而多端框架的出现可以帮助开发商更好的把握这拨红利。中国的技术发展此刻正在经历一个分水岭从全面的技术进口到开始建设自己的标准和开发者生态。迟早会开始向外输出引领世界的进步。不管中美是否开打贸易战这一转变都是必须做的事情。中国的移动支付、小程序、5G很多领域已经走在了全球前面。中国人发明的 Vue 已经在影响全球。虽然还有很多困难仍需克服但我们每个开发者都是新时代的见证者更是新生态的建设者！作者简介：王安DCloud 公司创始人HTML5 中国产业联盟秘书长。2003 年开始从事移动互联网工作十几年编程和商业经验连续创业者。声明：作者独立观点不代表 CSDN 立场。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    mpvue框架使用记录               腾讯在线教育小程序开发实践之路                                                        原作者:  王安                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序 input 使用setData触发bindinput事件 ", "author": "                  Rolan                  2019-12-17 00:33                ", "text": "                                                                                                                                                                                     背景UI设计如下图当有输入内容后显示后面的清除按钮点击清除删除input里的内容代码实现我的代码实现是监听bindinput事件将输入框中的值this.setData({inputValue}), 清除按钮监听点击事件触发后this.setData({inputValue: ''})问题android手机上存在一个问题当input组件是focus状态时点击清除按钮输入框会闪一下键盘保持弹出状态输入框中的内容并没有删除再次点击后才能删除 开发者工具和ios均没有上述问题解决我发现出现上面的问题是因为在点击清除按钮时额外的触发了一次bindinput事件将输入框中的值又重新赋值给inputValue了我一开始以为额外触发bindinput事件是因为input失焦导致的但是后面又发现我点击空白的地方并不会触发bindinput事件后来我发现是setData导致的找到了原因就可以对症下药了查看开发文档发现bindinput的返回值中有一个keyCode属性这个属性只有在键盘输入的时候才会有用于记录输入的键值所以我在bindinput中加了一层判断如果有keyCode这个属性才会进行后面的运算。缺陷在开发者工具中使用键盘输入bindinput的返回值中并没有keyCode这个属性所以在调试时就会存在输入的值并不会赋值给inputValue,需要注释对keyCode的判断。疑问上面的问题只会在input组件是focus状态时才会出现如果一开始不是focus时直接点击清除按钮并不会出现上述问题所以这个bug可能还和同时监听bindinput和bindblur或者bindfocus有关这个有待后面进行验证。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序跨页面数据传递与事件响应               纯CSS实现圆环型进度条                                                        原作者: 九当家丶                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "用云开发制作教务助手小程序丨实战 ", "author": "                  Rolan                  2019-12-4 00:02                ", "text": "                                                                                                                                                                                     本项目由一人承担从后端到前端的构思以及开发下面我就讲讲从教务助手小程序的构思到开发实现（基于云开发）。1、灵感来源教务小程序的灵感来源：用完即走查个成绩和课表无需下载app或去翻看公众号内的历史内容。加上本人很久以前就想实现开发一个类似的app但app的开发对于开发小白不太友好不知从何下手！幸好 小程序·云开发 的出现解决了我的需求它的低入门门槛和免后端运维等优势让非科班出身的我也能快速动手开发一款应用类小程序。2、构思教务小程序需要核心就是： 成绩查询、课表查询、教务通知查询 ！ 那么问题来了学校教务处只有网页版教务小程序数据从何而来呢？ 经过一系列思考百度各种问题思路就来了：后端模拟登陆——拿到页面数据——整理数据——反馈到小程序前端渲染大概结构如下：▌项目开发1、后端后端的实现 完全基于云开发 。 部分目录：采用云开发后端node.js语言主要利用模块有：Router模块：const cloud = require('tcb-admin-node');//   npm  install tcb-routerconst TcbRouter = require('tcb-router');cloud.init({  env: '//'})const db = cloud.database();const _ = db.command;// 云函数入口函数exports.main = async (event, context) => {  const app = new TcbRouter({ event });  /** 教务处登陆 eg*/  app.router('login', async (ctx, next) => {    const test = require('login/login.js');    ctx.body = test.main(event, context);  });  /**查取成绩*/  app.router('getpoint', async (ctx, next) => {    const logList = require('getpoint/index.js');    ctx.body = logList.main(event, context);  });  /**学术活动*/  app.router('academic', async (ctx, next) => {    const userList = require('schoolnews/academic.js');    ctx.body = userList.main(event, context);  });  app.router('xsxx', async (ctx, next) => {    const userList = require('schoolnews/xsxx.js');    ctx.body = userList.main(event, context);  });  return app.serve();}复制代码Cherrio实现课表成绩等网页解析：const cloud = require('tcb-admin-node')const rp = require('request-promise');var cheerio = require(\"cheerio\");cloud.init()module.exports = {  main: async (event, context) => {    var url ='URL'    var res = await rp({method: 'get',uri: url,json: false}).then((body) => {      var academic = [];      var $ = cheerio.load(body);      $('.fl').find('dl').each(function (i, elem) {        //业务代码未写        /**          **/        academic.push({date: date,time:time,title:title,speaker:speaker,place:place,link:link})      });      return academic    }).catch(err => {      return err;    })    return res  }}复制代码数据库access_token定时修改// 云函数入口文件const cloud = require('wx-server-sdk'),rp = require('request-promise'),key=require('key.js')cloud.init({  env: \"//\"})//指定数据库环境const db = cloud.database({  env: \"//\"}), _ = db.command;// 云函数入口函数exports.main = async (event, context) => {  try {     var res = await rp(      {        method: 'get',        uri: 'https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=' + key.APPID + '&secret=' + key.APPSECRET,        qs: {},//参数        headers: {},//请求头        json: true  //是否json数据      }    ).then((body) => {      return body    }).catch(err => {      return {errmsg:\"rp函数获取失败\"}    })/*将获取的access_token存到数据库*/    console.log(res)    if (res.hasOwnProperty('access_token')) {      await db.collection('key').where({        type: \"accesstoken\"      }).update({        data: {          accesstoken: res.access_token,          datearray: _.unshift(new Date(new Date().getTime())),          num: _.inc(1)        }      })    } else {      console.log(\"err错误\" + res)    }  } catch (err) {    console.log(err)  }   }复制代码此外还借助了其他模块实现登陆、数据处理（课表等数据格式化）、云开发数据库操作（用户信息储存消息发布）、用户权限鉴定（确保后台信息安全）等在此就不赘述。2、前端小白就是“简单粗暴”的进行各种if、var操作；部分详细介绍如下：① 课程表：实现了一键导入（其实课程表这一功能可以单独形成一个通用的小程序上线）每天一卡片形式在首页提醒：今天有什么课上完没有？②主题全局替换：支持自定义主题色给用户自定义能力。③校历：利用了插件【极点日历】再加以美化。▌感悟一个从小白到从后端到前端到UI全部自己写的入门者参赛的心路历程就这么多了目前源码暂不开放对本小程序有疑问与建议均可在留言同时希望大家能够利用好小程序实现自己的想法和创意！源码地址github.com/TencentClou…如果你想要了解更多关于云开发CloudBase相关的技术故事/技术实战经验请扫码关注【腾讯云云开发】公众号～                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序把base64的图片保存到手机相册               小程序同构方案 kbone 分析与适配                                                        原作者:  腾讯云云开发                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序技能进阶回忆录 - 自主实现数据侦听器和计算器 ", "author": "                  Rolan                  2019-10-22 00:32                ", "text": "                                                                                                                                                                                     熟悉 Vue 的同学对 computed 和 watch 一定很熟悉这些特性大大方便了我们对代码中的数据进行处理：var vm = new Vue({  el: '#example',  data: {    message: 'Hello'  },  computed: {    // 计算属性的 getter    reversedMessage: function () {      // `this` 指向 vm 实例      return this.message.split('').reverse().join('')    }  }})复制代码var vm = new Vue({  el: '#demo',  data: {    firstName: 'Foo',    lastName: 'Bar',    fullName: 'Foo Bar'  },  watch: {    firstName: function (val) {      this.fullName = val + ' ' + this.lastName    },    lastName: function (val) {      this.fullName = this.firstName + ' ' + val    }  }})复制代码这是 Vue 官网中两段代码。官方实现如今小程序也有了自己的实现详见官方文档 observer 。小程序官方 github中也开源了通过 Behaviors 实现的 Vue 风格的computed和watch：github.com/wechat-mini…。那么在微信没有提供这些方法之前如何自主实现数据的侦听器和计算属性呢？自主实现先看看定义的使用文档：Page({ data: {   list: [],   list2: [],   size: 0 }, // 侦听器函数名必须跟需要被侦听的 data 对象中的属性同名 // 其参数中的 newValue 为属性改变后的新值oldValue 为改变前的旧值 watch: {   // 如果 `list` 发生改变这个函数就会运行   list(newValue, oldValue) {     console.log(oldValue + '=>' + newValue)   } }, // 传入的参数list必须是 data 里面的属性 // 这里可以传入多个 data 属性 computed({   list,   list2 }) {   return {     size: list.length,     size2: list2.length   } }})复制代码在 Page 的传参中多了两个熟悉的属性用法不用解释太多。需要继续对小程序提供的 Page 方法进行改造此外因为所有数据变化都会用到 setData 方法去触发所以还需要改造这个方法。改造 Page 和 setData想要基于原有的 setData 进行封装那就得先得到这个函数缓存下来（像是缓存原有的 Page 一样）。想到 onLoad 是小程序页面的第一个生命周期函数可以在这里进行操作：// 缓存原有的 `Page`let originPage = Page// 定义新的 Pagefunction MyPage(config) {  let that = this  this.watch = config.watch  this.computed = config.computed  this.lifetimeBackup = {    onLoad: config.onLoad  }  config.onLoad = function(options) {    // 缓存下原有的 `setData`    this._setData = this.setData.bind(this)    this.setData = (data) => {      // 侦听器      that.watching(data)      // 计算器      let newData = that.getComputedData(data)      this._setData(extend(data, newData))    }    // 备份下页面实例    that.context = this    // 执行真正的 `onLoad`    this.lifetimeBackup.onLoad.call(this, options)  }    // ...  originPage(config)}MyPage.prototype.watching = funtion(data) {  // 执行侦听器  // ...}// 计算器MyPage.prototype.getComputedData = function(data) {  // 开始生成新的数据  // ...}function page (config) {  return new MyPage(config)}复制代码大致代码如上重新定义了 this.setData备份了原有的 setData 到 this._setData。当然这里只考虑了 setData 传一个参数的情况多个参数需要再对代码优化下。注意：调用 watching 和 createNewData 的对象是 that因为 this 指向小程序页面实例没有自定的这个方法。做完上述改造后续的 watch 和 computed 就简单多了。侦听器 watchMyPage.prototype.watching = function(data) {  var context = this.context  var oldData = context.data  // 开始生成新的数据  var watch = this.watch  if (watch) {    Object.keys(watch).forEach(function (k) {      // 如果新的 data 中属性被侦听执行侦听函数      if (k in data) {        var newValue = data[k]        var oldValue = oldData[k]        watch[k].apply(context, [          newValue,          oldValue        ])      }    })  }}复制代码简易的侦听器就写好了通过 setData 触发自定的 watch 中的侦听函数。计算器 computedMyPage.prototype.getComputedData = function(data) {  var context = this.context  var computed = this.computed  var computedData  if (computed) {    computedData = computed.call(context, data)  }  return computedData}复制代码这样就得到了计算后的新生成的数据：computedData。总结不断的通过备份、代理微信原有的方法自主实现了简单的侦听器和计算器。当然这些代码只是为了方便分享提取出来了提供思路实际业务中遇到情况复杂的多代码量远远也不止这些。传送门小程序技能进阶回忆录 - 也许你并不需要小程序框架小程序技能进阶回忆录 - 在缺少组件化的日子里小程序技能进阶回忆录 - 如何自主实现数据侦听器和计算器小程序技能进阶回忆录 - 如何自主实现拦截器（待发布）小程序技能进阶回忆录 - globalData 的那些事儿（待发布）小程序技能进阶回忆录 - 什么时候执行 onLoad（待发布）小程序技能进阶回忆录 - 增强型的 wx.navigateBack（待发布）广告时间美团单车事业部（摩拜单车）诚招前端 / 小程序研发工程师位置北京有兴趣可以发简历到 zhangshibing@mobike.com ）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    使用uni-app开发小程序比直接原生开发小程序好在哪里？               微信小程序登录、支付（小程序、微信H5、非微信H5）即请求加密方法 ...                                                        原作者: 摩拜单车前端团队                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "xquery小程序简易步进器 ", "author": "                  Rolan                  2019-12-30 00:29                ", "text": "                                                                                                                                                                                      这样一个简单的组件翻了ant.design才知道这种组件叫做步进器(steper)步进器常用于购物车等需要增减数量的场景最近的旅游项目中用于增减房间数和人数从产品的角度来理解步进器很简单但在开发角度来说需要适应多种场景及控制一些状态边界值(最大值最小值)初始值步进值(一次增减数量)需要可控边界状态即超出后显示为什么状态可供外部设置边界状态的api方法内部加减方法可供外部调用的加减方法(一些场景中外部有一个总量约束比如sku场景)加减回调方法比如当数量超出时提示用户相关信息多实例模式实例之间即隔离又能交互大致需求如上demo及实现部分如下GITHUB源码小程序代码片段wxml<view class=\"container\">  <ui-item item=\"{{steperConfig}}\" /></view>复制代码Page因为是直接使用Item组件实现所以组件写在Page页面中当然独立成组件看需求了const Pager = require('../components/aotoo/core/index')let lib = Pager.libfunction mkSteper(id=lib.suid('step_'), min, max, step=1) {  return {    $$id: id,    itemClass: 'steper-class',    title: [      {title: '-', aim: 'reduce', itemClass: 'steper-reduce'},      {title: '0', aim: 'custom', itemClass: 'steper-counter'},      {title: '+', aim: 'plus', itemClass: 'steper-plus'},    ],    methods: {      __ready(){        this.count = 0        this.min = min||0        this.max = max||10        this.step = step||1        this.stat = {          reduce: true,          plus: true,          count: true        }      },      reduce(e, param, inst){        let step = this.step        if (!inst) {          inst = this.children[0]        }        if (e === false) {          this.stat.reduce = false          inst.addClass('disable')        }        if (e === true) {          this.stat.reduce = true          inst.removeClass('disable')        }        if (typeof e === 'number') {          step = e        }        this.count -= step        if (this.count <= this.min) {          this.count = this.min          this.stat.reduce = false          inst.addClass('disable')        }        if (this.count < this.max && !this.stat.plus) {          this.stat.plus = true          let $plus = inst.siblings('steper-plus')          $plus.removeClass('disable')        }        this.changeNum(inst)        this.hooks.emit('reduce', {count: this.count}, this)      },      plus(e, param, inst){        let step = this.step        if (!inst) {          inst = this.children[2]        }        if (e === false) {          this.stat.plus = false          inst.addClass('disable')        }        if (e === true) {          this.stat.plus = true          inst.removeClass('disable')        }        if (typeof e === 'number') {          step = e        }        this.count += step        if (this.count >= this.max) {          this.count = this.max          this.stat.plus = false          inst.addClass('disable')        }        if (this.count > this.min && !this.stat.reduce) {          this.stat.reduce = true          let $reduce = inst.siblings('steper-reduce')          $reduce.removeClass('disable')        }        this.changeNum(inst)        this.hooks.emit('plus', {count: this.count}, this)      },      changeNum(inst){        let count = this.count        if (typeof inst === 'number') {          count = inst          inst = undefined        }        if (!inst) {          inst = this.children[1]        }        let $counter = inst.siblings('steper-counter')        $counter.update({          title: count        })      }    }  }}Pager({  data: {    steperConfig: mkSteper('steper'),  },  onReady(){    let $steper = this.getElementsById('steper')    $steper.hooks.on('plus', function(param) {      if (this.count === 10) {        Pager.alert('不能再多了仓库没货了')      }    })    $steper.hooks.on('reduce', function(param) {      if (param.count <= 0) {        Pager.alert('大哥买点啊')      }    })  }})复制代码                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序的getElementsById就像一把梭               红包小程序小结                                                        原作者:  天天修改                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序打怪之在线客服自动回复功能(node版) ", "author": "                  Rolan                  2019-6-13 00:14                ", "text": "                                                                                                                                                                                     我们知道H5页面经常需要将用户导流到APP通过下载安装包或者跳转至应用宝市场/Appstore等方式进行导流。但是由于小程序嵌套webview时需要校验域名因此跳转到第三方应用市场和Appstroe无法实现导流。那怎么办呢? 只能说道高一尺魔高一丈看看微博小程序是怎么导流的:曲线救国的方式利用小程序的在线功能可以打开H5的方式去进行下载引导。 于是就引出了这次文档的主题小程序在线客服自动回复功能。:laughing:阅读本文档之前最好已经了解过小程序客服信息官方的相关文档:1. 客服消息使用指南2. 小程序客服消息服务端接口3. 客服消息开发文档这次开发做在线客服功能也踩了不少坑网上也查阅不少资料但大部分的后台都是基于php或者python,java开发node.js开发的较少因此将这次开发的流程记录一下供大家参考避免大家踩坑。可能会有一些错误地方欢迎指正交流。 另外我们用的node框架是基于koa自行封装的在一些细节实现上和其他框架会有区别不必纠结。需求描述小程序中点按钮跳转在线客服界面根据关键词自动回复 客服回复判断条件支持cms配置key及 respond respond 支持配置以下类型及回复内容:type内容texttext=文本回复内容linktitle=标题 description=描述 url=跳转链接 thumb_url=图片地址imageimageurl=图片地址配置后用户需要精准匹配回复条件才可收到自动回复可支持配置多个key及对应respond除了配置的key以外的回复可配置默认的自动回复开发流程写个跳转客服的按钮吧index.wxml<button open-type=\"contact\">转在线客服</button>复制代码后台配置登录小程序后台后在「开发」-「开发设置」-「消息推送」中管理员扫码启用消息服务填写服务器地址（URL）、令牌（Token） 和 消息加密密钥（EncodingAESKey）等信息。URL服务器地址URL: 开发者用来接收微信消息和事件的接口 URL。开发者所填写的URL 必须以 http:// 或 https:// 开头分别支持 80 端口和 443 端口。务必要记住服务器地址必须是 线上 地址因为需要微信服务器去访问。localhostIP内网地址都不行的。不然会提示 '解析失败请检查信息是否填写正确'。那么问题来了不同的公司都有一套上线流程总不能为了调试URL是否可用要上到线上去测试成本太大也不方便。这就要引出 内网穿透 了简单来说就是配置一个线上域名但是这个域名可以穿透到你配置的本地开发地址上这样可以方便你去调试看日志。 推荐一个可以实现内网穿透的工具。(非广告 :laughing:)NATAPP 具体不详细介绍免得广告嫌疑。简单说NATAPP有免费和付费两种模式免费的是域名不定时更换对于微信的推送消息配置一个月只有3次更改机会来说有点奢侈。不定什么时候配置的域名就不能访问得重新配置。而付费的则是固定域名映射的内网地址也可以随时更改。楼主从免费切到付费模式一个月的VIP使用大概十几块钱吧。2.TokenToken自己随便写就行了但是要记住它因为你在接口中要用的。3.EncodingAESKey随机生成即可。4.加密方式和数据格式根据自己喜欢选择楼主选择的安全模式和JSON格式。 不同的模式和数据格式在开发上会有不同自己衡量。 既然这些配置都清楚那开始码代码。验证消息的确来自微信服务器配置提交前需要把验证消息来自微信服务器的接口写好。server.js/*     * https://developers.weixin.qq.com/miniprogram/dev/framework/server-ability/message-push.html     * 验证消息的确来自微信服务器     * 开发者通过检验 signature 对请求进行校验（下面有校验方式）。     * 若确认此次 GET 请求来自微信服务器请原样返回 echostr 参数内容     * 则接入生效成为开发者成功否则接入失败。加密/校验流程如下：     * 将token、timestamp、nonce三个参数进行字典序排序     * 将三个参数字符串拼接成一个字符串进行sha1加密     * 开发者获得加密后的字符串可与signature对比标识该请求来源于微信     */     const crypto = require('crypto');     async wxCallbackAction(){        const ctx = this.ctx;        const method = ctx.method;     \t//微信服务器签名验证确认请求来自微信     \tif(method === 'GET') {     \t\t// 1.获取微信服务器Get请求的参数 signature、timestamp、nonce、echostr     \t\tconst {     \t\t\tsignature,     \t\t\ttimestamp,     \t\t\tnonce,     \t\t\techostr     \t\t} = ctx.query;     \t\t     \t\t// 2.将token、timestamp、nonce三个参数进行字典序排序     \t\tlet array = ['yourToken', timestamp, nonce];     \t\tarray.sort();     \t\t     \t\t// 3.将三个参数字符串拼接成一个字符串进行sha1加密     \t\tconst tempStr = array.join('');     \t\tconst hashCode = crypto.createHash('sha1'); //创建加密类型     \t\tconst resultCode = hashCode.update(tempStr, 'utf8').digest('hex');     \t\t     \t\t// 4.开发者获得加密后的字符串可与signature对比标识该请求来源于微信     \t\tif (resultCode === signature) {     \t\t\tconsole.log('验证成功消息是从微信服务器转发过来');     \t\t\treturn this.json(echostr);     \t\t}else {     \t\t\tconsole.log('验证失败！！！');     \t\t\treturn this.json({     \t\t\t\tstatus: -1,     \t\t\t\tmessage: \"验证失败\"     \t\t\t});     \t\t}                 \t}     }复制代码验证接口开发完毕后台配置可以去点提交了。配置成功会提示如下:接收消息和推送消息当用户在客服会话发送消息、或由某些特定的用户操作引发事件推送时微信服务器会将消息或事件的数据包发送到开发者填写的 URL。开发者收到请求后可以使用发送客服消息接口进行异步回复。本文以接收文本消息为例开发:server.jsconst WXDecryptContact = require('./WXDecryptContact');    async wxCallbackAction(){        const ctx = this.ctx;        const method = ctx.method;        //接收信息时为POST请求；(完整代码自行与上面验证时的合并即可)        if(method === 'POST'){            const { Encrypt } = ctx.request.body;            //配置时选的安全模式 因此需要解密            if(!Encrypt){                return this.json('success');            }            const decryptData = WXDecryptContact(Encrypt);            await this._handleWxMsg(decryptData);            return this.json('success'); \t\t} \t} \t \t//处理微信回调消息的总入口 (只处理了文本类型其他类型自行添加)    async _handleWxMsg(msgJson){        if(!msgJson){            return ;        }        const { MsgType } = msgJson;        if(MsgType === 'text'){            await this._sendTextMessage(msgJson);        }            }    //微信文本信息关键字自动回复    async _sendTextMessage(msgJson){ \t    //获取CMS客服关键词回复配置 \t    const result = await this.callService('cms.getDataByName', 'wxApplet.contact'); \t\t \t\tlet keyWordObj = result.data || {}; \t \t\t//默认回复default \t\tlet options = keyWordObj.default; \t\tfor(let key in keyWordObj){ \t\t\t//查看是否命中配置的关键词 \t\t\tif(msgJson.Content === key){ \t\t\t    //CMS配置项 \t\t\t\toptions = keyWordObj[key]; \t\t\t} \t\t} \t} \t\t \t//获取access_token \tconst accessToken = await this._getAccessToken(); \t \t/* \t* 先判断配置回复的消息类型是不是image类型 \t* 如果是 则需要先通过 新增素材接口 上传图片文件获得 media_id \t*/ \t \tlet media_id = ''; \tif(options.type === 'image'){ \t\t//获取图片地址(相对路径) \t\tlet url = options.url; \t\tconst file = fs.createReadStream(url); \t\t \t\t//调用微信 uploadTempMedia接口 具体实现见 service.js \t\tconst mediaResult = await this.callService('wxApplet.uploadTempMedia', \t\t\t{ \t\t\t\taccess_token: accessToken, \t\t\t\ttype: 'image' \t\t\t}, \t\t\t{ \t\t\t\tmedia: file \t\t\t} \t\t); \t\t \t\tif(mediaResult.status === 0){ \t\t\tmedia_id = mediaResult.data.media_id; \t\t}else { \t\t\t//如果图片id获取失败 则按默认处理 \t\t\toptions = keyWordObj.default; \t\t} \t} \t \t//回复信息给用户 \tconst sendMsgResult = await this.callService('wxApplet.sendMessageToCustomer', \t\t{ \t\t\taccess_token: accessToken, \t\t\ttouser: msgJson.FromUserName, \t\t\tmsgtype: options.type || 'text', \t\t\ttext: { \t\t\t\tcontent: options.description || '', \t\t\t}, \t\t\tlink: options.type === \"link\" ?  \t\t\t\t{ \t\t\t\t\ttitle: options.title, \t\t\t\t\tdescription: options.description, \t\t\t\t\turl: options.url, \t\t\t\t\tthumb_url: options.thumb_url \t\t\t\t} \t\t\t\t: \t\t\t\t{}, \t\t\timage: { \t\t\t\tmedia_id \t\t\t} \t\t} \t); \t }复制代码service.jsconst request = require('request');/** 获取CMS客服关键词回复配置* 这个接口只是为了回去CMS配置的字段回复关键字配置 返回的data数据结构如下*/async contact(){\treturn {\t\tdata: {\t\t\t\"1\": {\t\t\t    \"type\": \"link\",\t\t\t    \"title\": \"点击下载[****]APP\",\t\t\t    \"description\": \"注册领取领***元注册红包礼\",\t\t\t    \"url\": \"https://m.renrendai.com/mo/***.html\",\t\t\t    \"thumb_url\": \"https://m.we.com/***/test.png\"\t\t\t  },\t\t\t  \"2\": {\t\t\t    \"url\": \"http://m.renrendai.com/cms/****/test.jpg\",\t\t\t    \"type\": \"image\"\t\t\t  },\t\t\t  \"3\": {\t\t\t    \"url\": \"/cms/***/test02.png\",\t\t\t    \"type\": \"image\"\t\t\t  },\t\t\t  \"default\": {\t\t\t    \"type\": \"text\",\t\t\t    \"description\": \"再见\"\t\t\t  }\t\t}\t}}/* * 把媒体文件上传到微信服务器。目前仅支持图片。用于发送客服消息或被动回复用户消息。 * https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/customer-message/customerServiceMessage.uploadTempMedia.html */  async uploadTempMedia(data,formData){ \tconst url = `https://api.weixin.qq.com/cgi-bin/media/upload?access_token=${data.access_token}&type=${data.type}`; \treturn new Promise((resolve, reject) => { \t\trequest.post({url, formData: formData}, (err, response, body) => { \t\t\ttry{ \t\t\t\tconst out = JSON.parse(body); \t\t\t\tlet result = { \t\t\t\t\tdata: out, \t\t\t\t\tstatus: 0, \t\t\t\t\tmessage: \"ok\" \t\t\t\t} \t\t\t\t \t\t\t\treturn resolve(result); \t\t\t \t\t\t}catch(err){ \t\t\t\treturn reject({ \t\t\t\t\tstatus: -1, \t\t\t\t\tmessage: err.message \t\t\t\t}); \t\t\t} \t\t}); \t} }  /* * 发送客服消息给用户 * https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/customer-message/customerServiceMessage.send.html */  async sendMessageToCustomer(data){ \tconst url = `https://api.weixin.qq.com/cgi-bin/message/custom/send?access_token=${data.access_token}`; \treturn new Promise((resolve, reject) => { \t\trequest.post({url, data}, (err, response, body) => { \t\t\t... \t\t}); \t} } 复制代码WXDecryptContact.js消息加密解密文档const crypto = require('crypto'); // 加密模块const decodePKCS7 = function (buff) {    let pad = buff[buff.length - 1];    if (pad < 1 || pad > 32) {        pad = 0;    }    return buff.slice(0, buff.length - pad);};// 微信转发客服消息解密const decryptContact = (key, iv, crypted) => {    const aesCipher = crypto.createDecipheriv('aes-256-cbc', key, iv);    aesCipher.setAutoPadding(false);    let decipheredBuff = Buffer.concat([aesCipher.update(crypted, 'base64'), aesCipher.final()]);    decipheredBuff = decodePKCS7(decipheredBuff);    const lenNetOrderCorpid = decipheredBuff.slice(16);    const msgLen = lenNetOrderCorpid.slice(0, 4).readUInt32BE(0);    const result = lenNetOrderCorpid.slice(4, msgLen + 4).toString();    return result;};// 解密微信返回给配置的消息服务器的信息const decryptWXContact = (wechatData) => {    if(!wechatData){        wechatData = '';    }    //EncodingAESKey 为后台配置时随机生成的    const key = Buffer.from(EncodingAESKey + '=', 'base64');    const iv = key.slice(0, 16);    const result = decryptContact(key, iv, wechatData);    const decryptedResult = JSON.parse(result);    console.log(decryptedResult);    return decryptedResult;};module.exports = decryptWXContact;复制代码呼~ 代码终于码完来看看效果:总结开发并不是一帆风顺的也遇到了一些值得留意的坑强调一下:后台配置URL地址一定外网可访问(可以通过内网穿透解决)文件上传接口 uploadTempMedia media 参数要用 FormData数据格式 (用node的 request 库很容易实现。 urllib 这个库有坑有坑 都是泪T_T)切记接收消息不论成功失败都要返回 success 不然即使成功接收返回消息日志没有报错的情况下还是出现IOS提示该小程序提供的服务出现故障 请稍后再试。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序前端实现自定义分享               小程序登录数据解密                                                        原作者:  人人贷大前端技术中心                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信严控学习类产品“打卡” ", "author": "                  Rolan                  2019-5-14 00:00                ", "text": "                                                                                                                                                                                     题图来源：视觉中国钛媒体快讯 | 5月13日消息：今天微信安全中心公众号发布《关于利诱分享朋友圈打卡的处理公告》整顿朋友圈诱导分享行为认为其是非正常营销严重影响朋友圈阅读体验。这些分享行为主要集中在某些公众号、APP软件等主体他们通过以返学费、送实物等方式利诱微信用户分享其链接（包括二维码图片等）到朋友圈打卡。微信方面表示一经发现微信团队将进行如下处理：包括但不限于停止链接内容在朋友圈继续传播、停止对相关域名或IP地址进行访问封禁相关开放平台帐号或应用的分享接口；对重复多次违规及对抗行为的违规主体将采取阶梯式处理机制包括但不限于下调每日分享限额、限制使用微信登录功能接口、永久封禁帐号、域名、IP地址或分享接口；对涉嫌使用微信外挂并通过微信群实施诱导用户分享的个人帐号将根据违规严重程度对该微信帐号进行阶梯式处罚。值得注意的是钛媒体发现在部分违规公式案例公式中微信选择了四款产品均属于教育类产品分别是流利阅读（流利说旗下产品）、火箭单词、轻课和薄荷阅读。微信官方这则公告一发布立马引起教育圈内的躁动和讨论。一位从事在线教育的高管告诉钛媒体其所加入大部分微信群都在转发这则公告并且表示会对当前大部分在线教育公司的营销模式造成影响。对于被微信方面公开点名批评钛媒体向流利说方面求证。对方表示已经知悉公告并且尊重并理解微信方面的治理。与此同时流利说也对“流利阅读”打卡返款条件作出一定的修改。但是流利说也不认可“打卡”是一种利诱分享的行为。该公司表示“流利阅读”从未以任何形式要求用户通过朋友圈帮助获客。“发朋友圈”只是流利阅读作为教育产品希望用户坚持使用“打卡”动作的重要一环并非“利诱”而是希望用户可以在大家的监督下养成坚持学习的习惯。实际上利用微信流量池鼓励学员朋友圈打卡一直是在线教育类产品的营销利器。比如说流利说就推出了“199元100天打卡80天返费”的项目。这不仅可以从微信上获得更多流量还是提升用户活跃度一大法宝。而对于部分用户而言通过朋友圈打开“打卡”尤其是学习类产品的打卡在从平台获取薄利、监督学习进度的同时还可以营造出一种积极向上的社交形象。但是显然日活已过10亿的微信已经不希望再被各方薅走流量的“羊毛”。微信早已出台《微信外部链接内容管理规范》禁止通过利益诱惑诱导用户分享、传播外链内容或者微信公众帐号文章这一次微信针对教育行业加大关注明确处罚力度。可以预见的是这无疑对于依靠线上渠道裂变招生的教培公司是一记重拳。或许微信朋友圈“整顿”可能只是个开始今后他们不得不调整营销策略以应对各大平台的“流量管控”。（本文首发钛媒体作者/李程程）以下是流利说回应原文：尊敬的媒体老师亲爱的产品用户：感谢各位对于流利说旗下产品“流利阅读”的关心。针对5月13日微信官方账号“微信安全中心”发出的《关于利诱分享朋友圈打卡的处理公告》我们做如下说明：1、微信官方的公告已收悉内部调整已经启动。我们尊重并理解微信官方在平台治理上做出的努力；2、“流利阅读”从未以任何形式要求用户通过朋友圈帮助获客。“发朋友圈”只是流利阅读作为教育产品希望用户坚持使用“打卡”动作的重要一环并非“利诱”而是希望用户可以在大家的监督下养成坚持学习的习惯；3、“流利阅读”一直以来希望为用户提供优质的学习内容因此我们的分享内容也不以销售为目的；4、有鉴于以上三点为了体现我们对于“用户第一”的坚持我们决定从即日起对于“流利阅读”打卡返费条款做如下调整：A、即日起仍在参与原“199元100天打卡80天返费”课程的用户无需朋友圈打卡只需要每天完成当日课程100天内坚持80天即可获得全额奖学金；B、用户仍可自愿在朋友圈打卡但不打卡不会对奖学金有任何影响；C、未来购买此课程的用户朋友圈打卡不会对返费产生任何影响；最后对于“流利阅读”的各位用户我们作为服务提供方向因此受到困扰的用户表示抱歉。本次微信平台的处理针对产品运营方。请各位用户放心我们已和微信官方进行过确认已经使用“流利阅读”在微信朋友圈的打卡不会对个人用户造成任何不良影响。流利阅读团队2019年5月13日                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序开发前的准备工作之【深入封装Component】               小程序绑定用户方案 优化                                                        原作者: 李程程                   来自: 钛媒体                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "uniapp登录流程详解uni.login ", "author": "                  Rolan                  2019-11-25 00:16                ", "text": "                                                                                                                                                                                     uni.login(OBJECT)登录H5平台登陆注意事项：微信内嵌浏览器运行H5版时可通过js sdk实现微信登陆需要引入一个单独的js详见普通浏览器上实现微信登陆并非开放API需要向微信申请仅个别开发者有此权限H5平台的其他登陆比如QQ登陆、微博登陆uni-app未封装请在条件编译里按普通H5写法编写。OBJECT 参数说明参数名 类型 必填 说明 平台差异说明provider String 否 登录服务提供商通过 uni.getProvider 获取如果不设置则弹出登录列表选择界面scopes String/Array 见平台差异说明 授权类型默认 auth_base。支持 auth_base（静默授权）/ auth_user（主动授权） / auth_zhima（芝麻信用） 支付宝小程序timeout Number 否 超时时间单位ms 微信小程序、百度小程序success Function 否 接口调用成功的回调fail Function 否 接口调用失败的回调函数complete Function 否 接口调用结束的回调函数（调用成功、失败都会执行）success 返回参数说明参数名 说明authResult 登录服务商提供的登录信息服务商不同返回的结果不完全相同errMsg 描述信息uni.login({  provider: 'weixin',  success: function (loginRes) {    console.log(loginRes.authResult);  }});uni.checkSession检查登录状态是否过期属性 类型 必填 说明success function 否 接口调用成功的回调函数fail function 否 接口调用失败的回调函数complete function 否 接口调用结束的回调函数（调用成功、失败都会执行）uni.getUserInfo(OBJECT)获取用户信息。UNI-APP 开发微信公众号（H5）JSSDK 的使用方式在 uniapp 中可以使用模块方式引用微信 js-sdk 微信官网直接下载的使用有问题可以使用 jweixin-module。安装下载使用方式下载地址： https://unpkg.com/jweixin-mod...使用、var jweixin = require('jweixin-module')  jweixin.ready(function(){      // TODO  });一、小程序:1、使用 button 组件并将 open-type 指定为 getUserInfo 类型获取用户基本信息。详情参考文档:https://developers.weixin.qq....2、使用 open-data 展示用户基本信息。详情参考文档:https://developers.weixin.qq....provider String 否 登录服务提供商通过 uni.getProvider 获取withCredentials Boolean 否 是否带上登录态信息。 微信小程序、头条小程序lang Number 否 指定返回用户信息的语言默认为 en。更多值请参考下面的说明。 微信小程序timeout Number 否 超时时间单位 ms。 微信小程序success Function 否 接口调用成功的回调fail Function 否 接口调用失败的回调函数complete Function 否 接口调用结束的回调函数（调用成功、失败都会执行）userInfo 参数说明参数 类型 说明 平台差异说明nickName String 用户昵称openId String 该服务商唯一用户标识 5+AppavatarUrl String 用户头像uni.login({  provider: 'weixin',  success: function (loginRes) {    console.log(loginRes.authResult);    // 获取用户信息    uni.getUserInfo({      provider: 'weixin',      success: function (infoRes) {        console.log('用户昵称为：' + infoRes.userInfo.nickName);      }    });  }});说明：调用 wx.login() 获取 临时登录凭证code 并回传到开发者服务器。调用 auth.code2Session 接口换取 用户唯一标识 OpenID 和 会话密钥 session_key。之后开发者服务器可以根据用户标识来生成自定义登录态用于后续业务逻辑中前后端交互时识别用户身份。注意：会话密钥 session_key 是对用户数据进行 加密签名 的密钥。为了应用自身的数据安全开发者服务器不应该把会话密钥下发到小程序也不应该对外提供这个密钥。临时登录凭证 code 只能使用一次uni.getProvider(OBJECT)获取服务供应商。仅App平台支持。在App平台可用的服务商是打包环境中配置的服务商与手机端安装了什么app没有关系。云打包在manifest中配置相关模块和SDK信息离线打包在原生工程中配置。某个服务商配置被打包进去运行时就能得到相应的服务供应商。关于目前文章内容即涉及前端PHP知识点如果有兴趣即可关注很荣幸能被您发现真是慧眼识英！也感谢您的关注在未来的日子里希望能够一直默默的支持我我也会努力写出更多优秀的作品。我们一起成长从零基础学编程将 Web前端领域、数据结构与算法、网络原理等通俗易懂的呈现给小伙伴。分享 Web 前端相关的技术文章、工具资源、精选课程、热点资讯。若本号内容有做得不到位的地方（比如：涉及版权或其他问题）请及时联系我们进行整改即可会在第一时间进行处理。请点赞！因为你们的赞同/鼓励是我写作的最大动力！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信-小程序开发基础知识笔记               小程序云开发：菜鸟也能全栈做产品                                                        原作者:  达达前端小酒馆                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "在小程序中自定义弹窗组件 ", "author": "                  Rolan                  2019-11-8 00:08                ", "text": "                                                                                                                                                                                     component{    \"component\": true}复制代码表明它是一个组件我们称之为“子组件” 3. 注意：在组件wxss中不应使用ID选择器、属性选择器和标签名选择器。（只使用class）如何使用组件便于区分引用子组件的页面我们称之为“父组件” 在父组件的json里先引用子组件：{  \"usingComponents\": {    \"component-tag-name\": \"path/to/the/custom/component\"  }}复制代码父组件传值给子组件因为这个自定义的弹窗组件会应用于很多不同的页面所以显示的弹窗标题也是不同的这就是需要父组件给子组件自定义标题也就是子组件的标题应该从父组件中接受到的。 子组件里： wxml<view class=\"page\">  <view>{{popupTitle}}</view></view>复制代码jsComponent({  properties: {    // 这里定义了innerText属性属性值可以在组件使用时指定    popupTitle: { //弹窗标题      type: String,      value: '默认值',     }  },})复制代码父组件里： wxml<popup popup-title=\"{{pagetitle}}\"/>复制代码jsdata: {    pagetitle: '我是页面标题',}复制代码. 在子组件中自定义值是以小驼峰的形式书写的但是在父组件传的时候要以“-”连接。子组件改变父组件的值这个组件的显示和隐藏都是在父组件决定的但是因为我这是一个全屏的弹窗覆盖了整个屏幕所以想要关闭弹框只能想办法在子组件的点击事件上想办法。 基本逻辑是这样的： 操作流程：打开页面- 点击弹框（弹出子组件）- 点击关闭（点击子组件关闭弹窗） 数据流程：打开页面-点击弹框（传入弹窗标题、点赞成功结果、其他参数）-点击关闭（在父组件上自定义组件然后子组件关闭按钮监听onTap事件点击子组件关闭按钮时会通知父组件去改变状态）逻辑：在子组件中给要触发的元素加 bindtap = 'onTap'然后通过在method中设置onTap函数在onTap中的triggerEvent中设置要触发父组件事件的函数名称父组件接收到字组件的消息然后触发事件具体参考：\t小程序-组件通信子组件： wxml<view class=\"hide-btn\" bindtap=\"onTap\">×</view>复制代码jsmethods: { //放自定义的方法    onTap: function () {      var myEventDetail = {} // detail对象提供给事件监听函数      var myEventOption = {} // 触发事件的选项      console.log(`子组件：'向父组件发送通知我要关闭弹窗'`)      this.triggerEvent('hidepopop', myEventDetail, myEventOption)    }  },复制代码父组件 wxml<popup bindhidepopop=\"hidePopop\" is-show-popup=\"{{isShowPopup}}\" popup-title=\"{{popupTitle}}\" popup-content=\"{{popupContent}}\"/>复制代码jshidePopop: function(e) {    console.log(e.detail) // 自定义组件触发事件时提供的detail对象    console.log('父组件：我接受到了子组件的关闭弹窗的通知！');    this.setData({      isShowPopup: true    })  }复制代码参考小程序-自定义组件 代码地址：\tgithub.com/AnsonZnl/wx…                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    当微信小程序遇上filter~               微信小程序使用echarts实现左右双Y轴动态获取数据生成折线图 ...                                                        原作者:  九旬大爷的梦                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序拼接图片链接无底洞探究 ", "author": "                  Rolan                  2019-8-21 00:42                ", "text": "                                                                                                                                                                                     由于小程序包大小限制我们一般都会将icon存放到cdn上。现在的开发流程需要在\t开发测试环境 下图片使用开发域名线上使用生产域名。问题重现在小程序onLaunch的时候读取配置文件获取当前环境并得到开发环境图片域名:./app.jsconst { imgHostDev, imgHostProd, env } = require('./app.config.js')App({  onLaunch: function () {    this.globalData.imageHost = env == 'dev' ? imgHostDev : imgHostProd  },  globalData: {    imageHost: ''  }})复制代码在页面中：./pages/index/index.jsconst app = getApp()Page({  data: {    imgHost: ''  },  onLoad: function () {    this.setData({      imgHost: app.globalData.imageHost    })  }})复制代码./pages/index/index.wxml<image src=\"{{imgHost}}/4jZ1L1qECEOsikW2JKsyHQ==/109951164304393164.jpg\" mode=\"aspectFit\"></image>复制代码图片渲染出来了但是在开发者工具中有报错VM1334:1 Failed to load local image resource /4jZ1L1qECEOsikW2JKsyHQ==/109951164304393164.jpg the server responded with a status of 500 (HTTP/1.1 500 Internal Server Error)手机预览就看不到图片。。。分析看一下报错信息说本地不存在\t/4jZ1L1qECEOsikW2JKsyHQ==/109951164304393164.jpg 这个文件。 也就是说页面在执行onLoad之前就已经渲染了这个时候\timgHost 值为空字符串image的src拿到的图片链接就是\t/4jZ1L1qECEOsikW2JKsyHQ==/109951164304393164.jpg image标签就以为这是本地图片导致的。修复当然修复的方法有很多可以将\timgHost 在初始化的时候就赋值：const app = getApp()Page({  data: {    imgHost: app.globalData.imageHost  },  onLoad: function () {  }})复制代码也可以在标签中做判断<image src=\"{{imgHost ? imgHost + '/4jZ1L1qECEOsikW2JKsyHQ==/109951164304393164.jpg' : ''}}\" mode=\"aspectFit\"></image>复制代码更多尝试之前都是渲染网络图片如果读取本地图片更换不同文件夹中的同名图片呢？发现也是如此。如果图片链接里有多个变量就建议在wxs文件中写一个方法来配置图片                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序使用车牌号输入法               小程序自定义弹层禁止页面滚动方案详解                                                        原作者:  padding0                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "uni-app相关知识总结 ", "author": "                  Rolan                  2019-10-12 00:43                ", "text": "                                                                                                                                                                                     一、默认导航栏uni-app默认会提供一个导航栏即 小程序的导航栏 我们不需要进行任何的配置就会显示 默认导航栏的配置同微信小程序 只不过微信小程序的组件是分为.wxml、.wxss、.js、.json四个文件组成而 uni-app的组件则只有一个.vue文件 (其中包含了html、css、js)其中并未包含.json的相关内容那么.json配置写在哪里呢？.json文件主要是 对页面的 窗口表现及页面相关功能进行配置所以unip在pages.json文件中注册页面的时候给每个page页面提供了一个style属性用于对当前页面的窗口表现( 窗口 样式、 导航栏 样式)及功能( 页面下拉刷新 、 页面能否滚动等)如:{    \"pages\": [ //pages数组中第一项表示应用启动页参考：https://uniapp.dcloud.io/collocation/pages        {            \"path\": \"pages/index/index\",            \"style\": { // 对窗口及其页面表现进行配置                \"navigationBarTitleText\": \"导航标题\", // 设置默认导航栏标题文字内容                \"navigationBarTextStyle\": \"white\", // 设置默认导航栏标题文字颜色及状态栏上文字颜色仅支持black和white                \"navigationBarBackgroundColor\": \"#4CD964\", // 设置默认导航栏背景颜色及状态栏背景颜色仅支持十六进制颜色值                \"navigationStyle\": \"default\", // 支持defaul和custom两种设置custom(自定义)后默认导航栏将消失微信小程序上只保持右上角胶囊按钮                \"backgroundColor\":\"#ADFF2F\", // 设置窗口背景颜色开启下拉刷新之后下拉后可见该背景颜色(黄色)仅小程序端生效                \"enablePullDownRefresh\": true, // 是否开启页面下拉刷新功能                // 上拉刷新不需要开启页面提供了一个触底事件onReachBottom只要页面存在滚动条滚动条触底后就可以触发触底事件从而进行下拉刷新                \"onReachBottomDistance\": 0, // 当滚动条距离底部的距离为指定值的时候则判定为触底                \"disableScroll\": false, // 页面能否滚动如果为true则禁用页面滚动功能及时页面设置的高度超过了屏幕高度也不会发生滚动仅小程序端生效                \"usingComponents\": { // 配置是否使用小程序提供的自定义组件这里的小程序组件不是.vue组件而是小程序提供的原生组件App端也支持                    \"custom\": \"/wxcomponents/custom/index\"                },                // \"backgroundTextStyle\":\"dark\", // 设置下拉 loading 的样式仅支持dark和light,无明显用处            }        }    ]}需要注意的就是usingComponents的配置其配置的是使用 小程序提供的原生组件(如包含.wxml、.wxss、.js、.json的组件) 而不是.vue组件。同时 状态栏上文字颜色仅支持black和white即非黑即白状态栏背景色同导航栏背景颜色二、原生导航栏uni-app运行在app端的时候还提供了原生导航栏其在注册页面的时候style还提供了一个 app-plus 属性用于 配置app端 页面窗口、导航栏样式的配置导航栏的配置通过titleNView属性如:{    \"pages\": [ //pages数组中第一项表示应用启动页参考：https://uniapp.dcloud.io/collocation/pages        {            \"path\": \"pages/index/index\",            \"style\": { // 对窗口及其页面表现进行配置                \"app-plus\": {                    // \"titleNView\": false // 禁用原生导航栏即当前页面不显示原生导航栏                    \"scrollIndicator\":\"none\", // 设置是否显示页面滚动条设置为none滚动时看不到右侧的滚动条                    \"pullToRefresh\": {                        \"style\":\"default\" // 设置下拉刷新样式只支持default和circle                    },                    \"bounce\":\"none\", // 设置页面回弹效果none关闭回弹效果                    // \"titleNView\": { // 空对象不会对默认导航栏进行替换必须进行相关配置才会对默认导航栏进行修改                                            // },                    \"titleNView\": { // 对原生导航栏进行配置                        \"titleText\": \"原生导航栏标题内容\", // 标题内容与搜索框只能显示一个                        \"buttons\": [ // 在原生导航栏上添加按钮                            {                                // \"type\":\"share\", // 使用 type 值设置按钮的样式时会忽略 fontSrc 和 text 属性。                                \"fontSrc\":\"./static/font/icon.ttf\", // 使用字体图标                                \"text\": \"\\ue609\", // 使用字体图标时 unicode 字符表示必须 '\\u' 开头                                \"fontSize\":\"22px\",                                \"color\":\"#FF9619\",                                 \"colorPressed\":\"#BBBBBB\",                                \"select\": false, // 是否显示右侧向下箭头图标常用于城市选择                                \"float\":\"left\" // 按钮放在导航栏左侧                            },                            {                                // \"type\":\"favorite\", // 使用 type 值设置按钮的样式时会忽略 fontSrc 和 text 属性。                                \"fontSrc\":\"./static/font/icon.ttf\",                                \"text\": \"\\ue653\", // 使用字体图标时 unicode 字符表示必须 '\\u' 开头                                \"fontSize\":\"22px\",                                \"color\":\"#000000\",                                \"colorPressed\":\"#BBBBBB\",                                \"select\": false, // 是否显示右侧向下箭头图标常用于城市选择                                \"float\":\"right\" // 按钮放在导航栏右侧                            }                        ],                        \"searchInput\": { // 是否在原生导航栏上添加搜索框一旦添加搜索框那么导航栏标题内容将无法显示因为搜索框是放在标题的位置对标题进行了替换                            \"align\":\"center\",                            \"backgroundColor\":\"#F7F7F7\",                            \"borderRadius\":\"4px\",                            \"placeholder\":\"搜索\",                            \"disabled\": true                        }                    }                }            }        }    ]}三、自定义导航栏要想自定义导航栏我们必须先让默认导航栏或者原生导航栏隐藏在小程序端可以通过 \"navigationStyle\":\"custom\" 隐藏app端则可以通过 \"titleNView\": false 进行隐藏如:{    \"pages\": [ //pages数组中第一项表示应用启动页参考：https://uniapp.dcloud.io/collocation/pages        {            \"path\" : \"pages/contact/contact\",            \"style\" : {                \"navigationStyle\":\"custom\", // 隐藏小程序端导航栏                \"app-plus\": {                    \"titleNView\": false // 隐藏app端原生导航栏                }            }        }     ]}使用自定义导航栏导航后由于默认导航栏和原生导航栏都消失了所以原先导航栏的位置就被空出来了我们可以 通过自定义一个导航视图组件占据原先导航栏的位置即可实现 但是下拉刷新会有问题因为页面的下拉刷新是从顶部开始的之前 有默认导航和原生导航的时候  页面的顶部就是导航栏底部 但是默认导航和原生导航隐藏后 顶部就变成了原先导航栏的顶部了 所以 页面下拉刷新的位置向上移了 使用自定义导航栏后最好不要在页面中使用下拉刷新功能了。如果非要使用下拉刷新功能的话我们可以通过<scroll-view>组件来模拟下拉刷新。即 监听<scroll-view>组件的@scrolltoupper事件判断是否到达顶部然后监听@scroll事件判断下拉的位置然后动态改变下拉刷新的样式、动画 从而模拟出下拉刷新效果。<view class=\"pull-down iconfont icon-liulan\" :style=\"{transform: 'rotate(' + detal+ 'deg)'}\"></view><scroll-view scroll-y class=\"scroll-box\" @scrolltoupper=\"pullDown\" @scroll=\"scroll\"></scroll-view>export default {    methods: {        pullDown(e) {            // console.log(e);        },        scroll(e) { // 根据下拉的距离改变detal的值从而改变下拉刷新图标的选择角度            this.detal = e.detail.scrollTop + 100;        }    }}四、vue与nvuenvue即 native vue 。uni-app App端内置 weex 渲染引擎提供了原生渲染能力。 uni-app默认是处于uni-app的渲染模式 即小程序渲染模式如果要启用纯原生渲染模式即weex渲染模式那么需要在 manifest.json 源码视图的 \"app-plus\" 下配置 \"renderer\":\"native\" 开启原生渲染模式后 pages.json注册的vue页面将被忽略 启动纯原生渲染可以减少App端的包体积、加快App启动速度。因为webview渲染模式的相关模块将被移除了。// manifest.json    {        // ...         /* App平台特有配置 */        \"app-plus\": {            \"renderer\": \"native\", //App端纯原生渲染模式    }    }在未开启weex原生渲染模式的情况下即uni-app模式下也是可以直接渲染.nvue文件的 不管是vue页面还是nvue页面都需要在pages.json中注册 并且如果一个页面下出现了两个同名的vue和nvue文件那么在 App端  会优先使用nvue页面 同名的vue文件将不会被编译到App端。而在 非App端  会优先使用vue页面 。.nve文件的写法同.vue文件一样只不过.nvue文件中可以还使用一些weex提供的特有组件比如<barcode>、<list>、<cell>、<refresh>等。五、subNvuesubNvue 是 vue 页面的原生子窗体其会 把weex渲染的原生界面当做 vue 页面的子窗体覆盖在页面上 主要解决 运行在App端时  视图无法覆盖在<video>、<map>等组件上 的问题( 非App端可以通过z-index或者cover-view解决 )subNvue的使用方式非常简单只需要 新建一个.nvue文件 建议放在母页面目录中但是 subNvue页面不需要注册到pages.json中 而是 在母页的\"style\"--> \"app-plus\" --> \"subNVues\"进行配置 因为subNvue主要解决App端层级覆盖问题所以需要在\"app-plus\"下配置需要注意的是 subNVues是一个数组 每个元素为一个原生子窗体因为一个母页中可以包含多个原生子窗体每个原生子窗体通过配置中的id进行区分。配置好subNvues后对应的原生子窗体默认就会显示。{    \"pages\": [ //pages数组中第一项表示应用启动页参考：https://uniapp.dcloud.io/collocation/pages        {        \"path\" : \"pages/video/video\", // 母页面路径        \"style\" : {            \"navigationBarTextStyle\":\"white\",            \"app-plus\": {                \"titleNView\":false,                \"subNVues\":[{                              \"id\": \"test\", // 唯一标识母页面中可以通过这个id调用api获取到原生子窗体                              \"path\": \"pages/video/subNVue/cover\", // video母页面下原生子窗体页面路径                              // \"type\": \"popup\",  //这里不需要                            \"style\": {                                  \"position\": \"absolute\",                                  // \"dock\":\"right\",                                \"width\": \"750rpx\",                                  \"height\": \"150upx\", // 需要设置合适的高度否则可能出现无法点击原生子窗体下面的内容                                 \"background\":\"transparent\" // 设置为透明以便能看到原生子窗体下面的内容 如果有背景颜色则全屏可见                            }                   }]            }        }    ]}pages.json文件中配置好原生子窗体后不需要向vue组件一样引入到母页中直接就会出现在母页面上具体位置根据subNVues中的配置而定。六、优化自定义导航栏下拉刷新功能前面说过使用自定义导航栏需要隐藏掉默认导航栏和原生导航栏但是会存在一个问题就是页面下拉刷新会跟着上移到了最顶部导致页面下拉刷新位置不正确之前的方法是使用<scroll-view>方法进行模拟 但是官方并不推荐该方法 我们可以通过原生子窗口实现其实现方法非常简单就是用原生子窗口占据原生导航栏的位置其中关键的一步就是在配置原生子窗体的时候 需要将其type设置为navigationBar类型 该原生子窗体就会站住原生导航栏的位置并且下拉刷新图标不会向上移如:{    \"pages\": [ //pages数组中第一项表示应用启动页参考：https://uniapp.dcloud.io/collocation/pages        {        \"path\" : \"pages/nav/nav\",        \"style\" : {            \"navigationBarTextStyle\":\"white\",            \"navigationBarBackgroundColor\":\"#007AFF\",            \"enablePullDownRefresh\": true,            \"app-plus\": {                \"titleNView\": false,                \"subNVues\": [                    {                        \"id\":\"nav\",                        \"path\":\"pages/nav/subNvue/nav\",                        \"type\":\"navigationBar\" // 设置为navigationBar类型才能让原生子窗体站住原生导航栏的位置                    }                ]            }        }    },    ]}pages/nav/subNvue/nav.nvue<template>    <div class=\"nav\">        <div class=\"status-bar\"></div>        <div class=\"nav-title\">            <div>我是导航栏</div>        </div>    </div></template><script>    export default {            }</script><style scoped>.nav { /*.nvue页面中的所有元素都是flex布局,不需要进行显示设定*/    flex: 1; /*占满整个导航栏高度,当该原生子窗体页面被设置为navigationBar类型后,会自动给予该页面一个导航高度,占满即可*/    background-color: #007AFF;}.status-bar { /*状态栏占位区,下面导航标题栏已经设置了44px高度让状态栏占满剩余高度*/    flex: 1; }.nav-title {    flex: 0;    height: 44px; /*导航栏固定高度为44px*/    background-color: #007AFF;    justify-content: center;    align-items: center;/*导航栏标题区垂直居中显示*/}</style>七、实现抽屉效果所谓抽屉效果就是就是页面上触发某种事件后页面上方有一个页面从屏幕的一侧开始滑出覆盖到原来页面的上方然后点击空白处该页面又可以收回去的效果。要实现这种效果我们也是需要利用原生子窗体将抽屉页面做成一个原生子窗体覆盖在页面上方其中关键的一步就是 需要将其type设置为popup类型  设置为popup类型之后  该页面默认不会出现在母页面上 需要通过调用api才能让该抽屉页面显示出来。如:{    \"pages\": [ //pages数组中第一项表示应用启动页参考：https://uniapp.dcloud.io/collocation/pages        {        \"path\" : \"pages/nav/nav\",        \"style\" : {            \"navigationBarTextStyle\":\"white\",            \"navigationBarBackgroundColor\":\"#007AFF\",            \"enablePullDownRefresh\": true,            \"app-plus\": {                \"titleNView\": false,                \"subNVues\": [                    {                        \"id\":\"drawer\",                        \"path\":\"pages/nav/subNvue/drawer\",                        \"type\":\"popup\",                        \"style\": {                            \"width\":\"50%\" // 只显示整个屏幕宽度的50%,高度默认为屏幕100%                        }                    }                ]            }        }    },    ]}pages/nav/subNvue/nav.nvue 母页通过api控制原生子窗体的显示和隐藏<template>    <view>        母页面        <button @click=\"showDrawer\">显示抽屉</button>    </view></template><script>    export default {        data() {            return {                            }        },        methods: {            showDrawer() {                uni.getSubNVueById('drawer').show(\"slide-in-left\", 200); // 从屏幕左侧向右边滑入耗时200ms            }        }    }</script>同样的方式也可以实现页面中间显示弹出框效果只需要改变原生子窗体的位置即可即将其定位到正中间如:{    \"id\":\"drawer\",    \"path\":\"pages/nav/subNvue/drawer\",    \"type\":\"popup\",    \"style\": {        \"margin\":\"auto\", // 居中显示        \"height\":\"50%\",        \"width\":\"80%\"    }}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    使用 async await 封装微信小程序HTTP请求               教你制作挂件头像 | 小程序七十二变之 canvas 绘制国旗头像                                                        原作者:  JS_Even_JS                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序点赞收藏功能 ", "author": "                  Rolan                  2018-9-12 00:13                ", "text": "                                                                                                                                                                                     一.收藏focusFavoriteTab: function (e) {        var that = this;        var isFocus = that.data.isFocus;        console.log(\"isFocus\", isFocus)        var itemId = that.data.itemId;        if (isFocus) {          favoriteService.cancel(that, itemId).then((res) => {            wx.showToast({              title: \"取消收藏\",              icon: 'success',              duration: 1000            });            that.setData({              isFocus: false,            });          })        } else {          favoriteService.add(that, itemId).then((res) => {            wx.showToast({              title: res.data == 1 ? \"收藏成功\" : \"收藏失败\",              icon: 'success',              duration: 1000            });            that.setData({              isFocus: true,            });          });        }      },二.点赞focuslikeTab: function (e) {    var that = this;    var isLike = that.data.isLike;    let itemDetail = this.data.itemDetail     var itemId = that.data.itemId;    if (isLike) {      itemService.cancellike(that, itemId).then((res) => {        wx.showToast({          title: \"点赞取消\",          icon: 'success',          duration: 1000        });        itemDetail.liked--;        that.setData({          itemDetail:itemDetail,           isLike: false        });       })    } else {      itemService.addlike(that, itemId).then((res) => {        wx.showToast({          title: res.data == 1 ? \"点赞成功\" : \"点赞失败\",          icon: 'success',          duration: 1000        });        itemDetail.liked++;        that.setData({          itemDetail: itemDetail,          isLike: true        });       });    }  },                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                (2)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (4 人)忧伤中＊落泪w小飞32Lawietgrok                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序之图片懒加载 完美方案你不来看看？               微信小程序 短信验证码登录 倒计时 setInterval                                                        原作者: 楷楷                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序倒计时深究 ", "author": "                  Rolan                  2018-12-28 00:08                ", "text": "                                                                                                                                                                                     小程序倒计时重叠抖动问题因为请求数据写在onShow 函数里面所以每次切换界面都会刷新这就会导致如果当前 定时器在跑的话再次刷新会再次常见定时 那么就会导致刷新几次有几个定时器同时在跑那么前端界面显示的计时数字 就会不时跳动所以需要保证在跑的定时器只有一个。将定时器对象创建为全局的在每次开启定时器的时候先清空之前的定时器。就可以解决刷新后计时闪动的问题了或者在在tab页面运用 onHide 周期 进行 clearTimeInterval清空 , 在 非tab页面运用onUload() 周期 进行 clearTimeInterval清空百度都可以找到类似解决方案其中在我的历史文章小程序实战踩坑之B2B商城项目总结也有总结代码类似如下：/**   * 清除interval  * @param that  */ clearTimeInterval: function (that) {    var interval = that.data.interval;    clearInterval(interval)  },  /**   * 生命周期函数--监听页面卸载   * 退出本页面时停止计时器  */ onUnload:function () {      var that = this;      that.clearTimeInterval(that) },  /**   * 生命周期函数--监听页面隐藏   * 在后台运行时停止计时器  */ onHide:function () {      var that = this;      that.clearTimeInterval(that) }倒计时使用setInterval或setTimeout触摸屏幕导致时间显示的突跳突慢问题卡顿甚至停止不信的同学可以尝试用手指触摸屏幕上下小幅上下移动不放你会发觉时间竟然停止了。（特别是针对低端机型）通常同学写代码都会如此：                let self = this;                let lefttimeSec = time - new Date().getTime();                let calc = setInterval(function() {                    lefttimeSec -= 1000;                    self.endtimestr = '距离拼单结束还有' + self.dateformat(lefttimeSec);                    self.$apply();                    if (lefttimeSec <= 0) {                        clearInterval(calc);                    }                }, 1000);使用setInterval后即使用了上面说的“小程序倒计时重叠抖动问题”解决方案只是解决了倒计时重叠问题这样写法会导致的一些精准度不高。其实很简单解决代码如下：                showCountTime(time){                    let self = this;                    setTimeout(function(){                        let lefttimeSec = time - new Date().getTime();                        lefttimeSec -= 1000;                        self.endtimestr = '距离拼单结束还有' + self.dateformat(lefttimeSec);                        self.$apply();                        self.showCountTime(time);                    },1000);                }注意这里用了setTimeout要tab页面运用onHide周期进行clearTimeout清空, 在非tab页面运用onUload()周期 进行clearTimeout清空定时器。这步必须要做就不多说了要不还是会出现上面说的“小程序倒计时重叠抖动问题”问题。用了上面代码补失的精准度不足。小心的测试同学会发现触摸屏幕导致的突跳突慢问题,甚至停止！于是各种寻思去找了拼多多小程序京东购物小程序各种对比。 结论是拼多多存在和我一样的问题京东购物小程序的倒计时没这样的问题给个赞！出现问题环境描述：小程序框架:wepy : \"^1.7.2\"测试机型：红米3自身思路是wepy脏检查在触摸（滚动）屏幕下引起性能占用导致的一些效率不足问题做了进一步测试还是用红米3机型抛掉组件抛掉data只保留data做一个简单的渲染将页面高度固定让屏幕可以上下滑动代码如下：<style>    .content {        height: 2000rpx;        border: 1rpx solid red;    }    .child {        height: 500rpx;    }</style><template>    <view class=\"content\">        <view class=\"child\"></view>        {{endtimestr}}    </view></template><script>    import wepy from 'wepy';    export default class test extends wepy.page {        data = {            endtimestr: ''        }        showCountTime(time) {            let self = this;            setTimeout(function() {                let lefttimeSec = time - new Date().getTime();                lefttimeSec -= 1000;                self.endtimestr = '距离拼单结束还有' + self.dateformat(lefttimeSec);                self.$apply();                self.showCountTime(time);            }, 1000);        }        dateformat = (micro_second) => {            // 总秒数            var second = Math.floor(micro_second / 1000);            // 天数            var day = Math.floor(second / 3600 / 24);            // 小时            var hr = Math.floor(second / 3600 % 24);            // 分钟            var min = Math.floor(second / 60 % 60);            // 秒            var sec = Math.floor(second % 60);            hr = hr < 10 ? '0' + hr : hr;            min = min < 10 ? '0' + min : min;            sec = sec < 10 ? '0' + sec : sec;            if (day > 0) {                return day + \" 天\" + ' ' + hr + \":\" + min + \":\" + sec;            } else {                return hr + \":\" + min + \":\" + sec;            }        }        onLoad() {            //api模拟得到time            this.showCountTime(1545899950167);        }    }</script>结论是： 倒计时在触摸（滚动）情况下正常了！！！那也表明wepy的脏检查存在一些性能的不足呀希望未来wepy有改进！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    如何寻找用户增长点构建小程序用户增长模型？               BAT发力小程序站在十字路口的开发者又当如何抉择？                                                        原作者:  张炳                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序之倒计时插件   wxTimer                                                      • 小程序验证码倒计时                                                      • 小程序条形倒计时动画                                                      • 【重构】微信小程序倒计时组件                                                      • 微信小程序 短信验证码登录 倒计时 setInterval                                                      • 小程序 - 验证码倒计时组件                                                                                               "},{"title": "微信小程序预加载图片以及占位图片 ", "author": "                  Rolan                  2019-8-7 00:11                ", "text": "                                                                                                                                                                                     wxml页面利用三目运算：代码如下： 1 <image src=\"{{ima?ima:'../../images/4.jpg'}}\" /> （../../images/4.jpg）这里意思是预加载图片大概是一张黑白色的类似于js代码如下：Page({/*** 页面的初始数据*/data: {ima: \"\",},/*** 生命周期函数--监听页面加载*/internet:function(){  setTimeout(function(){    this.setData({  /*setData*/是为了模拟服务器传输的数据     ima:'http://pic4.nipic.com/20091217/3885730_124701000519_2.jpg',     })   }.bind(this),2000);},onLoad: function (options) {this.internet（）/*调用*/},// app.YoniClient.request(app.Func.LOGIN,)/*** 生命周期函数--监听页面初次渲染完成*/onReady: function () {},/*** 生命周期函数--监听页面显示*/onShow: function () {},/*** 生命周期函数--监听页面隐藏*/onHide: function () {},/*** 生命周期函数--监听页面卸载*/onUnload: function () {},/*** 页面相关事件处理函数--监听用户下拉动作*/onPullDownRefresh: function () {},/*** 页面上拉触底事件的处理函数*/onReachBottom: function () {},/*** 用户点击右上角分享*/onShareAppMessage: function () {}})那么如果是以数组形式的话也非常简单：wxml代码<image src='{{item.images?item.images:\"../../../images/sketch_169_102.jpg\"}}' class='news_list_img' mode='widthFix'></image>因为数组的话要用到参数item可能其他js代码如下：Page({  /**   * 页面的初始数据   */  data: {    items: [{      title: \"第一届少儿足球比赛\",      txt: \"第一届郑州足球比赛开幕式z乒启动计划\",      time: \"2017年11月20日\",      images: '',    }, {      title: \"第一届少儿足球比赛\",      txt: \"第一届郑州足球比赛开幕式z乒启动计划\",      time: \"2017年11月22日\",      images: '',    }],    ite: [{      title: \"第一届少儿足球比赛\",      txt: \"第一届郑州足球比赛开幕式z乒启动计划\",      time: \"2017年11月20日\",      images: \"http://img2.niutuku.com/desk/1208/1401/ntk-1401-8806.jpg\",    }, {      title: \"第一届少儿足球比赛\",      txt: \"第一届郑州足球比赛开幕式z乒启动计划\",      time: \"2017年11月22日\",      images: \"http://img2.niutuku.com/desk/1208/1401/ntk-1401-8806.jpg\",    }]  },/**   * 生命周期函数--监听页面加载   */  internet: function () {    let ite = this.data.ite;    setTimeout(function () {      this.setData({        items: ite,      })    }.bind(this), 2000);  },  onLoad: function (options) {this.internet()  },  /**   * 生命周期函数--监听页面初次渲染完成   */  onReady: function () {  },  /**   * 生命周期函数--监听页面显示   */  onShow: function () {  },  /**   * 生命周期函数--监听页面隐藏   */  onHide: function () {  },  /**   * 生命周期函数--监听页面卸载   */  onUnload: function () {  },  /**   * 页面相关事件处理函数--监听用户下拉动作   */  onPullDownRefresh: function () {  },  /**   * 页面上拉触底事件的处理函数   */  onReachBottom: function () {  },  /**   * 用户点击右上角分享   */  onShareAppMessage: function () {  }})setData是为了实例化数据目的为了能够放在页面将ite模拟数据赋值给定义的ite（名字随便定义）既然是数据就会有databind的目的是为了捆绑后面的数字是时间间隔多少秒显示要加载出来的数据。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序云端解决方案探索之路               微信小程序客服消息功能 php                                                        原作者: 浪子义                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序跨页面数据传递与事件响应 ", "author": "                  Rolan                  2019-12-17 00:27                ", "text": "                                                                                                                                                                                     在实际工作中有很多场景需要在第二个页面中将用户操作之后的将数据回传到上一页面。接下来将我的方案分享给小伙伴。本次示例采用 uni-app 框架和 weui 样式库实现思路创建一个 Emitter用于事件处理创建一个全局的 Storage在第一个页面创建一个 emitter 对象并添加事件监听将 emitter 存储到 Storage 中在第二个页面从 Storage 中取出 emitter 对象 并触发事件将数据传递到第一个页面中做处理创建 Emitterfunction isFunc(fn) {  return typeof fn === 'function';}export default class Emitter {  constructor() {    this._store = {};  }  /**   * 事件监听   * @param {String} event 事件名   * @param {Function} listener 事件回调函数   */  on(event, listener) {    const listeners = this._store[event] || (this._store[event] = []);    listeners.push(listener);  }  /**   * 取消事件监听   * @param {String} event 事件名   * @param {Function} listener 事件回调函数   */  off(event, listener) {    const listeners = this._store[event] || (this._store[event] = []);    listeners.splice(listeners.findIndex(item => item === listener), 1);  }  /**   * 事件监听 仅监听一次   * @param {String} event 事件名   * @param {Function} listener 事件回调函数   */  once(event, listener) {    const proxyListener = (data) => {      isFunc(listener) && listener.call(null, data);      this.off(event, proxyListener);    }    this.on(event, proxyListener);  }  /**   * 触发事件   * @param {String} 事件名   * @param {Object} 传给事件回调函数的参数   */  emit(event, data) {    const listeners = this._store[event] || (this._store[event] = []);    for (const listener of listeners) {      isFunc(listener) && listener.call(null, data);    }  }}复制代码创建 Storageexport class Storage {  constructor() {    this._store = {};  }  add(key, val) {    this._store[key] = val;  }    get(key) {    return this._store[key];  }    remove(key) {    delete this._store[key];  }    clear() {    this._store = {};  }}export default new Storage();复制代码第一个页面中的处理<template>  <div class=\"page\">    <div class=\"weui-cells__title\">选择城市</div>    <div class=\"weui-cells weui-cells_after-title\">      <navigator :url=\"`../select/select?id=${cityId}`\" class=\"weui-cell weui-cell_access\" hover-class=\"weui-cell_active\">        <div class=\"weui-cell__hd weui-label\">所在城市</div>        <div class=\"weui-cell__bd\" :style=\"{color: cityName || '#999'}\">{{ cityName || '请选择' }}</div>        <div class=\"weui-cell__ft weui-cell__ft_in-access\"></div>      </navigator>    </div>  </div></template><script>import Emitter from '../../utils/emitter';import storage from '../../utils/storage';export default {  data() {    return {      cityId: '',      cityName: '',    }  },  onLoad() {    const emitter = new Emitter();    // 将emitter存到storage中    storage.add('indexEmitter', emitter);    // 添加事件监听    emitter.on('onSelect', this.handleSelect);  },  methods: {    // 事件处理    handleSelect(data) {      this.cityId = data.id;      this.cityName = data.text;    }  }}</script>复制代码第二个页面中的处理<template>  <div class=\"page\">    <div class=\"weui-cells__title\">城市列表</div>    <div class=\"weui-cells weui-cells_after-title\">      <radio-group @change=\"handleChange\">        <label class=\"weui-cell weui-check__label\" v-for=\"item in list\" :key=\"item.id\">          <radio class=\"weui-check\" :value=\"item.id\" :checked=\"`${item.id}` === selectedId\" />          <div class=\"weui-cell__bd\">{{ item.text }}</div>          <div v-if=\"`${item.id}` === selectedId\" class=\"weui-cell__ft weui-cell__ft_in-radio\">            <icon class=\"weui-icon-radio\" type=\"success_no_circle\" size=\"16\" />          </div>        </label>      </radio-group>    </div>  </div></template><script>import storage from '../../utils/storage';export default {  data() {    return {      list: [        { id: 0, text: '北京' },        { id: 1, text: '上海' },        { id: 2, text: '广州' },        { id: 3, text: '深圳' },        { id: 4, text: '杭州' },      ],      selectedId: ''    }  },  onLoad({ id }) {    this.selectedId = id;        // 取出 emitter    this.emitter = storage.get('indexEmitter');  },  methods: {    handleChange(e) {      this.selectedId = e.detail.value;      const item = this.list.find(({ id }) => `${id}` === e.detail.value);      // 触发事件并传递数据      this.emitter.emit('onSelect', { ...item });    }  }}</script>复制代码效果展示传送门github总结之所以将Storage定义成全局的是为了保证第一个页面放到Storage中和第二个页面从 Storage 中取出的emitter是同一个实例如此第一个页面才能正确监听到第二个页面触发的事件。也可以使用 vuex将 emitter 放到 state 中。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)問天地好在                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序Canvas性能优化实战               小程序 input 使用setData触发bindinput事件                                                        原作者: 精明的土豆                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "使用uni-app开发小程序，比直接原生开发小程序好在哪里？ ", "author": "                  Rolan                  2019-10-18 00:26                ", "text": "                                                                                                                                                                                     小程序原生开发有不少槽点：原生wxml开发对Node、预编译器、webpack支持不好影响开发效率和工程构建流程。所以大公司都会用框架开发微信定义的这套语法wxml、wxs以及wx:if等语法私有化太强。不如正经学vue学会了全端通用而不是只为微信小程序vue生态里有太多周边工具可以提高开发效率比如ide、校验器、三方库。。。而微信的开发者工具和专业编辑器相比实在不好用个性化设置也非常少作为前端工程师除了微信小程序还要开发web、其他小程序甚至App人们不喜欢来回切换开发工具和变更语法思考方式。uni-app自然可以解决这些问题但开发者又经常有些顾虑：怕使用uni-app后微信小程序里有的功能无法实现受制于uni-app的更新怕性能不如原生WXML怕框架不成熟跳到坑里担心社区生态不完善本文从开发者关心的功能、性能、学习门槛、开发体验、生态、可扩展性等维度逐个分析对比给予说明。1.功能实现开发者最常问的问题：如果小程序迭代升级新增了一批API但 uni-app 框架未及时更新该怎么办？其实这是误解 uni-app 不限制底层API 调用；在小程序端 uni-app 支持直接编写微信原生代码。类比传统web开发如果vue、react等框架的使用造成开发者无法操作浏览器提供的所有api那这样的框架肯定是不成熟的。小程序开发也一样 uni-app 框架中同样可调用微信提供的所有原生代码。故如果存在某些API（平台特有或新增API） uni-app 尚未封装开发者可直接在 uni-app中编写微信原生API即wx.开头的各种API。举个例子目前 uni-app 虽然尚未封装跨平台的广告（ad）组件但开发者在小程序端依然可以使用微信 <ad> 组件来展现广告代码示例如下：<view>    <view class=\"title\">微信官方banner广告</view>    <view style=\"min-height: 50px;\">        <!-- uni-app尚未封装但可直接使用微信原生的ad组件-->        <ad unit-id=\"adunit-01b7axxxbf53d74e\"></ad>    </view>    <view class=\"title\">微信官方视频广告</view>    <view style=\"min-height: 50px;\">        <!-- uni-app尚未封装但可直接使用微信原生的ad组件-->        <ad unit-id=\"adunit-9f340xxx64533\" ad-type=\"video\" ad-theme=\"white\"></ad>    </view></view>复制代码小程序端运行效果如下：包括微信小程序自定义组件、WXS、云开发这些复杂用法在uni-app里一样全面支持。所以结论是：使用 uni-app 框架开发在功能上和原生小程序开发没有区别不会有任何限制。2. 性能体验开发者常问的第二个问题：三方框架内部大多做了层层封装这些封装是否会增加运行负载导致性能下降？同样是多虑了 uni-app 不会导致性能下载甚至对很多环节做了自动优化很多场景下性能体验比微信原生开发更好。类似使用vue.js开发web不但不会造成性能比原生js差反而由于虚拟dom和差量更新技术的运用在大多数场景下比开发者手动写代码操作dom的性能还好。小程序中需要频繁的写setData代码来更新数据这里很重要的就是差量数据更新。如果不做差量代码性能不好如果每处逻辑都判断差量数据更新那代码写起来太麻烦了。使用 uni-app 底层自动差量数据更新简单而高性能。我们从优化理论、实测数据两个维度来仔细说明。2.1 理论：框架优化方案为提高性能体验小程序从架构设计层面做了很多工作：逻辑层、视图层分离避免JS运算阻塞视图渲染单独定义组件标签（wxml）减少DOM复杂度精简样式（wxss）提升渲染性能复杂组件原生化（video/map等）解决web组件的功能/体验缺失通过这些规范约束大幅提升了小程序的整体性能体验但依然存在不少性能坑点其中以 setData 最为频繁普遍。这里引用微信官方的描述简单介绍一下 setData 背后的工作原理：小程序的视图层目前使用 WebView 作为渲染载体而逻辑层是由独立的 JavascriptCore 作为运行环境。在架构上WebView 和 JavascriptCore 都是独立的模块并不具备数据直接共享的通道。当前视图层和逻辑层的数据传输实际上通过两边提供的 evaluateJavascript 所实现。为简化开发微信将 evaluateJavascript 调用封装成了 setData JS方法实现视图层和逻辑层的数据传输数据流示意图如下：setData 的执行会受到很多因素的影响 setData 每次传递数据量过大或频繁被调用（ 见微信官方介绍 ）都可能引发性能体验问题。幸运的是 uni-app 在这两个方面都有优化。2.1.1 减少 setData 传递数据量假设当前页面有一个列表（初始值为 a,b,c,d ）现在要向列表后追加4个新列表项（ e,f,g,h ）我们分别以微信原生、uni-app 两种模式编写代码。小程序原生代码：page({    data:{        list:['a','b','c','d']    },    change:function(){        let newData = ['e','f','g','h'];        this.data.list.push(...newData);        this.setData({            list:this.data.list        })    }})复制代码如上微信原生代码 change 方法执行时会将 list 中的 a,b,c,d,e,f,g,h 8个列表项通过 setData 全部传输过去。uni-app 代码：export default{    data(){        return {            list:['a','b','c','d']        }    },    methods:{        change:function(){            let newData = ['e','f','g','h'];            this.list.push(...newData)        }    }}复制代码如上 uni-app 代码 change 方法执行时仅会将 list 中的 e,f,g,h 4个新增列表项传输过去实现了 setData 传输量的极简化。uni-app 借鉴了 westore JSON Diff库在调用 setData 之前会先比对历史数据精确、高效计算出有变化的差量数据然后再调用 setData 仅传输变化的数据这样就实现 setData 传递数据量的最小化大幅提高通讯性能。Tips：也许有些同学对传递数据从 a,b,c,d,e,f,g,h 8个列表项优化为 e,f,g,h 4个列表项不以为然但我们提醒不要小看这个机制上述只是demo示例。在实际列表场景中每个列表项可能包含缩略图、标题、摘要、时间等各种信息每个列表项数据都会更大（假设为1k）；假设当前页面有20个列表项连续上拉4次后页面变成100条记录；如果再次上拉页面变成120条记录时情况会有不同上述微信原生的方式将120条记录数据(120k)全部传输过去上述 uni-app 模式仅会将新增的20条（101 ~ 120）记录数据（20k）传输过去数据量是原生方式的1/6！当页面列表项数据越多这个差别就越大页面有200条记录时uni-app传递数据量会变成微信原生数据传递量的1/10！2.1.2 减少 setData 调用频次假设我们有更改多个变量值的需求我们分别以微信原生、uni-app 两种模式编写代码。小程序原生代码：change:function(){    this.setData({a:1});    this.setData({b:2});    this.setData({c:3});    this.setData({d:4});}复制代码如上四次调用 setData 就会引发4次逻辑层、视图层数据通讯uni-app 代码：change:function(){    this.a = 1;    this.b = 2;    this.c = 3;    this.d = 4;}复制代码如上 uni-app 的代码最后会被合并成 {\"a\":1,\"b\":2,\"c\":3,\"d\":4} 一条数据然后仅调用一次 setData 完成所有数据传递大幅降低了 setData 的调用频次。uni-app 之所以有这样的优势是因为 uni-app 基于 Vue Runtime 深度定制实现并借助了 Vue 的 nextTick 机制。2.2 实测：性能对比数据有了如上的理论分析我们接着进行真机实测用数据来对比。测试模型如下：开发内容：开发一个仿微博小程序首页的复杂长列表支持下拉刷新、上拉翻页、点赞。 仿微博的列表是一个包含很多组件的列表这种复杂列表对性能的压力更大很适合做性能测试。界面如下：开发版本：使用微信原生、uni-app分别开发两套代码uni-app使用 cli 方式默认安装。测试代码开源（ Github仓库地址：https://github.com/dcloudio/test-framework ） Tips:若有同学觉得测试代码写法欠妥欢迎提交 PR 或 Issus 本项目下还有其它框架的测试代码开发者可忽略测试机型：红米 Redmi 6 Pro、MIUI 10.2.2.0 稳定版（最新版）、微信版本 7.0.3（最新版）测试环境：每个框架开始测试前杀掉各App进程、清空内存保证测试机环境基本一致；每次从本地读取静态数据屏蔽网络差异。从触发上拉加载到数据更新、页面渲染完成需要准确计时。人眼视觉计时肯定不行我们采用程序埋点的方式制定了如下计时时机：计时开始时机：交互事件触发框架赋值之前如：上拉加载（onReachBottom）函数开头计时结束时机：页面渲染完毕(微信setData回调函数开头)Tips： setData 回调函数开头可认为是页面渲染完成的时间是因为微信 setData 定义如下( 微信规范 )：字段类型必填描述dataObject是这次要改变的数据callbackFunction否setData引起的界面更新 渲染完毕 后的回调函数测试方式：从页面空列表开始通过程序自动触发上拉加载每次新增20条列表记录单次耗时；固定间隔连续触发 N 次上拉加载使得页面达到 20*N 条列表计算这 N 次触发上拉到渲染完成的平均耗时。测试结果如下：列表条数微信原生uni-app200770641400876741600111191080014061113100016901321说明：以400条微博列表为例从页面空列表开始每隔1秒触发一次上拉加载（新增20条微博）记录单次耗时触发20次后停止（页面达到400条微博）计算这20次的平均耗时结果微信原生在这20次 触发上拉 -> 渲染完成 的平均耗时为876毫秒 uni-app 是741毫秒。这个数据可能违反了很多人的直觉uni-app 的性能竟然比微信原生还好！不必疑惑这就是上面理论分析章节中减少 setData 传递数据量优化方案的结果；微信原生每次传递全量数据而 uni-app 在调用 setData 之前会自动做 diff 计算每次仅传递变动的数据。开发者使用微信原生框架完全可以自己优化精简传递数据比如修改如下：data: {    listData: []},onReachBottom() { //上拉加载    // 通过长度获取下一次渲染的索引    let index = this.data.listData.length;    let newData = {}; //新变更数据    Api.getNews().forEach((item) => {        newData['listData[' + (index++) + ']'] = item //赋值索引递增    })     this.setData(newData) //增量数据发送数据到视图层}复制代码经过如上优化修改后再次测试微信原生框架性能数据如下：组件数量微信原生框架（优化前）微信原生框架（优化后）uni-app20077057264140087668874160011118559108001406105511131000169012601321从测试结果可看出经过开发者手动优化微信原生框架可达到更好的性能但 uni-app 相比微信原生性能差距并不大。但原生开发需要开发者熟悉小程序通讯机制有意识的去编写代码精简数据；uni-app自动处理自然是更省心。这个结果和web开发类似web开发也有原生js开发、vue、react框架等情况。如果不做特殊优化原生js写的网页性能经常还不如vue、react框架的性能。也恰恰是因为 Vue 、 react 框架的优秀性能好开发体验好所以原生js开发已经逐渐减少使用了。通过本章节性能优化的理论分析及数据实测我们可以输出这么个结论：uni-app 不会增加小程序运行负载不会拉低运行性能uni-app 自动处理了很多性能优化点对不懂性能调优或不熟悉小程序架构设计的开发者更友好更省心3.社区生态3.1 周边轮子小程序是脱离web自造生态很多web生态中轮子无法使用。微信小程序还是有周边生态的而其他几家小程序平台的生态基本没建起来。uni-app 的周边生态非常丰富在插件市场有近800个插件详见 ext.dcloud.net.cn 。首先 uni-app 兼容小程序的生态各种自定义组件均可直接引入使用。在此基础上 uni-app的插件市场有更多vue组件同时可跨多端使用并且性能优秀。这使得 uni-app 的生态成为最丰富的小程序开发生态。比如富文本解析、图表等组件 uni-app 的插件性能均超过了wxparse、wx-echart等微信小程序组件。如果开发者需要丰富和高性能的组件更应该使用 uni-app 而不是原生小程序开发。3.2 活跃的QQ/微信群和论坛uni-app 官方有 70 个开发者QQ/微信交流群（大多2千人群近10万开发者）三方群更多。问答社区 每天有数百篇帖子。活跃度与微信小程序官方论坛相同远超过其他小程序官方论坛。uni-app 三方培训活跃腾讯课堂官方都为uni-app制作了课程各种培训网站到处可见免费或收费的uni-app培训视频教程。4.学习门槛、开发体验首先微信原生的开发语法既像 React 又像 Vue 有点不伦不类对于开发者来说等于又要学习一套新的语法大幅提升了学习成本这一直被大家所诟病。uni-app 则对开发者更为友好简单来说是 vue的语法 + 小程序的api。它遵循 Vue.js 语法规范组件和API遵循 微信小程序命名 这些都属于通用技术栈学习它们是前端必备技能 uni-app 没有太多额外学习成本。有一定 Vue.js 和微信小程序开发经验的开发者可快速上手 uni-app 。没学过vue的同学也不用掌握vue的全部只需了解vue基础语法、数据绑定、列表渲染、组件等其他如路由、loader、cli、node.js、webpack并不需要学。因为HBuilderX工具搭配 uni-app 可以免终端开发可视化创建项目、可视化安装组件和扩展编译器也就是 uni-app 的学习门槛比web开发的vue.js还低。开发体验层面微信原生开发相比 uni-app 有较大差距主要体现在：更为强大的组件化开发能力：vue的组件开发比小程序自定义组件开发的体验要好很多应用状态管理：uni-app支持vuex使用 Sass 等 CSS 预处理器完整的 ES Next 语法支持自定义构建策略开发工具维度差距更大：微信开发者工具被吐槽无数uni-app 的出品公司同时也是HBuilder的出品公司 DCloud.io 。HBuilder/HBuilderX系列是四大主流前端开发工具（可对比 百度指数 ）其为 uni-app 做了很多优化故 uni-app的开发效率、易用性非微信原生开发可及。这里可以输出一个结论：如果你需要工程化能力那就直接忘了微信原生开发吧。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    百度小程序与微信小程序全面对比               小程序技能进阶回忆录 - 自主实现数据侦听器和计算器                                                        原作者:  CHB                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "Mpx 小程序框架技术揭秘 ", "author": "                  Rolan                  2019-12-27 00:06                ", "text": "                                                                                                                                                                                     Github:\thttps://github.com/didi/mpx本文作者: 肖磊（\thttps://github.com/CommanderXL ）与目前业内的几个小程序框架相比较而言mpx 开发设计的出发点就是基于原生的小程序去做功能增强。所以从开发框架的角度来说是没有任何“包袱”围绕着原生小程序这个 core 去做不同功能的 patch 工作使得开发小程序的体验更好。于是我挑了一些我非常感兴趣的点去学习了下 mpx 在相关功能上的设计与实现。编译环节动态入口编译不同于 web 规范我们都知道小程序每个 page/component 需要被最终在 webview 上渲染出来的内容是需要包含这几个独立的文件的：js/json/wxml/wxss。为了提升小程序的开发体验mpx 参考 vue 的 SFC(single file component)的设计思路采用单文件的代码组织方式进行开发。既然采用这种方式去组织代码的话那么模板、逻辑代码、json配置文件、style样式等都放到了同一个文件当中。那么 mpx 需要做的一个工作就是如何将 SFC 在代码编译后拆分为 js/json/wxml/wxss 以满足小程序技术规范。熟悉 vue 生态的同学都知道vue-loader 里面就做了这样一个编译转化工作。具体有关 vue-loader 的工作流程可以参见我写的\t文章 。这里会遇到这样一个问题就是在 vue 当中如果你要引入一个页面/组件的话直接通过\timport 语法去引入对应的 vue 文件即可。但是在小程序的标准规范里面它有自己一套组件系统即如果你在某个页面/组件里面想要使用另外一个组件那么需要在你的 json 配置文件当中去声明usingComponents 这个字段对应的值为这个组件的路径。在 vue 里面 import 一个 vue 文件那么这个文件会被当做一个 dependency 去加入到 webpack 的编译流程当中。但是 mpx 是保持小程序原有的功能去进行功能的增强。因此一个 mpx 文件当中如果需要引入其他页面/组件那么就是遵照小程序的组件规范需要在\tusingComponents 定义好\t组件名:路径 即可\tmpx 提供的 webpack 插件来完成确定依赖关系同时将被引入的页面/组件加入到编译构建的环节当中 。接下来就来看下具体的实现mpx webpack-plugin 暴露出来的插件上也提供了静态方法去使用 loader。这个 loader 的作用和 vue-loader 的作用类似首先就是拿到 mpx 原始的文件后转化一个 js 文本的文件。例如一个 list.mpx 文件里面有关 json 的配置会被编译为：require(\"!!../../node_modules/@mpxjs/webpack-plugin/lib/extractor?type=json&index=0!../../node_modules/@mpxjs/webpack-plugin/lib/json-compiler/index?root=!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=json&index=0!./list.mpx\")这样可以清楚的看到 list.mpx 这个文件首先 selector(抽离\tlist.mpx 当中有关 json 的配置并传入到 json-compiler 当中) --->>> json-compiler(对 json 配置进行处理添加动态入口等) --->>> extractor(利用 child compiler 单独生成 json 配置文件)其中动态添加入口的处理流程是在 json-compiler 当中去完成的。例如在你的\tpage/home.mpx文件当中的 json 配置中使用了 局部组件\tcomponents/list.mpx :<script type=\"application/json\">  {    \"usingComponents\": {      \"list\": \"../components/list\"    }  }</script>在 json-compiler 当中：...const addEntrySafely = (resource, name, callback) => {  // 如果loader已经回调就不再添加entry  if (callbacked) return callback()  // 使用 webpack 提供的 SingleEntryPlugin 插件创建一个单文件的入口依赖(即这个 component)  const dep = SingleEntryPlugin.createDependency(resource, name)  entryDeps.add(dep)  // compilation.addEntry 方法开始将这个需要被编译的 component 作为依赖添加到 webpack 的构建流程当中  // 这里可以看到的是整个动态添加入口文件的过程是深度优先的  this._compilation.addEntry(this._compiler.context, dep, name, (err, module) => {    entryDeps.delete(dep)    checkEntryDeps()    callback(err, module)  })}const processComponent = (component, context, rewritePath, componentPath, callback) => {  ...  // 调用 loaderContext 上提供的 resolve 方法去解析这个 component path 完整的路径以及这个 component 所属的 package 相关的信息(例如 package.json 等)  this.resolve(context, component, (err, rawResult, info) => {    ...    componentPath = componentPath || path.join(subPackageRoot, 'components', componentName + hash(result), componentName)    ...    // component path 解析完之后调用 addEntrySafely 开始在 webpack 构建流程中动态添加入口    addEntrySafely(rawResult, componentPath, callback)  })}if (isApp) {  ...} else {  if (json.usingComponents) {    // async.forEachOf 流程控制依次调用 processComponent 方法    async.forEachOf(json.usingComponents, (component, name, callback) => {      processComponent(component, this.context, (path) => {        json.usingComponents[name] = path      }, undefined, callback)    }, callback)  }  ...}...这里需要解释说明下有关 webpack 提供的 SingleEntryPlugin 插件。这个插件是 webpack 提供的一个内置插件当这个插件被挂载到 webpack 的编译流程的过程中是会绑定\tcompiler.hooks.make.tapAsync hook当这个 hook 触发后会调用这个插件上的 SingleEntryPlugin.createDependency 静态方法去创建一个入口依赖然后调用\tcompilation.addEntry 将这个依赖加入到编译的流程当中这个是单入口文件的编译流程的最开始的一个步骤(具体可以参见\tWebpack SingleEntryPlugin 源码 )。Mpx 正是利用了 webpack 提供的这样一种能力在遵照小程序的自定义组件的规范的前提下解析 mpx json 配置文件的过程中手动的调用 SingleEntryPlugin 相关的方法去完成动态入口的添加工作。这样也就串联起了所有的 mpx 文件的编译工作。Render FunctionRender Function 这块的内容我觉得是 Mpx 设计上的一大亮点内容。Mpx 引入 Render Function 主要解决的问题是性能优化方向相关的因为小程序的架构设计逻辑层和渲染层是2个独立的。这里直接引用 Mpx 有关 Render Function 对于性能优化相关开发工作的描述：作为一个接管了小程序setData的数据响应开发框架我们高度重视Mpx的渲染性能通过小程序官方文档中提到的性能优化建议可以得知setData对于小程序性能来说是重中之重setData优化的方向主要有两个：尽可能减少setData调用的频次尽可能减少单次setData传输的数据为了实现以上两个优化方向我们做了以下几项工作：将组件的静态模板编译为可执行的render函数通过render函数收集模板数据依赖只有当render函数中的依赖数据发生变化时才会触发小程序组件的setData同时通过一个异步队列确保一个tick中最多只会进行一次setData这个机制和Vue中的render机制非常类似大大降低了setData的调用频次；将模板编译render函数的过程中我们还记录输出了模板中使用的数据路径在每次需要setData时会根据这些数据路径与上一次的数据进行diff仅将发生变化的数据通过数据路径的方式进行setData这样确保了每次setData传输的数据量最低同时避免了不必要的setData操作进一步降低了setData的频次。接下来我们看下 Mpx 是如何实现 Render Function 的。这里我们从一个简单的 demo 来说起：<template>  <text>Computed reversed message: \"{{ reversedMessage }}\"</text>  <view>the c string {{ demoObj.a.b.c }}</view>  <view wx:class=\"{{ { active: isActive } }}\"></view></template><script>import { createComponent } from \"@mpxjs/core\";createComponent({  data: {    isActive: true,    message: 'messages',    demoObj: {      a: {        b: {          c: 'c'        }      }    }  },  computed() {    reversedMessage() {      return this.message.split('').reverse().join('')    }  }})</script>.mpx 文件经过 loader 编译转换的过程中。对于 template 模块的处理和 vue 类似首先将 template 转化为 AST然后再将 AST 转化为 code 的过程中做相关转化的工作最终得到我们需要的 template 模板代码。在\tpackages/webpack-plugin/lib/template-compiler.js 模板处理 loader 当中:let renderResult = bindThis(`global.currentInject = {    moduleId: ${JSON.stringify(options.moduleId)},    render: function () {      var __seen = [];      var renderData = {};      ${compiler.genNode(ast)}return renderData;    }};\\n`, {    needCollect: true,    ignoreMap: meta.wxsModuleMap  })在 render 方法内部创建 renderData 局部变量调用\tcompiler.genNode(ast) 方法完成 Render Function 核心代码的生成工作最终将这个 renderData 返回。例如在上面给出来的 demo 实例当中通过\tcompiler.genNode(ast) 方法最终生成的代码为：((mpxShow)||(mpxShow)===undefined?'':'display:none;');if(( isActive )){}\"Computed reversed message: \\\"\"+( reversedMessage )+\"\\\"\";\"the c string \"+( demoObj.a.b.c );(__injectHelper.transformClass(\"list\", ( {active: isActive} )));mpx 文件当中的 template 模块被初步处理成上面的代码后可以看到这是一段可执行的 js 代码。那么这段 js 代码到底是用作何处呢？可以看到\tcompiler.genNode 方法是被包裹至\tbindThis方法当中的。即这段 js 代码还会被\tbindThis 方法做进一步的处理。打开 bind-this.js 文件可以看到内部的实现其实就是一个 babel 的 transform plugin。在处理上面这段 js 代码的 AST 的过程中通过这个插件对 js 代码做进一步的处理。最终这段 js 代码处理后的结果是：/* mpx inject */ global.currentInject = {  moduleId: \"2271575d\",  render: function () {    var __seen = [];    var renderData = {};    (renderData[\"mpxShow\"] = [this.mpxShow, \"mpxShow\"], this.mpxShow) || (renderData[\"mpxShow\"] = [this.mpxShow, \"mpxShow\"], this.mpxShow) === undefined ? '' : 'display:none;';    \"Computed reversed message: \\\"\" + (renderData[\"reversedMessage\"] = [this.reversedMessage, \"reversedMessage\"], this.reversedMessage) + \"\\\"\";    \"the c string \" + (renderData[\"demoObj.a.b.c\"] = [this.demoObj.a.b.c, \"demoObj\"], this.__get(this.__get(this.__get(this.demoObj, \"a\"), \"b\"), \"c\"));    this.__get(__injectHelper, \"transformClass\")(\"list\", { active: (renderData[\"isActive\"] = [this.isActive, \"isActive\"], this.isActive) });    return renderData;  }};bindThis 方法对于 js 代码的转化规则就是：一个变量的访问形式改造成 this.xxx 的形式；对象属性的访问形式改造成 this.__get(object, property) 的形式(this.__get方法为运行时 mpx runtime 提供的方法)这里的 this 为 mpx 构造的一个代理对象在你业务代码当中调用 createComponent/createPage 方法传入的配置项例如 data都会通过这个代理对象转化为响应式的数据。需要注意的是不管哪种数据形式的改造最终需要达到的效果就是确保在 Render Function 执行的过程当中这些被模板使用到的数据能被正常的访问到在访问的阶段中这些被访问到的数据即被加入到 mpx 构建的整个响应式的系统当中。只要在 template 当中使用到的 data 数据(包括衍生的 computed 数据)最终都会被 renderData 所记录而记录的数据形式是例如：renderData['xxx'] = [this.xxx, 'xxx'] // 数组的形式第一项为这个数据实际的值第二项为这个数据的 firstKey(主要用以数据 diff 的工作)以上就是 mpx 生成 Render Function 的整个过程。总结下 Render Function 所做的工作：执行 render 函数将渲染模板使用到的数据加入到响应式的系统当中；返回 renderData 用以接下来的数据 diff 以及调用小程序的 setData 方法来完成视图的更新Wxs ModuleWxs 是小程序自己推出的一套脚本语言。\t官方文档 给出的示例wxs 模块必须要声明式的被 wxml 引用。和 js 在 jsCore 当中去运行不同的是 wxs 是在渲染线程当中去运行的。因此 wxs 的执行便少了一次从 jsCore 执行的线程和渲染线程的通讯从这个角度来说是对代码执行效率和性能上的比较大的一个优化手段。有关官方提到的有关 wxs 的运行效率的问题还有待论证：“在 android 设备中小程序里的 wxs 与 js 运行效率无差异而在 ios 设备中小程序里的 wxs 会比 js 快 2~20倍。”因为 mpx 是对小程序做渐进增强因此 wxs 的使用方式和原生的小程序保持一致。在你的\t.mpx 文件当中的 template block 内通过路径直接去引入 wxs 模块即可使用：<template>  <wxs src=\"../wxs/components/list.wxs\" module=\"list\">  <view>{{ list.FOO }}</view></template>// wxs/components/list.wxsconst Foo = 'This is from list wxs module'module.exports = {  Foo}在 template 模块经过 template-compiler 处理的过程中。模板编译器 compiler 在解析模板的 AST 过程中会针对 wxs 标签缓存一份 wxs 模块的映射表：{  meta: {    wxsModuleMap: {      list: '../wxs/components/list.wxs'    }  }}当 compiler 对 template 模板解析完后template-compiler 接下来就开始处理 wxs 模块相关的内容：// template-compiler/index.jsmodule.exports = function (raw) {  ...  const addDependency = dep => {    const resourceIdent = dep.getResourceIdentifier()    if (resourceIdent) {      const factory = compilation.dependencyFactories.get(dep.constructor)      if (factory === undefined) {        throw new Error(`No module factory available for dependency type: ${dep.constructor.name}`)      }      let innerMap = dependencies.get(factory)      if (innerMap === undefined) {        dependencies.set(factory, (innerMap = new Map()))      }      let list = innerMap.get(resourceIdent)      if (list === undefined) innerMap.set(resourceIdent, (list = []))      list.push(dep)    }  }  // 如果有 wxsModuleMap 即为 wxs module 依赖的话那么下面会调用 compilation.addModuleDependencies 方法  // 将 wxsModule 作为 issuer 的依赖再次进行编译最终也会被打包进输出的模块代码当中  // 需要注意的就是 wxs module 不仅要被注入到 bundle 里的 render 函数当中同时也会通过 wxs-loader 处理单独输出一份可运行的 wxs js 文件供 wxml 引入使用  for (let module in meta.wxsModuleMap) {    isSync = false    let src = meta.wxsModuleMap[module]    const expression = `require(${JSON.stringify(src)})`    const deps = []    // parser 为 js 的编译器    parser.parse(expression, {      current: { // 需要注意的是这里需要部署 addDependency 接口因为通过 parse.parse 对代码进行编译的时候会调用这个接口来获取 require(${JSON.stringify(src)}) 编译产生的依赖模块        addDependency: dep => {          dep.userRequest = module          deps.push(dep)        }      },      module: issuer    })    issuer.addVariable(module, expression, deps) // 给 issuer module 添加 variable 依赖    iterationOfArrayCallback(deps, addDependency)  }  // 如果没有 wxs module 的处理那么 template-compiler 即为同步任务否则为异步任务  if (isSync) {    return result  } else {    const callback = this.async()    const sortedDependencies = []    for (const pair1 of dependencies) {      for (const pair2 of pair1[1]) {        sortedDependencies.push({          factory: pair1[0],          dependencies: pair2[1]        })      }    }    // 调用 compilation.addModuleDependencies 方法将 wxs module 作为 issuer module 的依赖加入到编译流程中    compilation.addModuleDependencies(      issuer,      sortedDependencies,      compilation.bail,      null,      true,      () => {        callback(null, result)      }    )  }}template/script/style/json 模块单文件的生成不同于 Vue 借助 webpack 是将 Vue 单文件最终打包成单独的 js chunk 文件。而小程序的规范是每个页面/组件需要对应的 wxml/js/wxss/json 4个文件。因为 mpx 使用单文件的方式去组织代码所以在编译环节所需要做的工作之一就是将 mpx 单文件当中不同 block 的内容拆解到对应文件类型当中。在动态入口编译的小节里面我们了解到 mpx 会分析每个 mpx 文件的引用依赖从而去给这个文件创建一个 entry 依赖(SingleEntryPlugin)并加入到 webpack 的编译流程当中。我们还是继续看下 mpx loader 对于 mpx 单文件初步编译转化后的内容：/* script */export * from \"!!babel-loader!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=script&index=0!./list.mpx\"/* styles */require(\"!!../../node_modules/@mpxjs/webpack-plugin/lib/extractor?type=styles&index=0!../../node_modules/@mpxjs/webpack-plugin/lib/wxss/loader?root=&importLoaders=1&extract=true!../../node_modules/@mpxjs/webpack-plugin/lib/style-compiler/index?{\\\"id\\\":\\\"2271575d\\\",\\\"scoped\\\":false,\\\"sourceMap\\\":false,\\\"transRpx\\\":{\\\"mode\\\":\\\"only\\\",\\\"comment\\\":\\\"use rpx\\\",\\\"include\\\":\\\"/Users/XRene/demo/mpx-demo-source/src\\\"}}!stylus-loader!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=styles&index=0!./list.mpx\")/* json */require(\"!!../../node_modules/@mpxjs/webpack-plugin/lib/extractor?type=json&index=0!../../node_modules/@mpxjs/webpack-plugin/lib/json-compiler/index?root=!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=json&index=0!./list.mpx\")/* template */require(\"!!../../node_modules/@mpxjs/webpack-plugin/lib/extractor?type=template&index=0!../../node_modules/@mpxjs/webpack-plugin/lib/wxml/wxml-loader?root=!../../node_modules/@mpxjs/webpack-plugin/lib/template-compiler/index?{\\\"usingComponents\\\":[],\\\"hasScoped\\\":false,\\\"isNative\\\":false,\\\"moduleId\\\":\\\"2271575d\\\"}!../../node_modules/@mpxjs/webpack-plugin/lib/selector?type=template&index=0!./list.mpx\")接下来可以看下 styles/json/template 这3个 block 的处理流程是什么样。首先来看下 json block 的处理流程：\tlist.mpx -> json-compiler -> extractor 。第一个阶段 list.mpx 文件经由 json-compiler 的处理流程在前面的章节已经讲过主要就是分析依赖增加动态入口的编译过程。当所有的依赖分析完后调用 json-compiler loader 的异步回调函数：// lib/json-compiler/index.jsmodule.exports = function (content) {  ...  const nativeCallback = this.async()  ...  let callbacked = false  const callback = (err, processOutput) => {    checkEntryDeps(() => {      callbacked = true      if (err) return nativeCallback(err)      let output = `var json = ${JSON.stringify(json, null, 2)};\\n`      if (processOutput) output = processOutput(output)      output += `module.exports = JSON.stringify(json, null, 2);\\n`      nativeCallback(null, output)    })  }}这里我们可以看到经由 json-compiler 处理后通过\tnativeCallback 方法传入下一个 loader 的文本内容形如：var json = {  \"usingComponents\": {    \"list\": \"/components/list397512ea/list\"  }}module.exports = JSON.stringify(json, null, 2)即这段文本内容会传递到下一个 loader 内部进行处理即 extractor。接下来我们来看下 extractor 里面主要是实现了哪些功能：// lib/extractor.jsmodule.exports = function (content) {  ...  const contentLoader = normalize.lib('content-loader')  let request = `!!${contentLoader}?${JSON.stringify(options)}!${this.resource}` // 构建一个新的 resource且这个 resource 只需要经过 content-loader  let resultSource = defaultResultSource  const childFilename = 'extractor-filename'  const outputOptions = {    filename: childFilename  }  // 创建一个 child compiler  const childCompiler = mainCompilation.createChildCompiler(request, outputOptions, [    new NodeTemplatePlugin(outputOptions),    new LibraryTemplatePlugin(null, 'commonjs2'), // 最终输出的 chunk 内容遵循 commonjs 规范的可执行的模块代码 module.exports = (function(modules) {})([modules])    new NodeTargetPlugin(),    new SingleEntryPlugin(this.context, request, resourcePath),    new LimitChunkCountPlugin({ maxChunks: 1 })  ])  ...  childCompiler.hooks.thisCompilation.tap('MpxWebpackPlugin ', (compilation) => {    // 创建 loaderContext 时触发的 hook在这个 hook 触发的时候将原本从 json-compiler 传递过来的 content 内容挂载至 loaderContext.__mpx__ 属性上面以供接下来的 content -loader 来进行使用    compilation.hooks.normalModuleLoader.tap('MpxWebpackPlugin', (loaderContext, module) => {      // 传递编译结果子编译器进入content-loader后直接输出      loaderContext.__mpx__ = {        content,        fileDependencies: this.getDependencies(),        contextDependencies: this.getContextDependencies()      }    })  })  let source  childCompiler.hooks.afterCompile.tapAsync('MpxWebpackPlugin', (compilation, callback) => {    // 这里 afterCompile 产出的 assets 的代码当中是包含 webpack runtime bootstrap 的代码不过需要注意的是这个 source 模块的产出形式    // 因为使用了 new LibraryTemplatePlugin(null, 'commonjs2') 等插件。所以产出的 source 是可以在 node 环境下执行的 module    // 因为在 loaderContext 上部署了 exec 方法即可以直接执行 commonjs 规范的 module 代码这样就最终完成了 mpx 单文件当中不同模块的抽离工作    source = compilation.assets[childFilename] && compilation.assets[childFilename].source()    // Remove all chunk assets    compilation.chunks.forEach((chunk) => {      chunk.files.forEach((file) => {        delete compilation.assets[file]      })    })    callback()  })  childCompiler.runAsChild((err, entries, compilation) => {    ...    try {      // exec 是 loaderContext 上提供的一个方法在其内部会构建原生的 node.js module并执行这个 module 的代码      // 执行这个 module 代码后获取的内容就是通过 module.exports 导出的内容      let text = this.exec(source, request)      if (Array.isArray(text)) {        text = text.map((item) => {          return item[1]        }).join('\\n')      }      let extracted = extract(text, options.type, resourcePath, +options.index, selfResourcePath)      if (extracted) {        resultSource = `module.exports = __webpack_public_path__ + ${JSON.stringify(extracted)};`      }    } catch (err) {      return nativeCallback(err)    }    if (resultSource) {      nativeCallback(null, resultSource)    } else {      nativeCallback()    }  })}稍微总结下上面的处理流程：module.exports所以上面的示例 demo 最终会输出一个 json 文件里面包含的内容即为：{  \"usingComponents\": {    \"list\": \"/components/list397512ea/list\"  }}运行时环节以上几个章节主要是分析了几个 Mpx 在编译构建环节所做的工作。接下来我们来看下 Mpx 在运行时环节做了哪些工作。响应式系统小程序也是通过数据去驱动视图的渲染需要手动的调用\tsetData 去完成这样一个动作。同时小程序的视图层也提供了用户交互的响应事件系统在 js 代码中可以去注册相关的事件回调并在回调中去更改相关数据的值。Mpx 使用 Mobx 作为响应式数据工具并引入到小程序当中使得小程序也有一套完成的响应式的系统让小程序的开发有了更好的体验。还是从组件的角度开始分析 mpx 的整个响应式的系统。每次通过\tcreateComponent 方法去创建一个新的组件这个方法将原生的小程序创造组件的方法\tComponent 做了一层代理例如在 attched 的生命周期钩子函数内部会注入一个 mixin：// attached 生命周期钩子 mixinattached() {  // 提供代理对象需要的api  transformApiForProxy(this, currentInject)  // 缓存options  this.$rawOptions = rawOptions // 原始的没有剔除 customKeys 的 options 配置  // 创建proxy对象  const mpxProxy = new MPXProxy(rawOptions, this) // 将当前实例代理到 MPXProxy 这个代理对象上面去  this.$mpxProxy = mpxProxy // 在小程序实例上绑定 $mpxProxy 的实例  // 组件监听视图数据更新, attached之后才能拿到properties  this.$mpxProxy.created()}在这个方法内部首先调用\ttransformApiForProxy 方法对组件实例上下文\tthis 做一层代理工作在 context 上下文上去重置小程序的 setData 方法同时拓展 context 相关的属性内容：function transformApiForProxy (context, currentInject) {  const rawSetData = context.setData.bind(context) // setData 绑定对应的 context 上下文  Object.defineProperties(context, {    setData: { // 重置 context 的 setData 方法      get () {        return this.$mpxProxy.setData.bind(this.$mpxProxy)      },      configurable: true    },    __getInitialData: {      get () {        return () => context.data      },      configurable: false    },    __render: { // 小程序原生的 setData 方法      get () {        return rawSetData      },      configurable: false    }  })  // context 绑定注入的render函数  if (currentInject) {    if (currentInject.render) { // 编译过程中生成的 render 函数      Object.defineProperties(context, {        __injectedRender: {          get () {            return currentInject.render.bind(context)          },          configurable: false        }      })    }    if (currentInject.getRefsData) {      Object.defineProperties(context, {        __getRefsData: {          get () {            return currentInject.getRefsData          },          configurable: false        }      })    }  }}接下来实例化一个 mpxProxy 实例并挂载至 context 上下文的 $mpxProxy 属性上并调用 mpxProxy 的 created 方法完成这个代理对象的初始化的工作。在 created 方法内部主要是完成了以下的几个工作：initApi在组件实例 this 上挂载\t$watch ,\t$forceUpdate ,\t$updated ,\t$nextTick 等方法这样在你的业务代码当中即可直接访问实例上部署好的这些方法；initDatainitComputed将 computed 计算属性字段全部代理至组件实例 this 上；通过 Mobx observable 方法将 data 数据转化为响应式的数据；initWatch初始化所有的 watcher 实例；initRender初始化一个 renderWatcher 实例；这里我们具体的来看下 initRender 方法内部是如何进行工作的：export default class MPXProxy {  ...  initRender() {    let renderWatcher    let renderExcutedFailed = false    if (this.target.__injectedRender) { // webpack 注入的有关这个 page/component 的 renderFunction      renderWatcher = watch(this.target, () => {        if (renderExcutedFailed) {          this.render()        } else {          try {            return this.target.__injectedRender() // 执行 renderFunction获取渲染所需的响应式数据          } catch(e) {            ...          }        }      }, {        handler: (ret) => {          if (!renderExcutedFailed) {            this.renderWithData(ret) // 渲染页面          }        },        immediate: true,        forceCallback: true      })    }  }  ...}在 initRender 方法内部非常清楚的看到首先判断这个 page/component 是否具有 renderFunction如果有的话那么就直接实例化一个 renderWatcher：export default class Watcher {  constructor (context, expr, callback, options) {    this.destroyed = false    this.get = () => {      return type(expr) === 'String' ? getByPath(context, expr) : expr()    }    const callbackType = type(callback)    if (callbackType === 'Object') {      options = callback      callback = null    } else if (callbackType === 'String') {      callback = context[callback]    }    this.callback = typeof callback === 'function' ? action(callback.bind(context)) : null    this.options = options || {}    this.id = ++uid    // 创建一个新的 reaction    this.reaction = new Reaction(`mpx-watcher-${this.id}`, () => {      this.update()    })    // 在调用 getValue 函数的时候实际上是调用 reaction.track 方法这个方法内部会自动执行 effect 函数即执行 this.update() 方法这样便会出发一次模板当中的 render 函数来完成依赖的收集    const value = this.getValue()    if (this.options.immediateAsync) { // 放置到一个队列里面去执行      queueWatcher(this)    } else { // 立即执行 callback      this.value = value      if (this.options.immediate) {        this.callback && this.callback(this.value)      }    }  }  getValue () {    let value    this.reaction.track(() => {      value = this.get() // 获取注入的 render 函数执行后返回的 renderData 的值在执行 render 函数的过程中就会访问响应式数据的值      if (this.options.deep) {        const valueType = type(value)        // 某些情况下最外层是非isObservable 对象比如同时观察多个属性时        if (!isObservable(value) && (valueType === 'Array' || valueType === 'Object')) {          if (valueType === 'Array') {            value = value.map(item => toJS(item, false))          } else {            const newValue = {}            Object.keys(value).forEach(key => {              newValue[key] = toJS(value[key], false)            })            value = newValue          }        } else {          value = toJS(value, false)        }      } else if (isObservableArray(value)) {        value.peek()      } else if (isObservableObject(value)) {        keys(value)      }    })    return value  }  update () {    if (this.options.sync) {      this.run()    } else {      queueWatcher(this)    }  }  run () {    const immediateAsync = !this.hasOwnProperty('value')    const oldValue = this.value    this.value = this.getValue() // 重新获取新的 renderData 的值    if (immediateAsync || this.value !== oldValue || isObject(this.value) || this.options.forceCallback) {      if (this.callback) {        immediateAsync ? this.callback(this.value) : this.callback(this.value, oldValue)      }    }  }  destroy () {    this.destroyed = true    this.reaction.getDisposer()()  }}Watcher 观察者核心实现的工作流程就是：this.update()mpx 在构建这个响应式的系统当中主要有2个大的环节其一为在构建编译的过程中将 template 模块转化为 renderFunction提供了渲染模板时所需响应式数据的访问机制并将 renderFunction 注入到运行时代码当中其二就是在运行环节mpx 通过构建一个小程序实例的代理对象将小程序实例上的数据访问全部代理至 MPXProxy 实例上而 MPXProxy 实例即 mpx 基于 Mobx 去构建的一套响应式数据对象首先将 data 数据转化为响应式数据其次提供了 computed 计算属性watch 方法等一系列增强的拓展属性/方法虽然在你的业务代码当中 page/component 实例 this 都是小程序提供的但是最终经过代理机制实际上访问的是 MPXProxy 所提供的增强功能所以 mpx 也是通过这样一个代理对象去接管了小程序的实例。需要特别指出的是mpx 将小程序官方提供的 setData 方法同样收敛至内部这也是响应式系统提供的基础能力即开发者只需要关注业务开发而有关小程序渲染运行在 mpx 内部去帮你完成。性能优化由于小程序的双线程的架构设计逻辑层和视图层之间需要桥接 native bridge。如果要完成视图层的更新那么逻辑层需要调用 setData 方法数据经由 native bridge再到渲染层这个工程流程为：小程序逻辑层调用宿主环境的 setData 方法；逻辑层执行 JSON.stringify 将待传输数据转换成字符串并拼接到特定的JS脚本并通过evaluateJavascript 执行脚本将数据传输到渲染层；渲染层接收到后 WebView JS 线程会对脚本进行编译得到待更新数据后进入渲染队列等待 WebView 线程空闲时进行页面渲染；WebView 线程开始执行渲染时待更新数据会合并到视图层保留的原始 data 数据并将新数据套用在WXML片段中得到新的虚拟节点树。经过新虚拟节点树与当前节点树的 diff 对比将差异部分更新到UI视图。同时将新的节点树替换旧节点树用于下一次重渲染。文章来源而 setData 作为逻辑层和视图层之间通讯的核心接口那么对于这个接口的使用遵照一些准则将有助于性能方面的提升。尽可能的减少 setData 传输的数据Mpx 在这个方面所做的工作之一就是基于数据路径的 diff。这也是官方所推荐的 setData 的方式。每次响应式数据发生了变化调用 setData 方法的时候确保传递的数据都为 diff 过后的最小数据集这样来减少 setData 传输的数据。接下来我们就来看下这个优化手段的具体实现思路首先还是从一个简单的 demo 来看：<script>import { createComponent } from '@mpxjs/core'createComponent({  data: {    obj: {      a: {        c: 1,        d: 2      }    }  }  onShow() {    setTimeout(() => {      this.obj.a = {        c: 1,        d: 'd'      }    }, 200)  }})</script>在示例 demo 当中声明了一个 obj 对象(这个对象里面的内容在模块当中被使用到了)。然后经过 200ms 后手动修改 obj.a 的值因为对于 c 字段来说它的值没有发生改变而 d 字段发生了改变。因此在 setData 方法当中也应该只更新 obj.a.d 的值即：this.setData('obj.a.d', 'd')因为 mpx 是整体接管了小程序当中有关调用 setData 方法并驱动视图更新的机制。所以当你在改变某些数据的时候mpx 会帮你完成数据的 diff 工作以保证每次调用 setData 方法时传入的是最小的更新数据集。这里也简单的分析下 mpx 是如何去实现这样的功能的。在上文的编译构建阶段有分析到 mpx 生成的 Render Function这个 Render Function 每次执行的时候会返回一个 renderData而这个 renderData 即用以接下来进行 setData 驱动视图渲染的原始数据。renderData 的数据组织形式是模板当中使用到的数据路径作为 key 键值对应的值使用一个数组组织数组第一项为数据的访问路径(可获取到对应渲染数据)第二项为数据路径的第一个键值例如在 demo 示例当中的 renderData 数据如下：renderData['obj.a.c'] = [this.obj.a.c, 'obj']renderData['obj.a.d'] = [this.obj.a.d, 'obj']当页面第一次渲染或者是响应式输出发生变化的时候Render Function 都会被执行一次用以获取最新的 renderData 来进行接下来的页面渲染过程。// src/core/proxy.jsclass MPXProxy {  ...  renderWithData(rawRenderData) { // rawRenderData 即为 Render Function 执行后获取的初始化 renderData    const renderData = preprocessRenderData(rawRenderData) // renderData 数据的预处理    if (!this.miniRenderData) { // 最小数据渲染集页面/组件初次渲染的时候使用 miniRenderData 进行渲染初次渲染的时候是没有数据需要进行 diff 的      this.miniRenderData = {}      for (let key in renderData) { // 遍历数据访问路径        if (renderData.hasOwnProperty(key)) {          let item = renderData[key]           let data = item[0]          let firstKey = item[1] // 某个字段 path 的第一个 key 值          if (this.localKeys.indexOf(firstKey) > -1) {            this.miniRenderData[key] = diffAndCloneA(data).clone          }        }      }      this.doRender(this.miniRenderData)    } else { // 非初次渲染使用 processRenderData 进行数据的处理主要是需要进行数据的 diff 取值工作并更新 miniRenderData 的值      this.doRender(this.processRenderData(renderData))    }  }  processRenderData(renderData) {    let result = {}    for (let key in renderData) {      if (renderData.hasOwnProperty(key)) {        let item = renderData[key]        let data = item[0]        let firstKey = item[1]        let { clone, diff } = diffAndCloneA(data, this.miniRenderData[key]) // 开始数据 diff        // firstKey 必须是为响应式数据的 key且这个发生变化的 key 为 forceUpdateKey 或者是在 diff 阶段发现确实出现了 diff 的情况        if (this.localKeys.indexOf(firstKey) > -1 && (this.checkInForceUpdateKeys(key) || diff)) {          this.miniRenderData[key] = result[key] = clone        }      }    }    return result  }  ...}// src/helper/utils.js// 如果 renderData 里面即包含对某个 key 的访问同时还有对这个 key 的子节点访问的话那么需要剔除这个子节点/** * process renderData, remove sub node if visit parent node already * @param {Object} renderData * @return {Object} processedRenderData */export function preprocessRenderData (renderData) {   // method for get key path array  const processKeyPathMap = (keyPathMap) => {    let keyPath = Object.keys(keyPathMap)    return keyPath.filter((keyA) => {      return keyPath.every((keyB) => {        if (keyA.startsWith(keyB) && keyA !== keyB) {          let nextChar = keyA[keyB.length]          if (nextChar === '.' || nextChar === '[') {            return false          }        }        return true      })    })  }  const processedRenderData = {}  const renderDataFinalKey = processKeyPathMap(renderData) // 获取最终需要被渲染的数据的 key  Object.keys(renderData).forEach(item => {    if (renderDataFinalKey.indexOf(item) > -1) {      processedRenderData[item] = renderData[item]    }  })  return processedRenderData}其中在 processRenderData 方法内部调用了 diffAndCloneA 方法去完成数据的 diff 工作。在这个方法内部判断新、旧值是否发生变化返回的 diff 字段即表示是否发生了变化clone 为 diffAndCloneA 接受到的第一个数据的深拷贝值。这里大致的描述下相关流程：响应式的数据发生了变化触发 Render Function 重新执行获取最新的 renderData；renderData 的预处理主要是用以剔除通过路径访问时同时有父、子路径情况下的子路径的 key；判断是否存在 miniRenderData 最小数据渲染集如果没有那么 Mpx 完成 miniRenderData 最小渲染数据集的收集如果有那么使用处理后的 renderData 和 miniRenderData 进行数据的 diff 工作(diffAndCloneA)并更新最新的 miniRenderData 的值；调用 doRender 方法进入到 setData 阶段相关参阅文档：Page )尽可能的减少 setData 的调用频次每次调用 setData 方法都会完成一次从逻辑层 -> native bridge -> 视图层的通讯并完成页面的更新。因此频繁的调用 setData 方法势必也会造成视图的多次渲染用户的交互受阻。所以对于 setData 方法另外一个优化角度就是尽可能的减少 setData 的调用频次将多个同步的 setData 操作合并到一次调用当中。接下来就来看下 mpx 在这方面是如何做优化的。还是先来看一个简单的 demo:<script>import { createComponent } from '@mpxjs/core'createComponent({  data: {    msg: 'hello',    obj: {      a: {        c: 1,        d: 2      }    }  }  watch: {    obj: {      handler() {        this.msg = 'world'      },      deep: true    }  },  onShow() {    setTimeout(() => {      this.obj.a = {        c: 1,        d: 'd'      }    }, 200)  }})</script>在示例 demo 当中msg 和 obj 都作为模板依赖的数据这个组件开始展示后的 200ms更新 obj.a 的值同时 obj 被 watch当 obj 发生改变后更新 msg 的值。这里的逻辑处理顺序是：obj.a 变化 -> 将 renderWatch 加入到执行队列 -> 触发 obj watch -> 将 obj watch 加入到执行队列 -> 将执行队列放到下一帧执行 -> 按照 watch id 从小到大依次执行 watch.run -> setData 方法调用一次(即 renderWatch 回调)统一更新 obj.a 及 msg -> 视图重新渲染接下来就来具体看下这个流程：由于 obj 作为模板渲染的依赖数据自然会被这个组件的 renderWatch 作为依赖而被收集。当 obj 的值发生变化后首先触发 reaction 的回调即\tthis.update() 方法如果是个同步的 watch那么立即调用\tthis.run() 方法即 watcher 监听的回调方法否则就通过\tqueueWatcher(this) 方法将这个 watcher 加入到执行队列：// src/core/watcher.jsexport default Watcher {  constructor (context, expr, callback, options) {    ...    this.id = ++uid    this.reaction = new Reaction(`mpx-watcher-${this.id}`, () => {      this.update()    })    ...  }  update () {    if (this.options.sync) {      this.run()    } else {      queueWatcher(this)    }  }}而在 queueWatcher 方法中lockTask 维护了一个异步锁即将 flushQueue 当成微任务统一放到下一帧去执行。所以在 flushQueue 开始执行之前还会有同步的代码将 watcher 加入到执行队列当中当 flushQueue 开始执行的时候依照 watcher.id 升序依次执行这样去确保 renderWatcher 在执行前其他所有的 watcher 回调都执行完了即执行 renderWatcher 的回调的时候获取到的 renderData 都是最新的然后再去进行 setData 的操作完成页面的更新。// src/core/queueWatcher.jsimport { asyncLock } from '../helper/utils'const queue = []const idsMap = {}let flushing = falselet curIndex = 0const lockTask = asyncLock()export default function queueWatcher (watcher) {  if (!watcher.id && typeof watcher === 'function') {    watcher = {      id: Infinity,      run: watcher    }  }  if (!idsMap[watcher.id] || watcher.id === Infinity) {    idsMap[watcher.id] = true    if (!flushing) {      queue.push(watcher)    } else {      let i = queue.length - 1      while (i > curIndex && watcher.id < queue[i].id) {        i--      }      queue.splice(i + 1, 0, watcher)    }    lockTask(flushQueue, resetQueue)  }}function flushQueue () {  flushing = true  queue.sort((a, b) => a.id - b.id)  for (curIndex = 0; curIndex < queue.length; curIndex++) {    const watcher = queue[curIndex]    idsMap[watcher.id] = null    watcher.destroyed || watcher.run()  }  resetQueue()}function resetQueue () {  flushing = false  curIndex = queue.length = 0}Mpx github:\thttps://github.com/didi/mpx使用文档:\thttps://didi.github.io/mpx/                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    支付系统：线上支付的对接流程               小程序背后：巨头们各自为阵的四大移动新生态                                                        原作者: 肖磊                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "介绍一个小程序预处理器 ", "author": "                  Rolan                  2019-10-31 00:12                ", "text": "                                                                                                                                                                                     前言用过原生用过  wepy用过 mp-vue但是都不是非常满意原生的痛点是文件太多wepy 和 mp-vue 的问题见 mpvue和wepy问题总结最后不得不和同事一起做了一个超轻量的小程序单文件解析器 mp-parser在贴合原生语法的同时解决掉文件太多的痛点。并配套研发了脚手架 mp-parser-cli 提供了很多通用能力比如字体压缩、代码压缩、通用组件、http & cookie 封装等。单文件形式mp-parser 的核心就是单文件解析以及热更新下面为一个语法示例（demo.vue）标签内的所有语法皆为原生语法。<!-- config 标签下的内容会被解析到 .json 文件中 --><config>  {    usingComponents: {}  }</config><!-- template 标签下的内容会被解析到 .wxml 文件中 --><template>  <navigation title=\"自定义导航栏\"></navigation></template><!-- script 标签下的内容会被解析到 .js 文件中 --><script>Page({})</script><!-- style 标签下的内容会被解析到 .wxss 文件中支持 sass 语法 --><style lang=\"scss\"></style>复制代码通用能力mp-parser 脚手架提供了非常多的通用能力详细文档见 github地址。http 请求将 http 请求 promise 化简化了请求语法且会自动携带 cookiePage({  onLoad() {    // get    this.$http.get('url', {params: ''}).then((res) => {}).catch((err) => {});    // post    this.$http.post('url', {params: ''}).then((res) => {}).catch((err) => {});  }})复制代码通用组件我们提供了非常多的通用组件比如常用有自定义导航栏 navigation拖拽卡片 drag-card倒计时 count-down省略文本 ellipsis-text吸底输入框 fixed-inputter图片裁剪器 image-cropper范围选择器 range-slider全屏录像 video-recorder左滑删除 sideslipping通用弹窗Page({  onLoad() {    // { title, needHideLoading }    this.$showSuccess('操作成功', false);    // { title, content, needHideLoading}    this.$showError('操作失败', '操作失败请稍后重试', false);    this.$showLoading('数据加载中...');    this.$hideLoading();  }})复制代码字体压缩字体配置完后执行以下命令具体配置教程见 字体压缩配置教程npm run fontCompression复制代码安装使用# 安装脚手架npm install -g mp-parser-cli# 新建项目mp-parser-cli-init <project_name># 安装依赖cd <project_name>npm install# 运行npm run dev# 打开开发者工具选择dist目录查看效果                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小小的支付完成页上腾讯阿里打起来了               小程序识别身份证银行卡营业执照驾照                                                        原作者: TJ-XiaJiaHao                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序前端实现自定义分享 ", "author": "                  Rolan                  2019-6-13 00:06                ", "text": "                                                                                                                                                                                     目前手上有一个小程序的项目希望转发时分享消息的界面能够自定义,然而微信小程序只提供设置图片的url和title。/**     * 用户点击右上角分享     */    onShareAppMessage: function() {        return {          imageUrl:'',          title:''        };    }复制代码实现我们要转发的显示内容多了一点东西: 头像  用户名 和 点赞数。好在这个排版不是很复杂所以我们思考了一下通过canvas去生成一张图片再return canvas所生成的图片url。代码如下（其实还要作出一些显示上的优化具体你们自己去调试）： 先在页面里新建一个canvas 标签<canvas canvas-id=\"canvasid\" style=\"width: 375px; height: 500px;\" wx:if=\"{{canvasShow}}\"></canvas>复制代码let context = wx.createCanvasContext('canvasid')     context.drawImage(back.path, 0, 60, backWidth, backHeight) //绘制下方背景图     //绘制圆形头像参考教程：https://www.jianshu.com/p/9a6ee2648d6f 第二种方法      context.save();      var d = 2 * 25;      var cx = 0 + 25;      var cy = 0 + 25;      context.arc(cx, cy,25, 0, 2 * Math.PI);      context.clip();      context.drawImage(avatar.path, 0,0, d, d);      context.restore();      //绘制名字和点赞数      context.setFontSize(14)      context.fillText('userName', 70, 32)      let zanLength = ('100' + '次赞').length      context.fillText('100'+ '次赞', 375 - 14 * zanLength, 32)      //执行draw进行渲染 并返回图片url      context.draw(true, () => {        //此方法应执行在draw的回调中        wx.canvasToTempFilePath({          x: 0,          y: 0,          width: 375,          height: 400,          destWidth: 375,          destHeight: 400,          canvasId: 'canvasid',          success(res) {        //设置onShareAppMessage所返回的数据格式           let shareInfo = {              title: 'customTitle',              imageUrl            }           //隐藏画布            that.setData({              canvasShow: false            })          }        })      });复制代码然而！ 在canvas中绘制的图片要在真机上显示出来是有问题的（画布污染）非同源的图片在canvas不会显示出来的。后来我们使用 wx.getImageInfo 去获取图片信息通过里面的地址去显示图片(相当于是把图片转了一道)。wx.getImageInfo({                src: imgUrl,                success: function(res) {                     /**拿到返回值res[0].path,再把该值作为canvas绘制图片的路径                         context.drawImage(res[0].path,x,x,x)**/                    let drawImgUrl =  res[0].path                }            }); 复制代码emmmm....文章很短暂这里只是提供一下解决的思路希望能帮助到大家~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序营销组件：红包雨、大转盘、九宫格翻牌……               小程序打怪之在线客服自动回复功能(node版)                                                        原作者:  没人懂还可以问神                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序绑定用户方案 优化 ", "author": "                  Rolan                  2019-5-15 00:16                ", "text": "                                                                                                                                                                                     在做过一系列小程序之后对小程序的登陆鉴权的流程也有一定的理解类似于 B 端小程序自不必说要用户信息手机号地址可以一把梭做一个引导页面进行判断然后要求用户给与绑定用户自然不会多说什么毕竟这是企业级别应用。但是当涉及到 C 端小程序时候。想让用户进行绑定就势必要给与用户便利。这里我列出一些我觉得较为不错的小程序应用方案以供参考。预先绑定类该类小程序在使用之前就需要绑定用户信息。常见于线下门店类功能性小程序。线下操作时有大量的优惠活动来支持小程序的流量。功能介绍例如 便利蜂。之前在上海经常使用价格和优惠都非常不错这类小程序属于线下功能类小程序内部有抽奖付款等一系列功能。该小程序第一次打开就先用户直接要求用户绑定信息和地址考虑到线下门店都会有一定的店员辅助。所以该小程序的绑定操作实际上用户都是可以接受的。图片如下所示。技术要点技术1： 使用自定义导航栏让头部可以配置全局配置\"window\": {  \"navigationStyle\": \"custom\"}如果微信 app 的版本在 7.0.0之上我们就可以使用页面级别的配置了。{  \"usingComponents\": {},  \"navigationStyle\": \"custom\"}该配置默认时default当使用custom时候可以自定义导航可以在头部配置 loading。第二种这个需要 app 版本所以如果是想简化反而在全局下定义再使用微信官方的组件 avigation-bar 即可。技术2：使用小程序骨架屏骨架屏方案在后端不能很快给与前端数据时候采用这种方案亦或者前端可以使用 Service Worker 把上次缓存数据返回到前端等到从后端获取数据之后刷新页面也是一种方案但是因为这是第一次打开小程序所以采用骨架屏是一个很好的方法。采用 小程序骨架屏 组件如果不需要骨架屏动画效果可以试试直接加载图片作为骨架屏。惰性绑定类该类小程序在展示时无需绑定用户信息但是当用户进行操作时在询问绑定。常用于线上商城等一系列无需专人引导的用户项目。功能介绍基本上线上大部分 c 端小程序都采用此做法功能上倒是没什么可以介绍的但是实践上却有不同做法。实践方式方式 1: 页面跳转 (京东购物)在每个需要绑定的按钮上添加跳转逻辑如果当前小程序没有绑定可以跳转到另外一个页面上确认授权。方式2: 按钮控制 (华为商城+)在每个需要绑定按钮上添加 open-type='getuserinfo'后续可以根据状态变化切换掉按钮(也可以不切换因为第二次绑定数据不会跳出组件)。方式3: 遮罩层拦截 (抽奖助手)在需要绑定的页面添加一个 透明模态框增加以整个页面大小的button。用fixed布局还可以向下滚动。无论在当前页面点击任何地方都会出现需要绑定选项。组件代码：// wxml<view style=\"z-index: {{zIndex}}\" class=\"mask\">  <button open-type=\"{{ openType }}\"          bindtap=\"onClick\"          bindgetuserinfo=\"bindGetUserInfo\"          bindgetphonenumber=\"bindGetPhoneNumber\"          bindopensetting=\"bindOpenSetting\"          binderror=\"bindError\"          class=\"mask\"/></view>// wxss.mask{  position: fixed;  top: 0;  bottom:0;  left:0;  right:0;  background-color: inherit;  opacity: 0;}然后在绑定后令 mask 消失。该方案初看起来不是那么的合适但是仔细想想却也没什么问题因为用户99%可能点击所需求的按钮就算点击到按钮之间的空隙之处跳出要求绑定也没有什么问题。上面方式实际上都没有太大的问题需要在不同场景下做最合适的选择。结语人机交互功能是决定计算机系统“友善性”的一个重要因素。读书学习时候要先把书读厚再把书读薄做程序也是一样如何把系统做的复杂而更加复杂如何让用户的体验简单而更为简单都不是那么容易的一件事。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w骅笙21                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信严控学习类产品“打卡”               微信小程序之SelectorQuery                                                        原作者: jump__jump                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "腾讯在线教育小程序开发实践之路 ", "author": "                  Rolan                  2019-7-2 00:08                ", "text": "                                                                                                                                                                                     作者于2019年6月21日赴北京GMTC大前端技术会议小程序专场分享话题《腾讯在线教育小程序开发实践之路》演讲稿一、腾讯在线教育小程序矩阵首先介绍下腾讯在线教育下的3个主要业务：面向成人职业化兴趣化学习的腾讯课堂面向小学初高中k12领域的企鹅辅导面向少儿英语学习的ABCmouse每个业务下都有PC Web,客户端,H5,APP这几端来满足学生的多端上课需求。但由于教育的前身是基于QQ群视频孵化出来的后续也是围绕QQ生态去搭建产品形态所以在流量上面QQ相关的流量占比较多。我们希望能够通过小程序生态来为教育业务带来微信端流量的增长并且优化学生的微信端上课体验所以我们打造了在线教育的小程序矩阵。我们通过工具内容型的小程序来获取流量。比如腾讯课堂打开小程序腾讯微课堂企鹅速算口语拼读等工具型小程序并最终转化到平台小程序上。二、小程序基础架构设计及工程化探索上面提到的那么多小程序我们是如何进行框架选型 以及团队在多人协作的开发中是如何制定统一的开发规范小程序工程化的探索呢？下面将一一介绍。框架选型时我们对小程序几大主流开发框架taro, wepy, mpvue跟原生开发框架进行了对比。可以看出原生框架在CSS预处理多端复用管理自动构建这几块能力对比其他框架是欠缺到。但考虑到以下几点我们比较倾向于使用原生框架进行开发：小程序的特性更新迭代速度较快我们希望能最快使用上最新特性其他第三方框架可能会有迭代滞后到问题我们的多端复用需求较弱对性能调优问题排查要求较高希望直接操控原生API那么以上这些开发上的缺陷使用原生框架是否可以解决如何解决呢？1CSS预处理首先来看CSS预处理我们是期望能够在小程序中使用到CSS预处理包括嵌套语法mixin变量等以及styleLint等工具。 经过调研后我们可以直接使用postcss来写样式文件并编译处理成wxss。并且通过引入插件可以解决小程序样式开发中的痛点。比如postcss-url解决background-image不支持本地图片问题将其变成base64格式；通过postcss-font-base64插件将字体变成base64格式。2数据管理数据管理方面可以使用westore来接入。3构建小程序的构建需要完成什么事情呢？小程序开发者工具已经提供了部分能力: ES7/ES6转ES5NPM包管理代码分包组件化打包合并。我们借助gulp来实现图片压缩以及前面提到的Post CSS编译为什么使用gulp而不用更流行的webpack呢?这里补齐的能力主要涉及文件处理比较多使用gulp开发效率较高小程序一些官方脚手架也是使用gulp。最后我们选择了小程序原生框架作为我们的开发框架。并且补齐了跟其他开发框架对比欠缺的基础能力。当然这里并非说其他框架不好具体选择还是需要看具体的业务场景。确定好开发框架后统一的目录规范也是团队协同开发必须约束的。在引入npm包管理后我们在小程序的基础目录中通过新起了一个miniprogram目录来作为小程序代码的根目录。这是由于小程序会对node_modules里面的包打包编译到miniprogram_npm目录为了避免小程序的node_modules跟其他工程化相关的node_modules混在一起才新起了一个文件夹来存放小程序工程代码。可以通过修改project.config.js可以配置小程序代码的根目录路径。约束好目录那么在团队协同开发如何维护规范化风格统一的代码我们希望可以团队成员开发时可以统一代码规范, 提交规范, 风格保持一致。因此跟我们其他web项目一样我们可以使用 eslintstylelintcommitmentprettier等插件来对我们的代码进行约束规范。通过git hook来在做提交时的校验检测不通过则不允许提交。通过Commitizen以及standard-version来自动化生成统一的版本号以及ChangeLog。会自动将你在本次版本迭代中提交的规范化log（遵循Angular团队的commit规范： https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#commits )自动生成ChangeLog, 注明是特性发布bugfix还是breakingChange以及对应的log信息。后续我们在需要回滚或者回溯某一版本的改动时就可以一目了然。我们基于上面的能力以及约束规范做成统一的脚手架方便团队在统一的环境下快速开发并且开源了出去( https://github.com/imweb/generator-imweb-wxapp )。三、小程序开发实践介绍完我们的框架选型工程化探索接下去分享下在线教育小程序的开发实践经历。1小程序音视频第一部分是小程序音视频能力相关的实践。腾讯课堂是一个在线学习的平台那么最核心的就是音视频直播录播能力。那么在小程序上面我们如何搭建课堂音视频能力呢？1)直播场景我们先来看未接入小程序前腾讯课堂的直播架构。我们通过老师上行到云上再实时下行到端上, App学生以及通过WebRTC下行到PC web学生。对于延迟要求不高的场景我们可以将直播流旁路转码到CDN再供用户拉流观看以节省成本。这是各端使用的直播协议以及延迟对比小程序应该采用那种协议如何接入呢？揭秘之前我们先来了解下小程序音视频能力的发展历史。最初小程序音视频只有原生的video标签。意味着只能支持 HLS高延时直播场景。2017年4月份腾讯云与小程序达成合作在小程序上嵌入腾讯云音视频SDK并封装成了live-pusher,live-player标签,使小程序能够支持更低延迟的直播协议如：rtmp, http-flv等。因此我们可以使用live-player来播放rtmp,http-flv协议的流媒体来播放降低小程序直播场景上的延迟。不过目前live-player还存在一些不足:比如全屏按钮不支持需要自己定义。由于live-player是原生组件因此需要通过cover-view以及一些hack方式来实现自定义控制条的全屏按钮跟视频窗口显示层级的bugIOS全屏时bindevent无效 不过小程序后面采用同层渲染的方案解决了原生组件需要使用cover-view来解决显示层级问题使用最新版本的基础库即可。使用live-player大概1-2s的延迟那么小程序上还有没更低延迟的直播方案呢？加入你是在腾讯云上面开通了WebRTC后可以使用wbertc-room去实现小程序上更低延迟的直播。其原理是基于live-player的RTMP但走的高速专线不经过CDN降低了延迟。(小程序接入课堂音视频的整体架构图)2)录播场景介绍完直播接入方案接着讲下录播。由于版权保护腾讯课堂录播播放采用了加密HLS。由于录播对延迟没要求小程序上面可以直接使用video标签来播放加密hls流。在Web上播放加密HLS的流程如下：1获取到加密HLS的m3u8地址传给video;2浏览器video底层解析m3u8发现其带有加密协议标识-EXT-X-KEY其值是一个获取解密key的接口地址；3浏览器会自动发起该请求发起请求去获取解密key；4浏览器自动发起请求时会把用户登陆态通过cookie方式带上业务后台对cookie鉴权后返回解密key之后浏览器拿到解密key后就可以解密播放了。但在小程序中由于小程序是没有cookie的那么怎么去针对小程序发起的获取解密key请求鉴权呢？我们通过在获取m3u8文件时在meu8地址加入加密后的鉴权参数并加上前缀\"voddrm.token.\"这样server返回m3u8文件时会在EXT-X-KEY的请求地址上将鉴权参数拼接进去。后面发起请求时业务后台获取到鉴权参数按照协商好到方式解密即可获取到用户登陆票据进行判断是否合法用户。之后就按照之前的流程鉴权通过即返回解密key。2小程序自动化发布补齐了音视频能力后我们项目也正常上线。由于平台功能不断增加小程序也在按照以下流程进行迭代发布。但是上面流程是存在一些隐藏问题的特别对于新人容易因疏忽导致出错我们也因此导致了一个现网bug。不知道大家能发现不？揭晓下答案主要有2个问题：1多人开发过程npm包可能存在不同版本比如登录能力的npm包有可能会忘记更新最新包。2构建npm按钮在开发者工具上面入口比较隐蔽容易导致更新了npm包但是忘记点击构建npm覆盖了线上的特性 上面操作对于熟悉小程序开发的人来说不容易出错但对于新人由于不熟悉容易疏忽。即使犯错但概率很小但是也必须解决。 那么我们能否通过自动化工具来帮我们校验检测这些隐患呢？我们希望在上传发布前可以进行以下流程的自动检测：1代码合并主干检测2node_modules版本检测必须是大于或者等于当前package.json的版本3自动执行构建npm操作4自动执行上传操作包括填写版号以及备注信息其中1跟2可以通过githook以及npm命令来判断3跟4涉及到小程序相关到能力调用是否有暴露相关到接口可以调用呢？这里小程序开发者工具提供了命令行以及http调用方式（ https://developers.weixin.qq.com/miniprogram/dev/devtools/cli.html）可以让你操作项目打开/关闭代码上传预览构建npm , 自动化测试等功能。因此我们利用这个能力采用cli调用等方式实现了构建npm以及自动发布等能力。具体流程如下：1进行是否更新最新主干代码检测；2判断是否安装了小程序开发者工具且正常设置到环境变量；3进行本地node_modules版本检测；4调用构建npm命令；5自动获取package.json的版本号作为上传版本获取git 提交log作为备注； 6调用上传命令进行上传自动化发布流程示例3小程序第三方平台有了以上工具后我们就可以愉快地进行开发迭代发布了。但随着我们课堂平台小程序的推广课堂平台的各家机构都想拥有其自己的机构小程序并且其页面是课堂平台小程序的一个子集。通过分析后我们决定通过构建的方式从平台小程序中拆离出机构小程序代码。通过2份模版配置信息, 通过构建可以动态生成平台小程序以及机构小程序的app.json。这样进行上传的时候就只会上传对应的页面。代码复用的问题解决了但随着而来还有另外一个问题。需要生成的机构有80多家有些机构不一定有开发人员如果帮助机构快速上传发布他们自己的机构小程序呢？这里引入微信第三方平台的概念（ https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&t=resource/res_list&verify=1&id=open1489144594_DhNoV&token=&lang=zh_CN ）我们可以往微信开发平台申请成为第三方平台。机构申请完独立的小程序账号后将其授权给我们腾讯课堂第三方平台。这样我们就可以获取到该机构到代码管理版本发布到权限。通过上传我们之前构建好到机构小程序模版再调用发布接口就可以快速实现帮助机构发布其独立个体到机构小程序了。4性能优化实践我们的小程序上线后通过在小程序管理后台看到的启动总耗时发现几个问题： 1小程序管理后台只展示了启动总耗时下载耗时渲染耗时这3个数据纬度但是启动总耗时!= 下载耗时 + 渲染耗时；2启动耗时居然达到了3.8s这是一个合格都数据吗？除了下载耗时跟渲染耗时其他耗时消耗在哪个环节呢？要想知道耗时消耗在哪里首先要先了解小程序启动过程中究竟发生了什么。1 小程序初始化在这个步骤微信会初始化小程序环境比如逻辑层的js引擎视图层的WebView并且注入公共基础库。2下载小程序代码包这里会进行业务小程序代码包的下载。3加载业务代码包对下载完成对代码包进行注入执行 - 小程序的代码会被加载到适当的线程中执行。此时所有app.js、页面所在的JS文件和所有其他被require的JS文件会被自动执行一次小程序基础库会完成所有页面的注册。4初始化小程序首页拉取数据从逻辑层传递到视图层生成VD树进行渲染。了解完小程序的启动过程后我们经过分析定位个阶段耗时如上图所示。其中灰色部分是小程序底层的执行耗时这块开发者是无法操控的。那在其他耗时中下载代码包这块占比比较高。我们能怎么去减少这块耗时呢？原先对课堂小程序的所有页面都是在一个包里面那么这里我们采用分包方案。将主tab的3个页面以及util, 常用组件这种公共模块放在主包。其他每个页面单独分成300-500k左右大小对子包子包可以引用主包对公共模块。经过分包处理后下载代码包对耗时减少了500ms左右整体启动耗时降到了3.2s。整体来说已经比小程序大盘平均启动耗时4.5s少了1.3s。不过随着而来的也有其他问题的引入比如从首页打开课程详情页这一场景。这个时候点击详情页时需要先下载完详情页分包才能打开课程详情页显然这样的体验是极差的。我们可以通过分包预加载的方案来解决这个问题。打开首页加载完主包后可以静默加载其他分包通过配置preloadRule即可实现分包预加载。下面是一组本地测试数据可以看到使用分包以及分包预加载的方案可以减少启动耗时以及提高用户体验。除了普通分包方案小程序还有独立分包的方案。不依赖主包加载即可打开分包页面。常用于一些比较独立的页面比如活动页等。但使用独立分包也有一些限制：独立分包无法引用主包或其他分包的资源全局App对象只能在主包定义独立分包不能使用App对象生命周期只能通过：wx.onAppShow, wx.onAppHide来监听解决了代码包下载的耗时以及采用分包以及分包与加载提高页面打开性能以及效率。我们接下来看渲染耗时这块。这是一个典型但小程序双线程通信的模型。每次调用setData方法都会将数据从逻辑层传递到native层再到渲染层形成VD树进行渲染。以上是setData传输数据量以及传输时间的关系图可以看到当数据量大于64kb时传输时间呈指数级增长。因此在使用setData时应该尽量遵循以下建议：不要频繁调用setData, 尽量合并到一次setData调用传输数据量跟通信性能有关尽量少于64k避免一些不需要在页面展示的复杂数据结构或者长字符串与界面无关的数据最好不要设置在data中去掉不必要的事件绑定减少通信的数据量以及次数不要在节点data前缀放置过大数据（需要传输target的currentTarget和dataset）5公共基础组件库为了提高开发效率代码复用率我们对常见的一些能力以及功能型组件进行了封装（后续计划开源）。这里拿基础能力的request组件来看我们基于wx.request来封装利用storage来存储登陆后的cookie信息并在后续发起请求的时候将登陆票据设置到请求头中。采用可插拔插件式封装方法来做各种插件到扩展。例如有loading插件一个可以在发起请求的时候自动显示loading请求完成后自动隐藏的插件。以上就是小程序开发实践相关的分享。四、QQ小程序QQ小程序是一个基于手Q庞大流量面向年轻化群体跟随小程序行业标准的小程序平台。启动于18年12月份并于6月底全量发布目前覆盖微信小程序API达到了95%以上。从用户侧来看基本跟微信小程序类似。在聊天下拉即可发现小程序入口里面有小程序商城可发现各类小程序以及小游戏。它的开发者工具的UI也类似微信开发者工具。它跟微信小程序之间有以下的一些区别：API以及功能方面调用前缀：例如：qq.getSystemInfoSync (也兼容wx语法) 覆盖率95%webview: QQ小程序暂不支持webview唤起方式：支持http链接唤起小程序组件：不支持live-player, live-pusher组件分享：QQ小程序支持分享到QQ空间开发者工具方面底层框架：都是基于nw.js编译能力：不支持增强型编译不支持多核心编译其他不支持体验评分不支持自动化测试总的来说QQ小程序的API基本对齐微信小程序它的迭代速度较快能力逐渐补齐中。并且拥有QQ生态流量红利最重要的是从微信小程序迁移到QQ小程序工作量较小代码95%以上基本可以复用。总结小程序生态发展之迅速支付宝百度等各大厂商都在各自研发自己的小程序。从开发者的角度来说希望能够统一一套API规范形成行业标准。前不久W3C中文兴趣组也在对小程序的生态进行了规范的相关讨论相信后续必然会朝着标准化的方向发展。以上便是此次在线教育小程序开发实践之路的分享可以通过下方的二维码关注IMWeb团队的公众号以及个人的公众号。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序技术演进史               微信小程序-麦当劳点餐+爬虫                                                        原作者: IMWeb社区                   来自: IMWeb社区                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序的getElementsById，就像一把梭 ", "author": "                  Rolan                  2019-12-24 00:52                ", "text": "                                                                                                                                                                                     使用selectComponent可以抓取自定义组件实例对象但在层层嵌套结构的业务场景中id的设置繁复js/wxml开发界面频繁的切换查找、维护、调整的开发工作很是让人抓狂啊好想封装一个getElementsById方法给小程序像在web开发中那样能够方便的获取页面元素。在父子子子子级间轻松调用好想念jquery开发的一把梭时代！实现如下需求：任何绑定id的自定义组件都能够方便抓取实例对象(任何嵌套层级均可调用)通过数据配置思路实现不难我们可以将所有自定义组件在create生命周期方法时将\tthis 挂载到一个全局变量中\tdetached 生命周期时销毁该实例(不然爆内存)实现准备一个全局变量app._elements = {}复制代码挂载/销毁方法一个全局的挂载、销毁方法方便将实例对象注册、注销在app._elements上app.mount = function(id, context){    app._elements[id] = context}app.unmount = function(id){    app._elements[id] = null}复制代码getElementsById定义全局\tgetElementsById 在Page中能够方便调用app.getElementsById = function(id){    let res = app._elements[id]    if (!res) {  // 兼容selectComponent        return wx.selectComponent('#'+id) || wx.selectComponent('.'+id)    }    return res}复制代码自定义组件ui-component组件const app = getApp()Component({  options: {    multipleSlots: true, // 在组件定义时的选项中启用多slot支持    addGlobalClass: true  },  properties: {    dataSource: {      type: Object,    },  },  data: {},  behaviors: [],  lifetimes: {    created: function() {    },    attached: function() {        this.id = this.data.dataSource.$$id  // 专用$$id来指定唯一名称    },    ready: function() {        app.mount(this.id, this)    },    detached: function(){        app.unmount(this.id)    }  },  methods: {      active(clsName){          /* do something */      }  })复制代码应用下面开始在Page中使用\tgetElementsById 来抓取自定义组件实例wxml<ui-component dataSource=\"{{config}}\" />复制代码jsPage({    data: {        config:  {            $$id: 'component-id',            title: 'some text'        }    },        onReady(){        // 我们应该在onReady中来调用onLoad时页面组件结构并没有渲染完成          const $ele = app.getElementsById('component-id')        $ele.active('.active')     }})复制代码至此基本思路已经实现现在即兼容了selectComponent方法又简化了写模板id的麻烦。不知道大家有没有了解小程序组件是可以递归嵌套自己的(模板不能递归嵌套)。因此聪明的你应该可以想到通过数据嵌套去实现组件嵌套进而实现结构嵌套这样我们就能够实现很复杂的页面结构当然小程序目前建议是结构应该在30层左右然并卵反正它能够正常显示哈哈                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    【微信小程序】写一个能自定义尺寸、样式的switch               xquery小程序简易步进器                                                        原作者: 天天修改                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序同构方案 kbone 分析与适配 ", "author": "                  Rolan                  2019-12-4 00:23                ", "text": "                                                                                                                                                                                     在微信小程序的开发的过程中我们会存在小程序和 H5 页面共存的场景而让小程序原生和 web h5 独立开发往往会遇到需要两套人力去维护。对开发者而言加大了工作量成本对于产品而言容易出现展示形态同步不及时问题。在这种情况下我们急需要找到一个既能平衡性能也能满足快速迭代的方案。主流的小程序同构方案web-view 组件webview 组件是一个承载网页的容器最简单的方案就是使用原 h5 的代码通过 web-view 组件进行展示。其优点是业务逻辑无需额外开发与适配只需要处理小程序特有的逻辑然后通过 jssdk 与原生小程序通讯。使用 webview 加载 h5 的问题也非常明显首先是体验问题用户见到页面会经过以下环节：加载小程序包初始化小程序再加载 webview 中的 html 页面然后加载相关资源渲染 h5 页面最后进行展示。最终导致的结果是打开体验非常差。另外其他缺点是小程序对 web-view 部分特性有限制比如组件会自动铺满整个小程序页面不支持自定义导航效果等。静态编译兼容静态编译是最为主流的小程序同构方案类似的有 taro, mpvue 等。其思路是在构建打包过程把一种结构化语言转换成另一种结构化语言。比如taro 把 jsx 在构建时进行词法分析解析代码获取 AST然后将 AST 递归遍历生成 wxml 目标代码。静态编译的好处是非常明显一套代码通过编译分别转 h5 和小程序兼具性能与跨平台。另一方面随着这种方案的流行大家也感受到了其明显的问题首先由于小程序本身的限制比如无法 dom 操作js 与 webview 双线程通信等导致静态编译语法转换不能做到彻底的兼容开发体验受制于框架本身的支持程度相信踩过坑的同学应该非常有痛的感悟。其次静态编译转换逻辑需要与小程序最新的特性保持同步不断升级。小程序运行时兼容方案静态编译的方案实现了同构但它只是以一种中间态的结构化语法去编码非真正的 web牺牲了大量的灵活性。另外一种更灵活的方案运行时兼容应值得去尝试。小程序原理我们回到小程序本身的限制上来。由于小程序采用双线程机制内部通过一个 webview 用于承载页面渲染但小程序屏蔽了它原本的 DOM/BOM 接口自己定义了一套组件规范；另一方面使用独立的 js-core 负责对 javascript 代码进行解析让页面和 js-core 之间进行相互通信（setData）从而达到执行与渲染的分离。而浏览器的 DOM 接口是大量 web 得以显示的底层依赖这也是 h5 代码无法直接在小程序中运行的主要原因。那么如何突破小程序对接口 DOM 的屏蔽呢？ 最直接的思路就是用 JS 实现和仿造一层浏览器环境的 DOM 相关的标准接口让用户的 JS 代码可以无感知的自由操作 DOM。通过仿造的底层 DOM 接口web 代码执行完后最终生成一层仿造的 DOM 树然后讲这棵 DOM 树转换成小程序的 wxml 构成的 DOM 树最后由小程序原生去负责正确的渲染出来。kbonekbone 是微信官方出一套小程序运行时兼容方案目前已经接入的小程序有小程序官方社区及腾讯课堂新人礼包等。并且有专人维护反馈及时。kbone 方案核心主要有两大模块第一是 miniprogram-render 实现了对浏览器环境下 dom/bom 的仿造构建 dom 树及模拟 web 事件机制。第二个模块是 miniprogram-element 是原生小程序渲染入口主要监听仿造 dom 树的变化生成对应的小程序的 dom 树另外一个功能是监听原生小程序事件派发到仿造的事件中心处理。DOM/BOM 仿造层DOM、BOM 相关的接口模拟主要是按照 web 标准构建 widow、document、node 节点等相关 api思路比较清晰我们简单看下其流程。首先在用户层有一个配置文件 miniprogram.config里面有必要信息 origin、entry 等需要配置。在 miniprogram-render 的入口文件 createPage 方法中配置会初始化到一个全局 cache 对象中然后根据配置初始化 Window 和 Document 这两个重要的对象。Location、Navigator、Screen、History 等 BOM 实例都是在 window 初始化过程中完成。DOM 节点相关 api 都是在 Document 类中初始化。所有生成的节点和对象都会通过全局的 pageMap 管理在各个流程中都能获取到。小程序渲染层miniprogram-element 负责监听仿造 DOM 仿造的变化然后生成对应小程序组件。由于小程序中提供的组件和 web 标准并不完全一样而我们通过 html 生成的 dom 树结构千差万别如和保证任意的 html dom 树可以映射到小程序渲染的 dom 树上呢？kbone 通过小程序自定义组件去做了这件事情。简单说下什么是自定义组件既将特定的代码抽象成一个模块可以组装和复用。以 react 为例div、span 等标签是原生组件通过 react.Component 将 div 和 span 组合成一个特定的 react 组件在小程序中用自带的 view、image 等标签通过 Component 写法就能组合成小程序自定义组件。和大部分 web 框架的自定义组件类似小程序自定义组件也能够自己递归地调用自己通过将伪造的 dom 结构数据传给自定义组件作为子组件然后再递归的调用直到没有子节点为止这样就完成了一个小程序 dom 树的生成。性能问题多层 dom 组合大量小程序自定义组件会有额外的性能损耗kbone 在实现时提供了一些优化。其中最基本的一个优化是将多层小程序原生标签作为一个自定义组件。dom 子树作为自定义组件渲染的层级数是可以通过配置传入理论上层级越多使用自定义组件数量越少性能也就越好。以上逻辑就是通过 DOM_SUB_TREE_LEVEL 层级数对节点过滤更新后检测是否还有节点再触发更新。节点缓存在页面 onUnload 卸载的过程中kbone 会将当前节点放入缓存池中方便下次初始化的时候优先从缓存中读取。kbone 接入与适配kbone 作为一种运行时兼容方案适配成本相对于静态编译方案而言会低很多总体来说对原代码侵入性非常少目前接入过程比较顺利（期间遇到的坑感谢 作者 june 第一时间帮忙更新发布 [玫瑰]）svg 资源适配小程序不支持 svg对于使用 svg 标签作为图片资源的应用而言需要从底层适配。在一开始我们想到的方案有通过 肝王的 cax 进行兼容但评估后不太靠谱cax 通过 解析 svg 绘制成 canvas大量 icon 会面临比较严重的性能问题。那么最直接暴力的办法就是使用 webpack 构建过程直接把 svg 转 png？后面一位给力的小伙伴想到通过把 svg 标签转成 Data URI 作为背景图显示最终实践验证非常可靠具体可以参考 kbone svg 适配。网络层适配/cookie微信小程序环境拥有自己定义的一套 wx.request API web 中的 XMLHttpRequest 对象是无法直接使用。由于我们代码中使用了 axios所以在预言阶段直接简单通过 axios-miniprogram-adapter 进行适配器后面发现部分业务没有使用 axios兼容并不够彻底。于是直接从底层构建了一个 XMLHttpRequest 模块将 web 网络请求适配到 wx.request。同时做了 cookie 的自动存取逻辑适配（小程序网络请求默认不带 cookie）。这一层等完善好了看是否能 pull request 到 kbone 代码仓库中。差异性 DOM/BOM API 适配部分 web 中的接口在小程序无法完全获得模拟比如 getBoundingClientRect 在小程序中只能通过异步的方式实现。类似的有 removeProperty、stopImmediatePropagation等接口在 kbone 中没有实现performance 等 web 特有的全局变量的需要兼容。这些扩展 API 可以通过 kbone 对外暴露的 dom/bom 扩展 API 进行兼容。getBoundingClientRect对于元素的的高度 height \\offsetHeight 获取我们只能通过 $getBoundingClientRect 异步接口如果是 body scroll-view 实现的getBoundingClientRect 返回的是 scrollHeight。滚动web 的全局滚动事件默认是无法触发需要通过配置 windowScroll 来监听启用这个特性会影响性能。global: {    windowScroll: true},样式适配标签选择器kbone 样式有一个坑就是它会将标签选择器转换成类选择器去适配小程序环境比如span { } =>  .h5-span{  }这样带来的副作用就是选择器的权重会被自动提升对选择器权重依赖的标签样式需要去手动调整兼容。其他适配点注意使用标准的 style 属性比如有 webkit-transform 会不支持及小程序样式和 web 差异性兼容等。  style: {      'WebkitTransform': 'translate(' + x + 'px, 0)' // 正确     // '-webkit-transform': 'translate(' + x + 'px, 0)' 报错  }路由适配在初始化路由阶段曾经遇到过 Redux 更新 dom 后偶现节点销毁最终定位到是 kbone 对 Location 等 BOM 实例化过晚最终在 june 帮忙及时调整了顺序更新了一个版本现最新本所有 BOM 对象会在业务执行前准备好。//初始化domthis.window.$$miniprogram.init()...//初始化业务init(this.window, this.document)隐式全局变量兼容在模拟 XMLHttpRequest 模块的过程中遇到一个问题什么时候初始化这个对象我们可以选择在网络请求库初始化前引入它挂载在仿造的 window 对象下。但仍然会出现一个问题第三放库直接使用的是 XMLHttpRequest 对象而非通过 window 访问。var request = new XMLHttpRequest() // 报错 var request = new window.XMLHttpRequest() // 正确在正常的 web 环境window 是默认的顶层作用域而小程序中隐式的使用 window 对象则会报错。为了解决这一问题可以通过配置文件的 globalVars 字段将 XMLHttpRequest 直接进行定义。 globalVars: [    ['XMLHttpRequest', 'require(\"libs/xmlhttprequest.js\")']]构建的过程中会在所有依赖前转成如下代码 ： var XMLHttpRequest = require(\"libs/xmlhttprequest.js\")这样做解决了隐式访问 window 作用域问题。但又面临另一个问题那就是 xmlhttprequest 模块本身内部由依赖仿造 window 对象比如 cookie 访问而此时因为 require 的模块独立的作用域无法访问到其他模块的仿造 window 对象。于是最终通过导入一个 function 传入 window 作用域然后初始化 xmlhttprequest。  globalVars: [      ['XMLHttpRequest', 'require(\"libs/xmlhttprequest.js\").init(window, document)']]多端构建小程序和 web 端需要的资源及部分逻辑是有差异通过 webpck 配置进行差异化处理具体可以参考文档编写 kbone webpack 配置。大概是这样的区分跨端配置：分离打包入口文件:小程序打包入口依赖的 dom 节点需要主动创建。详细示例参照官方 demo.export default function createApp() {    initialize(function() {        let Root = require('./root/index').default;         const container = document.createElement('div')        container.id = 'pages';        document.body.appendChild(container);        render(<Root />, container)    })}由于小程序本身是没有真正 userAgentkbone 内部是是根据当前环境进行仿造。//miniprogram-render/src/bom/navigator#45this.$_userAgent = `${this.appCodeName}/${appVersion} (${platformContext}) AppleWebKit/${appleWebKitVersion} (KHTML, like Gecko) Mobile MicroMessenger/${this.$_wxVersion} Language/${this.language}`在业务中有需要区分小程序平台的场景我们可以通过 webpack DefinePlugin 插件进行注入然后通过定义变量进行判断。if (!process.env.isWxMiniProgram) {    render(        <Root />,        document.getElementById('pages')    );}小程序分包在腾讯文档的小程序中有一个独立的小程序仓库。 而文档管理列表是另外一个独立的 H5 项目嵌入到小程序 webview 动态加载。通过 kbone 转原生打包后这部分代码需要继承到小程序仓库中。首先我们可以通过脚本在 webpack 构建过程将 kbone 编译后的包 copy 到独立小程序仓库的目录下合并小程序相关配置从而实现功能合并。这样遇到的一个问题是主包大小超过限制通过小程序分包我们可以解决这个问题将原小程序非首屏页面全部放分包之中配置 preloadRule 字段再预加载分包。\"subpackages\": [    {      \"root\": \"packageA\",      \"pages\": [        \"pages/cat\"      ]    }  ]  \"preloadRule\": {    \"pages/index\": {      \"network\": \"all\",      \"packages\": [\"important\"]    }  }结通过对目前各种小程序同构方案的对比与实践kbone 是一种非常值得推荐的新思路新方法兼具性能与灵活。唯一不足的地方就是目前仍有不少底层工作需要适配更多的问题在继续探索中相信随着不断迭代及采坑后的反馈kbone 会变得越来稳定和成熟                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    用云开发制作教务助手小程序丨实战               京喜首页（微信购物入口）跨端开发与优化实践                                                        原作者: Tencent AlloyTeam                   来自: alloyteam                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "当微信小程序遇上filter~ ", "author": "                  Rolan                  2019-11-6 00:32                ", "text": "                                                                                                                                                                                     在微信小程序的开发过程中当你想要实现不同页面间的数据绑定却为此抓耳饶腮时不妨让微信小程序与filter 来一场完美的邂逅相信会给你带来别样的惊喜~前段时间被安利了一个很实用的公众号—前端早读课它简洁、大方的页面和方便、实用的功能深深地吸引着我~(＾Ｕ＾)ノ 恰好这段时间学了小程序就自己仿着写了个前端早读课的小程序。实现的功能不同页面间的数据绑定随机显示数组里的元素实时显示系统的日期鼠标点击和页面跳转等基本功能swiper组件和template样式模板的使用使用easy mock模拟后台数据并进行动态传参项目展示整个项目包括“每日一看”、“看看世界”、“情报局”和“介绍”四个主页面。完美邂逅~在开发“每日一看”页面的过程中我遇到了一个难题如何将“每日一看”页面中获取的数据与阅读详情页的数据绑定起来也就是从这时起微信小程序开始邂逅filter~下面简单介绍一下filter~filter华丽登场~filter 是一个基于数组的方法通过一个回调函数对数组进行筛选并返回数组中满足条件的元素相当于过滤器的效果。filter的三要素数组对象(arry)每个filter 方法都有一个数组对象通过该方法对数组里的元素进行筛选。 具体用法： arry.filter();回调函数(callbackfn)对于数组中的每个元素filter 方法都会调用callbackfn 函数一次。 具体用法： function callbackfn(value, index, array);其中 value 表示数组元素的值index 表示数组元素的下标 array 表示包含该元素的数组。返回值filter 方法的返回值是一个数组包含所有满足回调函数条件的值。更多详情： filter文档别样的惊喜~filter的骚操作—实现数据的动态绑定敲黑板的重点来啦！！！在 dairy.wxml 页面中用 navigator 组件实现 ‘每日一看’ 页面和 ‘阅读详情’ 页的跳转并传递一个 id 参数每篇文章都有唯一的一个 id这样就可以通过 js 使用 filter 过滤器筛选出两个 id 相等的文章数据也就实现了数据的动态绑定。<navigator url=\"./detail/detail?id={{id}}\">    <button class=\"page_bd_motto_read\">阅读</button></navigator>在 dairy.js 中因为页面每次都是随机显示一篇文章这时就需要获取该文章的id并作为参数当页面跳转时作为一个钩子把两个页面联系起来。that.setData({            headline: arr[index].headline,            from: arr[index].from,            // 设置id作为阅读详情页的一个钩子            id: arr[index].acticle_id          })        }      })当页面跳转到详情页时在 detail.js 中使用 filter 把 acticle_id 等于上一页面文章 id 的数据赋值给 datas再对其进行操作就实现了数据的动态绑定。Page({  data: {    // 表示该篇文章    item: []  },  onLoad: function(params) {    // 检验id是否传递成功    console.log(params.id);    var that = this;    wx.request({      url: 'https://www.easy-mock.com/mock/5a2b5f76158e7b70032804d0/getActicleInfo/getActicleInfo',      success: function(res) {        // 使用过滤器把id等于上一页面id的数组赋值给datas        var datas = res.data.data.acticle_List.filter(item => {          return item.acticle_id == params.id;        });        that.setData({          item: datas        });        console.log(datas);      }    })  }})在 detail.wxml 中对传入的 item 数据进行调用于是别样的惊喜就出现啦~<!--pages/dairy/detail/detail.wxml-->    <view class=\"page__hd\">        <view class=\"page__hd_title center\">{{item[0].headline}}</view>        <view class=\"page__hd_author\">作者：@{{item[0].author}}</view>    </view>    <view class=\"page__bd\">        <text class=\"page__bd_content center\">{{item[0].content}}</text>    </view>特别注意： 可能有细心的人儿已经发现为什么这里用的是 item[0]. 来调用而不是 **item.**来调用这是数据索引的问题。如下图所示我的数据是个三级结构item 表示的是最外层的文章数组元素要获取文章的作者或标题等信息必须使用 item[0]. 才能进行调用。只有理解数据索引的本质才能准确地调用数据。于是小程序在遇上filter后就创造出了别样的惊喜 O(∩_∩)O~一起排坑~在开发过程中遇到了一些坑在此总结一下~1. 随机显示数组里的元素这个公众号一大亮点就是可以随机显示文章每次点进去的文章都不一样感受度极佳。这里采用随机函数来获取数组的下标Math.random()函数是获取[0,1)之间的数Math.floor()函数是向下取整这样就可以随机获取相应的下标数。 onLoad: function () {    var that = this;      wx.request({        url: 'https://www.easy-mock.com/mock/5a2b5f76158e7b70032804d0/getActicleInfo/getActicleInfo',        method: 'GET',        data: {},        success: function(res) {          //获取文章数据的列表          var arr = res.data.data.acticle_List;          //用随机函数随机获取数组的下标          var index = Math.floor(Math.random()*arr.length);          // console.log(arr[index].acticle_id);          that.setData({            headline: arr[index].headline,            from: arr[index].from,            // 设置id作为阅读详情页的一个钩子            id: arr[index].acticle_id          })        }      })  },})2. 实时显示系统的日期之前开发的时候觉得这个方法如果自己写还蛮难的后面百度了一下发现js里面提供了相应的API直接使用就好特别方便。有关系统时间的API  //监听页面显示  // day：星期几  // date：某日  // month：月份  onShow: function () {      var myDate = new Date();      // setData设置或更新数据      this.setData({        date: myDate.getDate(),        month: myDate.getMonth() + 1,        day: week(),      });      function week(day) {          switch(myDate.getDay()) {            case 1: day=\"星期一\"; break;            case 2: day=\"星期二\"; break;            case 3: day=\"星期三\"; break;            case 4: day=\"星期四\"; break;            case 5: day=\"星期五\"; break;            case 6: day=\"星期六\"; break;            default: day=\"星期天\";          }          return day;        }  },3. 用hover实现鼠标点击效果在对首页进行鼠标点击效果的开发过程中一开始想到的就是使用伪元素来添加点击按钮的样式效果后面出现了一个bug当我点击按钮跳转到另一个页面再回退到原页面时还是处于点击态的样式这时百度就起了很大的作用我上网百度了很久才发现有hover属性中的hover-stay-time为动画持续的时间hover-class 为定义点击按钮时的样式于是这个bug就解决啦~<view class=\"page__bd\">    <view class=\"page__bd_tab\" hover-class=\"active\" hover-stay-time=\"2000\">      <view class=\"page__bd_tab_item\" hover-class=\"active1\" hover-stay-time=\"2000\" bindtap=\"dairyRead\">每日一看</view>      <view class=\"page__bd_tab_item\" hover-class=\"active1\" hover-stay-time=\"2000\" bindtap=\"lookWorld\">看看世界</view>      <view class=\"page__bd_tab_item\" hover-class=\"active1\" hover-stay-time=\"2000\" bindtap=\"intelligence\">情报局</view>      <view class=\"page__bd_tab_item\" hover-class=\"active1\" hover-stay-time=\"2000\" bindtap=\"introduction\">简介</view>    </view>  </view>4. 页面左右滑动的效果使用swiper组件实现对页面的左右滑动的效果。5. template 模板样式的使用当一串代码面临复制粘贴时这时就应该考虑对其进行封装这样直接在不同的地方调用就好了也完成了代码的优化。小程序中的 template 模板就很好地帮我们解决了这个问题并通过 is 属性来实现调用。template 模板的定义：<!--pages/common/list_intelligence/list_intelligence.wxml--><template name = \"intelligence_list\"> <view class=\"page__cell\">    <view class=\"page__cell_headline center\">        <view class=\"page__cell_headline_img\">            <image src=\"{{avatar}}\"/>        </view>        <view class=\"page__cell_headline_author\">{{author}}分享于</view>        <view class=\"page__cell_headline_time\">{{share_time}}</view>    </view>    <view class=\"page__cell_detail center\">{{content}}</view> </view></template>template 模板的调用：  <view class=\"page__bd\">    <block wx:for=\"{{intelligence_list}}\" wx:key=\"{{index}}\" center >        <template is=\"intelligence_list\" data=\"{{...item}}\"></template>    </block>  </view>  我有话要说~开发的过程中难免会出现各种各样的bug记得一定要百度百度百度呀！！！这是个独立思考的过程对能力的提高也非常有帮助~做这个项目最大的心得便是看太多不如干一场肯定会干货满满收获满满哟~这个小程序后续还会完善感兴趣的可以持续关注哟(＾Ｕ＾)ノ~一波安利~微信小程序开发教程手册微信小程序官方开发文档使用 easy-mock 构造后台虚拟数据使用微信开发者工具进行开发                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序的双线程模型               在小程序中自定义弹窗组件                                                        原作者:  白眉少侠                    来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序之图片懒加载 完美方案，你不来看看？ ", "author": "                  Rolan                  2018-9-10 00:12                ", "text": "                                                                                                                                                                                     效果图既然来了把妹子都给你。定义懒加载前端人都知道的一种性能优化方式简单的来说只有当图片出现在浏览器的可视区域内时才设置图片正真的路径让图片显示出来。这就是图片懒加载。实现原理监听页面的scroll事件,判读元素距离页面的top值是否是小于等于页面的可视高度判断逻辑代码如下element.getBoundingClientRect().top <= document.documentElement.clientHeight ? 显示 : 默认我们知道小程序页面的脚本逻辑是在JsCore中运行JsCore是一个没有窗口对象的环境所以不能在脚本中使用window也无法在脚本中操作组件。所以关于图片懒加载就需要在数据上面做文章了。页面页面上面只需要根据数据的某一个字段来判断是否显示图片就可以了字段为Boolean类型当为false的时候显示默认图片就行了。代码大概长成这样<view wx:for=\"{{list}}\" class='item item-{{index}}' wx:key=\"{{index}}\">    <image class=\"{{item.show ? 'active': ''}}\" src=\"{{item.show ? item.src : item.def}}\"></image></view>布局跟简单view组件里面有个图片并循环list有多少就展示多少image组件的src字段通过每一项的show来进行绑定active是加了个透明的过渡样式image{    transition: all .3s ease;    opacity: 0;}.active{    opacity: 1;}逻辑本位主要讲解懒加载所以把数据写死在页面上了数据结构如下：我们使用两种方式来实现懒加载准备好没有一起来快乐的撸码吧。WXML节点信息小程序支持调用createSelectQuery创建一个SelectorQuery实例并使用select方法来选择节点并通过boundingClientRect来获取节点信息。wx.createSelectorQuery().select('.item').boundingClientRect((ret)=>{    console.log(ret)}).exec() 显示结果如下悄悄告诉你小程序里面有个onPageScroll函数是用来监听页面的滚动的。还有个getSystemInfo函数可以获取获取系统信息里面包含屏幕的高度。接下来思路就透彻了吧。还是上面的逻辑 扒拉扒拉直接写代码就行了,这里只写下主要的逻辑完整代码请戳文末githubshowImg(){    let group = this.data.group    let height = this.data.height  // 页面的可视高度        wx.createSelectorQuery().selectAll('.item').boundingClientRect((ret) => {     ret.forEach((item, index) => {       if (item.top <= height) { 判断是否在显示范围内         group[index].show = true // 根据下标改变状态       }     })     this.setData({       group     })    }).exec()}onPageScroll(){ // 滚动事件    this.showImg()}至此我们完成了一个小程序版的图片懒加载只是思维转变了下其实并没有改变实现方式。我们来学些新的东西吧。节点布局相交状态节点相交状态是啥？它是一个新的API叫做IntersectionObserver, 本文只讲解简单的使用了解更多请猛戳没错就是点我小程序里面给它的定义是节点布局交叉状态API可用于监听两个或多个组件节点在布局位置上的相交状态。这一组API常常可以用于推断某些节点是否可以被用户看见、有多大比例可以被用户看见。里面设计的概念主要有五个分别为参照节点：以某参照节点的布局区域作为参照区域参照节点可以有多个多个话参照区域取它们的布局区域的交集目标节点：监听的目标只能是一个节点相交区域：目标节点与参照节点的相交区域相交比例：目标节点与参照节点的相交比例阈值：可以有多个默认为[0], 可以理解为交叉比例例如[0.2, 0.5]关于它的API有五个依次如下1、createIntersectionObserver([this], [options])见名知意,创建一个IntersectionObserver实例2、intersectionObserver.relativeTo(selector, [margins]), 指定节点作为参照区域margins参数可以放大缩小参照区域可以包含top、left、bottom、right四项3、intersectionObserver.relativeToViewport([margin])指定页面显示区域为参照区域4、intersectionObserver.observer(targetSelector, callback)参数为指定监听的节点和一个回调函数目标元素的相交状态发生变化时就会触发此函数callback函数包含一个result下面再讲5、intersectionObserver.disconnect() 停止监听回调函数不会再触发然后说下callback函数中的result它包含的字段为我们主要使用intersectionRatio进行判断当它大于0时说明是相交的也就是可见的。先来波测试题请说出下面的函数做了什么并且log函数会执行几次1、wx.createIntersectionObserver().relativeToViewport().observer('.box', (result) => {     console.log('监听box组件触发的函数')    }) 2、wx.createIntersectionObserver().relativeTo('.box').observer('.item', (result) => {     console.log('监听item组件触发的函数') })3、wx.createIntersectionObserver().relativeToViewport().observer('.box', (result) => {    if(result.intersectionRatio > 0){        console.log('.box组件是可见的')     }})duang揭晓答案。第一个以当前页面的视窗监听了.box组件log会触发两次一次是进入页面一次是离开页面第二个以.box节点的布局区域监听了.item组件log会触发两次一次是进入页面一次是离开页面第三个以当前页面的视窗监听了.box组件log只会在节点可见的时候触发好了题也做了API你也掌握了相信你已经可以使用IntersectionObserver来实现图片懒加载了吧主要逻辑如下let group = this.data.group // 获取图片数组数据for (let i in this.data.group){   wx.createIntersectionObserver().relativeToViewport().observe('.item-'+ i, (ret) => {       if (ret.intersectionRatio > 0){         group[i].show = true        }       this.setData({         group       })     })}最后至此我们使用两种方式实现了小程序版本的图片懒加载可以发现使用IntersectionObserver来实现不要太酸爽。本文代码请戳github                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序JS导出和导入               小程序点赞收藏功能                                                        原作者: 安祭                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 让人头痛的小程序之『图片懒加载』终极解决方案                                                      • 小程序之图片瀑布流（最全实现方式额外加送懒加载）                                                      • 从无到有开发一款产品（小程序）的过程与思考                                                                                               "},{"title": "小程序Canvas性能优化实战 ", "author": "                  Rolan                  2019-12-17 00:18                ", "text": "                                                                                                                                                                                     案例背景需求：在小程序中使用canvas组件绘制地铁图地铁图包括地铁线路、站点图标、线及站点名称文字绘制元素为线、圆、图片、文字。支持拖动平移和双指缩放。问题：小程序中的canvas性能有限特别在交互的过程中不断触发重绘会引发严重卡顿。基本实现在不考虑优化的情况下先说说如何实现绘制和交互。数据格式首先看看数据服务返回的数据中每个元素都是独立的包括该元素的样式及坐标1234567891011121314// 线路数据lineData = { path: [x0, y0, x1, y1, ...], strokeColor, strokeWidth }// 站点数据：分为普通站点和换乘站点// 普通站点绘制简单圆形stationData = { x, y, r, fillColor, strokeColor, strokeWidth }// 换乘站点绘制换乘图标（png图片）stationData_transfer = { x, y, width, height }// 线路名称lineNameData = { text, x, y, fillColor }// 站点名称stationNameData = { text, x, y }绘图API绘制的时候遍历绘制元素数组根据元素类型设置上下文样式绘制及填充。接口参考：https://developers.weixin.qq.com/miniprogram/dev/api/CanvasContext.html。设置样式：setStrokeStyle, setFillStyle, setLineWidth, setFontSize绘制路线：moveTo, lineTo, stroke绘制站点：moveTo, arc, stroke, fill绘制图片：drawImage绘制文字：fillText交互实现实现交互主要步骤如下：通过bindtouchstart、bindtouchmove、bindtouchend实现对用户拖动和双指缩放的监听得到拖动位移向量、缩放比例触发重绘绘制时通过scale和translate在不用对数据坐标进行处理的情况下实现缩放和平移最终得到的结果如下平均渲染时长为42.82ms真机（ios）验证：龟速移动画面延迟非常大。优化方法完全不了解canvas优化方案的同学可以先看看： canvas的优化。避免不必要的画布状态改变参考Canvas 最佳实践（性能篇） 绘图上下文是一个状态机状态的改变是有一定开销的。画布状态改变这里主要指strokeStyle、fillStyle等样式的改变。如何减少这部分的开销呢？我们可以尽量让样式相同的元素放在一起进行一次性的绘制。观察一下数据可以发现很多站点元素样式都是相同的那么在绘制之前可以先做一次数据的聚合将样式相同的数据组合成一条数据：12345678910111213141516function mergeStationData(mapStation) {  let mergedData = {}  mapStation.forEach(station => {    let coord = `${station.x},${station.y},${station.r}`    let stationStyle = `${station.fillColor}|${station.strokeColor}|${station.strokeWidth}`    if (mergedData[stationStyle]) {      mergedData[stationStyle].push(coord)    } else {      mergedData[stationStyle] = [coord]    }  })  return mergedData}聚合后329条站点数据合并为24条有效的减少了90%的冗余状态改变开销。修改之后测试一下平均渲染时长降到了20.48ms真机验证：移动稍快了一些但画面仍有较高延迟。合并数据的时候需要注意此应用场景下各站点是没有互相压盖的而如果有压盖顺序的话在合并时只能合并相邻且样式相同的数据。减少绘制物筛除视野外的绘制物： 当用户在放大图像时其实大部分绘制物都消失在了视野范围之外避免绘制视野外的元素可以节省不必要的开销。点元素是比较容易判断是否在视野范围之外的而站点、站点名、线路名都可以作为点元素处理；线路也可以计算出在视野范围内的部分线段较为复杂这里先不做处理。筛除掉视野外的绘制物之后测试一下平均渲染时长17.02ms真机验证：同上没有太多变化。筛除过小的绘制物： 当用户在缩小图像时文字和站点会由于尺寸太小而看不大清在不影响用户体验的前提下可以考虑直接去掉。根据测试最终决定在显示比例小于30%时去除文字和站点这个级别下的渲染时长从22.12ms减少到了9.68ms。降低重绘频率虽然平均渲染时长已经低了很多但是在交互时却仍有较高的延迟这是因为每次ontouchmove都会将渲染任务加入到异步队列中事件触发频率远高于每秒能够执行的渲染次数导致渲染任务严重积压不断滞后。在PC端一般使用requestAnimationFrame解决这个问题小程序里没有但是可以自己实现参考微信小程序中使用requestAnimationFrame：1234567891011121314151617const requestAnimationFrame = function (callback, lastTime) {  var lastTime;  if (typeof lastTime === 'undefined') {    lastTime = 0  }  var currTime = new Date().getTime();  var timeToCall = Math.max(0, 30 - (currTime - lastTime));  lastTime = currTime + timeToCall;  var id = setTimeout(function () {    callback(lastTime);  }, timeToCall);  return id;};const cancelAnimationFrame = function (id) {  clearTimeout(id);};PC端我们一般将渲染间隔控制在16ms左右但是在小程序中考虑到性能限制且移动端各机型性能不一所以这里留了一些空间控制在30ms对应到30FPS左右。但如果一直循环调用也会造成静止状态下不必要的开销所以可以在交互开始ontouchstart和结束ontouchend时分别开启、停止动画：12345678910animate(lastTime) {  this.animateId = requestAnimationFrame((t) => {    this.render()    this.animate(t)  }, lastTime)},stop() {  cancelAnimationFrame(this.animateId)},修改之后真机验证一下：画面比较流程有轻微卡顿但不会延迟。其他注意由于本例中缩放和平移状态是以绝对状态保存的所以scale和translate要搭配save和restore一起使用；但也可以使用setTransform直接重置矩阵。从理论上看这样应该能节省开销但实际测试并没什么效果平均渲染时长在18.12ms。这个问题有待研究。小程序中避免使用setData保存与界面渲染无关的数据以避免引起页面重绘。优化结果经过以上优化渲染时长从42降到了17ms左右真机验证下安卓机型普遍非常流畅体验很好；ios机型有轻微卡顿且随着使用时长卡顿逐渐明显后期可以深入研究下是否有内存管理的问题。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    Kbone原理解析 & 小程序技术选型               小程序跨页面数据传递与事件响应                                                        原作者: totoro                   来自: blog                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "使用 async await 封装微信小程序HTTP请求 ", "author": "                  Rolan                  2019-10-9 00:55                ", "text": "                                                                                                                                                                                     1. 编写将普通回调函数形式的方法转换为promise方法的promisic方法 1 // util.js 2 const promisic = function (func) { 3     return function (params = {}) { 4         return new Promise((resolve, reject) => { 5             const args = Object.assign(params, { 6                 success: (res) => { 7                     resolve(res) 8                 }, 9                 fail: (error) => {10                     reject(error)11                 }12             })13             func(args)14         })15     }16 }17 18 export {19     promisic20 } 2. 编写Http类封装HTTP请求 1 // http.js 2 import { promisic } from \"./util\" 3 import { config } from \"../config/config\" 4  5 /** 6  * 使用 async await 封装HTTP请求 7  */ 8 class Http { 9 10     static async request({ url, method='GET', data }) {11         // 将wx.request方法转换成promise方法12         const res = await promisic(wx.request)({13             url: `${config.apiBaseUrl}${url}`,14             method,15             data,16             header: {17                 appkey: config.appkey18             }19         })20         return res.data21     }22 23 }24 25 export {26     Http27 } 3. 编写Theme业务类调用封装好的Http请求// theme.jsimport { Http } from \"../utils/http\"/** * 编写主题请求业务类 */class Theme {    /**     * 获取首页主题A     */    static async getHomeLocationA() {        return await Http.request({            url: 'xx/xx/xxx',            data: {                names: 't-1'            }        })    }}export {    Theme} 4. 在page中调用Theme业务类获取首页主题A方法 1 // home.js 2 import { Theme } from '../../model/theme' 3  4 Page({ 5  6   data: { 7     topTheme: {} 8   }, 9 10   async onLoad (options) {11     // 获取首页主题A12     const data = await Theme.getHomeLocationA()13     this.setData({14         topTheme: data[0]15     })16   }17 18 }) 附上目录结构  这样就可以愉快地使用async await形式的Http请求了彻底摆脱各种callback方法！                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    uni-app开发一个小视频应用(二)               uni-app相关知识总结                                                        原作者: 动物管理猿                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序自定义弹层禁止页面滚动方案详解 ", "author": "                  Rolan                  2019-8-21 00:52                ", "text": "                                                                                                                                                                                     方案一：通过小程序自定义组件\tscroll-view 实现布局动态修改\tscroll-y 属性组件及属性介绍：\tdevelopers.weixin.qq.com/miniprogram…缺点： 布局局限于\tscroll-view 组件 大部分需求都满足不了方案二：自定义弹层蒙层或者外层容器添加\tcatchtouchmove 事件<view class=\"mask-box\" catchtouchmove=\"preventTouchMove\">    <!--弹层内容--></view>复制代码缺点： 弹层滑动不了；适用于自定义弹层不滑动的布局。方案三：动态添加给最外层元素增加\tposition:fixed 样式<view style=\"{{isMask ? 'position:fixed; top: 0; left: 0;' : ''}}\">  <!--内容区--></view>复制代码缺点： 当\tisMask 为\ttrue 时页面始终会回到顶部；体验过不了关；方案四：通过动态修改样式处理 （推荐）原理： 小程序没提供\tAPI 给我们动态修改\tpage 样式 那我们换个思路最开始给\tpage 设置\toverflow: hidden , 最外层布局设置\toverflow: auto 但是设置\theight 属性时还是有坑。 如下：height: 100vh 时上拉加载、下拉刷新在安卓端失效ios没问题； 适用于当前页面不需要上拉、下拉刷新page 设置\toverflow: hidden 时 安卓端页面整体滑动不了； 适用于底层布局不需要滑动page 设置\toverflow: visible  以上问题均解决 （推荐）代码如下： wxml:view class=\"content {{isMask? 'page-hidden' : ''}}\">复制代码wxss:page {  overflow: visible;  height: 100%;}.group-buying-list{  height: 100%;  overflow: auto;  -webkit-overflow-scrolling: touch;}.page-hidden{  overflow: hidden}复制代码若有疑问欢迎留言指正                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序拼接图片链接无底洞探究               研究了多个出行类小程序后我们发现了留住用户的秘密                                                        原作者:  赖先生                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序云端解决方案探索之路 ", "author": "                  Rolan                  2019-8-7 00:58                ", "text": "                                                                                                                                                                                     小程序刚推出的时候很多人都觉得它就是 H5因为开发小程序的三大语言和 HTML、CSS、JS 是一脉相承的即使改变了扩展名也改不了其实质。那么小程序的实质到底是不是 H5 呢？经过我们的论证分析我们认为小程序并不是 H5 应用。主要原因如下：在小程序里面无法使用 DOM 接口所以 HTML5 生态中一切基于 DOM 的库都无法使用（如 jQuery）小程序并非使用 URL 访问所以没有域名的概念。这个特性有两个影响不存在跨域问题所以访问控制是直接在微信 MP 上配置域名白名单不支持 Cookie 存储这将导致后面我们重点研究了会话管理的实现从上面两个角度来考虑我们认为小程序更偏向于传统的 CS 架构。那么小程序和传统 CS 架构的区别在哪儿？主要包括下面两点：网络和续航小程序在移动端运行网络环境会比较复杂频繁的网络连接可能会过度消耗资源导致续航下降所以小程序对网络和资源的优化都提出了要求。伸缩能力小程序寄托在微信平台上运行作为一个十亿级的社交平台业务可能会面临爆炸式的增长。如果在爆点小程序不能快速伸缩应对那么将失去这样一个重要的机会。所以小程序对其后台架构的伸缩能力提出了比较高的要求。门槛和挑战在上面一些结论下我们进行了一些尝试包括上传下载、会话管理、WebSocket、视频点播等等。这次重点来分享会话管理和 WebSocket因为我们面临的挑战主要集中在这两个案例上。会话管理我们最早开发了一个一笔到底的案例来实现会话管理案例需要根据用户保存用户的作品每次用户登录都可以看到用户自己的绘画。但是因为小程序不支持 Cookie 传输所以会话服务需要自行实现。我们会话管理的实现目标是：完成微信要求的鉴权流程生成用户会话利用会话确定每个请求对应哪个微信用户安全性和扩展性满足要求我们案例按照这个流程进行会话建立：其中在小程序和服务器我们分别提供 JS 和 Node SDK 来提供会话支持。这个案例完成了会话服务的功能性目标可以提供会话建立和验证的能力。但是弊端在于该能力只能被 Node 开发者使用其他语言的开发者无法使用。同时因为小程序的 appId 和 appSecret 存放在外网可以访问的服务器上也有一定安全性问题。会话服务和我们的业务耦合在一起也给后续的横向扩展带来了麻烦。于是我们提出了改进的手段：会话管理服务器独立提供提供多语言的 SDKappId 和 appSecret 存放到数据库中其中多语言的 SDK 正式因为会话管理服务器的独立而可以快速开发到。优化后会话的建立流程如下图所示：而会话的验证流程如下图所示：我们的会话服务改进取得的效果还是很明显的：流程和安全性上完全符合了微信的鉴权要求独立会话服务器可以方便进行独立的升级和扩展也为多语言 SDK 的开发打开了方便的大门信道服务我们面临的另外一个挑战就是 WebSocket。在进行案例分析之前先跟大家分析一下微信支持 WebSocket 的原因。传统的 HTTPS 连接请求每个请求都需要建立一次连接耗费比较多的资源。同时微信有最大连接数的限制（5个）所以实时通信的需求不好做长连接的方案也只能串行传输这种方案耗电高体验差。当我们把目光转向 WebSocket 之后会发现 WebSocket 通信全程只需要建立一次连接就可以实现双向的实时通信更省电的情况下获得更好的体验。这就是小程序支持 WebSocket 的一个重要原因可以提高业务的体验并增加续航。鉴于很多同学可能对 WebSocket 还不了解这里简单介绍一下。我们的 HTTP 连接是在 TCP 的基础上建立的当服务器支持 WebSocket 的时候可以相应一个头部告知客户端进行协议升级。升级协议后会复用之前的 TCP 连接在上面实现 WebSocket 协议实现双向通信。更加详细的资料可以参考 MDN 上的说明。回到我们的案例上来我们当时使用小程序提供的 WebSocket 做了一个实时的剪刀石头布游戏。我们使用 Socket.IO 实现其后端后发现在小程序无法使用 Socket.IO 的客户端代码支持。我们只能自己去啃了一下 Socket.IO 的上层协议实现了一个简版的客户端从而实现剪刀石头布这个游戏逻辑。这个案例验证了在小程序上面 WebSocket 的可行性但是由于客户端的实现是自行实现和 Socket.IO 的后端配合可能会出现不可控的情况。同时我们发现 WebSocket 的后端实现门槛比较高并且进行横向扩展的话会更加困难。作为云服务厂商我们首先想到的方案是使用 PaaS 提供服务来支持 WebSocket 连接。这是怎么一个思路呢？上图很好地解释了 PaaS 形式和传统 WebSocket 形式的不同之处PaaS 实际上是要实现一个三方通信。我们看一下使用 PaaS 服务来建立 WebSocket 连接的过程：建立连接后小程序和业务服务器之间可以通过下面的形式进行通信：经过 PaaS 的改造我们得到了一个新的 WebSocket 方案。该方案的优劣在哪里？首先优势比较明显由平台来提供的服务由平台自己完成扩展能力的支持以及稳定性和性能的保障业务无需担心。同时业务也无需关心 WebSocket 协议的实现因为业务服务器和信道服务之前的通信都是传统的 HTTP这样也可以节约业务服务器的长连接资源。但是这种方案也有它的局限之处。业务服务器和信道服务器之间采取公网通信处于对信息安全的考虑最好还是走 HTTPS 通信这个过程的通信延迟比较客观。其次三方通信的调试便利性也不如传统的连接方式。对于上面两个问题其实我们也有对应方案。如果业务服务器在腾讯云机房运行那么可以让业务服务器和信道服务器之间通过内网 HTTP 传输延迟大大降低。信道服务后续也会提供调试日志供大家分析发现问题。总体来说PaaS 方案会帮助更多开发者解决掉了门槛较高的部分。整合我们上面对于会话服务和信道服务都进行了一个有益的实践那么这两个服务是否可以整合信道服务里面是否可以支持会话识别？事实上我们可以做这个事情。下面的表格描述了会话服务和信道服务与服务模块之间的关系。我们可以把客户端的部分整合为客户端 SDK把业务服务器的部分整合为服务器 SDK并且提供会话服务器的源码开源。那么上面三个部分加起来就是目前腾讯云的开源项目 - Wafer。Wafer 包含了会话服务和信道服务的支持从全栈模块来提供开源的资源并且提供了丰富的文档。有兴趣的开发者可以使用上面的连接来查看 Wafer 项目。产品化实践Wafer 帮开发者解决了小程序开发过程中信道服务和会话服务的门槛问题但是作为小程序开发者还要关心后台架构、资源采供、资源部署、扩展能力、安全性、域名申请等等与业务开发无关的部分。这部分我们提出了一个一站式部署的方案。这个方案会帮你分配好资源并自动部署下面的架构让开发者可以专注于业务开发。自动部署的过程其实挺复杂的有兴趣的同学可以参考下图了解。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序七夕节礼物               微信小程序预加载图片以及占位图片                                                        原作者: 追着太阳晒                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "如何寻找用户增长点，构建小程序用户增长模型？ ", "author": "                  Rolan                  2018-12-27 00:01                ", "text": "                                                                                                                                                                                     If you are not growingthen you are dying！1. 如果企业不在增长那么就在衰亡我已经不只一次在我的文章里面提到不管你是做用户运营、还是做产品经理、亦或是程序员我们都有一个共同的目标就是希望产品有人使用 这个“使用”就是希望可以大规模地获取用户。但我们所说的用户增长其实不仅仅是这些单项指标的增长而是更关注长期的用户增长、留存乃至产品所产生的价值。所以说如果一个企业不在增长那么她离死亡已经不远了企业需要不断地获取新的用户。即使在这个互联网人口红利消失的时代也不能阻止BAT们继续增长他们将用户增长点放在海外通过出海的方式去获得更多的新用户。因为BAT们也深知“If you are not growingthen you are dying！”。2. 我是如何寻找用户增长点的？2.1 我在这半年做了什么？我关注小程序可以追溯到2017年的时候也就是小程序一开始上线的时候。2017是小程序元年在这一年里小程序峰回路转从万众期待到被视为鸡肋再到柳暗花明小游戏“跳一跳”的出现更是让小程序成为全民焦点。而我也是一直在等待一个机会的到来。直到今年的5月份才加入到一家小程序公司负责一款游戏社交产品【开黑玩】的用户增长一头扎进了小程序蓝海中去关注产品运营关注如何获取用户。在这半年里我们把用户从0到200万我跟团队也是一直在摸索一条更加适合小程序的增长路径。因为我觉得做小程序增长或者说做用户增长其实是没有最适合的方式去获得用户而有更适合因为我们在做增长的适合其实需要去关注成本问题成本会因为增长方式的不一样而产生天壤之别。所以这半年里我开始构建自己的增长团队探索一条更适合本身产品的用户增长路径。2. 我是如何打破边界去做用户增长小程序是微信的。微信群是微信的；微信公众号是微信；朋友圈是微信的；而朋友圈、微信公众号、微信群、集聚了全国13亿人当中的10亿人。而这些都是微信生态圈的一个组成部分所以在微信群、微信公众号、朋友推广小程序是自然而然的事情。这是一大利好啊我知道我的用户在哪里啊！在负责这款小程序增长的时候其实我和大多数人都一样都会通过微信公众号关联的方式去获得用户。因为微信公众号本身是微信的生态组成的一部分小程序和微信公众号本身也可以无缝连接所以绑定微信公众号也是早期很多小程序获得用户的重要渠道。而微信公众号的菜单栏更是获得用户的一个低成本的衍生渠道所以低成本地去购买菜单栏也是很多推广者去获得小程序用户的重要渠道。同时很多运营推广者还会通过做活动找到用户需求点去做福利活动吸引用户参与而活动里面设置诱饵进而让用户分享到朋友圈和微信群其实这个也是看到微信群以及朋友圈的渗透力之强比如：拼多多的零元购等在这里我就不做过多赘述。还有一个做法也是现在很多运营人常用的方式。既然我们知道了用户很多都在微信群或者朋友圈既然朋友圈人数是固定那我们就来建立微信群微信群想建立多少急建立多少。所以很多公司的运营推广者就会把苗头对准如何裂变出成千上万的微信群因为他们知道只要你的成千上万的微信群了就可以把你家的小程序丢到这些群里用户点开来那就是顺理成章的事情。殊不知微信群的运营难度之大其实是超过很多了个人或者企业的想象所以很多企业也会用钱来买微信群。现在很多广告营销公司也会有这些服务一个群多少钱我手上有10万个群覆盖人群可以达到千万级别。而当你买了这些社群之后你一置千金要投放1万个群投完后你一看后台数据新增数据不超过三位数的时候你就知道被骗了其实也不是被骗了这些广告公司确实也帮你投了1万个群但是这1万个群早已是僵尸群。朋友圈亦是如此很多人的朋友圈其实也可以拿来卖了。但是试问一下如果你的产品不够强利益力度不够强的时候用钱来这些渠道其实就是在浪费钱。微信公众号、菜单栏、微信群这是我们早期在探索新增方式上的一个必走之路因为这个是很多小程序创业者都会经历的一个过程但是对于很多垂直行业小程序来说只有微信生态这一渠道是完全不够特别是对于我们这些新一代的游戏社交产品来说那更是不够的（因为95后乃至05后的社交圈很少会在微信产生）。这期间我一直都探索一个事情我的用户在哪里？微信公众号这是一个已知的大陆在这一渠道上我们也是下了很多功夫但是随着用户突破10万20万我觉得这个渠道已经远不能满足增长的需求我知道迟早会有一天会遇到增长瓶颈我需要尽快找到新的渠道来获得新的用户。当时有想到过短视频但是基于认知层面上考虑一个用户是很难从看完短视频去搜索你的产品并且使用你。因为他要经过看视频——退出短视频——打开微信——点击搜索——输入产品名字——使用它。这一增长路径其实相对于微信生态圈的任何一个渠道来说都是非常长的增长路径。用户不可能会有这样的使用操作即使有也是很小的一部分。对于短视频这一增长渠道来说还是需要考虑的一个因素是成本问题因为不管你是投放这个短视频渠道还是自己去制作视频发布其实相对于惯用的增长方式来说其成本都是巨高的。但通过调研抖音&快手这两个平台的用户群体25岁以下的95后占到了40%以上也就说抖音掌握了一二线城市的95后人群快手掌握了三四线的95后人群这两个平台有我们所需的人群关键怎么去撩这个人群是我们思考的重点。在前期为了能够更加低成本地去试错我们选择了微博这个渠道去测试我们前面所说的路径：看视频——退出短视频——打开微信——点击搜索——输入产品名字——使用它。为啥会选择微博因为微博相对短视频来说成本低且人群较精准。微博发展了近十年人群早已下沉到三四线城市而且在游戏这个领域里也是建立比较多的头部大号所以选择这个平台去做引流也是我们考虑的重点。当时我们采用了微博惯用的@两位好友随机抽奖方式去获得更多用户转发进而做到扩大传播的作用。由于预算有限我们对所有合作的微博都做了详细的分析不能允许有假号 的出现（因为大家都清楚微博的假号是非常盛行的刷量的价格也是非常低导致假号盛行之前我们做营销也在这里面踩过很多坑）。同时我们也对每个渠道做了参数设置对每个渠道的来量大小做了监控。当天我们同时投放了5个号投完一个小时候小程序的数据也是非常好看出现峰值。说明这个方式去做是有效果而我们最终验证的增长路径：看视频（资讯）——退出APP——打开微信——点击搜索——输入产品名字——使用它其实是非常有效的。而这个也是跟我们选取的利益点是有很大的关系因为我们的用户都是属于玩吃鸡或者玩王者的用户他们对于英雄皮肤这个点是不可抗拒的特别是888点券以上的皮肤更是如此。在微博的增长路径是可以如果将这个利诱点以及路径复制到其他平台那么产生的效益也是相当的变得只是平台不变是用户和利诱点只要方式把握好了你的用户就会源源不断地向你涌来。所以我们也是把这个方式复制到了短视频（抖音&快手）上用最低成本地大规模获取用户。而这个方式也是行之有效只不过在快手抖音上用的是视频不是文字但是效果更加显著用户可以看到更加真实更加有利于转化。其实从微信公众号横跨到微博、短视频其实 也是一次大胆地尝试尚不知效果如何但是只要找到行之有效的复用套路就看扩大规模地去复制。因为当你可以看到这个途径有效时你就要争取更多的资源去做这样才能发挥最大的价值。*我负责的小程序有什么可以吸引用户的其实在接手这个小程序的用户增长的时候我想的更多也是如何大规模获取用户而且是低成本的最好是那种增长黑客的酷炫获取方式懂不懂就可以获得大量用户的案例总在我脑海浮现。那段时间也是研究了很多案例自己虽然也有过这样的操盘案例但是每个行业都是不一样的人群、产品、业务之间的联系也是不一样的所以如何找到切入点是我第一步需要研究的事情。当时在我脑海里总有两个问题需要解决：我的用户聚集在哪里？我的用户需要什么？只有解决了这两个问题我才能有针对性地去制定措施去获取这群用户。在文章的前面我已经提到我的用户在抖音、快手、微博、微信公众号上而这些平台其实是“中心化”的平台里面都有相对于的头部用户也是我们经常叫的KOL。所以第一步我知道了这些平台聚集我所需的用户群体而且是大规模的。除了这些比较大众的平台那其实还有很多比较小众的平台也是有我所需要的用户比如贴吧、B站、兴趣部落、QQ空间、斗鱼……且这些平台都是有所谓的KOL的那我是怎么找到他们的呢？答案就是我先要知道我的用户是在什么样的年龄段然后再去找这些用户的经常去的平台。我的目标用户是一群95后的中小学生这些“新型用户”也是有个性的一代我不知道他们脑子里面想什么？但是我知道他们会去哪些平台这些平台的都是些什么类型的平台通过平台调性去获得这群用户的标签那是自然而然的事情。OK现在我们已经知道目标用户在哪里了！接下来那就是要去撩他们。在撩之前得知道他们需要什么啊？这样才能勾起他们的行动欲望吧。我的目标用户是移动手游爱好者游戏占据他们大部分的时间同时缩小范围他们是一群玩王者荣耀的用户那玩王者的用户的需求是：开黑？处CP？英雄皮肤？对这些都是需求那如果要找到一个硬核需求那就是皮肤而且是免费皮肤。那找到他们硬核需求点你就设置这些利诱点去吸引你的用户过来。同时我们在我们的产品里面也有这样的利益点那就是模仿电商玩法诸如免费抽皮肤、助力0元拿皮肤等这是外部引流跟内部留存相得益彰的做法。其实在找到你的用户需要什么的时候你可以针对这些利益去玩出很多花样。比如：还有开黑这个需求那我们建立开黑群里面有几个大神坐镇如果要进群那是不是要用户做点什么呢？同理处CP也是这群玩家一个非常重要的需求帮你解决单身问题啊？我们可以利用大数据帮你解决单身问题啊对于男性用户居多的游戏世界是不是也可以做很多文章呢。3. 每个行业都有其用户增长点如果你是可以把这篇文章读到这里的同学我相信你也是一直在寻找我自己的产品（行业）是如何找到用户需求点然后结合运营玩法成功地吸引更多用户使用你的产品。接下来我会说到如下几个行业都会有哪些需求点可以挖掘进而吸引到用户参与。3.1 教育行业其实从去年开始裂变玩法开始走入运营人的视野这其中的代表当属鉴锋而鉴锋团队所玩出的玩法基本都是属于教育行业的或者我们叫做知识内容这一领域。为什么教育行业容易引起大家的转发进而刷爆朋友圈。其实这中间还是用户的需求在作祟痛点是第一位“知识付费+粉丝裂变”核心的还是“知识”这二个字粉丝不傻套路基本都懂了之所以还陪你玩吸引他们的还是这个知识点。因为知识内容这个是非标品而且还是廉价的（因为互联网让内容变得廉价）所以很多企业都能玩而且知识发放简单只要完成任务就能在百度网盘里面拿到属于你的“知识”。这种成本又低、风险还很小的知识更容易受到大家的欢迎。只要你玩这个套路只要工具、技术到位就能吸引不少目标用户参与。比如鉴锋团队的三联生活周刊、网易戏精课新世相团队的营销课当然了你看到的都是刷屏级别的还有很多同样吸引了很多用户参与但是没有达到刷屏级别的玩法还有很多但这种涨粉几千几万是常有的事情。你问我这个套路还可以玩吗？答案同样可以的只要启动池的目标受众精准就会有成千上万参与进来。3.2 出行行业出行行业代表当属滴滴、摩拜、ofo们了。这个行业能够吸引用户去使用你的产品只要券了各种各样的券、卡比如：x元券、充x元返x元券、月卡……..其实这个出行行业有点像电商行业都是有自己的产品在此产品上可以优惠的点有很多而这些也是吸引用户的噱头天下攘攘皆为利往。在做活动、找用户需求点这些需求点足以可以撼动行业比如：摩拜和ofo。在去年摩拜在高考后的持续免费活动之后突然放了大招推出了摩拜单车免费月的活动与之前的摩拜活动不同这次摩拜免费活动则是以月卡的形式用户需免费领取月卡方能免费骑行一个月。这一举措让OFO小黄车有些措手不及而OFO的月卡晚了将近一个月。OFO的票面上也是原价20元不过首月免费用户也是免费骑30天的。双方你来我往你方唱罢我登场也是让很多用户吸引到甜头了。3.3 旅游行业其实旅游行业在做运营推广的时候其实比很多行业都会好做很多因为旅游是很多人的向往特别是世界各地或者一些比较稀有的胜地更是很多人争相向往的地方。所以这时候你在寻求用户增长点的时候除了一些自有平台上的一写免费酒店、免费门票等一些券之外更多应该想的是用户内心的向往。比如：如果你的宣传阵地在抖音上完全可以组建一个2人小组去录制剪辑一些美景吸引用户点赞评论之前很多不那么多人去的景点在抖音上火了就变成了旅游旺地了。一旦视频火了你的产品的使用用户也会增加。3.4 音乐、体育行业为什么会把这两类产品放在一起呢？因为我觉得这两类APP都有一个共性就是这两类产品都是“中心化”的。什么中心化就是里面都有粉丝所追求的偶像比如：NBA的科比、麦蒂、詹姆斯等音乐类的产品就更加明细了；比如：周杰伦、王力宏、鹿晗、潘玮柏等等。那怎么样才能更大范围吸引用户呢？那就是通过投票类活动因为投票类活动粉丝投的是自己喜欢的明星为自己的偶像打CALL他们义不容辞啊。比如QQ音乐以粉丝经济为方向策划了一场从APP引流微信公众号的投票活动即“年度巅峰分享榜”也就是通过一个排行榜让粉丝来投票（本次投票可在APP内以及微信公众号进行）。从粉丝群体入手就为此次活动的成功奠定了成功的基石因为粉丝群体的明显特征是认同感、参与感、和优越感。针对粉丝的“三感”排行榜形式的投票活动操作门槛变得更低实现的效果很好可以说是性价比超高运营手段之一。QQ音乐最终实现下载量的提高公众号也增粉150万。4. 如果让你来负责一款小程序增长你会如何做？4.1 我是如何搭建用户增长团队很多学用户增长的小伙伴或许都会有个误区那就是认为裂变就是用户增长你们相信你们严重所看到的一切比如看完很多人做了一场活动吸引了近百万新用户那就是一个厉害的用户增长。而我想告诉你的是裂变只是用户增长的一个方式手段罢了他不能概括用户增长。我们所说的增长他是一个多方式多维度的增长。多方式指的是实现用户增长的方式有很多比如：营销活动（品牌活动、裂变活动）、爆款内容（微信公众号的好文章、抖音上的好视频）。多维度指的是用户增长你得从纵深维度去考量他单单从渠道口进来的用户只是增长的第一步你还得促活他留存他转化他也就是我们所说的AARRR模型。所以我们所说的用户增长更关注长期的用户增长、留存乃至产品所产生的价值。这篇文章咱们也着重讲一下第一个“A”用户获取的问题。所以我在构建用户增长团队的时候也不是说一定要招那些技术很厉害、运营很厉害同时市场营销也很牛逼的人。当然了能招到这些人那最好不过了那其实你要认清一个事实就是如果真有这些人十有八九都自己干了。所以我需要清楚自己需要什么样的人这时候我就要明确我的小程序的增长路径是怎么样的？你得先明确了你的增长路径是怎么样的？然后再去搭建相对应的团队架构比如：你的流量入口有短视频、微信公众号、微博、小程序那就去找相对应的人才。比如：微信公众号、微博这些其实可以统称为新媒体那关于新媒体入口你可以去找一个专才去负责这块工作。而比如：短视频这个流量入口你可以去找短视频的运营人才。所以只有你知道了你的流量入口然后再去找相对应的专才去负责转化那么你的团队可以做到人尽其才效益最大化。4.2 做用户增长模型要小而美（路径清晰、切莫广撒网）很多人在用户增长这个口子上其实是推崇越多越好也就是你的流量入口越多越好但是我不这样认为我觉得初期在你的用户增长的流量口上你应该小而美。这个小而美包括两个层面：第一个层面就是用户转化路径需要很清晰然后去验证他。比如我们文章前面提到的如果你宣传的阵地在抖音上那么你在上面做营销那用户就要经过看视频——退出短视频——打开微信——点击搜索——输入产品名字——使用它。当你清晰了你的用户需要经过的每一步骤你才能做到心中有数每个步骤需要优化的点你都知道进而才会花人力和资源去专攻这个渠道。就比如我们在抖音上去转化的时候其实我们知道了每个步骤所以我们清楚每个步骤可能会出现哪些问题。比如：当用户打开搜索的时候那微信其实有很多搜索首页顶部搜索微信小程序搜索等。还有就是当用户第一次搜索这个“生词”的时候其实会出现搜索更多的。而你的用户群体如果是两个极端：年龄特别小or年龄特别大的就会觉得你这个产品不存在进而在这一环节流失掉等等这些问题所以当我们知道这些步骤哪里会出现问题的时候我们就会在宣传的时候特意给标注引导清楚。第二层面就是忌大而泛地去铺渠道。其实广撒网式的推广我并不推崇当你的人力资源有限的情况下你还分散“兵力”去打战那势必会被敌人击溃。在初期人力、资金有限的情况下应该聚焦其中的1-2个渠道去深究你会发现里面的套路很深但是等你研究透了之后其实也不过如此同样你还可以把你的套路有可能套用到其他平台上这样做的才能事半功倍。4.3 做小程序增长敢于突破边界敢于突破边界你需要一种成长型的思维。我们人脑都有两种思维：长型思维以及与之相对的固定型思维。举个例子：有的人觉得自己天生不适合学外语也不可能学好外语；有的人却认为外语虽然有难度但只要自己认真学还是能够有提高的。在这两种思维模式中我们称前者具有固定型思维后者具有成长型思维。同理有人觉得推广小程序很难但是还是愿意去尝试而且还会通过各种方式去获得增长他觉得虽困难但是只要有耐心恒心乐于探索就会有解决的办法。而有些人觉得推广小程序很难在我现在知道的渠道里面根本不可能完成上司交代下来的KPI那么这种人就只有等死的份儿。很明显成长型思维看重的是努力和成长所以拥有这种思维模式的人会愿意参与挑战也能够正视失败并且会从失败的经验中看到自己的成长不会抗拒学习新事物。固定型思维看重的是天赋或与生俱来的才干并且认为一个人能否做成一件事全靠聪明努力是没有效用的。可以看到成长型思维更多关注自身的提高与成长固定型思维却只想向外界证明自己的聪明或者遮掩自己的不聪明。在我负责这款小程序推广的时候在把渠道拓展到微博、短视频的时候肯定有想过背水一战失败了就不怕当做一次教训从中汲取一些有益的教训也是一份成长。当然了我觉得这里面还有一个很重要的是有一个能够容忍你试错的大环境。这个环境包括你的上司是否能容忍你去试错以及这个公司是否有足够的耐心和资金让你去试错这两个都是蛮重要的。如果不允许那你连试错的机会都没有那么你就永远不敢踏出你的固定思维。5. 不光只有大目标还要有关键行动做啥事情都要有目标因为他可以指导你前进让你每天做的工作都有意义。那有了目标当然得有关键行为了团队所做的每件工作都是围绕这个大目标去进行的。这时候可能就需要引进【OKR】即目标与关键成果法了。我相信2018年了做运营的小伙伴哪怕没用过这个方法都会听过这个OKR了。OKR是一种战略目标任务体系是一套明确目标并跟踪其完成情况的管理工具和方法它由一个需要极致聚焦的明确目标和量化该目标的数个关键结果这两大主要部分组成。也就是说团队需要有大目标而我们团队成员需要围绕这个“大O”去做可以影响到这个目标的任务这样既可以知道我们做的每一件事情到底有没意义同时也可以目标聚焦而不会把有效的时间浪费在无效的事情上。举个例子我们小组每个月都会有目标而这个目标最大的“O”就是可以更加低成本、高效率、大规模地拉来新用户。那么每个专员所要做的事情就是在自己负责的这个“流量口”上去规划自己的策略这个策略就是如何更加低成本、高效率、大规模地拉来新用户。那么“小O”就是每个月需要拉来xx新用户而这XX新用户可以通过哪些关键行动去拉来。比如：我们的新媒体运营专员其负责的微信公众号这个平台其实就是一个流量入口那么他需要根据这个“小O”每个月制定N多的关键行为策略去达到他的目标。而其他专员所负责的“小O”也是对整个“大O”的一个组成部分他必须完成了才可能更加容易达成大的目标。所以大家都各司其职做好自己的工作。#专栏作家#艺林小宇微信公众号：艺林小宇（cs-jy8）。2017年人人都是产品经理新锐作家专注于互联网运营领域的研究和总结在用户增长、小程序、APP推广有丰富的实战经验。声明：本文版权归属艺林小宇抄袭必究。如需转载请联系微信：443597359题图来自 Pexels基于 CC0 协议                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序助手发布！               小程序倒计时深究                                                        原作者:  艺林小宇                    来自: 人人都是产品经理                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序云开发：菜鸟也能全栈做产品 ", "author": "                  Rolan                  2019-11-25 00:25                ", "text": "                                                                                                                                                                                     我想独立实现一个全栈产品为什么这么难#日常生活中我们会使用很多软件产品。在使用这些产品的时候我们看得见的东西称为“前端界面”如一个输入框、一个按钮点击按钮之后发生的一切看不见的东西称为“后端服务”。与之对应的创造者分别称为“前端程序员”、“后端程序员”然而一个完整产品的开发不仅仅是只有前端和后端还有设计师架构师运维等。有没有可能这些所有的事情都一个人干呢？有可能事实上如今就有很多的“全栈工程师”他们身兼数职是多面手。能独立完成一个产品的方方面面。这种人固然十分了得他们通常具有多年的经验涉猎广泛是老手也是高手当有一个产品想法的时候他们可以用自己的全面专业技能尽情的发挥去实现自己的想法。所以从某种意义上讲“全栈也是一种自由”你可以自由的实现你的想法这简直太美妙了！然而很多时候当我们有一个产品想法的时候我们往往发现前端写完了后端怎么搞？数据库怎么搞？域名怎么搞？域名还要备案？应用部署怎么搞？我的买什么样的服务器啊？静态资源 CDN 怎么搞？文件上传服务器怎么搞？万一访问用户多了能撑住吗？等等……问题很多导致你的一个个想法都只是在脑海中昙花一现从来都无法将她们实现或者说你激情饱满的实现了其中自己最擅长的一部分当碰到其他难题的时候就止步了。于是仰天长啸：我就想独立做一个完整的产品为什么这么难？年轻人这一切都不怪你……破局：小程序云开发#为什么使用小程序云开发来破局？#为啥是用“小程序云开发”来破局？首先我们的目的是全栈实现一个产品。全栈可以有多种技术方案你可用任何你能会的技能来达到全栈的目的。你可以开发安卓IOS或者 PC 站然而小程序是最实际的！为啥？手机上能做的事情为啥要用 PC 版？OK,既然手机版比较好那能不能再简单一点？能就是小程序不需要开发IOS安卓两个版本。可以快速产出快速试错。其次前面说到了全栈实现一个产品并不容易对很多人来说甚至是巨难！选择了小程序已经是比较划算的方案。而再集成云开发全栈立马就有了。这就是为什么选择“小程序云开发”来破局。小程序云开发是什么?#小程序云开发是什么？官方文档是这么说的：开发者可以使用云开发开发微信小程序、小游戏无需搭建服务器即可使用云端能力。云开发为开发者提供完整的原生云端支持和微信服务支持弱化后端和运维概念无需搭建服务器使用平台提供的 API 进行核心业务开发即可实现快速上线和迭代同时这一能力同开发者已经使用的云服务相互兼容并不互斥。看完上面的描述也许你仍然无法非常清楚的知道什么是“小程序云开发”没关系你只需要注意加粗的部分大概知道它“无需搭建服务器”从传统观念将这个似乎“毁三观”咋可能没服务器啊？是的可以没有传统意义上的服务器这种模式是 serveless 的。那么小程序云开发提供了哪些东西来破局呢？且看下面的表格：能 力作 用说 明云函数无需自建服务器在云端运行的代码微信私有协议天然鉴权开发者只需编写自身业务逻辑代码数据库无需自建数据库一个既可在小程序前端操作也能在云函数中读写的 JSON 数据库存储无需自建存储和 CDN在小程序前端直接上传/下载云端文件在云开发控制台可视化管理云调用原生微信服务集成基于云函数免鉴权使用小程序开放接口的能力包括服务端调用、获取开放数据等能力上面的表格中提到了“云开发”中的一些能力：“云函数”“数据库”“存储”“云调用”我们可以将这些词带入你曾经开发过的应用看看它们分别代表了哪些部分。对于程序员来说如果有疑问的话没有什么是一个 helloword 解决不了的。实战：独立开发一个简易的零售小程序#哆嗦再多不如实战。下面我们就来使用小程序云开发实现一个简单的零售小程序。项目构思#既然是一个零售小程序那么我们可以思考一下零售小程序的大致业务流程以及粗略的梳理一下其功能点。现根据自己的想法大致画一下草图如果没有灵感可以参考一下别的 APP 是如何设计的。我根据自己的想法设计之后是这样的：功能模块：首页商品列表页购物车确认订单个人中心个人订单管你模块（商品添加分类添加）其中商品需要上传图片。梳理完功能之后我们对于要实现的东西已经有个初步的概念了。接下来我们需要大概画一下页面设计、及功能流转。初次设计可能没有太多经验没关系开始做就行了做着做着就会想法越来越多然后优化的越来越好。。我也是经过了多番修改调整最终找到了一些思路。我的（拙劣）设计如下图片如果看不清楚可复制图片链接在新窗口打开查看：说明以上图片是根据成品（我真的开发了一个云小程序并上线使用了）截图的而实际我再设计的时候也是经过几番修改才最终定成这样。同时补充说明一下这里前端页面使用的是 vant-weapp控件非常好用。推荐！如果你和我一样是一个纯后端程序员建议使用 vant-weapp 来作为 ui非常方便。否则自己写页面样式的话可能就做不出来了。全栈不是那么好干的啊。选择自己能驾驭的能实现最终功能就是一个合格的全栈。创建小程序云开发项目#我们先下载微信小程序开发工具下载地址在这里,安装好了之后新建项目界面如下APPID 需要你自己去注册一个。然后注意选择“小程序云开发”如下图所示：创建好了之后项目目录如下,先看 1 标注的地方：如果你曾经有过小程序的开发经验那么miniprogram文件夹下面的结构你肯定熟悉了miniprogram下面的子目录分别是小程序对应的组件、图片、页面、样式以及app.js,app.json,sitemap.json,其中components下面的vant-weapp就是上面提到的 ui 组件。最后一个比较重要的文件夹就是cloudfunctions这个目录是用来存放“云函数的”云函数就是我们的后端。每一个云函数提供一个服务。一个个的云函数组成了我们整体的后端服务。云函数可以看做是 FaaS（function as a service）。途中2 标记的位置的“云开发”按钮我们点进去就可以看到“云开发的控制台”如下图所示：如果上图看不清楚可以复制链接到新的浏览器窗口查看如图小程序云开发默认的免费套餐有一定的额度可供使用。首页便是使用统计。然后我们能看到有“数据库”“存储”“云函数”。这里的“数据库”其实就是类似于一个 MongoDB你可以点进去创建一个个的 collection（即：关系型数据库中的table）;这里的“存储”其实就是“文件夹”我们可以通过微信提供的 api把图片上传到“存储”中；这里的“云函数”就是我们需要实现的后端业务逻辑他就是一个个的函数（函数由我们自己写好后上传）。一般开发过程中我们在开发者工具中的cloudfunctions目录下创建云函数（比方说是:user-add）开发完成之后在云函数目录点击右键——上传即可。然后就可以在小程序的代码中调用这个user-add云函数。云开发之——3 分钟实现文件上传#注意：在开始云开发之前我们现在 小程序代码的 app.js 中加入wx.cloud.init,如下：CopyApp({  onLaunch: function () {    if (!wx.cloud) {      console.error('请使用 2.2.3 或以上的基础库以使用云能力')    } else {      wx.cloud.init({        // env 参数说明：        //   env 参数决定接下来小程序发起的云开发调用（wx.cloud.xxx）会默认请求到哪个云环境的资源        //   此处请填入环境 ID, 环境 ID 可打开云控制台查看        //   如不填则使用默认环境（第一个创建的环境）        env: 'your-env-id',        traceUser: true,      })    }    this.globalData = {}  }})上面的图中我们已经看到了“商品添加”页面的效果它需要我们输入商品名称、价格、并上传图片然后保存。传统架构中上传图片需要前端页面摆一个控件然后后端提供一个 api用来接收前端传来的文件通常来说这个后端 api 接收到图片之后会将图片文件保存到自己的文件服务器或者是阿里云存储、或者是七牛云存储之类的。然后返回给你一个文件链接地址。非常麻烦然而小程序云开发上传文件超级简单上代码：Copy页面代码：<van-notice-bar  scrollable=\"false\"  text=\"发布商品\"/>  <van-field    value=\"{{ productName }}\"    required    clearable    label=\"商品名称\"    placeholder=\"请输入商品名称\"    bind:change=\"inputName\"  />    <van-field    value=\"{{ productPrice }}\"    required    clearable    label=\"价格\"    icon=\"question-o\"     bind:click-icon=\"onClickPhoneIcon\"    placeholder=\"请输入价格\"    error-message=\"{{phoneerr}}\"    border=\"{{ false }}\"    bind:change=\"inputPrice\"  /><van-action-sheet  required  show=\"{{ showSelect }}\"  actions=\"{{ actions }}\"  close-on-click-overlay=\"true\"  bind:close=\"toggleSelect\"  bind:select=\"onSelect\" cancel-text=\"取消\"/>  <van-field    value=\"{{ productCategory }}\"    center    readonly    label=\"商品分类\"    border=\"{{ false }}\"    use-button-slot  >    <van-button slot=\"button\" size=\"small\" plain type=\"primary\"       bind:click=\"toggleSelect\">选择分类</van-button>  </van-field>    <van-button class=\"rightside\" type=\"default\" bind:click=\"uploadImage\" >上传商品图片</van-button>  <view class=\"imagePreview\">    <image src=\"{{productImg}}\" />  </view> <van-submit-bar  price=\"{{ totalShow }}\"  button-text=\"提交\"  bind:submit=\"onSubmit\"  tip=\"{{ false }}\" > </van-submit-bar> <van-toast id=\"van-toast\" /><van-dialog id=\"van-dialog\" />这里有个控件绑定了uploadImage方法其代码为：Copy  uploadImage:function(){    let that = this;    wx.chooseImage({      count: 1,      sizeType: ['compressed'],      sourceType: ['album', 'camera'],      success(res) {        wx.showLoading({          title: '上传中...',        })        const tempFilePath = res.tempFilePaths[0]        const name = Math.random() * 1000000;        const cloudPath = name + tempFilePath.match(/\\.[^.]+?$/)[0]        wx.cloud.uploadFile({          cloudPath:cloudPath,//云存储图片名字          filePath: tempFilePath,//临时路径          success: res => {            let fileID = res.fileID;            that.setData({              productImg: res.fileID,            });            wx.showToast({              title: '图片上传成功',            })          },          fail: e =>{            wx.showToast({              title: '上传失败',            })          },          complete:()=>{            wx.hideLoading();          }        });      }    })  }这里wx.chooseImage用于调起手机选择图片（相册/相机拍照）然后wx.cloud.uploadFile用于上传图片到上面说到的云开发能力之一的“存储”中。上传图片成功之后返回一个文件 ID类似：Copycloud://release-0kj63.7265-release-0kj63-1300431985/100477.13363146288.jpg  这个链接可以直接在小程序页面展示：Copy<image src=\"cloud://release-0kj63.7265-release-0kj63-1300431985/100477.13363146288.jpg  \" />也可以通过微信 api装换成 http 形式的图片链接。云开发之——操作数据库1 分钟写完保存商品到数据库的代码#上面我们实现了商品图片上传但是商品图片并没有保存到数据库。正常录入商品的时候我们会填好商品名称价格等然后上传图片最终点击“保存”按钮将商品保存到数据库。传统模式下前端仍然是需要调用一个后端接口通过 post 提交数据最终由后端服务（比如 java 服务）将数据保存到数据库。小程序云开发使得操作数据库十分简单首先我们在云开发控制台创建“商品表”即一个 collection,取名为：products。然后我们就可以保存数据到数据库了代码如下：CopyonSubmit:function(){    // 校验代码略    let product = {};    product.imgId = this.data.productImg;    product.name= this.data.productName;    product.categoryId = this.data.productCategoryId;    product.price = this.data.productPrice;    // 其他赋值略    const db = wx.cloud.database();    db.collection('products').add({     data: product,     success(res) {       wx.showToast({         title: '保存成功',       })     }   });  }以上就实现了数据入库就这点代码超简单1 分钟写完诚不欺我。其中这里的products就是我们的“商品表”之前说过类似 MongoDB 数据库这里操作的是db.collection这和 MongoDB 的语法差不多。云开发之——使用云函数完成后端业务逻辑订单创建#小程序云开发提供了几大能力：“数据库”“存储”“云函数”前两项我们已经有所体会了。下面我们能创建一个云函数来实现订单创建。这里说明云函数其实就是 一段JavaScript 代码上传至云服务器之后最终也是运行在 nodejs 环境的只是这一切我们不需要关心。我们只需要关心我们这个云函数提供的功能是什么就可以了。创建云函数很简单直接在开发工具中右键“新建Node.js 云函数”。然后以创建订单为例假设我们创建一个云函数名为c-order-add,创建好了之后目录是这样：云函数的主要代码在 index.js 中其完整代码是这样：Copy// 云函数入口文件const cloud = require('wx-server-sdk')cloud.init({  env: 'release-xxx'// your-env-id})const db = cloud.database()// 云函数入口函数exports.main = async (event, context) => {  const wxContext = cloud.getWXContext();  console.log(\"云函数 c-order-add : \")    // 这里是一些逻辑处理...    return await db.collection('uorder').add({    data: {      openid: event.userInfo.openId,      address: event.address,      userName: event.userName,      phone: event.phone,      shoppingInfo: event.shoppingInfo,      totlePrice: event.totlePrice,      shoppingStr: event.shoppingStr,      remark:event.remark,      createTime: now,      // ...    }  });}这个云函数写好之后需要上传到服务器直接在云函数目录点击右键然后点击“上传并部署”即可这就相当于部署好了后端服务。前端小程序页面调用的写法是这样的：Copylet orderData={};orderData.userName = this.data.userName;orderData.phone = this.data.phone;orderData.address = this.data.address;// ....wx.cloud.callFunction({      // 云函数名称      name: 'c-order-add',      // 传给云函数的参数      data: orderData,      complete: res => {        Dialog.alert({          title: '提交成功',          message: '您的订单成功即将配送请保持手机通畅。'        }).then(() => {          // ....          wx.redirectTo({            url: '../uorder/uorder'          });        });      }})这里向程序前端通过wx.cloud.callFunction完成了对云函数的调用也可以理解为对后端服务的调用。至此我们我们介绍完了小程序云开发的功能。虽然我只贴出了少量的代码即保存商品和提交订单。由于时间和篇幅有限我不可能把整个完整的程序代码贴出来。但是你可以参照这个用法示例将剩下的业务逻辑补充完整最终完成“项目构思”一节中展示的成品截图效果。小程序审核的一点经验#我开发的小程序审核在提交审核的时候遭遇了两次退回第一次是因为：“小程序具备电商性质个人小程序号不支持”。所以我只好申请了一个企业小程序号使用的是超市的营业执照。服务类目的选择也被打回了一次最后选择了食品还提交了食品经营许可证。第二次打回是因为：“用户体验问题”。其实就是“授权索取”的问题微信不让打开首页就“要求授权”同时不能强制用户接受授权得提供拒绝授权也能使用部分功能。上面两条解决之后更新新了好几版都没有出现过被拒的情况。并且有次我是夜晚 10 左右提价的审核结果10 点多就提示审核通过当时没看具体时间就是接盆水泡了个脚的时间审核通过了。所以我推断小程序审核初次审核会比较严之后如果改动不大应该直接机审就过了。总结及对比#这里我们可以对小程序云开发和传统模式做一个对比：就对比这么多吧总之我非常喜欢小程序云开发小程序真的可以让你轻松干全栈。或者咱们别动不动就提“全栈”姑且说小程序云开发可以让你更简单、更快速、更便宜的实现你的产品落地。我自己开发的云小程序上线之后使用了一两个月没出现任何问题。我也不用操心服务器什么的。所以我已经给身边很多人安利了小程序云开发了。这里我就不贴出我的小程序码了因为已经正式给我同学的超市使用了所以不方便让别人去产生测试数据。如果你感兴趣想看的话可以联系我。作者： 逃离沙漠出处：https://www.cnblogs.com/demingblog/p/11914354.html本站使用「CC BY 4.0」创作共享协议转载请在文章明显位置注明作者及出处。如果本文对您有帮助不妨点个「推荐」及「赞赏」                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    uniapp登录流程详解uni.login               小程序顶部导航栏可滑动可动态选中放大效果                                                        原作者:  逃离沙漠                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序 - 验证码倒计时组件 ", "author": "                  Rolan                  2018-12-27 00:08                ", "text": "                                                                                                                                                                                     发送验证码倒计时的方法很常见在项目里面也经常会多次用到这时就要把倒计时封装为组件需要用到的时候方便使用。自定义组件需要封装一个组件首先要熟悉小程序自定义组件的文档。官方文档在这里倒计时组件为了方便描述我把页面定义为父组件把倒计时组件定义为子组件吧。首先需要清楚子组件与父组件之间事件的响应方法例如：子组件响应父组件的事件子组件修改父组件的data属性等。小程序没有像Vue里面的watch模式也没有computed计算属性但是还好小程序properties里有observer官方文档说observer表示属性值被更改时的响应函数那这样就好办了。当子组件倒计时完成之后需要告诉父组件子组件已经完成了倒计时这里可以用到方法传递的e.detail来处理。子组件代码countdown.jsComponent({  /**   * 组件的属性列表   */  properties: {    // 是否开始倒计时    start: {      type: Boolean,      value: false,      observer(newVal){        if (newVal === true) {          this.countdownFunc()        }      }    }  },  /**   * 组件的初始数据   */  data: {    timerText: '获取验证码'  },  /**   * 组件的方法列表   */  methods: {    /**     * 触发页面点击事件     */    _getCountdownEvent(){      this.triggerEvent(\"getCountdownEvent\")    },    /**     * 触发页面修改data事件     */    _setStartDataEvent() {      this.triggerEvent(\"setStartDataEvent\", this.data.start)    },    /**     * 倒计时     */    countdownFunc() {      this.setData({        timerText: 60      })      let target = this      let countdownNum = target.data.timerText      let timer = setInterval(() => {        countdownNum--        target.setData({          timerText: countdownNum        })        if (countdownNum == 0) {          target.setData({            timerText: '重新发送',            start: false          })          this._setStartDataEvent() //倒计时为0时让父组件的start重新设置为false                    clearInterval(timer) //清除定时器        }      }, 1000)    }  }})复制代码显示的倒计时（timerText）可以根据自己需求重新修改。countdown.wxml<view bindtap=\"_getCountdownEvent\">{{timerText}}{{start?'s后重试':''}}</view>复制代码页面使用调用组件需要在相应的json文件里面注册这个我就不说了。父组件代码sendRandom.wxml<countdown id=\"sendRandom\"     start=\"{{start}}\"    bind:getCountdownEvent=\"_getCountdownEvent\"    bind:setStartDataEvent=\"_setStartDataEvent\"    ></countdown>复制代码sendRandom.jsPage({  /**   * 页面的初始数据   */  data: {    start: false  },  /**   * 点击获取验证码   */  _getCountdownEvent(e) {    // todo: 点击获取验证码之后可以根据自己的需求通知子组件可以开始倒计时了  // 如： 向后台请求发送验证码的方法请求成功之后将start设置为true表示倒计时开始了。        if (this.data.start === true) {      return    }    this.setData({      start: true    })  },  /**   * 倒计时结束 设置setData为false   */  _setStartDataEvent(e){    if (e.detail === false) {      this.setData({        start: false      })    }  }  })复制代码结语以上是根据自己公司的需求封装的倒计时组件写得不够优雅只是想记录一下小程序自定义组件的互相传值和事件响应。如有更好的方法可以提供下思路。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序授权弹窗               从入到放弃——快应用踩坑之路                                                        原作者: krypton                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序倒计时深究                                                                                               "},{"title": "【重构】微信小程序倒计时组件 ", "author": "                  Rolan                  2018-8-7 00:12                ", "text": "                                                                                                                                                                                     回想在4个月前刚刚进入公司实习时我封装了一个应用于小程序的倒计时组件。链接在这里： 微信小程序之倒计时组件以现在的视角再去看之前的实现可以说是一坨看不下去的烂代码。所以也借此机会将之前的组件重构一番。重构旧代码在原来的组件中有一个initDuration属性和3个方法3个方法分别是countDownformat和runCountDown。initDuration属性首先我们需要三个page属性来帮助完成接下来的代码它们的名字和内容如下：timer: null, // 存储setInterval的IDflag: false, // 倒计时是否结束的标志num: 0 // 过去的秒数复制代码在initDuration属性的新的回调方法中我们封装了clearTimer方法init初始化方法并且执行倒计时。initDuration: {  type: Number,  value: 0,  observer: function (newVal) {    if (this.timer) {      this.clearTimer()    }      this.init() // 重置num和flag    this.runCountDown(newVal)  }},复制代码一定要注意当传入的属性的值为默认值例如这里是0时是不会触发observer回调的。/** * 初始化函数 */init: function () {  this.flag = false  this.num = 0}/** * 清空计时器 */clearTimer: function () {  clearInterval(this.timer)  this.timer = null}复制代码countDown方法countDown方法是接受一个参数为倒计时的秒数返回一个倒计时的字符串。在这个方法中没有太大改动只是改动了一些代码格式。如下：/** * 计算倒计时 * @param {Number} duration - 秒数时间差 * @returns {string} 倒计时的字符串 */countDown: function (duration) {  if (duration <= 0) {    this.setFlag(true) // 将flag属性设为true    return '00:00:00' // 返回默认时间设置  }  let seconds = this._format(duration % 60)  let minutes = Math.floor(duration / 60)  minutes = minutes >= 60 ? this._format(minutes % 60) : this._format(minutes)  let hours = this._format(Math.floor(duration / 3600))  return `${hours}:${minutes}:${seconds}`},复制代码format方法format方法的作用很简单就是处理小于10的数字展示问题。/** * 格式化小于10的数字 * @param {Number} time - 小于10的数字 * @returns {string} 格式化后的字符串 */format: function (time) {  return time >= 10 ? time : `0${time}`},复制代码runCountDown方法runCountDown方法中的改动比较大在原来的代码中逻辑比较混乱穿插了许多无关的代码其实应该将它们封装起来达到解耦的目的。runCountDown: function (initDuration) {  // 第一次给倒计时赋值 this.setData({ countDownStr })  this.setCountDownTime(this.countDown(initDuration))  // 每一秒更新一次倒计时  this.timer = setInterval(() => {    if (this.flag == true) { // 倒计时结束      clearInterval(this.timer)      return undefined    }    this.addNum() // this.num += 1    this.setCountDownTime(this._countDown(initDuration - this.num))  }, 1000)},复制代码增加新功能我们原来的倒计时组件是缺乏一些功能的例如传入的时间只能是秒数倒计时结束后只显示00:00:00如果传入的值是0的话会不进行初始化（这算是Bug了）。所以我们需要加入以下的新功能：支持自定义倒计时结束后现实的字符串。修复传入值为0的Bug。传入的时间可以是秒数也可以是UTC时间的字符串。自定义结束字符串在倒计时组件中展示倒计时字符串的是this.data.countDownTime属性。所以在结束时将countDownTime属性的值设为传入的字符串即可。 首先封装一个赋值方法setEndContent: function (countDownTime) {  if (countDownTime) {    this.setData({ countDownTime })  }}复制代码接下来为组件新增加一个属性为 endContent 。endContent: {  type: String,  value: '00:00:00'}复制代码接下来在倒计时结束的位置调用我们的赋值方法也就是runCountDown方法的计时器回调函数中。this.timer = setInterval(() => {  if (this.flag == true) {    clearInterval(this.timer)        this.setEndContent(this.properties.endContent) // 设置结束字符串        return undefined  }      this.addNum()  this.setCountDownTime(this._countDown(initDuration - this.num))}, 1000)复制代码这样自定义字符串就成功了在使用组件时传入默认值即可。修复传入值为0的Bug这个问题的出现是因为当传入属性为默认值时不会调用observer回调函数所以这时我们需要使用组件的 attached 生命周期函数。attached: function () {  if (this.properties.initDuration <= 0) {    // 如果传入值为零时不会调用observer回调则直接从这里展示倒计时结束    this.setEndContent(this.properties.endContent)  }}复制代码可以传入UTC时间字符串为了简洁起见我们就不为组件增加新的属性了依然使用initDuration属性所以要将其type从Number改为null（小程序的这点不够强不能选择多类型。）。在修改type后我们需要封装一个将UTC时间字符串解析成倒计时秒数的方法。parseDate: function (date) {  if (typeof date == 'string') {    // 将传进来的时间减去现在的时间得到的结果便和直接传进数字值相同    return Math.floor((+new Date(date) / 1000)) - Math.floor((+new Date / 1000))  }    return date}复制代码在observer回调中调用时如下:initDuration: {  type: null,  observer: function (newVal) {    if (this.timer) {      this._clearTimer()    }      this._init()    this._runCountDown(this.parseDate(newVal)) // 在这里调用parseData方法  }}复制代码总结在这次重构过程中我看到了之前代码耦合太严重仅仅满足了凑合用的情况。如果想要再此基础上增加功能的成本很高所以将内部逻辑拆分。既方便阅读和理解也方便日后拓展功能。所以重构后我们便增加了两个新功能希望这边文章可以帮助大家。倒计时组件代码： github.com/MeloGuo/wxm…可将'count-down'文件夹直接copy到项目目录下使用。欢迎喜欢、关注、star、fork当然也欢迎pr、issue.                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序iOS端如何暂停animated动画               第一个mpvue小程序开发完了来总结下吧                                                        原作者: MeloGuo                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序倒计时组件更新加入时间校准功能                                                      • 微信小程序电商常用倒计时                                                      • 微信小程序之倒计时                                                      • 微信小程序之倒计时插件   wxTimer                                                      • 小程序验证码倒计时                                                      • 小程序条形倒计时动画                                                      • 小程序倒计时深究                                                                                               "},{"title": "支付系统：线上支付的对接流程 ", "author": "                  Rolan                  2019-12-23 00:04                ", "text": "                                                                                                                                                                                     本文作者主要从入网流程、支付流程和对账流程3个方面对支付系统进行了梳理与大家分享。做支付产品也有一段时间了简单梳理一下作为线上商户从入网到对账的流程也作为这段时间工作的总结。入网流程1. 确定支付方式首先需要确定的是支付场景选择合适的支付方式。简单列一下主流产品端及常用支付方式：从用户体验来说PC端支付方式可以选择聚合支付即同一个二维码支持各主流支付App扫码支付；App端一般要支持微信、支付宝支付；而微信公众号、小程序支持微信也就够了虽然也可以通过使用浏览器打开方式实现支付宝支付但用户体验并不是很好。从产品本身角度来说特别是跨端产品快捷支付是个合适的选择而且由于快捷绑卡需要四要素验证也实现了用户实名但也因为需要用户输入四要素很多对信息敏感的用户会排斥绑卡。网银虽然是个仅PC端支持且用户支付相对麻烦的支付方式但却适合大额支付限额相比其他支付方式要高上许多。银联云闪付、手机闪付的优势在于银联总是很乐于搞各种满减、随机立减活动优质商家可以多利用银联资源实现双赢。上面列举的支付方式主要针对C端用户若产品面向的是B端用户可以考虑企业网银或直接线下汇款。2. 确定收单机构确定了支付方式后就要选择收单机构了：如果是需要的支付方式比较单一如只需要微信或支付宝那直接入网微信、支付宝就可以了；如果需要支持多个支付方式且对费率比较敏感可以尝试比较一下市面上的第三方收单机构或是知名的第四方聚合支付公司比较下其提供的产品及费率。3. 入网不同机构要求的入网材料不尽相同但大致为营业执照信息、结算账户信息及经营相关信息按照选择的机构要求准备就可以了。协议签订完成后机构会下发商户号、证书等参数可进行下一步技术对接。支付流程不同收单机构、支付方式接口都不一样但是一般流程差别不大拿微信举例主要接口如下：统一下单、支付接口、支付结果通知、查询订单、申请退款、查询退款及下载对账单。具体开发流程各收单机构文档都会写的非常详细就不再赘述了主要说几个我认为需要注意的点：1. 支付成功以后台通知为准这点我是确实吃亏了的当时接手产品的时候大部分支付通道都已经完成了对接且线上跑了很久所以并没有要求技术重新梳理流程。后来某天财务找我来说支付宝短款了找技术查询才发现技术对支付宝订单的处理是前台回调成功订单就更改为支付成功。一般情况下前台通知和后台通知确实状态是一致的但是当不一致的时候后台通知才是准确的。这次问题造成了我司短款印象深刻。不过以后台通知为准如果通知晚了会稍影响用户体验建议如下处理：当前台回调之后查询后台交易状态是否已经收到通知并更改为支付成功若还是支付中则主动发起订单查询接口查询订单支付状态。2. 增加支付掉单处理设计产品除了要考虑正常流程外也需增加异常处理特别是涉及真金白银的支付交易更为敏感一些。一般认为网络异常等原因造成的交易状态不明是小概率事件但就实际处理中确实时有发生所以建议增加支付掉单处理即当未收到明确应答时反查交易状态为节省系统资源可设置合理的查询次数且查询时间间隔递增。偶尔也会有个别交易掉单确实超过了系统自动处理的次数或时效可以根据对账流程来进行差错处理。3. 重复支付处理重复支付大部分时候是因为支付掉单引起的用户看到自己扣款成功订单依然还是待付款会产生疑问一般不会继续付款但如果是一些限量、限时活动或用户未注意到扣款成功等情况就有可能产生重复支付。可以做的处理是在订单已完成支付的情况下再次收到另一笔支付完成的通知则进行退款若考虑资金安全认为系统自动退款有风险可以在第二日对账出现差异后再做处理。4. 增加退款重试机制如果结算时间是T+1且金额自动提现结算实体户隔日退款容易碰到当日头寸或账户余额不足造成的退款失败。一种避免方式是推迟退款时间如凌晨退款交易统一推迟至早9点后发起但依然很难完全避免失败。二是系统增加退款重试若退款碰到该类报错则推迟到下午或晚上再次重试退款。对账流程正常情况下收单机构提供的对账文件与收到的结算款总是对的上的系统主要关心对账文件是否与订单匹配。一般至少勾兑流水号、交易时间、交易类型及交易金额而手续费以收单机构提供的为准。差异部分主要有如下几种情况：1. 对账文件多用户重复支付超额支付部分需进行退款；支付掉单若订单未取消则更改订单状态为支付完成若订单已取消则需进行退款。2. 对账文件少可能为日切造成的差异支付记录参与后续勾兑连续2天未勾兑成功记录勾兑失败人工参与处理。3. 金额差异金额差异很少会出现如出现差异需要人工参与看是否系统出现了问题。以上就是我的一点看法比较浅显有不足之处欢迎与我交流作者：湘允儿wx：x_yuner本文由 @湘允儿 原创发布于人人都是产品经理未经作者许可禁止转载。题图来自Unsplash基于CC0协议。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序云函数与自研框架的一次碰撞               Mpx 小程序框架技术揭秘                                                        原作者: 湘允儿                   来自: 人人都是产品经理                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "百度小程序与微信小程序全面对比 ", "author": "                  Rolan                  2019-10-14 00:38                ", "text": "                                                                                                                                                                                     百度小程序已出来一段时间了本文分享我在开发过程中遇到的一些百度小程序与微信小程序的差别。帮助你快速转换微信小程序到百度小程序。文档地址：https://smartprogram.baidu.com/docs/develop/tutorial/codedir/有遇到问题的可以去百度小程序社区提问：https://smartprogram.baidu.com/forum/（需要登录并且有appid）。本文分享一些百度小程序与微信小程序的差别。百度小程序组件hidden属性区别虽然百度小程序没提到这个属性但我测试发现它在本地上和真机上都是支持的。但跟微信还是有一点区别：js:data: {\tflag:'123'}xml:<view hidden=\"true\">1</view><view hidden=\"false\">2</view><view hidden=\"!false\">3</view><view hidden=\"{{false}}\">4</view><view hidden=\"!flag\">5</view><view hidden=\"flag\">6</view><view hidden=\"{{flag}}\">7</view><view hidden=\"{{!flag}}\">8</view><view hidden=\"{{!!flag}}\">9</view><view hidden=\"\">10</view>百度小程序输出：248微信输出：4810百度：当hidden的值为flase或者插值{{false}}为flase时百度组件不会隐藏。其它情况不管是true或者是空或者其它值不为false或者计算出来的值不为flase都会被隐藏。微信：当这个hidden属性为空或者插值{{false}}为false才不会隐藏。有一种特殊情况就是直接赋值它为hidden=\"false\"这里的false不被当做布尔值所以它也被隐藏。结论：从上面这两个之中我们可以看到 4 和 8 两者都有那我们做的时候只需要保证 hidden 的值为插值形式并且插值的结果是布尔值那两者就能得到一致的表现。js文件命名空间wx.替换为swan.wx.request() -> swan.request()wx.showModal() -> swan.showModal()wx.canIuse() -> swan.canIuse()……swan文件整体替换wx:到s-主要有两个地方：1.条件判断wx:if -> s-if2.列表循环wx:for -> s-forwx:for-item -> s-for-itemwx:key -> s-key这里还有3点跟微信使用起来有点区别1.for循环里面百度是不支持跟if放在同一条语句里面。我们可以通过增加一个block来判断条件2.条件判断百度是没有使用插值计算。这是微信的：<view wx:if=\"{{condition}}\"> True </view>这是百度的：<view s-if=\"condition\"> True </view>3.组件中的3元运算符不支持 <= 判断猜测可能是bug可能是里面使用了正则判断。<view>{{ 1 <= 2 ? 'yes' : 'no' }}</view>解析出来的内容为：<view>true<=\"\" view=\"\"></=></view>解决方法是改成 >=或者<<view>{{ 2 >= 1 ? 'yes' : 'no' }}</view>模板1.声明需要使用的模板data 是所需要传入到模板的值当它是对象时对象字面量是三个大括号包裹微信是{{}}。<!-- template-demo.swan--><template name=\"person-card\">    <view>        <text>位置: {{pos}}</text>        <text>姓名: {{name}}</text>    </view></template><!-- template-demo.swan--><template is=\"person-card\" data=\"{{{person}}}\" />// template-demo.jsPage({    data: {        person: {name: 'Lebron James', pos: 'SF', age: 33}    }});2.不支持动态调用<template name=\"tid-1\">    <view>1</view>    <view>{{index}}:{{msg}}</view></template><template name=\"tid-2\">    <view>2</view>    <view>{{index}}:{{msg}}</view></template>当我需要根据tid值来调用某个模板时例如tid=1时使用下面的方法调用<template is=\"tid-{{tid}}\" data=\"{{{...item}}}\"/>Page({    data: {        tid:1    }});上面这种获取不了template tid-1的内容。我们可以通过条件判断来调用模板：<block s-if=\"{{ tid == 1}}\"><template is=\"template-1\" data=\"{{{...item}}}\" /></block>Page函数不要使用getData()由于我之前的页面中获取请求时用的是这个函数然后我发现百度小程序里面这个函数在onload中无法执行到。另外就是如果直接点击执行这个函数会报错。页面传递参数option最好加上enCodeURIComponent()我之前的一个微信小程序传递url时参数没有格式化直接传递后在百度小程序中会发现接收不完整例如：http://xsps.pchouse.com.cn/ 转化为 http:/xsps.pchouse.com.cn。swan.createSelectorQuery()这个API要在页面DOM 加载完毕后执行才能获取到具体的值如果你直接在onload或者request 的success 里面setData后获取值同样获取不到内容可以在onReady里面获取到。有一种做法就是加一个定时器在2秒后获取或者改为当需要的时候才开始获取。不要使用HTML标签在百度小程序中使用了div/ul/li等HTML标签调试swan tab时标签会被过滤掉。<div class=\"list\">\t<ul>\t\t<li bindtap=\"test\">测试</li>\t\t<li>测试</li>\t\t<li>测试</li>\t</ul></div>.list ul{font-size:18px;}test:function(){\tconsole.log('test');}会发现样式不起作用。另外就是绑定事件也无法起作用,如上面的test,点击后无效跟刚才说的li标签被过滤同样的道理。tabBar配置决定了首页在app.JSON中我改了一下pages首页的位置发现并不起作用反而tabBar改了第一个标签的地址后首页也跟着改变而微信是支持tabBar可以不是首页进来的页面。wxs 改为 filter微信的：WXS（WeiXin Script）是小程序的一套脚本语言结合 WXML可以构建出页面的结构。<!--wxml--><wxs module=\"m1\">var msg = \"hello world\";module.exports.message = msg;</wxs><view> {{m1.message}} </view>页面输出：hello world百度的：Filter 是小程序的过滤器结合 SWAN 模版可以构建出页面的结构。// page.jsPage({  data: {    array: [1, 3, 6, 8, 2, 0]  }});// test.filter.jsexport default {    maxin: (arr) => {        var max = undefined;        for (var i = 0; i < arr.length; ++i) {            max = max === undefined ?            arr[i] :            (max >= arr[i] ? max : arr[i]);        }        return max;    }};<!-- swan模版 --><view>{{swan.maxin(array)}}</view><filter src=\"./test.filter.js\" module=\"swan\"></filter>页面输出：8自定义组件模板里面没法嵌套模板建议使用slot图片路径要补全协议如下面这两种情况如果没有补全协议会无法访问默认代码为静态解析<image src=\"//www1.pchouse.com.cn/2018/weixinminipro/loading.png\"></image>//css image{background:url(//www1.pchouse.com.cn/2018/weixinminipro/loading.png)}import 和 includeimport 注意微信中引入的是.wxml的文件百度这里引入的是.swan的文件所以要替换掉在 index.swan 中引用了 item.swan就可以使用item模板：<import src=\"item.swan\"/><template is=\"item\" data=\"{{{preson}}}\"/>同理 include也是改文件后缀<!-- index.swan --><include src=\"header.swan\"/><view> body </view><include src=\"footer.swan\"/>百度小程序分享到微信无法打开百度虽然提供了分享到微信朋友圈和微信好友的功能但打开微信分享的内容会先提示跳到App Store上并无法打开百度小程序的页面分享体验不好只能分享到百度APP自身的动态打开后才能访问。微信转换为百度小程序1.登录百度小程序开发工具在工具菜单有一个一键转换微信的小程序为百度小程序。（前提：有审核通过的appid并且登录开发者工具）用了官方的工具还是挺好的对照我上面提到的点小小的调整应该就差不多了。2.下载NPM上的一个工具：wx2swan。https://github.com/yican008/wx2swan跟百度这个转换好像差不多。安装： npm i -g wx2swan转换：wx2swan 微信小程序的目录 (生成swan的目录)wx2swan ./test/demo ./test/swanDemo3.使用 Taro 开发2018.11.20日更新：bindscrolltolower 执行多次scroll-view 组件的bindscrolltolower 会执行多次需要加上防抖处理预防接口重复加载导致数据更新混乱出现错误。<scroll-view bindscrolltolower=\"loadMoreList\"></scroll-view>Page({\ttimer:null,\tloadMoreList:function(){\t\tvar self = this;\t\tif(this.timer){\t\t\tclearTimeout(this.timer);\t\t}\t\tthis.timer = setTimeout(function(){\t\t\tconsole.log('your data');\t\t\tself.timer = null;\t\t},300);\t}})双向绑定1.scroll-view组件里面有三个属性是属性双向绑定<scroll-view scrollTop=\"{= scrollTop =}\" scrollLeft=\"{= scrollLeft =}\" scroll-into-view=\"{= scrollIntoView =}\"></scroll-view>2.input组件<input value=\"{= value =}\"/>真机的屏幕高度没有去掉tabBar高度2019.1.17号更新：在DOM加载完毕是正确的屏幕高度会去掉tabBar,所以应该在onReady生命周期里面处理。由于scroll-view组件需要确定高度在电脑上计算出来的高度是已经对的但到了真机上发现高度并没有减掉tabBar的高度导致有些地方被隐藏在tabBar下面。没办法我只能用了另外一种办法因为我怕到时候它修复了这个错误我一hack它这个高度那时候我又得改了。我给scroll-view的父类加了一个绝对定位属性。然后定义它的高度为100%接着在scroll-view的组件里面减去头部的导航高度。<view class=\"fix-menu\"></view><view class=\"tab-content\"><scroll-view class=\"content\"><view class=\"list\"></view></scroll-view></view>.fix-menu{height:100rpx; position:fixed; top:0; left:0; width:100%;}.tab-content{position:absolute; left:0; top:0; height:100%; width:100%;}.content{height:100%;}.content .list{padding-top:100rpx;}这样子就不需要去计算scroll-view的高度了。直接用css兼容也不用管百度这个bug了。不过微信的还是直接计算这个高度比较好这样子这个scroll-view刚开始时的滚动条就不会被隐藏掉100rpx。百度小程序分享安卓中分享到百度动态点击消息进入时无法进入具体页面只能进入当前页或者首页。2019.1.24更新API微信小程序有的API而百度小程序没有的一个表不对下面这些微信小程序API进行转换wx: {        startRecord,        stopRecord,        playVoice,        pauseVoice,        stopVoice,        getBackgroundAudioPlayerState,        playBackgroundAudio,        pauseBackgroundAudio,        seekBackgroundAudio,        stopBackgroundAudio,        onBackgroundAudioPlay,        onBackgroundAudioPause,        onBackgroundAudioStop,        openBluetoothAdapter,        closeBluetoothAdapter,        getBluetoothAdapterState,        onBluetoothAdapterStateChange,        startBluetoothDevicesDiscovery,        stopBluetoothDevicesDiscovery,        getBluetoothDevices,        getConnectedBluetoothDevices,        onBluetoothDeviceFound,        createBLEConnection,        closeBLEConnection,        getBLEDeviceServices,        getBLEDeviceCharacteristics,        readBLECharacteristicValue,        writeBLECharacteristicValue,        notifyBLECharacteristicValueChange,        onBLEConnectionStateChange,        startBeaconDiscovery,        stopBeaconDiscovery,        getBeacons,        onBeaconUpdate,        onBeaconServiceChange,        getHCEState,        startHCE,        stopHCE,        onHCEMessage,        sendHCEMessage,        startWifi,        stopWifi,        connectWifi,        getWifiList,        onGetWifiList,        setWifiList,        onWifiConnected,        getConnectedWifi,        setTopBarText,        showShareMenu,        hideShareMenu,        updateShareMenu,        getShareInfo,        addCard,        openCard,        getWeRunData,        checkIsSupportSoterAuthentication,        startSoterAuthentication,        checkIsSoterEnrolledInDevice,        faceVerifyForPay,    }微信小程序被废弃的接口建议用后面的接口替换createContext：被废弃的函数建议使用createCanvasContext替代drawCanvas：被废弃的函数建议使用createCanvasContext替代createAudioContext：建议用createInnerAudioContext两者有些不同的前面是微信百度的用后面的替换navigateToMiniProgram--->navigateToSmartProgram微信二级API目前百度不支持的createLivePusherContext自定义组件// Component构造器中不支持的属性    Component: {        moved: null,        relations: null    },    Behavior: {        // Behavior 中不支持自定义组件的扩展        // definitionFilter: null    },    // 自定义组件中this上不支持的属性和方法    this: {        getRelationNodes: null,        selectComponent: {            // 方法不允许被调用的作用域            notAllowParents: ['onLaunch', 'onShow', 'onLoad']        },        selectAllComponents: {            // 方法不允许被调用的作用域            notAllowParents: ['onLaunch', 'onShow', 'onLoad']        }    },    // 设置内置behaviors映射关系    behaviors: {        'wx://form-field': {            mapping: 'swan://form-field'        },        'wx://component-export': {            mapping: 'swan://component-export'        }    },    json: {        // 不支持抽象节点        componentGenerics: null    }左边是微信右边是百度template组件data属性转换问题: {{item}} => {{{item}}}<template is=\"person-card\" data=\"{{person}}\" />wx:for不同百度可以浓缩到一个属性里面。s-for=\"item,p in obj\"---> wx:for=\"{{obj}}\" wx:for-item=\"item\" wx:for-index=\"p\"转换wx.__route__成员表达式调用为wx.route参考链接搬家工具转换支持的Feature List百度小程序开发问题汇总                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序下找地点、查路线、搜地铁用这3个插件就够了！               使用uni-app开发小程序比直接原生开发小程序好在哪里？                                                        原作者: 4965View                   来自: caibaojian                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序营销组件：红包雨、大转盘、九宫格翻牌…… ", "author": "                  Rolan                  2019-6-12 00:23                ", "text": "                                                                                                                                                                                     前言商城没几个营销活动能叫商城吗？这里你能找到的有：1.红包雨2.大转盘3.九宫格翻牌4...所以就来几个组件吧写的不好轻踩对你有帮助记得给个小星星哦直接上链接github链接运行例子git clone https://github.com/sunnie1992/soul-weapp.git复制代码微信开发者工具打开项目营销组件大转盘 \"pages/wheel/index\" 九宫格翻牌 \"pages/gridCard/index\" 红包雨 \"pages/packetRain/index\" 页面\"pages/filter/index\" 功能筛选筛选预览                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序WebSocket实践               微信小程序前端实现自定义分享                                                        原作者: 乖摸摸头                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序条形倒计时动画 ", "author": "                  Rolan                  2018-5-17 00:12                ", "text": "                                                                                                                                                                                     一、效果图如下：二、wxml<view class='headpiece-time flex-row'>    <text class='headpiece-txt'>倒计时：</text>    <view class='headpiece-process'>        <view class='headpiece-process-inner' style=\"width:{{width}}%\"></view>    </view>    <text class='headpiece-num'>{{t}}</text></view>三、wxss.headpiece-num {    position: absolute;    top: -3rpx;    right: -35rpx;    width: 62rpx;    height: 100%;    text-align: center;}.headpiece-time {    position: relative;    width: 305rpx;}.headpiece-process {    position: relative;    width: 138rpx;    height: 14rpx;    margin-right: 14rpx;    border: 4rpx solid #000;    overflow: hidden;    background: #fff4b2;}.headpiece-process-inner {    position: absolute;    top: 0rpx;    left: 0rpx;    background: #f74242;    height: 100%;    transition: all 0.3s ease-out;}四、index.js/**     * 获取系统信息     */    getSystemInfo: function () {        return new Promise((a, b) => {            wx.getSystemInfo({                success: function (res) {                    a(res)                },                fail: function (res) {                    b(res)                }            })        })    },    /**     * 进度条动画     */    countdown: function () {        const requestAnimationFrame = callback => {            return setTimeout(callback, 1000 / 60);        }, cancelAnimationFrame = id => {            clearTimeout(id);        };        this.getSystemInfo().then(v => {            let maxtime = this.data.maxtime,                width = this.data.width,                sTime = +new Date,                _ts = this,                temp,                   animate;            (animate = () => {                temp = requestAnimationFrame(() => {                    let time = maxtime * 1000,                        currentTime = +new Date,                        schedule = 1 - (currentTime - sTime) / time,                        schedule_1 = schedule <= 0 ? 0 : schedule,                        width = parseInt(schedule_1 * 100),                        t = parseInt((this.data.maxtime) * schedule_1)+1;                    _ts.setData({                        width: width,                        t:t                    });                    if (schedule <= 0) {                        cancelAnimationFrame(temp);                        _ts.setData({                            width: width,                            t: 0                        });                        return;                    } else {                        animate();                    };                })            })();        });    },                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w五权95                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发--『狗蛋TV』               微信小程序-两个input叠加多次点击字体变粗或闪动                                                        原作者: 谭瞎                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序倒计时功能                                                      • 微信小程序之倒计时                                                      • 微信小程序之倒计时插件   wxTimer                                                      • 小程序验证码倒计时                                                      • 微信小程序iOS端如何暂停animated动画                                                      • 【重构】微信小程序倒计时组件                                                      • 小程序倒计时深究                                                                                               "},{"title": "小程序识别身份证，银行卡，营业执照，驾照 ", "author": "                  Rolan                  2019-10-31 00:32                ", "text": "                                                                                                                                                                                     最近老是有同学问我小程序ocr识别的问题就趁机研究了下实现了小程序识别身份证银行卡驾照营业执照图片文字的功能。今天来给大家讲讲详细的实现流程。先画一张流程图出来第一次看到这个流程图可能有点萌什么云开发云函数。。。。 不要着急我们接下来会一步步带大家实现。先看下我们的页面和效果图。功能其实很简单就是我们点对应的按钮后去拍照或者去相册选择对应的图片。然后把图片上传到云存储会有一个对应的图片url然后把这个图片url传递到云函数然后云函数里使用小程序的开发ocr能力来识别图片返回对应的信息回来。如下图所示我们识别银行卡（身份证什么的就不演示了涉及到石头哥个人隐私）接下来就是代码的实现了。一首先要创建一个云开发的小程序项目这里我前面文章有讲解过就不再细说了不会的同学去翻看下我之前的文章。或者看下我录制的 讲解视频 这里有一点需要注意的给大家说下二创建一个简单的小程序页面1index.wxml如下2index.js完整代码如下Page({  //身份证  shenfenzheng() {    this.photo(\"shenfenzheng\")  },  //银行卡  yinhangka() {    this.photo(\"yinhangka\")  },  //行驶证  xingshizheng() {    this.photo(\"xingshizheng\")  },  //拍照或者从相册选择要识别的照片  photo(type) {    let that = this    wx.chooseImage({      count: 1,      sizeType: ['original', 'compressed'],      sourceType: ['album', 'camera'],      success(res) {        // tempFilePath可以作为img标签的src属性显示图片        let imgUrl = res.tempFilePaths[0];        that.uploadImg(type, imgUrl)      }    })  },  // 上传图片到云存储  uploadImg(type, imgUrl) {    let that = this    wx.cloud.uploadFile({      cloudPath: 'ocr/' + type + '.png',      filePath: imgUrl, // 文件路径      success: res => {        console.log(\"上传成功\", res.fileID)        that.getImgUrl(type, res.fileID)      },      fail: err => {        console.log(\"上传失败\", err)      }    })  },  //获取云存储里的图片url  getImgUrl(type, imgUrl) {    let that = this    wx.cloud.getTempFileURL({      fileList: [imgUrl],      success: res => {        let imgUrl = res.fileList[0].tempFileURL        console.log(\"获取图片url成功\", imgUrl)        that.shibie(type, imgUrl)      },      fail: err => {        console.log(\"获取图片url失败\", err)      }    })  },  //调用云函数实现OCR识别  shibie(type, imgUrl) {    wx.cloud.callFunction({      name: \"ocr\",      data: {        type: type,        imgUrl: imgUrl      },      success(res) {        console.log(\"识别成功\", res)      },      fail(res) {        console.log(\"识别失败\", res)      }    })  }})上面代码注释讲解的很清楚了再结合我们的流程图相信你可以看明白。三重头戏来了识别的核心代码是下面这个云函数云函数的完整代码也给大家贴出来// 云函数入口文件const cloud = require('wx-server-sdk')cloud.init()// 云函数入口函数exports.main = async(event, context) => {  let {    type,    imgUrl  } = event  switch (type) {    case 'shenfenzheng':      {        // 识别身份证        return shenfenzheng(imgUrl)      }    case 'yinhangka':      {        // 识别银行卡        return yinhangka(imgUrl)      }    case 'xingshizheng':      {        // 识别行驶证        return xingshizheng(imgUrl)      }    default:      {        return      }  }}//识别身份证async function shenfenzheng(imgUrl) {  try {    const result = await cloud.openapi.ocr.idcard({      type: 'photo',      imgUrl: imgUrl    })    return result  } catch (err) {    console.log(err)    return err  }}//识别银行卡async function yinhangka(imgUrl) {  try {    const result = await cloud.openapi.ocr.bankcard({      type: 'photo',      imgUrl: imgUrl    })    return result  } catch (err) {    console.log(err)    return err  }}//识别行驶证async function xingshizheng(imgUrl) {  try {    const result = await cloud.openapi.ocr.vehicleLicense({      type: 'photo',      imgUrl: imgUrl    })    return result  } catch (err) {    console.log(err)    return err  }}其实没什么特别的就是用一个switch方法根据用户传入的不同的type值来实现不同的识别效果。 如用传入的type是‘ yinhangka’我们就调用银行卡识别try {    const result = await cloud.openapi.ocr.bankcard({      type: 'photo',      imgUrl: imgUrl    })    return result  } catch (err) {    console.log(err)    return err  }进而把识别的结果返回给小程序端如下图到这里我们就完整的实现了小程序识别身份证银行卡行驶证的功能。至于别的更多的ocr识别可以去看小程序官方文档结合着我的这篇文章相信你也可以轻松实现更多的图片识别。源码其实在上面都已经贴给大家了如果你觉得不完整想要完整的源码可以在文章底部留言或者私信我。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    介绍一个小程序预处理器               如何实现微信小程序图像剪切？代码拿去用不谢！                                                        原作者: 编程小石头                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序验证码倒计时 ", "author": "                  Rolan                  2018-4-13 00:21                ", "text": "                                                                                                                                                                                     现在好多小程序都没有用到手机号的登录因为可以直接调用微信的接口getPhoneNumber因为我们为了保持公众号小程序app后台的一致性又做了手机号的登录。问题：简单描述一下功能：输入手机号点击获取验证码。我必须在点击那个获取验证按钮之前在js中获取手机号。如何获取到input提交之前的输入值呢？3.小程序的收取短信的倒计时方法？解决方法：微信对input的组件提供了多个事件看来只能通过这些事件去实现   单个input的值的获取。bindblur 失去焦点事件e.detail.value取的这个对象的值js代码：//page中添加属性（事件）mobileInputEvent:function(e){    this.setData({      mobile:e.detail.value    }) },verifyCodeEvent:function(e){    if(this.data.buttonDisable) return false;    var that = this;    var c = 60;    var intervalId = setInterval(function(){      c = c-1;      that.setData({        verifyCodeTime:c + 's后重发',        buttonDisable:true      })      if(c==0){        clearInterval(intervalId);        that.setData({          verifyCodeTime:'获取验证码',          buttonDisable:false        })      }    },1000)    var mobile = this.data.mobile;    var regMobile = /^1\\d{10}$/;    if(!regMobile.test(mobile)){        wx.showToast({          title:'手机号有误！'        })        return false;    }    app.sendVerifyCode(function(){},mobile);//获取短信验证码接口}代码解释：mobileInputEvent代表输入的手机号码verifyCodeEvent代表点击验证码倒计时方法wxml代码：<!--使用animation属性指定需要执行的动画  --> <view animation=\"{{animationData}}\" class=\"drawer_box\" wx:if=\"{{showModalStatus}}\" > <!--drawer content--> <view class=\"drawer_title\">登录</view> <view class=\"drawer_content\"> <view class=\"top grid\"> <label class=\"title col-0\">手机号码</label> <input class=\"input_base input_h30 col-1\" placeholder=\"请输入手机号码\" value=\"\" bindblur=\"mobileInputEvent\" ></input> </view> <view class=\"top grid\"> <label class=\"title col-0\">验证码</label> <input class=\"input_base input_h30 col-1 code\" placeholder=\"验证码\" value=\"\" bindblur='codeInputEvent'></input> <view class=\"btn_code\" bindtap=\"getCode\" disabled=\"{{buttonDisable}}\" >{{verifyCodeTime}}</view> </view> </view> <view class=\"btn_ok\" bindtap=\"powerDrawer\" data-statu=\"close\">确定</view> <view class=\"btn_concel\" bindtap=\"concel\" >取消</view> </view>wxss代码:/**弹出框**/ .btn {   width: 80%;    padding: 20rpx 0;    border-radius: 10rpx;    text-align: center;    margin: 40rpx 10%;    background: #000;    color: #fff;  }    /*mask*/ .drawer_screen {   width: 100%;    height: 100%;    position: fixed;    top: 0;    left: 0;    z-index: 1000;    background: #000;    opacity: 0.5;    overflow: hidden;  }    /*content*/ .drawer_box {   width: 650rpx;    overflow: hidden;    position: fixed;    top: 50%;    left: 0;    z-index: 1001;    background: #FAFAFA;    margin: -150px 50rpx 0 50rpx;    border-radius: 3px;  }    .drawer_title{   padding:15px;    font: 20px \"microsoft yahei\";    text-align: center;  } .drawer_content {   height: 210px;    overflow-y: scroll; /*超出父盒子高度可滚动*/ }    .btn_ok{   padding: 10px;    font: 20px \"microsoft yahei\";    text-align: center;    border-top: 1px solid #E8E8EA;    color: #3CC51F;    float: right;} .btn_concel{  padding: 10px;    font: 20px \"microsoft yahei\";    text-align: center;    border-top: 1px solid #E8E8EA;    color: #3CC51F;    float: left; }   .top{     padding-top:8px;  } .bottom {     padding-bottom:8px;  } .title {     height: 30px;      line-height: 30px;      width: 160rpx;      text-align: center;      display: inline-block;      font: 300 28rpx/30px \"microsoft yahei\";  }    .input_base {     border: 2rpx solid #ccc;      padding-left: 10rpx;      margin-right: 100rpx;  } .input_h30{     height: 30px;      line-height: 30px;  } .btn_code{  background-color: gray;  width: 180rpx;  color: white;  margin-left: 20rpx;  font-size: 25rpx;  line-height: 60rpx;  text-align: center;}.input_view{     font: 12px \"microsoft yahei\";      background: #fff;      color:#000;      line-height: 30px;  } input {     font: 12px \"microsoft yahei\";      background: #fff;      color:#000 ;  } radio{     margin-right: 20px;  } .grid { display: -webkit-box; display: box; } .col-0 {-webkit-box-flex:0;box-flex:0;} .col-1 {-webkit-box-flex:1;box-flex:1;} .fl { float: left;} .fr { float: right;}操作的结果为：                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)王豪wheroic66                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 点击切换样式的功能实现               微信小程序之自定义dialog组件                                                        原作者: honey缘木鱼                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...                                                      • 微信小程序+WEB使用JS实现注册【60s】倒计时功能                                                      • 微信小程序开发--倒计时60s获取验证码                                                      • 微信小程序倒计时功能                                                      • 微信小程序之倒计时                                                      • 微信小程序之倒计时插件   wxTimer                                                      • 小程序条形倒计时动画                                                      • 【重构】微信小程序倒计时组件                                                      • 小程序倒计时深究                                                                                               "},{"title": "微信小程序之倒计时插件   wxTimer ", "author": "                  Rolan                  2018-3-28 00:22                ", "text": "                                                                                                                                                                                     介绍：　　用于在微信小程序中进行倒计时的组件。功能：　　1、最基础的当然就是倒计时功能了。　　2、可以设置倒计时结束后执行的事件。　　3、可以设置倒计时执行过程中每隔多少秒执行一次对应的事件。下载： wxTimer在JS中调用           1.在当前js引入　timer = require('../../plug/wxTimer.js')　　2.在全局app.js引入　　app.jsglobalData: {    userInfo: null,    timer: require('/plug/wxTimer.js')  }　　当前jsvar app = getApp().globalData,        timer = app.timer;最简单的调用方式：var wxTimer = new timer({    beginTime:\"00:00:10\"})wxTimer.start(this);wxTimer.stop();开启多个计时//开启第一个定时器var wxTimer1 = new timer({    beginTime:\"00:00:10\",    name:'wxTimer1',    complete:function(){        console.log(\"完成了\")    }})wxTimer1.start(this);//开启第二个定时器var wxTimer2 = new timer({    beginTime:\"00:01:11\",    name:'wxTimer2',    complete:function(){        console.log(\"完成了\")    }})wxTimer2.start(this);倒计时结束后执行事件var wxTimer = new timer({    beginTime:\"00:00:10\",    complete:function(){        console.log(\"完成了\")    }})wxTimer.start(this);间隔执行事件var wxTimer = new timer({    beginTime:\"00:00:10\",    complete:function(){        console.log(\"完成了\")    },    interval:2,    intervalFn:function(){        console.log(\"过去了2秒\");    }}) 校准时间wxTimer.calibration(); 结束计时wxTimer.stop(); 在wxml中引用单个计时器：<view>显示剩余时间：{{wxTimer}}</view><view>显示剩余秒数：{{wxTimerSecond}}</view>多个计时器：<view>显示计时器1的剩余时间：{{wxTimerList['wxTimer1'].wxTimer}}</view><view>显示计时器2的剩余时间：{{wxTimerList['wxTimer2'].wxTimer}}</view><view>显示计时器1的剩余秒数：{{wxTimerList['wxTimer1'].wxTimerSecond}}</view><view>显示计时器2的剩余秒数：{{wxTimerList['wxTimer2'].wxTimerSecond}}</view>注意：　　 1、由于内部需要调用到小程序的setData方法所以我们需要把this传过去。　　2、此方法会在page中生成一个名为wxTimerwxTimerSecond和wxTimerList的数据请保证这些key没有被占用 3、请在data中添加一条属性wxTimerList:{},否则将会报错。其他参数：　　 1、beginTime 需要倒计时的时间比如：\"01:11:12\"默认值为\"00:00:00\"也可以省略秒数如:\"01:10\"　　2、complete 倒计时归零0时的回调函数如果为beginTime = \"00:00:00\"则立即调用　　3、interval 倒计时的过程中规定每隔几秒执行一次intervalFn如果为0则永远不会执行默认为1　　4、intervalFn 每隔interval秒执行一次的函数。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)lyq                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序——动画操作时rpx 和 px 的转换计算               微信小程序群功能开发-前端篇                                                        原作者: 梦幻飞雪                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序wxTimer更新加入多计时器功能。                                                      • 【小程序】地图｜绘制GPX轨迹                                                      • 小程序验证码倒计时                                                      • 手把手教你开发微信小程序中的插件                                                      • 技术课 | 开发小程序插件遇到问题？微信开发哥来教你！                                                      • 小程序条形倒计时动画                                                      • 【重构】微信小程序倒计时组件                                                      • 小程序倒计时深究                                                                                               "},{"title": "BAT发力小程序，站在十字路口的开发者又当如何抉择？ ", "author": "                  Rolan                  2018-12-29 00:12                ", "text": "                                                                                                                                                                                     文|邻章这是一个最好的时代也是一个最坏的时代对于当下的互联网以及背后的应用开发者而言大抵或都如此。人口红利见顶流量板结化趋势明显用户获取成本高企诸多APP用户启用频率与停留时长偏低都成为了已进入下半场的互联网的显著挑战；但另一方面我们也看到：总有新的理念更新、技术发展、解决方案来破壁当前困境。诸如小程序在2018年的全面爆发就可以视作是巨头分享自家流量赋能中小应用成长的显著一例当然这其中巨头也是在利用自家流量、技术、服务在跑马圈地。一、巨头入局小程序开发者站上十字路口如我们所见2018把持当下中国网络用户社交、购物、搜索、资讯等核心需求的巨头玩家们悉数入场小程序开始抢占新移动时代的发展风口。而其中对于开发者的争夺正成为巨头们竞争的关键。这事实上并不难理解他们选择谁家平台做为核心耕耘平台那么这一平台未来的生态环境自然也就会会更为壮大这一逻辑与Android和iOS对开发者的竞争事实上是如出一辙。也正因如此各大平台拿出了优势与解决方案来争取开发者的欢心。可以说当下的小程序开发者们正处于一种久违的辛福感中——要扶持有扶持要流量有流量。但与此同时我们也能发现许多开发者面对究竟选择谁做为首选平台颇为举棋不定陷入了选择困难症。在我身边的一些朋友就时常身陷其中。的确从某种层面来说这也是他们的身不由己——看似拥有很多选择但往往却似乎有没有选择——毕竟他们多为没有资源、能力有限的小公司经不起折腾没有大公司的多轮试错机会多数的盘算是先将某一平台做大做强之后在实现多平台覆盖。所以从某种程度来说小程序开发平台的选择实际上是关乎其未来生死存亡的大事。这使得他们在面对各色小程序平台时又一次站在了十字路口徘徊四顾。二、选择核心发力平台需要多方权衡那么对于小程序开发者而言特别是当下尚不具备广撒网能力的众多中小开发者而言面对微信、百度、支付宝、今日头条等推出的小程序平台究竟选择谁家平台作为核心发力点才有可能更好更快的打响第一枪？事实上需要从平台的竞争激烈程度、扶持政策、流量规模、质量等多方权衡。（1）小程序平台竞争激烈程度：微信>百度=支付宝>今日头条从当下四大主要小程序平台的竞争现实来看微信小程序平台的竞争无疑是最为激烈。得益于微信在小程序上的先发优势其平台已有的小程序的数量在当下可以说是占据着绝对的领先优势。据36氪报道在12月6日微信小程序团队的闭门沟通会上公布的数据显示：当下已上线的微信小程序超过100万个。作为对比此前支付宝在9月份正式发布小程序时对外宣称：依靠自然增长支付宝小程序平台的小程序数量共计超过2万。这种数量差距可见一斑。对于正准备入局小程序的开发者而言已有百万级小程序存量的微信平台必然竞争变得分外激烈这使得微信小程序生态在事实上已经形成了非常明显的丛林法则——先来者已经在微信平台上已经占据了先机且在大概率上并不会允许后来者冒头这就犹如当下的App Store虽然有着数以百万计的APP却鲜有后来居上者多数都是死应用。所以从这个层面来说对于现在准备入局小程序的开发者而言选择微信平台并不见得是个明智的决定反而选择百度、支付宝、今日头条这些平台或许更为有利可图。毕竟这些平台的小程序竞争在当下的并不是特别激烈这使得开发者在这些平台能够拥有大得多的成功几率即使从概率来说。另一方面百度、支付宝、今日头条这些平台同样也拥有过亿的月活数据也为开发者提供了流量保底。诸如在11月初召开的百度世界大会上百度就对外宣布称：“在过去120天内百度智能小程序月活用户已经超过1.5亿成功覆盖了262个细分领域。”在此之前支付宝也宣称其小程序日活达1.2亿。（2）小程序平台的扶持力度：百度>微信支付宝>今日头条从现实来说对于小程序这一战略级产品除开今日头条BAT三大平台事实上都拿出了自己的开发者扶持计划。微信小程序推出了一站式小程序云计划宣布在微信小程序在资金方面提供一亿元云基金；在技术层面提供开发、编译、一站式部署等支持在投资上则是举办开发者大赛等。支付宝小程序拿出了STS扶持计划宣布在三年内拿出10亿元扶持资金用于激励、孵化支付宝小程序生态创业者；在技术支撑上则表示将为开发者提供平台运营能力、深度培训指导等业务资源扶持；在投资上则是推出了科技创新、新租赁经济、本地生活专项领域投资扶持。百度智能小程序则是推出了开发者共筑计划宣布将为智能小程序开放全域千亿级别的用户流量；提供百亿联盟的广告分成；并且成立一个提供专门扶持和推广智能小程序的十亿创新基金以及一对一专人服务线上线下公开课等。综合对比来看BAT三大小程序平台在对开发者的扶持力度上百度相对而言是最为卖力——给足了小程序开发者流量、资金以及服务支持特别是一对一的专业服务对于诸多小开发者而言可能会相当具备吸引力。而事实上流量、资金之外对于开发者而言百度在智能小程序上推出伊始就宣布的将百度大脑3.0的AI能力——包括语音、视觉、自然语言处理、知识图谱、增强现实以及情景感知等类别在内能力全部开放给了智能小程序开发者的AI赋能同样不容忽视他使得开发者无需自己开发就能直接接入实现丰富的AI功能。这事实上是极大的减轻了开发者的开发难度节约了宝贵的时间。（3）流量规模质量比拼：百度、微信>支付宝>今日头条从现实来说开发者们纷纷入局巨头的小程序平台核心在于利用巨头们富集的流量激活自家的用户增长势能实现用户服务。毕竟从现实来说一个愈发明显的现实是：用户越来越朝着超级App聚集其在超级App上花费的时间远超以往行业马太效应凸显乃至有报告称：用户手机里只需要安装35个APP就可以满足社交、娱乐、电商、新闻等等方面的需求。所以对于开发者而言平台流量的多寡与流量质量的高低对于初期的势能激活与后续的持续发展预期都极为重要。那么从流量的层面来看谁又更为值得开发者选择？在用户基数层面当前微信和WeChat的用户超过10亿支付宝目前数据显示其全球用户数超过9亿百度App的用户量也已经超过7亿。所以从从自有超级APP的用户数据来看微信拔得头筹而百度APP相对而言稍有差距。但百度另辟路径成立了开源联盟包括爱奇艺、快手、WiFi万能钥匙、58同城以及百度地图、百度贴吧等百度内外部产品。这使得百度智能小程序拥有超过40个App流量入口。但需要注意的是百度在智能小程序这一战略级产品上其已不拘泥于自家的一亩三分地而是采用了完全开放策略转而与行业伙伴共建“智能小程序开源联盟”。从理论来说在小程序上奉行开源策略的百度智能小程序其不仅可以运行在百度系App上其同时也可以运行于外部第三方App上乃至是穿戴设备、智能家居和车载系统等IoT设备让开发者具备了“一次开发服务全球”的能力。这种联盟构建的累计流量相对于封闭式的微信、支付宝小程序以及在当下仅支持安卓系统的今日头条小程序而言其流量规模要大得多。诚如此前百度副总裁沈抖所言：“或许在百度做完小程序的流量没有微信大但是把所有合作伙伴的流量都算上就很大。”在流量精准性方面相对于而言个人认为百度、支付宝的额流量精准性要远大于微信小程序的流量精准性原因在于搜索与工具流量事实上都带有明确的目的性这使得小程序具备了更大的激活可能诸如我们去搜索旅行那么其目的就在于我们拥有旅行诉求但社交流量则往往不具备这样的特征。三、选择比能力更重要罗振宇在2018年《时间的朋友》跨年演讲中给出了这样一道选择题：“现在摆在你面前的有红色绿色两个按钮按红色钮可以直接拿走100万元按绿色钮有50%的机会拿到1亿元。你会选择哪一个钮？”事实上这样的选择题同样也摆在了当下众多准备入局小程序的开发者面前。是选择生态已经繁荣的微信小程序还是选择百度智能小程序这些在生态上略微落后的平台与其共同努力追赶微信小程序？毕竟从事实来说基于先发优势当前的微信小程序相对于支付宝小程序和百度智能小程序而言已是明显胜过一筹。但对于开发者而言同时也需要看到的是：在微信小程序生态的繁荣之下也拥有着更为惨烈的竞争并且相对而言微信小程序对于开发者的扶持力度、整体的流量规模与质量是落后于百度智能小程序这些平台的。所以 在此对于准备入局小程序的开发者而言究竟选择那一平台作为核心发力平台相信心中已然明晰了。在个人看来选择百度智能小程序、支付宝小程序对于新入局的小程序开发者而言可能更能拥有发光发热的可能性。注：本文所有图片源自网络。文|邻章【微信号：ZLxgic微信公众号：TMT317】欢迎添加关注！文章转载请注明出处。本人系独立撰稿人腾讯科技2016年年度新媒体关注智能手机、移动互联网、人工智能等文章在虎嗅、钛媒体、界面新闻、百家号、搜狐科技、腾讯、雪球、品途商业评论、今日头条等30余家平台发布。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序倒计时深究               一款基于2B市场的反馈产品分析                                                        原作者: 邻章                   来自: 艾瑞网                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "京喜首页（微信购物入口）跨端开发与优化实践 ", "author": "                  Rolan                  2019-12-4 00:45                ", "text": "                                                                                                                                                                                     随着今年的双十一落下帷幕京喜（原京东拼购）也迎来了首捷。双十一前夕微信购物一级入口切换为京喜小程序项目顺利通过近亿级的流量考验在此与大家分享一点自己参与的工作。在接手项目前京喜业务已在线上稳定运行较长时间。但经过一段时间迭代维护后发现首页存在以下问题：H5 版本首页针对不同渠道开发了多套页面对开发者维护和内容运营来说存在较大挑战需投入大量人力成本；项目技术栈不统一分别有传统 H5 开发、原生小程序开发、wqVue 框架开发严重影响项目复杂度迭代过程苦不堪言；H5、小程序以及 RN 三端存在各自构建和发布流程涉及较多工具及复杂系统流程影响业务交付效率。综上所述京喜迎来一次改版契机。改版目标从前端角度来看本次改版要实现以下目标：升级并统一项目技术栈解决项目技术栈混乱的现状；使用一套代码适配微信入口、手 Q 入口、微信小程序、京东 APP、京喜 APP、M 站六大业务场景减少多套页面的维护成本提升交付效率；通过让 RN 技术在业务上的落地完善团队在 App 端的技术储备；优化页面性能及体验为下沉市场用户提供优质的产品体验；技术选型京喜业务拥有非常丰富的产品形态涵盖了 H5、微信小程序以及独立 APP 三种不同的端对支持多端的开发框架有着天然的需求。在技术选型上我们选择团队自研的 Taro 多端统一开发解决方案。Taro 是一套遵循 React 语法规范的多端开发解决方案。现如今市面上端的形态多种多样Web、React-Native、微信小程序等各种端大行其道当业务要求同时在不同的端都要求有所表现的时候针对不同的端去编写多套代码的成本显然非常高这时候只编写一套代码就能够适配到多端的能力就显得极为需要。使用 Taro我们可以只书写一套代码再通过 Taro 的编译工具将源代码分别编译出可以在不同端（微信/百度/支付宝/字节跳动/QQ 小程序、快应用、H5、React-Native 等）运行的代码。选它有两个原因一来是 Taro 已经成熟内部和外部都有大量实践内部有京东 7FRESH、京东到家等外部有淘票票、猫眼试用等多个案例可以放心投入到业务开发；二来团队成员都拥有使用 Taro 来开发内部组件库的经验对业务快速完成有保障。开发实录由于首页改版的开发排期并不充裕因此充分地复用已有基础能力（比如像请求、上报、跳转等必不可少的公共类库）能大量减少我们重复的工作量。话虽如此但在三端统一开发过程中我们仍遇到不少问题同时也带来解决方案以下我们一一阐述。H5 篇我们所有的页面都依赖现有业务的全局公共头尾及搜索栏等组件这就不可避免的需要将 Taro 开发流程融入到现有开发和发布流程中去。同时公共组件都是通过 SSI 的方式引入和维护的为了能在运行 npm run dev:h5 时预览到完整的页面效果需要对 index.html 模版中的 SSI 语法进行解析 index.html 模版文件代码结构大致如下：<!DOCTYPE html><html lang=\"zh-CN\"><head>  <meta charset=\"UTF-8\">  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover\">  <title>京喜</title>  <!--#include virtual=\"/sinclude/common/head_inc.shtml\"--></head><body>  <div id=\"m_common_header\" style=\"display:none;\"></div>  <!--S 搜索框-->  <div id=\"search_block\" class=\"search_block\"></div>  <div id=\"smartboxBlock\" style=\"display:none;\"></div>  <!--E 搜索框-->  <div id=\"app\" class=\"wx_wrap\"></div>  <!--#include virtual=\"/sinclude/common/foot.shtml\"--></body></html>复制代码可以看到模版中存在很多类似 <!--#include virtual=\"...\" --> 格式的代码这些就是通过 SSI 方式引入的 H5 公共组件它的 virtual 属性指向的文件不存在于本地而是存在于服务器上的所以我们遇到的第一个问题就是在本地解析这些文件确保能预览到完整的页面效果不然开发调试起来就非常的低效。好在 Taro 有暴露出 webpack 的配置我们可以通过引入自定义加载器（这里就叫 ssi-loader ）来解析这些代码的路径然后请求服务器上的文件内容并进行替换即可要实现这个功能只需在项目的 config/dev.js 中加入如下代码即可：module.exports = {  h5: {    webpackChain(chain, webpack) {      chain.merge({        module: {          rule: {            ssiLoader: {              test: /\\.html/,              use: [                {                  loader: 'html-loader'                },                {                  loader: 'ssi-loader',                  options: {                    locations: {                      include: 'https://wqs.jd.com'                    }                  }                }              ]            }          }        }      })    }  }}复制代码这样就解决了本地开发调试难点然后开开心心的进行页面开发。当页面开发完成之后接下来遇到的问题就是如何将前端资源部署到测试和生产环境。由于现有开发和发布流程都是基于内部已有的平台我们临时定制一套也不太现实所以需要将它融入到 Taro 的流程中去这里我们引入了 gulp 来整合各种构建和发布等操作只要构建出符合发布平台规范的目录即可利用它的静态资源构建、版本控制及服务器发布等能力这样我们就打通了整个开发和发布流程。这套拼凑起来的流程还存在不少的问题对于新接手的同学有一点小繁琐有着不少改善的空间这也是接下来的重点工作方向。另外 Taro 的 H5 端之前是基于 SPA 模式对于有着多页开发需求的项目来说不太友好当时反馈给 Taro 团队负责 H5 的同学很快得到了响应目前 Taro 已支持 H5 多页开发模式支持非常迅速。小程序篇由于开发完 H5 版之后对应的业务逻辑就已经处理完了接下来只需要处理小程序下的一些特殊逻辑（比如分享、前端测速上报等）即可差异比较大的就是开发和发布流程。这里讲一下如何在一个原生小程序项目中使用 Taro 进行开发因为我们的 Taro 项目跟已有的原生小程序项目是独立的两个项目所以需要将 Taro 项目的小程序代码编译到已有的原生小程序项目目录下第一步要做的就是调整 Taro 配置 config/index.js 指定编译输出目录以及禁用 app 文件输出防止覆盖已有文件。const config = {  // 自定义输出根目录  outputRoot: process.argv[3] === 'weapp' ? '../.temp' : 'dist',  // 不输出 app.js 和 app.json 文件  weapp: {    appOutput: false  }}复制代码由于京喜以前是主购小程序的一个栏目后面独立成了独立的小程序但是核心购物流程还是复用的主购小程序所以这让情况变得更加复杂。这里还是通过 gulp 来进行繁琐的目录文件处理比如我们的小程序页面和组件都需要继承主购小程序的 JDPage 和 JDComponent 基类所以在进行文件复制之前需要进行代码替换代码如下：// WEAPPconst basePath = `../.temp`const destPaths = [`${basePath}/pages/index/`, `${basePath}/pages/components/`]const destFiles = destPaths.map(item => `${item}**/*.js`)/* * 基类替换 */function replaceBaseComponent (files) {  return (    gulp      .src(files || destFiles, { base: basePath })      .pipe(        replace(          /\\b(Page|Component)(\\(require\\(['\"](.*? \"'\"\")\\/npm\\/)(.*)(createComponent.*)/,          function(match, p1, p2, p3, p4, p5) {            const type =              (p5 || '').indexOf('true') != -1 ||              (p5 || '').indexOf('!0') != -1                ? 'Page'                : 'Component'            if (type == 'Page') p5 = p5.replace('))', '), true)') // 新：page.js基类要多传一个参数            const reservedParts = p2 + p4 + p5            // const type = p1            // const reservedParts = p2            const rootPath = p3            const clsName = type == 'Page' ? 'JDPage' : 'JDComponent'            const baseFile = type == 'Page' ? 'page.taro.js' : 'component.js'            console.log(              `:full_moon_with_face: Replace with \\`${clsName}\\` successfully: ${this.file.path.replace(                /.*?wxapp\\//,                'wxapp/'              )}`            )            return `new (require(\"${rootPath}/bases/${baseFile}\").${clsName})${reservedParts}`          }        )      )      .pipe(gulp.dest(basePath))  )}// 基类替换gulp.task('replace-base-component', () => replaceBaseComponent())复制代码还有很多类似这样的骚操作虽然比较麻烦但是只需要处理一次后续也很少改动。RN 篇对于 RN 开发也是第一次将它落地到实际的业务项目中所以大部分时候都是伴随着各种未知的坑不断前行所以这里也友情提示一下对于从未使用过的技术还是需要一些耐心的遇到问题勤查勤问。由于京喜 APP 是复用京东技术中台的基础框架和 JDReact 引擎所以整个的开发和部署都是遵循 JDReact 已有的流程画了一张大致的流程图如下：JDReact 平台是在 Facebook ReactNative 开源框架基础上进行了深度二次开发和功能扩展。不仅打通了 Android/iOS/Web 三端平台而且对京东移动端基础业务能力进行了 SDK 级别的封装提供了统一、易于开发的 API。业务开发者可以通过 JDReact SDK 平台进行快速京东业务开发并且不依赖发版就能无缝集成到客户端(android/iOS)或者转换成 Web 页面进行线上部署真正实现了一次开发快速部署三端。由于京喜 APP 的 JDReact 模块都是独立的 git 仓库所以需要调整我们 Taro 项目配置 config/index.js 的编译输出路径如下：rn: {  outPath: '../jdreact-jsbundle-jdreactpingouindex'}复制代码这样当我们运行 yarn run dev:rn 进行本地开发时文件自动编译到了 JDReact 项目接下来我们就可以用模拟器或者真机来进行预览调试了。当我们在进行本地开发调试的时候最高效的方式还是推荐用 Taro 官方提供的 taro-native-shell 原生 React Native 壳子来启动我们的项目详细的配置参照该项目的 README 进行配置即可。由于 React Native 官方提供的 Remote Debugger 功能非常弱推荐使用 React Native Debugger 来进行本地 RN 调试提供了更为丰富的功能基本接近 H5 和小程序的调试体验。这样我们就拥有了一个正常的开发调试环境接下来就可以进行高效的开发了由于我们前面在 H5 和小程序版本阶段已经完成了绝大部分的业务逻辑开发所以针对 RN 版本的主要工作集中在 iOS 和安卓不同机型的样式和交互适配上。在样式适配这块不得不提下 Taro 针对我们常见的场景提供了一些最佳实践可以作为布局参考：ImageflexscalePx2dpTaro RN 最佳实践集锦在实际开发过程中也遇到不少兼容性问题这里整理出来以供大家参考：文本要用 <Text> 标签包起来因为 RN 没有 textNode 的概念；使用 Swiper 时在外面包一个 View否则设置 margin 后会导致安卓下高度异常；Cannot read property 'x' of undefined Swiper 底层使用的 react-native-swiper 导致的问题Disable Remote JS Debug 就不会出现。图片默认尺寸不对RN 不会自动帮助设置图片尺寸而是交给开发者自己处理故意这样设计的；Image 组件上不可以设置 onClick实现基线对齐： vertical-align: baseline 用 <Text> 把需要基线对齐的组件包住即可。<Text>  <Text style={{ fontSize: 20 }}>abc</Text>  <Text style={{ fontSize: 40 }}>123</Text></Text>复制代码尽量避免使用 line-height 在安卓和 iOS 下表现不一致而且即使设置为与 fontSize 相同也会导致裁剪；android 调试生产环境的 bundle摇手机选 Dev Setting取消勾选第一项 Dev 即可；iOS 调试生产环境的 bundle AppDelegate.m 中增加一行语句关闭 dev 即可：[[RCTBundleURLProvider sharedSettings] setEnableDev:false];  // 找到这行并在它的上面增加上面这行  jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@\"index\" fallbackResource:nil];复制代码<Text> 与 <View> 支持的 style 属性不相同。> [Text Style Props](https://facebook.github.io/react-native/docs/text-style-props \"Text Style Props\") & [View Style Props](https://facebook.github.io/复制代码react-native/docs/view-style-props)render 方法中不要返回空字符串下面的代码在 android 下会报错（empty_string 内容为空字符串）<View>  {empty_string && <Text></Text>}</View>复制代码因为 empty_string && <Text></Text> 的返回值是空字符串RN 尝试把字符串添加到 View 的 children 时在安卓环境下会报错：Error: Cannot add a child that doesn't have a YogaNode复制代码border-radius 导致背景色异常单独给某个角设置圆角时没有设置圆角的边会出现一块与背景色颜色相同但半透明的色块。transform:tanslate()透明 View 无法点击的问题给设置了 onClick 的元素添加透明背景色即可：style={{ backgroundColor: \"transparent\" }}复制代码不可以用 scss 写只有写在 JSX 上的才有效Taro 编译时可能把透明背景色忽略了。一像素缝隙问题可能是 RN 布局引擎的问题或单位转换以及浏览器渲染中的精度损失问题。可以调整页面结构来绕过。 或者简单粗暴一点设置负 margin 值盖住缝隙。跨平台开发JS 文件1、文件拆分的方式要\"完美\"的编译出三端代码首先要解决的是公共类库的适配问题好在兄弟业务团队已经沉淀有完成度较高的三端公共类库利用 Taro 提供的跨平台开发能力抹平三端方法名和参数不统一的情况即可很好的解决公共类库的适配问题如下所示：.├── goto.h5.js├── goto.rn.js├── goto.weapp.js├── request.h5.js├── request.rn.js├── request.weapp.js└── ...复制代码以 request 公共组件为例三端代码如下：request.h5.jsimport request from '@legos/request'export { request }复制代码request.rn.jsimport request from '@wqvue/jdreact-request'export { request }复制代码request.weapp.js（由于小程序的公共组件没有发布至 npm这里引用的本地项目源文件）import { request } from '../../../common/request/request.js'export { request }复制代码如遇到需要适配的方法参数不一致或者增加额外处理的情况可进行再包装确保最终输出的接口一致如下：goto.rn.jsimport jump from '@wqvue/jdreact-jump'function goto(url, params = {}, options = {}) {  jump(url, options.des || 'm', options.source || 'JDPingou', params)}export default goto复制代码文件引入的时候我们正常使用就好Taro 在编译的时候为我们编译对应的平台的文件import goto from './goto.js'复制代码2、条件编译的方式解决了公共类库适配之后接下来就可以专注于业务代码开发了同样业务代码在三端也可能存差异的情况可以用 Taro 提供的环境变量来达到目的示例代码如下：if (process.env.TARO_ENV === 'h5') {  this.speedReport(8) // [测速上报] 首屏渲染完成} else if (process.env.TARO_ENV === 'weapp') {  speed.mark(6).report() // [测速上报] 首屏渲染完成} else if (process.env.TARO_ENV === 'rn') {  speed.mark(7).report() // [测速上报] 首屏渲染完成}复制代码CSS 文件以上是 js 的代码处理方式对于 css 文件及代码同样也有类似的处理。1、文件拆分的方式比如 RN 相对于 H5 和小程序的样式就存在比较大的差异RN 支持的样式是 CSS 的子集所以很多看起来很常见的样式是不支持的可以通过以下方式进行差异化处理：├── index.base.scss├── index.rn.scss├── index.scss复制代码这里以 index.base.scss 作为三端都能兼容的公共样式（名字可以任取不一定为 xxx.base.scss） index.rn.scss 则为 RN 端独特的样式 index.scss 则为 H5 和小程序独特的样式因为 H5 和小程序样式基本上没有什么差异这里合为一个文件处理。2、条件编译的方式Taro 也支持样式文件内的条件编译语法如下：/* #ifdef %PLATFORM% */// 指定平台保留/* #endif *//* #ifndef %PLATFORM% */// 指定平台剔除/* #endif */复制代码%PLATFORM% 的取值请参考 Taro 内置环境变量以下为示例代码：.selector {  color: #fff;  /* #ifndef RN */  box-shadow: 1px 1px 1px rgba(0, 0, 0, .1);  /* #endif */}复制代码编译为 H5 和小程序的样式为：.selector {  color: #fff;  box-shadow: 1px 1px 1px rgba(0, 0, 0, .1);}复制代码RN 的样式为：.selector {  color: #fff;}复制代码两种方式选其一即可这样就能开开心心的编写业务代码了。有些许遗憾的是产品经理对这次新版首页有着明确的上线优先级：先 H5 版再微信小程序版最后是 RN 版这就为后续 RN 版本跟 H5 和 小程序版本分道扬镳埋下了伏笔条件允许的话建议优先以 RN 版本为基准进行开发以免开发完成 H5 和小程序之后发现对结构和样式进行大的调整因为 RN 对样式确实会弱一些。性能优化图片优化电商性质的网站会存在大量的素材或商品图片 往往这些会对页面造成较大的性能影响。得益于京东图床服务提供强大的图片定制功能让我们在图片优化方面省去大量工作。以引入商品图片 \"https://img10.360buyimg.com/mobilecms/s355x355_jfs/t1/55430/24/116/143859/5cd27c99E71cc323f/0e8da8810fb49796.jpg!q70.dpg.webp\" 为样本我们对图片应用做了部分优化：根据容器大小适当裁剪图片尺寸：s355x355_jfs根据网络环境设置图片品质参数：0e8da8810fb49796.jpg!q70根据浏览器环境合理选择图片类型：0e8da8810fb49796.jpg!q70.dpg.webp为 Image 标签设置 lazyload 属性这样可以在 H5 和小程序下获得懒加载功能。接口聚合直出起初京喜首页的首屏数据涉及的后端接口多达 20 余个导致整体数据返回时间较长；为了解决此项痛点我们联合后端团队独立开发首屏专用的 聚合直出接口 。一方面将众多接口请求合并成一个减少接口联动请求带来的性能损耗；另一方面将复杂的业务逻辑挪到后端处理前端只负责视图渲染和交互即可减少前端代码复杂度；通过此项优化页面性能和体验得到极大改善。缓存优先策略由于京喜业务主要围绕下沉市场其用户群体的网络环境会更加复杂要保障页面的性能减少网络延时是一项重要措施。为了提升用户二次访问的加载性能我们决定采用 缓存优先策略 。即用户每次访问页面时所请求的主接口数据写入本地缓存同时用户每次访问都优先加载缓存数据形成一套规范的数据读取机制。通过优先读取本地缓存数据可让页面内容在极短时间内完成渲染；另外本地缓存数据亦可作为页面兜底数据在用户网络超时或故障时使用可避免页面空窗的情景出现。高性能瀑布流长列表首页紧接着首屏区域的是一个支持下滑加载的瀑布流长列表每次滑到底部都会异步拉取 20 条数据总计会拉取将近 500 条数据这在 iOS 下交互体验还比较正常。但是在配置较低的安卓机型下当滑动到 2 到 3 屏之后就开始出现严重卡顿甚至会闪退。针对这种场景也尝试过用 FlatList 和 SectionList 组件来优化但是它们都要求规则等高的列表条目于是不得不自己来实现不规则的瀑布流无限滚动加载。其核心思路是通过判断列表的条目是否在视窗内来决定图片是否渲染要优化得更彻底些得话甚至可以移除条目内所有内容只保留容器以达到减少内容节点以及内存占用不过在快速进行滑动时比较容易出现一片白框算是为了性能损失一些体验整体上来说是可以接受得。由于 RN 下在获取元素坐标偏移等数据相对 H5 和小程序要麻烦得到具体的实现细节可以查看抽离出来的简单实现 Taro 高性能瀑布流组件（for RN） 。写在最后这篇文章从技术选型、开发实录再到性能优化三个维度对京喜首页改版做了简单总结。整个项目实践下来证实 Taro 开发框架 已完全具备投入大型商业项目的条件。虽在多端开发适配上耗费了一些时间但仍比各端独立开发维护工作量要少；在前端资源匮乏的今天选择成熟的开发工具来控制成本、提升效率已是各团队的首要工作目标。 同时京喜作为京东战略级业务拥有千万级别的流量入口我们对页面的体验优化和性能改进远不止于此希望每一次微小的改动能为用户带来愉悦的感受始终为用户提供优质的产品体验。欢迎关注凹凸实验室博客： aotu.io                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序同构方案 kbone 分析与适配               小程序不同页面的异步回调callback和promise的使用讲解                                                        原作者: 凹凸实验室                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序之SelectorQuery ", "author": "                  Rolan                  2019-5-16 00:12                ", "text": "                                                                                                                                                                                     在开发小程序展开全文组件时需要用到节点查询API - wx.createSelectorQuery() 来查询全文内容的高度。wx.createSelectorQuery() 返回一个 SelectorQuery 对象实例。SelectorQuery 有五个方法（inselectselectAllselectViewportexec）第一个返回 SelectorQuery后四个返回 NodesRef。NodesRef 有四个方法（fieldsboundingClientRectscrollOffsetcontext）第一个返回 NodesRef后三个返回 SelectorQuery。对照官方提供的示例代码来看const query = wx.createSelectorQuery() // query 是 SelectorQuery 对象query.select('#the-id').boundingClientRect() // select 后是 NodesRef 对象然后 boundingClientRect 返回 SelectorQuery 对象query.selectViewport().scrollOffset() // selectViewport 后是 NodesRef 对象然后 scrollOffset 返回 SelectorQuery 对象query.exec(function (res) { // exec 返回 NodesRef 对象  res[0].top // #the-id节点的上边界坐标  res[1].scrollTop // 显示区域的竖直滚动位置})问题：每行执行返回的 SelectorQuery 对象是相同的吗？答案：是的都是同一个对象。问题：直接执行 query.select('#the-id').boundingClientRect().exec 也可以吗？答案：可以boundingClientRect() 返回就是 query。问题：这样连写 query.select('#the-id').boundingClientRect().selectViewport().scrollOffset() 算两条查询请求吗？答案：是两条请求。问题：query.exec 执行后会清空前面的查询请求吗？再次执行还能拿到结果吗？答案：可以query不会清空请求。问题：boundingClientRect 和 scrollOffset 可以接受 callback 参数它与 query.exec 执行顺序是怎样修改 res 结果会影响到后面的 callback 吗？答案：先执行 boundingClientRect 和 scrollOffset 的 callback再执行 query.exec 的 callback；修改 res 结果会影响到后面 exec 的结果。上面的问题通过 WAService.js 源码简单美化后可以了解 SelectorQuery 的代码逻辑class NodesRef {  constructor(selectorQuery, component, selector, single) {    this._selectorQuery = selectorQuery;    this._component = component;    this._selector = selector;    this._single = single;  }  fields(e, t) {    this._selectorQuery._push(this._selector, this._component, this._single,      e,      t,    );    return this._selectorQuery  }  boundingClientRect(callback) {    this._selectorQuery._push( this._selector, this._component, this._single,      {        id: true,        dataset: true,        rect: true,        size: true,      },      callback,    );    return this._selectorQuery;  }  scrollOffset(callback) {    this._selectorQuery._push( this._selector, this._component, this._single,      {        id: true,        dataset: true,        scrollOffset: true,      },      callback,    );    return this._selectorQuery;  }}let pluginId = '';class SelectorQuery {  constructor(e) {    if (e && e.page) {      this._component = this._defaultComponent = e.page;      this._webviewId = this._defaultComponent.__wxWebviewId__;    } else {      var pages = __internalGlobal__.getCurrentPagesByDomain('');      this._defaultComponent = pages[pages.length - 1],      this._component = null;      this._webviewId = null;    }    this._queue = [];    this._queueCb = [];  }  in(component) {    if (!this._webviewId) {      this._webviewId = component.__wxWebviewId__;      this._component = component;    } else if (this._webviewId !== component.__wxWebviewId__) {      console.error('A single SelectorQuery could not work in components in different pages. A SelectorQuery#in call has been ignored.');    } else {      this._component = component;    }    return this;  }  select(selector) {    return new NodesRef(this, this._component, selector, true);  }  selectAll(selector) {    return new NodesRef(this, this._component, selector, false);  }  selectViewport() {    return new NodesRef(this, 0, '', true);  }  _push(selector, component, single, fields, callback) {    if (!this._webviewId) {      this._webviewId = this._defaultComponent ? this._defaultComponent.__wxWebviewId__ : undefined;    }    const rootNodeId = pluginId ? '' : r.getRootNodeId(this._webviewId);    this._queue.push({      component: null != component ? (0 === component ? 0 : component.__wxExparserNodeId__) : rootNodeId,      selector,      single,      fields,    });    this._queueCb.push(callback || null);  }  exec(callback) {    hd(this._webviewId, {      pluginId,      queue: this._queue,    }, (results) => {      const queueCb = this._queueCb;      results.forEach((res, index) => {        if ('function' == typeof queueCb[index]) {          queueCb[index].call(this, res);        }      });      if ('function' == typeof callback) {        callback.call(this, results);      }    })  }}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序绑定用户方案 优化               在微信小程序中下载图片到本地解决方案                                                        原作者: IMWeb howenhuo                    来自: IMWeb                                                                                      /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "【微信小程序】写一个能自定义尺寸、样式的switch ", "author": "                  Rolan                  2019-12-24 00:51                ", "text": "                                                                                                                                                                                     小程序原生的switch不能灵活的修改宽高、样式很不方便我这边参考 WeUI 的开关写了一个可以自定义尺寸样式的switch组件。直接上代码： https://gitee.com/piscdong/we...效果如下图可以自定义宽高可以做成方角的代码分析这个switch主要的难点就是点击后背景颜色变换的动画这里用到了css的transition、transform两个属性来实现动画以及::before和::after两个伪元素。wxml基本结构为：<view class=\"switch\">    <view></view></view>父级view是整个switch容器会用到::before做背景色切换动画::after做禁用时的灰色遮罩。内部的一个view是来回切换的白点。未选中时默认class是switch选中时增加一个class：switch_checked。选中状态到未选中状态背景有一个从中间变大到全部的白色动画所以需要给父级view设置一个颜色作为背景色。.switch {    ...    background: #00c000;    position: relative;}未选中时::before覆盖整个容器选中时::before设置 transform: scale(0); 这样选中时白色区域就会缩放到最小再加上transition的实现动画效果。.switch::before {    display: block;    content: '';    position: absolute;    top: 0;    left: 0;    right: 0;    bottom: 0;    border-radius: 9999rpx;    background: #fff;    transition: all 0.35s cubic-bezier(0.45, 1, 0.4, 1);}.switch_checked::before {    transform: scale(0);}来回移动的白点未选中时通过 left: 0; 定位到左侧选中时将left设置为100%定位到右侧但是这样白点会完全移出容器范围所以还需要加上 transform: translateX(-100%); 将白点向左再一定自身宽度的100%同样加上transition的实现动画效果。.switch view {    position: absolute;    top: 0;    left: 0;    width: 60rpx;    height: 60rpx;    border-radius: 50%;    background: #fff;    box-shadow: 0 2rpx 6rpx rgba(0, 0, 0, 0.4);    transition: all 0.35s cubic-bezier(0.45, 1, 0.4, 1);}.switch_checked view {    left: 100%;    transform: translateX(-100%);}关于“::”最后搭车说一下“:”和“::”“:”是伪类“::”是伪元素。按照我的理解：伪类不会在dom中增加节点只不过是css选择器的一种特殊效果；伪元素会增加节点flex布局中会影响到其他元素。为了保证兼容性css3是允许伪元素使用单个冒号。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    【微信小程序】知乎视频查看               小程序的getElementsById就像一把梭                                                        原作者:  祺爸                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序JS导出和导入 ", "author": "                  Rolan                  2018-9-6 00:27                ", "text": "                                                                                                                                                                                     1. 导出1.1 方法和变量导出（写在被导出方法和变量的js文件）module.exports = {  variable: value,  method : methodName}1.2 class导出(es6语法)class HomeModule {  constructor(url) {    this.url = url;  }}export { HomeModule }2. 导入2.1 方法和变量的引入(写在需要引入其他js的方法或变量的JS文件中)var util = require(\"../../../utils/util.js\");  //注意这里引入的js文件路径写相对路径(绝对路径可能引入失败)var http = require(\"../../../utils/http.js\");    使用： util.method() 或 util.variable2.2 class的引入import { HomeModule } from \"../../../module/HomeModule.js\";//引入的js文件最好写相对路径  使用：      var homeModule = new HomeModule(listUrl);  //创建class对像后就可以直接调用对象的函数了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    简陋至极：微信小程序日历组件（思路）               小程序之图片懒加载 完美方案你不来看看？                                                        原作者:  T丶快乐知己丬                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序的双线程模型 ", "author": "                  Rolan                  2019-11-6 00:10                ", "text": "                                                                                                                                                                                     官方文档给出的双线程模型:  小程序的宿主环境 微信客户端提供双线程去执行wxml,wxssjs文件。双线程模型1.上述的渲染层上面运行着wxml文件渲染层使用是的webview线程进行渲染（一个程序会有多个页面也就会有多个view线程进行运作）2.js文件是运行在逻辑层逻辑层的js是通过jscore进行运行的。通过双线程界面的渲染过程是怎样的？wxml与DOM树其实我们wxml文件与我们html中的DOM树是一样的这样我们就可以有js来模拟一个虚拟的DOM树：初始化渲染如果我们的wxml文件中如果有变量：要与js逻辑层共同渲染页面成为一个真正的DOM树：界面数据发生变化1如果通过setDat把hell改成dsb则js对象的的节点会发生改变.2 这时会用diff算法对比两个对象的变化3 然后将变化的部分应用到DOM树上4 从而达到更新页面的目的这也就是数据驱动的原理总结界面渲染的整体流程1在渲染层将wxml文件与wxss文件转化成js对象也就是虚拟DOM2 在逻辑成将虚拟的DOM对象配合生成真实的DOM树在交给渲染层渲染3 当数据变化是逻辑层提供更新数据js对象发生改变用diff算法进行比较4 将更新的内容反馈到真实的DOM树中更新页面                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序 setData 修改 data 中数组内不定对象的数据               当微信小程序遇上filter~                                                        原作者: waller                    来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序助手发布！ ", "author": "                  Rolan                  2018-12-26 00:12                ", "text": "                                                                                                                                                                                     又是熟悉的夜晚。今天我们带来两个新能力：小程序开发助手升级为“小程序助手”你可以在手机上使用它管理你的小程序了。用户在小程序支付完成后开发者可获取用户UnionID。（在“小程序助手”首页选择“小程序示例”进入可查看详细功能）不在电脑前也能同时管理多个小程序这次全新发布的小程序助手就是一个非常适用于小程序开发者的小程序不仅小程序的管理员能用开发者、运营者、体验者也能用还能让你随时加班掌握小程序情况。解决你平时的一些小难题：想体验不同的小程序版本（开发版/体验版/线上版）“版本查看”立马搞定。小程序有项目成员离职、有新成员要加手机上就能快速操作。PR部门突然要用小程序码？不用登电脑后台了这个小程序里就能取。小程序关键数据想查？马上就能查到。开发哥想看自己的小程序性能如何？性能分析来帮忙。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    聊聊2018小程序这个迷宫               如何寻找用户增长点构建小程序用户增长模型？                                                        原作者: 微信公开课                   来自: 微信公开课                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "从无到有开发一款产品（小程序）的过程与思考 ", "author": "                  Rolan                  2018-9-11 00:08                ", "text": "                                                                                                                                                                                     在阿里巴巴总部有着这样一句话 改变世界的不是技术而是技术背后的梦想。不知不觉已经做技术有三年的时间了这三年间经历了很多次项目的开发上线以及产品的争论。很多同事都常常说我你不像一个干技术的产品让你干什么你就干什么不就好了最多就是在技术比较难实现时说一句这个需求做不了就得了为什么老要去和产品关于交互问题争论呐？我常常争辩道我认为一个技术不能不会敲代码但是一个好的技术不能只会敲代码再敲代码之外也应该有自己关于产品的一些思考。确定需求有一天和一位朋友在聊微信聊着聊着突然想添加对方的手机号码到通讯录里面于是就让他发电话号码邮箱和公司名称发过来然后我一遍一遍的复制到手机通讯录里面花了好一段功夫才添加完成过程觉得特别麻烦。这个时候我就突发奇想要是有一款产品可以直接由对方把自己的各种信息输入(例如姓名、电话、公司、邮箱)然后生成一个二维码发送给好友好友长按二维码识别信息或者用扫一扫功能扫一下就能直接添加进入手机通讯录那该是一件多么方便的事情啊。说干就干于是我产生了设计并开发一款这种产品的想法。产品选型需求很明确做一款能根据用户输入的信息生成二维码并且通过扫一扫直接添加进入手机通讯录的产品。由于我是做android开发的所以首先想到的是做一款android客户端去供大家下载使用。但是转念一想这种东西的需求场景是有但是并不是一个高频场景下使用的东西真的有必要或者用户真的会特意下载一款这种一次用完下次什么时候再次使用都不知道的APP吗？答案显然是否定的。时间宝贵流量宝贵内存更宝贵用户显然不会一直把一款这种方面但使用率不算很高的应用放在内存宝贵的手机里。APP的开发成本很高做一款这种APP显然不合适。那么比较低频用完即走的应用和张小龙所推广的微信小程序简直不谋而合不占内存空间想到了就使用用完即走小程序显然满足这所有的一切。经过这一块思考之后决定从做一款android APP转而做一款微信小程序！具体功能与界面决定好了不做android APP而是做微信小程序之后接下来就该思考这款小程序具体会有那些功能还有界面应该是怎么样的了。首先大的核心功能就是一个输入个人信息生成二维码去扫码添加用户。因此我将界面拆成两个主要的界面是类似于腾讯乘车码小程序那样只有一个二维码界面方面对方直接通过扫一扫来添加信息。另外一个界面为用户信息界面这个界面可以由用户添加个人信息添加完成之后点击生成二维码按钮自动生成二维码并且跳转到主界面。于是把界面搭建完成之后成为了这个样子可以看到这里将小程序分为两个主要的界面二维码页面负责提供扫描的二维码个人界面负责由用户自己填写个人信息这里面包含姓名、移动电话和电子邮箱信息。当用户点击生成二维码名片的按钮时将数据保存在本地并自动跳转到二维码界面。思考此处在主界面我产生了两个思考二维码中信息的格式该如何处理？是否需要添加一个扫一扫功能去扫描二维码？我应该用什么样的格式去保存个人信息的内容怎样能够让程序更好的进行解析操作？是否需要再开发一个扫一扫功能来扫描里面的二维码？这些问题困扰在我面前。我的思考是用户拿到二维码的时候第一反应肯定不是拿小程序里面的扫一扫去进行扫描而是直接掏出手机打开微信使用微信里面的扫一扫来扫描二维码查看里面的内容。而如何解决摆在我面前让微信扫一扫自动识别我二维码里面内容这是现在必须思考的难题。好在我同事帮我解决了这个问题。他说有一种叫电子名片的格式微信是可以扫码支持的。于是我去了解了一下这种原来微信扫码是支持一种vcard格式的二维码名片它会根据你在二维码中隐藏这种格式来进行自动的解析操作将解析的信息直接识别出来并添加到通讯录当中去于是通过这种方式解决了第一个个人信息格式的问题。 关于微信电子名片的格式信息可以参考一下这篇文章。那么第一个问题解决了现在处理第二个思考到底有没有必要在小程序里面内嵌一个扫一扫的功能？我的思考是没有这个必要。理由有二：用户不用为了添加一个信息而专门去小程序市场找一个小程序来扫码。用户的直觉一定是看见二维码直接打开微信去扫而不是打开微信打开小程序再打开小程序中的扫码功能。我对产品交互的理念一直都是能一步到位的事情绝对不多一步去处理能让用户直接打开微信扫一扫完成的事情非要拆成两步三步放到小程序里面去干这种交互在我看来非常的愚蠢！微信的扫一扫功能已经非常强大了实在没有必要在已经这么强大又便捷的功能面前再自不量力的去自己写一遍并且写的还没微信好。综合上面两点思考我决定不去做扫一扫功能。那么这里又有一个问题出现一般我们在给别人联系方式的时候很少会面对面给大部分情况都是通过网上聊天或微信直接发。所以此时我要做的就是将这个二维码分享出去让好友长按之后能自动识别出来再添加这种场景会更多见一些。于是我便把当初要添加扫一扫功能的button按钮进行了一次改造换成了点击分享二维码功能将二维码直接直接发送分享出去将界面修改成了这个样子：好了所有关于产品的思考都已经完成了剩下的就是撸起袖子直接干。功能很简单我只花了半天的时间就全部开发完成了。但是我却觉得这是一个解决用户实际痛点的问题由这一个我们经常在生活中面临的实际问题出发通过层层思考接着确定功能和界面最后利用自己所学的技术将想法变成现实这一过程无比的有趣。写在最后其实在如今这个大功能都被人做完的时代里我们再想做一些事情的时候确实比较难但并不代表没有机会去做。就像我做出这款产品一样也是因为实际中有这么个痛点让我苦恼所以我才想着能不能通过自己的技术去帮助解决这个痛点。一款好的产品在我看来从来不需要做的多复杂也不需要有多炫酷的界面。杂而多的功能会让用户无从下手不知道自己到底怎么用要用什么；而炫酷的界面只会让用户停留在炫酷的效果中而忽视了产品的本身使用就像罗丹的断臂维纳斯一样一双过于完美的手会阻碍维纳斯整体的美于是罗丹毫不犹豫的将它砍掉。微信的界面从来就没有那么酷炫他的开屏界面永远都是一张卫星拍的地球图片但是你却从来离不开他。好的产品就是以简约至上复杂的功能和炫酷的界面在我看来只是在掩盖他华而不实的内在而已。如果有兴趣想体验下我的小程序欢迎扫码体验。如果有什么意见也欢迎留言。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    「小程序·云开发」开放               iPad 支持使用小程序分包加载等能力升级                                                        原作者:  晨雨细曲                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序时间轴组件                                                      • 小程序之图片懒加载 完美方案你不来看看？                                                      • 小程序多业务线融合【完整分包业务接入】                                                      • 微信小程序之动态获取元素宽高                                                                                               "},{"title": "微信小程序-麦当劳点餐+爬虫 ", "author": "                  Rolan                  2019-7-3 00:04                ", "text": "                                                                                                                                                                                     hello大家好这是我的第一篇掘金文章每天都在掘金上面看各位大佬的文章终于鼓足勇气决定写一篇属于自己的文章了。今天呢就给大家带来一篇微信小程序（麦当劳点餐）+爬虫的详解吧。大佬们可以忽略我这个小辣鸡但是如果你也是前端小白的话可以认真看看哟说不定对你有帮助呢。项目介绍这个小程序是为最近参加的一个小活动而制作的（为期两天3-4人组队完成一个小型项目）。说实话两天怎么可能完成一个小程序呢？在前两天我们大致完成了小程序基本结构然后由我完成收尾工作前前后后历时四天。项目预览图大家可以看到这个小程序有四个页面。项目工作分配由于我是组长所以工作的内容是由我分配的我们组内四个成员正好一人一个页面但是页面有简单和复杂之分的在我的暴政下分到了复杂页面的也不许抱怨！当然我是一个好组长我给自己分配了选餐的页面并且爬虫爬数据也由我完成。所以下面我给大家分享的就是我完成的那个页面。项目开始前的准备一些准备工作：申请账号：进入微信公众平台根据指示申请注册账号开发工具：VScode和微信开发者工具小程序官方文档github申请存储库使用的一些工具：小程序云开发数据库功能微信官方文档markMan(可以进行图片测量和标注的工具)iconfont(阿里巴巴矢量图标库有大量icon资源)github（由于这是我们一个小组完成的项目所以需要建一个新的存储库然后把大家拉进来）这里需要着重说明一下github命令行的操作一个人开发的时候直接git push就行。但是多人合作开发的时候是不能直接git push的如果别人先提交了项目然后你再提交之前一定先要git pull先把别人的项目拉下来然后在git push不然会导致冲突。其实除了这些基本的准备工作以外我们最应该做的就是思考。有一位前辈曾经告诉我在接手项目的时候不应该第一时间就去敲代码而是应该闭上眼睛思考一会。具体思考什么他也没有细说但是通过这次我领悟到了前辈的意思。首先我们需要仔细的看一下设计稿在脑子里搭建起来大致的框架以便在写代码的时候可以提升效率。其次我们应该思考数据如果存放打个比方：在做电商页面的时候点击左边导航栏右边内容框显示相应的数据这就涉及到数据的存放了。所以在写代码之前我们就应该思考好这些逻辑。项目完成过程下图就是我要完成的页面。第一开始看见这个页面的时候心里其实并不慌因为之前也做过一些电商的小程序所以知道这个页面的基本功能应该如何实现所以在写代码的过程中还算很顺利。点餐页面当看见这个页面的时候脑子里大致就需要搭建一个结构框架。页面上端是一个swiper用于滚动不同的广告。页面中间的部分是地址栏点击可以选择不同的商店。页面中下部是一个点餐栏左边和右边同时都要使用scroll-view。尾部是一个类似于购物车的东西这一部分建议大家写成一个组件调用为了减少代码耦合度。（虽然我没用组件）话不多说下面来分析结构吧！首先我们来看一下页面的swiper部分可以从图片看出这是一个广告位置用于放置最新的产品这一部分其实很简单直接引用小程序的swiper组件即可。<swiper indicator-dots=\"true\"         indicator-active-color=\"rgba(242,207,4,1)\"         autoplay=\"true\"         circular=\"true\"         interval=\"4000\"         duration=\"1000\"         class=\"header\"         wx:if=\"{{hidden}}\">        <swiper-item wx:for=\"{{adImage}}\" wx:key=\"index\">            <image mode=\"aspectFill\" class=\"headerImg\" src=\"{{item.image}}\" />        </swiper-item>    </swiper>复制代码这一部分代码如上需要提一下的就是swiper组件里面indicator-active-color这个属性只接受rgba形式不接受十六进制颜色的输入大家可以自行在百度上面找转换的方法。接下来就是地址栏的部分我这里放两张图片方便对比：这一部分的页面并不算简单首先外面的大盒子需要设置为弹性布局方便左边的地址栏还有右边的会员并排在一排。然后地址栏也需要设置为弹性布局将flex-flow设置为column就可以沿Y轴分布然后将align-items: center;就可以把店名还有地址放在方框中间。因为这个地址栏是可以点击切换地址的所以内边距不可以写死只能用弹性布局将它们放在中间如果选择的地址过长的话页面也会自动调整边距十分的美观。<!-- 地址栏 -->    <view class=\"middle\" wx:if=\"{{hidden}}\">        <navigator style=\"display: inline-block\" target=\"\" url=\"../index/index\" hover-class=\"navigator-hover\">            <view class=\"address\">                <view>                    <view class=\"storeName\">{{storeInfo.name}}</view>                    <view class=\"storeAdress\">{{storeInfo.address}}</view>                </view>            </view>        </navigator>        <view class=\"member\">            <image src=\"../../images/menuImg/u=324093054,273186418&fm=26&gp=0.jpg\" class=\"menberImg\" />            <text class=\"memberText\">会员中心</text>        </view>    </view>复制代码.middle{    height: 110rpx;    width: 100%;    background-color: #fff;    display: flex;    border-bottom: 1px solid #eeeeee;}.address{    width: 600rpx;    height: 110rpx;    display: flex;    align-items: center;    border-right: 1px solid #eeeeee;}.storeName{    line-height: 40rpx;    font-size: 28rpx;    font-weight: bold;    margin-left: 40rpx;}.storeAdress{    line-height: 34rpx;    font-size: 22rpx;    color: #737373;    margin: 0 40rpx;}.member{    width: 150rpx;    height: 110rpx;    padding: 16rpx 0;    box-sizing: border-box;    display: flex;    flex-flow: column;    align-items: center;}.menberImg{    width: 40rpx;    height: 40rpx;    border-radius: 50%;    margin: 0 ;}.memberText{    position: relative;    width: 100%;    font-size: 24rpx;    line-height: 24rpx;    text-align: center;    margin-top: 14rpx;}复制代码因为这里是有一个点击事件的点击过后跳转到选地址页面然后选完地址在跳转回本页面。那么在页面与页面之间是怎么传递数据的呢？在逛了一圈小程序开发文档之后我们发现了一个api十分的好用可以将页面的数据暂时放入缓存区以一个key来命名然后在另外一个页面也用相同的key来获取就可以获取缓存区的数据了下面来看看代码吧。toDetail (e) {    let idx = e.currentTarget.dataset.idx;    if (idx) {      wx.setStorage({        key:\"itemsIndex\",        data: this.data.items[idx],      })    } else {      wx.setStorage({        key:\"itemsIndex\",        data: this.data.items[0]      })    }    wx.navigateTo({      url: '../menu/menu'    })  },复制代码这是通过另外一个页面跳转我的页面的点击事件用wx.setStorage来存取数据。wx.getStorage({      key: 'itemsIndex',      success: (res) => {        let storeInfo = this.data.storeInfo;        storeInfo.name = res.data.name;        storeInfo.address = res.data.address;        // console.log(storeInfo);        this.setData({          storeInfo        })      },      fail: () => {},      complete: () => {}    });复制代码这是在本页面接收数据的方法并且这个方法要写在onLoad生命周期函数里这样就可以在页面加载的时候把获取到的数据渲染到页面上。然后就是本页面含金量最高的部分了这一部分应该是所有电商小程序都会用到的。其实说难也不难说简单也不简单只要认真看完我下面的讲解应该就了解要怎么做了。相信大家看到这个截图之后内心都有一些自己的想法那不妨继续看看我的做法然后与你们自己的想法融合在一起看看是不是会迸发出新的火花呢！<!-- 选餐栏 -->    <view class=\"menuContent\">        <view class=\"scrollLeft\">            <scroll-view scroll-y>                <navigator class=\"search\" url=\"../\" hover-class=\"none\">                    <image class=\"searchImage\" src=\"../../images/menuImg/sou-suo.png\" />                    <text class=\"searchText\">搜索</text>                </navigator>                <block wx:for=\"{{scrollLeft}}\" wx:key=\"index\">                    <view class=\"{{curIndex === index ? 'selected' : 'select'}}\"                     bindtap=\"onSelect\"                     data-index=\"{{index}}\"                     data-id=\"{{item.id}}\">                        <image src=\"{{item.url}}\"                         class=\"selImg\"                         wx:if=\"{{curIndex === index}}\" />                        <view class=\"{{curIndex === index ? 'selectedText' : 'selectText'}}\">                            {{item.name}}                        </view>                    </view>                </block>            </scroll-view>        </view>        <view class=\"scrollRight\">            <scroll-view scroll-y scroll-into-view=\"{{toView}}\"             scroll-with-animation=\"true\"             bindscroll=\"scrollTop\"             style=\"height: 1205rpx\">                <block wx:for=\"{{scrollRight}}\" wx:key=\"index\">                    <view class=\"food\"                     wx:for=\"{{item.detail}}\"                     wx:key=\"index\"                     wx:for-item=\"food\"                     id=\"{{item.id}}\">                        <view class=\"foodName\">{{food.name}}</view>                        <view class=\"foodPrice\">                            ￥                            <view class=\"foodPriceNum\">{{food.price}}</view>                            起*                        </view>                        <image src=\"{{food.img}}\" class=\"foodPci\" />                        <view class=\"custom\">                            <view class=\"customText\">去定制</view>                            <navigator url=\"../cart/cart\"                             hover-class=\"none\">                                <view class=\"customBtn\"                                 bindtap=\"gotoCart\"                                 data-id=\"{{item.id}}\"                                 data-index=\"{{index}}\">                                    <image src=\"../../images/menuImg/toRight.png\" class=\"customPic\" />                                </view>                            </navigator>                        </view>                        <view class=\"order\">                            <view class=\"orderText\">大套餐</view>                            <view class=\"orderselect\" wx:if=\"{{food.showCombo}}\">                                <view class=\"reduce\" bindtap=\"OnReduce\" data-id=\"{{item.id}}\" data-index=\"{{index}}\">                                    <image src=\"../../images/menuImg/jianhao.png\" class=\"orderPic\" />                                </view>                                <text class=\"orderTitle\">{{food.title}}</text>                                <view class=\"add\" bindtap=\"OnAdd\" data-id=\"{{item.id}}\" data-index=\"{{index}}\">                                    <image src=\"../../images/menuImg/jiahao.png\" class=\"orderPic\" />                                </view>                            </view>                            <view class=\"orderBtn\" wx:else bindtap=\"OnAdd\" data-id=\"{{item.id}}\" data-index=\"{{index}}\">                                <image src=\"../../images/menuImg/jiahao.png\" class=\"orderPic\" />                            </view>                        </view>                    </view>                </block>            </scroll-view>        </view>    </view>复制代码从页面结构可以看出这一部分分为左边和右边两部分然后都通过wx:for循环将数据循环渲染在页面上左边和右边也都使用了scroll滚动条这里有一个坑不知道大家是否踩过就是使用小程序scroll-view组件时必须要给这个组件设置固定的高度或者宽度（这采决与你是设置了Y方向滚动还是X方向滚动）如果不设置高度的话滚动条就会失效虽然这个坑我已经踩过很多次了但是每当我遇到时都还会在踩一遍。这里由于css太多了所以就不放上来了展示给大家看了如果有想看朋友可以去文章最下面的github地址观看。在css里也有一个坑那就是在选择布局的时候有两种方法第一种是使用弹性布局将左边导航栏和右边选餐栏并排一起。第二种是使用display: inline-block;方法使得左边导航栏和右边选餐栏都变成行内块元素并排在一起虽然布局上面没问题但是当循环数据时你就会发现右边的数据会倒叙排列我也没有找到会导致这种方法的原因。所以遇到左右两边需要并排且需要填充数据的时候推荐使用弹性布局。接下来就是最最最最难的逻辑部分了我会给大家分左边和右边来讲解。虽然百度上面也有很多左右联动的逻辑方法但是百度到的答案不尽人意所以我就取其精华去其糟粕写了一下自己的逻辑接下来我就要给大家细致的讲一下左右联动的效果实现。我们先来看看点击左边导航栏然后点击的导航栏变换样式是怎样实现的。onSelect(e) {    console.log(e);    const that = this;    const curIndex = e.currentTarget.dataset.index;    const toView = e.currentTarget.dataset.id;    console.log(toView)    that.setData({      curIndex,      toView    })  },复制代码这里通过点击事件获取到该数据的index并赋值给curIndex然后通过判断class=\"{{curIndex === index ? 'selected' : 'select'}}\"改变样式。同时点击事件时也将数据里的id值赋给toView然后在右边的滚动条里设置scroll-into-view=\"{{toView}}\"通过这个属性滚动条就可以自动跳转到对应的toView数据里。这是小程序自定义的方法可以很方便的做到点击左边右边自动跳转的操作。但是滚动右边左边样式也自动切换就不是那么容易的事情了。.then(res => {          let heightArr = [];          const height = 180;          let heightList = 0          for(let i = 0; i < res.length; i++) {            heightList += res[i].detail.length * height;            heightArr.push(heightList);          }          // console.log(heightArr);          this.setData({            heightArr          })        }) 复制代码在这里我是在onLoad生命周期函数里先请求数据通过.than接收到数据const height = 180;这是我设置的每一个食物框的固定高度所以通过这个高度乘以分类里面的每个数据就可以获得右边滚动条不同分类的高度区间然后存入heightArr数组。scrollTop(e) {    // console.log(e)    const scrollTop = e.detail.scrollTop;    if(scrollTop > 100) {      this.setData({        hidden: false      })    }    else{      this.setData({        hidden: true      })    }    const heightArr = this.data.heightArr;    for(let i = 0; i < heightArr.length; i++) {      if(scrollTop > 0 && scrollTop < heightArr[0]) {        this.setData({          curIndex: 0        })      } else if (scrollTop < heightArr[i] && scrollTop > heightArr[i - 1]) {        this.setData({          curIndex: i        })      }    }  },复制代码右边高度的区间我们已经得到了然后我们应该怎么利用好它呢？在scroll-view组件里有一个bindscroll=\"scrollTop\"方法是滚动滚动条时可以触发的事件这个方法可以获取到滚动的顶部在滚动时距离顶部的距离。那么我们就可以利用这个滚动的距离然后获取到这个距离在heightArr区间的哪一部分然后将这个区间的索引值赋值给curIndex。 这样左边的样式就能随右边滚动而改变了。这个方法大家学会了嘛如果没有看懂可以在下面评论区问我哟！OnAdd(e) {    const id = e.currentTarget.dataset.id;    const indexSelect = e.currentTarget.dataset.index;    let totalPrice = this.data.totalPrice;    let index = id.split('l')[1];    let scrollRight = this.data.scrollRight;    const price = scrollRight[index].detail[indexSelect].price;    scrollRight[index].detail[indexSelect].title++;    scrollRight[index].detail[indexSelect].showCombo = true;    totalPrice = totalPrice + price;    this.setData({      scrollRight,      totalPrice    })  },  OnReduce(e) {    const id = e.currentTarget.dataset.id;    const indexSelect = e.currentTarget.dataset.index;    let index = id.split('l')[1];    let scrollRight = this.data.scrollRight;    let title = scrollRight[index].detail[indexSelect].title;    let totalPrice = this.data.totalPrice;    const price = parseFloat(scrollRight[index].detail[indexSelect].price);    totalPrice = totalPrice - price;    if(title > 1) {      scrollRight[index].detail[indexSelect].title--;      this.setData({        scrollRight,        totalPrice      })    }else if(title = 1) {      scrollRight[index].detail[indexSelect].title--;      scrollRight[index].detail[indexSelect].showCombo = false;      this.setData({        scrollRight,        totalPrice,      })    }  },复制代码上面是一些简单的加和减的方法点击+号的时候触发onAdd事件获取到当前点击事件的索引值然后找到数据里面每一项的价格以及数量除了将数量+1之外还需要算出当前所有物品的总价。点击-号的方法一样我就不再赘述了。最后就是页面下端的购物车部分了当选餐时就会自动跳出购物车按钮然后点击购物车就会显示出购物清单列表在购物清单列表中也可以增加或者减少食物。<view class=\"shoppingList\" wx:if=\"{{showList && totalPrice != 0}}\">        <view class=\"shadow\" bindtap=\"onList\"></view>        <view class=\"shoppingBottom\">            <view class=\"shoppingHeader\">                <view class=\"hasSelected\">                    <image src=\"../../images/menuImg/shoppingGray.png\" class=\"image\" />                    <view class=\"text\">已选产品</view>                </view>                <view class=\"empty\" bindtap=\"onEmpty\">                    <image src=\"../../images/menuImg/lajitong.png\" class=\"image\" />                    <view class=\"text\">清空</view>                </view>            </view>            <scroll-view scroll-y                 style=\"max-height: 534rpx\">                <block wx:for=\"{{scrollRight}}\" wx:key=\"index\">                    <view class=\"shoppingBody\" wx:for=\"{{item.detail}}\" wx:for-item=\"food\" wx:if=\"{{food.showCombo}}\" wx:key=\"index\">                        <view class=\"name\">{{food.name}}</view>                        <view class=\"unitPrice\">                            ￥                            <view class=\"unitPriceNum\">{{food.price * food.title}}</view>                        </view>                        <view class=\"orderselect addPlace\">                            <view class=\"reduce\" bindtap=\"OnReduce\" data-id=\"{{item.id}}\" data-index=\"{{index}}\">                                <image src=\"../../images/menuImg/jianhao.png\" class=\"orderPic\" />                            </view>                            <text class=\"orderTitle\">{{food.title}}</text>                            <view class=\"add\" bindtap=\"OnAdd\" data-id=\"{{item.id}}\" data-index=\"{{index}}\">                                <image src=\"../../images/menuImg/jiahao.png\" class=\"orderPic\" />                            </view>                        </view>                    </view>                </block>            </scroll-view>        </view>    </view>    <!-- 选好了 -->    <view class=\"shopping\" wx:if=\"{{totalPrice != 0}}\">        <view class=\"shoppingLeft\">            <view class=\"shoppingCar\" bindtap=\"onList\">                <image src=\"../../images/menuImg/shopping.png\" class=\"shoppingImg\" />            </view>            <view class=\"shoppingPrice\">                <view class=\"priceTitle\">￥</view>                <view class=\"priceNum\">{{totalPrice}}</view>            </view>        </view>        <navigator url=\"../settlement/settlement\" class=\"shoppingRight\" bindtap=\"gotoSettlement\" >            <view class=\"rightText\">选好了</view>            <image src=\"../../images/menuImg/yellowRight.png\" class=\"rightImg\" />        </navigator>    </view>复制代码这是购物清单还有购物车的部分使用position: fixed;将这部分固定在屏幕的底部不会随着屏幕滑动而滑动在结构上面还设置了一个蒙层当展示购物清单时显示。// 是否显示选餐列表  onList() {    let showList = this.data.showList;    showList = !showList;    this.setData({      showList    })  },  // 清空事件  onEmpty() {    const scrollRight = this.data.scrollRight;    for(let i = 0; i < scrollRight.length; i++) {      for(let j = 0; j < scrollRight[i].detail.length; j++) {        scrollRight[i].detail[j].title = 0;        scrollRight[i].detail[j].showCombo = false;      }    }    this.setData({      scrollRight,      totalPrice: 0,      showList: false    })  },  // 跳转到cart页面  gotoCart(e) {    // console.log(e)    const id = e.currentTarget.dataset.id;    const indexSelect = e.currentTarget.dataset.index;    let index = id.split('l')[1];    let scrollRight = this.data.scrollRight;    const zhushi = scrollRight[index].detail[indexSelect];    console.log(zhushi);    wx.setStorage({      key: \"cartFood\",      data: zhushi    })  },复制代码这些方法都是基本方法还是很简单的大家看一下应该就知道做什么的了也不再一一介绍了。啊啊啊啊啊啊啊啊啊啊好累码了这么多字感觉写文章比写小程序还累！但是我不能停下来因为还有重点没有讲！接下来就是这篇文章的重点部分了小伙伴们快竖起耳朵听啊！爬虫爬取数据相信大家在写小项目的时候最头疼的就是写假数据了每次编写假数据自己看的都头皮发麻。所以我给大家带来一个简单的爬虫不仅可以轻轻松松的获取到数据而且显得既高端又专业！我把爬虫写在了云函数里这样可以直接在运行云函数的时候就把爬虫爬取到的数据直接存储到云数据库。在写爬虫之前首先需要将运行环境初始化成node运行环境然后下载基本的依赖以便后面可以在网页上获取数据。因为我这里要获取到的数据在不同的页面里所以我先将网页全部定义好方便直接引用。同时我也创建了不同的空数组为了将从不同网页中获取到的不同数据存入不同的数组里。这些准备工作都做完了下面来看看代码吧。const cloud = require('wx-server-sdk');const request = require('request');const cheerio = require('cheerio');const breakfast = 'http://www.5ikfc.com/mdl/menu/breakfast/';  //早餐const chaozhitaocan = 'http://www.5ikfc.com/mdl/menu/chaozhitaocan/';  //超值套餐const happymeals = 'http://www.5ikfc.com/mdl/menu/happymeals/';  //快乐套餐const sides = 'http://www.5ikfc.com/mdl/menu/sides/';  //配餐const drink = 'http://www.5ikfc.com/mdl/menu/drink/';  //饮料const dessert = 'http://www.5ikfc.com/mdl/menu/dessert/';  //甜品const mccafe = 'http://www.5ikfc.com/mdl/menu/mccafe/';  //麦咖啡let breakfastList = [];let chaozhitaocanList = [];let happymealsList = [];let sidestList = [];let drinkList = [];let dessertList = [];let mccafeList = [];// 初始化 cloudcloud.init()const db = cloud.database();function maidanglaoSpider(http, list) {    return new Promise((resolve, reject) => {        request(http,        (err, res) => {            if(err) {                reject('net error');            }            if(!err) {                const body = res.body;                const $ = cheerio.load(body, {                decodeEntities: false                })                $('.lside.fr.bdgrey.main_wrap .fx li')                .each(function() {                    const img = $('a img', this).attr('src');                    const name = $('a', this).text().trim();                    const price = $('b', this).text().trim();                    list.push({                        name,                        img,                        price                    })                    console.log({                        name,                        img,                        price                    })                })                resolve(list);            }        })    })}maidanglaoSpider(breakfast,breakfastList).then(res => {    console.log(res);})复制代码首先往爬虫函数里传http和list两个参数因为我需要将不同网页的数据存入不同的list里面。然后函数return一个Promise函数然后在promise函数里发起请求如果请求没有报错的话就const body = res.body获取网页的html的body结构然后通过 ('a img', this).attr('src');获取我们需要的图片的src；通过const name = ('b', this).text().trim();获取到需要的价格。最后将这三个数据以对象的形式push进数组然后resolve出来。到这里我们的爬虫函数就写好啦然后下面就需要把数据传入云数据库了。exports.main = async (event, context) => {        const breakfastData = await maidanglaoSpider(breakfast, breakfastList);        const chaozhitaocanData = await maidanglaoSpider(chaozhitaocan, chaozhitaocanList);        const happymealsData = await maidanglaoSpider(happymeals, happymealsList);        const sidesData = await maidanglaoSpider(sides, sidestList);        const drinkData = await maidanglaoSpider(drink, drinkList);        const dessertData = await maidanglaoSpider(dessert, dessertList);        const mccafeData = await maidanglaoSpider(mccafe, mccafeList);        let arrData = [breakfastData,chaozhitaocanData,happymealsData,sidesData,drinkData,dessertData,mccafeData]                for(let i = 0; i < arrData.length; i++) {            await db.collection('food').add({                data: {                    id: i,                    detail: arrData[i]                }            })        }}复制代码我首先将不同的数据命名好然后将他们放进arrData数组里然后通过遍历这个数组把每一项数据都存入云函数里。云数据库内容如下当我同一个小组的大佬看到我的云数据库以后对我进行了夸赞：“您真是将数据库运用到了极致。”当然了这并不是夸赞而是无情的嘲讽。我在存数据的时候将所有数据存在了一个集合中并且在集合中将数据划分开来（这是极度错误的做法希望大家不要效仿我）由于这是我第一次使用云数据库存数据所以犯这种错误也能体谅。正确做法是：将每一个种类的数据存放在一个集合中不要吝啬数据库的使用。获取数据上面我们已经把爬虫的数据存进云函数了然后就到了获取数据的时候了。wx.cloud.callFunction({      name: 'foodData',      success: (res) => {        // console.log(res);        db.collection('breakfast')        .get()        .then(res => {          let food = {};          food.id =  `l${res.data[0].id}`          food.detail = res.data[0].detail.slice(0,5);          food.title = 0;          let scrollRight = this.data.scrollRight;          scrollRight.push(food);          this.setData({            scrollRight          })          return res        })        .then(res => {          let food = {};          food.id =  `l${res.data[1].id}`          food.detail = res.data[1].detail.slice(0,5);          food.title = 0;          let scrollRight = this.data.scrollRight;          scrollRight.push(food);          this.setData({            scrollRight          })          return res        })        .then(res => {          let food = {};          food.id =  `l${res.data[2].id}`          food.detail = res.data[2].detail.slice(0,5);          food.title = 0;          let scrollRight = this.data.scrollRight;          scrollRight.push(food);          this.setData({            scrollRight          })          return res        })        .then(res => {          let food = {};          food.id =  `l${res.data[3].id}`          food.detail = res.data[3].detail.slice(0,5);          food.title = 0;          let scrollRight = this.data.scrollRight;          scrollRight.push(food);          this.setData({            scrollRight          })          return res        })        .then(res => {          let food = {};          food.id =  `l${res.data[4].id}`          food.detail = res.data[4].detail.slice(0,5);          food.title = 0;          let scrollRight = this.data.scrollRight;          scrollRight.push(food);          this.setData({            scrollRight          })          return res        })        .then(res => {          let food = {};          food.id =  `l${res.data[5].id}`          food.detail = res.data[5].detail.slice(0,5);          food.title = 0;          let scrollRight = this.data.scrollRight;          scrollRight.push(food);          this.setData({            scrollRight          })          return res        })        .then(res => {          let food = {};          food.id =  `l${res.data[6].id}`          food.detail = res.data[6].detail.slice(0,5);          food.title = 0;          let scrollRight = this.data.scrollRight;          scrollRight.push(food);          console.log(food);          this.setData({            scrollRight          })          return res        })复制代码本来我想的是利用循环把数据遍历出来然后通过循环存进定义的空数组里。但是我怎么也存不进去实在找不到原因我就把数据的每一项都单独拎出来然后存进去。虽然代码很不美观但是总算把数据存进去了。这个函数要写在onLoad生命周期函数里这样可以在页面加载的时候就把数据获取到然后渲染到页面上。至此我的个人页面就完成了小伙伴们也将他们的页面提交到了github上面本以为工作就结束了可以高高兴兴的玩耍了。但是转头一想页面跳转的工作还没人做呢哎谁让我是小组长呢只能由我这个“老父亲”来做收尾工作了。收尾工作其实收尾工作很简单就是改一下路由跳转并且传送一下对应的数据就行。传送和接收数据代码如下：wx.setStorage({        key:\"itemsIndex\",        data: this.data.items[idx],    })wx.getStorage({      key: 'itemsIndex',      success: (res) => {        let storeInfo = this.data.storeInfo;        storeInfo.name = res.data.name;        storeInfo.address = res.data.address;        // console.log(storeInfo);        this.setData({          storeInfo        })      },      fail: () => {},      complete: () => {}    });复制代码在跳转页面时利用wx.setStorage将数据放入缓存区然后在需要数据的页面利用wx.getStorage获取缓存区的数据。好啦工作算是结束了给大家来看看我们的最终成果把！嘿嘿总体来说还算过得去吧一些总结小程序写完了总得有一些工作总结对吧我觉得通过这次几个小伙伴通力合作我感慨还是蛮多的给大家总结一下几点吧！第一！最重要的就是！心平气和。几个小伙伴合作写项目难免在一些观点上面有分歧但是大家一定要心平气和的商讨不能各执己见。虽然我们团队在写项目的时候也有几句争吵但是总体来说还算平和。第二！一定要注意代码的质量以前一直是一个人写代码没有体会到代码质量的重要性但是通过这次合作我发现代码一定要写的简单易懂也要多写注释这样方便别人修改你的代码同时也方便自己阅读。第三！一定要坚持有些事情看似很难但是只要坚持下来你会发现那些困难再一点点土崩瓦解到最后会被你完全击溃。第四！不懂就问不管是老师同学还是百度不懂就要去问不能把问题放在那里不解决只要多问多思考就会一点点有思路了。以上几点就是这次小项目完成的总结啦同时也是这篇文章的收尾了这篇文章是我第一次写文章所以我知道可能很差所以大家有什么建议的话一定要给我留言方便我改进同时如果大家对这个项目有什么不懂的也可以在留言区问我会细心解答的！这是这个项目的github地址： github.com/Yeqing98/Ma… （有需要的小伙伴可以拿去参考一下噢！）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)张钟旺                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    腾讯在线教育小程序开发实践之路               开发 地图标记工具 后记                                                        原作者:  短叹illusion                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序顶部导航栏，可滑动，可动态选中放大效果 ", "author": "                  Rolan                  2019-11-25 00:36                ", "text": "                                                                                                                                                                                     老规矩先看效果图可以看到我们实现了如下功能1顶部导航栏 2可以左右滑动的导航栏 3选中条目放大 原理其实很简单我这里把我研究后的源码发给大家吧。wxml文件如下<!-- 导航栏 --><scroll-view scroll-x class=\"navbar\" scroll-with-animation scroll-left=\"{{scrollLeft}}rpx\">  <view class=\"nav-item\" wx:for=\"{{tabs}}\" wx:key=\"id\" bindtap=\"tabSelect\" data-id=\"{{index}}\">    <view class=\"nav-text {{index==tabCur?'tab-on':''}}\">{{item.name}}</view>  </view></scroll-view>wxss文件如下/* 导航栏布局相关 */.navbar {  width: 100%;   height: 90rpx;  /* 文本不换行 */  white-space: nowrap;  display: flex;  box-sizing: border-box;  border-bottom: 1rpx solid #eee;  background: #fff;  align-items: center;  /* 固定在顶部 */  position: fixed;  left: 0rpx;  top: 0rpx;}.nav-item {  padding-left: 25rpx;  padding-right: 25rpx;  height: 100%;  display: inline-block;  /* 普通文字大小 */  font-size: 28rpx;}.nav-text {  width: 100%;  height: 100%;  display: flex;  align-items: center;  justify-content: center;  letter-spacing: 4rpx;  box-sizing: border-box;}.tab-on {  color: #fbbd08;  /* 选中放大 */  font-size: 38rpx !important;  font-weight: 600;  border-bottom: 4rpx solid #fbbd08 !important;}js文件如下// pages/test2/test2.jsPage({  data: {    tabCur: 0, //默认选中    tabs: [{        name: '等待支付',        id: 0      },      {        name: '待发货',        id: 1      },      {        name: '待收货',        id: 2      },      {        name: '待签字',        id: 3      },      {        name: '待评价',        id: 4      },      {        name: '五星好评',        id: 5      },      {        name: '差评订单',        id: 6      },      {        name: '编程小石头',        id: 8      },      {        name: '小石头',        id: 9      }    ]  },  //选择条目  tabSelect(e) {    this.setData({      tabCur: e.currentTarget.dataset.id,      scrollLeft: (e.currentTarget.dataset.id - 2) * 200    })  }})代码里注释很明白了大家自己跟着多敲几遍就可以了。后面会更新更多小程序相关的知识请持续关注。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序云开发：菜鸟也能全栈做产品               微信小程序——基础知识                                                        原作者: 编程小石头                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序七夕节礼物 ", "author": "                  Rolan                  2019-8-7 00:09                ", "text": "                                                                                                                                                                                     VSCode Node.js HbuilderX安装前端开发环境npm install -g cnpm --registry=https://registry.npm.taobao.orgcnpm install -g lessHBuilderX是国内最优秀的前端开发工具我们用它来开发Electron项目和小程序项目{  \"pages\": [    \"pages/index/index\"  ],  \"requiredBackgroundModes\": [    \"audio\",    \"location\"  ],  \"subPackages\": [],  \"window\": {    \"navigationBarTextStyle\": \"black\",    \"navigationBarTitleText\": \"我喜欢你\",    \"navigationBarBackgroundColor\": \"#F8F8F8\",    \"backgroundColor\": \"#F8F8F8\"  },  \"usingComponents\": {}}@import './common/main.wxss';require('./common/runtime.js')require('./common/vendor.js')require('./common/main.js').content {  padding: 0 40rpx;}.content image {  width: 100%;}.content .title {  display: block;  text-align: center;  font-size: 50rpx;  font-weight: bold;}.content .operate {  text-align: center;  margin-top: 30rpx;  margin-bottom: 30rpx;}.content .operate .btn {  width: 200rpx;  height: 80rpx;  display: inline-block;}.content .operate .btn:first-of-type {  margin-right: 40rpx;}.content .message {  font-size: 34rpx;  margin: 15rpx 0;  color: #333;}<view class=\"content\"><image src=\"../../static/g1.gif\" mode=\"widthFix\"></image><text class=\"title\">小姐姐做我女朋友吧！</text><view class=\"operate\"><button class=\"btn\" type=\"primary\" data-event-opts=\"{{[['tap',[['agree',['$event']]]]]}}\" bindtap=\"__e\">好呀</button><button class=\"btn\" type=\"warn\" data-event-opts=\"{{[['tap',[['disagree',['$event']]]]]}}\" bindtap=\"__e\">不好</button></view><block wx:for=\"{{love}}\" wx:for-item=\"one\" wx:for-index=\"__i0__\" wx:key=\"*this\"><view class=\"message\">{{one}}</view></block></view>若本号内容有做得不到位的地方（比如：涉及版权或其他问题）请及时联系我们进行整改即可会在第一时间进行处理。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w蓝色安素53                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序页面通信、数据刷新、事件总线 、event bus 终极解决方案之 iny-bus ...               微信小程序云端解决方案探索之路                                                        原作者: 达叔小生                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序iOS端如何暂停animated动画 ", "author": "                  Rolan                  2018-8-2 00:03                ", "text": "                                                                                                                                                                                     在知道有 animation-play-state 这个animation的参数时我内心是激动的。在得知iOS端并不支持时一股凉意袭来animation-play-state先来介绍一下今天的主角 animation-play-stateanimation-play-stateCSS属性定义一个动画是否运行或者暂停。可以通过查询它来确定动画是否正在运行。另外它的值可以被设置为暂停和恢复的动画的重放。恢复一个已暂停的动画将从它开始暂停的时候而不是从动画序列的起点开始在动画。在MDN文档中了解到这是一个实验中的功能但是其作用还是强大的。既可以控制/获取元素的动画状态（pausedrunning）所以这个animation的参数用来控制动画的播放状态再合适不过了。画外音：你还没考虑兼容性呢！对！就是这个兼容性问题。在chrome上这个参数是可以支持的但是iOS设备上就不支持了...叹息。在iOS上的处理当然不能因为兼容性问题就不用这个参数了当然不能让每个iOS用户去下载一个chrome浏览器当然...那我们怎么解决呢？？？用JS通过 Window.getComputedStyle() 方法我们可以获取元素实时的 style 的 CSSStyleDeclaration 对象这个对象表示CSS属性键值对的集合。也就是说我们使用这个方法可以获取一个正在进行动画的元素当前的 style 值。PS:关于 Window.getComputedStyle() 方法的值可以在MDN上了解到这里不展开叙述。给出一个语法的例子（摘自MDN）let style = window.getComputedStyle(element, [pseudoElt]);复制代码那么具体要怎么做呢？实现See the Penanimation-play-state by luogao (@luogao) onCodePen.代码已经在上面的codepen预览中展示啦如果现实不来请点这里:point_right:Roy Luo's codepen大致解释一下就是：在元素的外层的包裹元素上添加获取到的执行动画的元素的 style 计算属性从而让执行动画的元素暂停下来。那么在微信小程序中又是如何呢？其实最先遇到这个问题是在做小程序的时候。一个播放器的界面中间一张专辑图片。在圆形的黑胶唱片边框中旋转。当播放停止图片也同时停止旋转。 停在当前旋转的位置当时看似简单的一个需求使用了 animation-play-state 并且与预期一样达到了效果 在模拟器中 。没错洋洋得意的以为完成了需求结果真机（iOS）上一测试原形毕露。当时看到小程序的官方社区中提到说iOS不支持这个 animation-play-state ‍♂️ ‍♂️ ‍♂️ ‍幸得残阳映枫红在sf的一个问题中的回答让我找到了方向。感谢之～                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序如何获取群聊的openGid以及名称               【重构】微信小程序倒计时组件                                                        原作者: RoyLuo                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序弹出和隐藏遮罩层动画以及五星评分                                                      • 小程序条形倒计时动画                                                      • 小程序抛物线动画                                                      • 利用css transition属性实现一个带动画显隐的微信小程序部件                                                                                               "},{"title": null, "author": "", "text": ""},{"title": "研究了多个出行类小程序后，我们发现了留住用户的秘密 ", "author": "                  Rolan                  2019-8-26 00:02                ", "text": "                                                                                                                                                                                     上一期我们聊到小程序“蓝牙能力”就像篮球场上力挽狂澜的“第六人”。这次微信公开课与晓程序观察（yinghoo-tech）一起继续研究“蓝牙”能力在出行场景里发挥的作用。我们发现除了智能家居、共享充电设备领域蓝牙在出行领域更是一个“神器”堪比“好邻居”蜘蛛侠一样能解决各种身边的问题。日常出行中这些“奇葩”景象不陌生： 过高速收费站时人工收费通道排长龙ETC通道廖无几人；充值交通卡时明明手机就能解决很多人却去窗口“人挤人”；好不容易发现一辆共享单车却因网络太差而开不了锁只好放弃... 这些新技术的出现原本是为方便我们出行生活的如今却因为网络问题或者是体验不好成为“bug”如ETC难办、充值App下载有门槛、共享单车网络开锁不稳定等。另一方面对于开发者来说因此流失用户也不值当。 “小程序+蓝牙”是怎么来解决这些问题的？ 我们邀请到ETC助手、e行卡、卡亭、青桔单车等四款小程序的开发者来谈谈如何发挥蓝牙的“超能力”。12.5亿车主需要的ETC业务 小程序+蓝牙都不能少截至2019年6月全国汽车保有量达2.5亿。在国家ETC政策的推动下办理ETC成了全国车主们纷纷关心的大事。但ETC难办确是落实困难的主要原因。 去线下办理过ETC的朋友应该清楚不仅网点覆盖少办理过程更是繁琐期间一度想要放弃“还是踏踏实实走人工通道吧反正也很少走高速”。现在通过小程序车主像是拥有了一位“私人助理”足不出户就能办理ETC。一款叫做「ETC助手」的小程序正是使用了蓝牙能力成为了很多车主办理ETC的首选。 「ETC助手」小程序团队感叹：“有了小程序蓝牙能力后用户不用专门花上几个小时的时间去找ETC服务网点了。ETC设备激活只需十几秒可以随时进行。”以前这一步骤是线下ETC网点工作人员来完成的。另一款小程序「e行卡」也可以自助办理ETC用户通过「e行卡」进行申请收到电子标签（OBU）与e行卡之后就可以自己安装激活设备了。过程很简单先将电子标签贴在车前挡风玻璃插入e行卡。等OBU蓝牙打开进入「e行卡」小程序内的“装标签”与OBU蓝牙连接成功后按照流程操作就行。看似复杂的过程车主实际操作起来不到1分钟就能搞定。蓝牙充当了激活ETC设备的关键角色。“蓝牙”秒速连接的能力让车主几乎无门槛地享受到了不用停车直接过收费站的快感。 对于开发者来说实现也不复杂相比App蓝牙能力较高的开发难度小程序则直接调用蓝牙能力就能完成。正是有了“蓝牙”的助攻这两个小程序也出现了“前所未有”增长现象。 “自去年7月上线以来现在还能保持每月100万以上的用户增长”「e行卡」小程序团队说。ETC助手小程序的最新用户也达到了2500万。2蓝牙竟然能充公交卡？这是真的……针对出行场景小程序蓝牙能力不仅能让有车一族更加便利对习惯“环保出行”的用户蓝牙能力照样能出一份力。比如充值公交卡。 你一定有过这样的经历：早高峰飞奔着来到地铁站一刷卡却显示“余额不足”此时心中肯定是想把自己“打死”。充值公交卡这件事似乎是一个“魔咒”越是赶时间的时候公交卡越容易出现“余额不足”的情况。 虽然可以选择现金充值、下载App充值但带现金和下载App本身就是一道“槛”。 而“小程序+蓝牙”可以“神奇”地实现充值。以「卡亭」小程序为例用户只需找到充值设备将公交卡放入卡槽内然后打开手机蓝牙用微信扫描二维码充值即可既方便又高效。（小程序蓝牙公交卡充值机器）它充值的逻辑就是小程序通过蓝牙与充值设备形成连接然后将充值后的数据同步到公交卡而蓝牙能力在这一过程中起到了核心作用。开发难度上也不大直接将蓝牙能力放进小程序即可。3解锁共享单车有时候蓝牙比4G更好用有时候明明触手可及却又“不可触摸”。说的就是网络信号弱时打开了共享单车小程序但没法连接单车。原来3秒就能开锁的简单动作就变成了长时间的等待甚至开不了锁。因此拓展更多解锁方式是共享单车们都在做的“功课”。「青桔单车」曾在扫码之外还用过短信通知的方式开锁但成本、效率上都不尽如人意。于是开发成本低、解锁速度又快的“蓝牙”脱颖而出。用户打开蓝牙扫码进入小程序就能直接解锁。“不论什么环境下蓝牙锁依然能保持非常高的开锁成功率。”开锁成功率的提升也标志着用户留存的提升青桔单车小程序项目组表示蓝牙能力给「青桔」单车带来了5%以上的订单增量。 随着「青桔」单车对蓝牙能力的理解加深他们也为开发者总结了一些经验：  01 尽可能去掌握蓝牙（BLE）的协议及特性比如通信的距离数据传输的方式。  02 iOS、Android在通信的方式上有差异比如IOS搜索到的蓝牙设备需要转一层才是MAC地址。  03 在进行蓝牙写动作不能连续写可以每次写的时候加个100ms的延时同时传输的数据超过20字节需要进行分片发送。  04 多看文档一定要多看文档因为各平台对蓝牙接口的处理方式不一定相同一定要注意细节。 细节决定成败或许未来不仅仅是出行、智能家居、通讯、车载设备等场景会有更多小程序发现“蓝牙”的更多玩法。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序自定义弹层禁止页面滚动方案详解               【微信小程序】图片压缩-纯质量压缩非长宽裁剪压缩                                                        原作者: 晓程序观察                     来自: 微信公众号                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "Kbone原理解析 & 小程序技术选型 ", "author": "                  Rolan                  2019-12-12 00:24                ", "text": "                                                                                                                                                                                     转载自微信开放社区： https://developers.weixin.qq.com/community/develop/article/doc/0006a6326b8d38e56b998833456813官方介绍“Kbone 是一个致力于微信小程序和 Web 端同构的解决方案。”Web端框架基本原理首先我们来看下普通Web端框架以Vue框架为例一份Vue模板对应一个组件在代码构建阶段编译成调用Dom接口的JS函数执行此JS函数就会创建出组件对应的Dom树从而渲染到浏览器页面上。然而小程序是双线程的并没有Dom树的概念逻辑层和视图层完全分离逻辑层是一个纯粹的JSCore,开发者可以编写JS脚本但是无法直接调用Dom/Bom的api, 没有任何浏览器相关的实现。在小程序中视图层和逻辑层的交互是通过数据和时间驱动的。因此要实现跨端同构问题是：怎么将web端代码转为小程序代码？业界常规做法目前业界流行的第三方跨端框架们常规做法都是：静态编译兼容。原理是把代码语法分析一遍然后将其中的模板部分翻译成对应的跨端需求的模板（微信小程序、支付宝小程序、H5、APP等）。静态编译最大的局限性是无法保证转换的完整性因为Vue模板和WXML模板的语法并不是直接对等的Vue的特性设计也和小程序的设计无法划等号这自然就导致了部分Vue特性的丢失。比如像Vue中的v-html指令、ref获取Dom节点、过滤器等就通通用不了。除了Vue自身的特性外一些原本依赖Dom/Bom接口的Vue插件页无法使用例如Vue-Router。Kbone的做法Kbone是通过提供 适配器 的方式来实现同构即运行时兼容而非静态编译。Kbone的适配器核心包含两个部分：miniprogram-render： 仿造Dom/Bom接口构造仿造Dom树；miniprogram-element: 监听仿造Dom树变化渲染到页面同时监听用户行为触发事件。仿造Dom树和浏览器的运行时对比：仿造Dom树：利用内置组件和自定义组件的自引用来进行递归创建组件树。如图自定义custom-dom为递归自引用组件：递归的终止条件是遇到特定节点、文本节点或者children空节点。在创建出组件树猴将Dom节点和自定义组件实例进行绑定以便后续的Dom更新和操作。kbone这里还对节点数进行了优化：如果一个dom节点对应一个自定义组件的话就会创建很多自定义组件这样会很浪费开销这里做了子树的合并也就是说3层才创建一个自定义组件节省开销。优化前：17个dom=17个自定义组件； 优化后：17个dom=4个自定义组件蓝色那个是单节点会合并到上面的树；dom 子树作为自定义组件渲染的层级数是可以通过配置传入理论上层级越多使用自定义组件数量越少性能也就越好。一棵很大的 Dom 树一次性 setData 到视图层可能会超过 setData 的大小限制（1024kB）拆分成多棵子 Dom 树然后分批的 setData 到视图层可以节省开销。事件监听小程序的事件是视图层到逻辑层的通讯方式事件绑定在组件上当被触发时就会执行逻辑层中对应的事件处理函数。小程序的捕获冒泡是在视图层view端因此逻辑层在整个捕获冒泡流程中各个节点接收到的事件不是同一个对象小程序事件的捕获冒泡和阻止冒泡等操作必须在WXML模板中生命无法使用接口实现。为了能够让web端和小程序端的事件系统行为一致kbone除了仿造了一份Dom树外也把整个事件系统仿造了一份即在仿造Dom树上进行捕获冒泡。当自定义组件监听到用户的操作后就将事件发往仿造Dom树后续自定义组件监听到的同一个事件的冒泡就直接忽略。当触发改节点仿造Dom树接收到事件后再进行捕获和冒泡让事件在各个节点触发。Kbone的优势支持多个前端框架：Vue、React、Preact 等支持更为完整的前端框架特性： Vue 中的 v-html 指令、Vue-router 插件等提供了常用的 dom/bom 接口可以使用小程序本身的特性： live-player 内置组件、分包功能等提供一些 Dom 扩展接口：getComputedStyle 接口等Kbone实践脚手架kbone-cli官方已经提供了kbone-cli可以用来快速开发：用npm全局安装kbone-cli可以根据自己的技术栈选择不同的开发模板：React/Vue/Omi/Preact然后就可以愉快的进行开发啦~生成的demo项目结构如下：demo中包含了多页跳转、vue-router、vuex等的使用示例以及mp-webpack-plugin的配置示例。对于多页面的应用在 Web 端可以直接通过 a 标签或者 location 对象进行跳转但是在小程序中则行不通。同时 Web 端的页面 url 实现和小程序页面路由也是完全不一样的。Demo示例对比其中有一部分两端差异的业务逻辑功能也给出了3中不同的解决方案：利用vue-improve-loader在构建时对dom树节点进行删减在需要提出的节点加上check-reduce属性 利用reduce-loader将业务中不需要被打包的代码进行去除使用行内loader和环境变量来判断 使用样式隐藏即设置不需要显示的节点样式为 display:none其他问题在实际开发中还会碰到一些细节例如：多页面开发：修改webpack和mp-webpack-plugin配置小程序内置组件： 部分用html标签代替其他用wx-component + behavior标签小程序自定义组件：修改mp-webpack-plugin配置补充wxCustomComponents字段将自定义组件放入组件根目录使用自定义组件自定义app.js和app.wxss：监听app的生命周期修改webpack配置补充app.js的构建入口修改插件配置的generate.app字段补充app.js扩展dom/bom对象和API：使用 window.$$extend追加方法代码优化：用reduce-loader做体积精简dom树精简用vue-improve-loader区分环境实现不同功能：process.env.isMiniprogram更新迭代kbone由于目前在快速发展期更新迭代非常迅速以下特性是对比了8月份的版本和11月份版本可以看出已经解决了近2/3的问题。小程序技术选型详细了解了kbone之后我们来分析下小程序技术框架到底应该怎么选？kbone & 小程序原生已有web版需要小程序版：kbone跨平台需求（web + 小程序）：kbone对性能特别苛刻 or 追求稳定 or 要用最新功能：小程序原生页面节点数量特别多（ 1000 节点以上）且对渲染性能要求高：静态模板转义方案（第三方框架：mpvue/taro等）第三方框架MpVue ：不推荐再用了坑越来越多内部也表示之后不会投入太多维护WePY 1.7.x ：不推荐再用了：1.7.x 的版本在最初的设计上的缺陷导致遗留了很多比较严重的问题WePY 2.0：现在还是 alpha 阶段内外部有一些小程序在跑体验和反馈还可以。但依然 issue 比较多。害怕踩坑的也不推荐使用Taro: 也还是有不少问题但相对来说应该是比 mpVue 和 WePY 更稳定一点Uni-app：mpvue的衍生版跨端 (官方示例有6端) 支持的很好在H5端实现了一套微信模拟器可以尝试是目前唯一支持app端的商用方案有独立的编辑器HBuildXChameleon: 统一的多态协议渐进式跨端提供脚手架命令工具规划比较宏大Omi ：基于Taro完成的框架kbone有支持omi的模板Nanachi: 基于react的编译期间的转义框架总结没有跨端需求只需要微信小程序 ==> 小程序原生web端转小程序 or 两端 or 想要尝鲜 ==> kbone多端 or Vue 技术栈 ==> uni-app多端 or React 技术栈 ==> taro不介意学习新技术栈 ==> wepy 2.0 or chaemeleon写在最后小程序在非常快速的更新迭代就算是原生框架也还是有一些坑的因此没有哪种框架是百分之百完美需要根据业务具体需求以及自身技术栈偏好来进行选择。文章中提及到的部分第三方框架只是参考了官方文档没有逐个一一尝试有问题麻烦指出鞠躬~~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序不同页面的异步回调callback和promise的使用讲解               小程序Canvas性能优化实战                                                        原作者: 马倩                    来自: 微信开放社区                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序之图片瀑布流（最全实现方式，额外加送懒加载） ", "author": "                  Rolan                  2018-5-14 00:21                ", "text": "                                                                                                                                                                                     来来来看啊看外面的世界多好看效果图展示的是瀑布流布局 && 懒加载的效果数据图片数据来源张鑫旭的网络日志先说下我们的图片链接格式所有的链接都是 http://cued.xunlei.com/demos/publ/img/P_${name}.jpg 这样的格式我们需要改变name的值就行了当 name 值小于10的时候格式是 00x ,如 002 、 003 大于10的时候就是 023 这种。定义瀑布流布局是一种比较流行的页面布局方式, 最早采用此布局的网站是Pinterest, 图片宽度是固定的高度自动产生一种参差不齐的美感。原理原理很简单主要分为以下几步1、定义高度数组和列数2、遍历元素个数小于列数的直接 push 到数组中3、大于列数的获取高度数组中最小的值定义元素的top和left值4、 重要一点 更新高度数组将最小高度加上当前元素的高度知道原理了代码应该怎么写呢？这里用web端来示例大概如下let heightArr = []let col = 2let allBox = document.querySelectorAll('.box') // 获取所有盒子for(let i in allBox){\t\tlet boxWidth = allBox[0].offsetWidth  // 获取盒子宽度 都一样直接取第一个  let boxHeight = allBox[i].offsetHeight\tif(i < col){\t\t\theightArr.push(boxHeight)  // 把第一行高度都添加进去\t} else {  // 进行布局操作\t\t\t\tlet minHeight = Mac.min.apply(null, heightArr)  // 获取最小高度\t\tlet minIndex = getIndex(heightArr, minHeight)  // 获取最小高度的下标 要不就是0 要不就是1\t\tallBox[i].style.position = 'absolute'\t\tallBox[i].style.top = minHeight + 'px'\t\tallBox[i].style.width = minIndex * boxWidth + 'px'\t\t\t\theightArr[minIndex] += boxHeight // 更新最新高度 \t}}// 获取下标getIndex(arr, val){\tfor(i in arr){\t\tif(arr[i] == val) {\t\t\treturn i\t\t}\t}}上面就是实现瀑布流的主要逻辑这里大概写了下接下来我们看看小程序怎么实现。实现在web页面里面我们可以直接获取、操作DOM实现起来很方便何况还有很多的jquery插件可以使用。我们知道小程序里面是没有DOM的那应该怎么实现呢？我们把思路转换下就行了。这里我们用三种方式来实现瀑布流布局。CSS使用css3来实现是最简单的我们先捡简单的来说使用 column-count 属性设置列数使用 wx-if 进行判断将图片渲染到左侧还是右侧wxml<view class='container'>    <image src='{{item.url}}' wx:if=\"{{index % 2 != 0 }}\" wx:for=\"{{list}}\" mode='widthFix' wx:key=\"{{index}}\"></image>     <image src='{{item.url}}' wx:if=\"{{index % 2 == 0 }}\" wx:for=\"{{list}}\" mode='widthFix' wx:key=\"{{index}}\"></image> </view>wxss.container{  column-count: 2;  /*设置列数*/   column-gap:2rpx;  padding-left: 8rpx;}image{  width: 182px;  box-shadow: 2px 2px 4px rgba(0,0,0,.4);}js获取下数据即可这里就不赘述了。节点信息小程序可以通过WXML节点信息API来获取元素的信息接下来我们来撸码。wxml<view class=\"container\">\t  <view wx:for=\"{{group}}\" style='position:{{item.position}}; top: {{item.top}}; left:{{item.left}}; width:{{width}}rpx;' class='box box-{{index}}' wx:key=\"{{index}}\"> \t\t\t<image  src='http://cued.xunlei.com/demos/publ/img/P_{{item.name}}.jpg' style=' height:{{height[index]}}px' bindload='load' data-index='{{index}}' class='image'></image>\t  </view></view>wxss.container{  position: relative;  display: flow-root;}.box{  float: left;  display: flex;  margin-left:5rpx;  box-shadow: 2rpx 2rpx 5rpx rgba(0,0,0,.3);  border: 1rpx solid #ccc;  box-sizing: border-box;  padding: 10px;}.box:nth-child(2){  margin-left: 12rpx;}image{  width: 100%;}js图片链接为 http://cued.xunlei.com/demos/publ/img/P_${name}.jpg , 只需要更改name就行了首先处理我们的数据// 创建长度为30的数组const mockData = () => {  return Array.from(Array(30).keys()).map(item => {    if (item < 10) {      return '00' + item    } else {      return '0' + item    }  })}// 扩展成我们需要的数据const createGroup = () => {  let group = []  let list = mockData()  list.forEach(item => {    group.push({ name: item, position: 'static', top: '', left: '' })  })  return group}然后进行瀑布流布局主要代码如下load(e){  // 监听图片加载完 获取图片的高度    this.setData({      height: [...this.data.height, e.detail.height]    })    this.showImg()  // 调用渲染函数},showImg(){    let height = this.data.height    if (height.lenth != this.data.group .legth){  // 保证所有图片加载完      return    }    setTimeout(()=>{ // 异步执行      wx.createSelectorQuery().selectAll('.box').boundingClientRect((ret) => {        let cols = 2        var group = this.data.group        var heightArr = [];        for (var i = 0; i < ret.length; i++) {          var boxHeight = height[i]          if (i < cols) {            heightArr.push(boxHeight + 25)          } else {            var minBoxHeight = Math.min.apply(null, heightArr);            var minBoxIndex = getMinBoxIndex(minBoxHeight, heightArr);            group[i].position = 'absolute'            group[i].top = `${minBoxHeight}px`            group[i].left = minBoxIndex * this.data.width / 2 + 'px'            group[i].left = minBoxIndex == 0 ?  minBoxIndex * this.data.width / 2 + 'px' : minBoxIndex * this.data.width / 2 + 5 + 'px'            heightArr[minBoxIndex] += (boxHeight + 25)          }        }        this.setData({          group        })        wx.hideLoading()      }).exec()    }, 200)      }可以看到实现的逻辑和上面的大概类似只不过这里我们修改的是数据毕竟小程序是数据驱动的嘛。这里主要我们监听 image 组件的 bindload 事件来获取每张图片的高度获取了高度才能进行布局大部分的时间也都用来加载图片了能不能优化呢？当然可以了我们使用node把数据包装下。后端处理数据上面我们说到在小程序内部获取图片的高度是个费力不讨好的事我们使用node来获取图片高度然后包装下再给小程序使用。使用request进行请求使用image-size获取图片的高度最后将获取后将数据写入文件启动一个服务提供接口这里主要说下碰到的问题1、request模块的请求默认返回来的是个String类型的字符串使用image-size模块传入的必须是Buffer怎么破呢？在request请求中设置 encoding 为 null 即可2、我们这里爬取了100张图片怎么保证都已经爬取完了呢？可以这样写Promise.all(List.map(item => getImgData(item)))  // getImgData函数是获取图片的函数 会返回个promise3、如果请求了几次发现有的图片获取不到了报错了怎么回事呢人家毕竟做了防爬的恭喜你中奖了换个ip再试吧（可以把代码放在服务器上面或者换个Wi-Fi）其实我们只需要爬一次就行生成完文件还爬干嘛啊。完整代码请戳 github我们回到小程序此时接口返回的数据如下可以看到每个图片都有高度了接下来我们实现瀑布流布局等下我们搞下瀑布流布局的懒加载关于小程序的懒加载猛戳了解更多。怎么实现呢？主要分为两步1、将元素瀑布流布局2、创建IntersectionObserver进行懒加载先开始我们的布局吧wxml<view class='container'>  <view class='pic pic-{{index}}' wx:for=\"{{list}}\" style=\"height:{{item.height}}px;left:{{item.left}}; top:{{item.top}}; position:{{item.position}}\" wx:key=\"{{item.index}}\">    <image src='{{item.url}}' wx:if=\"{{item.show}}\"></image>    <view class='default' wx:if=\"{{!item.show}}\"></view>  </view></view>上面我们使用 wx-if 通过 show 这个字段来进行判断了图片是否加载使用一个 view 组件用来占位然后更改 show 字段就可以显示图片了js我们使用两个for循环先来进行布局let cols = 2    let list = this.data.list    let heightArr = [];    for(let i in list){      var boxHeight = list[i].height      if (i < cols) {        heightArr.push(boxHeight + 5)      } else {        var minBoxHeight = Math.min.apply(null, heightArr);        var minBoxIndex = getMinBoxIndex(minBoxHeight, heightArr);        list[i].position = 'absolute'        list[i].top = `${minBoxHeight}px`        list[i].left = minBoxIndex * 182 + 'px'        list[i].left = minBoxIndex == 0 ? minBoxIndex * 182 + 'px' : minBoxIndex * 182 + 4 + 'px'        heightArr[minBoxIndex] += (boxHeight + 5)      }    }    this.setData({      list    })布局完后创建IntersectionObserver动态判断image节点的显示for (let i in list) {      \twx.createIntersectionObserver().relativeToViewport({ bottom: 20 }).observe('.pic-' + i, (ret) => {        if (ret.intersectionRatio > 0) {          list[i].show = true        }        this.setData({          list        }) })}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)纪芬洛可                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    Serverless 打造智能微信小程序：图像识别分析文本               杨春文：小程序在直播产品中的技术应用                                                        原作者: 掘金                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序图片使用示例                                                      • 微信小程序实现图片双滑缩放大小                                                      • 开发一款图片上传+用户反馈(留言)小程序附前端+后端代码                                                      • 微信小程序瀑布流最好最简单的解决方案                                                      • 小程序之图片懒加载 完美方案你不来看看？                                                                                               "},{"title": "让人头痛的小程序之『图片懒加载』终极解决方案 ", "author": "                  天下雪                  2016-12-16 00:09                ", "text": "                                                                                                                                                                                     本文作者：小小小来自授权地址微信小程序中懒加载特效让人头疼不已因为小程序完全没法操作dom所以位置的操作在小程序中变得极其的难~~先看特效：我们将其拆分为如下几个步骤进行讲解~~1）如何获取图片的位置高度先看一张图：通过上图可以知道图片位置高度其实可以通过img.height + margin值算出。js代码：arrHight[i] = Math.floor(i/2)*(img.height + margin-bottom);为何是Math.floor(i/2)呢因为同一排两张图片高度一样比如i=0和i=1通过Math.floor得出值都为0所以可以保证同一排的两张图片位置高度是同一个值。2）替换默认图片先看效果图片：wxml代码：<image src=\"{{arr[index] ? productArr[index].Image : 'default.jpg'}}\"></image>思路很明显一开始arr[index]中都是false所以默认都是default图片但是随着往下移动有些arr[index]的值变为true所以替换默认图片js代码：for (var i = 0; i < this.data.productArr.length; i++) {  if (arrHight[i] < scrollTop) {      if (arr[i] == false) {          arr[i] = true;      }  }}思路相当清晰无需多言~~3）懒加载中渐显特效先看效果：wxss代码：.product_image{  opacity: 0;  width: 100%;  height: 70%;  transition: opacity 1s linear 2s;}.loaded{    opacity: 1;}其实就是opacity的一个过渡动画而已so easy~~项目地址：https://github.com/didiaohu/xiaoxiaoxiao/tree/master/lazyload项目下载：lazyload.zip                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)wx_vitian47                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    知晓程序：如何「掏空」小程序的五层页面限制？               微信小程序官方文档知识解读推荐新手仔细阅读                                                        原作者: xiaoxiaoxiao                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序快速掌握组件及API的方法                                                      • 使用小程序的scroll-view组件实现列表页                                                      • 微信小程序实用组件：手势解锁                                                      • 微信小程序开发：水平排列布局与滚动视图（scroll-view）                                                      • 微信小程序之『仿 QQ 消息气泡拖拽消失』                                                      • 小程序之图片懒加载 完美方案你不来看看？                                                                                               "},{"title": "微信小程序-两个input叠加，多次点击字体变粗或闪动 ", "author": "                  Rolan                  2018-5-17 00:18                ", "text": "                                                                                                                                                                                     问题描述：当两个input叠加多次点击input框 placeholder 字体变粗或input框闪动。如图：代码：<!--  最上层input-1 --><input  placeholder='请输入昵称手机号客户名称' ></input><!--  底层input-2 点击后会遮盖上层input-1 --><input  placeholder='请输入昵称手机号客户名称' ></input>效果示意图：解决办法：input-1添加 disabled=\"disabled\" input-2 的 placeholder 去掉<!--  最上层input-1 --><input  placeholder='请输入昵称手机号客户名称' disabled=\"disabled\"></input><!--  底层input-2 点击后会遮盖上层input-1 -->                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序条形倒计时动画               小程序授权逻辑如何更改为button形式                                                        原作者: Jaye118                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发问答《四十九》input空间输入文字如何清空 & 时间处理问题 ... ...                                                      • 微信小程序开发问答《六十九》radio样式不能自定义 & 多个input如何方便的获取提交 .. ...                                                      • 微信小程序input表单页面实例,redio和下拉列表获取数据                                                      • 小程序根据input输入动态设置按钮的样式                                                      • 微信小程序开发问答《八十》实现 sticky header 效果 & input标签中文字被遮盖 ...                                                      • 微信小程序修改自定义input                                                                                               "},{"title": "微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ... ", "author": "                  Rolan                  2017-6-14 00:50                ", "text": "                                                                                                                                                                                                                                                                 1、一般我们说的显示秒杀都是指的单条数据循环我没做。效果：2、wxml代码：<p><block wx:if=\"{{total_micro_second<=0}}\">剩余时间：已经截止</block>      <block wx:if=\"{{clock!='已经截止'}}\">剩余时间：{{clock}}</block>      </p>3、.js文件代码：function countdown(that) {  var EndTime = that.data.end_time || [];  var NowTime = new Date().getTime();  var total_micro_second = EndTime - NowTime || [];  console.log('剩余时间：' + total_micro_second);      // 渲染倒计时时钟      that.setData({        clock: dateformat(total_micro_second)      });      if (total_micro_second <= 0) {        that.setData({          clock: \"已经截止\"        });        //return;      }      setTimeout(function () {        total_micro_second -= 1000;        countdown(that);      }        , 1000)    }  // 时间格式化输出如11:03 25:19  每1s都会调用一次  function dateformat(micro_second) {       // 总秒数       var second = Math.floor(micro_second / 1000);       // 天数       var day = Math.floor(second/3600/24);       // 小时       var hr = Math.floor(second/3600%24);       // 分钟       var min = Math.floor(second/60%60);       // 秒       var sec = Math.floor(second%60);      return day + \"天\" + hr + \"小时\" + min + \"分钟\" + sec+\"秒\";  }Page({  /**   * 页面的初始数据   */  data: {  id:'',  result:[],  end_time:'',  clock:''  },/**   * 生命周期函数--监听页面加载   */  onLoad: function (options) {  var that = this;    wx.request({      url: 'https://m.******.com/index.php/Home/Xiaoxxf/activity_detail?a_id='+options.id,//不含富文本html      data: {},      method: 'GET', // OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, CONNECT      header: {        'Content-Type': 'application/json'      },      success: function (res) {        that.setData({          common: res.data,   //一维数组全部数据          end_time: res.data.end_time    //项目截止时间时间戳单位毫秒        })        console.log(that.data.common);        console.log('结束时间：' + that.data.end_time);      },      fail: function (res) { },      complete: function (res) { },    }),    //调用上面定义的递归函数一秒一刷新时间  countdown(that);},4、拿去用吧不懂的下面留言。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)benben1886                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序-隐藏和显示自定义的导航               微信小程序开发教程---创建第一个微信小程序                                                        原作者: PHP急先锋                   来自: 博客园                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 秀杰实战教程系列《四》：倒计时组件LXStepper组件-商品数量加减 ...                                                      • 微信小程序小工具之下发短信验证码倒计时                                                      • 微信小程序倒计时组件更新加入时间校准功能                                                      • 微信小程序电商常用倒计时                                                      • 微信小程序--动态添加分享数据、根据不同的id来进行设置和读取缓存 ...                                                      • 微信小程序+WEB使用JS实现注册【60s】倒计时功能                                                      • 章鱼小程序项目开发总结                                                      • 高考志愿导师小程序项目的开发过程全解析                                                      • 小程序根据input输入动态设置按钮的样式                                                      • 微信小程序倒计时功能                                                      • 小程序验证码倒计时                                                                                               "},{"title": "微信小程序之自定义dialog组件 ", "author": "                  Rolan                  2018-4-13 00:25                ", "text": "                                                                                                                                                                                     由于项目开发需求坑爹的小程序没有自定义dialog(类似饿了么组件那种)。于是百度了下思路开发了一个。参数：title  标题cancelText  取消文本 (默认文本为取消）confirmText  确认文本（默认文本为确定）animated  是否动画 （默认为是）modalSize  模态框大小(默认md)animationOption  动画事件(默认300s)接下来分享下实现步骤吧...主要的概念就是想把自定义的部分通过插槽来接收。1、创建好components组件且命好名字。 小tips:在微信开发工具内创建方便点它会自动帮你把相关文件配好。 创建组件且命名2、写好相关布局及样式。dialog.wxss/** 模态 **/.modal{   position: fixed;   top: 0rpx;   left: 0rpx;   right: 0rpx;   bottom: 0rpx;   width: 100%;   height: 100%;    z-index: 100;}.modal-mask{   position: absolute;   width: 100%;   height: 100%;   z-index: 97;   background-color: rgba(0,0,0,0.30);}.modal-layer-sm{    width: 60%;     transform : translate3d(-50%,-50%,0);    left : 50%; } .modal-layer-md{    width: 80%;     transform : translate3d(-50%,-50%,0);    left : 50%; } .modal-layer-full{    width: 100%;     left: 0; } .modal-layer{   position: absolute;   background: transparent;   top: 50%;    display: flex;   flex-direction: column;   z-index: 98;    box-shadow: 0 4rpx 14rpx rgba(0,0,0,.4); }.modal-header{   background: #fff;   color: #333;   padding: 20rpx;   font-size: 30rpx;   text-align: center;   border-top-left-radius: 10rpx;   border-top-right-radius: 10rpx; }.modal-body{   flex: 1;    padding: 0 40px 40rpx;   background: #ffffff;  }.modal-footer{   background: #ffffff;   flex-direction: row;   display: flex;   align-items: center;   width: 100%;    border-top : 1rpx solid #eee;      border-bottom-left-radius: 10rpx;   border-bottom-right-radius: 10rpx; }.modal-close{   color: #fff;   font-size: 48rpx;   position: absolute;   right: 40rpx;   top: 0;   z-index: 98;}.btn{  flex: 1;  text-align: center;  font-size: 30rpx; color:#666; padding: 19rpx 5rpx;}.btn:first-child{   border-right: 1px solid #eee;}.btn-primary{ color: #009887;   }dialog.wxml<view animation=\"{{animationData}}\" hidden=\"{{!isShow}}\" class='modal'><view data-type=\"mask\" catchtap='hideModal' class='modal-mask' ></view><view class='modal-layer  modal-layer-radius {{modalSize == \"sm\" ? \" modal-layer-sm\" : \" modal-layer-md\" }} ' ><!-- 头部 --><view class='modal-header'> <text>{{title}}</text> </view><!-- 内容区域 --><view class='modal-body'> <slot></slot> </view><view class='modal-footer'><text catchtap='_cancelModal' class='btn btn-default'>{{cancelText}}</text><text catchtap='_confirmModal' class='btn btn-primary'>{{confirmText}}</text> </view></view></view>dialog.js// common/component/modal.jsComponent({       /**    * 组件的属性列表    */   properties: {     title : {       type : String,       value : '这里是默认标题'     },     cancelText : {       type: String,       value: '取消'     },     confirmText : {       type: String,       value: '确定'     },     backdrop: {       type: Boolean,       value: true     },     animated : {       type: Boolean,       value: true     },     //模态框大小(sm md)     modalSize : {       type: String,       value: \"md\"     },     //动画时间(默认300)     animationOption : {       type : Object,       value  : {         duration : 300        }     },   },   /**    * 组件的初始数据    */   data: {     isShow:false,     animation : ''   },   ready: function () {         this.animation = wx.createAnimation({         duration: this.data.animationOption.duration,         timingFunction: \"linear\",         delay: 0     });    },   /**    * 组件的方法列表    */   methods: {     //modal隐藏     hideModal : function(e){         if(e){         let type = e.currentTarget.dataset.type;         if (type == 'mask' && !this.data.backdrop) {           return;         }          }                       if (this.data.isShow) this._toggleModal();     },     //modal显示     showModal: function(){       if (!this.data.isShow) {         this._toggleModal();                }     },     //切换modal的显示还是隐藏     _toggleModal:function(){             if(!this.data.animated){           this.setData({             isShow: !this.data.isShow           })       }       else{         let isShow = !this.data.isShow;         this._executeAnimation(isShow);       }     },     //根据需求执行动画     _executeAnimation: function (isShow) {         let animation = this.animation;         if (isShow) {           animation.opacity(0).step();           this.setData({             animationData: animation.export(),             isShow: true           })           setTimeout(function () {             animation.opacity(1).step()             this.setData({               animationData: animation.export()             })           }.bind(this), 50)         }         else {           animation.opacity(0).step()           this.setData({             animationData: animation.export()           })           setTimeout(function () {             this.setData({               isShow: isShow             })           }.bind(this), this.data.animationOption.duration)         }       },       //取消事件 向外部page 发送事件通知       _cancelModal : function(){               this.hideModal();              this.triggerEvent(\"cancelEvent\");       },       //确认事件       _confirmModal : function(){              this.triggerEvent(\"confirmEvent\");       }   } })核心都在这叻~注释都有哦。 分析下怎么做到自定义弹层吧。slot图通过slot图所示从图中可以知道通过slot插槽来接受modal-body里头自定义的代码。因为这里只需要一个插槽,所以插槽的名字可以省略会自动配上。如果是需要多个slot的话记得为插槽加上name=\"xxx\"属性命名哦对应的视图块通过 slot=\"xxx\"接受对应的插槽数据。引用组件须知js部分 需用在页面渲染的时候获取组件 onReady: function () {this.Modal = this.selectComponent(\"#modal\");},取消按钮以及确定按钮的回调事件_cancelEvent : function(){   console.log(\"点击取消!\");}_confirmEventFirst : function(){   console.log(\"点击确定了!\"); this.Modal.hideModal(); }控制modal显示和隐藏this.Modal.showModal();//显示this.Modal.hideModal(); //隐藏好了展示下效果呗~效果图.png 对了。标题这块以及按钮块都可以根据自己的需求再做调整哦。 样式也可以调整。附git地址https://github.com/jerryli519/dialogComponent。 路过的小伙伴给下star哦~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (3)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)w峰46cloudrootw莫过于此93                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序验证码倒计时               微信小程序请求API接口PHPSESSID变化的解决方式                                                        原作者: Benny_lzb                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 - dialog                                                                                               "},{"title": "如何实现微信小程序图像剪切？代码拿去用，不谢！ ", "author": "                  Rolan                  2019-11-1 00:33                ", "text": "                                                                                                                                                                                     我在早先发布的文章 《如何实现微信小程序换头像？三步帮你搞定！》 中提到实现微信小程序换头像需要三步：获取用户头像图片模板图片合成前文已经就获取用户头像和图片模板两个步骤进行了讲解本文就来详细说说如何合成图片。图片合成的过程中非常重要的一块功能对图片进行剪切。该功能点很固定大都是对图片进行拖拽、缩放后在一定区域内剪切出一个固定长宽的图片。这类功能在app端和H5中都有很多成熟的插件供使用接下来就来看看我在海豚趣图小程序中的头像剪切插件是如何实现的欢迎大家提意见。为了更好地理解接下来的代码建议大家先扫描体验一下图片裁剪效果。实现效果界面实现在H5中要实现图片的拖拽和缩放需要一大坨代码具体实现网上有很多。小程序实现就简单的多了通过 <movable-area> 和 <movable-view> 就可以实现上述功能<view class=\"clip-view\">  <!--    clipHeight、clipWidth 分别为剪切框的高和宽    imgHeight、imgWidth 分别对应图片的初始高和宽    imgUrl 为剪切图片的url地址  -->  <movable-area class=\"moveare\" style=\"height: {{clipHeight}}rpx; width: {{clipWidth}}rpx; \">    <movable-view scale=\"true\" scale-min=\"{{1}}\" damping=\"1000\" style=\"height: {{imgHeight}}px; width: {{imgWidth}}px; \" direction=\"all\" x=\"{{x}}\" y=\"{{y}}\" bindchange=\"_onChange\" bindscale=\"_onScale\">      <image class=\"clip-img\" src=\"{{imgUrl}}\" />    </movable-view>  </movable-area>  <!--剪切框 装饰用-->  <view class=\"clip-box\" style=\"height: {{clipHeight}}rpx; width: {{clipWidth}}rpx; \">    <!--剪切框四个角-->    <view class=\"clip-border clip-border-lt\"></view>    <view class=\"clip-border clip-border-rt\"></view>    <view class=\"clip-border clip-border-lb\"></view>    <view class=\"clip-border clip-border-rb\"></view>  </view>  <!--剪切图片用的canvas-->  <canvas class=\"clip-canvas\" id=\"img_clip_canvas\" canvas-id=\"img_clip_canvas\" style=\"height: {{clipHeight}}rpx; width: {{clipWidth}}rpx; \"></canvas></view>复制代码组件属性组件的入参只需要原始图片的地址和图片剪切框的宽高/** * 组件的属性列表 */properties: {  // 原始图片路径（要剪切的图片）  imgUrl: {    type: String,    value: ''  },  // 剪切的宽度 (rpx)  clipWidth: {    type: Number,    value: 500  },  // 截切的高度 (rpx)  clipHeight: {    type: Number,    value: 500  }}复制代码组件data组件的data就会多一些记录图片拖拽缩放的数据需要注意的是图片初始位置和图片拖拽位置没有使用同一变量存储是为了防止在拖拽过程中产生抖动。/** * 组件的初始数据 */data: {  baseScale: 1,  imgPath: '',  imgWidth: 0, // 图片宽  imgHeight: 0, // 图片高  x: 0, // 图片初始时x轴位置  y: 0, // 图片初始时y轴位置之所以不和top共用一个变量是因为如果频繁改变y值图片会闪烁x同理  left: 0, // 图片拖拽后的x轴位置  top: 0, // 图片拖拽后的y轴位置  scale: 1 // 拖拽后的缩放比例}复制代码组件初始化组件的初始化方法用于把图片缩放到合适的大小并使剪切框位于图片中央/** * 初始化方法 * 获取图片宽高后把图片缩放至剪切框大小 * 并使剪切框位于图片中央 **/_init() {  if (!this.data.imgUrl) return  // 获取屏幕宽度  let {    screenWidth  } = wx.getSystemInfoSync()  // 计算屏幕rpx  const rpx = screenWidth / 750  // 获取图片宽高然后缩放至剪切框大小  wx.getImageInfo({    src: this.data.imgUrl,    success: ({      width,      height,      path    }) => {      const cw = this.data.clipWidth * rpx      const ch = this.data.clipHeight * rpx      let scale = Math.max(cw / width, ch / height)      const imgWidth = width * scale      const imgHeight = height * scale      this.setData({        imgPath: path,        imgWidth,        imgHeight,        baseScale: scale,        x: (cw - imgWidth) / 2,        y: (ch - imgHeight) / 2      })    }  })}复制代码图片拖拽缩放处理完成初始化后就可以监听用户的拖拽和缩放操作了主要是记录拖拽的位置和缩放的比例具体到代码实现就是监听 <movable-view> 的拖拽( bindchange )和缩放( bindscale )事件// 拖拽事件响应函数  _onChange: function(e) {    this.setData({      x: e.detail.x,      y: e.detail.y    })  }  // 缩放事件响应函数  _onScale: function(e) {    this.setData({      x: e.detail.x,      y: e.detail.y,      scale: e.detail.scale    })  }复制代码图片剪切实现拖拽缩放完成后就是剪切了,剪切是利用了 <canvas> 重新绘制图片的剪切区域保存到微信临时目录里并返回保存路径。需要注意的是拖拽和缩放后记录的图片剪切位置并不是原图的位置利用 canvas 的 drawImage 进行绘制的时候需要转换成原图位置或者先把 canvas 的坐标系进行缩放。 注意：在自定义组件下调用 wx.createCanvasContext(string canvasId, Object this) 方法时第二个参数this不能省略否则canvas绘制无响应/**  * 图片剪切入口方法  */clip() {  const scale = this.data._scale * this.data._baseScale  const canvasId = 'img_clip_canvas'  imageClip(canvasId, this.data.imgPath, {    x: this.data._left * -1,    y: this.data._top * -1,    scale,    width: this.data.clipWidth,    height: this.data.clipHeight  }, this)}/** * 图片剪切 * * @param canvas canvas组件id用于绘制剪切图片 * @param img 要剪切的图片 * @param option 剪切的位置宽高等信息 * @param option.left 剪切图片左边距 * @param option.top 剪切图片上边距 * @param option.width 剪切图片宽度 * @param option.height 剪切图片高度 * @param context 组件实例对象 *  * @return new Promise(resolve=>ctx) */imageClip(canvas, img, option, context) {  return new Promise((resolve, reject) => {    option = Object.assign({      left: 0,      top: 0,      scale: 1,      width: 0,      height: 0    }, option)    let x = option.left / option.scale    let y = option.top / option.scale    let clipW = option.width / option.scale    let clipH = option.height / option.scale    const ctx = wx.createCanvasContext(canvas, context)    ctx.drawImage(img,      x,      y,      clipW,      clipH,      0,      0,      option.width,      option.height)    ctx.draw(false, (e) => {      console.log(e)      resolve()    })  })},/** * canvas 保存为临时文件 */function saveCanvasToTemp(canvas, option) {  return new Promise((resolve, reject)=>{    wx.canvasToTempFilePath({      ...option,      canvasId: canvas,      success:resolve,      fail:reject    }, this)  })}复制代码写在最后这就是小程序版图片剪切的主要代码实现里面还有一些小点儿需要注意<movable-view>wx.createCanvasContext(string canvasId, Object this)关于我们快狗打车前端团队专注前端技术分享定期推送高质量文章欢迎关注点赞。 文章同步发布在公众号哟想要第一时间得到最新的资讯just scan it ！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序识别身份证银行卡营业执照驾照               微信小程序工程化之持续集成方案                                                        原作者:  快狗打车前端团队                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序之动态获取元素宽高 ", "author": "                  Rolan                  2018-9-10 00:49                ", "text": "                                                                                                                                                                                     我以前一直以为微信小程序不能动态获取view元素的宽高。但是自从看到： wx.createSelectorQuery() 这个api接口以前的某些问题就能得到解决了。。。那么这个api接口怎么用呢？首先这个接口会返回一个对象实例。var obj=wx.createSelectorQuery(); 下面的就是返回的对象实例 obj 的所有内容。返回的 obj 有五个方法：obj.in(component)：没用过这个方法多用于组件的选择器。obj.select(selector)：获取指定的节点selector是css选择器。返回一个 NodesRef 对象实例可以用于获取节点信息。obj.selectAll(selector)：获取指定的节点selector是css选择器。返回一个 NodesRef 对象实例可以用于获取节点信息。上面这两个我感觉就是 js 中querySelector和querySelectorAll的区别。obj.selectViewport()：我没用过这个方法。官方说是选择显示区域可用于获取显示区域的尺寸、滚动位置等信息。也是返回一个 NodesRef 对象实例可以用于获取节点信息。exec( function(res){} )：执行所有的请求请求结果按请求次序构成数组在callback的第一个参数中返回上面返回的 NodesRef 对象实例就很重要了它有三个方法：boundingClientRect( function(rect){} )：就是这个方法能够动态获取view元素的高度、宽度等属性。还有其它的请看官方文档scrollOffset( function(res) {}）：获取节点的水平、垂直滚动的位置等。节点必须是scroll-view或者viewportfields(fields,function(){res} )：这个可以获取指定元素的自定义属性和class名具体的请看官方文档的说明。废话了这么多真正的实例用法：wx.createSelectorQuery().selectAll('.npl-intro').boundingClientRect(function (rect) {    console.log(rect[0].height)    console.log(rect[0].width)}).exec()  如果觉得这样写有点长。可以分步写。也是一样的结果。var obj=wx.createSelectorQuery();obj.selectAll('.npl-intro').boundingClientRect(function (rect) {    console.log(rect[0].height)    console.log(rect[0].width)})obj.exec() ;当然这方法可以写在onLoad、onReady、onShow等这些生命周期的方法也可以写在自定义的方法里。什么时候需要什么时候就调用。 官方 wx.createSelectorQuery() 接口                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序多业务线融合【完整分包业务接入】               golang+json-iterator（微信小程序推送通知实例）                                                        原作者: 站住别跑                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 从无到有开发一款产品（小程序）的过程与思考                                                                                               "},{"title": "小程序多业务线融合【完整分包业务接入】 ", "author": "                  Rolan                  2018-9-10 00:19                ", "text": "                                                                                                                                                                                     应用场景同一个主体（公司、部门）下有多个小程序这些小程序由一个主小程序和后来新建的多条业务线构成（每条业务线拥有独立的小程序）各业务线的小程序需要挂载到主程序下面因为需要主程序导流同时各业务线自己的小程序也照常发布更新==一套代码通过打包命令来生成独立包和分包==（分包生成完需要拷贝到主程序的subPages目录下）项目概述我的这条业务线叫欢乐送（项目名为enjoy_given）是转转旗下一个免费的以物换物平台因为我们这条业务线小程序是用mpvue构建的（整个项目也是通过mpvue的cli生成的）所以后面相关配置都是以mpvue为例如果是wepy项目基本也大同小异。下面就是我们的目录结构src目录下的几个js文件需要专门介绍下：src/App.vue 是小程序的入口文件里面定义的是小程序的生命周期src/main.js 里面初始化通用业务、定义小程序页面路径和全局变量src/vars.js 存放整个项目的全局变量src/baseInstall.js 基础方法装配逻辑（如：给vue对象挂载登录、统计逻辑、识别渠道号等）分包配置概述首先要配置source和appid作为分包时这两个参数都要统一采用主包参数（建议通过webpack配置来实现）source：是每条业务线登录、注册、和接口访问时用的标识用来区分该用户来自于哪条业务线appid：微信分配的小程序appid为什么要配置这两参数：因为不配置没法登录页面路径问题作为分包时所有页面的跳转路径都要加主包的跳转前缀（建议通过包装跳转方法navigateTo、redirectTo、reLaunch、navigateBack实现建议配合webpack统一处理）当新业务线作为分包接入主程序时页面跳转路径前需要统一加一个前缀如：独立小程序首页路径为 /pages/content/index/main作为分包时主程序分配的包为/subPages/enjoy_given那么分包业务线首页路径为: /subPages/enjoy_given/pages/content/index/mainwxss引用路径问题不要用使根目录引入方式（建议采用webpack或者shell脚本来完成）因为在分包状态下用根目录访问方式会直接访问主程序的根目录文件是不存在的图片路径问题所有图片路径统一采用cdn资源访问方式不要引用本地图片对于分包的main.js和App.vue入口文件不执行的问题可以通过抽离基础业务装配方法对于每一个从主包跳到分包页面的入口分别引入后面会细说对于小程序内的h5页面拉起小程序页面在打开webview时候要加入一个标志位或者prefix告诉h5页面当前处于分包当中打开的小程序path要加前缀分享路径问题在路径前面也要加入路径前缀可以通过一个通用的分享方法进行统一处理后面会细说小程序的所有页面都需要在主包入口文件（app.vue）注册每新增页面都要注册这个是坑尤其新增页面时会很容易忽略这个问题这里要特别强调下分包接入需要注意的地方storage命名问题为了避免和主程序或者其他业务线小程序发生冲突（建议采用 zz_业务名_xxx, 我们业务名是enjoy_given简称eg如： zz_eg_address zz指的就是转转）登录问题推荐和主程序使用同样的cookie名称这样可以通用一套用户信息免得双方各维护一套还能避免重复授权。支付问题保证下单时和支付时cookie中的参数保持一致调试可以找主程序那边要个主程序的测试包把生成的代码(dist目录下的内容)拷贝到主程序包的 subPages/业务名/ 下面例如我们的目录是 subPages/enjoy_given/（目录结构同上）一套代码通过不同打包命令生成对应的程序包（独立包和分包）package.json中scripts\"scripts\": {    \"dev\": \"node build/dev-server.js\",    \"start\": \"node build/dev-server.js\",    \"build\": \"rimraf dist && node build/build.js\",    \"lint\": \"eslint --ext .js,.vue src\",    \"build_subPkg\": \"node build/build-subpkg.js && sh ./scripts/path-replace.sh\"}独立小程序(调试) npm run dev独立小程序(构建) npm run build主程序分包(构建) npm run build_subPkg为什么没有主程序分包（测试）因为我们无论是构建测试分包还是构建正式分包都要把生成dist下的代码拷贝到主程序的subPages/enjoy_given/目录下成本基本是一样的所以就没有写构件分包的命令分包webpack配置因为需要兼容独立小程序和分包业务webpack我们建议分开配置我们对测试环境和正式环境分别配置了webpack通过对webpack配置替换全局变量直接修改项目的全局参数。通过npm命令动态执行替换。为了分开配置我们拷贝了一份build.js更名为build-subpkg.js\"scripts\": {    ...,    \"build_subPkg\": \"node build/build-subpkg.js && sh ./scripts/path-replace.sh\"}build_subPkg命令就是读取的build-subpkg.js文件build.js和build-subpkg.js中99%的内容都一样只有一行不一样var webpackConfig = require('./webpack.prod.conf')变更为var webpackConfig = require('./webpack.subpkg.prod.conf')所以下一步就是创建webpack.subpkg.prod.conf文件webpack.subpkg.prod.conf由webpack.prod.conf拷贝而来里面依旧99%的内容一致// webpack.prod.conf...var config = require('../config')var env = config.build.env...var webpackConfig = merge(baseWebpackConfig, {    ...    plugins: [        new webpack.DefinePlugin({            'process.env': env,            'app.source': env.APP_SOURCE,            'app.udeskDebug': env.UDESK_DEBUG,            'app.id': env.APP_ID,            'app.pathPrefix': env.APP_PATH_RREFIX,            'app.isUseCrazyFormId': env.IS_USE_CRAZY_FORMD_ID        }),        ...    ]})// webpack.subpkg.prod.conf...var config = require('../config')var env = config.build.env...var webpackConfig = merge(baseWebpackConfig, {    ...    plugins: [        new webpack.DefinePlugin({            'process.env': env,            'app.source': env.APP_SUB_PKG_SOURCE,            'app.udeskDebug': env.UDESK_DEBUG,            'app.id': env.APP_SUB_PKG_ID,            'app.pathPrefix': env.APP_SUB_PKG_PATH_RREFIX,            'app.isUseCrazyFormId': env.IS_USE_CRAZY_FORMD_ID        }),        ...    ]})DefinePlugin插件是用来进行全局替换的如：’process.env’: ‘“hahaha”‘, 指的就是全局process.env替换为”hahaha”里面通过定义多个全局变量实现打包时通过不同的命令替换对应环境下的全局变量我们看一下../config/index.js中的文件var path = require('path')module.exports = {  build: {    env: require('./prod.env'),    ...  },  dev: {    env: require('./dev.env'),    ...  }}引入了dev.env.js和prod.env.js以prod.env.js为例module.exports = {  // 环境  NODE_ENV: '\"production\"',  // 欢乐送独立小程序source  APP_SOURCE: '114',  // 欢乐送分包小程序source  APP_SUB_PKG_SOURCE: '103',  // 欢乐送独立程序appid  APP_ID: '\"wxaaaaaaaaaaaaaaa\"',  // 欢乐送分包程序appid  APP_SUB_PKG_ID: '\"wxbbbbbbbbbbbbbbbb\"',  // udesk测试标志位  UDESK_DEBUG: false,  // 欢乐送独立小程序页面路径前缀  APP_PATH_RREFIX: '\"\"',  // 欢乐送分包小程序页面路径前缀  APP_SUB_PKG_PATH_RREFIX: '\"/subPages/enjoy_given\"',  // 是否启用crazyFormId  IS_USE_CRAZY_FORMD_ID: true}然后我们再来看一下存放全局变量的文件src/vars.js（上面项目截图中有）// 小程序常量export default {  ...  // 小程序版本号  version: '1.3.5',  // 小程序appid  appId: app.id,  // 小程序source（由webpack根据不同环境统一替换）  source: app.source,  // 路径前缀  pathPrefix: app.pathPrefix,  // 是否启用CrazyFormId  isUseCrazyFormId: app.isUseCrazyFormId}var webpackConfig = merge(baseWebpackConfig, {    ...    plugins: [        new webpack.DefinePlugin({            'process.env': env,            'app.source': env.APP_SUB_PKG_SOURCE,            'app.udeskDebug': env.UDESK_DEBUG,            'app.id': env.APP_SUB_PKG_ID,            'app.pathPrefix': env.APP_SUB_PKG_PATH_RREFIX,            'app.isUseCrazyFormId': env.IS_USE_CRAZY_FORMD_ID        }),        ...    ]})在打包完成后全局变量文件中的”app.xxx”会被webpack中的同名变量替换掉如vars.js中 appId: app.id的app.id会被替换独立小程序时该值为”wxaaaaaaaaaaaaaaa”作为分包业务时该值为”wxbbbbbbbbbbbbbb”这样整个替换全局变量的流程就跑完了==作为分包接入主程序中自己的main.js和App.vue都不会执行==这个是大坑因为很多通用业务的初始化如登录、cookie、统计都是在这里完成的。解决方案把基础功能的装配业务（如在录、统计、识别渠道号等逻辑）从main.js中抽离到另一个文件我这里叫baseInstall.js。里面我还加入了对query的处理比如渠道号channel和微信入口scene。那这样的话src/main.js就会变得非常简单,import Vue from 'vue'import App from './App'import baseInstall from './baseInstall'App.mpType = 'app'baseInstall.init()  // ！！！最关键就是这行代码！！！const app = new Vue(App)app.$mount()export default {  config: {    pages: [      '^pages/content/index/main',            // 首页      ...    ],    window: {      ...    }  }}里面最关键的是baseInstall.init()这行代码下面我们来看看baseInstall.js// 通用业务装配初始化...async function init (opts) {  let options = opts  ...  // 获取指定渠道号  const channel = options.channel || options.c || ''  // 设置渠道号  if (channel) {    VARS.channel = channel.indexOf('waeg_') === 0 ? channel : ('waeg_' + channel)  }  ...  if (!VARS.baseInstallFlag) {    // 为了避免重复装备通过标志位进行区分    VARS.baseInstallFlag = true    ...    // 登录配置    ZZLogin.config({      source: VARS.source    })    ZZLogin.install()    Navigator.install()    // 统计    LeStatic.config({      appid: VARS.source,      pageTypePrefix (currentRoute) {        return 'waeg_'      }    }).install()    ...  }  // 写入cookie  cookie.set({    channelid: VARS.channel,    fromShareUid: VARS.shareUid  })  return options}export default {  init}为什么要用VARS.baseInstallFlag标志位因为在分包时候是不执行main.js的实际场景会从主包的业务直接跳转到分包的一些页面。由于没有固定入口所以在这些页面中都要加入baseInstall.js的引入为了避免重复装配才会设置这个标志位。为什么要把这些业务抽离baseInstall.init里面涵盖了所有启动小程序时需要初始化的业务前面也提到了在作为分包时自己的App.vue和main.js是不会执行的。那怎么办这样就在所有的页面中在onLoad的生命周期中加入baseInstall.init方法。,所以我们抽离肯定是为了更方便的复用了。以首页为例（pages/content/index/index.vue）import baseInstall from '@/baseInstall'export default {    ...    async onLoad (options) {        options = await baseInstall.init(options)        ...    }}用async/await是因为baseInstall.init中部分逻辑用到了异步请求因为主程序不会读取main.js所以所有的分包页面路径都要统一在主程序中注册注：每新增一个页面都要在主程序中注册。也就是新增一个页面就要通知主程序那边在他们的文件里统一注册页面路径在分包中所有页面路径访问要加入前缀如：原来访问/pages/content/index/main就可以了但是分包的访问路径为：/subPages/enjoy_given/pages/content/index/main解决方案：以包装的navigateTo为例async navigateTo (route) {    route.url = VARS.pathPrefix + (route.url.indexOf('/') === 0 ? '' : '/') + route.url // 这里做前缀处理    console.log('[Navigator] navigateTo:', route)    ...    wx.navigateTo(route)}这里面需不需要加前缀都是由全局变量VARS中的pathPrefix来决定而pathPrefix是在打包过程中由webpack根据打包命令动态替换的图片访问路径问题图片访问路径统一采用cdn的资源访问路径不要用本地访问路径要不然在分包路径中是有问题的同时也会增加程序包的体积wxss路径问题用mpvue生成的wxss文件,里面会把通用的vendor.wxss引入但是引入路径是根路径作为分包直接引入根路径会去访问主包的路径导致文件无法找到。@import \"/static/css/vendor.wxss\"; //在分包中用根路径是无法找到文件的._button,._input[type=button],._input[type=reset],._input[type=submit],._textarea{-webkit-appearance:none}._button:after{border:none}page{background-color:#fff}...解决方案通过shell脚本对文件进行批量替换scripts/path-replace.sh#!/bin/shsed -i \"_bak\" \"s/\\/static\\/css\\/vendor\\.wxss/\\/subPages\\/enjoy_given\\/static\\/css\\/vendor\\.wxss/g\" `grep \"\\/static\\/css\\/vendor\\.wxss\" -rl ./dist/static/css/pages/**/*.wxss ./dist/static/css/pages/*/*/*.wxss`这段shell脚本的目的就是把./dist/static/css/pages/下所有的wxss文件中的/static/css/vendor.wxss替换成/subPages/huanlesong/static/css\\vendor.wxss替换完成后路径变更ok生成正式包的时候用npm run build_subPkg就ok了分享路径问题主程序和独立小程序分享出来的路径也是一样的处理方式和跳转类似。解决方案建议通过通用方法统一处理我们的做法是在页面的onShareAppMessage中加入通用方法Share.getFinalShareInfo以首页分享为例import Share from '@/lib/share'export default {    ...    onShareAppMessage () {        ...        return Share.getFinalShareInfo({            title: 'xxx',            path: `/pages/content/index/main`,            imageUrl: 'xxxx'        })    }}分享时统一调用Share.getFinalShareInfo方法我们再来看下share.jsexport default class Share {    static getFinalShareInfo (shareInfo) {        ...        // 路径前缀处理        shareInfo.path = VARS.pathPrefix + (shareInfo.path.indexOf('/') === 0 ? '' : '/') + shareInfo.path        ...        return shareInfo    }}这样整个分包业务就配置完成了。是不是很麻烦~当初和主程序融合时候确实踩了很多坑这里我把解决方案和大家分享下如果有更好的解决方案也希望一起交流：）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    Mpvue中无缝接入Vant Weapp组件库               微信小程序之动态获取元素宽高                                                        原作者: 陈龙                   来自: 公众号大转转FE                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序分包加载实战                                                      • 转转：微信小程序分包加载实战                                                      • 从无到有开发一款产品（小程序）的过程与思考                                                                                               "},{"title": "微信小程序倒计时功能 ", "author": "                  Rolan                  2017-11-13 00:14                ", "text": "                                                                                                                                                                                     倒计时功能是一个比较常见的功能比如用户获取验证码就需要用到。这里记录一下在微信小程序里面倒计时功能的简单实现直接看看代码吧//倒计时60秒function countDown(that,count) {  if (count == 0) {    that.setData({      timeCountDownTop: '获取验证码',      counting:false    })    return;  }  that.setData({    counting:true,    timeCountDownTop: count + '秒后重新获取',  })  setTimeout(function(){    count--;    countDown(that, count);  }, 1000);}在需要倒计时的地方调用Page({    data:{        counting:false    },    //生成验证码    generateVerifyCode:function() {        var that = this;        if (!that.data.counting) {          wx.showToast({            title: '验证码已发送',          })          //开始倒计时60秒          countDown(that, 60);        }     },})下面简单介绍下功能的实现首先倒计时的方法是写在Page的外面这个别搞错了 实现倒计时关键的地方在于setTimeout方法也即下面这段代码。setTimeout方法可以设置在指定的时间间隔执行某个函数。应用的格式是setTimeout(function(),time),function就是对应要执行的方法time就是时间间隔这里的1000表示1000毫秒也就是间隔1秒执行一次countDown方法。setTimeout(function(){    count--;    countDown(that, count);  }, 1000);countDown方法中利用count字段来设置倒计时的时间比如这里是60秒 countDown方法中把that也传递进去是为了在倒计时状态改变时利用setData方法更新页面 countDown方法中利用counting字段来判断是否已经在倒计时了避免重复开始倒计时倒计时结束是通过count来判断通过return直接退出 以上就是微信小程序里面倒计时功能的简单实现啦希望对大家有用！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序内嵌网页web-view开发教程               微信小程序 - 设计方案                                                        原作者: xxq2dream                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序小工具之下发短信验证码倒计时                                                      • 微信小程序倒计时组件更新加入时间校准功能                                                      • 微信小程序电商常用倒计时                                                      • 微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...                                                      • 微信小程序+WEB使用JS实现注册【60s】倒计时功能                                                      • 微信小程序开发--倒计时60s获取验证码                                                      • 小程序验证码倒计时                                                      • 小程序条形倒计时动画                                                                                               "},{"title": "微信小程序+WEB使用JS实现注册【60s】倒计时功能 ", "author": "                  Rolan                  2017-7-1 00:19                ", "text": "                                                                                                                                                                                     1、效果图：  2、页面仅仅利用了JS的相关功能包含：wxml、js、wxss 2.1wxml页面代码：<text>绑定手机</text><form bindsubmit=\"bindMobile\"><view class=\"form_group\">        <text>手  机：</text>        <input type=\"number\" placeholder=\"请输入手机号\" maxlength=\"11\" name=\"data_phone\" value=\"\" auto-focus=\"true\" bindblur=\"blur_mobile\" />        <button type=\"button\" class=\"{{is_show?'show':'hide'}}\" bindtap=\"clickVerify\">获取验证码</button>        <button type=\"button\" class=\"{{is_show?'hide':'show'}}\">重新发送{{last_time}}秒</button>    </view><input type=\"number\" placeholder=\"请输入验证码\" maxlength=\"6\" name=\"data_verify\" value=\"\"/><button class=\"save_btn\" form-type=\"submit\">确认绑定</button></form> 2.2 js页面代码：var countdown = 60;var settime = function (that) {  if (countdown == 0) {    that.setData({      is_show: true    })    countdown = 60;    return;  } else {    that.setData({      is_show:false,      last_time:countdown    })    countdown--;  }  setTimeout(function () {    settime(that)  }    , 1000)}Page({  /**   * 页面的初始数据   */  data: {    last_time:'',    is_show:true  },  clickVerify:function(){    var that = this; // 将获取验证码按钮隐藏60s60s后再次显示      that.setData({        is_show: (!that.data.is_show)   //false      })      settime(that);  }}) 2.3 wxss页面代码：/* 发送验证码按钮隐藏并展示倒数60s提示 */.hide{ display: none;}.show{ display: block;} 3、上面讲的是微信小程序的那么我们一般web端或者移动端的应该是什么样呢？其实方法都差不多这里也贴出来仅供大家参考<!-- 这段代码(html)是从脚本之家挪过来的信誉度应该是很高的大家可以放心使用 --><script src=\"http://libs.baidu.com/jquery/1.10.2/jquery.min.js\"></script><script type=\"text/javascript\"> var countdown=60; function settime(obj) { if (countdown == 0) { obj.removeAttribute(\"disabled\"); obj.value=\"免费获取验证码\"; countdown = 60; return;} else { obj.setAttribute(\"disabled\", true); obj.value=\"重新发送(\" + countdown + \")\"; countdown--; } setTimeout(function() { settime(obj) },1000) }</script><body> <input type=\"button\" id=\"btn\" value=\"免费获取验证码\" onclick=\"settime(this)\" /> </body></html>                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                   微信小程序 LeanCloud(二)命令行工具使用                                                        原作者: PHP急先锋                   来自: 博客园                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 秀杰实战教程系列《四》：倒计时组件LXStepper组件-商品数量加减 ...                                                      • 微信小程序小工具之下发短信验证码倒计时                                                      • 微信小程序电商常用倒计时                                                      • 微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...                                                      • 微信小程序倒计时功能                                                      • 小程序验证码倒计时                                                                                               "},{"title": "iPad 支持使用小程序，分包加载等能力升级 ", "author": "                  Rolan                  2018-9-12 00:02                ", "text": "                                                                                                                                                                                     “ iPad 支持打开小程序开发者可对小程序进行大屏幕适配。小程序分包加载功能升级允许分包独立运行。地图组件新增个性化底图样式。模板消息下发流程简化。”01—iPad 支持使用小程序微信 iOS 6.7.2 起已支持 iPad 使用小程序和小游戏。用户登录 iPad 微信后可通过小程序的各个入口打开小程序和小游戏。开发者可对小程序进行大屏幕的适配并根据业务的实际情况决定是否支持用户转动屏幕。详见《小程序开发文档》02—分包加载能力升级 为了提升小程序页面的启动速度在原分包加载能力的基础上小程序新增分包独立加载功能允许分包独立于主包与其他分包运行并支持预下载。详见《独立分包》《分包预下载》03—个性化地图 为丰富小程序地图服务的使用场景小程序地图组件新增个性化底图样式小程序示例。开发者可通过开通腾讯位置服务更换小程序地图样式。详见《小程序开发文档》04—简化模板消息下发流程 为了简化模板消息的下发流程开发者现只需调用一次接口就能下发小程序或公众号的模板消息。详见《小程序开发文档》更多新能力及详情可查看《更新日志》                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从无到有开发一款产品（小程序）的过程与思考               小程序分享及用户信息授权等接口能力的调整通知                                                        原作者: 微信公众平台                   来自: 微信公众平台                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 「小程序·云开发」开放                                                                                               "},{"title": "小程序时间轴组件 ", "author": "                  Rolan                  2018-9-10 00:06                ", "text": "                                                                                                                                                                                                                                                                 预览timeline.gif场景用于快递节点跟踪、发展历程等要点1.position作布局 2.border-radius画圆点 3.moment格式化时间区分当日(HH:mm)与前日的格式(YYYY-MM-DD HH:mm)wxml<view class=\"listview-container\">  <block wx:for=\"{{newsList}}\" wx:key=\"\">    <view class=\"playlog-item\" bindtap=\"itemTapped\">      <view class=\"dotline\">        <!-- 竖线 -->        <view class=\"line\"></view>        <!-- 圆点 -->        <view class=\"dot\"></view>        <!-- 时间戳 -->      </view>      <view class=\"content\">        <text class=\"course\">{{item.time}}</text>        <text class=\"chapter\">{{item.content}}</text>      </view>    </view>    <ad unit-id=\"adunit-5abb45645905fc90\" wx:if=\"{{index % 5 == 4}}\"></ad>  </block></view>wxss/*时间轴*//*外部容器*/.listview-container {  margin: 10rpx 10rpx;}/*行样式*/.playlog-item {  display: flex;}/*时间轴*/.playlog-item .dotline {  width: 35px;  position: relative;}/*竖线*/.playlog-item .dotline .line {  width: 1px;  height: 100%;  background: #ccc;  position: absolute;  top: 0;  left: 15px;}/*圆点*/.playlog-item .dotline .dot {  width: 11px;  height: 11px;  background: #30ac63;  position: absolute;  top: 10px;  left: 10px;  border-radius: 50%;}/*时间戳*/.playlog-item .dotline .time {  width: 100%;  position: absolute;  margin-top: 30px;  z-index: 99;  font-size: 12px;  color: #777;  text-align: center;}/*右侧主体内容*/.playlog-item .content {  width: 100%;  display: flex;  flex-direction: column;  border-bottom: 1px solid #ddd;  margin: 3px 0;}/*章节部分*/.playlog-item .content .chapter {  font-size: 30rpx;  line-height: 68rpx;  color: #444;  white-space: normal;  padding-right: 10px;}/*课程部分*/.playlog-item .content .course {  font-size: 28rpx;  line-height: 56rpx;  color: #999;}jsvar moment = require('./moment.min');// 格式化订单var formatNews = function (news) {  return news.map(item => {    var time = moment(item.postTime);    var zero = moment().format('YYYY-MM-DD');    var after = moment(time).isAfter(zero);    if (after) {      item.time = moment(item.postTime).format('HH:mm');    } else {      item.time = moment(item.postTime).format('YYYY-MM-DD HH:mm');    }    return item;  });}module.exports = {  formatNews}源码下载 关注订阅号【黄秀杰】或扫一扫下方二维码回复关键字115                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序引用腾讯地图接口域名不合法               小程序超实用组件：仿微信通讯录                                                        原作者: 黄秀杰                   来自: 黄秀杰                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 从无到有开发一款产品（小程序）的过程与思考                                                                                               "},{"title": "微信小程序开发--倒计时60s获取验证码 ", "author": "                  Rolan                  2017-7-21 00:49                ", "text": "                                                                                                                                                                                     1、工具类（引用微信小程序提供的工具类）countdown.jsclass Countdown {constructor(options = {}) {Object.assign(this, {options, })this.__init()}/*** 初始化*/__init() {this.page = getCurrentPages()[getCurrentPages().length - 1]this.setData = this.page.setData.bind(this.page)this.restart(this.options)}/*** 默认参数*/setDefaults() {return {date: `June 7, 2087 15:03:25`, refresh: 1000, offset: 0, onEnd() {}, render(date) {}, }}/*** 合并参数*/mergeOptions(options) {const defaultOptions = this.setDefaults()for (let i in defaultOptions) {if (defaultOptions.hasOwnProperty(i)) {this.options[i] = typeof options[i] !== `undefined` ? options[i] : defaultOptions[i]if (i === `date` && typeof this.options.date !== `object`) {this.options.date = new Date(this.options.date)}if (typeof this.options[i] === `function`) {this.options[i] = this.options[i].bind(this)}}}if (typeof this.options.date !== `object`) {this.options.date = new Date(this.options.date)}}/*** 计算日期差*/getDiffDate() {let diff = (this.options.date.getTime() - Date.now() + this.options.offset) / 1000let dateData = {years: 0,days: 0,hours: 0,min: 0,sec: 0,millisec: 0,}if (diff <= 0) {if (this.interval) {this.stop()this.options.onEnd()}return dateData}if (diff >= (365.25 * 86400)) {dateData.years = Math.floor(diff / (365.25 * 86400))diff -= dateData.years * 365.25 * 86400}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)whapp                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序解密微信运动数据               微信小程序+OLAMI自然语言API接口制作智能查询工具--快递、聊天、日历等 ... ...                                                        原作者: 老邓头                   来自: csdn博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 秀杰实战教程系列《四》：倒计时组件LXStepper组件-商品数量加减 ...                                                      • 自学系列（零基础学小程序）---小程序实现简单的倒计时                                                      • 微信小程序中利用时间选择器和js无计算实现定时器（将字符串或秒数转换成倒计时） ... ...                                                      • 微信小程序小工具之下发短信验证码倒计时                                                      • 微信小程序倒计时组件更新加入时间校准功能                                                      • 微信小程序开发相关记录                                                      • 微信小程序倒计时功能                                                      • 小程序验证码倒计时                                                                                               "},{"title": "一款基于2B市场的反馈产品分析 ", "author": "                  Rolan                  2018-12-29 00:31                ", "text": "                                                                                                                                                                                     本文将会通过基础分析、2B产品的市场特点、何为互动社区以及我对下个版本的策划4个角度来与大家进行分享。当然分析以及策略的基础都将围绕相同的目标产品即“吐个槽” 这款以“建议反馈”为核心亮点的2B 产品。文中观点主要针对与 小程序版本的“吐个槽”本人着重体验了小程序版本至于APP和WEB 版本则略过了为了帮助大家更好的理解建议将本文观点映射至小程序版本的吐个槽。基础分析一款B端产品的核心往往会被作为卖点重点宣传。对于“吐个槽”这款产品而言与微信开展的协作打通用户到官方官方到用户的双向信息沟通渠道确实提供了一种非常特殊的能力称之为亮点毫不为过。以此打造的“建议反馈产品”不仅仅节省了互联网团队的开发资源更重要的是提供了一种新的能力而这种能力相信大部分互联网团队并不具备。即： 与微信的通讯能力打通。尽管我不是很喜欢“赢在起跑线上”但我却不得不承认原本并不十分出彩乃至最容易被我们舍弃不断降低优先级甚至排期一年后再开发的“建议与反馈”这个功能因为打通微信而有了颠覆式的变化。因为起跑线将会赢的更加轻松。可是兔子也会有输给乌龟的时刻起跑线的优势能构造壁垒但也终究是起跑线过程中仍然会遇到许多问题而每一个问题都有可能导致项目无法到达终点。我提出两个问题视为抛砖引玉还请诸君思考—— “2B产品的市场特点”以及“何为互动社区”。2B产品的市场特点2B产品 尤其是以围绕“ 帮助产品更好的服务用户 ”相关能力的2B产品具备一个鲜明特点他应该是隐形的他的存在应该完全隐藏在产品本身之下。排除一些版权标示我们几乎难以从用户的视角发现这个服务并不是来自于产品本身。有部分提供隐形服务的产品诸如数据统计客服系统甚至会完全不被用户察觉最大限度的减少了对于B端产品的影响。2B产品的第一个市场特点：作为互联网团队而言我希望这个B端的服务能够被用户使用但我并不希望让用户感知到自己使用了其他的产品我希望所有我所接入的B端服务都能让用户产生一种错觉这个功能是属于我这款产品本身的而不是第三方的尽管他的本质任然是第三方的。这个截图 是小程序：腾讯小经费接入的吐个槽社区我很难将这个界面与小经费建立关联我甚至没有办法产生这样的判断这是“ 小经费的吐个槽社区 ”或者这是“ 小经费的建议与反馈”。作为B端产品而言还具备另一个特点： 我希望我所使用的第三方服务是植入到我的流量路径之中的 是能形成流量闭环的。也就是说我不希望这些服务阻塞了用户的使用路径同样的我也不希望我自己的用户被第三方服务截流。我所理解的针对第三方服务的流量闭环是指具备多个路径到达自有服务以此形成闭环用户在整个使用过程当中极大的降低离场转场感。这种闭环不仅仅需要满足返回路径更多的则是正向路径的延续跳转能够通过第三方服务进入到下一个自有服务。目前小程序版本的吐个槽仅仅满足了前者仅通过返回的触发能够回到自有服务。我们可以尝试思考一个场景 用户在吐个槽页面跳出这应该被视为原有产品流失用户还是视为吐个槽流失用户。B端产品尤其是以提供面向用户的服务内容尽量多的去推动用户回流减少“截流”的可能性。我将其理解为 用户从哪里来便回到哪里去。（小程序版 吐个槽的用户路径仅通过返回按钮能回到产品自有服务里）何为互动社区我们曾经将建议反馈视为信息的通道一方面是指用户的信息传达到开发团队的通道另一方面也是指开发团队将一些重要信息引导信息乃至于教育信息规则信息传达给用户的通道。对于任何一个团队而言都非常重视 用户的意见与反馈但很遗憾的是我们重视这个通道并不代表我们有足够的资源来完善和强化这个通道因为他并不能为我们带来更加直观的数据价值。我很惊讶于“吐个槽”对自身的定义并不是“通道”而是一个“互动社区”。这是一种质变对于大部分互联网团队而言我们是不具备打造社区的能力及资源许多时候我们甚至连通道的稳定性也没有与之相匹配的资源预算。从定义上来讲这是一个让人眼前一亮的概念有一瞬间我反问自己“通道为什么不能是社区呢？”遗憾的是经过我的体验吐个槽目前的产品设计里仍然是在构建“通道”而非构建基于通道的“社区”也许我们很难将通道和社区联系在一起不妨思考这个问题： 在一个管道里如果只有零散数人那么他是一个通道但这个管道一旦涌入大量的人群数以万计的人流转到这个通道里他是否就构成了一个社区？有人的地方就有社会。通道是从信息传递的角度去看待建议与反馈如果是站在人数的角度看待当一个通道拥有足够的人数时他即是通道也是社区。建议与反馈是具备构造社区的基因的因为他对一些特定的用户具有足够明确的吸引力。这些热衷产品愿意贡献反馈和建议的特定用户往往可以成为产品的死忠用户。（并不是所有人遇到问题都想去反馈更多的是遇到问题了然后就流失了）建议与反馈具备极大的提升空间只是单个团队难以付出完成该空间所需的成本实际上一个基于死忠用户的小社区并不需要太大的用户基数日活5万左右便可构造一个小社区。对于2B产品定位的“吐个槽”而言所服务的产品对象相信大部分都是满足这个数值的。以目前而言吐个槽所提供的服务仅仅满足了作为通道的诉求能发起反馈能查看他人反馈能发布官方信息的作用。几乎没有满足构造社区的特点比如：氛围。社区氛围用户其实是很容易被影响的。在这里我们可以理解为用户是否发起反馈是否阅读他人反馈是否参与反馈均是受到氛围的影响。对于面向用户的服务我们不能用“有”和“无”来判断好坏基数足够大的情况下必然会形成“有”的格局。随着产品用户的增长一定会有用户发起反馈也一定会有用户阅读或者参与反馈这与我们做好或者做坏无关只是人数增长带来的概率效应。实际上面向用户的服务都会强调氛围对用户的影响我们会通过反馈率（反馈人数/页面访问人数）来衡量一个反馈页面的氛围是否构造到位。通道是工具工具满足人们既定需求社区的根本在于氛围而氛围引导并创造用户需求再来满足用户需求。永远不要低估氛围对人行为的影响实际上人们大部分的行为都是受到环境的影响而产生的结果。什么样的氛围是以反馈为前提构造的社区应该具备的氛围？真实、真诚、平等、尊重这四点是基础氛围再之上还有活跃响应以及竞争（同一个功能的AB派系之争）当然最重要的是 这里有人 这需要我们构造的人物形象足够丰满。比如：一个大头像比小头像更容易让人感觉到“人味”人们只会在一个相对放松的环境能够畅所欲言反馈也是用户真实想法内心话语的倾述。一个严肃的环境下只有“忍无可忍”的建议会被暴露出来俗气点来讲严肃的反馈社区只能收集到一些“憋不住了”的反馈大部分还能“再憋一下”的反馈是不会被收集到的。简单来讲吐槽首页是在被动的等待用户反馈并没有主动的引导用户反馈是冷冰冰的工具而不是有人味的社区。如果有这样一句话 那我们的感知就会产生很大的区别这便是对氛围的构造。“非常感谢你使用我们的产品你的每一个建议我们都会认真对待小经费全体团队期待你的反馈”顺带一提你是否还记得这个页面是从“腾讯小经费”这款小程序进入的建议与反馈。我想已经很难想起这款小程序的名字了。我的策划如果是我来做这款产品的下个版本我会围绕B端定义以及社区构造来策划和设计。1. B端定义（1）将产品风格以及反馈主场景还给B端客户产品风格和反馈主场景是解决“ 我在哪” 这个问题反馈和建议是从属于主产品的并不是一个独立的分支。他需要继承主产品的设计风格以及主要的氛围场景。我会将吐个槽主页的视觉主场景“还”给B端这很简单只需要开放针对内容的配置项即可后续迭代也可以在主场景构造不同的风格样式。2. 让流量从哪来回哪去作为产品体系的一个业务需要有能力联动至不同的业务场景我会考虑用 交叉路径 的设计方法替代 死胡同折返路径 。我们构思一个场景来理解这个需求吧。用户进入意见与反馈必然是对某个业务产生了疑问前来提出问题或者寻找答案。我们假设用户在“吐个槽”经过两次操作找到了答案并回到业务场景我们来看看这个流程用户需要经过几个步骤。首页–>二级页面（疑问）–>返回首页–>进入个人中心–>进入吐个槽–>进入二级页面（找到答案）【正向路径】返回吐个槽首页–>返回个人中心–>返回首页–>再次进入该业务【死胡同折返路径】为什么不能在找到答案时直接回到业务场景呢？通过路径交叉我们能极大缩短用户回到对应业务的流程。实际上面对用户的真实操作所产生的路径比我们文中的案例还要长许多正向路径不能减短但受到需求（解惑）驱动尚能推动用户完成该路径。但死胡同折返路径时由于已经得到了答案但却是“原路返回”此时没有需求驱动在这个漫长的返回路径里出现若干次流失漏斗。最终大部分用户并没有回到原来的业务场景而是流失在返回路径当中。让流量从哪里来回到哪里去并不是指产品之间的跳转而是指A业务的流量回到A业务里建立业务和反馈问题之间的交叉路径。这也仅仅只是开放给B端用户定向配置跳转页的能力。3. 社区氛围构造建议与反馈对于互联网团队而言其具备的基础价值是信息收集与传达在此之上也能一定程度聚集活跃死忠用户并且能促使死忠用户的产生。站在基础价值的角度我会尝试通过氛围的营造来增加用户的反馈率获得更多的反馈信息也会通过一些激励设计刺激用户提供高质量的反馈。（评测送奖品对此类型活动的支持会是非常有效的方法。）在我的产品经验里我发现某个时间点产生的问题会具有极强的趋同性比如：我们上线了一个新功能一定时间范围里80%的反馈都是围绕新功能展开的。用户提供的建议并不是一笔一笔的流水账反而是和时间具有高度共鸣的信息。对问题趋同性的表达会增加用户对产品的熟悉感同时也会引导用户产生共同的关注点乃至延展教育引导意义。反馈其实与话题很像都是极易受到时间事件的影响。我会减少热门话题的暴露更多的暴露用户新提出来的问题而不是一些所谓的经典问题要知道许多的经典问题并不是用户当前最关注的问题。同时我会将 “如同评论一般 ”的视觉更改为 卡片式的内容流 相对于评论视觉而言卡片本身对内容能起到很好的聚焦以及分割作用。在多个评论之间其实上下并没有联系两条信息是分割的也是独立存在的卡片更符合这里的场景。同时我取消了 时间参数。时间参数是双刃剑对于有大用户规模的产品而言能够用时间表达出“人气”“热闹”的氛围。然而对于中小产品而言时间只会产生“冷清”“不火”乃至“这个产品是不是死了”的感觉。我们可以回顾一下之前的截图在腾讯小经费的吐槽社区里第一条信息显示的日期是：4个月前。无形当中其实是削弱了产品对用户的吸引力减少了用户的兴奋值和新鲜感甚至产生一种淡淡的嫌弃。时间参数在两个环节有弊端：其1时间是不可逆不可暂停的今天的信息终究会被贴上1个月前1年前的标签若没有持续的新的信息很容易出现首条信息来自数月前的现象。其2通过查看两条信息之间的时间差用户能解读出该产品是否活跃是否有人气。如果两条信息之间的时间差是秒级显然是很活跃的社区如果两条信息之间的时间差是数日乃至1个月以上显然是极度不具备人气的社区。这就如同贴吧火的贴吧和冷清的贴吧都会通过时间很真实的反应出来。站在产品的角度我们可以尝试理解毕竟是反馈和建议是低频是极少用户进入的地方。遗憾的是 用户并不会对产品的主场景和副场景进行区分实际上不管是主还是副用户都会将自己所看到的信息理解为这款产品怎么样而不是这款产品的某个业务怎么样。除了删除时间参数我还增加了官方答复的标签放大了人物头像。放大人物头像会增加提问的真实感以及人味真实且丰满的人物所提出来的问题恰恰会引起阅读者的好奇乃至联想甚至于“这就是我要问的”。官方答复标签此时会增加用户的安全感信任感从而进入问题详情查阅答案。反馈按钮则调整为固化在底部的按钮在用户翻页浏览内容时能够最便捷的方式发起反馈不用再回到页面顶部再来发起反馈。并且我在反馈按钮上植入了一些具有暗示效果具有亲和力的文案用来让反馈倾诉这个行为不显得那么沉重。以反馈和建议构造的社区还有很多可能性站在B端的角度要充分考虑到不同产品的背景条件并给予支撑能力。用户量大的产品每天都有一定流量经过反馈页的甚至可以植入一些提建议送红包送礼品等具有运营性质的能力。用户量少的产品缺少集中流量的就需要隐藏产品的缺点而是去引导死忠用户的产生给予到足够的尊敬足够的氛围促使用户提出宝贵的建议。总结我认为针对拥有核心优势的产品无需堆砌太多重量级功能反而是需要注意许多细节与体验在产品设计上尽量去依赖核心能力尽量不要去干扰核心能力。吐个槽的核心能力拥有非常强的市场竞争力及壁垒效应此时不需要增加过多的所谓的核心业务而是应该去包装完善核心能力的使用场景以点破面。我将其称之为 大招少一点秒招多一点 。简单来讲“吐个槽”拥有核心能力但缺少对B端产品的洞察尚且没有明白“帮助B端客户服务客户所拥有的用户”的含义所以在做法层面甚至没有在服务内给到B端产品署名权。同时以“建议与反馈”作为根基 构造互动社区仍然处在探索阶段还没有完成社区的构造目前仅仅只是名字被称呼为“互动社区”“吐个槽社区”实际上仍然只是一个信息传达的通道。在吐个槽官我想指出几个点：也许客户需要的是腾讯网一样功能强大的互动社区而不是指“长得一样”的互动社区；如果没有腾讯网的流量即使长的一样也不会具备太大的收集反馈的能力；副标题是让反馈变得便捷轻巧那么反馈和社区有什么关系呢难道不应该是“让社区收集更多的反馈更高质量的反馈吗”；或许这里想表达的是“接入便捷开发轻巧”但不要忘记这项能力 即服务于客户也服务于用户。Ps：具备核心能力已经赢在起跑线但龟兔赛跑的故事屡屡上演（OFO）不忘初心方得始终与诸君共勉。相关阅读腾讯吐个槽产品测评大赛报名启动iPhone XR等你来拿！念念不忘必有回响｜腾讯吐个槽产品测评大赛结果公布作者：作者：枯叶微信公众号：枯叶咖啡馆。人人都是产品经理专栏作家。7年产品人3年产品总监本文为「人人都是产品经理」社区和腾讯吐个槽联合主办的“腾讯吐个槽产品测评大赛”中的三等奖作品未经许可禁止转载。题图来自Unsplash基于CC0协议                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    BAT发力小程序站在十字路口的开发者又当如何抉择？               小程序的一些总结：画canvas和内嵌webview                                                        原作者: 枯叶                   来自: 人人都是产品经理                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "聊聊2018小程序这个迷宫 ", "author": "                  Rolan                  2018-12-26 00:02                ", "text": "                                                                                                                                                                                     整个2018年我都在纠结小程序到底是不是一个新赛道或者存在不存在红利但巨头们似乎已经想清楚了。那么我仅希望在即将到来的2019年小程序薅羊毛大战中吃得饱穿的暖！我喜欢在飞机上俯瞰城市尤其是晚班的飞机可以根据城市灯光的聚合度和亮度了解到整个城市的规划格局。俯瞰是某种程度上的升维。穿梭在一个整体中时你无法看到整体的全貌。就像迷宫中的人和站在高处的旁观者看到的东西是不一样的。一、迷宫中的开发者从微信小程序内测开始我就混迹到了各个小程序的圈子里。作为一名自称的开发者我沉浸在各个社群的激烈讨论中有时高呼万岁有时吐槽弱智。那时候我和大多数小程序开发者一样看不清微信的布局不知道小程序未来的路在何方一切的动力都来自于“公众号红利错过了不能再错过小程序”。以致于很长一段时间小程序的玩法都是照搬了微信公众号早期H5和微官网那些玩法只是迭代的速度加快了。不断被赋予的能力不断加持的资本不断高呼的发声者让走在迷宫中的开发者越来越迷茫。最开始觉得搞量有的玩然后发现流量根本存不住。后来搞积分兑换商城然后发现被羊毛党薅的入不敷出。现在又回归社区搞起了O2O会比2015年更好么？二、从一个咨询项目说起我在今年7月份接到一项咨询服务需求客户的要求是搜集所有可以搜集的公开资料和数据给出公司是否应该加大投入正式入局小程序赛道咨询建议。“？？？”这还用咨询么？肯定赶紧上啊！客户的回应是：“我要知道为什么？”不得不说这是一个企业得以立身的重要因素：任何一项决定不是盲目跟风而是先回答“为什么”。我也曾经问过自己为什么当时的答案是“公众号红利错过了不能再错过小程序”。但我没有再问自己“为什么会错过公众号红利”以及“为什么就笃定小程序会有红利”甚至“小程序的红利是什么”。要回答客户的为什么我就需要强迫自己站到更高的维度去仔细的审视小程序这个产品形态。比如这些升维的问题：从平台的角度微信为什么上线小程序？小程序发展到什么规模了？从小程序本身它细分出了哪些服务类目每种类目发展如何？哪种类目最受开发者追捧？哪种类目在微信有更好的发展前景或者说目前来看发展的最好？从开发者的角度哪些人在做小程序他们为什么做小程序？取得了哪些成绩？还有哪些人没做小程序他们的疑虑是什么？…即便是以行业观察者自居的媒体似乎也没有深思过这些问题。他们中的大部分把目光聚焦在“谁谁谁用什么方法在多长时间获得了多少万流量”；剩下的小部分把这些稿件的标题换成了疑问句式但正文内容没变。我很艰难的从几个数据公司推测的小程序榜单和流量报告里扒出了一些内容虽然他们大部分都对不上但终归是升高了维度：对行业整体进行观察。抛开小程序不说先看微信的数据。根据艾瑞统计的微信用户月停留时长看从2017年7月开始用户停留在微信的时间越来少直到2018年1月突然拉升然后开始稳步增长。2018年1月微信的一个节点事件是开屏推广的小游戏。小程序是2017年1月上线的但是根据图表的数据直到2017年12月微信的用户停留时长还一直是降低的状态。拐点出现在小游戏上线的时间而不是小程序我们是否可以由此推测小程序并不能帮助微信把用户停留在微信里。那么显然微信是没有私心的小程序的上线只是希望给用户更好的体验。假设这一切是真的话那么涌入的“淘金者”应该对自己的动机做一番思考：小程序到底是不是红利？我已经越来越笃定微信小程序并不是一件红利至少对创业者来说没有那么大的红利。见实之前发布了一篇某个投资人对微信小程序审核逻辑的吐槽当时实在是看不过留言“反对”了一下：首先摆正一个心态：微信推出小程序不是为了制造一个新的经济形势或者创造新的创业机会给开发者赚钱而是要提高用户在微信的停留市场和使用频率。创业者应该是在这个基础上去最大化拓展生存的空间谋取自己的利益而不应该有“你是开放平台就不能管我太多”的想法。要知道我们生存在夹缝里应该做的不是说夹缝太窄了没法赚钱而是想尽办法支撑甚至拓展这个夹缝。（毕竟是你自己选择进入这个夹缝的）其次要想清楚你的创业点子和小程序的特性是不是符合。小程序就是这个样子它的流量是流动的不属于任何一个人因为它只是微信的一个附属物。在这个前提下过分强调留存不是一个正确的心态甚至拿APP的思路来要求小程序。假设你的服务解决的是用户高频高时长需求那么你应该能做出一个非常爆款的APP。如果你没有那说明你的服务并不能有效的解决用户的需求或者说用户根本不存在你想象出来的那个“需求”。如此的话你凭什么要求做出一个高留存的小程序呢？但开发者们不这么看。不到两年的时间里开发者生产出了超过百万个小程序！即速应用的报告里显示到11月微信小程序总量已经超过120万阿拉丁指数的样本数是1028566新榜量子查查样本量是938094。狂热的不止创业者资本比开发者还积极。三、同样迷茫的资本们公众号量子程序统计了2018年截止到12月中旬的小程序融资情况我们选两个比较有价值的图表看一看。类目上占比最高的是电商和服务商一个是来钱最快的一个是卖水的非常符合资本家们的喜好。量子程序那篇统计文章的标题叫《2018小程序融资报告：数量涨5倍金额涨6倍半数以上融资额超1000万元》非常打鸡血给人的感觉是资本拼了命加持。但实际上我们来看投资轮次天使轮和A轮占了总数的60%以上……是什么概念呢？玩过炸金花的都知道第一把不论如何一般都会跟一把。如果老是只下底不跟牌要么别人不带你玩了要么把自己耗死。但是第二轮过后如果自己的牌不好一般人不会继续跟。我不是看衰小程序其实如果按照月份统计每个月的融资情况的话资本对小程序的关注还是一直没有放缓的。我去除掉量子程序统计中和小程序关系不大的融资团队（比如某成熟项目只是上线了一个小程序）做了一个月度融资次数的趋势图：整体来看还是稳步增加的与哀鸿遍野的互联网裁员潮形成了很明显的差异。看上去平稳乐观的趋势下其实藏了一股“焦虑”我把每个月获得融资团队的类目放进图里：除了几乎每个月必现的电商、社交和SaaS服务商其他类目混乱不堪。把每个月融资团队的类型数量做统计你会发现趋势是在不断增加的。所以说资本们其实也有点抓瞎？他们不再像各种大会里那样沉稳、笃定而是有点“乱投医”；不再像过往的投资意向一样聚焦到同一个赛道内而是每个类目都做尝试。或者资本们认为小程序是一个红利任何一个服务类目都能大有可为？回到投资情况如果你足够细心应该发现从8月开始有一个特别的类目越来越被资本关注。我把图表精简了一下：红色的部分叫社区团购我仿佛回到了2015年看到满大街送水果、修指甲和上门去洗车的O2O从业者……已经在2015年验证了不可行的玩法真的会因为小程序焕发第二春么？还是说新零售已经是被验证可行的新物种了？新闻稿好像不是这么写的。四、两个能力工作原因最近半年接触、聊了超过50个小程序开发者/团队多多少少有了一些感觉。纵观各团队的成败得失我觉得两种能力可以拿出来聊一聊：流量获取能力和流量操纵能力。流量获取能力是一个说起来简单实操很难的能力就像你懂得起标题、写稿子、平台分发的所有套路你也很难写出一篇10W+一样即便你懂得裂变、拼团甚至诱导分享的所有方法你仍然做不出爆款小程序。细细数下来2018年真正从零做到刷屏的小程序就那几款无非是年初人尽皆知的跳一跳、涉嫌抄袭的西瓜足迹还有被封的匿名聊聊、AI面相等。其他用户超过百万级的小程序要么像玩车教授一样基于已有的百万粉丝公众号导流要么像小打卡一样经历了漫长的积累。即便外界都在传播小程序特别容易获取流量这依然是一件非常难的事情。开发者们扪心自问靠在诱导分享边缘试探获取流量的自己有多么胆战心惊。即使获取了巨额流量有多少人过上了滋润的日子？召回、留存、变现哪一件不让开发者操碎了心？你肯定看过很多买彩票中大奖的报道但是应该很少听说利用奖金走向致富路的这就涉及到“流量操纵能力”。千万级流量是什么概念？从零到千万级流量最快需要多久？流量从什么渠道来流向哪里？多少男女？来自哪个城市多大年龄？用了什么手机？如果流量是固定的这些流量可以用来做什么？如果流量是动态的如何引导他们去做你想让他们做的事情？让你操盘一次千万级流量的话你是否会考虑这些问题？或者你能否预计到是否会有千万级流量到来？据我所知的去年圣诞节的圣诞帽事件为赵团结同学带来了峰值4000万PV的巨额流量他除了不停的给服务器充钱加带宽以外脑子几乎是空白的。今年刷屏的西瓜足迹在周末刷屏流量暴增的时候才开始通过亦仁找广告投放；唯一有先见之明的AI面相采用了分销的玩法变现并没有发挥与小程序功能相当的价值。在我看来在成熟的微信生态小程序开发者未来只会有两种活法：一种是已有盈利模式具有巨额流量操纵能力的团队在10亿微信流量里徜徉。另一种是头系红带每日给自己打鸡血的红利追逐者逐渐把自己的斗志消耗殆尽。从这点来看微信是比较自私的：不断涌入的开发者为用户提供了数不尽体验流畅的小程序让用户更加依赖微信。微信的目的达到了但除了广点通并没有给那些没有盈利模式的无私奉献这提供足够有效的变现方式。或者说微信没有给他们足够的“入坑警示”。五、新的争夺战整个2018年我都在纠结小程序到底是不是一个新赛道或者存在不存在红利但巨头们似乎已经想清楚了。去年挑起内容创业者争夺战的BATT今年又开始撺掇着挑起小程序开发者争夺大战。2016年几乎同一时间百度、阿里、腾讯和头条纷纷上线了玩法完全一样的内容算法分发平台然后出台了各种补贴政策抢夺内容生产者入驻。一年后还是同一波公司在微信小程序后上线了一系列名为支付宝小程序、百度智能小程序和头条/抖音小程序的平台。这些平台除了把程序文件的后缀名从wxml改成swan、axml或者ttml外用了几乎完全一样的代码规范。那么对他们来说拼的只能是接口能力、流量和变现了。这种可预见的竞争格局下2019年等待开发者们的将是一场薅羊毛盛宴。即日起我将分别对百度小程序、支付宝小程序和头条/抖音小程序逐一展开分析。先不管它赛道不赛道红利不红利让我们一起挖掘各平台的最高价值点在即将到来的2019年小程序薅羊毛大战中吃得饱穿的暖！#专栏作家#喜新微信公众号：喜新人人都是产品经理专栏作家。产品经理、新媒体、数据分析师三栖。本文原创发布于人人都是产品经理。未经许可禁止转载题图来自网络                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    研究了6个爆款小程序我总结了产品增长的四大动因               小程序助手发布！                                                        原作者: 喜新                   来自: 人人都是产品经理                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序 setData 修改 data 中数组内不定对象的数据 ", "author": "                  Rolan                  2019-11-6 00:31                ", "text": "                                                                                                                                                                                     小程序 setData 修改 data 中数组内不定对象的数据普通变量的 setData()在某些时候我们的小程序中存在的不只是像下面这样的简单的变量: 变量值这种形式data: {    name: 'Kyle',    age: 28,    mail: 'kylebing@163.com'}这种形式的数据在需要修改的时候只需要如下形式修改就可以了 this.setData({    name: 'Tina' })数组内部的 setData()有时候里面会有对象数组需要修改数组内部的变量如下面的 people 数组：people: [  {    name: 'Kyle',    age: 24,    products: [      {name: 'iPhone', price: 4550},      {name: 'AirPods Pro', price: 1999},    ]  },  {    name: 'Tina',    age: 26,    products: [      {name: 'Dell P2415Q', price: 1800},      {name: 'Macbook Pro', price: 8500},    ]  }]像这种改变数组内部属性的值需要不同于普通变量的 setData()格式如下：方括号里接收的是字符串this.setData({    [ 定位数据的字符串 ]: 数据})如: 修改 Kyle 的 agethis.setData({    ['people[0].age']: 25})上面这是修改数组中固定位置元素的数据比如现在已经知道需要修改的数据下标变量为 index修改不定下标的数据又该怎么写呢？因为 [] 方括号中接收的是字符串所以我们只需要放入对应的字符串即可可以是 单引号拼接的字符串也可以是 ES6 反引号形式的字符串说白了只要是字符串就可以。对比两种形式的写法就能明白什么意思了写法如下：普通字符串拼接：let index = 1;this.setData({  ['people[' + index + '].age']: 25})ES6 形式字符串：let index = 1;this.setData({  [`people[${index}].age`]: 25})修改数组中数组的值这个无非就是再加一层而已如：修改第二个人的第二个产品的价格每次点击加 2定义一个方法 changeAirPodsPrice 绑定中页面中的按钮上代码如下：changeAirPodsPrice: function() {    let index = 1;  // people 下标也就是第二个人    let productIndex = 1 // 产品 下标也就是第二个产品    this.setData({      [`people[${index}].products[${productIndex}].price`]: this.data.people[index].products[productIndex].price + 2    })},效果如图：                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    VUE 组件转换为微信小程序组件               小程序的双线程模型                                                        原作者:  KyleBing                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序实用组件：手势解锁 ", "author": "                  天下雪                  2016-12-14 16:46                ", "text": "                                                                                                                                                                                                                                                                 本文为本站原创内容作者为jsh5css如需分享请在明显位置标注来源地址及作者。今天又仿了个轮子前几次用基于微信小程序自家的canvas写了两个小demo期间真是各种莫名问题尤其android系统问题比较严重；接下来的demo毋庸置疑理所当然的还是有bug啦经测试ios系统和开发工具都是没有问题的用同事的手机一测结果悲催了触摸事件好像有问题.同事是一铁杆米粉感兴趣的同学可以找找其他类型安卓手机上的问题顺便帮忙解决一哈啦；前两次的demo感觉不太实用这次的应该会好点wxml文件代码：<view class=\"lock-box\">    <view  class=\"lock-title {{titleColor}}\">{{title}}</view>    <view hidden=\"{{resetHidden}}\" bindtap=\"lockreset\" class=\"lock-reset\">重置</view>    <canvas disable-scroll=\"true\" class=\"lock-cav\" bindtouchstart=\"touchS\" bindtouchmove=\"touchM\" bindtouchend=\"touchE\" canvas-id=\"locker\" style=\"width:686rpx;height:686rpx;\"></canvas></view>js代码：// pages/main/index.jsvar wxlocker = require(\"../../utils/wxlocker.js\");Page({  data:{     title:'请设置手势密码',     resetHidden:false,     titleColor:\"\"  },  onLoad:function(options){    // 页面初始化 options为页面跳转所带来的参数    wxlocker.lock.init();    this.initState();  },  onReady:function(){      },  onShow:function(){        // 页面显示  },  onHide:function(){    // 页面隐藏  },  onUnload:function(){    // 页面关闭  },  //设置提示语与重置按钮  initState:function(){    var resetHidden = wxlocker.lock.resetHidden;    var title = wxlocker.lock.title;    var titleColor = wxlocker.lock.titleColor;    this.setData({      resetHidden:resetHidden,      title:title,      titleColor:titleColor    });  },  touchS:function(e){//touchstart事件绑定    wxlocker.lock.bindtouchstart(e);  },  touchM:function(e){//touchmove事件绑定    wxlocker.lock.bindtouchmove(e);  },  touchE:function(e){//touchend事件绑定    wxlocker.lock.bindtouchend(e,this.lockSucc);    this.initState();  },  lockSucc:function(){//解锁成功的回调函数    console.log(\"解锁成功！\");    //do something  },  lockreset:function(){    wxlocker.lock.updatePassword();    this.initState();  }})文件下载：小程序之手势解锁.zip最新代码地址：https://github.com/demi520/wxapp-lock                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                                           微信小程序实用组件：城市切换                                                        原作者: jsh5css                   来自: 本站原创                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 让人头痛的小程序之『图片懒加载』终极解决方案                                                      • 微信小程序源码解析：数字累加动态效果（附demo）                                                      • 微信小程序实战开发教程：手势解锁；基于canvas                                                      • 在微信小程序里实现图片预加载组件                                                      • 微信小程序自定义实用组件（对话框、指示器、五星评分...                                                      • 微信小程序实战源码解析：列表项左滑删除效果                                                      • 微信小程序中实现一对多发消息                                                      • 微信小程序手势探索：单触摸点与多触摸点                                                      • 微信小程序 手势解锁组件（无卡顿）                                                                                               "},{"title": "【微信小程序】知乎视频查看 ", "author": "                  Rolan                  2019-12-24 00:04                ", "text": "                                                                                                                                                                                     第一版做了知乎视频保存视频到本地相册的功能。进一步我们可以做一个增强功能支持视频查看。用户在登录状态下载过的知乎视频可以在我的浏览或者查看历史记录在线查看视频这个功能的核心其实是用户身份标识的获取因为我们只要拿到了用户标识相应用户下载过的视频就可以和用户标识绑定存储到数据库中。当用户下次再进入app只要通过用户标识就可以去数据库中拿用户之前下载过的视频就可以了。表结构如下：CREATE TABLE `wx_user_zhihu_answer` (  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,  `is_delete` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '软删除标识',  `create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',  `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',  `openId_md5` varchar(128) NOT NULL DEFAULT '' COMMENT 'openId md5加密',  `answer_url` varchar(128) NOT NULL DEFAULT '' COMMENT '知乎回答url',  PRIMARY KEY (`id`),  KEY `idx_is_delete` (`is_delete`),  KEY `idx_openId_md5` (`openId_md5`),  KEY `idx_answer_url` (`answer_url`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户及知乎回答信息';获取用户标识我们借鉴微信的例程来设计用户登录逻辑首先按钮上设置open-type=\"getUserInfo\",可以让用户自主选择是否授权小程序。<button class=\"login-btn\" wx:if=\"{{!hasUserInfo}}\" open-type=\"getUserInfo\" bindgetuserinfo=\"getUserInfo\">  点击登录</button>当用户点击并确认授权会执行回调的getUserInfo方法getUserInfo: function(e) {  app.globalData.userInfo = e.detail.userInfo;  this.setData({    userInfo: e.detail.userInfo,    hasUserInfo: true  });  // 登录  wx.login({    success: res => {      const { code } = res;      app.globalData.loginInfo.jsCode = code;      this.fetchUserIdInfo();      // 发送 res.code 到后台换取 openId, sessionKey, unionId    }  });  // 获取用户信息  wx.getSetting({    success: res => {      if (res.authSetting[\"scope.userInfo\"]) {        // 已经授权可以直接调用 getUserInfo 获取头像昵称不会弹框        wx.getUserInfo({          success: res => {            const { encryptedData, iv } = res;            // 可以将 res 发送给后台解码出 unionId            app.globalData.loginInfo.encryptedData = encryptedData;            app.globalData.loginInfo.iv = iv;            this.fetchUserIdInfo();          }        });      }    }  });},fetchUserIdInfo() {  const { jsCode, encryptedData, iv } = app.globalData.loginInfo;  if (!(jsCode && encryptedData && iv)) {    return;  }  wx.request({    url: userInfoFetchUrl,    method: \"POST\",    data: {      jsCode,      encryptedData,      iv    },    header: {      \"Content-Type\": \"application/x-www-form-urlencoded\"    },    success: res => {      res = res.data;      if (res.code === 1) {        app.globalData.userIdInfo = res.data;      }    }  });},getUserInfo可以获取用户的信息调用wx.login能够拿到code,调用wx.getUserInfo能够拿到encryptedData和iv。拿到code、encryptedData、iv我们就可以调用微信接口以及解码逻辑拿到用户的openId和unionId,我们这部分都放在了后端接口(userInfoFetchUrl)处理这里我们使用openId标识用户身份该接口返回的是openId用m5加密后的id。由于所以身份标识相关的操作都在服务器进行且返回的是md5加密后的值所以极大提高了用户信息的安全性。后端解析用户标识的逻辑如下exports.infoFetch = async params => {  const { jsCode, encryptedData, iv } = params;  const sessionRes = await axios.get(    `${jscode2sessionUrl}?appid=${appId}&secret=${appSecret}&js_code=${jsCode}&grant_type=authorization_code`  );  const sessionResData = sessionRes.data;  const sessionKey = sessionResData.session_key;  const openId = sessionResData.openid;  const pc = new WXBizDataCrypt(appId, sessionKey);  const userInfo = pc.decryptData(encryptedData, iv);  const unionId = userInfo.unionId;  if (unionId && openId) {    return {      openIdMD5: md5(openId),      unionIdMD5: md5(unionId)    };  } else if (openId) {    return {      openIdMD5: md5(openId)    };  }  return {};};拿到用户标识后工作基本就完成了。我们还需要做一些优化在app.js的onLaunch回调和登录页onLoad回调中获取用户信息使得用户再次打开app在有效登录时间内依然可以直接使用用户标识。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序 找不到可构建的npm包-解决方法               【微信小程序】写一个能自定义尺寸、样式的switch                                                        原作者:  前端阅读室                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发：水平排列布局与滚动视图（scroll-view） ", "author": "                  天下雪                  2016-12-23 11:58                ", "text": "                                                                                                                                                                                     本来是希望李宁老师亲自过来发的估计好久没来把我们网站给忘了我只好帮李宁老师发了；本文节选自李宁老师的电子书：http://yuedu.baidu.com/ebook/b3af07cfb04e852458fb770bf78a6529647d35c9一：水平排列布局小程序的布局和React Native的布局类似采用了弹性布局的方法。也就是说分为水平和垂直布局。默认是从左向右水平依次放置组件从上到下依次放置组件。wxml文件用于放置参与布局的组件为了更好地描述小程序是如何布局的本章使用了带背景色的view组件来演示。view是小程序中所有可视组件的根。任何可视组件都需要使用样式来设置自身的属性并完成相应的布局。在小程序中可以使用两种方式设置样式一种是class属性另外一种是style属性。前者需要指定在wxss文件中定义的样式后者允许直接在组件中定义样式属性。例如如果要水平放置三个view组件可以在wxml文件中使用下面的代码。12345<view class=\"flex-wrp\" style=\"flex-direction:row\">     <view class=\"flex-item bc_green\"></view>     <view class=\"flex-item bc_red\"></view>     <view class=\"flex-item bc_blue\"></view></view>显示的效果如图1所示。图1 水平布局 在上面的代码中同时使用了class和style。分别指定了样式flex-wrp和样式属性flex-direction:row。其中后者表示view中的子组件要按水平排列。flex-wrp的定义如下：12345.flex-wrp{     height: 100px;     display:flex;     background-color: #FFFFFF; }其中display:flex表示弹性布局flex是Flexible的缩写。如果class属性需要指定多个样式样式直接用空格分隔代码如下：1<view class=\"flex-item bc_green\"></view>其中flex-item的代码如下：1234.flex-item{    width: 100px;    height: 100px;}前面所有的样式都是在当前页面的index.wxss文件中定义的而bc_green以及其他几个设置颜色的样式是在app.wxss文件中定义的所以的页面都可以使用。123456789101112131415.bc_green{     background-color                                            .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序小技巧系列《七》五星评分制作微信小程序组件 ... ...               微信小程序实用组件：城市切换                                                        原作者: 李宁                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 知晓程序：如何「掏空」小程序的五层页面限制？                                                      • 让人头痛的小程序之『图片懒加载』终极解决方案                                                      • 微信小程序官方文档知识解读推荐新手仔细阅读                                                      • 面向新手系列《六》快速创建页面技巧及正则使用简介                                                      • HotApp云笔记问题解决：背景图片在手机上不显示                                                      • 微信小程序Page中data数据操作和函数调用                                                                                                                                                   0 条回复                                                                        \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                                             相关栏目              官方教程后端教程官方问答入门系列官方基础教程新手教程面向新手系列小技巧系列https相关系列实战教程                新手教程阅读排行            jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092505|82d0548d1782d4904884b786f9339b63|2';\t\t\t\t\t\t"},{"title": "微信小程序之『仿 QQ 消息气泡拖拽消失』 ", "author": "                  天下雪                  2016-12-29 00:32                ", "text": "                                                                                                                                                                                     作者：xiaoxiaoxiao来自授权地址今天带来的是仿QQ消息气泡拖拽消失特效源码中很多地方还是有很多不足希望大家一起齐心协力给我提出宝贵意见咱们一起来继续完善此效果~~先看效果：气泡拖拽消失原理并没有想象得那么简单我们拆分来逐步分析~~1）实现静态效果先看效果：先实现静态效果上图看着很头疼就算静态也完全没有思路我们将填充色去掉留下曲线再看看效果（盗用别人一张图）：原谅我无耻的盗图这样思路就清晰很多其实就是由两个圆、两条直线、两条曲线构成：js代码如下：// 两条贝塞尔曲线和两条直线this.ctx.beginPath();this.ctx.moveTo(x1, y1);this.ctx.quadraticCurveTo(this.anchorX, this.anchorY, x2, y2);this.ctx.lineTo(x3, y3);this.ctx.quadraticCurveTo(this.anchorX, this.anchorY, x4, y4);this.ctx.lineTo(x1, y1);this.ctx.setFillStyle('red');this.ctx.fill();// 两圆圈this.ctx.beginPath();this.ctx.arc(this.startX, this.startY, this.radius, 0, 2 * Math.PI)this.ctx.arc(this.x, this.y, 20, 0, 2 * Math.PI)this.ctx.setFillStyle('red');this.ctx.fill();如上代码即画出我们想要的静态效果。再献上一张图表示如上坐标点（又无耻盗图了）：坐标点：(x1, y1)为A点(x2, y2)为B点(x3, y3)为C点(x4, y4)为D点(anchorX, anchorY)为X点2）如何让气泡消息动起来先看效果（再tm无耻盗图→_→）：js代码：touchmove: function(e){    this.x = e.changedTouches[0].x;    this.y = e.changedTouches[0].y;    this.anchorX =  (e.changedTouches[0].x + this.startX)/2;    this.anchorY =  (e.changedTouches[0].y + this.startY)/2;}其实就是如上一个touchmove事件x、y为手指移动的位置坐标将x、y与气泡定位曲线和圆圈等关联起来那么手指移动的时候气泡也会跟着移动了从而实现动起来的效果~~3）如何拉断气泡先看效果（终于没有盗图了）：拉断气泡js代码：if(this.radius < 7){    //写去除曲线链条只留下消息    ...}有没有发现拉得越长时候初始位置小圆半径越来越小当半径小于7的时候我们就可以认定其为拉断。(至于拉断消失源码很简单朋友们自己去看)4）松开手后气泡消息消失js代码：touchend: function(e){    // 松手后消息消失    this.ctx.setFillStyle('rgba(1,1,1,0)');    this.ctx.draw();}很简单就是将整个颜色绘制成透明度为0那么就实现消失效果。参考文献：- http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2015/0311/2577.html- http://blog.csdn.net/gesanri/article/details/48490873源码下载：https://github.com/didiaohu/xiaoxiaoxiao/tree/master/bezierDemo文件下载：bezierDemo.zip                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)胡岳华                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序实例-摇一摇抽奖               在Linux系统下运行微信Web开发者工具                                                        原作者: xiaoxiaoxiao                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序仿闲鱼『下拉菜单』省市区联动选择器（附源码） ... ...                                                      • 让人头痛的小程序之『图片懒加载』终极解决方案                                                                                               "},{"title": "简陋至极：微信小程序日历组件（思路） ", "author": "                  Rolan                  2018-9-4 00:35                ", "text": "                                                                                                                                                                                     最近在做微信小程序项目其中涉及到日历。一直以来遇到日历就是网上随便找个插件这次心血来潮想着自己去实现一下。这次不是封装功能强大健硕完美的组件只是记录一下主体思路。更多功能还得根据项目需要自己去挖掘、实现。（大佬轻喷）思路分析首先最主要的一点就是要计算出某年某月有多少天其中涉及到大小月闰、平年二月。其次弄清楚每月一号对应的是周几。然后有时为填充完整还需显示上月残余天数以及下月开始几天这些又该如何展示。最后根据自己项目需求实现其它细枝末节。计算每月天数按照一般思路[1,3,5,7,8,10,12]这几个月是31天[2,3,6,9,11]这几个月是30天闰年2月29天平年2月28天。每次需要计算天数时都得如此判断一番。方案可行而且也是大多数人的做法。但是这个方法我却觉得有些繁琐。其实换一种思路也未尝不可。时间戳就是一个很好的载体。当前月一号零时的时间戳与下一月一号零时的时间戳之差不就是当前月天数的毫秒数嘛。// 获取某年某月总共多少天getDateLen(year, month) {     let actualMonth = month - 1;    let timeDistance = +new Date(year, month) - +new Date(year, actualMonth);    return timeDistance / (1000 * 60 * 60 * 24);},复制代码看到上述代码你可能会问是不是还缺少当月为12月时的特殊判断毕竟涉及到跨年问题。当然你无需担心,根据MDN中关于Date的表述js已经为我们考虑好了这一点当Date作为构造函数调用并传入多个参数时如果数值大于合理范围时（如月份为13或者分钟数为70）相邻的数值会被调整。比如 new Date(2013, 13, 1)等于new Date(2014, 1, 1)它们都表示日期2014-02-01（注意月份是从0开始的）。其他数值也是类似new Date(2013, 2, 1, 0, 70)等于new Date(2013, 2, 1, 1, 10)都表示时间2013-03-01T01:10:00。计算每月一号是周几呃这个就不需要说了吧getDay()你值得拥有// 获取某月1号是周几getFirstDateWeek(year, month) {     return new Date(year, month - 1, 1).getDay()},复制代码每个月的数据如何展示如果只是简单展示当月数据那还是很简单的获取当月天数依次遍历就可以拿到当月所有数据。// 获取当月数据返回数组getCurrentArr(){     let currentMonthDateLen = this.getDateLen(this.data.currentYear, this.data.currentMonth) // 获取当月天数    let currentMonthDateArr = [] // 定义空数组    if (currentMonthDateLen > 0) {        for (let i = 1; i <= currentMonthDateLen; i++) {\t    currentMonthDateArr.push({\t        month: 'current', // 只是为了增加标识区分上下月                date: i            })        }    }    this.setData({    \tcurrentMonthDateLen    })    return currentMonthDateArr},复制代码很多时候为了显示完整需要显示上下月的残余数据。一般来说日历展示时最大是7 X 6 = 42位为啥是42位呃自己去想想吧。当月天数已知上月残余天数我们可以用当月1号是周几来推断出来下月残余天数正好用42 - 当月天数 -上月残余。// 上月 年、月preMonth(year, month) {     if (month == 1) {\treturn {\t    year: --year,\t    month: 12\t}    } else {    \treturn {\t    year: year,\t    month: --month    \t}    }},复制代码// 获取当月中上月多余数据返回数组getPreArr(){     let preMonthDateLen = this.getFirstDateWeek(this.data.currentYear, this.data.currentMonth) // 当月1号是周几 == 上月残余天数）        let preMonthDateArr = [] // 定义空数组    if (preMonthDateLen > 0) {\tlet { year, month } = this.preMonth(this.data.currentYear, this.data.currentMonth) // 获取上月 年、月\tlet date = this.getDateLen(year, month) // 获取上月天数\tfor (let i = 0; i < preMonthDateLen; i++) {\t\tpreMonthDateArr.unshift({ // 尾部追加                        month: 'pre', // 只是为了增加标识区分当、下月\t\t    date: date                })\t\tdate--\t}    }    this.setData({\tpreMonthDateLen    })    return preMonthDateArr},复制代码// 下月 年、月nextMonth(year, month) {     if (month == 12) {\treturn {\t    year: ++year,\t    month: 1\t}    } else {\treturn {            year: year,\t    month: ++month\t}    }},复制代码// 获取当月中下月多余数据返回数组getNextArr() {     let nextMonthDateLen = 42 - this.data.preMonthDateLen - this.data.currentMonthDateLen // 下月多余天数    let nextMonthDateArr = [] // 定义空数组    if (nextMonthDateLen > 0) {        for (let i = 1; i <= nextMonthDateLen; i++) {            nextMonthDateArr.push({                month: 'next',// 只是为了增加标识区分当、上月                date: i            })        }    }    return nextMonthDateArr},复制代码整合三组数据就得到了完整的当月数据格式如下[    {month: \"pre\", date: 30},    {month: \"pre\", date: 31},    {month: \"current\", date: 1},    {month: \"current\", date: 2},    ...    {month: \"current\", date: 31},    {month: \"next\", date: 1},    {month: \"next\", date: 2}]复制代码至于上下月切换选择某年某月等功能无非就是参数变化而已自己琢磨琢磨即可。骨架都有了你想创造什么样的功能还不是手到擒来。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)忧伤中＊落泪wzhelp121                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    mpvue写一个CPASS小程序               微信小程序JS导出和导入                                                        原作者:  冰扬                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • JavaScript简单日历实现-小程序版                                                      • 微信小程序下订单件插（日历）                                                      • 看大神如何玩转微信小程序日历插件？                                                      • 微信小程序日历选择-类似酒店预订方式有节日标识                                                                                               "},{"title": "使用小程序的scroll-view组件实现列表页 ", "author": "                  天下雪                  2016-12-14 01:16                ", "text": "                                                                                                                                                                                     本文作者：hong26来自原文地址本文作者所属博客有很多内容涉及微信小程序推荐关注之；scroll-view组件介绍scroll-view是微信小程序提供的可滚动视图组件,其主要作用是可以用来做手机端经常会看到的上拉加载下拉刷新列表页!下面就以<摇出微笑>为例来讲解一下这个组件的使用吧!为app导入新page页面首先需要为我们的小程序导入新的page页面,项目根目录打开app.json这个项目配置文件在里面的pages数组添加\"pages/allJoke/allJoke\"然后设置底部导航在\"tabBar\"的列表项(\"list\")添加:    {      \"text\": \"列表\",      \"pagePath\": \"pages/allJoke/allJoke\",      \"iconPath\": \"images/note.png\",      \"selectedIconPath\": \"images/noteHL.png\"    },如果大家要了解具体配置的含义可以参考小程序配置文档这里不再赘述!json配置页接下来就是我们新建page的配置页了,在page目录下新建一个目录如alljoke,再在这个目录下新建一个allJoke.json,复制下面代码到这个文件里面:{    \"navigationBarTitleText\": \"笑话集锦\",    \"enablePullDownRefresh\": true}因为我们待会做下拉刷新时需要用到小程序提供的onPullDownRefresh方法,所以在配置项里面必须开启enablePullDownRefresh.另外一个选项是页顶标题大家随意设置也可以不用设置!wxml视图页好轮到视图页了,同样的在alljoke目录下新建一个alljoke.wxml页面.wxml是小程序自创的一个视图页文档类型,其写法类似html,对于前端来说入门没有难度.需要详细了解的可以去阅读wxml文档.同样复制以下代码到alljoke.wxml里面<view>  <view>    <scroll-view class=\"scroll\" scroll-top=\"{{scrollTop}}\" style=\"height:580px;\" scroll-y=\"true\" bindscroll=\"scrll\"   bindscrolltolower=\"loadMore\">      <view class=\"block\" wx:for=\"{{listLi}}\" wx:for-item=\"item\">        <text>{{item.text}}</text>      </view>        </scroll-view>  </view>  <view class=\"top\" hidden=\"{{hidden}}\" catchtap=\"goTop\">⇧</view></view>大家可以看到,我们的主角scroll-view也在这里隆重登场了!带过来的是一长串配置,就让我来为大家讲一下这些配置的作用吧!配置项作用scroll-top设置竖向滚动条的位置,要注意一点如果设置的值没有变化,组件不会渲染!scroll-y允许纵向滚动bindscroll滚动时触发的回调函数bindscrolltolower滚动到底部触发的事件用到的选项都列出来了,还有一点需要大家特别注意的:使用竖向滚动条时必须为组件设置一个固定高度就是上面代码style里面设置的高!切记切记!更多资料请阅读微信小程序scroll-view组件文档wxss样式同样在alljoke目录下面新建allJoke.wxss文件,小程序的样式和传统css差不多大家可以根据自己喜好自行设计,这里我简单做了一下样式比较丑大家将就着用吧.(题外话:受不了的自己动手丰衣足食).block {    border: 8px solid #71b471;    margin: 20rpx 20rpx;    padding: 10rpx;    background-color: #fff;    border-radius: 20rpx;    text-align: center;}.top {    width: 100rpx;    height: 100rpx;    line-height: 100rpx;    background-color: #fff;    position: fixed;    bottom: 40rpx;    right: 20rpx;    text-align: center;    font-size: 50rpx;    opacity: .8;    border-radius: 50%;    border: 1px solid #fff;  }小程序文档中关于样式的介绍逻辑部分来到最后也是最重要的逻辑部分了!老规矩alljoke目录下新建allJoke.js文件,先贴代码再慢慢讲解:Page({  data:{    listLi:[],    page:1,    scrollTop:0,    done: false,    hidden: true  },  onLoad:function(options){    this.getList(1);  },  onPullDownRefresh: function(){    wx.showToast({      title: '加载中',      icon: 'loading'    });    this.getList(1,true);  },  getList: function(page, stopPull){    var that = this    wx.request({      url: 'https://wechat.sparklog.com/jokes',      data: {        page: page,        per: '20'      },      method: 'GET',       success: function(res){        if(page===1){          that.setData({            page: page+1,            listLi: res.data,            done: false          })          if(stopPull){            wx.stopPullDownRefresh()                     }        }else{          if(res.data<20){            that.setData({              page: page+1,              listLi: that.data.listLi.concat(res.data),              done: true            })           }else{            that.setData({              page: page+1,              listLi: that.data.listLi.concat(res.data)            })           }            }      },    })  },  loadMore: function(){    var done = this.data.done;    if(done){      return    }else{      wx.showToast({        title: '加载中',        icon: 'loading',        duration: 500      });      var page = this.data.page;      this.getList(page)    }  },  scrll: function(e){    var scrollTop = e.detail.scrollTop    if(scrollTop>600){      this.setData({        scrollTop: 1,        hidden: false             })    }else{      this.setData({        scrollTop: 1,        hidden: true          });    }  },  goTop: function(){    this.setData({      scrollTop:0,      hidden: true     })  }})大家可以看到首先我们需要用page()函数注册页面,然后在data里面定义一些初始化数据.onLoad是这个页面的生命周期函数,页面加载时会调用到它.我们在页面加载时调用了自定义的getList函数.这个函数接收两个参数,第一个参数是要加载的页面,第二个参数是布尔值,用来判断是下拉刷新调用的这个函数,还是页面加载时调用的这个函数!接下来onPullDownRefresh是小程序提供的下拉刷新函数,里面wx.showToast显示消息提示框,用来提示用户正在加载,loadMore是滚动到底部触发的事件.函数里面会检查是否已经加载了全部列表项,如果已经加载了全部列表项会return掉,如果数据库还有列表项,上拉到底部加载下一页!scrll函数是滚动时触发的函数,可以看到这个函数会判断滚动条位置是否大于六百,如果大于六百显示点击直达底部的按钮,如果小于六百隐藏直达顶部的按钮.同时会更新滚动条位置的参数.刚刚在讲wxml时已经讲过scroll-view组件设置竖向滚动条位置scroll-top设置项时如果参数一样,页面不会重新渲染,我们就是利用了这一点,如果要到达顶部,位置必定是'0',滚动时触发scrll函数,我们把位置信息设置为'1',因为滚动函数会反复触发,所以此时页面是不会渲染的.也就是说由于位置设置参数都是设置为'1'不变,导致scroll-top设置项不会生效为goTop函数的直达顶部(把参数变为'0'提供机会).最后就是直达顶部按钮的函数了,可以看到它是把位置信息变为'0',参数变化scroll-top设置生效,页面直达顶部.最后再通过改变hidden这个参数把自己(直达顶部按钮)给隐藏掉了!结尾ok,通过上面的步骤我们终于实现了下拉刷新上拉加载的列表页功能了,从上面我们可以看到微信提供的接口和api还是挺全面的,要实现一个功能总体来说要比原生js实现要简单一些!                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    零基础小程序开发系列《一》理论篇               公司的开发者之间互相分享自己开发的小程序及域名修改次数限制 ...                                                        原作者: hong26                    来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 让人头痛的小程序之『图片懒加载』终极解决方案                                                                                               "},{"title": "微信小程序 - dialog ", "author": "                  Rolan                  2017-12-2 00:22                ", "text": "                                                                                                                                                                                     实现了 标题,内容和按钮设置,可动态设置按钮,以及按钮点击事件的回调可作为component 使用直接上代码//遮罩的代码 <viewclass=\"uiComponent uiComponent_mask uiComponent_mask_{{uiComponent.mask.show &&'active'}}\" style=\"{{uiComponent.mask.style}}\" ></view> //dialog的代码<view wx:if=\"{{uiComponent.dialog.show}}\" class=\"uiComponent uiComponent-dialog uiComponent-dialog_{{ uiComponent.dialog.show &&'active' }}\" style=\"{{uiComponent.dialog.style}}\"  >  <view class='uiComponent-dialog-title txt-nowrap' wx:if=\"{{ uiComponent.dialog.title }}\">{{ uiComponent.dialog.title }}</view>   <view class='uiComponent-dialog-content' wx:if=\"{{ uiComponent.dialog.content }}\">{{ uiComponent.dialog.content }}</view>   <view class='uiComponent-dialog-btns' wx:if=\"{{ uiComponent.dialog.btns.length>0 }}\">      <view bindtap='uiComponent_dialog_btnclick' class='uiComponent-dialog-btn  txt-nowrap' wx:for=\"{{uiComponent.dialog.btns}}\" wx:key=\"{{index}}\" data-index=\"{{index}}\" style=\"width:{{1/uiComponent.dialog.btns.length*99.99999}}%;{{item.style}}\"><view>{{item.text}}</view></view>   </view> </view>/**显示或隐藏mask */UIComponent.mask = function (show=false,style='') {  var self = this;  self.setData({    'uiComponent.mask.show': show,    'uiComponent.mask.style': style  });}/** dialog *  按照界面,这里可排布的大概也就3个左右 * btns:[ *        { *          text: \"确定\", *          style: \"\", *          click: function(e, idx, btn){ *  *        }   *    } * ] *  *  * 调用例子  self.dialog({ show: true, title: \"111\", content: \"2222\", btns: [      {        text: \"确定\" ,        click: function (e, idx, btn){          self.toast(`选中了第${idx}个按钮`)        }      },      {        text: \"样式\",        style:\"color:white;background-color:green;\"      } ,      {        text: \"不能取消\",        click:function(e,idx,btn){            self.toast(\"不满足条件,不能取消\")            return false;        }      }    ]  }) * self.dialog({show:false}) */UIComponent.dialog = function (opt={}) {  var self = this;  let app = getApp();  opt = app.util.extend({},{    //默认有遮罩    mask:true,    show:false ,    //按钮组    btns:[    ],    title:\"\",    content:\"\"  },opt);   if (opt.mask){         self.mask(opt.show)   }  if(opt.show){    if (!opt.btns || opt.btns.length==0){      opt.btns=[        {          text:\"确定\"        }      ];    }  }  self.setData({    'uiComponent.dialog.show': opt.show,    'uiComponent.dialog.style': opt.style,    'uiComponent.dialog.btns': opt.btns,    'uiComponent.dialog.title': opt.title,    'uiComponent.dialog.content': opt.content  });  }/** * 所有的按钮touch事件都关注到这里 */UIComponent.uiComponent_dialog_btnclick=function(e){  var self = this;  var index = e.currentTarget.dataset.index;  var btns = self.data.uiComponent.dialog.btns;  var btn = btns[index];  var func = btn.click;  if (typeof func==\"function\"){    var ret= func.apply(self, [e, index, btn]);    if(ret!==false){ //click事件可返false禁止关闭dialog      self.dialog({        show: false      });    }  }else{    self.dialog({      show:false    });  }}/**截断为1行文字,超出...*/.txt-nowrap {  text-overflow: -o-ellipsis-lastline;  overflow: hidden;  text-overflow: ellipsis;  display: -webkit-box;  -webkit-line-clamp: 1;  -webkit-box-orient: vertical;}/* 遮罩层 */.uiComponent_mask{    height:0;width:0;transform:translateZ(0) translateY(-1);    transition: all .1s ;  }.uiComponent_mask_active{    height:100vh;width:100%;display:block;position:fixed;top:0;left:0;z-index:99;    background-color: rgba(0,0,0,.6);transform:translateZ(0) translateY(0); transition: all .01s ;  }/** dialog */.uiComponent-dialog{  display:none;}.uiComponent-dialog_active{  display:block;background-color: white;border-radius:8rpx;  width:70%;position:fixed;top:30%;left:15%;min-height:50px;}.uiComponent-dialog-title{  text-align: center;font-size: 14px;color:#808080;  padding:10px 5rpx 0 5rpx;}.uiComponent-dialog-content{  text-align: center;font-size: 16px;color:#202020;  padding:10px 5rpx;}.uiComponent-dialog-btns{  display:flex;align-items: center;text-align: center;justify-content: space-around;border-top: 1px solid #ccc;}.uiComponent-dialog-btn:first-child{   border-left: 0;}.uiComponent-dialog-btn{   font-size: 14px;padding:10rpx 0; border-left: 1px solid #ccc;}                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序--获取屏幕宽度及弹窗滚动与页面滚动冲突               微信小程序实现给循环列表点击添加类（单项和多项）                                                        原作者: jifsu                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序支付及退款流程详解【上】                                                      • 微信小程序支付及退款流程详解【下】                                                      • 小程序页面pv统计数过高导致页面转化率低  问题                                                      • 微信小程序公共组件的引用与控制                                                      • 微信小程序之自定义dialog组件                                                                                               "},{"title": "微信小程序工程化之持续集成方案 ", "author": "                  Rolan                  2019-11-1 00:52                ", "text": "                                                                                                                                                                                     本文作者：韩永刚360奇舞团 WEB前端开发高级工程师。本文将简单介绍一下持续集成的概念并手把手带你在你的微信小程序项目中完成属于你的持续集成方案。什么是前端工程化所有能降低成本并且能提高效率的事情总称为工程化。在前端项目中能够减少重复工作、扩展 javascript\\html\\css 本身的语言能力、解决功能复用和变更问题、解决开发和产品环境差异问题、任何时间任何地点生成可部署的软件、解决发布流程问题都属于前端工程化。什么是持续集成持续集成是前端工程化中的一部分是一种软件开发实践即团队开发成员经常集成他们的工作通常每个成员每天至少集成一次也就意味着每天可能会发生多次集成。每次集成都通过自动化的构建（包括自动化编译自动化测试自动化发布）来验证项目代码从而尽早地发现错误。Web项目持续集成怎么做Web项目的持续集成方案选择比较多并且相对成熟这里介绍一下 gitlab-ci 持续集成方案。这种方式的原理就是为项目在自己的 linux 服务器安装并注册 gitlab-runner注册会有一个 token 服务器上运行 gitlab-runner 后 runner 会轮询的发送带 token 的 http 请求给 gitlab ,如果 gitlab 有任务了（一般是 git push ）那么会把任务信息返回给 runner 然后 runner 就开始调用注册时选的 Executor 来执行项目根目录下的配置文件 .gitlab-ci.yml 执行后把结果反馈给 gitlab 。此时我们可以编写 .gitlab-ci.yml 脚本比如设定当 test 分支发生 push时自动运行测试用例、自动构建代码、自动将代码更新到测试人员在测的环境等任何你想在提测时需要做的事情。当 merge 到 master 时自动更新线上代码完成上线等各种你想在上线时做的事情。这里只要考虑的足够全面那么之后的项目开发你只需要 push 到对应的分支 gitlab-runner 会自动完成你想做的所有构建、提测、上线操作。减少重复工作这就是持续集成的意义所在。手把手教你完成小程序的持续集成方案小程序的持续集成可以继续使用 gitlab-ci 的方式但由于小程序的构建、提测、提交体验版等操作都需要依赖于 微信开发者工具 而微信开发者工具只有 Windows 和 Mac 版所以我们需要一台 Windows 服务器来运行 gitlab-runner 。1. 准备工作一台 Windows 服务器一个权限为 Maintainer 的 gitlab 项目2. 安装必要软件在这台 Windows 服务器上安装以下软件GitNode.js微信开发者工具3. 配置gitlab-runner1. 首先下载 gitlab-runnerhttps://docs.gitlab.com/runner/install/windows.html下载完成后将其移动到合适的路径后重命名为 gitlab-runner.exe2. 在 Windows 服务器中打开 powershell 并进入 gitlab-runner.exe 所在目录然后执行以下命令.\\gitlab-runner.exe register1. Please enter the gitlab-ci coordinator URL打开想要设置 CI 的 gitlab 项目进入页面 settings > CI/CD > Runners > Expand 找到 Set up a specific Runner manually 输入 Specify the following URL during the Runner setup: 下的地址2. Please enter the gitlab-ci token for this runner输入 Use the following registration token during setup: 下的token字符串3. Please enter the gitlab-ci description for this runner输入一个描述4. Please enter the gitlab-ci tags for this runner输入一个标签该标签对应该runner5. Please enter the executor这里输入 shell 就好此时刷新 gitlab 页面会新增一个 gitlab-runner3. 执行命令 install.\\gitlab-runner.exe install4. 执行命令 start.\\gitlab-runner.exe start此时刷新 gitlab 页面之前的 gitlab-runner 会更新为以下状态表示 gitlab-runner 配置完成已经可以开始工作。4. 修改gitlab-runner服务的登录账号由于 gitlab-runner 服务默认登录账号为 authority\\system 而这个账号在执行微信开发者工具命令行时会出现报错所以我们需要更改 gitlab-runner服务的登录账号为正确账号并重启该服务。右击计算机 -> 管理 -> 服务和应用程序 -> 服务找到 gitlab-runner 服务右击 gitlab-runner -> 属性 -> 登录 -> 此账号 -> 输入可以正确使用微信开发者工具命令行的账号和密码 -> 确定 -> 重启动此服务修改完成后账号会正确被更改5. 配置微信开发者工具使用你的微信账号登录开发者工具设置 -> 安全 -> 服务端口 -> 开启6. 配置.gitlab-ci.yml在项目根目录创建 .gitlab-ci.yml 文件并填写以下配置。stages: # 定义阶段用于执行任务  - build  - deploybuild_job: # 定义 build 任务名称可以随意命名只是为了方便理解和区分  stage: build # 该任务属于 build 阶段要严格与stages中定义的命名一致  only:    - master  tags: # tags 指定运行在哪个 Runner 上这里需要在我们刚注册的 Runner 运行和注册时的 mp_win7 匹配    - mp_win7  before_script: # 执行script之前的钩子    - whoami  script: # 执行下面脚本这里可以自定义配置您的构建任务    - echo \"build\" # 可以在这里执行您项目的构建编译操作deploy_job: # 定义 deploy 任务名称可以随意命名只是为了方便理解和区分  stage: deploy # 该任务属于 deploy 阶段  only:    - master  tags: # tags 指定运行在哪个 Runner 上这里需要在我们刚注册的 Runner 运行和注册时的 mp_win7 匹配    - mp_win7  script: # 执行下面脚本这里可以自定义配置您的部署任务    - C:\\software\\wechatDevTool\\cli.bat -u 0.1.0@\"$PWD\" --upload-desc 最新的描述 # 这里使用微信开发者工具提供的命令行工具进行上传体验版操作修改完成后将代码 push 到远程仓库会自动触发CI任务。此时登录微信小程序官网后台就可以看到刚刚 push 代码时由 gitlab-ci 自动上传的体验版了。有关 .gitlab-ci.yml 的详细配置方法可以参考以下文章。http://urlqh.cn/mK3tAhttp://urlqh.cn/mNjWs7. 持续集成项目方案以下为本人最近在做的 360瞭望台 小程序的持续集成方案您可以根据自己的需要加以改进并完成属于你的持续集成方案。由于编写 .gitlab-ci.yml 时需要用到微信开发者工具的命令行所以为了便于团队成员使用我开发了一个 node.js 脚本并发布为 npm 模块用于在 .gitlab-ci.yml 调用 Windows 虚拟机中的上传命令。约定团队开发流程开发新需求时创建 feature/0.5.1 (需求版本号) 分支当 push 代码时会自动触发 CI 任务并在虚拟机修改为 test 环境后提交体验版。发完测试报告后可以将小程序提审时我们需要将 feature/0.5.1 分支 merge 到 audit 分支此时会自动触发 CI 任务并在虚拟机修改为 production 环境后提交体验版。 audit 分支需要添加为受保护的分支不允许直接 push 代码如果审核没通过那么可以以 audit 为基础新建 feature/0.5.2 分支进行调整后重新 merge 到 audit 。当审核通过后我们需要将 audit 分支代码合并到 master 分支 master 分支应该永远与线上代码保持同步。相关资料http://urlqh.cn/mKi7Thttp://urlqh.cn/mJPCChttp://urlqh.cn/mIWRkhttp://urlqh.cn/mJoY2http://urlqh.cn/mLCIB                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    如何实现微信小程序图像剪切？代码拿去用不谢！               手把手教你避开组件cover-view的那些坑                                                        原作者: 奇舞周刊                   来自: 奇舞周刊                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发教程---创建第一个微信小程序 ", "author": "                  Rolan                  2017-6-21 00:54                ", "text": "                                                                                                                                                                                                                                                                 在安装完“微信Web开发者工具”之后通过开发者的微信扫码进入后如图。　　　　点击“添加项目”填入之前获得的AppID（无AppID可忽略）输入项目名称“Hello WXapplet”,选定本地文件夹作为项目目录。　　勾选“在当前目录中创建quick start项目”后点击“添加项目”按钮即已成功创建了我们第一个微信小程序项目——Hello WXapplet。 开发者工具操作与使用　　　　开发者工具界面基本分为四大区域：1区“顶部菜单”2区“导航菜单”3区“目录文件/模拟运行”4区“编辑/调试开发”、1区与2区是固定的。3区与4区会根据选择导航菜单区的不同功能或模式有所不同。　　1区“顶部菜单”“设置”是配置开发机运行程序时如何连接网络。“动作”是指“刷新”、“后退”、“前进”等操作主要在网页或界面调试时使用。“帮助”是Web开发者工具的版本与版权声明等信息。　　2区“导航菜单”是开发者经常使用的功能区。特别是其中的“编辑”与“调试”功能将是开发者使用最多的重要功能。  编辑功能　　点击编辑按钮出现如图所示的界面。　　原来的4区部分变成项目的文件列表区及对应文件的代码编辑区我们也称之为代码编辑器。　　代码编辑器现在支持4种文件的编辑：wxml、wxss、js以及json文件。代码编辑器还提供了较为完善的自动补全功能大大方便了开发者。　　代码编辑器也支持快捷键操作部分常用快捷键如下：　　　　Ctrl+End:移动到文件结尾　　　　Ctrl+Home：移动到文件开头　　　　Ctrl+i:选中当前行　　　　Shift+End:移动到行尾　　　　Shift+Home：移动到行首　　　　Ctrl+Shift+L:选中所有匹配　　　　Ctrl+D:选中匹配　　　　Ctrl+U:光标回退　　　　Shift+Al\tt+F:代码格式化　　　　Alt+Up,Alt+Down:上下移动一行　　　　Shift+Alt+Up,Shfit+Alt+Down:向上向下复制一行　　　　Ctrl+Shift+Enter:在当前行上方插入一行  调试功能　　调试功能是开发者检测代码结果实现与排查问题的核心工具如图。　　4区此时变成调试工具与输出区。模拟器将如实地模拟微信小程序项目在客户端的逻辑与操作表现绝大部分的功能与API调用均能在模拟器上正确呈现。　　调试工具与输出区的顶部是一行菜单分别是：Console、Sources、Network、Storage、AppData、Wxml、Senser最右边的扩展菜单项是定制与控制开发工具钮“┆”。　Console页：控制台信息页有两个作用：　1）开发者直接在此输入代码并调试。　　　2）显示小程序的错误输出。　　　Sources页：源文件调试信息页用于显示当前项目的脚本文件。　　　　注意：因小程序框架会对脚本文件进行编译工作在源文件页面中我们看到的文件其实是经过处理之后的脚本文件。所以我们编写的代码都被包含在define函数中。对于页面（page）的代码则在打包脚本文件尾部require函数会完成主动调用动作。　Network页：网络调试信息页用于观察和显示每个元素请求信息和套接字（socket）状态等网络相关的详细信息。　Storage页：数据存储信息页用于显示当前项目使用存储API(wx.setStorage或wx.setStorageSync)接口的数据存储情况。比如在Console中输入：wx.setStorage({key:\"name\",data:\"King\"}),则在Storage页面中就可以看到我们存储了一个Key-Value数据。　　AppData页：用于调试显示当前小程序项目此时此刻的应用具体数据实时地回显项目数据情况。我们可以在此处编辑修改数据反馈到当前界面上去。　Wxml页：用于帮助开发者调试wxml转化后的界面。通过这里的调试可以看到真实的页面结构及对应的wxss属性同时可通过修改对应的wxss属性在模拟器中即时查看修改后的情形。（类似chrome中开发者选项中的Element、IE开发者选项中的DOM Explorer） 项目功能　导航菜单区的“项目”功能用来显示当前项目的细节包括图标、AppID以及目录信息等。　                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...               微信小程序开发教程--线程架构与开发步骤                                                        原作者: 蔚蓝色幻想                   来自: 博客园                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发工具---常用快捷键                                                      • 微信小程序从使用到分析快速解析                                                      • 如何阅读一份代码？                                                      • 微信小程序开发教程--线程架构与开发步骤                                                      • 老胡--足球视频小程序开发之Tab切换                                                                                               "},{"title": "微信小程序解密微信运动数据 ", "author": "                  Rolan                  2017-7-21 00:30                ", "text": "                                                                                                                                                                                     微信小程序API-微信运动https://mp.weixin.qq.com/debug/wxadoc/dev/api/we-run.html#wxgetwerundataobject思路：wx.login获取的code请求获取的session_keywx.getWeRunData获取的iv,encryptData将它们一起发送到后台解密就行了。安全顾虑因为只是示例所以直接传递session_key了为了安全最好按照下图的方式加密后存储到redis中再传递key。小程序端代码get3rdSession: function () {    let that = this    wx.request({      url: 'https://localhost/login.php',      data: {        code: this.data.code      },      method: 'GET', // OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, CONNECT      success: function (res) {        var sessionId = res.data;        that.setData({ sessionId: sessionId })        wx.setStorageSync('sessionId', sessionId)        that.decodeUserInfo()      }    })  },  decodeUserInfo: function () {    let that = this    wx.request({      url: 'https://localhost/decrypt.php',      data: {        encryptedData: that.data.encryptedData,        iv: that.data.iv,        session: wx.getStorageSync('sessionId')      },      method: 'GET', // OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, CONNECT      // header: {}, // 设置请求的 header      success: function (res) {        let todayStep = res.data.stepInfoList.pop()        that.setData({          step: todayStep.step        });      }    })  },  onLoad: function () {    let that = this    wx.login({      success: function (res) {        let code = res.code        that.setData({ code: code })        wx.getWeRunData({//解密微信运动          success(res) {            const wRunEncryptedData = res.encryptedData            that.setData({ encryptedData: wRunEncryptedData })            that.setData({ iv: res.iv })            that.get3rdSession()//解密请求函数          }        })      }    })  }后台这使用的是官方PHP版本Demo：先处理login的请求login.php直接返回session_key然后再一起请求decrypt.php进行解密。login.php部分代码$appid = '你的appid';$appsecret = '你的appsecret';$url = 'https://api.weixin.qq.com/sns/jscode2session?appid='.$appid.'&secret='.$appsecret.'&js_code='.$_GET['code'].'&grant_type=authorization_code';$content = file_get_contents($url);$content = json_decode($content);echo $content->session_key;decrypt.php部分代码$pc = new WXBizDataCrypt($appid, $sessionKey);$errCode = $pc->decryptData($encryptedData, $iv, $data );if ($errCode == 0) {    print($data . \"\\n\");} else {    print($errCode . \"\\n\");}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)一霎云天                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发问答《五十四》同步请求授权 &  用户拒绝授权,重新调起授权 ... ...               微信小程序开发--倒计时60s获取验证码                                                        原作者: 风流三月1                   来自: csdn博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序实战--仿今日美食food                                                      • 黄秀杰实战教程--购物车动画与加减                                                      • xiaochun系列教程--自定义消息提示框                                                      • Python Flask小程序文件（图片）上传技巧                                                      • 微信小程序--获取微信运动步数的实例代码                                                      • 微信小程序AES解密失败                                                                                               "},{"title": "高考志愿导师小程序项目的开发过程全解析 ", "author": "                  Rolan                  2017-7-14 00:11                ", "text": "                                                                                                                                                                                     一、产品功能结构：首先我们需要做的是什么？哪些功能是用户需要的?原始草稿：基础功能：拓展功能：功能分为两部分基础功能、拓展功能。基础功能：提供完整的院校、专业、职业、批次线、排行、及一些常见的问答知识。拓展功能：在原有的基础上提供给用户一个高级的功能MBTI的职业测试、多个学校的对比根据考生的分数、成绩、省份智能推荐学校以及某个考试对目标大学的录取概率评估。学校、专业、职业是基础的三大版块在实现上要实现闭环。二、产品方案：可行性分析：1、框架（缺）2、数据（缺）3、人力（3人）5、设计（缺）6、种子用户（缺）做一个完整的APP的方案从人力与时间来看是不可能的。从多年开发经验来讲短时间开发一套系统是不大可能的(没三四个月不要扯淡)快速实现的话我们只能借助别人的框架。微信小程序是基于微信+类H5是一种不需要下载安装即可使用的应用它实现了应用“触手可及”的梦想用户扫一扫或搜一下即可打开应用。从开发成本来讲相比全套的移动端APP可以减少大量的时间。从用户来讲微信小程序有着微信的人群。几个人基本上都是java出身选择spring也是主流。数据来源于大鱼数据api平台。三、原型时间比较紧张实现的原型比较粗糙这里贴上程序的截图更多截图可以体验程序。四、开发计划三个人属于全栈工程师凡事都需要明确的分工大致的分配为纯前端页面编写1人后端接口业务及数据整合1人前后端打杂+设计+其他业务1人。下图为详细的任务安排计划表：五、过程问题没有计划就像一盘散沙说乱就乱。尽管大多数都在计划之中但是难免遇到问题。程序：1.本地图片不能做背景（background-image）2.最多5层页面（再多就报错）3.不支持jquery4.遍历展示列表时注意得赋wx:key值否则容易影响页面渲染（数据比较多的情况）5.系统自带的下拉刷新和App的下来刷新不同（前者基于标题栏底部而后者是基于列表顶部要用系统自带的下拉刷新得配置）6.不完全支持html标签的原有效果7.无法动态设置哪个页面作为第一个页面8.微信登录后的session超时管理比较繁琐9.由于Android系统限制目前还无法获取到按 Home 键退出到桌面然后从桌面再次进小程序的场景值对于这种情况会保留上一次的场景值。业务：1、小程序的申请耗费了3天微信支付又耗了差不多快一星期。2、提交代码进行审核又是周五导致脱到周二总共花了四天的时候就好比农民丰收却等不到小贩来收购一样。3、首页转发地址写错（相当于你分享出去的小程序没办法打开）提交之后也是四天就好比农民看着自己的蔬菜烂在土里。其实小程序可以提供一个紧急发布或者是回滚的入口。总而言之加起来导致项目上线拖了快一星期时间错过了高考填报的最佳时机。六、运营由于目前还在运营中具体的结果尚未统计就不公布了。大致的运营计划由于篇幅问题只罗列部分内容：1、身边人推广：给自身亲朋好友、尤其是有在高考完的那些亲朋好友推荐（家长和考生）。适用于小型/创业公司的一张推广方式通过身边一些人群建立小范围口碑传播效应2、线下（二维码）推广：小范围地推如学校门口或附近小区3、网络推广（二维码）：软文推广 —— 现有平台+自建站群嵌入二维码广告；主要针对一些高考资讯平台针对性的广告平台推广——如广点通等寻找高考志愿相关的大站去针对性的植入广告4、微信群传播找那些成员年龄分布接近高中那些的微信群高校群、班级群、考生辅教群等一系列教育相关群人员众多的闲聊群5、微信搜索自身seo优化 —— 如命名、关键词6、QQ群广告、QQ加好友私聊7、贴吧、论坛软文8、大站平台分享微博朋友圈空间豆瓣脸书订阅号等9、小程序商店——可考虑刷榜排名领域：校园学校游戏学生老师家长维度：1、各大高校列表大概在3千左右个；2、中国区域包括县级区划数2852个（含860个市辖区、368个县级市、1453个县、117个自治县）、333个地级行政单位（含地级市、州）、4个直辖市、2个特别行政区、1个台湾省；由于微信小程序没有支持渠道的分析但是有可以生成带参数的二维码根据这个功能我们添加了一个渠道的参数用于识别用户渠道来源。对于用户的启动日志建议也进行收集。在首页Onload上进行收集小程序会有缓存当你推出去再进来短时间是不会触发的。七、总结计划赶不上变化我们不能左右别人的工作所以最好把时间安排的更从容点。像我们这样几个人疯狂的加班加点往往一辈子只能干几次毕竟太伤身体了。对我们的微信小程序感兴趣的话可以关注：高考志愿导师也可私信给我。也欢迎有志同道合的朋友微信交流：dayuapi123 路漫漫其修远兮吾将上下而求索！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序开发之视频开发 适配、禁止拖动进度               微信小程序开发问答《五十一》post请求服务器收不到参数 & 小程序ajax请求问题 ...                                                        原作者: 闲暇杂谈                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发—项目实战之聊天机器人                                                      • 独立开发微信小程序——“桌游聚乐会”项目实践上线                                                      • 微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...                                                      • 章鱼小程序项目开发总结                                                      • 微信小程序开发相关记录                                                                                               "},{"title": "微信小程序--动态添加分享数据、根据不同的id来进行设置和读取缓存 ... ", "author": "                  Rolan                  2017-6-15 00:38                ", "text": "                                                                                                                                                                                     动态分享数据：1、效果：2、.js代码：page({  /**   * 用户点击分享按钮或右上角分享   */  onShareAppMessage: function (res) {    var that = this;    return {      title: that.data.common.act_name,      desc: that.data.common.introduction,      path: '/pages/xiangqing/xiangqing?id='+that.data.id,      success: function (res) {        // 转发成功      },      fail: function (res) {        // 转发失败      }    }  }}）根据不同的id来进行设置和读取缓存作者：wy_Blog原文：http://blog.csdn.net/wy_blog/article/details/72991150本文是根据不同的id来进行设置和读取缓存是同步缓存的方式：jonNums.count 是接口返回的数据 是报名总人数 newNumber 新的报名总人数 - 缓存上次的报名总人数 = 新增报名人数[javascript] view plain copy print?onLoad: function (options) {     var that = this;     var activityId = options.activityId;     //报名表人数统计     wx.request({       url: domain + '/activityjoin/selectJoinCount',       data: { activityId: activityId },       method: 'GET',       success: function (res) {         var jonNums = res.data;         var newNumber = jonNums.count - wx.getStorageSync('jonNumsed' + activityId) //获取缓存         wx.setStorageSync('jonNumsed' + activityId, jonNums.count);//设置缓存         if (jonNums.count) {           activityId                 }         jonNums.joinCount = jonNums.count;         that.setData({ newNumber: newNumber, jonNums: jonNums })       }     })   },                                               .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序：canvas写字板效果               小程序实战入门 - 手机归属地查询                                                        原作者: PHP急先锋                   来自: 博客园                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序-隐藏和显示自定义的导航                                                      • 微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...                                                      • 微信小程序 监听手势滑动切换页面                                                      • 微信小程序数据处理                                                      • 小程序根据input输入动态设置按钮的样式                                                                                               "},{"title": "秀杰实战教程系列《四》：倒计时组件，LXStepper组件-商品数量加减 ... ", "author": "                  天下雪                  2016-10-18 16:22                ", "text": "                                                                                                                                                                                     一：倒计时组件：适用于电商应用的限时团购、商品秒杀等先来看下最终效果：git源：http://git.oschina.net/dotton/CountDown分步骤-性子急的朋友可以直接看最后那段代码。wxml文件放个text<text>second: {{second}} micro second:{{micro_second}}</text>在js文件中调用function countdown(that) {  var second = that.data.second  if (second == 0) {    // console.log(\"Time Out...\");    that.setData({      second: \"Time Out...\"    });    return ;  }  var time = setTimeout(function(){    that.setData({      second: second - 1    });    countdown(that);  }  ,1000)}Page({    data: {        second: 3    },    onLoad: function() {        countdown(this);    }});运行验证下从10走到1s然后显示时间到。于是继续将毫秒完善注意毫秒的步长受限于系统的时间频率于是我们精确到0.01s即10msjs/* 秒级倒计时 */function countdown(that) {  var second = that.data.second  if (second == 0) {    that.setData({      second: \"Time out!\",      micro_second: \"micro_second too.\"    });    clearTimeout(micro_timer);    return ;  }  var timer = setTimeout(function(){    that.setData({      second: second - 1    });    countdown(that);  }  ,1000)}/* 毫秒级倒计时 */// 初始毫秒数同时用作归零var micro_second_init = 100;// 当前毫秒数var micro_second_current = micro_second_init;// 毫秒计时器var micro_timer;function countdown4micro(that) {  if (micro_second_current <= 0) {    micro_second_current = micro_second_init;  }  micro_timer = setTimeout(function(){    that.setData({      micro_second: micro_second_current - 1    });    micro_second_current--;    countdown4micro(that);  }  ,10)}Page({    data: {        second: 2,        micro_second: micro_second_init    },    onLoad: function() {        countdown(this);        countdown4micro(this);    }});wxml文件<text style=\"display: block;\">second: {{second}}s</text><text>{{micro_second}}</text>如此当秒级运行完毕时毫秒级timer即clearTimeout并将字本显示为'micro_second too'再添加一个countdown4micro方法使得显示剩余 0:3:19 89这样形式的倒数function dateformat(second) {    var dateStr = \"\";    var hr = Math.floor(second / 3600);    var min = Math.floor((second - hr * 3600) / 60);    var sec = (second - hr * 3600 - min * 60);// equal to => var sec = second % 60;    dateStr = hr + \":\" + min + \":\" + sec;    return dateStr;}目前有2个时钟影响性能合并下去掉countdown于是countdown4micro变成以下的样子：function countdown4micro(that) {    var loop_second = Math.floor(loop_index / 100);    // 得知经历了1s    if (cost_micro_second != loop_second) {        // 赋予新值        cost_micro_second = loop_second;        // 总秒数减1        total_second--;    }      // 每隔一秒显示值减1; 渲染倒计时时钟    that.setData({      clock:dateformat(total_second - 1)    });      if (total_second == 0) {        that.setData({          // micro_second: \"\",          clock:\"时间到\"        });        clearTimeout(micro_timer);        return ;      }      if (micro_second_current <= 0) {    micro_second_current = micro_second_init;  }  micro_timer = setTimeout(function(){    that.setData({      micro_second: micro_second_current - 1    });    micro_second_current--;    // 放在最后++不然时钟停止时还有10毫秒剩余    loop_index ++;    countdown4micro(that);  }  ,10)}如此这般毫秒与时分秒是分别运行渲染的再次改造程序可读性更好。dateformat针对于毫秒操作而不接受秒为数。同时还省却了计算100次为1s的运算/**  * 需要一个目标日期初始化时先得出到当前时间还有剩余多少秒 * 1.将秒数换成格式化输出为XX天XX小时XX分钟XX秒 XX * 2.提供一个时钟每10ms运行一次渲染时钟再总ms数自减10 * 3.剩余的秒次为零时return给出tips提示说已经截止 */// 定义一个总毫秒数以一分钟为例。TODO传入一个时间点转换成总毫秒数var total_micro_second = 2 * 1000;/* 毫秒级倒计时 */function countdown(that) {      // 渲染倒计时时钟      that.setData({          clock:dateformat(total_micro_second)      });      if (total_micro_second <= 0) {          that.setData({              clock:\"已经截止\"          });          // timeout则跳出递归          return ;      }          setTimeout(function(){        // 放在最后--        total_micro_second -= 10;        countdown(that);    }    ,10)}// 时间格式化输出如3:25:19 86。每10ms都会调用一次function dateformat(micro_second) {      // 秒数      var second = Math.floor(micro_second / 1000);      // 小时位      var hr = Math.floor(second / 3600);      // 分钟位      var min = Math.floor((second - hr * 3600) / 60);      // 秒位    var sec = (second - hr * 3600 - min * 60);// equal to => var sec = second % 60;    // 毫秒位保留2位    var micro_sec = Math.floor((micro_second % 1000) / 10);    return hr + \":\" + min + \":\" + sec + \" \" + micro_sec;}Page({    data: {        clock: ''    },    onLoad: function() {        countdown(this);    }});经过如上优化代码量减少一半运行效率也高了。二：LXStepper组件-商品数量加减：适用于购物车商品数量的加减翻看了个文档微信没有提供现成的组件于是写了这个小widget。总体思路：最左边框最右边框由最后外层的容器的border-left与border-right设定；中间2段由input来设定；左右按钮不设边框圆角效果由最外面容器来设定这样刚好实现了一个耳熟能详的stepper样式。布局：1.1 准备一个容器view设置它的宽为width: 70px;height: 21px;边框颜色为#ccc灰色；圆角3px;1.2 内置3个组件分别是左text中input右text之所以不用button是因为系统自带的button带了样式为了遵守设计规范不去重写button的样式。其中input的默认高度是21px。宽度分别为19px30px19px之所以是19px是因为容器带了左右边距共占据了2px。1.3 3个组件都是文字居中text-align: center实现；垂直居中使用line-height: 21px来实现1.4 3个组件都是向左浮动由于我们计算好3个组件的宽度绝对值于是不必设定加号按钮的浮动float: right布局文件代码<!-- Stepper容器 --><view class=\"stepper\">    <!-- 减号 -->    <text>-</text>    <!-- 数值 -->    <input type=\"number\" value=\"{{num}}\" />    <!-- 加号 -->    <text>+</text></view>样式表代码/*stepper容器*/.stepper {    border: 1px solid #ccc;    border-radius: 3px;    width: 70px;    height: 21px;    margin:0 auto;}/*加号与减号*/.stepper text {    width: 19px;    height: 28px;    line-height: 21px;    text-align: center;    float: left;}/*数值*/.stepper input {    float: left;    margin: 0 auto;    width: 30px;    text-align: center;    font-size: 12px;    border-left: 1px solid #ccc;    border-right: 1px solid #ccc;}绑定事件2.1 准备两个按钮样式分别对应普通与禁用状态/*普通样式*/.stepper .normal{    color: black;}/*禁用样式*/.stepper .disabled{    color: #ccc;}还要准备一个data的值对象用于监测数值与状态的改变：data: {    num: 1,    minusStatus: 'disabled'}2.2 加号与减号事件2.2.1 绑定text事件bindtap分别是bindMinusbindPlus。按如下处理：取出data中的num值后作自增与自减对于自减操作要先判断是否大于1才做自减操作也就是说已经是1的时候就不要自减了2.2.2 当num已经为1的时候我们将减号按钮设置为disabled样式一旦大于1又变回normal状态加减事件均要如此处理不然到了临界值1的时候回不到normal状态js代码：bindMinus: function() {    var num = this.data.num;    // 如果只有1件了就不允许再减了    if (num > 1) {        num --;    }    // 只有大于一件的时候才能normal状态否则disable状态    var minusStatus = num <= 1 ? 'disabled' : 'normal';    // 将数值与状态写回    this.setData({        num: num,        minusStatus: minusStatus    });},效果如图注意减号是灰色的#ccc2.3 文本框输入事件2.3.1 在wxml文件中的\\<input\\>监听值变更事件bindchange=\"bindManual\"。注：bindchange是失去焦点才会调用一次的而bininput是每当有值有改变会有调用一次敲打123则会产生值112123三次比较适合于输入验证。2.3.2 实现bindManualbindManual: function(e) {    var num = e.detail.value;    // 将数值与状态写回    this.setData({        num: num    });}这个步骤看似多余实则为了num个数同步以作为提交到网络数据时是真正的data.num而不是input手工改写的数值                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    秀杰实战教程系列《三》：下拉筛选菜单WXDropDownMenu组件               怎么在小程序里添加想要的QQ音乐                                                        原作者: 秀杰                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 秀杰实战教程系列《八》：记账应用实战服务端之用户注册与登录基于Codeigniter3描述 ...                                                      • 秀杰实战教程系列《九》：应用实例教程服务端登录篇                                                      • 秀杰实战教程系列《十》：服务端实现账目CRUD                                                      • 秀杰实战教程系列《十一》：对接服务端账目CRUD                                                      • 秀杰实战教程系列《十二》：基于LeanCloud实现访问网络与数据存储 ...                                                      • 微信小程序电商常用倒计时                                                      • 微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...                                                      • 黄秀杰--小程序实现选择图片九宫格带预览                                                      • 微信小程序+WEB使用JS实现注册【60s】倒计时功能                                                      • 微信小程序开发--倒计时60s获取验证码                                                                                               "},{"title": "章鱼小程序项目开发总结 ", "author": "                  Rolan                  2017-7-8 00:31                ", "text": "                                                                                                                                                                                     章鱼活动平台浙江本地活动的优选平台。章鱼平台包含的功能很多包括活动的创建与发布、优质的活动的筛选、活动的报名与审核、自定义门票、线下扫码签到等一系列功能。本人主要负责章鱼活动pc端用户主页部分、小程序的开发及后期的h5版的迭代与升级。这里主要是介绍章鱼小程序开发的总结与一些心得希望能与大家分享（很想把源码推上来的由于是公司项目有保密协议没法直接推上来对源码有兴趣或者有需要可留言私密我）。项目基础框架选型 wxpageWXPage 是一个极其轻量的微信小程序开发框架其中的API蕴含了“极致页面打开速度的思想”为可维护性与开发效率而设计的功能框架来自“腾讯视频”小程序的项目沉淀。wxpage是在2016年年底去上海参加微信小程序的公开课的时候了解到的当时就对作者封装的onNavigate还是有onPreload特别感兴趣本人毕竟只是前端菜鸟所以作者的那些开发理念和做法确实是挺颠覆我的值得学习和借鉴的地方有很多所以这里墙裂推荐大家使用。用作者的说法是用这种方式可以做到'零秒打开页面'无空白等待的情况这里大致分析一下：小程序不同于h5的重要一点是小程序的js是运行在JSCore(安卓x5内核)中的所以这也是小程序可以原生媲美的原因之一也是小程序之所以能称为\"应用\"的原因之一。这样就导致用户打开应用的时候所有的页面的其实是算启动了这个时候页面之前是可以进行通信的。（不知道这么解释正不正确啊毕竟还是菜鸟希望有大牛帮忙补充）所以可以做的就是提前加载上一个页面加载下一个页面的数据然后保存起来下一个页面先去取能取到就无须再去请求若没取到（网络原因或其他原因导致没存储进来）则请求数据即可。拿我开发的这个小程序来说列表页点击进入详情是一个常见的情况：1用户点击的时候去请求数据（这个时候还没跳转到详情）这个时候会触发目标页面的onNavigate（扩展的生命周期）此时对应的叶页面并未被加载这个时候去请求数据然后通过$put存储起来2页面onLoad的时候先去$take数据若没取到则再去请求数据当然wxpage不仅仅只有这些它还有对页面、组件的扩展还有页面生命周期的扩展、自定义的函数属性等等大家可以参考wxpage的git主页有兴趣也可以去读下源码。项目的开发工具可以先吐槽下微信官方提供的小程序开发者工具当然现在大家看到的开发者工具算好很多但是还是有很多有缺陷的地方可是我是在小程序内测阶段的时候就开始玩小程序了那更不用说内测阶段时候的开发者工具了。当然吐槽归吐槽作为开发者要有一个包容的心毕竟他们在不断的完善开发者工具总是会越来越好。这里给大家介绍一款方便开发小程序的工具不是说这个工具有多好只能说能方便大家的开发。这个是白鹭时代（egret） 下面的一款产品（wing）去网站看你会发现这个主要是游戏编辑器但是也支持小程序的开发。不得不说白鹭时代很了不起有一系列优秀的产品有一套游戏开发的解决方案主要是国产的对！国产的！虽然并不是专业的游戏开发者但是对他们的产品有些些了解也参加过他们组织的小程序分享会觉得还是很腻害的一家公司。为何选择使用wing:1可自定义快捷键这是件很酷的事情想想就很酷；2配合官方的开发者工具一起使用最好是分屏wing负责代码的编辑官方开发者工具负责看效果和调试这样就无须在开发者工具中来回切换。3可以像很多编辑器那样split以上三点就可以让你像平时开发h5一样开发小程序大家可以先试着用下开发者工具大概就能了解我说的那些痛了。项目的管理comps:顾名思义components组件。我会把项目中通用的部分模块化组件化如通用底部、loading、章鱼形象、搜索框、门票、列表等。libs:用到的一些库wxParse:用于富文本解析。小程序不支持html里面的标签所以这里需要对富文本的内容进行解析生成能运行在小程序里的代码。感谢这样的人民工程师不然富文本解析这个让我一个菜鸟来解决的话估计得哭晕在厕所吧。(记得没错的话这个的作者是白鹭时代的开发)promise:小程序支持es6的大部分语法起初是支持promise的忘了是因为啥后来不支持所以这里得手动引入promise。wxqrcode:因项目需要把一串码生成一个二维码用户线下扫码。wxpage:前面说的项目基础框架pages:项目所涉及到的页面resource:用户放设计稿及项目相关文档便于项目开发。service:个人的习惯把所有的接口放在一个api.js文件进行管理这里还把自定义的公用函数放在里面然后还会有一个文件里面放的是项目的所有接口请求所有的成功通过回调的方式暴露出来。source:存放静态资源关于tab切换tab切换：很普通的需求点击tab切换下面的列表数据切换成对应的数据如下图可扫下面码体验：可能大部分能想到的就是和这位前端想到的处理方式一样吧切换就切换无非是换个标签切换一个tabpage从就1重新开始。可是如果用户反复的来回切换呢？之前请求的数据再请求一遍？第一个tab已经请求了第三个page了然后切换到第二个然后再切换回来呢滚动条的位置这么办？我的做法是这样的：每一个标签对应一个对象对象包含的数据有page、scrollTop、ifMore、active等属于当前标签的字段*active:标志当前标签是否被选中标志位（用于区分标签选中前后样式）*ifMore:列表请求回数据时若长度小于默认的pageNum则可判断无很多数据标志位用于显示'无更多数据'及减少无必要的请求*scrollTop:添加一个scrollListen事件记录各自移动的位置切换时直接定位到上次浏览的位置提示用户体验*page:存该标签当前所处的page避免重置成1重复请求对应的效果大家可以进入小程序体验下对应着h5可以看出明显的差别。项目总结此次小程序的开发独立完成且审核一次通过算是比较成功的吧。后来想了想原因应该是项目初期对于框架的选择和项目结构的搭建及细节的把握都做了比较足的工作这让我想起以前写作文的时候老师总让我们先列提纲我觉得拿到我们项目的开发中也是有道理的。先收集各种相关资料选定框架、理清自己的项目结构、项目中可能的难点、可优化的地方等等总之不是上来就开始写代码。此次开发对我成长有很大的帮助。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序版本的 Auto Draw               微信小程序加密数据解密算法Go版                                                        原作者: yuwanli                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发—项目实战之聊天机器人                                                      • 独立开发微信小程序——“桌游聚乐会”项目实践上线                                                      • 微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...                                                      • javascript/微信小程序中将String进行Base64编码并UTF-8格式输出                                                      • 高考志愿导师小程序项目的开发过程全解析                                                      • 微信小程序开发总结                                                      • 微信小程序开发总结                                                      • 《欢乐坦克大战》微信小游戏开发总结                                                      • 《腾讯大家》小程序开发总结                                                                                               "},{"title": "微信小程序小工具之下发短信验证码倒计时 ", "author": "                  天下雪                  2017-3-17 22:12                ", "text": "                                                                                                                                                                                                                                                                 目标： 按钮倒计时 步骤： 用户点击按钮提示下发短信按钮进行倒计时 代码： wxml<view><input type=\"number\" name=\"linkTel\" bindblur=\"blurTel\" value=\"{{agentTel}}\" placeholder=\"*手机号码\" maxlength=\"11\" />                                            .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (3)                鸡蛋                (6)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (9 人)ggzsh凉城Dna188591256yg123456Fatbirda394682817liwei2496chenmanguanjiali                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序开发之『弹出菜单』特效               ngrok 服务搭建内网穿透多张image图片排列有空隙解决方案                                                        原作者: ETL                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • ETL：微信小程序之小公举（小工具）：分页查询获取当前定位信息 ...                                                      • ETL：微信小程序之图片上传                                                      • 微信小程序+PHP：动态显示项目倒计时（格式：4天7小时58分钟39秒） ...                                                      • 微信小程序+WEB使用JS实现注册【60s】倒计时功能                                                      • 微信小程序开发--倒计时60s获取验证码                                                      • 短信验证功能的实现（附案例代码/前后端/直接用）                                                      • 微信小程序倒计时功能                                                                                               "},{"title": "微信小程序开发相关记录 ", "author": "                  Rolan                  2017-7-24 00:32                ", "text": "                                                                                                                                                                                                                                                                 1、获取位置的API这里是获取到位置并且打开地图定位到手机当前的经纬度坐标处wx.getLocation({  type: 'gcj02', //返回可以用于wx.openLocation的经纬度  success: function(res) {    var latitude = res.latitude    var longitude = res.longitude    wx.openLocation({      latitude: latitude,      longitude: longitude,      scale: 28    })  }})2、发起网络请求的APIconst requestTask = wx.request({  url: 'test.php', //仅为示例并非真实的接口地址  data: {     x: '' ,     y: ''  },  header: {      'content-type': 'application/json'  },  success: function(res) {    console.log(res.data)  }})requestTask.abort() // 取消请求任务3、根据经纬度坐标获取城市信息的接口地址（百度API）：http://api.map.baidu.com/geocoder/v2/?ak=百度API Key&location=32.12,120.5&output=json4、根据城市名称获取天气信息的接口地址：http://wthrcdn.etouch.cn/weather_mini?city=合肥5、页面js方法调用在微信API方法内调用另一个方法要首先获取到当前的页面如下图所示：var page = this;6、获取返回的Json值后可以在页面中直接.出对应节点的值如下图所示：首先创建数组7、使用模板API定义与引用创建模板8、利用循环获取模板并展示                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            小程序个人开发者的经验总结               微信小程序实战篇-个人中心                                                        原作者: 暖枫无敌                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序开发入门                                                      • 小程序开发之视频开发 适配、禁止拖动进度                                                      • 高考志愿导师小程序项目的开发过程全解析                                                      • 小程序个人开发者的经验总结                                                      • 微信小程序开发实例--仿麦当劳微信小程序                                                      • 微信小程序快速开发-食堂菜单案例                                                      • 微信小程序开发--倒计时60s获取验证码                                                      • 微信小程序入门bug--页面跳转js数据无法在wxml中出现                                                      • 小北微信小程序之小白教程系列之-- Hello World                                                                                               "},{"title": "研究了6个爆款小程序，我总结了产品增长的四大动因 ", "author": "                  Rolan                  2018-12-25 00:06                ", "text": "                                                                                                                                                                                     每次看见群里有人发小程序笔者就会想一个问题：是什么因素驱动着各种各样的小程序在微信里疯传？作者：独孤伤来源：鸟哥笔记本文为作者授权鸟哥笔记发布转载请联系作者并注明出处当你打开微信群会看到一个很少人发现的现象：图片和图文型的广告越来越少另一种形式的广告却越来越多。越来越多的是什么？答案是小程序。有号召你一起组队的有邀请你领红包的有让你给点赞助力的有吸引你抽奖的总之各种各样的小程序在微信群里传播俨然成了微信生态里的一道风景。每次看见群里有人发小程序笔者就会想一个问题： 是什么因素驱动着各种各样的小程序在微信里疯传？于是笔者深入研究了 6个曾经刷屏的爆款小程序 总结了 4个促使小程序增长的动因 分别是 游戏化、公益化、炫耀化、利益化 。我们一一来进行分析。01 游戏化游戏化是小程序初期爆发最主要的动因像我们熟知的跳一跳以及其他火爆的小程序就是以游戏化为主要增长驱动力的。那么游戏化是如何驱动小程序传播呢？主要有四个原因分别是 趣味、激励、排名、社交我们以猜画小歌小程序为例来进行说明。首先是趣味在猜画小歌里用户根据给的提示进行单笔作画由人工智能来猜测所画的是否是提示之物这个过程是非常有趣的因为用户一定会好奇自己画的能不能被识别这种期待感很容易吸引用户参与。其次是激励在猜画小歌里激励的形式是给予越来越高的等级而这些需要持续让人工智能猜对你所画的画来获得这叫荣誉激励而更多游戏小程序给予的激励是物质上的比如积分、红包、金币等这是因为物质奖励比精神奖励更能让用户坚持使用小程序。再者是排名排名的目的是 激发用户的竞争欲望 因为我们看到别人玩的比自己好段位比自己高会产生嫉妒心理于是就更加投入到游戏里努力升级直至超过别人在猜画小歌里也是如此其用等级和画图张数为排名标准以来刺激长尾用户更加活跃。最后是社交现在多数游戏小程序均有邀请好友组队或对抗的功能如猜画小歌新增加的“好友同玩”这显然是利用社交关系来促进小程序的增长即留住用户又增加用户一举两得。趣味、激励、排名、社交这四个原因综合在一起使游戏化成为小程序增长的首选利器值得好好研究和利用。02 公益化公益化驱动小程序增长是因为人们都有怜悯之心看见公益性的活动或需要帮助的事物会主动参与并且参与之后会觉得应该让别人知道自己做了好事显示自己有爱心。最能体现这一动因的案例是“中华田园犬”刷屏事件当时朋友圈都在传播显示“保护中华田园犬“的海报之所以会这样是因为当时杭州爆出”拒给中华田园犬配狗证“事件因为中华田园犬是禁止饲养的品种无法办理狗证。北京一家宠物公司看中这个热点发布了“保护中华田园犬”的小程序果然就引爆朋友圈大家纷纷转发以示支持而该公司也因该热点和公益化实现获客成为小程序增长的经典案例。03 炫耀化炫耀化是常见的刷屏动因无论是小程序还是其他形式比如网易的各种H5。为什么人们会愿意炫耀？这个问题很少人去思考笔者通过观察以此为动因的小程序和H5发现人愿意通过分享满足炫耀心理是因为里面有标榜自己的需求。这种需求满足的方式多种多样可以是测试题可以是个性操作甚至仅仅是输入自己的名字、生日或去过的地方只要得到的结果能够符合潜意识里对自己的认知。像西瓜足迹小程序当初能够一夜之间刷遍微信各个群和朋友圈就是因为用户仅需要选择到过的城市然后生成地图就能让用户产生“我竟然到过这些地方”的感觉满足对方的自恋心理。当然结果一定要是正向的如果是不好的结果也就不会被分享了因为这对用户来说没有任何意义。所以如果想通过炫耀化实现小程序的传播对于结果的描述就要好好下一番功夫。以上三个动因本质上是满足了人们的精神需求是单纯的利己心理。但是从传播的角度讲第4个动因即利益化才是最容易让人行动的毕竟钱的诱惑不是谁都能抵抗的尤其是当赚钱变得容易的时候。04 利益化所谓利益化即分享赚钱或邀请有奖这不是小程序独有的增长方式几乎任何一个产品都有这样的传播机制可以说是互联网产品的标配。这样的方式很容易快速起量毕竟没有人会和钱过不去。像名为“运动赚”的小程序产品名就彰显了意图就是让你赚钱而其产品功能的设计也把赚钱体现的淋漓尽致。比如每日签到提醒邀请好友得运动币；天天领红包自己得红包并且邀请好友开红包；幸运转盘中奖之后提示邀请好友赚钱等等。几乎每一处都在提醒你“赶紧邀请好友一起赚钱还等什么”。除了以运动为主题的赚钱小程序还有以问答为主题的小程序基本是同样的路数只不过提醒赚钱的入口就没那多了比如近期刷屏的“HOW好好”小程序。这是一个问答类小程序用户可以通过发问、回答、邀请好友等赚取金币1金币是1分钱可以提现每次最多可提现5元。就是这样简单的“赚钱”方式笔者以及身边的朋友都加入到“赚钱大军”在各群以及朋友圈分享小程序据说有大学生把一个月伙食费挣了出来当然笔者就没那么幸运只够买一瓶水。除了这种明目张胆告诉你“有钱赚”的增长方式代理机制则是小程序利益化增长策略的另一种体现。比如持续刷屏好几天的“面相研究院”其主打“人工智能测面相”充分利用人们对测面相这种古老卦术的好奇心狠狠地火了一把火到什么程度？小程序被封禁H5换了不知道多个地址。“面相研究院”玩法其实很简单用户只需要上传自己的正面照就可以得到面相测试报告报告里不单单对人脸进行解读还有事业运详解和情感解读不过需要额外花钱。这实际是一种炫耀化的增长玩法因为其产生的海报体现的是面相分数很符合炫耀心理毕竟如果自己的面相得分高肯定愿意晒出去。不过“面相研究院”并非这一种策略在其一处较深的入口隐藏“推广渠道招募”意即招募一些人专门推广它的产品而一旦成为其推广者可获得全部推广用户的收益层级不限上不封顶。什么意思？假如你推广了1个用户而经你推广的用户又拉来10个用户那么你可以获得11个人的收益而后面这些用户如果继续推广你的收益还将增加。这是一个很恐怖的裂变方式被称之为 “无限裂变” 。所以可以知道为什么它会持续刷屏了有“无限裂变”吸引着人们为其传播加上本身产品的传播性也很高（官方称分享率为50%）两者结合在一起让它没有离开用户的视线。可见利用利益化为动因促进小程序增长是一种绝佳的策略但是这样的策略是否能持久可能要打一个问号。毕竟对用户有利不代表产品就有价值从长远来看后者才是能否持续增长的关键无论这种产品的形态是不是小程序。总结小程序作为微信流量红利延续的重要产品具有非常高的价值这也是多数企业和创业公司或团队重点关注甚至all in的主要原因。作为运营人也有必要对小程序保持关注尤其是小程序的增长手段这对其他形成产品的增长有很深的借鉴意义。当然 任何产品的增长都应以对用户产生价值为前提 短期的让利并不会实现长期健康的增长毕竟通过这种方式吸引来的不一定是真正的用户。最后总结一下小程序的四大增长动因：游戏化：趣味+激励+排名+社交；公益化：怜悯显示爱心；炫耀化：标榜自己；利益化：分享赚钱代理机制。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)时代奇迹                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    百度10亿基金扶持生态2年的小程序市场又要燥起来了！               聊聊2018小程序这个迷宫                                                        原作者: 独孤伤                   来自: 鸟哥笔记                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序中利用时间选择器和js无计算实现定时器（将字符串或秒数转换成倒计时） ... ... ", "author": "                  天下雪                  2016-12-9 10:23                ", "text": "                                                                                                                                                                                     作者：这名字就是霸气；已经获得授权原文地址今天写小程序有一个需求就是用户选择时间然后我这边就要开始倒计时。因为小程序的限制所以直接选用时间选择器作为选择定时器的小时和分钟。唯一的缺点就是不能选择秒。一开始的想法是选择的到一个字符串以后截取字符串转换成数字然后和以前一样不停的计算。什么计算秒数换算成分数啊之类的想想虽然不难但还是太麻烦了。就想有没有简单易懂的实现方法。首先想到的就是js中的Date()因为这个函数可以传字符串获取毫秒数传毫秒数获取字符串。那么总体上来看应该是可行的。思路：首先我们的需求是用户需要通过时间选择器一个时间这个时间选择器传出来的就是一个类似\"12:25\"这样的字符串前面是小时后面是分钟我们需要把这个字符串转换成秒数才好进行倒计时。因为前面已经提到了Date函数那么我们需要的是将这个字符串转换成毫秒数。所以我们将字符串拼接并得到毫秒数：var endTime = new Date(\"1970/01/01 \"+time+\":00\");其中的time就是我们的时间选择器传出来的字符串了。前面的年月日你随便设置就行这个无所谓反正后面是要被截掉的。得到毫秒数以后我们就要开始倒计时啦。这时我们需要开启一个定时器这个定时器里面有什么内容呢？最为关键的就是利用Date函数来获取日期。（这不吃饱了撑的么刚换算成秒数你又要换算成日期？？？excuse me？？？别急继续往下看）然后需要一个countsetInterval每执行一次就+1聪明的同学应该到这里就清楚我们该怎么做了。没错请看：var count = 0;setInterval(function(){        var time = new Date(endTime.getTime()-1000*count++);        time = time.toString().substr(16,8);},1000); 但是这里有个问题就是时间到0了以后没有停止。那怎么办呢。这个时候我们的程序就要稍微改一下了。var count = 0;var intervarID = setInterval(function(){　　var time = new Date(endTime.getTime()-1000*count++);　　time = time.toString().substr(15,9);　　if(that.data.time == \"00:00:00\"){　　　　clearInterval(intervarID);　　}},1000);这样我们就完美的实现了一个定时器啦。下面上小程序部分的代码：   // 页面初始化 options为页面跳转所带来的参数      var endTime = new Date(\"2011/01/01 \"+options.time+\":00\");      //初始化定时器      this.setData({          time:options.time+\":00\"      });      //开始倒计时      var that=this;      var count = 0;     this.data.intervarID = setInterval(function(){         console.log(that.data.time + \" \" + count);         var time = new Date(endTime.getTime()-1000*count++);         that.setData({             count:count+1,             time:time.toString().substr(16,8)         });         if(that.data.time == \"00:00:00\"){             clearInterval(that.data.intervarID);         }     },1000);最后需要注意的是：在 iOS 上小程序的 javascript 代码是运行在 JavaScriptCore 中在 Android 上小程序的 javascript 代码是通过 X5 内核来解析在 开发工具上 小程序的 javascript 代码是运行在 nwjs（chrome内核） 中这ios和开发工具的内核在Date()  函数的输入上有一定的差别。开发工具上的支持2011-11-11这种格式但是ios的不支持所以就采用2011/11/11这种格式来书写代码（安卓未进行测试）好了最后我承认我是个标题党其实我还是计算了两下的。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序框架详解（直播分享）               实战：微信小程序支付开发具体流程                                                        原作者: 这名字就是霸气                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发--倒计时60s获取验证码                                                      • 写了一个时间管理的小程序                                                                                               "},{"title": "小程序分享及用户信息授权等接口能力的调整通知 ", "author": "                  Rolan                  2018-9-13 00:01                ", "text": "                                                                                                                                                                                     针对近期部分小程序接口能力使用不合理的情况微信公众平台将对下列能力进行调整。开发者可在最新版开发者工具内选择最新基础库版本体验。调整方案具体如下请开发者尽快完成适配。1、分享监听接口10月10日起新提交的版本用户从小程序、小游戏中分享消息给好友时开发者将无法获知用户是否分享完成也无法在分享后立即获得群ID。请参考调整指引2、getUserInfo接口10月10日起新提交的版本用户在小程序、小游戏中需要点击组件后才可以触发登录授权弹窗、授权自己的昵称头像等数据。请参考调整指引3、openSetting接口10月10日起新提交的版本用户在小程序、小游戏中需要点击行为后才可以跳转打开设置页管理授权信息。请参考调整指引微信团队2018年09月12日                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)walluedr80                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    iPad 支持使用小程序分包加载等能力升级               张小龙连接线下的初心未改支付宝小程序却也打起如意算盘 ...                                                        原作者: 微信团队                   来自: 微信公众平台                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序+OLAMI自然语言API接口制作智能查询工具--快递、聊天、日历等 ... ... ", "author": "                  黄眉毛                  2017-7-21 22:29                ", "text": "                                                                                                                                                                                          微信小程序最近比较热门再加上自然语义理解也越来越被人关注于是我想赶赶潮流做一个小程序试试。想来想去快递查询应该是一种比较普遍的需求。     如果你也在通过自然语言接口做点什么希望我的这篇博客能帮到你。感兴趣的朋友可以加入互通有无。或者你也可以直接下载代码试一试。     ----------代码下载：-------------GitHub代码下载CSDN代码下载----------------功能介绍： 我的小程序名字叫“智能生活宝”------------------------1. 通过自然语言对话查询     现在在微信里如果你参加一个什么活动一般都是在输入框里写上关键字或者数字这样才能获取你所需要的服务。而通过自然语言接口可以让用户像跟人对话一样和你的小程序对话。比如：    我要查快递帮我查一下快递查快递122343甚至直接输入快递运单号小程序就能做出相应的回应。2. 多功能查询   目前支持快递查询聊天日历查询菜谱查询讲笑话讲故事计算算24点功能。原本我只是准备支持快递查询功能后来发现OLAMI开放平台有许多内置的模块于是也顺便添加了一下。----------------功能展示：------------------------------------------------------------------------1. 快递查询页面如下图所示只要在下方的输入框中输入查询句子就会在text控件中返回结果。也可以点击“例句”按钮和“更换例句”按钮体验一下。       2.  点击例句后的效果图触摸例句就会在text控件中看到效果。3.  输入语句： “查询中通快递765325527325”4.  点击更换例句按钮可以更换例句5.   其他模块体验     点击左下角的切换按钮会发现右下角的查快递变成了“聊天”。   6.  点击“例句”按钮这时候例句里就是其他模块的例句了。     7.  同样可以通过“更换例句”按钮进行例句更换8.  查日期9. 讲笑话10.  查菜谱----------------开发步骤----------------------------------------1.  微信小程序相关     首先要申请一个微信小程序公众号注意不是微信公众号然后仔细阅读小程序的框架和功能介绍。有些JS的功能小程序里是不能用的。我之前也没有做过JS但上起手来感觉还是很快的几乎没有太多阻碍。网上有很多教程我就不多说了。    网址： 微信小程序开发文档2. 快递查询的API接口     注意寻找合适的API接口时要选用支持https的访问接口微信小程序目前仅支持https的访问。 我选用的是快递鸟快递API里面的即使查询API因为免费嘛呵呵。而且每天可以访问3000次足够了。你需要自己注册获取自己的API key和商户ID。注意：注册之后需要在自己的账号界面申请对应的API接口才能使用免费的也要申请。如下图所示：3.  欧拉蜜（OLAMI）人工智能开发平台     这个非常重要决定了你能支持多少种模块多少种句子。毕竟这种接口看起来还是很复杂的总结一下我的心得： *  写语法    在使用自然语言语义API之前首先得写语法仔细阅读语法文档这个很重要。当然你也可以登录进去看看平台内置的语法是否符合你的要求如果只是为了测试完全可以先导入一个内置的模块试试。点击下图中的“进入NLI系统”。进入NLI系统之后点击“导入”按钮既可以看到内置模块选中添加即可如下图所示。每个模块的作用可以在NLI 自然语言语义互动系统 / 内置模块列表看到详细描述。    下图中是我的NLI系统里面有我自己写的快递模块\"expressage\"和添加了内置模块\"music\".2...创建应用配置模块    写好语法并发布之后后就可以创建自己的应用了并在应用里添加模块即可。我在配置模块的过程中发现OLAMI有内置的模块可以使用于是我创建了两个应用一个叫查询工具用来专门查询快递；另一个叫工具选了内置的模块。    为什么我没有将这些应用放在一起呢？因为我的快递模块语法中有一个会抓整个句子导致内置模块无法正常工作。    你如果想验证自己的功能是否可用可以点“测试”按钮测试一下看看。快递应用配置：   其他查询应用配置（这个语法完全不用自己写还有对应的输出结果很好用）：                  应用创建好之后你就可以查看OLAMI分配给你的Key信息这可是访问API接口的必备信息。         3.  访问API           如果你在你的应用中测试结果很满意也就是你要捕获的句子都支持那么就可以尝试调用API了。然后分析API的结果做出对应的回应。比如我的快递查询APP的语法通过modifier支持的四种功能如下表所示：      modifier含义modifier含义例句query输入的句子只是说要查快递没有提供快递公司名称和运单号我要查快递查一下快帮我查查快递呗query_num输入的句子中提供了运单号12112311111查一下运单号是123423的快递query_name输入的句子中提供了快递公司名称我想查圆通快看一下申通快递query_name_num输入的句子中提供了运单编号和快递公司名称查申通快递1122333我的语法中仅涉及了两个关键信息即两个slot,“expnumber”抓取快递单号,'expname'用来抓取快递公司的名称。因此当OLAMI 的API接口返回语法信息之后我只需要根据modifier的值就可以做出对应的操作而使用slot的值去快递鸟的API接口查询快递信息。我的快递APP功能逻辑如下：* 如果仅提供运单号则先用运单号查询快递公司编号如果快递公司编号有一个则直接用运单号和公司编号查物流信息。  如果有多个则请用户选择快递公司。* 如果提供运单号和快递公司则直接调用运单号+快递code接口查询。* 如果仅提供快递公司名称则记录并查询对应快递公司code,并请用户提供运单编号。 其他的查询功能因为用的是内置模块直接就有回复不需要我再去调用其他接口直接显示即可很有意思。----------代码下载：-------------CSDN代码下载                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发--倒计时60s获取验证码               微信小程序学习 动手撸一个校园网小程序                                                                                                                                                                /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序的Web API接口设计及常见接口实现                                                      • 微信小程序-配置开源接口                                                      • 万年历—Java计算感恩节是哪天？                                                      • JavaScript简单日历实现-小程序版                                                      • 小程序wx.setScreenBrightness/wx.getScreenBrightness接口测试                                                      • 微信小程序下订单件插（日历）                                                      • 微信小程序请求API接口PHPSESSID变化的解决方式                                                      • Serverless 打造智能微信小程序：图像识别分析文本                                                      • 看大神如何玩转微信小程序日历插件？                                                      • 一个同时支持移动端与小程序的聊天机器人                                                      • 微信小程序之物流状态时间轴                                                                                               "},{"title": "小程序的一些总结：画canvas和内嵌webview ", "author": "                  Rolan                  2019-1-2 00:04                ", "text": "                                                                                                                                                                                     做了一些小程序项目着重记录一下小程序内嵌webview以及小程序画canvas遇到的一些坑。小程序画canvas的坑第一个坑canvas无法画base64格式的二维码。需求：前端将一些动态数据以及动态生成的小程序二维码图片用canvas画出来最后生成且可保存的一张图片。前端显示二维码图片一般有两种方法：1.后端调用微信api直接返回的二进制数据到前端会乱码一般后端先将二进制数据转为base64格式数据然后返回到前端。若是当普通的图片显示只需要设置图片：<image src=\"data:image/png;base64,图片base64数据\"></image> 2.后台在服务器上将二进制数据保存为一张图片然后返回给前端一个二维码的绝对路径。若后台因为各种原因不好实现第2种且第1种方法微信官方的回复是：真机上小程序的canvas无法绘制base64格式的图片难道就无法在canvas里绘制二维码了？此时还有第3种方法就是利用小程序的文件系统 FileSystemManager.writeFile() Api将base64数据的图片写入到本地之后去操作这个本地的图片。第一步创建写入文件的文件夹mkdir() {    return new Promise((resolve, reject) => {        this.fs.access({ // 先判断有没有resource目录            path: `${wx.env.USER_DATA_PATH}/resource`, // wx.env.USER_DATA_PATH获取本地文件路径开发者工具是:\"http://usr\",真机是:\"wxfile://usr\"            success: (res) => {                console.log('access:',res)                resolve(res)            },            fail: (err) => {                console.error('access:',err)                // 不存在创建一个文件夹                this.fs.mkdir({                    dirPath: `${wx.env.USER_DATA_PATH}/resource`,                    success: (res) => {                        console.log('mkdir:', res)                        resolve(res)                    },                     fail: (err) => {                        console.error(err)                        reject(res)                    }                })            }        })    })}复制代码第二步将base64图片写入创建的文件夹writeBase64Image() {    return this.mkdir().then(() => {        return new Promise((resolve, reject) => {            this.fs.writeFile({                filePath: `${wx.env.USER_DATA_PATH}/resource/${this.openId}.png`, // 可以用openId来命名此图片                data: this.base64Code, //后台返回的base64编码的图片不需要加'data:image/png;base64,'                encoding: 'base64', // 存的文件类型的选择base64                success:(res) => {                    console.log('writeFile:', res)                    resolve(res)                 },                fail:(err) => {                    console.error('writeFile:',err)                    reject(err)                }            })        })    })}复制代码第三步获得图片的缓存临时地址如果是绝对路径的网络图片绘制图片前需要将图片缓存到本地如果是写入的本地文件则可以直接绘制。getImageSrc(src) {        return new Promise((resolve, reject) => {            // 如果是本地图片则直接返回;如果是网络路径的图片则先缓存到本地wx.getImageInfo或者wx.downloadFile获得本地临时路径            !src.includes('https') ? resolve(src) :                wx.getImageInfo({                    src,                    success(res) {                        resolve(res) // res.path:返回的临时路径                    },                    fail(err) {                        reject(err)                    }                })        })    },复制代码之后通过获得临时文件路径用canvas绘制图片。以前遇到这个问题绝对大多数的开发者都是采用后端返回图片绝对路径给前端而第3种则可以前端去做保存图片的事减少很多后端服务器的操作。第二个坑一些android机生成的canvas图片文字样式混乱尤其是华为P20哈哈真真是bug神机了。 小程序的canvas组件是原生组件原生组件脱离在 WebView 渲染流程外对于频繁绘制而机型又绘制较慢时就很容易样式错乱解决方法就是生成图片时给一定时间的延迟。// 在绘制canvas的回调里导出生成的图片如果是andriod则延迟500ms生成。如果500ms还会有样式问题那就增加延迟时间。ctx.draw(() => {    // some code    isAndroid && setTimeout(() => {        wx.canvasToTempFilePath({            // some code        })    },500)    // some code})复制代码第三个坑在ios上只能绘制显示的canvas元素若设置wx:if或hidden在初始化时必须是显示的。如果你想绘制一个隐藏的canvas元素(hidden=true)将这个canvas转为图片保存android下正常ios下则不会绘制canvas。其他的一些问题用css3的旋转动画在真机上没效果最好使用wx.createAnimation代替；canvas元素不能添加css动画会非常的卡即使使用wx.createAnimation代替也是很卡。这个官方文档也有提到。小程序内嵌webview的一些坑第一个坑判断是否在小程序环境内如果app的首页以及一些其他页面是服务端渲染那么官方的提供的方法并不一定能判断准确尤其在android下。如果想通过navigator.userAgent里的miniprogram字符串判断小程序我劝你还是放弃吧....真机下miniprogram字符串时有时无官方的回复永远都是这是最近出现的bug会在后续版本修复......// 在服务端渲染的页面下下面的方法无法保证准确的判断尤其在andriod下function ready() {  console.log(window.__wxjs_environment === 'miniprogram') // true}if (!window.WeixinJSBridge || !WeixinJSBridge.invoke) {  document.addEventListener('WeixinJSBridgeReady', ready, false)} else {  ready()}// 或者wx.miniProgram.getEnv(function (res) {  console.log(res.miniprogram) // true})复制代码解决：1.将小程序标识拼在web-view的src属性上<web-view src=\"https://XXXX.com?isMiniProgram=1\"></web-view>复制代码第二个坑微信浏览器和小程序会共用localStorage微信浏览器内访问的是正常的H5小程序内访问的是内嵌的webview下的H5很多时候需要这俩个环境各有不同的数据缓存区分功能。 而微信在某次更新后就开始共用微信浏览器和小程序的storage了也是哭哭啊。。。。解决：如果只是一个页面打开的后续页面间互相传递数据那么可以使用sessionStorage去临时缓存数据而不用localStorage。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    一款基于2B市场的反馈产品分析               微信小程序诞生两周年回顾小程序兴衰历程                                                        原作者:  我是好好                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序超实用组件：仿微信通讯录 ", "author": "                  Rolan                  2018-9-12 00:18                ", "text": "                                                                                                                                                                                                                                                                 效果图话不多说先上效果图因为是使用的手机录屏视频格式为MP4上传到文章时发现只支持图片还好电脑自动录屏功能所以简单的录制了一下完后又提示只能4M只能再去压缩图片所以画质略渣各位客官讲究的看看吧。特色功能介绍用户只需按照格式传入参数组件能够自动将参数按首字母分组简单方便；组件右侧首字母导航无需另外传值并且根据参数具体有哪些首字母显示（没有的咱就不要）；用户进行上下滑动时左右相互联动；点击右侧导航组件会相应的上下滚动。实现基础说到滚动当然少不了小程序的基础组件scroll-view该组件就是在此基础上实现的；监听组件scroll-view的bindscroll事件进而对组件数据进行操作即可完成。Wxml滚动区域<scroll-view scroll-y style=\"height:100%;white-space:nowrap;\" scroll-into-view=\"{{toView}}\" enable-back-to-top bindscroll=\"scroll\" scroll-with-animation scroll-top=\"{{scrollTop}}\">  <view class=\"list-group\" wx:for=\"{{logs}}\" wx:for-item=\"group\">    <view class=\"title\" id=\"{{group.title}}\">{{group.title}}</view>    <block wx:for=\"{{group.items}}\" wx:for-item=\"user\">      <view id=\"\" class=\"list-group-item\">        <image class=\"icon\" src=\"{{user.avatar}}\" lazy-load=\"true\"></image>        <text class=\"log-item\">{{user.name}}</text>      </view>    </block>  </view></scroll-view>简单说一下上述代码：根据小程序文档在使用scroll-view组件用于竖向滚动时一定要设置高度,你们可以看到我在代码中设置了'height:100%;'这就实现了组件的滚动高度是整个页面。但是请注意：很多同学会发现设置了高度100%后组件并没有效果这是因为你没有将页面高度设置为100%所以你还需在app.wxss中设置page的高度为100%其他的属性看文档就好我就不再多说；2.侧边字母导航<view class=\"list-shortcut\">  <block wx:for=\"{{logs}}\">    <text class=\"{{currentIndex===index?'current':''}}\" data-id=\"{{item.title}}\" bindtap='scrollToview'>{{item.title}}</text>  </block></view>3.固定在顶部的字母导航仔细的同学能发现在滚动时顶部有一个固定位置的字母导航其值对应滚动到的区域<view class=\"list-fixed {{fixedTitle=='' ? 'hide':''}}\" style=\"transform:translate3d(0,{{fixedTop}}px,0);\">    <view class=\"fixed-title\">      {{fixedTitle}}    </view></view>Wxss样式太简单了就不发了重点看js部分js拿到参数第一步当然是将参数列表渲染上去啦normalizeSinger(list) {    //歌手列表渲染    let map = {      hot: {        title: this.data.HOT_NAME,        items: []      }    }    list.forEach((item, index) => {      if (index < this.data.HOT_SINGER_LEN) {        map.hot.items.push({          name: item.Fsinger_name,          avatar:this.constructor(item.Fsinger_mid)          })      }      const key = item.Findex      if (!map[key]) {        map[key] = {          title: key,          items: []        }      }      map[key].items.push({        name: item.Fsinger_name,        avatar: this.constructor(item.Fsinger_mid)      })    })    let ret = []    let hot = []    for (let key in map) {      let val = map[key]      if (val.title.match(/[a-zA-Z]/)) {        ret.push(val)      } else if (val.title === this.data.HOT_NAME) {        hot.push(val)      }    }    ret.sort((a, b) => {      return a.title.charCodeAt(0) - b.title.charCodeAt(0)    })    return hot.concat(ret)  },将用户数据分为两大块即热门组和不热门组默认将参数的前10组归类为热门组然后对所以参数安装首字母进行排序分组。计算各组高度var lHeight = [],    that = this;let height = 0;lHeight.push(height);var query = wx.createSelectorQuery();query.selectAll('.list-group').boundingClientRect(function(rects){    var rect = rects,        len = rect.length;    for (let i = 0; i < len; i++) {        height += rect[i].height;        lHeight.push(height)    } }).exec();var calHeight = setInterval(function(){    if (lHeight != [0]) {       that.setData({          listHeight: lHeight       });    clearInterval(calHeight);  } },1000)在获取元素属性上小程序提供了一个很方便的apiwx.createSelectotQuery();具体使用方法请看节点信息API使用该方法获取到各分组的高度存入lHeight中用于之后滚动时判断使用；同学们可以看到我在将lHeight赋值给data的listHeight时使用了定时器这是因为获取节点信息api是异步执行的顾你直接进行赋值是没有效果的所以我使用了定时器功能；我觉得这里使用定时器不是最好的处理方式同学们有更好的方法请告诉我谢谢3.第三步就是在滚动的时候获取滚动高度相应的处理即可滚动使用到了scroll-view自带事件这个事件会返回滚动的距离及其方便const listHeight = this.data.listHeight// 当滚动到顶部scrollY<0if (scrollY == 0 || scrollY < 0) {  this.setData({    currentIndex:0,    fixedTitle:''  })  return}// 在中间部分滚动for (let i = 0; i < listHeight.length - 1; i++) {  let height1 = listHeight[i]  let height2 = listHeight[i + 1]  if (scrollY >= height1 && scrollY < height2) {    this.setData({      currentIndex:i,      fixedTitle:this.data.logs[i].title    })    this.fixedTt(height2 - newY);    return  }}// 当滚动到底部且-scrollY大于最后一个元素的上限this.setData({  currentIndex: listHeight.length - 2,  fixedTitle: this.data.logs[listHeight.length - 2].title})参数格式list:[    {        \"index\": \"X\",        \"name\": \"薛之谦\",    },    {        \"index\": \"Z\",        \"name\": \"周杰伦\",    },    {        \"index\": \"B\",        \"name\": \"BIGBANG (빅뱅)\",    },    {        \"index\": \"B\",        \"name\": \"陈奕迅\",    },    {        \"index\": \"L\",        \"name\": \"林俊杰\",    },    {        \"index\": \"A\",        \"name\": \"Alan Walker (艾伦·沃克)\",    },]如果你们还需要其他的参数对应的在后面加上即可。END如果想看完整代码请戳GITHUB欢迎star欢迎关注我的个人博客如果有疑问欢迎提问                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w小余45                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            小程序时间轴组件               JDC | 京东设计中心--小程序实战总结                                                        原作者: HEternally                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序通讯录功能实现思路分享                                                      • 微信小程序通讯录demo（校园教职工通讯录）                                                                                               "},{"title": "自学系列（零基础学小程序）---小程序实现简单的倒计时 ", "author": "                  天下雪                  2016-11-25 11:52                ", "text": "                                                                                                                                                                                     基本实现功能1从60到0的倒计时效果2倒计时完毕后 会有提示先看效果图其实实现代码很简单[JavaScript]<!--index.wxml-->  <view class=\"container\">   <text>倒计时: {{second}} </text>  </view>  下面是相对应得js处理[JavaScript] //index.js  // 从从60到到0倒计时  function countdown(that) {   var second = that.data.second   if (second == 0) {    that.setData({     second: \"60秒倒计时结束\"    });    return ;   }   var time = setTimeout(function(){    that.setData({     second: second - 1    });    countdown(that);   }   ,1000)  }     Page({    data: {      second: 60    },    onLoad: function() {      countdown(this);    }  });  源码地址：小程序简单实现倒计时效果.zip更多微信小程序优秀源码：https://github.com/qiushi123/xiaochengxu_demos也可以关注我的个人微信号每天定期推送小程序最新开发技术优秀源码各种干货关注上面微号回复1可以加千人小程序学习微信群群里和大家交流学习一起进步                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (3)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)luckydog77parrot32梦中剑神                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    娇娇jojojojo：微信小程序踩坑录：canvaspost请求页面刷新               水牛01248：flex布局学习笔记                                                        原作者: 邱石                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发--倒计时60s获取验证码                                                                                               "},{"title": "公司的开发者之间互相分享自己开发的小程序及域名修改次数限制 ... ", "author": "                  天下雪                  2016-12-14 13:07                ", "text": "                                                                                                                                                                                     今天遇到一个提问者问题是：如何让开发者之间互相查看对方的小程序其实网站里的知识稍微变通一下即可解决之但是因为还是比较实用的所以我还是简述一下：需求：手下有多个开发者需要随时看对方开发的效果；但是开发者没有上传权限无法上传预览；给管理员的话费时且比较繁琐；解决思路：      1：使用以下方法来申请测试用的账号账号有预览权限同时可添加体验者及开发者；            申请管理员：http://www.wxapp-union.com/forum.php?mod=viewthread&tid=495；            可申请数量说明：http://www.wxapp-union.com/forum.php?mod=viewthread&tid=1073      2：每个开发者都有一个或多个管理员账号互相将对方全部添加为体验者；           体验者教程：http://www.wxapp-union.com/forum.php?mod=viewthread&tid=1248      3：每次开发完毕只需要将版本上传至自己的测试用的管理员账号然后将体验用的二维码发布出来（或提交上去）即可；这个解决思路尤其适合需要做总结的公司可以将二维码直接放在总结内方便主管人员查看最新进展；（将主管添加至体验者即可）这个思路主要使用了体验者这个角色算是一个实用的综合运用。扩展使用：     问题二：一个月只有三次修改配置域名怎么办？                  解决思路基本同上                   1：申请多个管理员：2：测试时使用测试用管理员账号进行域名修改3：测试完毕集中更改正式用的管理员账号又是一个实用的小思路其实综合一下本站的一些新人分享可以方便自己的很多事情。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    使用小程序的scroll-view组件实现列表页               微信小程序开发之不能使用eval函数的问题                                                        原作者: 天下雪                   来自: 本站原创                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序公共组件的引用与控制 ", "author": "                  Rolan                  2017-12-1 00:14                ", "text": "                                                                                                                                                                                     思路：1.在组件wxml文件里实现布局、数据绑定、事件绑定；2.组件js文件里定义事件并将文件所有内容作为一个对象export出去；3.在引用的文件引入组件（方式有两种一个是用include引入一个是import引入详情：https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/import.html);4.数据传递。在引用文件对应的js里定义要传递的数据数据名称与组件wxml文件里的一致；5.函数映射。在引用文件对应的js里import组件js对象并将相应事件映射过来映射名须与函数名一致。 例子：公用组件为一个蒙版弹窗提示内容各页面也有差异以其中一个为例效果图：代码(样式部分的代码就不贴了=.=)1.componentswxml: (如果要用import方式引入组件则wxml文件需将template作为根元素) js: 定义了一个yesIKonw事件来控制关闭蒙蔽层 2.引用页面wxml: 通过include引入公共组件js: 定义要传递的数据值（flag、alertInfo）,并映射函数yesIKnow使得在引用页可控制蒙版组件的展示与隐藏。 PS：1.需在引用页的wxss文件里引入公共组件的样式wxss文件@import \"../components/promptBox/index.wxss\";2.蒙版样式：.mask {position: fixed;width: 100%;height: 100%;top: 0;background: rgba(0, 0, 0, 0.4);overflow: hidden;/* stylelint-disable */  //这个是禁止styleint检测的语句z-index: 1;}                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)sadgvs                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序初体验               小程序上传图片到七牛                                                        原作者: 南韵                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序getPhoneNumber快速获取用户手机号组件                                                      • 微信小程序：button组件的边框设置                                                      • 微信小程序添加视频video组件                                                      • 基本组件--(进度条、滑动选择器、开关选择器、复选框、)                                                      • 营销组件--大转盘\\刮刮乐\\老虎机\\跑马灯\\九宫格翻纸牌\\摇一摇\\手势解锁 ...                                                      • 截图组件welCropper实现原理及其使用                                                      • 小程序自定义评分组件（精确度0.1星）                                                      • 微信小程序 - dialog                                                      • 微信小程序组件 分页菜单带下划线焦点切换                                                      • 手把手教你实现微信小程序中的自定义组件                                                      • 微信小程序 引入公共页面的几种情况                                                                                               "},{"title": "手把手教你避开组件cover-view的那些坑 ", "author": "                  Rolan                  2019-11-1 00:32                ", "text": "                                                                                                                                                                                     以下内容转载自微信开放社区腾讯位置服务官方文章《手把手教你避开组件cover-view的那些坑》作者：腾讯位置服务链接: https://developers.weixin.qq....来源：微信开放社区著作权归作者所有。商业转载请联系作者获得授权非商业转载请注明出处。案例背景：最近在开发城市地铁图项目具体功能有规划路线、定位最近地铁站、以及显示整个城市的地铁网状图等功能。根据需求在实现的时候在地铁线路图上需要添加定位按钮及线路弹框来展示位置信息以及地铁站详情信息。遇到的问题：在地铁图调研初期原计划实现渲染方案是采用svg来绘制但是调研后发现小程序原生API不支持svg。同时我们在开源中找到一个svg的框架库来实现绘制但是开发初期发现遇到很多无法实现的需求和性能问题。在对开源库的代码跟踪后发现绘制方案也是canvas的方式于是我们决定使用原生canvas的方案来支持地铁图。但是呢又遇到一些问题那么我们来看看几个具体的点：        1) view在canvas上无法正常显示。在canvas上使用view来添加图片和弹框时发现图片以及弹框在canvas的下面不能正常显示图片。查看文档发现canvas、map、video等原生组件使用的是native实现的默认显示在小程序的最上层所以就把view换成cover-view或者cover-image。使用view效果：<!-- 线路 --><view class = \"sublines sublines-icon\"><image class = 'sublinesIcon' src = \"/static/img/ic_sublines.png\" bindtap = 'clickSublines' wx-if = \"{{lineIconShow}}\" ></ image > </view>替换成cover-view效果：<!-- 线路 --><cover-view class = \"sublines sublines-icon\"><cover-image class = 'sublinesIcon' src = \"/static/img/ic_sublines.png\" bindtap = 'clickSublines' wx-if =\"{{lineIconShow}}\"></cover-image></cover-view>但是使用cover-view又遇到了层级和样式的问题。2）canvas上使用cover-image添加图片图片设置position：absolute；页面上的图片显示在canvas画线的下方导致定位按钮不能正常使用。后来把position该换成fixed解决来层级的问题。效果如下所示：.locationIcon {    width: 3rem;    height: 3rem;    position: fixed;    bottom: 3rem;    left: 0.7rem;}3）在页面上实现一个弹框时根据UI图需要实现一个底边线和底边小三角形。通过border给块级元素设置底边线或者css实现三角箭头单边border设置无效。最终采用了height为1px的cover-view或者图片来代替。设置单边border效果：<!-- 起终点设置弹框 --><cover-view class =  \"sdMark\"  style =  'top:{{tapClient.y}}px;left:{{tapClient.x}}px;'  wx-if  =  \"{{sdMarkShow}}\">    <cover-view class = 'sdMarkContent'>        <cover-view class = 'sdMarkItem' bindtap = 'clickStart'>设为起点</cover-view>        <cover-view class = 'sdMarkItem' bindtap = 'clickEnd' >设为终点</cover-view>        <cover-view class = 'sdMarkItem' bindtap = 'clickStationDetail'>站点详情</cover-view>    </cover-view></cover-view>修改后的代码：<!-- 起终点设置弹框 --><cover-view class = \"sdMark\" style = 'top:{{tapClient.y}}px;left:{{tapClient.x}}px;' wx-if = \"{{sdMarkShow}}\">    <cover-view class = 'sdMarkContent'>        <cover-view class = 'sdMarkItem' bindtap = 'clickStart'>设为起点</cover-view>        <cover-view class = 'line'></cover-view>        <cover-view class = 'sdMarkItem' bindtap = 'clickEnd'>设为终点</cover-view>        <cover-view class = 'line'></cover-view>        <cover-view class = 'sdMarkItem' bindtap``= 'clickStationDetail'>站点详情</cover-view>    </cover-view>    <cover-view class = \"icon\">        <cover-image class = 'icArrow' src = '/static/img/ic_arrow.png'></cover-image>    </cover-view></cover-view>最终的效果：踩坑总结：canvas层级较高使用cover-view或者cover-image在canvas做操作。单边border相关的操作使用图片或者块级元素来代替。查看相关API文档：cover-view相关文档：https://developers.weixin.qq.com/miniprogram/dev/component/cover-view.html欢迎体验和吐槽：\"腾讯位置服务-地铁图\"插件：https://lbs.qq.com/miniprogram_plugin/subway.html                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序工程化之持续集成方案               node egg 微信支付服务                                                        原作者: 韶华                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序实现给循环列表点击添加类（单项和多项） ", "author": "                  Rolan                  2017-12-2 00:24                ", "text": "                                                                                                                                                                                     在微信小程序里面没有DOM对象, 不能操作DOM. 所有的操作通过数据来实现下面主要实现了给循环列表点击添加类的操作一、单项目标需求：实现下图给点击的view增加类每次只能选择一个。主要思路：给点击的view增加类依靠点击的index对state进行赋值。如果相同时给该view增加类。实现代码：.wxml文件 1 <view> 2   <view class='appointent-date'> 3     <view  class=\"appointent-date-div {{state==index?'active-tag':''}}\" bindtap=\"select_date\"  wx:for=\"{{dates}}\" data-key='{{index}}'> 4       <view class=\"flex-item\" > 5         <rich-text class='data_name'>{{item.data_name}}</rich-text> 6         <rich-text>{{item.name}}</rich-text> 7       </view> 8     </view>   9   </view>10 </view>.wxss文件 1 .appointent-date-div{ 2   display:inline-block; 3   width:20%; 4   text-align: center; 5   margin-top: 30rpx; 6 } 7 .flex-item{ 8   display: inline-block; 9   width:96rpx;10   height: 88rpx;11   font-size: 26rpx;12   border:2rpx solid #999;13   text-align: center;14   border-radius: 10rpx;15   color: #999;16   cursor: pointer;17   line-height: 30rpx;18 }19 .data_name{20   font-size: 36rpx;21   line-height: 52rpx;22   23 }24 .active-tag .flex-item{25   background: #c8321e;26   color:#fff;  27   border:1rpx solid #fff;28 }.js文件 1 Page({ 2  3   /** 4    * 页面的初始数据 5    */ 6   data: { 7     dates: [ 8       { \"data_name\": \"30\", \"name\": \"十三\"}, 9       { \"data_name\": \"1\", \"name\": \"十四\"},10       { \"data_name\": \"2\", \"name\": \"十五\"},11       { \"data_name\": \"3\", \"name\": \"十六\"},12       { \"data_name\": \"4\", \"name\": \"十七\"},13       { \"data_name\": \"5\", \"name\": \"十八\"},14       { \"data_name\": \"6\", \"name\": \"十九\"},15       { \"data_name\": \"7\", \"name\": \"二十\"},16       { \"data_name\": \"8\", \"name\": \"廿一\"},17       { \"data_name\": \"9\", \"name\": \"廿二\"},18       { \"data_name\": \"10\", \"name\": \"廿三\"},19       { \"data_name\": \"11\", \"name\": \"廿四\"},20       { \"data_name\": \"12\", \"name\": \"廿五\"},21       { \"data_name\": \"13\", \"name\": \"廿六\"},22       { \"data_name\": \"14\", \"name\": \"廿七\"}23     ],24     state:''25   },26   //选择日期后加样式27   select_date: function (e) {28     this.setData({29       state: e.currentTarget.dataset.key,30     });31   },32 }) 二多项目标需求：实现下图给点击的view增加类再次点击时取消可以多项选择。 主要思路：给dates数组增加一个属性state, 1表示状态选中,0表示未选中每次点击时修改active的值。实现代码：.wxml文件1 <view class='appointent-date'>2     <view  class=\"appointent-date-div {{item.state==2?'active-tag':''}}\" bindtap=\"select_date\"  wx:for=\"{{dates}}\" data-key='{{index}}'>3       <view class=\"flex-item\" >4         <rich-text class='data_name'>{{item.data_name}}</rich-text>5         <rich-text>{{item.name}}</rich-text>6       </view>7     </view>  8   </view>.wxss文件 1 .appointent-date{ 2   padding:10rpx 30rpx 40rpx 30rpx; 3   background: #fff; 4   box-sizing: border-box; 5 } 6 .appointent-date-div{ 7   display:inline-block; 8   width:20%; 9   text-align: center;10   margin-top: 30rpx;11 }12 .flex-item{13   display: inline-block;14   width:96rpx;15   height: 88rpx;16   font-size: 26rpx;17   border:2rpx solid #999;18   text-align: center;19   border-radius: 10rpx;20   color: #999;21   cursor: pointer;22   line-height: 30rpx;23 }24 .data_name{25   font-size: 36rpx;26   line-height: 52rpx;27   28 }29 .active-tag .flex-item{30   background: #c8321e;31   color:#fff;  32   border:1rpx solid #fff;33 }.js文件 1 Page({ 2  3   /** 4    * 页面的初始数据 5    */ 6   data: { 7     dates: [ 8       { \"data_name\": \"30\", \"name\": \"十三\", \"state\": 0 }, 9       { \"data_name\": \"1\", \"name\": \"十四\", \"state\": 0 },10       { \"data_name\": \"2\", \"name\": \"十五\", \"state\": 0 },11       { \"data_name\": \"3\", \"name\": \"十六\", \"state\": 0 },12       { \"data_name\": \"4\", \"name\": \"十七\", \"state\": 0 },13       { \"data_name\": \"5\", \"name\": \"十八\", \"state\": 0 },14       { \"data_name\": \"6\", \"name\": \"十九\", \"state\": 0 },15       { \"data_name\": \"7\", \"name\": \"二十\", \"state\": 0 },16       { \"data_name\": \"8\", \"name\": \"廿一\", \"state\": 0 },17       { \"data_name\": \"9\", \"name\": \"廿二\", \"state\": 0 },18       { \"data_name\": \"10\", \"name\": \"廿三\", \"state\": 0 },19       { \"data_name\": \"11\", \"name\": \"廿四\", \"state\": 0 },20       { \"data_name\": \"12\", \"name\": \"廿五\", \"state\": 0 },21       { \"data_name\": \"13\", \"name\": \"廿六\", \"state\": 0 },22       { \"data_name\": \"14\", \"name\": \"廿七\", \"state\": 0 }23     ]24   },25   //选择日期后加样式26   select_date: function (e) {27     var index = e.currentTarget.dataset.key;28     if (this.data.dates[index].state == 1) {29       this.data.dates[index].state = 0;30     } else if (this.data.dates[index].state == 0) {31       this.data.dates[index].state = 1;32     }33     this.setData({34       dates: this.data.dates,35     });36   },37 })赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 - dialog               3分钟实现小程序模版消息推送 | 基于Bmob后端云                                                        原作者: wxw婉                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 问答《三十九》循环列表点击时改变当前项的背景颜色                                                      • 小程序request接口的封装实现给循环列表添加点击样式                                                      • 微信小程序页面跳转navigator与传递参数循环列表添加点击事件和样式 ...                                                                                                                                                   0 条回复                                                                        \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                        推荐教程开发小程序折叠面板2020-02-16小程序对文件及后缀名解析2020-02-16小程序后端 egg 框架开发记录2020-02-16           最新Demo同城小程序代码2020-01-09汽车养护2020-01-07微信答题小程序仿头脑王者源码2020-01-02微信小程序图书共享借阅全套模板2019-12-10行政后勤服务小程序2019-11-28微信小程序--蓝牙控制音乐播放小车2019-11-15微信小程序--颜色选择器2019-11-13求小程序源码2019-11-04微信小程序--垃圾分类小程序2019-10-25            jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092507|8abfa30ca1ddcf13deca7b0b178a5c0d|2';\t\t\t\t\t\t"},{"title": "小程序页面pv统计数过高，导致页面转化率低  问题 ", "author": "                  Rolan                  2017-12-1 00:08                ", "text": "                                                                                                                                                                                     小程序页面pv统计数过高导致页面转化率低问题详细描述对于业务开发者来说业务数据和数据监控是不可缺失的。图例是我们小程序扫码付业务在数据体系搭建过程中的其中一步：技术流程拆解。技术流程拆解在数据选型上我同时使用了微信自定义数据统计和公司内部第三方数据统计并将之与微信主动上报的数据分析进行对比来确保数据准确性。微信自定义数据统计和公司内部第三方数据统计方法：自定义统计微信主动上报数据查询参见MP后台 微信实时统计:微信实时统计在数据的收集过程中我发现支付按钮点击率（点击支付次数/页面展示次数）仅有50%+。对比我们内部相同的H5服务转化率过低远远不符合我们对业务预期效果。核查3种数据分析我发现页面展示次数过高并且三种方法的页面展示次数有较大差异其中：    微信自定义数据统计pv(页面展示次数) 约等于 公司内部第三方数据统计pv（页面展示次数）    微信实时统计pv(页面展示次数) <  自定义数据统计 （包括微信自定义和公司内部第三方字数据统计）微信实时统计pv的统计方法不得而知而另外两种方法均是在onshow事件中触发。原因排查过程中发现页面在涉及到支付时微信调起弹窗会再次触发onshow事件从而导致pv数重复发送。对于微信来说支付完以后会触发支付完成页如图所示：支付完成页点击完成后再次回到页面会继续触发onshow事件。解决方案：从技术上来说onshow事件本应设计如此。页面再次展示应该触发onshow。从业务上来说onshow事件是应该用来做pv统计的。但因为涉及到类似支付的事情业务方需要自己控制pv发送时机。目前我的解决方案：onload中统计。image.pngps:问题虽小记录下来的意义更大。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序中吸底按钮适配 iPhone X 方案               连胜--小程序中滚动条的使用wx.pageScrollTo和<scroll-view>的对比 ...                                                        原作者: 陈小二_will                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序扫普通链接二维码打开小程序的具体配置流程                                                      • 小程序中吸底按钮适配 iPhone X 方案                                                      • 微信小程序支付及退款流程详解【上】                                                      • 微信小程序支付及退款流程详解【下】                                                      • 微信小程序 - dialog                                                                                               "},{"title": "微信小程序支付及退款流程详解【下】 ", "author": "                  Rolan                  2017-11-30 00:24                ", "text": "                                                                                                                                                                                     微信小程序支付及退款流程详解【上】中讲了微信支付的相关流程。在理清思路后流程还是比较清晰和简单的。重点在于需要注意一些细节问题例如数据格式加密方法等。下面说一下微信小程序退款的具体实现二.退款小程序退款的流程和付款相似但有一些细节上的不同。首先退款的步骤通常如下:用户前端点击退款按钮后后端接收到用户的退款请求通过商城后台呈现给商户商户确定允许退款后后端再发起向微信退款接口的请求来请求退款。后端向微信退款接口发送请求后得到响应信息确定退款是否完成根据退款是否完成再去进行改变订单状态等业务逻辑。退款的步骤相对微信支付来说比较简单。值得注意的有以下两点：1.向微信退款接口请求退款后根据得到的响应是可以直接确定退款是否完成的。不再需要设置专门的回调接口等待微信通知。当然如果需要也是可以在微信商户平台设置回调接口接受从而接受微信回调的但并不是必须的。2.退款请求需要在请求服务器安装微信提供的安全证书也就是说,发起退款请求相比较支付请求在请求时请求方法不能复用,因为微信退款需要携带证书的请求,此证书可在申请微信商户号成功后从微信商户平台自行下载Linux下的PHP开发环境的证书只需要放在网站根目录的cert文件夹中即可。其他开发环境可能需要导入操作。下面讲解一下退款的具体步骤一. 用户发起退款请求    用户在前端发起退款请求,后端接收到退款请求,将相应订单标记为申请退款,展示在后台.商户查看后,如果同意退款再进行相应操作.此后才进入真正的退款流程.二. 商户发起退款请求    商户同意退款后,后端即向微信提供的退款 API 发起请求.    同请求微信支付API一样.退款请求也需要将需要的参数进行签名后以XML发送到微信的退款API [https://api.mch.weixin.qq.com/pay/refund](https://api.mch.weixin.qq.com/pay/refund)退款请求需要的参数如下(多个参数在支付API请求时也有使用):小程序 appid。商户号 mch_id 。申请开通微信支付商户认证成功后微信发给你的邮件里有商户订单号 out_trade_no 。退款订单在支付时生成的订单号退款订单号 out_refund_no 。由后端生成的退款单号需要保证唯一因为多个同样的退款单号只会退款一次。总金额 total_fee 。订单总金额单位为分。退款金额 refund_fee 需要退款的金额,单位同样为分操作员 op_user_id .与商户号相同即可随机字符串 nonce_str 。同支付请求签名 sign 。使用上面的所有参数进行相应处理加密生成签名。（具体处理方式与支付相同可直接复用。）三. 退款完成    在发起退款请求后就可以直接根据请求的响应XML中的  result_code字段来判断退款是否成功从而对订单状态进行处理和后续操作。不需要像支付那样等待另一个接口的通知来确定请求状态。当然如上文所说如果需要微信服务器发送通知到后端的话可以到微信商户平台进行设置。    退款因为流程与支付大同小异因此退款的PHP类我选择了直接继承支付类代码如下注意区分退款请求方法postXmlSSLCurl和支付请求方法postXmlCurl的区别这也就是上文提到的退款需要的双向证书的使用。```` class WinXinRefund extends WeiXinPay{    protected \\$SSLCERT_PATH = 'cert/apiclient_cert.pem';//证书路径    protected \\$SSLKEY_PATH =  'cert/apiclient_key.pem';//证书路径    protected \\$opUserId = '1234567899';//商户号    function __construct($openid,$outTradeNo,$totalFee,$outRefundNo,$refundFee){    //初始化退款类需要的变量    $this->openid = $openid;    $this->outTradeNo = $outTradeNo;    $this->totalFee = $totalFee;    $this->outRefundNo = $outRefundNo;    $this->refundFee = $refundFee;} public function refund(){    //对外暴露的退款接口    $result = $this->wxrefundapi();    return $result;}private function wxrefundapi(){    //通过微信api进行退款流程    $parma = array(        'appid'=> $this->APPID,        'mch_id'=> $this->MCHID,        'nonce_str'=> $this->createNoncestr(),        'out_refund_no'=> $this->outRefundNo,        'out_trade_no'=> $this->outTradeNo,        'total_fee'=> $this->totalFee,        'refund_fee'=> $this->refundFee,        'op_user_id' => $this->opUserId,    );    $parma['sign'] = $this->getSign($parma);    $xmldata = $this->arrayToXml($parma);    $xmlresult = $this->postXmlSSLCurl($xmldata,'https://api.mch.weixin.qq.com/secapi/pay/refund');    $result = $this->xmlToArray($xmlresult);    return $result;}//需要使用证书的请求function postXmlSSLCurl($xml,$url,$second=30){    $ch = curl_init();    //超时时间    curl_setopt($ch,CURLOPT_TIMEOUT,$second);    //这里设置代理如果有的话    //curl_setopt($ch,CURLOPT_PROXY, '8.8.8.8');    //curl_setopt($ch,CURLOPT_PROXYPORT, 8080);    curl_setopt($ch,CURLOPT_URL, $url);    curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,FALSE);    curl_setopt($ch,CURLOPT_SSL_VERIFYHOST,FALSE);    //设置header    curl_setopt($ch,CURLOPT_HEADER,FALSE);    //要求结果为字符串且输出到屏幕上    curl_setopt($ch,CURLOPT_RETURNTRANSFER,TRUE);    //设置证书    //使用证书：cert 与 key 分别属于两个.pem文件    //默认格式为PEM可以注释    curl_setopt($ch,CURLOPT_SSLCERTTYPE,'PEM');    curl_setopt($ch,CURLOPT_SSLCERT, $this->SSLCERT_PATH);    //默认格式为PEM可以注释    curl_setopt($ch,CURLOPT_SSLKEYTYPE,'PEM');    curl_setopt($ch,CURLOPT_SSLKEY, $this->SSLKEY_PATH);    //post提交方式    curl_setopt($ch,CURLOPT_POST, true);    curl_setopt($ch,CURLOPT_POSTFIELDS,$xml);    $data = curl_exec($ch);    //返回结果    if($data){        curl_close($ch);        return $data;    }    else {        $error = curl_errno($ch);        echo \"curl出错错误码:$error\".\"<br>\";        curl_close($ch);        return false;    }}}三. 总结以上就是关于微信支付和退款的流程及相关知识的介绍。文中的 PHP类 均封装直接可用。因为微信支付和退款涉及的东西较为繁杂很多人直接看官方文档可能会一头雾水所以看过此文了解流程和要点后再去看微信官方文档。一方面可以更清晰的了解小程序的支付和退款流程。另一方面本文因为篇幅有限及作者能力有限肯定有无暇顾及或有所纰漏之处。为求稳妥还是需要多看看官方开发文档。毕竟事涉支付出个BUG可不是小事。最后扯点闲话吧。这篇博客本来应该在三个月前就发表的也算当时我从一无所知到独立完成微信小程序商城前后端的总结系列的第一篇。但是公司突然出现人员和项目的变动导致管理和项目上都混乱不堪再加上个人的惰性导致此篇博客一直拖到三个月后的今天才断断续续写完。这三个月我的心态因为各种事起起伏伏也颇有一番风味。借用李志的一句歌词结束这篇博客吧。下一篇是什么时候也说不定了我苦笑。我再也不会把自己愚蠢的交给过去。我的生活和我的想法从此相隔万里。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)100MHz                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序支付及退款流程详解【上】               微信小程序获取用户手机号详解                                                        原作者: 未曾见海                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序页面pv统计数过高导致页面转化率低  问题                                                      • 微信小程序 - dialog                                                      • 微信小程序与内嵌网页交互实现支付功能                                                      • 微信小程序开发之webview组件内网页实现微信原生支付                                                      • 微信小程序实现流程进度功能                                                      • Java 后端微信小程序支付demo                                                      • 5分钟解决小程序的微信支付                                                                                               "},{"title": "微信小程序日历选择-类似酒店预订方式有节日标识 ", "author": "                  Rolan                  2018-6-8 00:34                ", "text": "                                                                                                                                                                                     微信小程序的日历选择主要针对酒店选择时间段的日历带有公历的节日。主要函数： 通过选择入住与离店时间记录对应的时间段判断选择的开始时间和结束时间通过改变背影颜色连成对应时间段。  selectDataMarkLine: function () { let dateList = this.data.dateList; let { checkInDate, checkOutDate } = wx.getStorageSync(\"ROOM_SOURCE_DATE\"); let curreInid = checkInDate.substr(0, 4) + \"-\" + (checkInDate.substr(5, 2) < 10 ? checkInDate.substr(6, 1) : checkInDate.substr(5, 2));//选择入住的id let curreOutid = checkOutDate.substr(0, 4) + \"-\" + (checkOutDate.substr(5, 2) < 10 ? checkOutDate.substr(6, 1) : checkOutDate.substr(5, 2));//选择离店的id let dayIn = checkInDate.substr(8, 2) >= 10 ? checkInDate.substr(8, 2) : checkInDate.substr(9, 1);//选择入住的天id let dayOut = checkOutDate.substr(8, 2) >= 10 ? checkOutDate.substr(8, 2) : checkOutDate.substr(9, 1);//选择离店的天id let monthIn = checkInDate.substr(5, 2) >= 10 ? checkInDate.substr(5, 2) : checkInDate.substr(6, 1);//选择入店的月id let monthOut = checkOutDate.substr(5, 2) >= 10 ? checkOutDate.substr(5, 2) : checkOutDate.substr(6, 1);//选择离店的月id if (curreInid == curreOutid) {//入住与离店是当月的情况 for (let i = 0; i < dateList.length; i++) { if (dateList[i].id == curreInid) { let days = dateList[i].days; for (let k = 0; k < days.length; k++) { if (days[k].day >= dayIn && days[k].day <= dayOut) {              days[k].class = days[k].class + ' bgitem'; } if (days[k].day == dayIn) {              days[k].class = days[k].class + ' active';              days[k].inday = true; } if (days[k].day == dayOut) {              days[k].class = days[k].class + ' active';              days[k].outday = true; } } } } } else {//跨月 for (let j = 0; j < dateList.length; j++) { if (dateList[j].month == monthIn) {//入住的开始月份 let days = dateList[j].days; for (let k = 0; k < days.length; k++) { if (days[k].day >= dayIn) {              days[k].class = days[k].class + ' bgitem'; } if (days[k].day == dayIn) {              days[k].class = days[k].class + ' active';              days[k].inday = true; } } } else {//入住跨月月份 if (dateList[j].month < monthOut) {//离店中间的月份 let days = dateList[j].days; for (let k = 0; k < days.length; k++) {              days[k].class = days[k].class + ' bgitem'; } } else if (dateList[j].month == monthOut) {//离店最后的月份 let days = dateList[j].days; for (let k = 0; k < days.length; k++) { if (days[k].day <= dayOut) {                days[k].class = days[k].class + ' bgitem'; } if (days[k].day == dayOut) {                days[k].class = days[k].class + ' active';                days[k].outday = true; } } } } } } this.setData({      dateList: dateList }) },效果图：具体参见git仓库地址代码：https://github.com/kingbuwu/calendar作者：不会武术 链接：https://www.jianshu.com/p/047eb2004393 著作权归作者所有。商业转载请联系作者获得授权非商业转载请注明出处。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序的拖拽、缩放和旋转手势               微信小程序——使用setData修改数组中的单个对象                                                        原作者: 不会武术                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 简陋至极：微信小程序日历组件（思路）                                                                                               "},{"title": "微信小程序支付及退款流程详解【上】 ", "author": "                  Rolan                  2017-11-30 00:27                ", "text": "                                                                                                                                                                                     小程序的支付和退款流程\" style=\"margin: 10px 0px; padding: 0px; font-size: 28px; line-height: 1.5; color: rgb(51, 51, 51); font-family: Verdana, Arial, Helvetica, sans-serif; background-color: rgb(255, 255, 255);\">微信小程序的支付和退款流程近期在做微信小程序时涉及到了小程序的支付和退款流程所以也大概的将这方面的东西看了一个遍就在这篇博客里总结一下。首先说明一下微信小程序支付的主要逻辑集中在后端前端只需携带支付所需的数据请求后端接口然后根据返回结果做相应成功失败处理即可。我在后端使用的是php当然在这篇博客里我不打算贴一堆代码来说明支付的具体实现而主要会侧重于整个支付的流程和一些细节方面的东西。所以使用其他后端语言的朋友有需要也是可以看一下的。很多时候开发的需求和相应问题的解决真的要跳出语言语法层面去从系统和流程的角度考虑。好的也不说什么废话了。进入正题。一. 支付支付主要分为几个步骤：前端携带支付需要的数据(商品id购买数量等)发起支付请求后端在接收到支付请求后处理支付数据然后携带处理后的数据请求 微信服务器 的 支付统一下单接口后端接收到上一步请求微信服务器的返回数据再次处理然后返回前端让前端可以开始支付。前端进行支付动作前端支付完成后微信服务器会向后端发送支付通知（也就是微信要告诉你客户已经付过钱了）后端根据这个通知确定支付完成然后就去做支付完成后的相应动作比如修改订单状态添加交易日志啊等等。    从这几个步骤可以看出后端主要的作用就是将支付需要的数据传给微信服务器再根据微信服务器的响应确定支付是否完成。    这个流程还是蛮容易理解的。形象的说前端就是个顾客后端就是店家微信服务器的统一下单接口就像收银员。顾客跟店家说我是谁谁谁现在我要付多少多少钱给你买什么什么。店家就跟收银员说那个谁谁谁要付多少钱你准备收钱吧。收银员收到钱后就去告诉店家我已经收到钱了你给他东西吧。下面就详细的说明一下各个步骤的具体实现。1. 前端请求支付    前端请求支付就是简单的携带支付需要的数据例如用户标识支付金额支付订单 ID 等等跟 **你的业务逻辑有关** 或者跟 **下一步请求微信服务器支付统一下单接口需要的数据有关** 的相关数据使用微信小程序的 wx.request( ) 去请求后端的支付接口。2. 后端请求微信服务器    后端接收到前端发送的支付请求后可以进行一下相关验证例如判断一下用户有没有问题支付金额对不对等等。    在验证没什么问题可以向微信服务器申请支付之后后端需要使用 微信规定的数据格式 去请求微信的支付统一下单接口。微信规定的请求数据:这需要较多代码实现。因为需要的数据个数较多而且还需要加密并以 XML 格式发送。首先有以下数据是使用小程序支付必须提供给微信服务器的参数。小程序 appid。写小程序的大概没有不知道这个的。。。用户标识 openid。也就是用户的小程序标识在我上篇博客中说明了如何获取。商户号 mch_id 。申请开通微信支付商户认证成功后微信发给你的邮件里有商户订单号 out_trade_no 。商户为这次支付生成的订单号总金额 total_fee 。订单总金额很重要的一点是单位是分要特别注意。微信服务器回调通知接口地址 notify_url。微信确认钱已经到账后会往这个地址多次发送消息告诉你顾客已经付完钱了你需要返回消息给微信表示你已经收到了通知。。这个地址不能有端口号同时要能直接接受POST方法请求。交易类型 trade_type 。微信小程序支付此值统一为 JSAPI商品信息 Body。类似\"腾讯-游戏\"这种格式终端IP地址 spbill_create_ip 。终端地址IP也就是请求支付的 IP 地址。随机字符串 nonce_str 。需要后端随机生成的字符串用于保证数据安全。微信要求不长于32位。签名 sign 。使用上面的所有参数进行相应处理加密生成签名。（具体处理方式可见下文代码可直接复用。）在处理好以上所有数据后将这些数据以 XML 格式整理并以 POST 方法发送到 微信支付统一下单接口https://api.mch.weixin.qq.com/pay/unifiedorder 。3.后端接受微信服务器返回数据微信服务器在接收到支付数据之后如果数据没有问题其会返回用于支付的相应数据其中非常重要的是 名称为 prepay_id 的数据字段需要将此数据返回前端前端才能继续支付。因此在后端接收到微信服务器的返回数据后需要进行相应的处理最终返回到前端如下数据：appid 不需多说timeStamp 当前时间戳nonceStr 随机字符串package 就是上面提到的 prepay_id不过切记格式如 “prepay_id= prepay_id_item“。否则会导致错误。signType 加密方式一般应该是 MD5paySign 对以上数据进行相应处理并加密。到这里后端的支付接口已经完成了接收前端支付请求并返回了前端支付所需数据的功能。4. 前端发起支付​ 前端在接收到返回数据后使用 wx.requestPayment() 来请求发起支付。此 API 需要的对象参数各项值就是我们上一步返回的各个数据。5.后端接受微信服务器回调​ 前端完成支付后微信服务器确认支付已经完成。就会向第一步中设置的回调地址发送通知。后端的接收回调接口在接收到通知后就可以判断支付是否完成从而决定后续动作。​ 需要注意的是在接收到微信服务器的回调通知后根据通知的result_code字段判断支付是否成功。在接受到成功的通知后后端需要返回success数据向微信服务器告知已得到回调通知。否则微信服务器会不停的向后端发送消息。另外微信的通知是以XML格式发送的在接受处理时需要注意。​ 微信的大概支付流程就是这样。以下是PHP语法的微信支付类可以比照上面的步骤介绍加深理解。在需要支付时直接传入参数实例化此类再调用类的 pay 方法即可。//微信支付类class WeiXinPay{    //=======【基本信息设置】=====================================    //微信公众号身份的唯一标识    protected $APPID = appid;//填写您的appid。微信公众平台里的    protected $APPSECRET = secret;    //受理商ID身份标识    protected $MCHID = '11111111';//商户id    //商户支付密钥Key    protected $KEY = '192006250b4c09247ec02edce69f6a2d';    //回调通知接口    protected $APPURL =      'https://smart.afei.com/receivesuc';    //交易类型    protected $TRADETYPE = 'JSAPI';    //商品类型信息    protected $BODY = 'wx/book';    //微信支付类的构造函数    function __construct($openid,$outTradeNo,$totalFee){        $this->openid = $openid; //用户唯一标识        $this->outTradeNo = $outTradeNo; //商品编号        $this->totalFee = $totalFee; //总价    }        //微信支付类向外暴露的支付接口    public function pay(){        $result = $this->weixinapp();        return $result;    }          //对微信统一下单接口返回的支付相关数据进行处理     private function weixinapp(){         $unifiedorder=$this->unifiedorder();         $parameters=array(          'appId'=>$this->APPID,//小程序ID          'timeStamp'=>''.time().'',//时间戳          'nonceStr'=>$this->createNoncestr(),//随机串          'package'=>'prepay_id='.$unifiedorder['prepay_id'],//数据包          'signType'=>'MD5'//签名方式             );         $parameters['paySign']=$this->getSign($parameters);         return $parameters;     }    /*     *请求微信统一下单接口     */    private function unifiedorder(){        $parameters = array(            'appid' => $this->APPID,//小程序id            'mch_id'=> $this->MCHID,//商户id            'spbill_create_ip'=>$_SERVER['REMOTE_ADDR'],//终端ip            'notify_url'=>$this->APPURL, //通知地址            'nonce_str'=> $this->createNoncestr(),//随机字符串            'out_trade_no'=>$this->outTradeNo,//商户订单编号            'total_fee'=>floatval($this->totalFee), //总金额            'open_id'=>$this->openid,//用户openid            'trade_type'=>$this->TRADETYPE,//交易类型            'body' =>$this->BODY, //商品信息        );        $parameters['sign'] = $this->getSign($parameters);        $xmlData = $this->arrayToXml($parameters);        $xml_result = $this->postXmlCurl($xmlData,'https://api.mch.weixin.qq.com/pay/unifiedorder',60);        $result = $this->xmlToArray($xml_result);        return $result;    }   //数组转字符串方法   protected function arrayToXml($arr){        $xml = \"\";        foreach ($arr as $key=>$val)        {            if (is_numeric($val)){                $xml.=\"<\".$key.\">\".$val.\".$key.\">\";            }else{                 $xml.=\"<\".$key.\">.$val.\"]]>.$key.\">\";            }        }        $xml.=\"\";        return $xml;    }    protected function xmlToArray($xml){        $array_data = json_decode(json_encode(simplexml_load_string($xml, 'SimpleXMLElement', LIBXML_NOCDATA)), true);        return $array_data;    }        //发送xml请求方法    private static function postXmlCurl($xml, $url, $second = 30)    {        $ch = curl_init();        //设置超时        curl_setopt($ch, CURLOPT_TIMEOUT, $second);        curl_setopt($ch, CURLOPT_URL, $url);        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE); //严格校验        //设置header        curl_setopt($ch, CURLOPT_HEADER, FALSE);        //要求结果为字符串且输出到屏幕上        curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);        //post提交方式        curl_setopt($ch, CURLOPT_POST, TRUE);        curl_setopt($ch, CURLOPT_POSTFIELDS, $xml);        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 20);        curl_setopt($ch, CURLOPT_TIMEOUT, 40);        set_time_limit(0);        //运行curl        $data = curl_exec($ch);        //返回结果        if ($data) {            curl_close($ch);            return $data;        } else {            $error = curl_errno($ch);            curl_close($ch);            throw new WxPayException(\"curl出错错误码:$error\");        }    }    /*     * 对要发送到微信统一下单接口的数据进行签名     */    protected function getSign($Obj){         foreach ($Obj as $k => $v){          $Parameters[$k] = $v;         }         //签名步骤一：按字典序排序参数         ksort($Parameters);         $String = $this->formatBizQueryParaMap($Parameters, false);         //签名步骤二：在string后加入KEY         $String = $String.                                            .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 | 使用 canvas 生成朋友圈分享图片并保存到手机相册 ... ... ... ...               微信小程序支付及退款流程详解【下】                                                        原作者: 未曾见海                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序支付（微信支付）文档API列表：申请退款查询退款下载对账单 ...                                                      • 支付宝小程序PHP全栈开发--前端样式的设计.acss样式详解                                                      • 微信小程序支付c#后台实现                                                      • 微信支付新增企业付款到银行卡等功能                                                      • VIDE支持微信和支付宝小程序开发                                                      • 微信小程序 c#后台支付结果回调                                                      • 小程序页面pv统计数过高导致页面转化率低  问题                                                      • 微信小程序 - dialog                                                      • 微信小程序与内嵌网页交互实现支付功能                                                      • 微信小程序开发之webview组件内网页实现微信原生支付                                                      • 微信小程序实现流程进度功能                                                      • Java 后端微信小程序支付demo                                                      • 5分钟解决小程序的微信支付                                                                                               "},{"title": "微信小程序AES解密失败 ", "author": "                  Rolan                  2018-5-19 00:21                ", "text": "                                                                                                                                                                                     微信小程序分享群获取群id时后端接口返回“微信AES解密失败”后来定位到原因是服务端用于解密的session_key失效。用户获取到openID存在缓存后就不会每次login获取登录态了这样会导致登录态失效即后端维护的session_key失效。分享群后获取的加密信息是老的session_key+openId构成服务端解密时的session_key要和分享前一致。在需要获取openGid的页面：app.getOpenId(this.route, this.data.pageOptions).then((res) => {wx.login({success(res) {// 刷新服务端session_keyapi.ajax('GET', api.config_url.refreshWxUserSessionKey, {appId: api.appId,code: res.code,}).then(res => {const { status, message } = res.data;if (status) {console.log('登录态刷新成功');}}, res => { });}})// 其他业务逻辑app.js//获取openGidgetOpenGid(shareTicket, status, callback) {var self = this;wx.getShareInfo({shareTicket: shareTicket,complete(res) {var param = {\"iv\": res.iv,\"encryptedData\": res.encryptedData,\"appId\": self.appId,\"openId\": wx.getStorageSync(\"openId\")};self.getAesDecryptData(callback, param);}});},getAesDecryptData(callback, param) {const self = this;this.ajax('POST', this.config_url.aesDecryptData, param).then(res => {console.log(res);if (res.data.entry && res.data.entry.openGId) {wx.setStorageSync(\"openGId\", res.data.entry.openGId);callback() && callback();} else {console.log('获取群id失败');wx.login({success(res) {self.ajax('GET', self.config_url.refreshWxUserSessionKey, {appId: self.appId,code: res.code,}).then(res => {const { status, message } = res.data;if (status) {console.log('登录态刷新成功');}}, res => { });}});wx.removeStorageSync('openGId');}});},作者：东少回忆链接：微信小程序AES解密失败 - 东少回忆 - 博客园著作权归作者所有。商业转载请联系作者获得授权非商业转载请注明出处。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    (干货)微信小程序组件封装               微信小程序之无埋点函数调用监控                                                        原作者: 东少回忆                   来自: cnblogs.                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序端JS加密传输PHP端解密                                                      • 微信小程序后台解密用户数据                                                      • 微信小程序加密数据解密算法Go版                                                      • 微信小程序解密微信运动数据                                                      • 微信小程序加密数据解密的java实现                                                      • 微信小程序开发问答《七十七》encryptedData解密 & canvas 设置opacity：0无效 ... .. ...                                                      • JAVA版微信小程序用户数据的签名验证和加解密                                                      • 小程序的登录和数据解密全解析                                                                                               "},{"title": "小北微信小程序之小白教程系列之-- Hello World ", "author": "                  Rolan                  2017-10-11 00:37                ", "text": "                                                                                                                                                                                                                                                                 首先你要知道这是一套微信小程序入门级的教程原理、理念这些东西统统没有这里只有一样东西 -- 快速使用并开发。这个系列主要讲解后端工程师如何快速入门小程序.本篇为你讲解如何获得开发权限、工具等。先下个工具再说微信官方提供了一个小程序的开发工具经历了几个版本后已经很好用当然也很消耗内存现在提供windows和mac平台版本Linux暂时无缘。mac上的样子开发工具下载地址#获取小程序开发账号有很多能让你开发小程序的途径免费的和收费的一一说来。体验账号使用开发工具就可以新建体验类的小程序当然既然是体验类有些比如小程序的微信支付功能等是无法使用的供学习使用还是够的。建立体验项目很简单见下图。对的很方便。有服务类公众号如果你有一个服务公众号那么用你公众号的主体可以直接获得一个免费的小程序如果你的公众号申请了微信支付则小程序也可以申请支付功能不需要任何money。在上图AppID文本框内输入你的小程序AppID具体可以在公众号平台用你申请小程序时候设置的账号和密码登陆后得到。登录地址 mp.weixin.qq.com/如果你玩公众号则一定不陌生是一个登录框。##独立申请这个是最麻烦的流程也比较多要求和公众号申请差不多如果你需要微信支付等还需要交300元腾讯是和300干上了。申请地址 mp.weixin.qq.com/cgi-bin/reg…具体流程点击后一步一步来就好了。我推荐去注册一个服务号然后免费获得一个这样还多了一个公众号比较实在。Hello World学习一门语言第一步总是要写一个Hello World我来啦。按照上面的步骤进入到小程序编辑器页面你会看到默认的一些文件我们来一一说明下为了方便理解我们拿yii来对比说明下。由此我们总结如下当我们访问一个小程序页面它的路由是pages/controller/action对应的路径问/pages/controller/action.js业务逻辑实现写在具体的action.js内。不需要renderaction.js会主动的加载同级目录下的action.wxml 文件这就是视图。它里面就是类html标签只不过我们常用的div在这里变成了view你可以使用style也可以class。每个视图会主动加载同名的action.wxss就是css。只不过只能一级不能类似于 .box .title {}这样。app.wxss也会累加到action.wxml中。你可能会问model去哪了？我们只是对比学习但是小程序毕竟不是mvc你如果真有一些很公用的可以放到utils文件夹内然后require就可以。es6如果你对前端有一定了解则无需我多言小程序的js使用的就是es6的语法当然你如果不会也没关系会一些js也足以搞定。Hello World好接下来写一个hello world我们新建一个action页面并放到index控制器下。我们叫做hello新建后多了4个文件分别是hello.js / hello.wxml / hello.wcss / hello.json。并且开发工具对文件内容进行了一个初始化打开hello.js后我无需多言通过每个函数的备注你应该就知道了。因为我们只是显示因此我不打算动hello.js而是直接在视图里动手脚。如下图。视图样式好的接下来看看战绩。ok啦~是不是很简单我们完成了第一个小程序页面虽然它意义不大。跟着这个系列我们来一起了解小程序的方方面面。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (7)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (7 人)tw78871Gentlemanw(๑°3°๑30nicxzqZhiswd天下钞票yileiqweq                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序的日期选择器               小北微信小程序之小白教程系列之 -- 入口                                                        原作者: 北哥                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序开发入门                                                      • 小程序个人开发者的经验总结                                                      • 微信小程序开发相关记录                                                      • 微信小程序实战篇-个人中心                                                      • 小北微信小程序之小白教程系列之 -- 入口                                                      • 送给将要写小程序的你                                                      • 小北微信小程序之小白教程系列之 -- 样式（WXSS）                                                      • 微信小程序开发入门与实践                                                      • 小北微信小程序之小白教程系列之 -- 脚本语言（WXS）                                                      • 小北微信小程序之小白教程系列之 -- 项目实战（小乖猴助手小程序） ...                                                      • 小北微信小程序教程之 -- 实现完整的相册列表逻辑（小程序端&服务器端） ...                                                      • 小北微信小程序教程之 -- 下拉刷新和上拉加载                                                      • 小北微信小程序之--新建和编辑相册（小程序的表单提交）                                                      • 小北微信小程序之-- 添加照片（小程序图片上传功能）                                                      • 小北微信小程序教程之-- 上传视频                                                      • 小北微信小程序教程之-- 相册内容浏览                                                                                               "},{"title": "微信小程序入门bug--页面跳转，js数据无法在wxml中出现 ", "author": "                  Rolan                  2017-9-18 00:36                ", "text": "                                                                                                                                                                                                                                                                 微信小程序入门bugbug--描述：在实现页面跳转的时候js数据无法在wxml 中渲染（不知道这个词对不对有点逼格）没有出现要跳转页面的js//detail.js  var app = getApp()  Page({          /**           * 页面的初始数据           */          data: {                          message: 'Hello MINA!',                          info: {                                  title: \"ss\"                          }          },          /**           * 生命周期函数--监听页面加载           */          onLoad: function (options) {          },          /**           * 生命周期函数--监听页面初次渲染完成           */          onReady: function () {          },          /**           * 生命周期函数--监听页面显示           */          onShow: function () {          },          /**           * 生命周期函数--监听页面隐藏           */          onHide: function () {          },          /**           * 生命周期函数--监听页面卸载           */          onUnload: function () {          },          /**           * 页面相关事件处理函数--监听用户下拉动作           */          onPullDownRefresh: function () {          },          /**           * 页面上拉触底事件的处理函数           */          onReachBottom: function () {          },          /**           * 用户点击右上角分享           */          onShareAppMessage: function () {          }  }) wxml页面   class='detail'>  {{info.title}}  {{message}}12    探索过程：确定jsl文件有没有错误：我把要跳转的页面直接饭放在程序人口数据可以直接出来但是如果是通过点击链接跳转的话没有数据通过调试发现：发现其他页面的js没有写解决：补写其他页面的js,问题解决了                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序实战篇-个人中心               微信小程序使用Socket                                                        原作者: 灯下驼贼                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序开发入门                                                      • 小程序个人开发者的经验总结                                                      • 微信小程序开发相关记录                                                      • 微信小程序实战篇-个人中心                                                      • 微信小程序wxml数据绑定总结                                                      • 微信小程序的一级页面和二级页面设置                                                      • 微信小程序返回多级页面                                                      • 小程序页面跳转解析                                                      • 微信小程序实现淡入淡出效果（页面跳转）                                                      • 小程序 - 简单入门                                                      • 小程序bug监控工具                                                                                               "},{"title": "小程序开发入门 ", "author": "                  Rolan                  2017-7-14 00:40                ", "text": "                                                                                                                                                                                                                                                                 关于本文作者周林致力于Hybrid开发基础架构研究你可以在这里读到我的其他文章。本文中的很多架构思想并非是我个人的原创而是综合了多年架构工作经验的成果。特别感谢我的前领导谯洪敏对我的帮助你可以在这篇文章中了解到更多陆金所前端的架构知识。本文涉及代码Github地址: https://github.com/eeandrew/apps-lite小程序开发简介什么是小程序从技术实现的角度看小程序是融合原生和WEB特性的一套Hybrid混合开发框架。从原生能力上看每个小程序都有原生的路由管理每个页面都能监听部分原生App的生命周期同时暴露了特定的原生API。从WEB能力上看小程序支持绝大部分CSS支持Javascript的ES6语法同时借鉴了现代WEB框架的响应式开发理念提供了类VUE的model和view绑定机制。小程序技术基础小程序很新吗小程序本质上是一套Hybrid开发框架因此从技术上看小程序属于旧瓶装新酒。但是依托于微信这个超级平台在配合线下无数的轻量使用场景小程序推出的时机恰到好处。小程序横向对比小程序生命周期小程序生命周期包含两个方面一是小程序作为App从被用户打开到关闭需要经历的生命周期。一是每个页面从入栈到出栈需要经历的生命周期。App生命周期小程序的页面生命周期相对复杂一点如下图：页面生命周期小程序路由就我看来路由看似简单却是小程序最大的亮点因为它的路由是原生的。也就是说每个小程序页面都运行在一个新的原生容器中并且容器的切换是通过原生技术来实现(小程序的容器就是WebView)。Hybrid开发经历了这么多年对于一些简单页面用户已经很难分辨出这个页面是原生页面或者是WEB页面直到在页面切换时露出马脚。原生APP在路由切换时的流畅程度是WEB技术很难企及的。这一点应该为我们的Hybrid开发(WEB, ReactNative等)带来启示(我们会有一篇文章专门讲解RN和原生路由的融合敬请期待)。和原生App非常类似小程序的路由是通过栈来维护的页面切换可以直观的理解为容器的入栈和出栈。小程序路由注意 小程序只能同时打开5个页面也就是说路由栈里最多只能有5个容器。你可以通过redirectTo或者reLaunch来替换或者清空路由栈。数据绑定和重渲染小程序提供单向的Model到View的数据绑定和机制使用起来也非常简单。image.pngimage.pngimage.png小程序模板小程序只提供模板化开发不提供组件化开发支持在当今的前端组件化开发潮流下应该算是一个很大的倒退。模板开发非常简单具体可以参考这里的文档。这里只补充一点就是模板里面可以绑定事件。需要理解的是模板引用本质上是WXML的一个简单替换因此模板中数据的作用域取决于引用这个模板的Page页面。编写模板<template name=\"Hello\"><text bindtap=\"sayHello\" bindtap=\"sayHi\">{{message}}</text></template>使用模板<!--引入模板--><import src=\"../../templates/test/hello.wxml\"/><view ><!--使用模板--><template is=\"Hello\" data=\"{{message}}\"></template></view>绑定数据和事件Page({/*** 页面的初始数据*/data: {message: \"Hello MINA!\"},/*** 模板中绑定的方法*/sayHi: function () {wx.showToast({ title: 'Hello from MINA!',})},})小程序开发框架小程序只支持模板引用没有提供组件开发支持。这样的考虑不清楚是出于技术原因或是刻意限制小程序的规模。经过我们仔细甄选以下是我们推荐的两款小程序开发框架：wepylabrador这两款框架都支持组件化开发wepy提供了非常接近VUE的开发语法很适合以VUE作为开发框架的前端团队。labrador使用相对复杂一些适合喜欢折腾探究实现原理的小伙伴。然而对于团队而言我们不建议直接以这两款框架做为主力开发工具。原因之一这些框架的更新进度比不上小程序本身的更新进度。原因之二这些框架对小程序做了层次很深的二次封装在对小程序基本原理不理解的情况下很难针对性的对自己的小程序APP做好相应的优化和升级。我们建议团队应该对小程序有自己的探索和积累在有足够经验的基础上再引入第三方框架协助团队开发。当然了最好是针对公司业务给出一套定制化的解决方案。所以对于小程序的第三方开发框架我们的态度是：在对小程序开发有着足够经验的前提下对于大型项目可以考虑第三方框架对于中小型项目建议选择小程序的原生开发方式。至于怎样界定项目的规模则需要依靠架构师的经验了(不同架构师的界定标准可能会不一样)。作者：federerchou链接：http://www.jianshu.com/p/efadc9af953f來源：简书著作权归作者所有。商业转载请联系作者获得授权非商业转载请注明出处。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (3)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)黄大仙ramonqo50520                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序登录流程图               小程序个人开发者的经验总结                                                        原作者: federerchou                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 如何阅读一份代码？                                                      • 微信小程序入门实例之记事本                                                      • 腾讯云&搭建微信小程序服务                                                      • 微信小程序登录流程图                                                      • 小程序个人开发者的经验总结                                                      • 微信小程序开发相关记录                                                      • 微信小程序入门bug--页面跳转js数据无法在wxml中出现                                                      • 小北微信小程序之小白教程系列之-- Hello World                                                                                               "},{"title": "小程序个人开发者的经验总结 ", "author": "                  Rolan                  2017-7-15 00:50                ", "text": "                                                                                                                                                                                                                                                                 一、个人开发者公号的读者中大部分应该都知道我有一个小程序 [Github开源社区]。我简单的介绍下这个小程序：这是一个小程序版的 Github 社区目前功能比较简单主要包括了查看热门项目、登录 Github、点赞项目和搜索代码后续也将支持查看源代码和个人页等等的功能。那么今天我们来聊聊小程序的个人开发者。其实小程序的开发并不复杂官网上已经提供了完善的开发文档其中有组件和接口的汇总。所以复杂的是什么？「IDEA」对于开发者来讲IDEA 真心是一个很头疼的问题。在互联网的世界里面我想 idea 最多的就是产品和市场运营的人因为他们更专注于产品和市场在市场中挖掘用户的需求从而产生一个 idea再由技术人员完成开发。然而、如果让开发者自己产生一个 idea 就不是那么容易的一件事因为他们长时间专注于技术对这个互联网市场并不是很了解因此无法深入了解到用户的痛点。那么、开发者能产生最多的 Idea 是什么？「解决技术人员的痛点」因此我就有了这么一个 idea 将 PC 端的 Github 社区转移到小程序当中让我们可以随时随地查看 Github 上优秀的代码。二、验证想法大家可能对 「验证想法」并不是很熟悉。验证想法是我对自己的 idea 是否可行必做的第一步。我要去搜索当前市面上有没有这样的小程序了因为我可不想重复造轮子。大概在 5 月份的时候我去搜索 “Github” 相关的小程序在当时并没有一款此类的小程序。当然现在你去搜索的话已经出来一大堆了。在当时验证的结果来看我明确的知道小程序版的 Github开源社区在市面上并没有所以有戏。三、开发idea 有了而且市面上没有此类小程序那么就可以动手开发了。然而我并没有急于去写代码而是搜索目前市场上现有的移动端的 Github App 功夫不负有心人我找到了一款非常、非常优秀的 App CodeHub这是一款 iOS 上的 App同时它的代码托管在 Github 上：https://github.com/thedillonb/CodeHub这是一个将近 1W star 的开源项目就问你优不优秀。那么找到市场上现有的此类 App我就可以先去了解它的实现原理抓包、抓包、抓包。抓了一通之后各种业务的 API 就都出来。基于 CodeHub 的现有 API 一开始我是想直接在小程序里面直接访问 CodeHub 的 API然而小程序对域名校验十分严格最后我就用 Python 针对 CodeHub 的 API 做了一层封装将所有接口梳理出来并整合了一套自己的接口。源代码也托管在 Github：https://github.com/xiyouMc/GithubTrending-Mini-Program这样 Python 的 Github API 就有了。四、被坑Python 版 Github API 的 Server 有了那么这时候就需要去部署这个服务。当然一开始我并不清楚小程序的服务是怎么部署使用的然后我在小程序的后台看到了一条 ：一站式腾讯云小程序服务器 巴拉巴拉的。 我一想‘咦这不是很爽嘛。一站式搞定小程序后台’。然后我就跑去腾讯云后台买了一个月的小程序服务器。结果nmd各种服务都得付钱而且访问速度超慢。就这样没几天我就放弃了腾讯云也就被它“坑了”一个月的租金。五、部署服务我本人一直是有一个阿里云的服务器但当时一直没有发挥它的作用。我就趁着这次搞小程序服务器重新激活了阿里云。各种环境配上去最后将自己的 Python 服务挂上去。当时只是简单的挂在了服务器的一个端口上并将端口开放出来。当然是 http 访问的。然后我就拿着这个接口去小程序里面调用一把结果访问不了查了一堆资料之后发现在小程序里面必须使用 https 的接口。我就匆匆忙忙的跑回去申请备案拍照。大概过了一个礼拜终于通过了。我就兴高采烈的拿到 ssl 证书在阿里云上的 Nginx 将绑定 ssl 证书的域名反代理到对应的接口。终于大功告成：https://python.0x2048.com/v1/trending?since=daily这是一个获取当天 Github 热门的接口。六、开发小程序服务器的接口都已经开发且部署好了那么就可以开始动手编写小程序部分的代码了。当然我是一个没有前端开发经验的 Android 狗。也就只能沉下心来仔细查阅微信小程序的开发文档。看的差不多之后我就要开始编写代码。开发小程序最头疼的就是编写界面。再次强调我是没有前端开发经验的 Android 狗。界面部分一开始的想法也是直接抄 CodeHub 的那么要怎么抄上去呢？ 这时候我意识到了一个问题就是 CSS CSS 是写前端最麻烦且重要的一个模块。然后就开始查阅资料对 CSS 做了一个简单的入门。在自我感觉入门差不多的时候就开始编写小程序在开发的过程中会遇到很多界面上的问题这个对不齐那个位置不对。 总之那段时间我在 Google 上搜索最多的就是 这个、那个的 CSS 怎么写。大概零零散散的经历了一两周的时间「Github 开源社区」的雏形就出来了。然后我就再次兴高采烈的拿着这个版本去提交审核但提交中有一步是选择服务类型足足让我试了好几次不过还好每次提交之后他们的客服都会告诉我应该申请哪个类型最后就定位到了特殊人群教育。当然你也可以在这里查看具体的个人开发者服务类型：https://mp.weixin.qq.com/debug/wxadoc/introduction/#面向个人开发者开放的服务类目七、目前数据情况Github开源社区上线已经有一两个月了目前总用户数 4.4K每日新增大概保持在200左右。其实在我看来小程序的数据中重要的不是总用户数而是日活、每日新增和用户活跃度所以下次你在问别人小程序数据的时候就可以将重点放在新增和日活上面。这里帅气的我简单的抛几个数据出来供大家参考： 累计用户数、近30天访问趋势新增用户年龄分布分享次数看到这里是不是觉得这个小程序还不错呢？那么事不宜迟赶紧用起来。其次如果你有个人公众号那么不妨联系我将这个小程序绑定到你的公众号我们一起来玩玩这个小程序产品。八、总结其实吧我开发这款小程序的目的主要有如下几个： 1. 了解小程序的技术占个坑位认识更多的志同道合的开发者（包括你）和公众号绑定将用户从小程序导流到公众号最后才是为了方便开发者查阅代码（你敢信？）所以你的想法是什么？行为艺术要持之以恒iOS专用赞赏通道。 长摁‘识别二维码’一起进步生活不止眼前的苟且还有手下的代码、 和嘴上的扯淡 —— 个人博客: http://xiyoumc.0x2048.com Github:https://www.github.com/xiyouMc                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            小程序开发入门               微信小程序开发相关记录                                                                           来自: 极客头条                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序入门：相册选择拍照toast等弹框提示                                                      • 微信小程序入门：Flex布局                                                      • 快速了解微信小程序                                                      • 微信小程序新手入门之必胜客篇                                                      • 小程序开发入门                                                      • 微信小程序开发相关记录                                                      • 微信小程序豆瓣电影项目的改造过程经验分享                                                      • 微信小程序入门bug--页面跳转js数据无法在wxml中出现                                                      • 小北微信小程序之小白教程系列之-- Hello World                                                      • 前端开发微信小程序的个人经验总结–持续更新【原创】                                                      • 小程序--记一次低级并严重的开发失误                                                      • 微信小程序开发一些经验                                                                                               "},{"title": "微信小程序快速开发-食堂菜单案例 ", "author": "                  Rolan                  2017-7-15 00:08                ", "text": "                                                                                                                                                                                     （1）这是目录结构。 （2）只写了一个index页面。——这个页面的布局分为上下两部分。上面一部分是一个view里面嵌套了3个view用来切换tab的。——下面是内容区域。用了小程序的swiper控件swiper控件里面放置的是scroll-view控件。这里面设置的高度用的是百分比这存在一定的问题。不如CSS3可以混用百分比和数值来的方便虽然这种方式存在兼容性问题。——index.wxml。<view class=\"recipe_tabs\">  <view class=\"recipe_tab {{currentTab==0 ? 'recipe_tab_active' : ''}}\" data-current=\"0\" bindtap=\"swipeContent\">早餐</view>  <view class=\"recipe_tab {{currentTab==1 ? 'recipe_tab_active' : ''}}\" data-current=\"1\" bindtap=\"swipeContent\">午餐</view>  <view class=\"recipe_tab {{currentTab==2 ? 'recipe_tab_active' : ''}}\" data-current=\"2\" bindtap=\"swipeContent\">咖吧</view></view><swiper current=\"{{currentTab}}\" class=\"swiper_container\" bindchange=\"swiperChange\">  <swiper-item>    <scroll-view scroll-y style=\"height:100%\">      <view class=\"recipe_cell\" wx:for=\"{{breakfests}}\">        <image class=\"recipe_img\" src=\"{{item.RECIPE_IMG}}\"></image>        <view class=\"recipe_name\">{{item.RECIPE_NAME}}</view>      </view>    </scroll-view>  </swiper-item>  <swiper-item>    <scroll-view scroll-y style=\"height:100%\">      <view class=\"recipe_cell\" wx:for=\"{{lunches}}\">        <image class=\"recipe_img\" src=\"{{item.RECIPE_IMG}}\"></image>        <view class=\"recipe_name\">{{item.RECIPE_NAME}}</view>      </view>    </scroll-view>  </swiper-item>  <swiper-item>    <scroll-view scroll-y style=\"height:100%\">      <view class=\"recipe_cell\" wx:for=\"{{desserts}}\">        <image class=\"recipe_img\" src=\"{{item.RECIPE_IMG}}\"></image>        <view class=\"recipe_name\">{{item.RECIPE_NAME}}</view>      </view>    </scroll-view>  </swiper-item></swiper>（3）样式没什么好说的index.wxss。/index.wxss/page{  background-color: #EEEEEE;  height: 100%;}/* recipe_tab */.recipe_tabs{  background-color: #FFFFFF;  height: 7%;}.recipe_tab{  display: inline-block;赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发实例--仿麦当劳微信小程序               xiaochun系列教程--微信小程序 WeUi.wxss                                                        原作者: 喂-不吃素的熊宝宝                   来自: CSDN                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序实例--贪吃蛇                                                      • 微信小程序入门实例：2048                                                      • 微信小程序入门实例：navbar、swiper 应用                                                      • 微信小程序入门实例之记事本                                                      • 微信小程序实例--搜索电影app                                                      • 微信小程序开发实例--仿麦当劳微信小程序                                                      • 微信小程序开发相关记录                                                      • 微信小程序实现多折叠展开酷炫菜单                                                                                                                                                   0 条回复                                                                        \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                        推荐教程开发小程序折叠面板2020-02-16小程序对文件及后缀名解析2020-02-16小程序后端 egg 框架开发记录2020-02-16           最新Demo同城小程序代码2020-01-09汽车养护2020-01-07微信答题小程序仿头脑王者源码2020-01-02微信小程序图书共享借阅全套模板2019-12-10行政后勤服务小程序2019-11-28微信小程序--蓝牙控制音乐播放小车2019-11-15微信小程序--颜色选择器2019-11-13求小程序源码2019-11-04微信小程序--垃圾分类小程序2019-10-25            jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092508|9d9ea83d64b0e0571c3d45b51d4646cc|2';\t\t\t\t\t\t"},{"title": "微信小程序实战篇-个人中心 ", "author": "                  Rolan                  2017-8-5 00:06                ", "text": "                                                                                                                                                                                                                                                                 哈喽大家好又到周五啦有木有期待今天的更新呀~今天要教大家的是制作个人中心界面先上效果图个人中心制作1. mine.js// pages/mine/mine.jsvar app = getApp()Page({  data: {    userInfo: {},    motto: 'Hello World',    // orderItems    orderItems: [      {        typeId: 0,        name: '待付款',        url: 'bill',        imageurl: '../../images/person/personal_pay.png',      },      {        typeId: 1,        name: '待发货',        url: 'bill',        imageurl: '../../images/person/personal_shipped.png',      },      {        typeId: 2,        name: '待收货',        url: 'bill',        imageurl: '../../images/person/personal_receipt.png'      },      {        typeId: 3,        name: '待评价',        url: 'bill',        imageurl: '../../images/person/personal_comment.png'      }    ],  },  //事件处理函数  toOrder: function () {    wx.navigateTo({      url: '../order/order'    })  },  onLoad: function () {    console.log('onLoad')    var that = this    //调用应用实例的方法获取全局数据    app.getUserInfo(function (userInfo) {      //更新数据      that.setData({        userInfo: userInfo      })    })  }})1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515212345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152toOrder :事件监听跳转到我的订单界面 onLoad：在加载过程中获取用户的信息2. mine.wxml<!--pages/mine/mine.wxml--><view class=\"container\">  <view class=\"userinfo\">    <image class=\"userinfo-avatar\" src=\"{{userInfo.avatarUrl}}\" background-size=\"cover\"></image>    <text class=\"userinfo-nickname\">{{userInfo.nickName}}</text>    <image src=\"../../images/person/account_bg.png\" class=\"account-bg\">    </image>  </view>  <view class=\"separate\"></view>  <view class=\"order\" catchtap=\"toOrder\">    <text class=\"myorder-text\">我的订单</text>    <text class=\"myorderlook-text\">查看全部订单</text>    <image class=\"next-image\" src=\"../../images/person/next.png\"></image>  </view>  <view class=\"line\"></view>  <view class=\"navs\">    <block wx:for-items=\"{{orderItems}}\" wx:key=\"name\">      <view class=\"nav-item\" catchtap=\"toOrder\" data-type=\"{{item.name}}\" data-typeid=\"{{item.typeId}}\">        <image src=\"{{item.imageurl}}\" class=\"nav-image\" />        <text>{{item.name}}</text>      </view>    </block>  </view>  <view class=\"separate\"></view>  <view class=\"person-list\">    <view class=\"list-item\">      <image class=\"item-image\" src=\"../../images/person/personal_favorite.png\"></image>      <text class=\"item-text\">我的收藏</text>    </view>    <view class=\"person-line\"></view>    <view class=\"list-item\">      <image class=\"item-image\" src=\"../../images/person/personal_site.png\"></image>      <text class=\"item-text\">收货地址</text>    </view>    <view class=\"person-line\"></view>    <view class=\"list-item\">      <image class=\"item-image\" src=\"../../images/person/personal_sale_record.png\"></image>      <text class=\"item-text\">售后记录</text>    </view>    <view class=\"person-line\"></view>    <view class=\"list-item\">      <image class=\"item-image\" src=\"../../images/person/personal_evaluated.png\"></image>      <text class=\"item-text\">我的评价</text>    </view>    <view class=\"person-line\"></view>    <view class=\"list-item\">      <image class=\"item-image\" src=\"../../images/person/personal_share.png\"></image>      <text class=\"item-text\">推广邀请</text>    </view>  </view>  <view class=\"separate\"></view></view>赞赏 1人赞赏                                                                 邀请                                                                                                                                                                                      鲜花                (7)                鸡蛋                (13)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (20 人)w知行渐远35w正烨60wYWWY66w姚力85hello格林wO叶24scmsdbd萌小亮dzk1350506819redtxdtzpstorm冰姝jydqhy钱钱钱新宇huwenhua夏日清风onedropwaterwx_crab41chenhonglinpaty                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序开发相关记录               微信小程序入门bug--页面跳转js数据无法在wxml中出现                                                        原作者: 御鹏工作室                   来自: csdn博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • “微音乐”微信小程序实战开发过程                                                      • 微信小程序实战篇-下拉刷新与加载更多                                                      • 微信小程序实战篇-分类页面制作                                                      • 微信小程序实战--仿今日美食food                                                      • 黄秀杰实战教程--购物车动画与加减                                                      • 微信小程序实战——智能小秘“遥知之”源码分享（语义理解基于olami） ...                                                      • 黄秀杰实战系列-- 灵动商城姊妹——灵犀外卖新鲜出炉                                                      • 小程序实战--仿bilibil（哔哩哔哩）小程序                                                      • 为微信小程序增加mixin扩展                                                      • 微信小程序开发实战&电影小程序之（1）——基础目录、欢迎页面的创建 ...                                                      • Android开发不用学CSS从0开始学习微信小程序                                                      • POI微信小程序实战                                                      • 实战--小程序扫雷                                                      • 微信小程序入门bug--页面跳转js数据无法在wxml中出现                                                      • 小北微信小程序之小白教程系列之-- Hello World                                                                                                                                                                       0 条回复                                                                        \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                                                                                   jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092508|9d9ea83d64b0e0571c3d45b51d4646cc|2';\t\t\t\t\t\t"},{"title": "微信小程序开发实例--仿麦当劳微信小程序 ", "author": "                  Rolan                  2017-7-15 00:57                ", "text": "                                                                                                                                                                                     学习使我happy!!!作为全栈的学习者初学微信小程序抱着试试做心态一个星期内初步完成了这个项目。小程序是何方神圣？  小程序是一种新的开放能力开发者可以快速地开发一个小程序。小程序可以在微信内被便捷地获取和传播同时具有出色的使用体验。为什么选择它？用户可便捷地获取服务无需安装或下载即可使用具有更丰富的功能和出色的使用体验封装一系列接口能力帮助快速开发和迭代切身体验你也可以来！小程序对于新手来说是很容易上手的需要你用几天时间去熟悉小程序的构建过程和说明文档你就可以初步做出一个比较完整的小程序。 我觉得小程序最屌地方还是rpx使得小程序有很大的兼容性在页面布局使用这个属性可以适应不同的手机这也使得我们降低工作量。而且小程序是一个不需要下载安装即可使用的应用而且它的背后是强大的微信所以如果我们能够用自己的创造思维去看待这个你会得到很大的收获O(∩_∩)O哈哈~。项目工具及文档：微信web开发者工具：微信小程序官网 微信开发的小程序编辑软件下载安装即可使用不需要去添加什么的；开发文档：微信小程序宝典秘籍 这里面详细的介绍了小程序的各项信息包括组件、框架、API等等；Easy Mork： easy-mock 小程序后台数据可以在这里模拟利用json格式；图标库： Iconfont-阿里巴巴矢量图标库 这个是个好东西以前我总是为找不到图标元素烦恼但是现在有了它就啥也不怕了。页面注册\"pages\":[    \"pages/index/index\",   // 主页    \"pages/happynotice/happynotice\",  //开心通告栏    \"pages/userinfo/userinfo\",    //个人信息详情>    \"pages/queryintegral/queryintegral\",  // 积分查询    \"pages/integralmall/integralmall\", // 积分商城    \"pages/user/user\",  //个人信息    \"pages/integraldetail/integraldetail\",   //  优惠券详情    \"pages/qrcodenull/qrcodenull\", // 请求注册页面    \"pages/register/register\", // 注册信息页面    \"pages/qrcode/qrcode\"  //我的二维码 ], 项目功能已实现功能：注册用户信息手机号码验证(这里实现了页面)个人信息修改优惠券信息查看优惠券兑换积分查询开心通告栏未实现功能：麦有礼卡片(这个是刚上线的功能)麦麦同乐会的注册文字页面-常见问题、积分规则...项目GIF部分功能解析1. 获取本地信息在这里我们首先要登录利用wx.login(OBJECT) 必写（不然获取不到用户的信息） 然后利用方法wx.getUserInfo(OBJECT)获取用户信息 //登录的信息创建    wx.login({      success: function (e) {        wx.setStorage({          key: \"key\",          data: e.errMsg        })      }    })    //获取用户的信息    wx.getUserInfo({      success: function(res) {        var userInfo = res.userInfo        var nickName = userInfo.nickName        var avatarUrl = userInfo.avatarUrl        var gender = userInfo.gender //性别 0：未知、1：男、2：女        var province = userInfo.province        var sex;        ...2. 优惠券的显示及页面传值这里我们从easy-mock获取到优惠券的信息并且将信息显示到页面上我们就利用了wx:for这个控制属性绑定一个数组 这里我们还可以注意这个信息navigator是个跳转页面的属性在跳转的过程中它可以传值,例如**?url={{item.url}}这里我要穿的是图片地址信息到下个页面。 当然页面传值并不是只是这样方法还有设置全局的数据缓存**引入事件订阅和发布onfire.js这里就不一一介绍了有兴趣可以去Google   <block wx:for=\"{{imgs}}\" wx:key=\"\" class=\"block\" >    <swiper-item >        <navigator url=\"/pages/integraldetail/integraldetail?url={{item.url}}&description={{item.description}}&prompt={{item.prompt}}\">            <image  src=\"{{item.url}}\" class=\"side-img\" />            <view class=\"check click\">查看详情view>        navigator>        <view class=\"exchange click\" bindtap=\"exchangetap\">立即兑换view>    swiper-item>  block>```    我们需要在js文件中声明你的的优惠券数据imgs:[]**注意这里是json格式加','** ```javascript data: {    imgs:[],    modalHidden: true,  },利用wx.request(OBJECT)发起的是https请求从easymock中获取数据信息,利用setData()改变imgs得值, 要注意一定要声明var that = this,因为wx:request里面是请求不到当前页面的data的数据信息我们需要将this的赋值给that。还有一个微信小程序同时只能有5个网络请求连接。  var that = this;  wx.request({      url: \"https://www.easy-mock.com/mock/595f3f139adc231f357b0615/McDonald/list\",      method: 'GET',      success: function (res) {        console.log(res);        that.setData({          imgs: res.data.image,        })      }    })3. 星座选择器（这里我踩过坑）表单组件picker支持三种选择器通过mode来区分分别是普通选择器时间选择器日期选择器这里我们选择的是普通选择器。range是显示的数组只有声明mode为selector这个才能实现；value表示选择的第几个（由0开始）；bindchange是触发事件<view class=\"userdata-name\">星座view>      <view class=\"userdata-symbol\">view>      <picker mode=\"selector\" class=\"userdata-input\" range=\"{{actionConItems}}\" value=\"{{conIndex}}\" bindchange=\"pickerConSelected\">           <text>{{actionConItems[conIndex]}}text>      picker> view>      从微信端获取的个人信息放在本地利用wx.setStorageSync(\"key\", '')存储特定的信息picker到的星座就可以利用这个方法放到本地。 data: {        actionConItems: ['白羊座','金牛座','双子座','巨蟹座','狮子座','处女座','天秤座','天蝎座','射手座','摩羯座','水瓶座','双鱼座'],    conIndex: 0,  },      //星座弹出窗口  可以将数据放在本地setStorage  pickerConSelected: function (e) {     console.log('picker发送选择改变星座为' + e.detail.value);      wx.setStorageSync(\"con\", e.detail.value);      this.setData({             conIndex: e.detail.value,             btnColor: \"#ffc324\",      });  },踩过的坑...开始对文档不熟悉导致自己走了很多的弯路例如啊我做星座选择器的时候就不知道picker这个组件而去使用了action-sheet因为action-sheet里面的数据不能超过6项我们都知道啊有12星座所以我在这里卡了一段时间后面详细了看了下文档才解决了问题。所以在你开发小程序时候你应该对小程序的文档有个详细的了解。微信小程序的编译包是不能超过2M的开始你可能不知道将自己的图片放在云端得到API你尽可能将你的图片压缩小点来我开发的时候编译包就超过了2M。 目前小程序还有很多的限制需要去申请合法的域名等等之类的啊不过相信后面微信团队会逐渐放开这些限制。目前我最擅长的也就是切页面切页面...由于之间不知道弹性布局页面总显得不那么整齐。display:flex这里有它的详细说明快来点我哦这个可以完美解决我的问题妈妈再也不会担心我的图片文字同时居中了。作为处女座男生可能有那么一丢丢的强迫症就是特别想做的完美一直在改图片的样式字体样式...这也有好处当然坏处也不少╮(╯▽╰)╭项目地址：https://github.com/wuyuanlijie/iMcDonald-master                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)zhangdaliangh627457796                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发问答《五十一》post请求服务器收不到参数 & 小程序ajax请求问题 ...               微信小程序快速开发-食堂菜单案例                                                        原作者: wuyuanlijie                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序实战分享：腾讯体育                                                      • github精选：微信小程序起手式DEMO仿肯德基实战                                                      • 微信小程序实战教程：模仿—网易云音乐                                                      • 微信小程序版五洲到家实战                                                      • 微信小程序快速开发-食堂菜单案例                                                      • 微信小程序中多个button/view组件中进行切换时改变样式                                                      • 微信小程序开发相关记录                                                      • 微信小程序实例--洗衣小程序开发经验分享                                                      • 微信小程序-简单出售商品示例                                                      • 微信小程序实例--知乎日报小程序                                                      • 微信小程序实例-- 电影影评小程序                                                      • 养车记账本小程序开发实例                                                      • 小程序实战--天气预报                                                      • 微信小程序实例--仿豆瓣电影                                                                                               "},{"title": "微信小程序框架详解（直播分享） ", "author": "                  天下雪                  2016-12-9 00:26                ", "text": "                                                                                                                                                                                     作者：anda0109来自原文地址作者的话：整体感觉效果不是太满意一方面用手机录音效果不是太好另一方面在直播的过程中思维没有活跃起来整个直播的过程感觉比较被动。同时感觉这种直播形式实在不适合直播技术。直播些轻松的话题还是比较好的。但同时也有令我比较满意的地方啦！直播的参与人数达到300人以上而且是在没有任何宣传的情况下。这如果在线下不花一分一钱组织这么大的一厂讲座还是比较困难的。所以这就是互联网的力量。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从零入门系列《二》手动创建目录结构               微信小程序中利用时间选择器和js无计算实现定时器（将字符串或秒数转换成倒计时） ... ...                                                        原作者: anda0109                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序框架解析                                                      • 小程序框架总结                                                      • 小程序音视频能力技术负责人解读“小程序直播”                                                      • 微信小程序之-NBA在线直播小程序开发                                                                                               "},{"title": "水牛01248：flex布局学习笔记 ", "author": "                  天下雪                  2016-11-25 21:21                ", "text": "                                                                                                                                                                                     经典教程Flex 布局教程：语法篇Flex 布局教程：实例篇flex布局游戏理解flex布局实现需要至少两层控件,外层叫做容器,内部的叫做项目(item).类似于Android里的ViewGroup和里面装的View。容器分两个轴,水平的主轴（main axis）和竖直方向的交叉轴（cross axis）,就相当于盒子模型中的xy轴,或者android中的xy轴.基本的布局原则不像安卓里有那么多的定义好了布局规则的ViewGroup比如RelativeLayoutLinearlayout以及ListviewGridView等flex布局的名字就只有这一种（display: flex;）它是通过容器的一些属性来控制具体的布局规则的。那么如何确定布局规则呢？容器上的属性第一步确定众多的item是横向排列还是纵向排列：flex-direction：        row（默认值）：主轴为水平方向起点在左端。        row-reverse：主轴为水平方向起点在右端。        column：主轴为垂直方向起点在上沿。        column-reverse：主轴为垂直方向起点在下沿。第二步：一行或者一列放不下怎么办？怎样换行或换列？flex-wrap: nowrap | wrap | wrap-reverse;flex-wrap.png前面两个属性的简写形式：flex-flowflex-flow: <flex-direction> || <flex-wrap>;第三步：每个item之间在主轴方向上（flex-direction所确定的方向）以什么方式对齐？ justify-content:     flex-start（默认值）：左对齐    flex-end：右对齐    center： 居中    space-between：两端对齐项目之间的间隔都相等。    space-around：每个项目两侧的间隔相等。所以项目之间的间隔比项目与边框的间隔大一倍。第四步：每个item在交叉轴方向上以什么方式对齐？align-items:    flex-start：交叉轴的起点对齐。    flex-end：交叉轴的终点对齐。    center：交叉轴的中点对齐。    baseline: 项目的第一行文字的基线对齐。    stretch（默认值）：如果项目未设置高度或设为auto将占满整个容器的高度。第五步：多行或者多列时（多根轴线）轴线和轴线之间的对齐方式align-content: flex-start | flex-end | center | space-between | space-around | stretch;每个item的属性1.排列顺序：order数值越小排列越靠前默认为0。一般情况下控件一个个写过去没什么可说的但有时想把后面的一个控件显示到前面或者把前面的一个控件显示在最后就需要这个了2.大小/宽高的控制： 2.1项目的大小：flex-basisflex-basis: length | auto; /* default auto */2.2 当项目多时我这个项目怎么缩小：flex-shrink2.3 当项目少时本项目怎么放大：flex-grow注：flex-shrink和flex-grow有点类似于安卓中线性布局的weight。　缩写形式：flexflex: none | [ <'flex-grow'> <'flex-shrink'>? || <'flex-basis'> ]该属性有两个快捷值：auto (1 1 auto) 和 none (0 0 auto)。3.对齐方式可以覆盖容器上规定的对齐规则。类似于Android中母布局中gravity与子布局中layout-gravity的关系。这里的相关属性值可以类比Android中相对布局中子view 定位的相关属性。align-self: auto | flex-start | flex-end | center | baseline | stretch;                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    自学系列（零基础学小程序）---小程序实现简单的倒计时               蓝狐锅锅：微信小程序列表渲染多层嵌套循环及wx:key的使用                                                        原作者: 水牛01248                    来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • hss01248：吐槽小程序开发踩过的坑,以及一些解决方法                                                      • hss01248：全流程详解：小程序基本开发框架的搭建                                                      • hss01248：微信小程序登录逻辑梳理                                                      • 水牛01248：flex布局示例                                                      • 在微信小程序中学习flex布局                                                      • 从微信小程序看待FlexBox布局                                                      • 微信小程序 View：flex 布局                                                                                               "},{"title": "微信小程序通讯录demo（校园教职工通讯录） ", "author": "                  Rolan                  2017-10-30 00:20                ", "text": "                                                                                                                                                                                     前言帮别人做的一个展示用的demo最开始只需要一些假数据展示看看效果。不过到最后也没用上所以就拿出来分享一下吧。我自己把后台接口部分给简单补齐了做了一些假数据样式也做了一些调整。因为接口需要https以及上线需要微信审核之类的所以目前此demo只能在本地查看。同时功能也不是很完善很多功能做的也比较简陋。如果是初学微信小程序的话可以参考着看看。源码Talk is cheap. Show me the code.如何使用git clone https://github.com/XNAL/WxContacts// 需要先安装mysql并创建数据库可参考源码中的`wx_contacts.sql`cd WxContactsnpm init// 启动后台服务接口node api/app.js// 使用微信web开发者工具打开本项目并通过编译查看效果// 登录账号密码可使用以下两个亦可在数据库中查看：   手机号：13288886666/15688886666   密码： 123456        项目截图登录部门联系人列表学科我                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (3)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)wkaka'35w枪79xieph99                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小北微信小程序之小白教程系列之 -- 样式（WXSS）               微信小程序中获取access_token                                                        原作者: XNAL                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 王者荣耀故事站小程序（nuxt + 小程序）                                                      • 任务列表中显示\"小程序\"的原理分析                                                      • 小程序页面跳转解析                                                      • 微信小程序性能二三事                                                      • 微信小程序（创建页面、设置页面标题）                                                      • 小程序超实用组件：仿微信通讯录                                                                                               "},{"title": "微信小程序 引入公共页面的几种情况 ", "author": "                  Rolan                  2017-12-28 00:43                ", "text": "                                                                                                                                                                                     1、不带参数首先在pages文件夹中新建一个template文件夹文件夹中新建一个template.wxml文件代码如下<template name=\"msgItem\">  <view>    <text>This is template.wxml文件我是一个模板text>  view>template>然后我们书写我们所要调用template的页面index.wxml<import src =\"../template/template.wxml\"/>　　<view>This is index.wxmlview><template is=\"msgItem\"/>注意：（1）index.wxml中template 标签的is属性与template.wxml中template 标签的name属性值相同（2）index.wxml文件中要通过import标签声明需要使用的模板文件运行效果：2、带参数首先修改template.wxml文件我们给模板添加三个字段修改后代码如下<template name=\"msgItem\">  <view>    <text>This is template.wxml文件我是一个模板text>    <view>      <text> {{index}}: {{msg1}} text>      <text> {{msg2}} text>    view>  view>template>接下来我们在index.wxml中传递模板中所需要的三个参数修改后的代码如下：<import src =\"../template/template.wxml\"/><view>This is index.wxmlview><template is=\"msgItem\" data=\"{{index:1,msg1:'msg1数据',msg2:'msg2数据'}}\"/>运行效果： 3、列表item模板接下来我们就通过一种常见的情况列表数据来使用模板增加对模板的认知直接上修改过的代码：//index.jsPage({  data: {    list:[      { name: '张三', age: 15 },      { name: '李四', age: 25 },      { name: '王五', age: 18 },      { name: '赵六', age: 19 },    ]  }})<import src =\"../template/template.wxml\"/><view>This is index.wxmlview><view wx:for=\"{{list}}\">    <template is=\"msgItem\" data=\"{{name:item.name,age:item.age}}\"/>view><template name=\"msgItem\">  <view>    <text> name: {{name}} text>    <text> age: {{age}}text>  view>template>运行效果： 4、使用模板样式接下来我们就给模板增加样式文件然后在需要调用模板的地方使用该样式。 首先在pages/template文件夹中新建一个template.wxss文件,然后对模板文件添加一个简单样式。<template name=\"msgItem\">  <view class=\"template_style\">    <text> name: {{name}} text>    <text class=\"template_age_style\"> age: {{age}}text>  view>template>/* pages/template/template.wxss */.template_style{  border-bottom: solid 2px #999999;  padding: 5px;  font-size: 18px;  color: #000000;}.template_age_style{  color: #666666;  font-size: 14px;}我们的样式文件已经创建好了接下来在index.wxml中引入该样式文件。/index.wxss/@import \"../template/template.wxss\";运行效果： 5、调用不同的模板有时候我们有这样的需求那就是同一个列表中item数据不同可能他的样式也是有很大的区别所以我们使用的模板也会对应不相同接下来我们就来实现这样需求的小Demo: 首先修改了一下template.wxml原本该文件中只有一个template现在我们创建了两个新增的template仅仅多了一行代码当然了实际开发中需求会比这个难很多在这里只是为了实现Demo。<template name=\"msgItem\">  <view class=\"template_style\">    <text> name: {{name}} text>    <text class=\"template_age_style\"> age: {{age}}text>  view>template><template name=\"msgItem2\">  <view class=\"template_style\">    <text> name: {{name}} text>    <text class=\"template_age_style\"> age: {{age}}text>    <text>我是一个未成年text>>  view>template>接下来我们在index.wxml中通过age字段调用不同的模板：<import src =\"../template/template.wxml\"/><view>This is index.wxmlview><view wx:for=\"{{list}}\">    <template is=\"{{item.age >= 18 ? 'msgItem' : 'msgItem2'}}\" data=\"{{name:item.name,age:item.age}}\"/>view>运行效果：                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序“圣诞帽”的实现思路               微信小程序实战--流动图书馆                                                        原作者: 下页、再停留                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序--引用公共js里的方法                                                      • 微信小程序公共组件的引用与控制                                                                                               "},{"title": "微信小程序组件 分页菜单带下划线焦点切换 ", "author": "                  Rolan                  2017-12-11 00:34                ", "text": "                                                                                                                                                                                     <view class=\"edition-container\"><view class='edition-content'><!-- 1分类菜单--><view class='edition-menu flex'><block wx:key=\"edmenu\" wx:for=\"{{edmenu}}\" wx:for-index=\"index\"><view class='flexcca' data-index='{{index}}' bindtap='keyMenu'><text class=\"menu-title {{edmenuShow==index?'actitle':''}}\">{{item.menunm}}</text><view class=\"menu-under {{edmenuShow==index?'edactive':''}}\"></view></view></block></view></view></view>data: {// （网页数据）edmenu: [{ menunm: '登录'},{ menunm: '会员注册'},{ menunm: '红娘注册'}],edmenuShow:1,},// 焦点控制函数keyMenu: function (e) {let that = this;let index = e.currentTarget.dataset.index;this.setData({edmenuShow: index})},page{\">#fff;}.edition-container{font-size: 30rpx;color: #333;}/* 1分类菜单 */.edition-menu{height: 80rpx;border-top: 1px solid #f7f7f7;border-bottom: 1px solid #f7f7f7;box-sizing: border-box;}.edition-menu>view{width: 33.33%;}.edition-menu .menu-title{margin-top: 16rpx;}.edition-menu .menu-under{width: 140rpx;height: 5rpx;\">transparent ;border-radius: 6rpx;margin-top: 10rpx;}.edition-menu .actitle{color: #ff4273;}.edition-menu .edactive{\">#ff4273;}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序爬坑日记               微信小程序--跳转页面常用的两种方法                                                        原作者: ThisCall                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序：完成一个tabbar+下拉刷新组件需要经历什么坑                                                      • 微信小程序：新组件web-view详解（2017.11.02新增）                                                      • 小程序自定义评分组件 template（精度0.1）                                                      • swiper组件添加左右箭头                                                      • 微信小程序公共组件的引用与控制                                                      • 手把手教你实现微信小程序中的自定义组件                                                      • 微信小程序实现多折叠展开酷炫菜单                                                                                               "},{"title": "手把手教你实现微信小程序中的自定义组件 ", "author": "                  Rolan                  2017-12-14 00:20                ", "text": "                                                                                                                                                                                     之前做小程序开发的时候对于开发来说比较头疼的莫过于自定义组件了当时官方对这方面的文档也只是寥寥几句一笔带过而已所以写起来真的是非常非常痛苦！！好在微信小程序的库从 1.6.3 开始官方对于自定义组件这一块有了比较大的变动首先比较明显的感觉就是文档比以前全多了有木有！（小程序文档）现在小程序支持简洁的组件化编程可以将页面内的功能模块抽象成自定义组件以便在不同的页面中复用提高自己代码的可读性降低自己维护代码的成本！本篇文章就是手把手教你实现小程序中自定义组件坐稳啦~具体实现要做自定义组件我们先定一个小目标比如说我们在小程序中实现一下 WEUI 中的弹窗组件基本效果图如下。Step1我们初始化一个小程序（本示例基础版本库为 1.7 ）删掉里面的示例代码并新建一个 components 文件夹用于存放我们以后开发中的所用组件今天我们的目的是实现一个 弹框 组件因此我们在 components 组件中新建一个 Dialog 文件夹来存放我们的弹窗组件在 Dialog 下右击新建 Component 并命名为 dialog 后会生成对应的 json wxml wxss js 4个文件也就是一个自定义组件的组成部分此时你的项目结构应该如下图所示：Step2组件初始化工作准备完成接下来就是组件的相关配置首先我们需要声明自定义组件也就是将 dialog.json 中 component 字段设为 true ：{  \"component\": true,        // 自定义组件声明  \"usingComponents\": {}     // 可选项用于引用别的组件}其次我们需要在 dialog.wxml 文件中编写弹窗组件模版在 dialog.wxss 文件中加入弹窗组件样式它们的写法与页面的写法类似我就不赘述直接贴代码啦~dialog.wxml 文件如下：<view class='wx_dialog_container' hidden=\"{{!isShow}}\">    <view class='wx-mask'>view>    <view class='wx-dialog'>        <view class='wx-dialog-title'>{{ title }}view>        <view class='wx-dialog-content'>{{ content }}view>        <view class='wx-dialog-footer'>          <view class='wx-dialog-btn' catchtap='_cancelEvent'>{{ cancelText }}view>          <view class='wx-dialog-btn' catchtap='_confirmEvent'>{{ confirmText }}view>        view>    view>view>dialog.wxss 文件如下：/* components/Dialog/dialog.wxss */.wx-mask{  position: fixed;    z-index: 1000;    top: 0;    right: 0;    left: 0;    bottom: 0;    background: rgba(0, 0, 0, 0.3);}.wx-dialog{    position: fixed;    z-index: 5000;    width: 80%;    max-width: 600rpx;    top: 50%;    left: 50%;    -webkit-transform: translate(-50%, -50%);    transform: translate(-50%, -50%);    background-color: #FFFFFF;    text-align: center;    border-radius: 3px;    overflow: hidden;}.wx-dialog-title{    font-size: 18px;    padding: 15px 15px 5px;}.wx-dialog-content{    padding: 15px 15px 5px;    min-height: 40px;    font-size: 16px;    line-height: 1.3;    word-wrap: break-word;    word-break: break-all;    color: #999999;}.wx-dialog-footer{    display: flex;    align-items: center;    position: relative;    line-height: 45px;    font-size: 17px;}.wx-dialog-footer::before{    content: '';    position: absolute;    left: 0;    top: 0;    right: 0;    height: 1px;    border-top: 1px solid #D5D5D6;    color: #D5D5D6;    -webkit-transform-origin: 0 0;    transform-origin: 0 0;    -webkit-transform: scaleY(0.5);    transform: scaleY(0.5);}.wx-dialog-btn{    display: block;    -webkit-flex: 1;    flex: 1;    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);    position: relative;}.wx-dialog-footer .wx-dialog-btn:nth-of-type(1){    color: #353535;}.wx-dialog-footer .wx-dialog-btn:nth-of-type(2){    color: #3CC51F;}.wx-dialog-footer .wx-dialog-btn:nth-of-type(2):after{    content: \" \";    position: absolute;    left: 0;    top: 0;    width: 1px;    bottom: 0;    border-left: 1px solid #D5D5D6;    color: #D5D5D6;    -webkit-transform-origin: 0 0;    transform-origin: 0 0;    -webkit-transform: scaleX(0.5);    transform: scaleX(0.5);}step3组件的结构和样式都有了还缺少什么呢没错还缺 js  眼睛比较犀利的同学可能已经发现了我们在 dialog.wxml 文件中的会有一些比如 {{ isShow }} 、 {{ title }} 这样的模版变量还定义了 _cancelEvent 和 _confirmEvent 两个方法其具体实现就是在 dialog.js 中。dialog.js 是自定义组件的构造器是使用小程序中 Component 构造器生成的调用 Component 构造器时可以用来指定自定义组件的属性、数据、方法等具体的细节可以参考一下官方的文档下面我通过代码注释解释一下构造器中的一些属性的使用：// components/Dialog/dialog.jsComponent({  options: {    multipleSlots: true // 在组件定义时的选项中启用多slot支持  },  /**   * 组件的属性列表   * 用于组件自定义设置   */  properties: {    // 弹窗标题    title: {            // 属性名      type: String,     // 类型（必填）目前接受的类型包括：String, Number, Boolean, Object, Array, null（表示任意类型）      value: '标题'     // 属性初始值（可选）如果未指定则会根据类型选择一个    },    // 弹窗内容    content :{      type : String ,      value : '弹窗内容'    },    // 弹窗取消按钮文字    cancelText :{      type : String ,      value : '取消'    },    // 弹窗确认按钮文字    confirmText :{      type : String ,      value : '确定'    }   },  /**   * 私有数据,组件的初始数据   * 可用于模版渲染   */  data: {    // 弹窗显示控制    isShow:false  },  /**   * 组件的方法列表   * 更新属性和数据的方法与更新页面数据的方法类似   */  methods: {    /*     * 公有方法     */    //隐藏弹框    hideDialog(){      this.setData({        isShow: !this.data.isShow      })    },    //展示弹框    showDialog(){      this.setData({        isShow: !this.data.isShow      })    },     /*     * 内部私有方法建议以下划线开头     * triggerEvent 用于触发事件     */    _cancelEvent(){      //触发取消回调      this.triggerEvent(\"cancelEvent\")    },    _confirmEvent(){      //触发成功回调      this.triggerEvent(\"confirmEvent\");    }  }})step4截至目前为止你应该完成了一个自定义弹窗组件的大部分可是你保存后并没有发现任何变化因为我们还需要在 index.wxml 文件中引入它！首先需要在 index.json 中引入组件：{  \"usingComponents\": {    \"dialog\": \"/components/Dialog/dialog\"  }}然后我们在 index.wxml 中引入它并增加我们自定义的一些值如下<view class=\"container\">    <dialog id='dialog'       title='我是标题'       content='恭喜你学会了小程序组件'       cancelText='知道了'       confirm='谢谢你'      bind:cancelEvent=\"_cancelEvent\"        bind:confirmEvent=\"_confirmEvent\">    dialog>        <button type=\"primary\" bindtap=\"showDialog\"> ClickMe! button>view>嗯哪还差最后一步 index.js 配置没错这个也很简单我就复制粘贴了//index.js//获取应用实例const app = getApp()Page({  /** * 生命周期函数--监听页面初次渲染完成 */  onReady: function () {    //获得dialog组件    this.dialog = this.selectComponent(\"#dialog\");  },  showDialog(){    this.dialog.showDialog();  },   //取消事件  _cancelEvent(){    console.log('你点击了取消');    this.dialog.hideDialog();  },  //确认事件  _confirmEvent(){    console.log('你点击了确定');    this.dialog.hideDialog();  }})到此！大功告成！step5让我们测试一下试试看：点击按钮之后呢会出现如下效果：点击取消或者确定按钮的话我们在事件中设置了弹窗会关闭并会打印出相应的信息具体点击完应该怎么做就看你们自己发挥了我只能帮你到这里了~总结现在你已经基本掌握了小程序中的自定义组件开发技巧怎么样是不是很棒应该给自己点个赞打个call。 总体来说小程序推出自定义组件后感觉方便了很多还没有 get 的小伙伴们赶紧学习学习以后多用组件化开发就不会那么难受了加油哦~具体代码我已经托管到 github 上了欢迎 issue ~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序代码包压缩策略 & 方案               小程序开发 - webview                                                        原作者: Chris威                   来自: 稀土掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序：新组件web-view详解（2017.11.02新增）                                                      • 小程序自定义评分组件 template（精度0.1）                                                      • swiper组件添加左右箭头                                                      • 微信小程序公共组件的引用与控制                                                      • 微信小程序组件化 快速实现可用模态窗                                                      • 微信小程序组件 分页菜单带下划线焦点切换                                                      • 关于微信小程序这件大事！                                                                                               "},{"title": "小程序自定义评分组件（精确度0.1星） ", "author": "                  Rolan                  2017-10-6 00:53                ", "text": "                                                                                                                                                                                     自定义评分组件不止于1星、半星精确到0.1星。自定义评分组件 实现思路星星分两种形态一种代表实心评分一种代表空心未评分。实星和空星完全重叠大小必需保持一致实星叠于空星之上根据评分设置实星的宽来显示评分。 全五星代表10分一颗星就是2分精确到0.1一颗星就分为20份。源码rating.wxml name=\"rating\">       class='rating-on'       style='width:{{rating >= 2 ? 1 : rating*10%20/20}}em'    >     class='rating-off'>         class='rating-on'       style='width:{{rating >= 4 ? 1 : rating < 2 ? 0 : rating*10%20/20}}em'    >     class='rating-off'>         class='rating-on'       style='width:{{rating >= 6 ? 1 : rating < 4 ? 0 : rating*10%20/20}}em'    >     class='rating-off'>         class='rating-on'       style='width:{{rating >= 8 ? 1 : rating < 6 ? 0 : rating*10%20/20}}em'    >     class='rating-off'>              style='width:{{rating == 10 ? 1 : rating < 8 ? 0 : rating*10%20/20}}em'    >     class='rating-off'>  rating.wxss.rating-on {  color: black;  position: absolute;  overflow: hidden;}.rating-off {  color: #DBDBDB;}.rating-on:not(:last-child),.rating-off:not(:last-child) {  margin-right: 0.2em;}使用page.wxml src='../common/rating/rating.wxml' /> is='rating' data='{{rating:rating.average}}' />page.wxss@import '../common/rating/rating';我使用的特殊符号也可使用图片保证尺寸一致就行。评分组件实现方式很多我也许是初学若有更佳实现方式请赐教。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序播放音频               开发适用于微信小程序的跨平台图表库：part1                                                        原作者: 红叶丶秋鸣                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序组件化（上）                                                      • 微信小程序开发组件化（下）                                                      • Yii2小程序组件                                                      • 微信小程序getPhoneNumber快速获取用户手机号组件                                                      • 微信小程序：button组件的边框设置                                                      • 微信小程序添加视频video组件                                                      • 基本组件--(进度条、滑动选择器、开关选择器、复选框、)                                                      • 营销组件--大转盘\\刮刮乐\\老虎机\\跑马灯\\九宫格翻纸牌\\摇一摇\\手势解锁 ...                                                      • 截图组件welCropper实现原理及其使用                                                      • Min – 小程序组件化解决方案                                                      • 微信小程序评分组件                                                      • 自定义组件化开发(附完整示例代码和效果图)                                                      • 小程序自定义评分组件 template（精度0.1）                                                      • 微信小程序公共组件的引用与控制                                                                                               "},{"title": "截图组件welCropper，实现原理及其使用 ", "author": "                  Rolan                  2017-9-25 00:04                ", "text": "                                                                                                                                                                                                                                                                 封面最近做项目的时候需要做一个截图功能。用了一个别人写的截图工具发现截出的图质量下降了但是我们图片要用来做识别, 需要保证截出的图质量不下降。而且也不支持通过拖动来调整截图框的大小。所以这个截图工具无法满足需求。因为所以就自己动手写了一个截图组件。下面介绍一下实现原理和使用方法。实现原理组件wxml的层次结构图如下：hierarchy.pngoriginal canvas 用来绘制原图大小的图片这样能保证截图后的质量不会下降这个canvas是隐藏的。movable-area是movable-view的容器是官方提供的拖拽移动组件用来移动截取框的四个角。这个组件支持多个点同时移动。scale canvas用来绘制适应屏幕比例大小的图片（aspectFit）因为通常原图大小是超过屏幕长宽的。move canvas是根据四个movable-view的位置绘制出截图框。最后截图通过四个点的位置计算出截图框的位置然后放大对应原图大小的位置得到在原图中的(x, y, width, height)最后通过官方提供的canvas接口截图。wx.canvasToTempFilePath({  x: x,  y: y,  width: w,  height: h,  destWidth: w,  destHeight: h,  canvasId: 'originalCanvas',  success: function (res) {  })}最后截图通过四个点的位置计算出截图框的位置然后放大对应原图大小的位置得到在原图中的(x, y, width, height)最后通过官方提供的canvas接口截图。特点保证截图质量不会被压缩截图框能够通过拖拽来调整大小使用假设我们的应用文件结构如下：./├── app.js├── app.json├── app.wxss├── pages│   └── index│       ├── index.js│       ├── index.json│       ├── index.wxml│       └── index.wxss└── welCropper    ├── welCropper.js    ├── welCropper.wxml    └── welCropper.wxss调用组件时需要传入cropperData和cropperMovableItems因为数据和事件都是绑定在Page上的所以要避免使用组件里面已经被占用的命名。 /pages/index/index.wxml<!-- 引入组件 --><import src=\"/welCropper/welCropper.wxml\" /><!-- 调用组件 --><template is=\"welCropper\" data=\"{{data:cropperData, cropperMovableItems:cropperMovableItems}}\"></template><!-- 用于选择图片传入cropper中 --><button bindtap='selectTap'>select image</button>/pages/index/index.js// 获取显示区域长宽const device = wx.getSystemInfoSync()const W = device.windowWidthconst H = device.windowHeight - 50let cropper = require('../../welCropper/welCropper.js');console.log(device)Page({    data: {    },    onLoad: function () {        var that = this        // 初始化组件数据和绑定事件        cropper.init.apply(that, [W, H]);    },    selectTap() {        var that = this        wx.chooseImage({            count: 1, // 默认9            sizeType: ['original', 'compressed'], // 可以指定是原图还是压缩图默认二者都有            sourceType: ['album', 'camera'], // 可以指定来源是相册还是相机默认二者都有            success(res) {                const tempFilePath = res.tempFilePaths[0]                console.log(tempFilePath)                // 将选取图片传入cropper并显示cropper                that.showCropper(tempFilePath, (resPath) => {                    console.log(\"crop callback:\" + resPath)                    wx.previewImage({                        current: '',                        urls: [resPath]                    })                    // that.hideCropper() //隐藏我在项目里是点击完成就上传所以如果回调是上传那么隐藏掉就行了不用previewImage                })            }        })    }})最后引入组件的样式 /pages/index/index.wxss@import \"/welCropper/welCropper.wxss\";效果图效果动图截图如果将movable-view显示出来是这样的：显示movable-view后源代码：Github:tomfriwel/welCropper将welCropper文件夹复制到自己项目引入调用就行了。如果出现什么bug、问题或者建议可以告诉我我会尽量改进。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w小余45                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            营销组件--大转盘\\刮刮乐\\老虎机\\跑马灯\\九宫格翻纸牌\\摇一摇\\手势解锁 ...               微信小程序时间预约插件（包含日历）                                                        原作者: tomfriwel                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序自定义评分组件（精确度0.1星）                                                      • 任务列表中显示\"小程序\"的原理分析                                                      • Min – 小程序组件化解决方案                                                      • 自定义组件化开发(附完整示例代码和效果图)                                                      • 微信小程序公共组件的引用与控制                                                      • 给微信聊天记录添加截图功能                                                                                               "},{"title": "小程序的拖拽、缩放和旋转手势 ", "author": "                  Rolan                  2018-6-8 00:23                ", "text": "                                                                                                                                                                                     在开发中有时会遇到像App中的手势那样的效果下面就仿照App实现了一下。wxml部分：<view class=\"touch-container\"> <view class=\"msg\">{{msg}}</view> <image class=\"img\" src=\"{{src}}\" style=\"width: {{width}}rpx; height: {{height}}rpx; left: {{left}}rpx; top: {{top}}rpx; transform: translate(-50%, -50%) scale({{ scale }}) rotate({{ rotate }}deg);\" bindload=\"bindload\" catchtouchstart=\"touchstart\" catchtouchmove=\"touchmove\" catchtouchend=\"touchend\" ></image></view>wxss部分：page {  width: 100%;  height: 100%;  background: #ffffff;}.touch-container {  width: 100%;  height: 100%;  padding-top: 0.1px;}.msg {  width: 100%;  height: 60rpx;  line-height: 60rpx;  text-align: center;  font-size: 30rpx;  color: #666666;}.img {  position: absolute;  width: 690rpx;  height: 300rpx;  transform-origin: center center;}js部分：var canOnePointMove = falsevar onePoint = {  x: 0,  y: 0}var twoPoint = {  x1: 0,  y1: 0,  x2: 0,  y2: 0}Page({  data: {    msg: '',    src: 'http://img01.taopic.com/150508/318763-15050PU9398.jpg',    width: 0,    height: 0,    left: 375,    top: 600,    scale: 1,    rotate: 0 }, // 关闭上拉加载  onReachBottom: function() { return },  bindload: function(e) { var that = this var width = e.detail.width var height = e.detail.height if (width > 750) {      height = 750 * height / width      width = 750 } if (height > 1200) {      width = 1200 * width / height      height = 1200 }    that.setData({      width: width,      height: height }) },  touchstart: function(e) { var that = this if (e.touches.length < 2) {      canOnePointMove = true      onePoint.x = e.touches[0].pageX * 2      onePoint.y = e.touches[0].pageY * 2 }else {      twoPoint.x1 = e.touches[0].pageX * 2      twoPoint.y1 = e.touches[0].pageY * 2      twoPoint.x2 = e.touches[1].pageX * 2      twoPoint.y2 = e.touches[1].pageY * 2 } },  touchmove: function(e){ var that = this if (e.touches.length < 2 && canOnePointMove) { var onePointDiffX = e.touches[0].pageX * 2 - onePoint.x var onePointDiffY = e.touches[0].pageY * 2 - onePoint.y      that.setData({        msg: '单点移动',        left: that.data.left + onePointDiffX,        top: that.data.top + onePointDiffY })      onePoint.x = e.touches[0].pageX * 2      onePoint.y = e.touches[0].pageY * 2 }else if (e.touches.length > 1) { var preTwoPoint = JSON.parse(JSON.stringify(twoPoint))      twoPoint.x1 = e.touches[0].pageX * 2      twoPoint.y1 = e.touches[0].pageY * 2      twoPoint.x2 = e.touches[1].pageX * 2      twoPoint.y2 = e.touches[1].pageY * 2 // 计算角度旋转(优先) var perAngle = Math.atan((preTwoPoint.y1 - preTwoPoint.y2)/(preTwoPoint.x1 - preTwoPoint.x2))*180/Math.PI var curAngle = Math.atan((twoPoint.y1 - twoPoint.y2)/(twoPoint.x1 - twoPoint.x2))*180/Math.PI if (Math.abs(perAngle - curAngle) > 1) {        that.setData({          msg: '旋转',          rotate: that.data.rotate + (curAngle - perAngle) }) }else { // 计算距离缩放 var preDistance = Math.sqrt(Math.pow((preTwoPoint.x1 - preTwoPoint.x2), 2) + Math.pow((preTwoPoint.y1 - preTwoPoint.y2), 2)) var curDistance = Math.sqrt(Math.pow((twoPoint.x1 - twoPoint.x2), 2) + Math.pow((twoPoint.y1 - twoPoint.y2), 2))        that.setData({          msg: '缩放',          scale: that.data.scale + (curDistance - preDistance) * 0.005 }) } } },  touchend: function(e) { var that = this    canOnePointMove = false }})json部分：\"navigationBarTitleText\": \"识别手势\", \"navigationBarTextStyle\":\"black\", \"navigationBarBackgroundColor\": \"#FFF\", \"disableScroll\": true如有问题请大家多多指教！作者：honey缘木鱼 链接：https://www.jianshu.com/p/ec95cd4a6941 著作权归作者所有。商业转载请联系作者获得授权非商业转载请注明出处。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    如何开发小程序中的朋友圈功能               微信小程序日历选择-类似酒店预订方式有节日标识                                                        原作者: honey缘木鱼                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "(干货)微信小程序组件封装 ", "author": "                  Rolan                  2018-5-19 00:13                ", "text": "                                                                                                                                                                                     概述自己封装的一个比较简单微信弹窗小组件主要就是教会大家对微信小组件的用法和理解因为微信小程序对组件介绍特别少所以我就把自己的理解分享给大家。一前言相信大家在开发小程序时会遇到某个功能多次使用的情况比如弹出框。这个时候大家首先想到的是组件化开发就是把弹出框封装成一个组件然后哪里使用哪里就调用对看来大家都是有思路的人但是要怎样实现呢。可能你会去看官方文档但是微信的官方文档也是说的不太清楚所以写起来也是非常痛苦。今天就和大家一起开发微信组件坐稳了老司机要开车了。二具体实现我们先实现个简单的弹窗组件详情图如下：1.新建component文件夹存放我们的组件里边存放的就是我们所用的组件我们今天要做的事弹出框新建文件夹popup存放我们的组件模板点击右键选择新建component就会自动生成组件的模板wxss、wxml、json、js如图2.我们可以写一些组件样式和布局跟页面写法类似我就不多说了直接把代码贴出 :popup.wxml<view class=\"wx-popup\" hidden=\"{{flag}}\">  <view class='popup-container'>    <view class=\"wx-popup-title\">{{title}}</view>    <view class=\"wx-popup-con\">{{content}}</view>    <view class=\"wx-popup-btn\">      <text class=\"btn-no\" bindtap='_error'>{{btn_no}}</text>      <text class=\"btn-ok\" bindtap='_success'>{{btn_ok}}</text>    </view>  </view></view>popup.wxss/* component/popup.wxss */.wx-popup {  position: absolute;  left: 0;  top: 0;  width: 100%;  height: 100%;  background: rgba(0, 0, 0, .5);}.popup-container {  position: absolute;  left: 50%;  top: 50%;  width: 80%;  max-width: 600rpx;  border: 2rpx solid #ccc;  border-radius: 10rpx;  box-sizing: bordre-box;  transform: translate(-50%, -50%);   overflow: hidden;  background: #fff;}.wx-popup-title {  width: 100%;  padding: 20rpx;  text-align: center;  font-size: 40rpx;  border-bottom: 2rpx solid red;}.wx-popup-con {  margin: 60rpx 10rpx;  text-align: center;}.wx-popup-btn {  display: flex;  justify-content: space-around;  margin-bottom: 40rpx;}.wx-popup-btn text {  display: flex;  align-items: center;  justify-content: center;  width: 30%;  height: 88rpx;  border: 2rpx solid #ccc;  border-radius: 88rpx;}样式和布局和布局已经写好了接下来要介绍的就是Component构造器Component构造器可用于定义组件调用Component构造器时可以指定组件的属性、数据、方法等。Tips:Component 构造器构造的组件也可以作为页面使用。使用 this.data 可以获取内部数据和属性值但不要直接修改它们应使用 setData 修改。生命周期函数无法在组件方法中通过 this 访问到。属性名应避免以 data 开头即不要命名成 dataXyz 这样的形式因为在 WXML 中 data-xyz=\"\" 会被作为节点 dataset 来处理而不是组件属性。在一个组件的定义和使用时组件的属性名和data字段相互间都不能冲突（尽管它们位于不同的定义段中）。component介绍完后就是最为关键的js了popup.js:Component({  options: {    multipleSlots: true // 在组件定义时的选项中启用多slot支持  },  /**   * 组件的属性列表   */  properties: {    title: {            // 属性名      type: String,     // 类型（必填）目前接受的类型包括：String, Number, Boolean, Object, Array, null（表示任意类型）      value: '标题'     // 属性初始值（可选）如果未指定则会根据类型选择一个    },    // 弹窗内容    content: {      type: String,      value: '内容'    },    // 弹窗取消按钮文字    btn_no: {      type: String,      value: '取消'    },    // 弹窗确认按钮文字    btn_ok: {      type: String,      value: '确定'    }   },  /**   * 组件的初始数据   */  data: {    flag: true,  },  /**   * 组件的方法列表   */  methods: {    //隐藏弹框    hidePopup: function () {      this.setData({        flag: !this.data.flag      })    },    //展示弹框    showPopup () {      this.setData({        flag: !this.data.flag      })    },    /*    * 内部私有方法建议以下划线开头    * triggerEvent 用于触发事件    */    _error () {      //触发取消回调      this.triggerEvent(\"error\")    },    _success () {      //触发成功回调      this.triggerEvent(\"success\");    }  }})上边会用到一个 triggerEvent下面我们就来介绍下：自定义组件触发事件时需要使用 triggerEvent 方法指定事件名、detail对象和事件选项。触发事件的选项包括：现在一个弹窗的组件就封装好了接下来就是调用了。调用的时候需要在调用的页面新建一个json文件json文件里需要配置usingComponents就是引用组件看代码：index.json{  \"usingComponents\": {    \"popup\": \"/component/popup/popup\"  }}现在基本上完成了需要的就是在首页引用了。<!--index.wxml--><view class=\"container\">  <view class=\"userinfo\">    <button bindtap=\"showPopup\"> 点我 </button>  </view>  <popup id='popup'       title='小组件'       content='学会了吗'       btn_no='没有'       btn_ok='学会了'      bind:error=\"_error\"        bind:success=\"_success\">  </popup></view>配置index.js加上点击事件//index.js//获取应用实例const app = getApp()Page({  onReady: function () {    //获得popup组件    this.popup = this.selectComponent(\"#popup\");  },  showPopup() {    this.popup.showPopup();  },  //取消事件  _error() {    console.log('你点击了取消');    this.popup.hidePopup();  },  //确认事件  _success() {    console.log('你点击了确定');    this.popup.hidePopup();  }})一个弹窗组件就完成了看下效果：如果觉得文章还不错并对你有帮助的话请分享给你的小伙伴并点赞有什么不懂得可以在底下留言哦。如果想看源码的话可以去我的github上下载欢迎stargithub： github.com/Mr-MengBo/M…                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)wSr55tjn470812009                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序实现长按删除图片               微信小程序AES解密失败                                                        原作者: 码农界段子手                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序--缓存的二次开发封装                                                      • 微信小程序之多文件下载的简单封装                                                      • 微信小程序 wx.request 的封装                                                      • 小程序封装ajax等工具函数                                                      • 微信小程序封装get、post请求                                                      • 使用mpvue开发小程序通用能力封装                                                                                               "},{"title": "小程序的登录和数据解密全解析 ", "author": "                  Rolan                  2018-4-23 00:06                ", "text": "                                                                                                                                                                                     不知不觉已经一个月没有写东西了堕落的日子居然过的这么心（chou）安（bu）理（yao）得（lian）罪过啊。好了回到正文来聊咱们的小程序。致敬登录大部分逻辑代码统统来自 手把手教会你小程序登录鉴权登录流程上图是官方给出的登录流程我们来捋下逻辑。1、用户使用 wx.login 获取临时 code ,有效期为5分钟2、将临时 code 传到我们自己的后端服务调用微信的API获取用户的 session_key 和 openid3、后端自定义新的密钥并关联返回的 session_key 和 openid 将新的密钥返给前端4、前端发送请求的时候带着密钥后端进行解析后返回数据session_key和openid1、 session_key 会话密钥用来确定会话的操作的有效性和用来加密解密用户数据服务器自己存储即可不应该将密钥返给前端和对话使用2、 openid 用户唯一标识同样只用于服务器,可以用来标识用户的唯一性接下来我们说下它们的获取,通过服务端调用微信API获取API： https://api.weixin.qq.com/sns/jscode2session参数如下：// 小程序页面wx.login({\tsuccess:(ret)=>{\t\twx.request({\t\t\turl: 'http://test.com', // 后端服务器\t\t\tdata:{\t\t\t\tcode : ret.code\t\t\t}\t\t})\t}})后端服务我们使用 request 模块来发送请求// 后端服务let options = {  url: 'https://api.weixin.qq.com/sns/jscode2session',  qs:{      appid: appid,        secret: secret,      js_code: code,      grant_type:'authorization_code'  }}// 默认请求方式是getrequest(options, (err, response, body) => {\tif(err) return err\treturn body  // {openid:'openid', session_key:'session_key'} 不是真正的返回 看下面的代码})生成新的密钥 skey上面我们获取了session_key和openid下文两个字断称keyID接下来我们生成一个新的密钥返回前端并将新密钥关联keyID。我们使用crypto模块的sha1算法生成密钥const crypto = require('crypto')function getShaKey(data){\treturn crypto.createHash('sha1').update(data, 'utf8').digest('hex')}上面的代码返回我们就改成这个新的skey前端将这个密钥存在storage里面请求的时候带上这个skey就完成了自定义登录态。wx.checkSession用来校验当前用户的session_key是否有效微信不会把session_key的有效期告知开发者用户越频繁使用小程序session_key有效期越长。wx.checkSession({\tsuccess:function(){  // 当前session_key有效\t\t... // 可以写我们的业务代码\t},\tfail:function(){   // 当前session_key已过期\t\twx.login()  // 重新登录获取新的session_key\t}})当session_key过期的时候我们调用登录API更新session_key生成新的skey并关联二者关系。工具函数的封装前面我们将流程大概串了下接下来我们把上面的流程写成写成公用的函数// 验证session_key状态function checkSession(){\treturn new Promise((resolve, reject) => {\t\twx.checkSession({\t\t\tsuccess:function(){\t\t\t\tresolve(true)\t\t\t},\t\t\tfail:function(){\t\t\t\treject(false)\t\t\t}\t\t})\t})}// 登录function login(){\treturn new Promise((resolve, reject) => {\t\twx.login({\t\t\tsuccess: (ret) => {\t\t\t\twx.request({\t\t\t\t\turl:'本地服务地址',\t\t\t\t\tmethod: 'POST',\t\t\t\t\tdata:{\t\t\t\t\t\tcode: ret.code\t\t\t\t\t},\t\t\t\t\tsuccess: (response) =>{\t\t\t\t\t\twx.setStorageSync('skey', response.data.key)  // 将skey存在storage里面\t\t\t\t\t\tresolve(response.data.key)\t\t\t\t\t}\t\t\t\t\t\t\t\t\t})\t\t\t}\t\t})\t\t\t})}// 请求function ajax(url, data, method=\"GET\", config={}){\tlet skey = wx.getStorageSync('skey') // 获取skey\tif(!skey){  // 没有skey首次登录\t\treturn new Promise((resolve, reject) => {\t\t\tlogin()\t\t\treject('请登录')\t\t})\t} else {\t\treturn new Promise((resolve, reject) => {      checkSession().then( _=> {        if (_){ // session_key有效          wx.request({            url,            method: method.toLocaleUpperCase(),            data,            header: Object.assign({}, { skey }, config),            success: (ret) => {              resolve(ret.data)            }          })        } else { // session_key失效          login()          reject('session_key失效')        }      })    })\t}}后端代码后端使用koa框架代码见文末 github 地址解密官方提供了多种编程语言的示例代码点击下载这里我们使用微信运动API为例var app = getApp()  // 我们将工具函数都放在了app的示例上面Page({\tonLoad:function(){\t\tapp.Util.login().then(_ => {  // 先登录然后获取数据      this.getrunData()    })\t},\tgetrunData(){    wx.getWeRunData({      success: (ret) => {        app.Util.ajax('本地服务地址', { iv: ret.iv, data: ret.encryptedData}, 'post').then(_=>{          console.log(_)        }, (err)=>{          console.log(err)        })      }    })  },})返回结果如下以上我们完成了小程序简单的登录鉴权和数据解密结尾登录鉴权我们只是将用户状态放在了内存里实际项目中肯定要放在数据库中可以拜读下大神文章里面说到了数据库的操作。再次致敬本文完整代码请戳github                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序&PHP 获取小程序码 并改变其中间logo的方法               微信小程序全局Toast尝试思路                                                        原作者: 小心夹手                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • java实现微信小程序登录态维护                                                      • 微信小程序中做用户登录与登录态维护的实现详解                                                      • 基于bmob快速搭建小程序用户模块（包括登录、当前用户、用户安全） ...                                                      • 微信小程序登录换取token                                                      • 微信用户访问小程序的登录过程                                                      • 手把手教会你小程序登录鉴权                                                      • Serverless 微信小程序-登录                                                      • 微信小程序AES解密失败                                                                                               "},{"title": "小北微信小程序之--新建和编辑相册（小程序的表单提交） ", "author": "                  Rolan                  2017-11-7 00:08                ", "text": "                                                                                                                                                                                     之前相册的数据都是我们使用种子脚本模拟出来的本节我们尝试从小程序端直接提交数据到yii2服务器。在本节我们要学习到如下知识小程序的form功能yii2中restful的create和update方法的使用这一次我们依然从服务端开始服务器端我们知道使用GET /xcx/albums 是触发了index这个action那么create和update那？也是有的当我们对接口发起POST /xcx/albums代表create同理PUT /xcx/albums/xxx 代表update。我们先来说create简单尝试一下如下图我先给yii2模拟一个post请求看看是否会有新数据很不错在我没有对服务器代码进行任何改动的情况下已经成功插入了数据当然这面临着1个问题就是对于album表记录created_at和updated_at并没有赋值关于它们方法有很多比如前台传入时间戳、后台对create action进行重写当然还有一种方法也是我们即将采用的方法那就是使用yii2的TimestampBehavior行为类它将作用于模型Album如下图设置完以后我们再测试下起作用了小提示：yii2的行为是一门比较大的教程我们干货区也有讲解可以从http://nai8.me/sapper-index.h... 链接进入共14篇文章。现在我们已经知道了create接口如何玩接下来看看update在yii2的restful中如果对一个已经存在的记录进行更新需要如下规则 PUT /xcx/albums/xxx 其中xxx代表这个记录的ID比如PUT /xcx/albums/6 就是要更改id=6的相册其中form部分就是更新的内容我们来模拟一个记录。果然数据库被修改了。以上就是create和update接口现在服务器端我们都知道如何做了接下来就是小程序的部署。小程序在小程序端我们计划增加一个新建按钮点击后跳转到一个页面完成相册新建功能因此我对相册列表页面做了如下配置小提示：关于样式的问题大家可以参考项目中的list.wxss文件这里就不做讲解。我设计了一个相册表单提交页面如下图这里面有几点要说的表单form首先是在小程序中form的用法它有固定的步骤及能携带的组件数据(switch、input、checkbox、slider、radio、picker)将含有能提交数据的组件用form包起来并至少要指定bindsubmit=\"abc\"这代表表单提交后有对应js中的abc()方法进行接收。在表单中需要有一个button用来点击提交它且规定这个button的formType必须为submit满足以上两个条件后基本的表单提交就可以完成。小提醒：在js端接收form里各组件数据的方法和html很像是根据wxml内各组件的name属性获取的。我们在add.js中定义一个formSubmit方法用于接收表单数据。这个方法有一些要说的今后你也会经常用到。1 上面我们说定义了表单内每个组件的name在js函数内我们可以通过e.detail.value.name来获取对应的值。2 因为我们要提交一个数据因此method必须为POST如果是更新则为PUT3 在这里我告诉小程序本次请求发送的data格式为jsonok开始提交~0.1秒过去了OMG失败了~~~~根据yii2的响应说明两点数据的验证失败name不能为空这说明了一点就是yii2并没有识别出我们传递过去的name=2这是为什么那？还记得我们是什么格式传递的么？json对在这里你要注意小提示：默认情况下yii2的restful只能解析application/x-www-form-urlencoded 和 multipart/form-data类型的请求内容。那么第一种方法是不要传递json类型的数据但是我想将小程序的所有请求和响应都用json因此我必须去配置yii2让其能解析json类型请求。打开你的web.php找到request组件配置增加一个解析器如下图现在再实验一下哈哈哈成功了。总结上面的教程让我们完成了一次数据的提交我们总结下小程序有自己的form和我们使用html+js提交表单差不多yii2的restful默认不支持json类型的请求内容但是可以配置对于yii2的restfulPOST新数据成功后会返回这条记录。关于更新操作因为更新操作和新建操作的高度重合性本篇我们不再做讲解代码中会实现大家可以去github拉下来看下 https://github.com/abei2017/xgh下一篇到现在我们已经有了相册下一篇我们将讲解为某一个相册传图片的实现你也将学到如何使用小程序选择/拍摄照片以及上传到服务器等等。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小北微信小程序教程之 -- 下拉刷新和上拉加载               js和微信小程序路由（页面）跳转拦截                                                        原作者: 阿北                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小北微信小程序之小白教程系列之-- Hello World                                                      • 小北微信小程序之小白教程系列之 -- 入口                                                      • 小北微信小程序之小白教程系列之 -- 样式（WXSS）                                                      • 小北微信小程序之小白教程系列之 -- 脚本语言（WXS）                                                      • 小北微信小程序之小白教程系列之 -- 项目实战（小乖猴助手小程序） ...                                                      • 小北微信小程序教程之 -- 实现完整的相册列表逻辑（小程序端&服务器端） ...                                                      • 小北微信小程序教程之 -- 下拉刷新和上拉加载                                                      • 如何实现微信小程序与.net core应用服务端的无状态身份验证                                                      • 小北微信小程序之-- 添加照片（小程序图片上传功能）                                                      • 小北微信小程序教程之-- 上传视频                                                      • 小北微信小程序教程之-- 相册内容浏览                                                      • 记录位置和想法以时间线形式来展示的微信小程序                                                      • 微信小程序：从本地相册选择图片或使用相机拍照                                                                                               "},{"title": "微信小程序的日期选择器 ", "author": "                  Rolan                  2017-9-28 00:15                ", "text": "                                                                                                                                                                                                                                                                 关于微信小程序中的日期选择器大家用过都会发现有个很大的问题 就是在2月的时候会有31天没有进行对闰年的判断等各种情况。看了 官方文档提供的源码后进行了一些修改测试修复了上面所说的bug！ 下面源码：jsconst date = new Date();//获取系统日期const years = []const months = []const days = []const bigMonth = [1,3,5,7,8,10,12]//将日期分开写入对应数组//年for (let i =1990; i <= date.getFullYear(); i++) {years.push(i);}//月for (let i =1; i <= 12; i++) {months.push(i);}//日for (let i =1; i <= 31; i++) {days.push(i);}Page({/*** 页面的初始数据*/data: {years: years,year: date.getFullYear(),months: months,month: 2,days: days,day: 2,value: [9999, 1, 1],},showToask: function() {wx.showToast({title: '成功',icon: 'success',duration: 2000})},赞赏                                                               邀请                                                                                                                                                                                      鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)shikanghui                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序使用Socket               小北微信小程序之小白教程系列之-- Hello World                                                        原作者: qq_32486147                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序小技巧系列《八》picker-view日期选择器获取用户openId ...                                                      • 小程序踩坑记《二》页面关闭数据传递picker的日期bug                                                      • 微信小程序入门：滑块视图容器(swiper)滚动选择器(时间日期选择器) ...                                                      • wxss 编译错误for循环中页面跳转,搜索关键词高亮获取 今天 明天 后天的日期 ...                                                      • 扩展微信小程序框架功能：日期时间Moment.js                                                      • javascript时间戳和日期字符串相互转换(也适合微信小程序)                                                      • 支付宝小程序日期选择组件 datePicker 封装                                                                                                                                                                       0 条回复                                                                        \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                                                                                   jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092508|9d9ea83d64b0e0571c3d45b51d4646cc|2';\t\t\t\t\t\t"},{"title": "小北微信小程序教程之-- 上传视频 ", "author": "                  Rolan                  2017-11-17 00:24                ", "text": "                                                                                                                                                                                     服务端其实对于yii2程序而言如果不考虑转码、获取帧等事情上传图片和上传一个视频差别并不大我们还是先来构造接口实现。考虑到在我们的程序中视频和照片都是存储在photo_item表中通过type字段加以区分因此我们仍然使用 /xcx/PhotoItemController这个控制器但是create动作已经被上传图片使用了无奈我们需要自定义一个action就叫它add吧。在yii2的restful中自定义路由方法首先在web.php里的urlManager进行设置//web.php[    'class' => 'yii\\rest\\UrlRule',    'controller' => 'xcx/photo-item',    'extraPatterns'=>[        'POST add'=>'add',    ]],设置后我们来写实际的action这里先说明一点就是上传视频和上传图片思路一样只是因为视频体积偏大每次我们设定上传一个。思路：新建photo记录返回小程序后上传具体文件。对于新建photo记录不在说明请参考上一篇文章详细代码请大家参考github本项目仓库。// PhotoItemController.addpublic function actionAdd(){    $video = UploadedFile::getInstanceByName('file');    $body = Yii::$app->getRequest()->getBodyParams();    if($video == false){        throw new Exception('文件上传失败');    }    $ext = $video->getExtension();    $path_result = N8Folder::createItemPath('video',$ext);    $video->saveAs($path_result['save_path']);    $modelClass = $this->modelClass;    $model = new $modelClass();    $model->photo_id = $body['photo_id'];    $model->album_id = $body['album_id'];    $model->path = $path_result['web_path'];    $model->type = 2;    $model->save();    return $model;}ok,服务端暂且到这里接下来开始我们小程序部署。小程序作为一套入门级实战教程我们的重点在于小程序组件和api的讲解因此对于上传视频我仍然采用和上传照片完全一致的思路看下图。在这里我们要做如下事情选择或拍摄视频并判断是否符合标准上传视频第一步 生成photo记录这一步和上一篇相同我把代码贴过来自行看下我们的重点不在这里。formSubmit: function (e) {    var that = this;    var desc = e.detail.value.desc;    if (that.data.albumIndex < 0) {        wx.showToast({            title: '请选择相册',        })        return;    }    var albumId = that.data.albums[that.data.albumIndex].id;    wx.showLoading({ title: '提交中' });    wx.request({        method: 'POST',        data: {            album_id: albumId,            description: desc        },        url: 'http://xgh.local.com/xcx/photos',        header: {            'content-type': 'application/x-www-form-urlencoded'        },        success: function (res) {        }    });}当我们通过上面方法成功新建photo记录后小程序可以拿到此刻photo的id接下来我们上传视频。在上传之前我们研究下如何选择和拍摄视频。在视频这块微信小程序提供了2个APIwx.chooseVideo 选择视频wx.saveVideoToPhotosAlbum 保持视频到相册在这里我们使用第一个。先贴出来官方文档 https://mp.weixin.qq.com/debu...我们首先在data里设置了一个video字段用来表示选择视频的路径然后在wxml里设置了一个text点击后触发函数addVideo来选择视频// addVideoaddVideo: function () {    var that = this    wx.chooseVideo({        sourceType: ['album', 'camera'],        maxDuration: 60,        camera: 'back',        success: function (res) {            that.setData({                video: res.tempFilePath,        size: (res.size / (1024 * 1024)).toFixed(2)            })        }    })},通过sourceType可以设置 拍摄和选择已经存在的视频两个属性maxDuration来限制拍摄时长。关于chooseVideo成功后的返回还是蛮多的一共5项tempFilePath、duration、size、width、height。总之我们通过上面的方法将video设置了选择视频的路径为了体验好点在视图wxml内我添加了如下代码<view class=\"video-box\" wx:if=\"{{video}}\">    <video class=\"video\" src=\"{{video}}\"></video>    <view style=\"text-align:center;color:green;font-size:14px;padding-top:7px;\">当前视频大小为{{size}}M</view></view>通过对video的判断来决定是否显示小视频预览在这里我们用了小程序的video组件以后会详细说明。我们来看一下成果。效果还不错现在流程顺了我们需要回过头来再去处理上面的formSubmit函数有两件事情点击提交前对视频的判断生成photo记录后对视频的上传判断我们判断两个参数一个是必须选择一个是尺寸不能大于2MformSubmit: function (e) {    var that = this;    var desc = e.detail.value.desc;    if (that.data.albumIndex < 0) {        wx.showModal({            title: '小乖猴助手',            content: '请选择相册'        })        return;    }    var albumId = that.data.albums[that.data.albumIndex].id;    if (that.data.video == false) {        wx.showModal({            title: '小乖猴助手',            content: '请录制或选择一个小视频'        })        return false;    }    if (that.data.size > 1024 * 1024 * 2) {        wx.showModal({            title: '小乖猴助手',            content: '很抱歉视频最大允许2M当前为' + (that.data.size / (1024 * 1024)).toFixed(2) + 'M'        })        return false;    }    .......}没什么难度if而已。接下来处理上传当获取了photo记录后将视频上传上去知道哪个函数了吧对就是uploadFile看代码formSubmit: function (e) {    ....    wx.request({        method: 'POST',        data: {            album_id: albumId,            description: desc        },        url: 'http://xgh.local.com/xcx/photos',        header: {            'content-type': 'application/x-www-form-urlencoded'        },        success: function (res) {            if (res.statusCode == 201) {                var photo = res.data;                wx.showLoading({ title: '视频上传中' });                wx.uploadFile({                    url: 'http://xgh.local.com/xcx/photo-items/add',                    method: 'POST',                    filePath: that.data.video,                    header: {                        'content-type': 'multipart/form-data'                    },                    name: 'file',                    formData: {                        photo_id: photo.id,                        album_id: photo.album_id                    },                    success: function (r) {                        wx.hideLoading();                        wx.showModal({                            title: '小乖猴助手',                            content: '上传成功',                        })                    },                    fail: function (r) {                    }                })            }        }    });}ok,成功了就这样我们轻松实现了视频上传功能有上一篇做基础我想很多方法你已经很熟悉了吧详细代码稍后会放到github上大家可以拉下来看下。https://github.com/abei2017/xgh                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序：新组件web-view详解（2017.11.02新增）               小北微信小程序教程之-- 相册内容浏览                                                        原作者: 阿北                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小北微信小程序之小白教程系列之-- Hello World                                                      • 小北微信小程序之小白教程系列之 -- 入口                                                      • 小北微信小程序之小白教程系列之 -- 样式（WXSS）                                                      • 小北微信小程序之小白教程系列之 -- 脚本语言（WXS）                                                      • 小北微信小程序之小白教程系列之 -- 项目实战（小乖猴助手小程序） ...                                                      • 小北微信小程序教程之 -- 实现完整的相册列表逻辑（小程序端&服务器端） ...                                                      • 小北微信小程序教程之 -- 下拉刷新和上拉加载                                                      • 小北微信小程序之--新建和编辑相册（小程序的表单提交）                                                      • 小北微信小程序之-- 添加照片（小程序图片上传功能）                                                      • 小北微信小程序教程之-- 相册内容浏览                                                      • 小北微信小程序教程之-- 服务器端接口restful配置                                                      • 微信小程序腾讯视频插件的使用                                                                                               "},{"title": "小北微信小程序教程之-- 相册内容浏览 ", "author": "                  Rolan                  2017-11-17 00:30                ", "text": "                                                                                                                                                                                     在本篇你讲学到的知识有image和video组件yii2中restfule的prepareDataProvider方法的使用当然这一切还是从服务端开始服务器从逻辑上说就是点击一个相册后将属于这个相册的所有photo记录都拿出来这应该是yii2中restful的index方法但是有一个问题就是调用index方法的时候需要传递一个参数过去album_id！而默认情况下使用index方法的时候是无法传递参数的好在yii2已经为我们提供了一个函数用来处理这方面需求 --- prepareDataProvider我们首先重载下PhotoItemController的index方法如下代码public function actions() {    $actions = parent::actions();    unset($actions['create']);    $actions['index']['prepareDataProvider'] = [$this,'prepareDataProvider'];    return $actions;}yii2的restful针对于index方法内置了一个prepareDataProvider方法用来准备数据集记录我们通过对其重写编写来设置带有album_id的查询条件。于是我重写了prepareDataProvider方法public function prepareDataProvider(){    $params = Yii::$app->request->queryParams;    $query = Photo::find()->where(['album_id'=>$params['album_id']]);    $provider = new ActiveDataProvider([        'query'=>$query    ]);    return $provider;}通过Yii::$app->request->queryParams获取本次请求的get参数将得到的$params['album_id']传递给ActiveDataProvider获取具体相册的photo记录。看看效果图更多关于yii2的restful方法可以在这里学习 http://nai8.me/course-book.ht...小程序当点击某个相册的时候我希望每个photo记录按照上传时间降序排序并且在photo记录的列表页也会呈现出图片和视频。好东西要一口一口吃我先实现photo列表而不考虑图片和视频问题。为此我在album文件夹内新建了一个view的page它由album/list点击而来。获取photo记录的思路和之前讲过的获取相册列表一样。首先在data里设置一个album_id并在页面 onLoad 的时候由相册列表页传递过来id对其赋值。根据album_id从服务器分页形式获取photo记录集合并渲染给视图。我想你对上面的实现已经胸有成竹了吧我将从后台获取数据的代码写一下（更详细的代码请从github上拉下来）loadList: function () {    if (hadLastPage != false) {        wx.showToast({            title: '到底了',        })        return;    }    var that = this;    wx.request({        method: 'GET',        url: 'http://xgh.local.com/xcx/photo-items',        data: {            fields: 'id,name,description',            album_id:that.data.album_id,            page: page        },        header: {            'content-type': 'application/json'        },        success: function (res) {            var listData = that.data.photos;            for (var i = 0; i < res.data.length; i++) {                listData.push(res.data[i]);            }            if (res.header[\"X-Pagination-Page-Count\"] == res.header[\"X-Pagination-Current-Page\"]) {                hadLastPage = res.header[\"X-Pagination-Current-Page\"];            } else {                page++;            }            that.setData({                photos: listData            });        },    })}现在相册的photo记录已经存到了view页面的photos中接下来放到wxml渲染出来看下方代码<view class=\"photos\">    <block wx:for=\"{{photos}}\" wx:key=\"id\" wx:for-index=\"idx\" wx:for-item=\"photo\">        <view class=\"photo\">            <view class=\"desc\">{{photo.description}}</view>        </view>    </block></view>看看效果图优化photo列表这样是不够的我们还要进一步进行优化首先优化图片类photo我希望每个photo介绍下面直接是2*2形式的图片矩阵。也就是说我在获取每个photo的同时还要顺便获取其下的photo_item。但是photo数据表是没有photo_item字段的幸好我们的yii2有那个extraFields方法开始部署吧首先我在小程序从后台获取photo记录的请求data中重新设置如下data: {    fields: 'id,name,description,type',    album_id:that.data.album_id,    expand: 'photos',    page: page},然后针对photo模型增加如下方法public function extraFields() {    return [        'photos'    ];}public function getPhotos(){    $data = PhotoItem::find()->where(['photo_id'=>$this->id])->all();    $return = [];    foreach($data as $item){        $return[] = [            'path'=>Yii::$app->request->getHostInfo().\"/static/\".$item->path        ];    }    return $return;}现在再看看相册详情页面photo记录的服务器响应数据达到目的现在开始渲染视图有个特别情况需要说下当photo记录的photos照片返回一个的时候,就不要2*2了直接显示即可。因此我对相册详情的视图进行了如下优化。<view class=\"photos\">    <block wx:for=\"{{photos}}\" wx:key=\"id\" wx:for-index=\"idx\" wx:for-item=\"photo\">        <view class=\"photo\">            <view class=\"desc\">{{photo.description}}</view>            <view class=\"items\">                <block wx:for=\"{{photo.photos}}\" wx:if=\"{{photo.photos.length==1}}\" wx:key=\"id\" wx:for-index=\"pidx\" wx:for-item=\"photoItem\">                    <image src=\"{{photoItem.path}}\" style=\"width:10em;height:10em;\"></image>                </block>                <block wx:for=\"{{photo.photos}}\" wx:if=\"{{photo.photos.length>1}}\" wx:key=\"id\" wx:for-index=\"pidx\" wx:for-item=\"photoItem\">                    <image src=\"{{photoItem.path}}\" style=\"width:5em;height:5em;display:inline-block;\"></image>                </block>            </view>        </view>    </block></view>看看效果我们的目的初步达到了。遗留的问题聪明的你一定发现了一些问题最明显的就是图片尺寸问题应该等比例且真实长宽要适配设备另外最好显示压缩图。这些的确是真实存在的问题别急下节将为你解决。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)luckjoe                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小北微信小程序教程之-- 上传视频               浅谈微信小程序前端生态                                                        原作者: 阿北                   来自: segmentfault.com                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小北微信小程序之小白教程系列之-- Hello World                                                      • 小北微信小程序之小白教程系列之 -- 入口                                                      • 小北微信小程序之小白教程系列之 -- 样式（WXSS）                                                      • 小北微信小程序之小白教程系列之 -- 脚本语言（WXS）                                                      • 小北微信小程序之小白教程系列之 -- 项目实战（小乖猴助手小程序） ...                                                      • 小北微信小程序教程之 -- 实现完整的相册列表逻辑（小程序端&服务器端） ...                                                      • 小北微信小程序教程之 -- 下拉刷新和上拉加载                                                      • 小北微信小程序之--新建和编辑相册（小程序的表单提交）                                                      • 小北微信小程序之-- 添加照片（小程序图片上传功能）                                                      • 小北微信小程序教程之-- 上传视频                                                      • 记录位置和想法以时间线形式来展示的微信小程序                                                      • 小北微信小程序教程之-- 服务器端接口restful配置                                                      • 微信小程序：从本地相册选择图片或使用相机拍照                                                      • 小程序之保存图片到相册的几种方法                                                                                               "},{"title": "小北微信小程序之-- 添加照片（小程序图片上传功能） ", "author": "                  Rolan                  2017-11-11 00:37                ", "text": "                                                                                                                                                                                     在上一篇中我们搞定了相册的新建和列表功能本节我们尝试往相册内传图功能这需要小程序和服务器端的双重支持。还是老规矩我们先实现服务器端。服务器端我们需要数据库的支持还记得第8篇说的那个photo数据表么在这里我们进行一次修改然后再新增一个表。相册表存储每次照片的提交以及对本次提交的备注。相册图片表实际存储每个照片包含图片的路径等其中photo_id为photo表的主键ID。现在有了数据表我们再做两个控制器分别用来服务于photo和photo_item表。接下来我们来计划一下添加相片的逻辑看下图。当点击了“提交”按钮后会新家一条photo记录然后返回给小程序小程序开始实际的传图过程并携带新photo记录的id来填充photo_item表。这里有一点要注意的就是针对于photo记录的新建直接使用yii2的restful --- create 就可以了但是对于传图不一样涉及到接收图片、存储等等等等。因此我们对PhotoItemController的create方法进行了重写如下图这里也为你展示了yii2中restful如何重写内置的action。然后我们自己定义一个create看下图。通过yii2的UploadedFile类来接收小程序过来的图片并且保持同时建立一条记录。其中的N8Folder::createItemPath主要用于生成有效的物理路径感兴趣的可以在github仓库上看看。ok接下来我们来处理小程序端小程序在小程序端分两步1、请求服务器POST /xcx/photos 新建一条photo记录（所属相册、描述）2、新建photo记录成功携带文件请求POST /xcx/photo-items 新建一条photo_item记录（所属相册ID、photoID、图片路径、类型等）正式开始新建一条photo记录这个过程涉及到了一个小程序组件 -- picker也就是滚动选择器它能接收一个数组或对象数组我们这里使用它来选择所属相册先看效果。当页面准备好后我们去服务器拿到相册列表看代码。代码实现了如何把对象数据渲染成选择器。接下来我们就可以提交数据新建photo了这仍是一个表单事件formSubmit当然为了体验在用户端并不会感觉到photo和photo_item新建之间的差别只需点击一次按钮。因此在提交表单时候我们需要对是否选择了相册以及是否传图进行判断。关于photo记录的建立并不复杂我们之前学过新建相册思路都一样POST /xcx/photos 即可要说的是上传图片我们看下面的代码在上面的代码中涉及到一个循环因为我可能一次选择多个图片然后点击提交所以核心是这个uploadImage函数我们来看一看它。这涉及到wx.uploadFile函数这是微信小程序内置的用来上传一个文件有几个点要说下绿色框 要上传文件资源的路径也就是我们相册里选择的图片路径。蓝色框 文件对应的 key在yii2上通过这个名字获得文件对象。红色框 有时候上传文件的时候还需要一些其他数据可以都放到formData内。这样就完成了上传图片功能。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序异步处理               微信小程序语音识别服务搭建全过程解析（https api开放支持新接口mp3录音、老接口si ...                                                        原作者: 阿北                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小北微信小程序之小白教程系列之-- Hello World                                                      • 小北微信小程序之小白教程系列之 -- 入口                                                      • 小北微信小程序之小白教程系列之 -- 样式（WXSS）                                                      • 小北微信小程序之小白教程系列之 -- 脚本语言（WXS）                                                      • 小北微信小程序之小白教程系列之 -- 项目实战（小乖猴助手小程序） ...                                                      • 小北微信小程序教程之 -- 实现完整的相册列表逻辑（小程序端&服务器端） ...                                                      • 小北微信小程序教程之 -- 下拉刷新和上拉加载                                                      • 小北微信小程序之--新建和编辑相册（小程序的表单提交）                                                      • 小北微信小程序教程之-- 上传视频                                                      • 小北微信小程序教程之-- 相册内容浏览                                                      • 微信小程序基于万象优图实现图片 OCR                                                                                               "},{"title": "微信小程序开发一些经验 ", "author": "                  Rolan                  2018-5-16 00:14                ", "text": "                                                                                                                                                                                     对于微信小程序开发入门还是比较简单的只需要具备基本的css+js知识就可以了成本比较低。 写了小程序和RN之后有一种原生很笨重的感觉就是小程序或者是RN等这些新的开发方式在效率上面真的有比较大的优势唯一不足就是运行速度了(使用Canvas就会有这样子的感觉)。 感觉目前所接触的种类前端开发(包括移动端)都是基本一个套路：UI网络数据保存富文本图片/视频。 本文也是从这几个方向去总结自己的小程序开发经验。小程序的入门其实小程序的开发过程一直都是查看文档按照文档去操作就可以了。 一般流程是先看简易教程。看完之后再去看组件。之后可以开始尝试写需求这个过程中开始不断的去查API和框架即可。多列列表在开发中有一个需求是需要实现类似Android的GridView网格列表的。但是微信中并没有提供这样子的组件但是小程序是跟html/css前端很类似的他可以通过指定 display:flex 然后去设置 flex-wrap:wrap 就可以。例如有一个数组 data:[\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\"] 需要显示为一个三列的列表可以如下处理：//GridPage.wxml<view class='grid-container'>  <view wx:for=\"{{data}}\" wx:key=\"{{item}}\" class=\"grid-list\">  <view class='grid-item'>  <text class='grid-item-text'>{{item}}</text>  </view>  </view></view>//GridPage.wxssPage {  min-height: 100%;  background-color: #fff;}.grid-container {  margin-left: 4rpx;  margin-right: 4rpx;  display: flex;  flex-wrap: wrap;  flex-direction: row;}.grid-list {  width: 33.33%;}.grid-item {  margin: 2rpx;  background: #999;  display: flex;  justify-content: center;  align-items: center;}.grid-item-text {  color: black;}这里的重点就是 grid-container 中的 flex-wrap 为 wrap 方向是 row 了。然后他的每一个item宽度都是 33.33% 。需要注意的是一定是去设置外部的contanier而不是内部的list。层级布局在CSS中需要使用层级布局就是类似Android的FrameLayout效果可以使用z-index也可以使用一个绝对定位。比如我们有一个需求是：下面是一个图片上面是文字。//PositionPage.wxml<view class='root'><image src='https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=3756982450,995202616&fm=27&gp=0.jpg' class='image'></image><text class='text'>我是权律二啊</text></view>//PositionPage.wcss.root{  align-items: center;  display: flex;  flex-direction: column;  position: relative;}.image{  width: 300rpx;  height: 300rpx;}.text{  background-color: #999;  position: absolute;}主要是两点：父布局的 position 必须是 relative 它本身 position 必须是 absolute。网络请求小程序的网络请求是使用wx.request()方法但是该方法太臃肿并没有使用Promise那样子简洁。幸运的是小程序支持Promise所以我们可以把http封装一下变成有条理。说到这里大家做的时候需要注意去微信后台配置各种request域名upload域名downloadFIle域名。 下面封装的例子的数据返回格式都是json格式post请求方式发出的://真正发起请求function _request(url, param) {    if (isDebug) {        Log.i(\"http==> params->\" + JSON.stringify(param));        Log.i(\"http==> url->\" + url);    }    return new Promise((resolve, reject) => {        wx.request({            url: url,            data: param,            header: {                'content-type': 'application/json',                \"Accept\": \"application/json\"            },            method: \"POST\",            success: function (response) {                if (isDebug) {                    const jsonResponse = JSON.stringify(response);                    Log.i(\"http==> response->\" + jsonResponse);                }                const {data, statusCode, ok = false} = response;                //只有ok为true的是时候才返回成功data不一定是包含数据的                if (statusCode === 200 && data && data.ok) {                    resolve(data, ok);                } else {                    if (statusCode != 404 && statusCode < 500 && statusCode > 300) {                        ToastUtil.showError();                    }                    reject(data);                }            },            fail: reject        });    });}使用：function getInfo(fid) {    const params = {};    params.token = user.token;    params.uid = user.uid;    return _request(\"INFO_URL\", params);}然后需要发起请求就调用该方法即可处理Promise。上传图片到阿里云需要注意微信upload接口配置目前好像不可以直接配置阿里云的URL需要阿里云先 跟我们的域名绑定之后再去把设置到微信后台的upload接口中。可以参考博客： 小程序图片上传阿里OSS使用方法 获取签名阿里云Demo地址： JavaScript客户端签名直传 通过打log获得policy和signature（签名时间可以稍微设置久一点）之后就开始封装upload方法了。 如下：/**    * 真实上传代码    */    function _upload(file, success, fail) {        const suffix = file.substring(file.lastIndexOf(\".\"));        //做一下md5处理        const fileName = hex_md5(file);        Log.i(\"fileName=\" + (fileName + suffix));        wx.uploadFile({            url: ALIYUNPHOTOADDRESS,            formData: {                \"OSSAccessKeyId\": \"你的阿里云accessKey\",                \"key\": DIR+ (fileName + suffix),                \"policy\": \"你的policy\",                \"success_action_status\": '200',                \"signature\": \"你的signature\"            },            filePath: file,            name: 'file',            success: function (res) {                const {statusCode} = res;                if (statusCode === 200) {                    console.log(JSON.stringify(res));                    success(\"\" + fileName + suffix);                } else {                    console.log(\"上传失败\");                    fail(res);                }            },            fail: function (e) {                fail(e);                console.log(\"上传失败\");                console.log(\"e=\" + JSON.stringify(e));            }, complete: function () {                console.log(\"上传过程结束\");            }        })    }}其中 url 是上传OOS的地址key是需要上传的文件夹+上传之后的文件名。这里的fileName我们通过一个md5去计算得来保证唯一性又没有什么特殊字符。md5的算法来自JS-MD5加密。我们可以顺带封装一个上传多张图片的方法,而且使用Promise返回：/*** files需要上传的文件是一个数组,里面是文件的绝对路径*/function uploadFiles(files) {  if (!files || files.length <= 0) {    wx.showModal({      title: '图片错误',      content: '请重试',      showCancel: false,    });    return Promise.reject();  }  Log.i(\"开始上传\" + files);  return new Promise((resolve, reject) => {    //上传成功的文件名称    let uploadPaths = [];    for (let i = 0; i < files.length; i++) {      _upload(files[i], (path) => {        //成功的文件名        uploadPaths[uploadPaths.length] = path;        if (uploadPaths.length >= files.length) {          //把url+name返回          resolve([ALIYUNPHOTOADDRESS + \"/\" +DIR, uploadPaths]);        }      }, () => {        //error        reject(res);      });    }  });Canvas使用由于需要使用Canvas画一棵树所以还是在这里走了比较多的坑的。我的需求是Canvas全屏除了画一个树之外还需要画别的一些独立Button。 首先设置Canvas全屏和不可滑动可以通过以下方式：<canvas  disable-scroll='true' style=\"width: {{width}}px; height: {{height}}px;background-color:#efeff4;flex:1;\" canvas-id=\"canvas\" bindtouchstart=\"touchStart\" bindtouchmove=\"touchMove\" bindtouchend=\"touchEnd\"></canvas>其中在设置了disable-scroll设置为true同时需要绑定三个touch事件才能响应画布的触摸event。其中这里的width+height是通过wx.getSystemInfo()获得。其次canvas没有类似View的catchtap事件只有一些touch事件详情可以看Canvas然后在微信小程序中Canvas是层级最高的无法通过设置z-index去调所以假如你的Canvas全屏还需要一些其他的Button那么只能通过最后canvas去draw了。在canvas中假如通过moveTo+lineTo去画线一般需要先调用canvas.beginPath()画完成之后先调用canvas.stoke()然后在调用canvas.closePath();c.beginPath();    c.setLineWidth(this.arrowPaint.width);    c.setStrokeStyle(this.arrowPaint.color);    c.setLineCap(\"square\");    c.moveTo(this.arrowStartPointF.x, this.arrowStartPointF.y);    c.lineTo(this.arrowCenterPointF.x, this.arrowCenterPointF.y);    c.moveTo(this.arrowCenterPointF.x, this.arrowCenterPointF.y);    c.lineTo(this.arrowEndPointF.x, this.arrowEndPointF.y);    c.stroke();    c.closePath();在连续画多种图片/线条的时候不要连续多次调用draw(true)方法 消耗性能一般最后调用fill()/stoke()方法即可。比如//绘制点        c.beginPath();        let y = node.noteView.pointFrameCenter.y + Constant.FRAME_HEIGHT / 2 + Constant.GAP_BETWEEN_DOT + Constant.RADIUS_DOT;        c.setFillStyle(Constant.LINE_COLOR_RED);        c.setLineWidth(Constant.LINE_WIDTH);        c.arc(node.noteView.pointFrameCenter.x, y, Constant.RADIUS_DOT, 0, 2 * Math.PI);        //        y += (Constant.GAP_BETWEEN_DOT + Constant.RADIUS_DOT);        c.arc(node.noteView.pointFrameCenter.x, y, Constant.RADIUS_DOT, 0, 2 * Math.PI);        //        //        y += (Constant.GAP_BETWEEN_DOT + Constant.RADIUS_DOT);        c.arc(node.noteView.pointFrameCenter.x, y, Constant.RADIUS_DOT, 0, 2 * Math.PI);        c.fill();        c.closePath();对于draw方法建议只是调用draw()就好不要调用draw(true)方法draw(true)是在原画布之上再去画不会清空旧画布draw()会清空。一般我们会在所有的imagerectangleline,circle去fill/stoke完之后再调用draw()方法这样子就可以避免draw(true)多次性能耗损。而且再次去reDraw的时候也不用先去清空画布。Canvas的跟随手势拖动//index.wxml  <canvas disable-scroll='true' style=\"width: {{width}}px; height: {{height}}px;background-color:#efeff4;\" canvas-id=\"canvas\" bindtouchstart=\"touchStart\" bindtouchmove=\"touchMove\" bindtouchend=\"touchEnd\"></canvas>//index.wcssPage {  overflow: hidden;  display: flex;}//index.jsconst app = getApp()Page({  data: {    width: 0,    height: 0,  },  onLoad: function (e) {    this.time = (new Date()).valueOf();    this.x = 0;    this.y = 0;    this.moveX = 0;    this.moveY = 0;    const that = this;    wx.getSystemInfo({      success: function (res) {        that.setData({ width: res.screenWidth, height: res.screenHeight })      },    })    const ctx = wx.createCanvasContext(\"canvas\", this)    this.canvas = ctx;  },  onReady: function () {    this.draw();  },  draw: function () {    this.canvas.fillRect(10, 10, 150, 100)    this.canvas.fill();    this.canvas.draw()  },  touchMove: function (e) {    console.log(\"touchMove\")    let xOffset = e.touches[0].x - this.x;    let yOffset = e.touches[0].y - this.y;    this.x = e.touches[0].x;    this.y = e.touches[0].y;    this.moveX = this.moveX + xOffset;    this.moveY = this.moveY + yOffset;    this.canvas.translate(this.moveX, this.moveY);    this.draw();  },  touchStart: function (e) {    this.x = e.touches[0].x;    this.y = e.touches[0].y;  },  touchEnd: function (e) {    console.log(\"touchEnd\")  }})其他的scale等方法类似。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (3)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)wSheary_鹏63wssying87CHUN                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    杨春文：小程序在直播产品中的技术应用               （干货）微信小程序转发好友                                                        原作者: 黎伟杰                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序个人开发者的经验总结                                                      • 微信小程序实例--洗衣小程序开发经验分享                                                      • 微信小程序豆瓣电影项目的改造过程经验分享                                                      • 《王者荣耀周边商城》经验总结                                                      • 前端开发微信小程序的个人经验总结–持续更新【原创】                                                      • 小程序审核发布经验                                                      • 微信小程序开发--『狗蛋TV』                                                                                               "},{"title": "微信小程序实现多折叠展开酷炫菜单 ", "author": "                  Rolan                  2018-4-10 00:22                ", "text": "                                                                                                                                                                                     在另一篇文章《2018年设计趋势指南》中发现一款菜单不错就想着用微信小程序实现先把成果摆上来开始正题上方Nav基本 flex 布局再加个 padding 不需要多讲吧?提一下微信小程序里input的placeholder样式是写在 placeholder-style 里或使用 placeholder-class下方菜单每个小卡片遵从 flex 布局设置 width: 50% 别忘了 flex-wrap: wrap每个小卡片内部同为 flex 布局并设置垂直居中想了想还是科普下:.main-view-item{  display: flex;  justify-content: center;  align-items: center;  width: 50%;}flex真他娘的好用至于里面的图片是从iconfont上拿的调这几个配色的时间是我布局时间的几十倍....动画微信小程序的动画只能用JS常规手段不可用来个头脑风暴hack起来观察每个卡片的折叠方向后为每个卡片添加初始 rotate 使其反向折叠我在这里定义了两个Class.rotateX90{  transform: rotateX(-90deg);}.rotateY90{  transform: rotateY(-90deg);}好了这样就看不到卡片了然后给菜单按钮添加点击事件改变卡片的rotate就Ojbk啦var duration = 150var item1 = wx.createAnimation({  duration: duration,  transformOrigin: '0 0 0'})item1.rotateX(90).step()this.setData({  item1: item1,  item1Style: 'item1Style'})这里注意调整 transformOrigin 来控制折叠方向对于后面的卡片在 createAnimation 中添加 delay 字段即可(差为 duration 的等差数列)是不是很简单嗯?至于菜单的收回代码和展开差不多就是反过来而已不过有些展开的顺序和 transformOrigin 需要注意这里还是贴一个代码吧:var duration = 150var item3 = wx.createAnimation({  duration: duration,  transformOrigin: '100% 100% 0',  delay: duration * 2})item1.rotateX(90).step()this.setData({  item3: item3,  item3Style: ''})另外我在 data 里设置了两个变量 isShow 和 isShowing 来判断菜单是否展开或者正在展开来控制点击事件具体实现这里就不讲了                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (3)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)wxapp123w^O^19阿花❀                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序silk格式转码成mp3格式               WeScale 技术篇 —— mpvue 与微信小程序的火花                                                        原作者: addone                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序菜单实现                                                      • 微信小程序快速开发-食堂菜单案例                                                      • 微信小程序开发问答《六十六》 菜单内容左右联动 & MD5加密 ...                                                      • 微信小程序组件 分页菜单带下划线焦点切换                                                      • 微信小程序 类似弹出菜单特效从右向左滑出                                                                                               "},{"title": "从零入门系列《二》手动创建目录结构 ", "author": "                  天下雪                  2016-12-9 00:21                ", "text": "                                                                                                                                                                                                                                                                 作者：loveDodream-zzt；来自原文地址需求: 1. 屏幕打印红色字体 你好 ;        2. 自定义全局应用对象的方法getString, 在index.js页面实现etString方法*****************************************************************本文以这一个例子讲解如何手动创建项目目录结构, 步骤如下:1. 填写项目名称和目录注意: 因为要手动创建目录结构, 所以上图中不要勾选!!2.新建目录这里就按照官方目录结构创建, 大家看起来比较方便, 步骤如图: 目录如下:3.需求1界面代码3.1 app.json界面的代码如下: {     \"pages\": [       \"pages/index/index\"     ] }通过pages来添加要加载页面的路径, 注意这里不要写文件的后缀, 写在最前边的路径就是最先加载的文件3.2 index.wxml界面代码如下:<text>你好</text>用text标签来添加文本。 3.3 index.wxss界面代码如下:text{    color: red;}到此需求1已经完成, 运行结果如图:4.需求2界面代码4.1 app.js界面代码如下:  App({   onLaunch () {      console.log('加载')    },      //自定义的函数    getString () {      console.log('自定义的函数')    } })通过系统函数App来生成一个程序实例, 在其中有常见的生命周期函数, 在这里自定义函数getSting4.2 index.js界面代码如下: //通过getApp方法拿到应用程序对象 const app = getApp() Page({  onLoad () {     const string1 = app.getString()     console.log(string1)   } })通过getApp方法拿到应用程序对象,这里对象命名为app, 以此来用app对象获取getSrting方法, 通过Page函数生成一个页面实例,在加载页面时完成需求2, 运行结果如图:5. 注意其中可能出现的问题如图:这说明在app.json文件中没有加载入口文件。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            github精选：微信小程序说明：数据绑定及条件渲染,列表渲染               微信小程序框架详解（直播分享）                                                        原作者: loveDodream-zzt                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 理解微信小程序技术架构                                                                                               "},{"title": "从微信小程序看待FlexBox布局 ", "author": "                  天下雪                  2017-2-14 00:05                ", "text": "                                                                                                                                                                                     正文开始学习微信小程序时需要掌握最基本的UI布局有了UI的布局才是一个开始。下面主要通过一些例子来聊聊FlexBox布局其实它和ReactNative大同小异。所以学习一门技术其它的也就不愁了。下面主要通过一些例子来说明FlexBox是如何布局的。FlexBox概述Flex container（容器）承载子视图的一个容器也就是说一个视图如果设置成display: flex;那么它就是作为一个Flex container。其中它的子视图称为FlexItem。主轴（Main axis）:主轴也就是水平轴它决定了Flex item的布局的方向。也就是子视图的布局方向是从水平方向开始。main-start | main-end主轴的起点和结束点。main sizeFlex container占主轴的空间。纵轴（cross axis）垂直于主轴的轴成为纵轴也叫交叉轴。cross-start | cross-end纵轴的起点和结束点。cross sizeFlex container占纵轴的空间。一、容器属性介绍display：flex如果想采用FlexBox布局必须设置 .container { display: flex; },这样这个视图将作为一个Flex container。flex-direction：row | row-reverse | column | column-reverse;它决定了子视图的布局方向默认的布局方向是row。me.wxml文件<view class=\"container\">  <view class=\"children1\"></view>  <view class=\"children2\"></view>  <view class=\"children3\"></view></view>me.wxss文件.container {  display: flex;  background-color: lightblue;}.children1 {  width: 100rpx;  height: 100rpx;  background-color: red;}.children2 {  width: 100rpx;  height: 100rpx;  background-color: yellow;}.children3 {  width: 100rpx;  height: 100rpx;  background-color: purple;}flex-direction:column垂直方向布局从上到下布局flex-direction: column-reverse;垂直方向布局从下到上布局flex-direction: row;默认水平方向布局从左到右布局.container {    display: flex;    flex-direction: row;    background-color: lightblue;}flex-direction: row-reverse;水平方向布局从右到左布局flex-wrap：nowrap | wrap | wrap-reverse；默认情况下flex items是在一行进行布局使用flex-wrap可以改变flex items进行多行布局。默认情况微信小程序是采用的nowrap,它试图采用一行对flex items进行布局。.container {  display: flex;  flex-direction: row;  flex-wrap: nowrap;  background-color: lightblue;}.container {    display: flex;    flex-direction: row;    flex-wrap: wrap;    background-color: lightblue;}flex-flow: 是flex-direction 和 flex-wrap属性的简写你可以这样定义。.container {  display: flex;  flex-flow: row wrap;  background-color: lightblue;}justify-content:flex-start | flex-end | center | space-between | space-around;flex items 在主轴上的对其方式。flex-start从主轴开始位置开始布局；flex-end从主轴结束位置开始布局；center居中布局；space-between第一个flex item在主轴的main-start最后一个flex item在主轴的main-end位置；space-around:开始于结束的flex item所占的空间是中间flexItem直接距离的一半中间flexItem之间的间距一样。.container {    display: flex;    flex-flow: row wrap;    justify-content: space-around;    background-color: lightblue;}.container {    display: flex;    flex-flow: row wrap;    justify-content: space-between;    background-color: lightblue;}align-items：flex-start | flex-end | center | baseline | stretch; flex item在纵轴方向的对其方式。与主轴的布局大同小异。flex-start:布局的起点为cross-start；flex-end:布局的起点为cross-end；center:居中布局；baseline:与基线对其；stretch:默认的属性但是它依据flex item 的min-height和max-height.flex-container {  height: 400rpx;  display: flex;  flex-direction: row;  justify-content: space-around;  align-items: stretch;  background-color: lightblue;}.children1 {  width: 100rpx;  min-height: 100rpx;  background-color: red;}align-content:flex-start | flex-end | center | space-between | space-around | stretch;。多行时纵轴的对齐方式如果只有一行它是没有作用的。.flex-container {  height: 400rpx;  display: flex;  flex-direction: row;  justify-content: space-around;  align-items: stretch;  flex-wrap: wrap;  align-content: flex-end;  background-color: lightblue;}.children1 {  width: 600rpx;  height: 100rpx;  background-color: red;}.children2 {  width: 600rpx;  height: 100rpx;  background-color: yellow;}.children3 {  width: 600rpx;  height: 100rpx;  background-color: purple;}二、Flex item属性介绍order：控制Flex item的顺序.children1 {  width: 100rpx;  height: 100rpx;  order: 3;  background-color: red;}flex-grow: 它必须是一个整数它表示如何分配剩余的空间只越大他所分配的剩余空间就越大。.children1 {  width: 20rpx;  flex-grow: 1;  height: 100rpx;  background-color: red;}.children2 {  width: 100rpx;  height: 100rpx;  background-color: yellow;}.children3 {  width: 100rpx;  flex-grow: 2;  height: 100rpx;  background-color: purple;}flex-shrink: 它必须是一个整数它表示如何缩小Flex item当空间不足时是否要缩小。.children1 {  width: 1000rpx;  flex-shrink: 2;  height: 100rpx;  background-color: red;}.children2 {  width: 100rpx;  height: 100rpx;  flex-shrink: 0;  background-color: yellow;}.children3 {  width: 1000rpx;  flex-shrink: 3;  height: 100rpx;  background-color: purple;}flex-basis:属性定义了在分配多余空间之前项目占据的主轴空间（main size）,他可以是固定的宽度也可以是百分比。.children1 {  height: 100rpx;  flex-basis: 50%;  background-color: red;}flex: 它是flex-grow, flex-shrink 和flex-basis的缩写。默认值为0 1 auto。align-self:auto | flex-start | flex-end | center | baseline | stretch;表示单独一个Flex item的对其方式。参考：阮一峰Flex box guide                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序的this和that触摸水波涟漪效果               小程序框架总结                                                        原作者: Lefe                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发教程：Flex布局                                                      • 微信小程序控件学习：view的flex布局《上》                                                      • 微信小程序控件学习：view的flex布局《下》                                                      • 水牛01248：flex布局学习笔记                                                      • 新手布局福音！微信小程序使用flex的一些基础样式属性                                                      • Flexbox in CSS可视化文档（英文版）                                                      • 微信小程序开发之——flex布局（附源码下载）                                                      • 水牛01248：flex布局示例                                                      • 在微信小程序中学习flex布局                                                      • 官方问答精选《十五》ios8不支持flex布局客服接口接收参数                                                      • 微信小程序页面布局方式flexbox -温故而知新                                                      • 微信小程序开发flex布局总结                                                      • 微信小程序 View：flex 布局                                                      • flex实现小程序导航                                                      • 微信小程序开发--从block盒式布局到Flex弹性布局                                                                                               "},{"title": "微信小程序（创建页面、设置页面标题） ", "author": "                  Rolan                  2017-11-3 00:08                ", "text": "                                                                                                                                                                                     好了 hello world 创建好了 咱开始写页面了那么如何创建一个简单的页面呢废话不多说开始撸代码 新建一个页面需要以下几步：1. 在pages 中添加一个目录（当然如果你觉得写在现有的目录里面就好 那这一步就省略啦）点击左侧的 编辑  -->  点中 pages 文件夹  -->   点击右上角的  +  号  --> 在下拉菜单中选择 目录  --> 弹出框中 填写目录 名称 （这里我们写了test）--> 点击 确定2. 新建一个wxml 文件选中 test  文件夹 --> 点击 右上角  + 号  --->  选择  wxml 类型 文件  --> 填入文件名  （注意 这里必须填写 后缀名 至少 我的版本是必须填入的）3. 编辑test.wxml 文件为了方便测试 我们随便 填写点内容进去4. 创建test.js文件使用同样的方法在test 目录下创建一个 test.js 文件5. 将test 页面加入 app.json在pages 属性中 加入一条 test 页面所在的目录 这里是相对路径 首部不必填写 /6. 在首页加入访问链接好了 上面路径也加好了 我们得加个入口 才能看到自己写的页面啊  小程序的首页一般是默认显示 pages 属性中的第一条路径所指向的页面  如果我们不想破坏原有的 那么 我们直接找到首页  pages/index/index.wxml  添加一个链接7. 访问一且准备就绪 点击左下角的 “编译”出现如下 页面  然后 点击 “”跳转test页面“” 哇哈哈看到了没你的页面做好了！！！（注意所有页面编辑后 请按 ctrl + s 保存键）设置页面标题页面写好了总感觉哪里不爽对就是那每个页面的标题都一样都是 Wechatcou 呀 真cou, 那咱就单独说说如何设置 页面标题。找到所在页面的目录新建一个 json 文件比如我们上一次建造的 test 页面我们  找到 pages/test/ 目录 新建一个 test.json 文件 加入如下代码 效果如下：是不是很霸气这节就写这么多下节更精彩！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小北微信小程序之小白教程系列之 -- 脚本语言（WXS）               微信小程序的tab选项卡的实现                                                        原作者: 酷酷的抖s                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序上传头像                                                      • 送给将要写小程序的你                                                      • 微信小程序通讯录demo（校园教职工通讯录）                                                      • 微信小程序：开发之前要知道的三件事                                                      • 微信小程序开发入门与实践                                                      • 微信小程序中获取access_token                                                      • 如何跳出小程序五级页面的限制                                                                                               "},{"title": "微信小程序 View：flex 布局 ", "author": "                  天下雪                  2017-2-16 00:03                ", "text": "                                                                                                                                                                                                                                                                 微信小程序 View 支持两种布局方式：Block 和 Flex所有 View 默认都是 block要使用 flex 布局的话需要显式的声明：display:flex; 下面就来介绍下微信小程序的 Flex 布局先做一个简单的 demo  <view class=\"main\">    <view class=\"item item1\">1</view>    <view class=\"item item2\">2</view>    <view class=\"item item3\">3</view>  </view>加上背景色能看的更清楚些.main {  width: 100%;  background-color: antiquewhite;}.item {  height: 100rpx;  width: 100rpx;}.item1 {  background-color: red;}.item2 {  background-color: dodgerblue;}.item3 {  background-color: greenyellow;}然后大概是这个样子的： 然后我们先都加上  display: flex好使用 flex 布局主意貌似 view 不会自动继承需要在每个想使用的 view 里都加上。 首先是横向布局和竖向布局要设置属性 flex-direction ,它有4个可选值：row：从左到右的水平方向为主轴row-reverse：从右到左的水平方向为主轴column：从上到下的垂直方向为主轴column-reverse：从下到上的垂直方向为主轴我们来看下设置 row 和 row-reverse 的区别：row： row-reverse：  然后我们要设置元素在横向上的布局方向需要设置 justify-content 属性它有5个值可选：flex-start：主轴起点对齐(默认值)flex-end：主轴结束点对齐center：在主轴中居中对齐space-between：两端对齐除了两端的子元素分别靠向两端的容器之外其他子元素之间的间隔都相等space-around：每个子元素之间的距离相等两端的子元素距离容器的距离也和其它子元素之间的距离相同  然后我们要设置元素在纵向上的布局方向需要设置 align-items 属性它有5个值可选：stretch 填充整个容器(默认值)flex-start 侧轴的起点对齐 （这里我们手动设置下子 view 的高度来看的明显一些）flex-end 侧轴的终点对齐center 在侧轴中居中对齐baseline 以子元素的第一行文字对齐  子 View 还有个属性 align-self可以覆盖父元素的 align-items 属性它有6个值可选：auto | flex-start | flex-end | center | baseline | stretch （auto 为继承父元素 align-items 属性其他和 align-items 一致）比如上面最后一个 baseline 的例子我们把 item3 设置 align-self:flex-end;就成了这个样子：  此外还有 flex-wrap 属性用于控制子 View 是否换行有3个值可选：nowrap：不换行（默认）wrap：换行wrap-reverse：换行第一行在最下面 还有子 View 有个 order 属性可以控制子元素的排列顺序默认为0。比如还是上面那个例子我们把 item3 设置 order:-1; 可以把 item3 排在前面 flex 常用布局就这些写微信小程序的可以试试 最后要是啥时候小程序能直接支持 bootstrap 就更好了…                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            image组件binderror实例使用百度api获取天气信息               微信小程序下拉刷新上拉加载的两种实现方法使用评测                                                        原作者: sun8134                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发教程：Flex布局                                                      • 微信小程序控件学习：view的flex布局《上》                                                      • 微信小程序控件学习：view的flex布局《下》                                                      • 水牛01248：flex布局学习笔记                                                      • 新手布局福音！微信小程序使用flex的一些基础样式属性                                                      • Flexbox in CSS可视化文档（英文版）                                                      • 微信小程序开发之——flex布局（附源码下载）                                                      • 水牛01248：flex布局示例                                                      • 在微信小程序中学习flex布局                                                      • 官方问答精选《十五》ios8不支持flex布局客服接口接收参数                                                      • 微信小程序页面布局方式flexbox -温故而知新                                                      • 微信小程序开发flex布局总结                                                      • 从微信小程序看待FlexBox布局                                                      • flex实现小程序导航                                                      • 微信小程序开发--从block盒式布局到Flex弹性布局                                                                                               "},{"title": "在微信小程序中学习flex布局 ", "author": "                  天下雪                  2016-12-28 00:16                ", "text": "                                                                                                                                                                                                                                                                 网页布局（layout）是CSS的一个重点应用。布局的传统解决方案基于盒状模型依赖display属性 + position属性 + float属性。它对于那些特殊布局非常不方便比如垂直居中就不容易实现。2009年W3C提出了一种新的方案----Flex布局可以简便、完整、响应式地实现各种页面布局。目前它已经得到了所有浏览器的支持这意味着现在就能很安全地使用这项功能。Flex布局将成为未来布局的首选方案。本文介绍它的语法下一篇文章给出常见布局的Flex写法。以下内容主要参考了下面两篇文章：A Complete Guide to Flexbox 和 A Visual Guide to CSS3 Flexbox Properties。一、Flex布局是什么？Flex是Flexible Box的缩写意为\"弹性布局\"用来为盒状模型提供最大的灵活性。任何一个容器都可以指定为Flex布局。.box{ display: flex;}行内元素也可以使用Flex布局。.box{ display: inline-flex;}Webkit内核的浏览器必须加上-webkit前缀。.box{ display: -webkit-flex; /* Safari */ display: flex;}注意设为Flex布局以后子元素的float、clear和vertical-align属性将失效。二、基本概念采用Flex布局的元素称为Flex容器（flex container）简称\"容器\"。它的所有子元素自动成为容器成员称为Flex项目（flex item）简称\"项目\"。容器默认存在两根轴：水平的主轴（main axis）和垂直的交叉轴（cross axis）。主轴的开始位置（与边框的交叉点）叫做main start结束位置叫做main end；交叉轴的开始位置叫做cross start结束位置叫做cross end。项目默认沿主轴排列。单个项目占据的主轴空间叫做main size占据的交叉轴空间叫做cross size。三、容器的属性以下6个属性设置在容器上。flex-directionflex-wrapflex-flowjustify-contentalign-itemsalign-content3.1 flex-direction属性flex-direction属性决定主轴的方向（即项目的排列方向）。.box { flex-direction: row | row-reverse | column | column-reverse;}它可能有4个值。row（默认值）：主轴为水平方向起点在左端。row-reverse：主轴为水平方向起点在右端。column：主轴为垂直方向起点在上沿。column-reverse：主轴为垂直方向起点在下沿。3.2 flex-wrap属性默认情况下项目都排在一条线（又称\"轴线\"）上。flex-wrap属性定义如果一条轴线排不下如何换行。.box{ flex-wrap: nowrap | wrap | wrap-reverse;}它可能取三个值。（1）nowrap（默认）：不换行。（2）wrap：换行第一行在上方。（3）wrap-reverse：换行第一行在下方。3.3 flex-flowflex-flow属性是flex-direction属性和flex-wrap属性的简写形式默认值为row nowrap。.box { flex-flow: <flex-direction> || <flex-wrap>;}3.4 justify-content属性justify-content属性定义了项目在主轴上的对齐方式。.box { justify-content: flex-start | flex-end | center | space-between | space-around;}它可能取5个值具体对齐方式与轴的方向有关。下面假设主轴为从左到右。flex-start（默认值）：左对齐flex-end：右对齐center： 居中space-between：两端对齐项目之间的间隔都相等。space-around：每个项目两侧的间隔相等。所以项目之间的间隔比项目与边框的间隔大一倍。3.5 align-items属性align-items属性定义项目在交叉轴上如何对齐。.box { align-items: flex-start | flex-end | center | baseline | stretch;}它可能取5个值。具体的对齐方式与交叉轴的方向有关下面假设交叉轴从上到下。flex-start：交叉轴的起点对齐。flex-end：交叉轴的终点对齐。center：交叉轴的中点对齐。baseline: 项目的第一行文字的基线对齐。stretch（默认值）：如果项目未设置高度或设为auto将占满整个容器的高度。3.6 align-content属性align-content属性定义了多根轴线的对齐方式。如果项目只有一根轴线该属性不起作用。.box { align-content: flex-start | flex-end | center | space-between | space-around | stretch;}该属性可能取6个值。flex-start：与交叉轴的起点对齐。flex-end：与交叉轴的终点对齐。center：与交叉轴的中点对齐。space-between：与交叉轴两端对齐轴线之间的间隔平均分布。space-around：每根轴线两侧的间隔都相等。所以轴线之间的间隔比轴线与边框的间隔大一倍。stretch（默认值）：轴线占满整个交叉轴。四、项目的属性以下6个属性设置在项目上。orderflex-growflex-shrinkflex-basisflexalign-self4.1 order属性order属性定义项目的排列顺序。数值越小排列越靠前默认为0。.item { order: <integer>;}4.2 flex-grow属性flex-grow属性定义项目的放大比例默认为0即如果存在剩余空间也不放大。.item { flex-grow: <number>; /* default 0 */}如果所有项目的flex-grow属性都为1则它们将等分剩余空间（如果有的话）。如果一个项目的flex-grow属性为2其他项目都为1则前者占据的剩余空间将比其他项多一倍。4.3 flex-shrink属性flex-shrink属性定义了项目的缩小比例默认为1即如果空间不足该项目将缩小。.item { flex-shrink: <number>; /* default 1 */}如果所有项目的flex-shrink属性都为1当空间不足时都将等比例缩小。如果一个项目的flex-shrink属性为0其他项目都为1则空间不足时前者不缩小。负值对该属性无效。4.4 flex-basis属性flex-basis属性定义了在分配多余空间之前项目占据的主轴空间（main size）。浏览器根据这个属性计算主轴是否有多余空间。它的默认值为auto即项目的本来大小。.item { flex-basis: <length> | auto; /* default auto */}它可以设为跟width或height属性一样的值（比如350px）则项目将占据固定空间。4.5 flex属性flex属性是flex-grow,flex-shrink 和 flex-basis的简写默认值为0 1 auto。后两个属性可选。.item { flex: none | [ <'flex-grow'> <'flex-shrink'>? || <'flex-basis'> ]}该属性有两个快捷值：auto (1 1 auto) 和 none (0 0 auto)。建议优先使用这个属性而不是单独写三个分离的属性因为浏览器会推算相关值。4.6 align-self属性align-self属性允许单个项目有与其他项目不一样的对齐方式可覆盖align-items属性。默认值为auto表示继承父元素的align-items属性如果没有父元素则等同于stretch。.item { align-self: auto | flex-start | flex-end | center | baseline | stretch;}该属性可能取6个值除了auto其他都与align-items属性完全一致。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)wx_b3242889d5hhhh                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            Flexbox in CSS可视化文档（英文版）               微信小程序如何设计才能更受欢迎？                                                                                                                                                                /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发教程：Flex布局                                                      • 微信小程序控件学习：view的flex布局《上》                                                      • 微信小程序控件学习：view的flex布局《下》                                                      • 水牛01248：flex布局学习笔记                                                      • 新手布局福音！微信小程序使用flex的一些基础样式属性                                                      • Flexbox in CSS可视化文档（英文版）                                                      • 微信小程序开发之——flex布局（附源码下载）                                                      • 水牛01248：flex布局示例                                                      • 新手跳坑指南《六十六》：路径path坑；相对路径与绝对路径                                                      • 微信小程序页面布局方式flexbox -温故而知新                                                      • 从微信小程序看待FlexBox布局                                                      • 微信小程序 View：flex 布局                                                      • flex实现小程序导航                                                                                               "},{"title": "微信小程序性能二三事 ", "author": "                  Rolan                  2017-10-30 00:17                ", "text": "                                                                                                                                                                                     小程序代码在ios上很溜但是安卓机上性能问题很多低端安卓机对性能调优更是要求贼高稍不注意页面就能卡死。性能问题基本都是cpu不够用导致的卡顿这种卡顿可能是1）dom太大内存爆满 2）js操作频繁js进程繁忙 3）渲染问题可能是被js阻塞了也有可能是所在环境的渲染机制不够优化在本次为小程序开发的双十一会场页面时总结出以下经验。存在的性能问题及解决方案在开发中发现在低端机上几个小程序端需要注意的事：dom大了后bindtap事件会不灵敏短时间连续触发的bindtap事件后续的会丢失。原生小程序测试时3000个dom节点就有丢失现象。后来尝试了使用touchstart和touchend去模拟发现虽然touchstart很灵敏但是touchend会丢失（个人猜测小程序的tap事件也是通过touchstart和touchend模拟的）。我们的大促会场600个商品时我算了下大约13000个dom节点低端安卓机事件丢的很严重间隔几乎是秒级别才能触发下一次事件。所以解决方案只能减小dom量添加dom懒加载和动态移除的逻辑经过多次测试比较理想的效果是预加载2屏2）滚动时setState卡顿严重如果滚动时有触发setState操作那么setState成功可能发生在几秒后即使滚动操作在几百ms内就结束了。这就导致导航类功能的滚动跟随效果在安卓机上反应特别慢滚停到某个商品楼层后过了1-2s才导航条才突然动一下所以最终取消了安卓的滚动跟随效果。（不根据版本取消效果是因为发现即使是安卓最新的7.1版本在性能不好的机器上也会这样）3）白屏问题快速疯狂滚动页面前面的页面没渲染出就不停的往后滚发现小程序不是优先渲染可视区域而是一定要把曾经滚过的区域按顺序渲染了。所以如果快速疯狂滚动后面的内容白屏等待时间会很久。考虑到正常用户不会有这种需求想看后面的内容可以通过楼层导航过去而且这个问题我们也找不到解决方案所以这个现象没有处理。注意事项1）懒加载+动态移除非可视范围内的内容让dom小下去2）耗时的js操作异步化不要阻塞主线程。落地一点说小程序里不要做频繁的setState操作不在state里放跟视图层无关的内容。譬如我之前为了代码清晰把导航功能模块里的楼层位置信息放到了视图层也用的一个变量里其实视图层并不直接用到这个信息这个信息为了准确又会在每次滚动后重新计算导致频繁setState且set的是跟视图层无关的数据优化后性能提升很明显。3）还有跟小程序本身相关的wx.createSelectorQuery系列接口都是异步的会受主进程影响如果主进程繁忙这个接口返回时间会延迟很久也是s级别的对于楼层导航和懒加载这种需要页面各模块位置信息的功能不能每次操作都等这个接口返回可以缓存数据取缓存然后用户的操作触发调接口更新缓存在缓存有更新时为了更准确也可以主动触发下需要位置信息的后续处理函数。4）少用scroll-view这个组件对性能影响实在太大单纯的只是需要一块可滚动区域请用css+view解决5）不知道微信的小程序做了什么滚动操作时进程异常繁忙滚动停止后很久才是可操作和执行js状态所以尽量少的触发在滚动时的回调函数节流函数必须合理用起来。性能调优是个漫长的取舍过程需要不断测试来获取最优效果。cpu只有那么多一段时间只能干那么多事那就要干效果最好最重要的事。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从微信小程序看promsie.all和promise顺序执行               你真的了解小程序的自定义编译功能嘛？                                                        原作者:  echizen                   来自: 推酷                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 从微信小程序看promsie.all和promise顺序执行                                                      • 王者荣耀故事站小程序（nuxt + 小程序）                                                      • 微信小程序-getUserInfo回调的实例详解                                                      • 任务列表中显示\"小程序\"的原理分析                                                      • gulp构建小程序                                                      • 小程序页面跳转解析                                                      • 微信小程序通讯录demo（校园教职工通讯录）                                                                                               "},{"title": "给微信聊天记录添加截图功能 ", "author": "                  Rolan                  2018-4-11 00:10                ", "text": "                                                                                                                                                                                     有时候知识小集群里讨论的技术问题比较有价值我们会把有价值的内容整理出来供大家查阅。但为了保护群友隐私需要把昵称和头像都打码如果碰到几百条聊天记录这样做简直要吐血。而且也不能截一张长图只能一张一张截取然后拼接起来。群聊记录只能在微信内分享这也限制了传播的渠道。为了提高小集成员工作效率想着能不能给微信做个插件解决这些问题。我们一直在追求如何更有效率开展我们的工作比如使用脚本自动整理每周小集内容使用微信小程序给读者更好阅读体验。（呀还有脚本如果你还不知道那肯定没有点 star 吧 传送门 ）知识小集公众号知识小集是一个团队公众号每周都会有 原创 文章分享我们的文章都会在公众号首发。知识小集微信群短短几周时间目前群友已经300+人很快就要达到上限（抓住机会哦）关注公众号获取加群方式。提出问题通过以上痛点可以确定我们要解决的问题主要有：截图：把所有的聊天记录截一张长图并保存到相册；截图（马赛克）：把所有的聊天记录截一张长图并保存到相册需要把群友的头像和昵称打码；预览：预览打码后的效果。如何解决下面这张图是聊天记录页面点击导航右边按钮会弹出 ActionSheet。从图中可以看出添加截图功能在 ActionSheet 上添加是不错的选择。我们下面主要的工作是：1.拿到 ActionSheet 并添加3个菜单（截图截图（马赛克）预览）2.找到聊天记录所在的页面找到展示消息的视图；3.获取 ActionSheet 点击菜单对应的事件；4.实现截取长图并保存到相册功能；5.对头像和昵称打马赛克；6.添加版权信息。实现本文使用 MonkeyDev 工具开发（无需越狱）重点是教你如何开发一个微信插件并不打算介绍工具。关注我们的朋友应该都知道以往的 #iOS知识小集 中我已经介绍了三个工具的使用。这三个工具在下面会用到。给 ActionSheet 添加3个菜单使用 Reveal 工具查看聊天记录页面对应的 VCActionSheet 对应的类名。如何使用 Reveal 调试第三方 APP网上有很多教程。使用 MonkeyDev 无需越狱。通过上图可以看到聊天记录所对应的VC是 MsgRecordDetailViewController 使用 MMTableView 展示聊天内容。弹出的 ActionSheet 对应的类为 WCActionSheet , 可以发现它是一个 UIWindow 。 那么我们看看这几个类中的内容吧。使用 class-dump 查看第三方 APP 的头文件。在 #iOS知识小集 中已经介绍过这个工具的使用。在 MsgRecordDetailViewController 的头文件中发现有一个 WCActionSheet *favImgLongPressAction; 我们可以断定出 WCActionSheet 就是我们要找的 ActionSheet。好了接下来主要就是看 WCActionSheet 的头文件挖掘有用的信息。WCActionSheet头文件@property(strong, nonatomic) NSMutableArray *buttonTitleList;- (void)showInView:(id)arg1;- (long long)addButtonWithItem:(id)arg1 atIndex:(unsigned long long)arg2;- (long long)addButtonWithTitle:(id)arg1 atIndex:(unsigned long long)arg2;- (long long)addButtonWithTitle:(id)arg1;我们的目标是给 WCActionSheet 添加3个菜单。下面这些方法似乎对我们有用。目前想到有两种方案：1.在 buttonTitleList 中添加一个对象我们所关心的最主要的问题是 buttonTitleList 中存放的的对象是什么？需要使用Cycript工具这个工具在以往的 #iOS知识小集 介绍过想了解的朋友可以在知识小集小程序中搜索 Cycript调试第三方APP 。通过 Cycript 可以看到 buttonTitleList 中存放的对象是 WCActionSheetItem 。我们看看 WCActionSheetItem 的头文件发现其实就是一个 Model 对象用来表示菜单的标题颜色等等。@interface WCActionSheetItem : NSObject @property(copy, nonatomic) NSString *titleColor;@property(copy, nonatomic) NSString *title; - (id)initWithTitle:(id)arg1 fontSize:(long long)arg2 fontColor:(id)arg3 WithDesc:(id)arg4 descFontSize:(long long)arg5 descFontColor:(id)arg6 enable:(_Bool)arg7;- (id)initWithTitle:(id)arg1;看到这里我们可以直接在 buttonTitleList 中添加 WCActionSheetItem 实例即可。2.直接调用 addButtonWithTitle: 方法从上图可以看出直接调用 addButtonWithTitle: 这个方法返回一个 Index 为 3说明可以直接调用这个方法。接下来主要的问题是找到添加菜单的时机。第一想到的是在 WCActionSheetDelegate 的代理中添加菜单果断在 MsgRecordDetailViewController 中 Hook 下面这3个代理方法但是通过实验证明发现最后两个方法并没有被调用因为 MsgRecordDetailViewController 并没有实现这两个代理只好放弃了这种思路。- (void)actionSheet:(id)arg1 clickedButtonAtIndex:(long long)arg2;- (void)didPresentActionSheet:(WCActionSheet *)arg1;- (void)willPresentActionSheet:(WCActionSheet *)arg1;无奈之下看到 WCActionSheet 中有个 showInView: 方法 可以直接 Hook 这个方法。但这样导致所有的 WCActionSheet 都会被添加了额外的菜单。而我们的目的只是在聊天记录页中的 WCActionSheet 显示截图菜单。所以用 [WeChatSaveData defaultSaveData].isNeedAddMenu 加了一个判断isNeedAddMenu 在 MsgRecordDetailViewController 页面将要出现的时候设置成 YES在页面将要消失的时候设置成 NO。所以需要 Hook MsgRecordDetailViewController 的 viewWillAppear: 和 viewWillDisappear: 方法。CHOptimizedMethod1(self, void, WCActionSheet, showInView, UIView *, view){    if ([WeChatSaveData defaultSaveData].isNeedAddMenu) {        // 方案一        [self addButtonWithTitle:@\"\"]; // 填坑        [self addButtonWithTitle:kScreenshotTitle];        [self addButtonWithTitle:kScreenshotTitleMask];                // 方案二       WCActionSheetItem *shotItem = [[objc_getClass(\"WCActionSheetItem\") alloc] initWithTitle:kScreenshotTitle];        WCActionSheetItem *shotItem2 = [[objc_getClass(\"WCActionSheetItem\") alloc] initWithTitle:kScreenshotTitleMask];        [self.buttonTitleList addObject:shotItem];        [self.buttonTitleList addObject:shotItem2];    }    CHSuper1(WCActionSheet, showInView, view);}执行结果如下图：找到聊天记录页面和展示消息的视图MsgRecordDetailViewController头文件@interface MsgRecordDetailViewController: UIViewController{    MMTableView *m_tableView;}- (void)viewWillAppear:(_Bool)arg1;- (void)viewWillDisappear:(_Bool)arg1;- (void)actionSheet:(id)arg1 clickedButtonAtIndex:(long long)arg2;- (UITableViewCell *)tableView:(id)arg1 cellForRowAtIndexPath:(id)arg2;@end通过对 MsgRecordDetailViewController 头文件分析可以达到截图功能只需要截取 TableView 为一张长图即可。获取到 MsgRecordDetailViewController 实例使用 KVC 的方式即可获取到 MMTableViewMMTableView *tableView = [viewController valueForKeyPath:@\"m_tableView\"];实现截取长图的功能保存到相册首先需要 Hook actionSheet: clickedButtonAtIndex: 捕获菜单的点击事件做截图功能。CHOptimizedMethod2(self, void, MsgRecordDetailViewController, actionSheet, WCActionSheet*, sheet, clickedButtonAtIndex, int, index){    CHSuper2(MsgRecordDetailViewController, actionSheet, sheet, clickedButtonAtIndex, index);    [WeChatCapture saveCaptureImageWithSheet:sheet index:index viewController:self];}saveCaptureImageWithSheet 这个方法中主要获取到 MMTableView 并截图保存到相册。有兴趣可以看源码。对头像和昵称打马赛克为了保护用户的隐私需要对用户的头像和昵称做保护那么我们可以在 TableView 的代理中获取头像和昵称对应的 View然后替换 View 的内容即可。需要 Hook cellForRowAtIndexPath 这个方法。CHOptimizedMethod2(self, UITableViewCell *, MsgRecordDetailViewController, tableView, MMTableView *, tableViewArg, cellForRowAtIndexPath, NSIndexPath, *indexPath){    UITableViewCell *cell = CHSuper2(MsgRecordDetailViewController, tableView, tableViewArg, cellForRowAtIndexPath, indexPath);    [WeChatCapture updateCellDataWithCell:cell indexPath:indexPath];    return cell;}获取到 Cell 如果当前是要打码截图需要对头像和昵称的内容做处理。这里做一个特殊的处理头像和昵称我们换成三国人物的头像的名字。+ (void)updateCellDataWithCell:(UITableViewCell *)cell indexPath:(NSIndexPath *)indexPath{    if ([WeChatSaveData defaultSaveData].maskType == WeChatSaveDataMaskTypeMast || [WeChatSaveData defaultSaveData].maskType == WeChatSaveDataMaskTypePreview) {        NSArray *subviews = [cell.contentView subviews];        FavRecordBaseNodeView *nodeView = [subviews lastObject];        if ([NSStringFromClass([nodeView class]) hasSuffix:@\"NodeView\"]) {            UILabel *nickNameLabel = [nodeView valueForKey:@\"m_srcTitleLabel\"];            if (nickNameLabel) {                CGRect tempFrame = nickNameLabel.frame;                tempFrame.size.width = 120;                nickNameLabel.frame = tempFrame;            }                        MMHeadImageView *imageView = [nodeView valueForKeyPath:@\"m_headImg\"];            NSString *nickName = [imageView valueForKey:@\"_nsUsrName\"];            WeChatUser *aUser = [[WeChatSaveData defaultSaveData].userNameDict objectForKey:nickName?:@\"\"];            if (!aUser) {                aUser = [WeChatUser user];                [[WeChatSaveData defaultSaveData].userNameDict setObject:aUser forKey:nickName?:@\"\"];            }            nickNameLabel.text = aUser.nickname ?: @\"\";            if (imageView) {                [imageView updateUsrName:aUser.nickname withHeadImgUrl:aUser.icon];            }        }    }}添加版权信息给绘制的长图添加一个小集的版权 by公众号 知识小集 。最终效果（伴随着咔嚓一声一张被打码的照片保存到了相册你可以在任意的渠道分享了）：踩坑WCActionSheet的代理方法Index不对添加额外的菜单后WCActionSheet 的代理方法 actionSheet: clickedButtonAtIndex: 中的 Index 点击取消或空白区域总为 2也就是我添加菜单第一个的 Index。导致每次点击取消或空白区域时都会听到咔嚓一声截图。解决方法就是加一个没有标题的菜单并且高度为 0。收藏的聊天记录也需要有截图功能按着这个思路给收藏中的聊天记录添加截图功能这就是你为什么会在源码中看到 FavRecordDetailViewController 的 Hook。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    WeScale 技术篇 —— mpvue 与微信小程序的火花               如何简单地实现小程序分享页拥有返回首页按钮                                                        原作者: 知识小集                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 截图组件welCropper实现原理及其使用                                                      • 微信小程序截图工具                                                      • 一个同时支持移动端与小程序的聊天机器人                                                      • 微信小程序与AspNetCore SignalR聊天实例                                                                                               "},{"title": "微信小程序时间预约插件（包含日历） ", "author": "                  Rolan                  2017-10-31 00:29                ", "text": "                                                                                                                                                                                                                                                                 因为项目需要做了一个类似电商的时间预约功能觉得有用就独立出来成了个小插件。部分js代码var that=this;    function getThisMonthDays(year, month) {      return new Date(year, month, 0).getDate();    }  // 计算每月第一天是星期几    function getFirstDayOfWeek(year, month) {    return new Date(Date.UTC(year, month - 1, 1)).getDay();    }    const date = new Date();    const cur_year = date.getFullYear();    const cur_month = date.getMonth() + 1;    const cur_date=date.getDate();    const weeks_ch = ['日', '一', '二', '三', '四', '五', '六'];    //利用构造函数创建对象    function calendar(date,week){      this.date=cur_year+'-'+cur_month+'-'+date;      if(date==cur_date){        this.week = \"今天\";      }else if(date==cur_date+1){        this.week = \"明天\";      }else{        this.week = '星期' + week;      }    }    //当前月份的天数    var monthLength= getThisMonthDays(cur_year, cur_month)    //当前月份的第一天是星期几    var week = getFirstDayOfWeek(cur_year, cur_month)    var x = week;    for(var i=1;i<=monthLength;i++){      //当循环完一周后初始化再次循环      if(x>6){        x=0;      }      //利用构造函数创建对象      that.data.calendar[i] = new calendar(i, [weeks_ch[x]][0])      x++;    }    //限制要渲染的日历数据天数为7天以内（用户体验）    var flag = that.data.calendar.splice(cur_date, that.data.calendar.length - cur_date <= 7 ? that.data.calendar.length:7)    that.setData({      calendar: flag    })    //设置scroll-view的子容器的宽度    that.setData({      width: 186 * parseInt(that.data.calendar.length - cur_date <= 7 ? that.data.calendar.length : 7)    })源代码地址https://github.com/Dorr2333/calendar-and-order.git                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            截图组件welCropper实现原理及其使用               微信小程序评分组件                                                        原作者: 李佳明同学                   来自: 简书                                                                                      /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 webpack 插件                                                      • 微信小程序商城 - 基于ecshop插件接口文件                                                      • 微信小程序 滚动插件 xHSwiper                                                      • 微信小程序图表插件（wx-charts）:饼图、线图、柱状图、区域图 ... ...                                                      • 微信小程序开发--富文本插件wxParse的使用                                                      • 小程序中布局突然乱掉了到底是怎么个情况？                                                      • 万年历—Java计算感恩节是哪天？                                                      • JavaScript简单日历实现-小程序版                                                      • 微信小程序组件 加减号弹出框                                                      • 初探小程序插件                                                      • 微信小程序下订单件插（日历）                                                      • 手把手教你开发微信小程序中的插件                                                      • 技术课 | 开发小程序插件遇到问题？微信开发哥来教你！                                                      • 看大神如何玩转微信小程序日历插件？                                                                                               "},{"title": "自定义组件化开发(附完整示例代码和效果图) ", "author": "                  Rolan                  2017-11-14 00:47                ", "text": "                                                                                                                                                                                     自定义组件我把它分为简单的三个步骤, 1.创建组件 --- 2.编写组件 --- 3.调用,使用组件.第一步:创建组件 创建一个modal文件夹,里面包含 josn.wxml.wcss.js 四个文件,然后在josn里面添加 \"component\":true (作用是声明这一组文件为自定义组件)第二步. 编写组件代码在modal.wxml :[html] view plain copy<view hidden='{{modalHidden}}'>    <view class='mask_layer' bindtap='modal_click_Hidden' />    <view class='modal_box'>      <view class=\"title\">提示</view>      <view class='content'>        <text class='modalMsg'>{{modalMsg}}</text>      </view>      <view class='btn'>        <view bindtap='modal_click_Hidden' class='cancel'>取消</view>        <view bindtap='Sure' class='Sure'>确定</view>      </view>    </view>  </view>在modal.wxss:[css] view plain copy.mask_layer {    width: 100%;    height: 100%;    position: fixed;    z-index: 1000;    background: #000;    opacity: 0.5;    overflow: hidden;  }  .modal_box {    width: 76%;    overflow: hidden;    position: fixed;    top: 50%;    left: 0;    z-index: 1001;    background: #fafafa;    margin: -150px 12% 0 12%;    border-radius: 3px;  }  .title {    padding: 15px;    text-align: center;    background-color: gazure;  }  .content {    overflow-y: scroll; /*超出父盒子高度可滚动*/  }  .btn {    width: 100%;    margin-top: 65rpx;    display: flex;    flex-direction: row;    align-items: center;    justify-content: space-between;    box-sizing: border-box;    background-color: white;  }  .cancel {    width: 100%;    padding: 10px;    text-align: center;    color: red;  }  .Sure {    width: 100%;    padding: 10px;    background-color: gainsboro;    text-align: center;  }  .modalMsg {    text-align: center;    margin-top: 45rpx;    display: block;  }在modal.js[javascript] view plain copyComponent({    properties: {      modalHidden: {        type: Boolean,        value: true      }, //这里定义了modalHidden属性属性值可以在组件使用时指定.写法为modal-hidden      modalMsg: {        type: String,        value: ' ',      }    },    data: {      // 这里是一些组件内部数据      text: \"text\",    },    methods: {      // 这里放置自定义方法      modal_click_Hidden: function () {        this.setData({          modalHidden: true,        })      },      // 确定      Sure: function () {        console.log(this.data.text)      }    }  })第三步, 使用组件这里我是在 pages/index/index 页面调用 pages/modal/modal 自定义组件 首先在index.json中进行引用说明, 这里是设置自定义组件的标签名和引用路径[javascript] view plain copy {    \"usingComponents\": {      \"modal\": \"../modal/modal\"    }  }然后在index.wxml调用组件[html] view plain copy <!-- 调用modal组件 -->  <modal modal-hidden=\"{{is_modal_Hidden}}\" modal-msg=\"{{is_modal_Msg}}\"/>在index.js绑定数据,[javascript] view plain copy Page({    data: {      is_modal_Hidden:false,      is_modal_Msg:'我是一个自定义组件'    }  })效果图:如果需要查看更加详细的文档,可以在官方文档查看, 地址为:https://mp.weixin.qq.com/debug/wxadoc/dev/framework/custom-component/                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 c#后台支付结果回调               微信小程序Http高级封装 es6 promise                                                        原作者: 小天王_jack                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 营销组件--大转盘\\刮刮乐\\老虎机\\跑马灯\\九宫格翻纸牌\\摇一摇\\手势解锁 ...                                                      • 截图组件welCropper实现原理及其使用                                                      • 小程序自定义评分组件（精确度0.1星）                                                      • Min – 小程序组件化解决方案                                                      • 微信小程序评分组件                                                      • 微信小程序日常开发中常遇到的错误代码                                                      • 小程序自定义评分组件 template（精度0.1）                                                      • 微信小程序 - toptip效果                                                      • 微信小程序 - IOS 仿饿了么\"我的\",下拉橡皮筋效果                                                      • 微信小程序组件化的解决方案（上）                                                                                               "},{"title": "微信小程序评分组件 ", "author": "                  Rolan                  2017-11-8 00:34                ", "text": "                                                                                                                                                                                                                                                                 multiple-rate-wxapp微信小程序评分组件 wxapp multiple rate component下载git clone https://github.com/simsir-lin/multiple-rate-wxapp.git预览打开微信web开发者工具'本地小程序项目 - 添加项目'项目目录选择为 multiple-rate-wxapp 的目录就可以了添加项目后就可以进行组件源码的查看和预览demo了。使用将 multiple-rate-wxapp 目录下的components文件夹下的multiple-rate拷贝到你的小程序目录下在你要使用的页面的json文件中引入组件如：index页面的index.json{  \"navigationBarTitleText\": \"首页\",  \"usingComponents\": {    \"multiple-rate\": \"你的目录/multiple-rate/multiple-rate\"  }}在wxml中即可使用组件<multiple-rate rate=\"4\" disabled=\"true\"></multiple-rate>如看不明白请直接参考项目实例(/pages/index/index)注意微信小程序基础库版本至少为1.6.4贡献如果你有好的意见或建议欢迎给我提issue!                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序时间预约插件（包含日历）               微信小程序自定义模态弹窗插件                                                        原作者: simsir-lin                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序自定义评分组件（精确度0.1星）                                                      • 自定义组件化开发(附完整示例代码和效果图)                                                      • 小程序自定义评分组件 template（精度0.1）                                                      • 微信小程序组件 加减号弹出框                                                                                               "},{"title": "Min – 小程序组件化解决方案 ", "author": "                  Rolan                  2017-11-6 00:12                ", "text": "                                                                                                                                                                                     是的我们撸了一个新轮子。在这个前端高速发展的时代撸轮子并不是目的而是解决问题的手段。我们希望通过这个轮子帮助像我们这样的小程序开发者优雅高效的搞定小程序中自定义组件的 开发 和 使用 这 2 个环节为开发者 赋能 。缘起一切的初衷都始于我们希望像下面这样优雅的定义和使用组件：但这并不容易。首先需要微信官方支持以自定义标签的方式来封装组件。我们知道在以往的小程序开发中这样的方式是不支持的。所喜微信团队和我们的想法一致。依托于同微信团队良好的沟通渠道我们团队在第一时间获得了自定义标签组件的内测邀请并开始着手将我们的想法落地。（PS：微信自定义组件功能已于 2017.11.02 日 开始公测 请升级微信版本到 6.5.16 或更高）。其次需要降低组件的开发成本。再次需要便捷的在既有项目中安装、应用和更新组件。组件开发对于组件的开发Min 提供了一整套的开发方案包括范式、工具化环境、Demo 预览小程序、内置化文档、自动编译打包、一键式发布等能力。○ 单文件策略我们知道小程序目前的工程化文件结构是多文件形式（.wxml、.wxss、.js）。为了提供额外的能力封装Min 采用了单文件的方式（.wxc 文件）来开发一个组件一个基于 Min 开发的组件就是一个 npm 包。采用单文件的策略既有对开发者诸如 Vue 单文件开发习惯的考虑同时也基于在单文件的编译环节我们可以做一些额外的赋能 —— 如对 less、postcss 的支持；再如对全局变量、模板、引用路径 Resolve 等支持；抑或通过插件的引入提供其他的额外能力。○ Min CliMin 提供了一套 Cli 工具 （ https://github.com/meili/min-cli） 来帮助开发者快速创建、编译、发布您的组件。通过 $ npm -i -g @mindev/min-cli 您就能获得 Min 提供的一键式能力。通过 $ min init 您可以快速的创建本地的组件开发环境。这个组件开发环境就是一个组件的预览小程序可以通过微信开发者工具便捷的查看组件的运行情况。通过 $ min new *name （*name 是你的组件名）来新建一个组件。通过 $ min dev *name 来开启开发模式 —— 组件的最新改动都会在微信开发者工具中实时的刷新显示。通过 $ min publish *name 来最终发布你的组件发布后的组件即为一个随时可用的 npm 包。○ MinUI同时我们还提供了一套小程序 UI 组件库 这也是我们团队在业务中使用的组件库。您可以通过搜索小程序 “MinUI” 、或通过扫描下方的“小程序二维码”来访问它。当然它也是开源的 �� （ https://github.com/meili/minui）。组件应用对于组件的应用Min 提供了在原有的应用项目中一键式安装、一键式更新组件的能力。并提供了渐进增强的诸如应用全局变量、全局模板等能力支持。后续我们还将以插件化的方式提供诸如代码检测、单测环境等能力支持。○ 组件安装在既有应用下开发者可以通过 $min install *name 来安装一个组件组件默认会安装到项目工程的 packages/ 文件夹下。安装后的组件即可以用小程序通用的方式在页面中引入和使用了。○ 组件更新对于组件的更新你可以使用 $ min update *name 来一键搞定。○ 渐进增强Min 同时提供了一些应用全局性的渐进增强能力以供开发者选择性使用。但这需要付出一点额外的成本。前面提到我们采用单文件 .wxc 的方式来开发一个组件因为在编译环节可以做一些额外的事情这里的 “c” 即为 component 的首字母。同理Min 还提供了 .wxp 和 .wxa来为 page 和 app 提供一些额外的赋能。如果您已经在本地尝试基于 Min 的开发就会发现本地的组件开发环境这个小程序就是基于 .wxp 和 .wxa 来实现的。 ：）短暂的结尾我们希望 Min 能帮助你快速的解决组件开发中的痛点我们也希望这个小 Baby 能够在社区的帮助中快速成长所以我们将 Min 进行了开源。希望有更多的同学通过实际的使用获得收益更希望有改进的建议（吐槽 :p ）、或是共建来帮助稚嫩的 Min 逐渐打磨的趋于成熟。最后再次附带 Github 上项目的开源地址输出才是最好的输入 : )MinUI： https://github.com/meili/minuiMin Cli： https://github.com/meili/min-cli蘑菇街前端团队2017.11.02 于杭州。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序评论框实现               小程序上传视频预览                                                        原作者: 蘑菇街前端团队                   来自: web前端开发                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序添加视频video组件                                                      • 基本组件--(进度条、滑动选择器、开关选择器、复选框、)                                                      • 营销组件--大转盘\\刮刮乐\\老虎机\\跑马灯\\九宫格翻纸牌\\摇一摇\\手势解锁 ...                                                      • 截图组件welCropper实现原理及其使用                                                      • 小程序自定义评分组件（精确度0.1星）                                                      • 自定义组件化开发(附完整示例代码和效果图)                                                      • 小程序自定义评分组件 template（精度0.1）                                                      • 微信小程序组件化的解决方案（上）                                                                                               "},{"title": "如何开发小程序中的朋友圈功能 ", "author": "                  Rolan                  2018-6-7 00:34                ", "text": "                                                                                                                                                                                     一、开发功能分析：1.各条内容以列表展示 2.点击可展示内容详情 3.评论功能二、数据库建立这里列表与详细我们用一个表来实现评论用第二个表。总计2个表1.post 表 我们可以直接这样导入一个JSON但由于首页的资讯这样操作导致数据都一模一样这次我们使用云函数定时采集数据到数据库。2.采集数据 数据结构地址：var url = 'https://apiquan.ithome.com/api/post?categoryid=0&type=0&orderTime=1526981875455&visistCount=&pageLength=' 如果手动导入可以导入此数据结构:    {        \"id\":266716,        \"t\":\"普通联通卡可以转米粉卡吗？\",        \"c\":\"[杂谈]\",        \"cn\":\"畅谈\",        \"uid\":100058,        \"un\":\"中国火箭军\",        \"rn\":\"诺基亚 Lumia 930\",        \"pt\":\"/Date(1527057744773)/\",        \"rt\":\"/Date(1527060538403)/\",        \"vc\":0,        \"rc\":17,        \"IC\":false,        \"IH\":false,        \"ot\":\"/Date(-62135596800000)/\"    }云函数获取网址数据代码:function onRequest(request, response, modules) {var http = modules.oHttp;var url = 'https://apiquan.ithome.com/api/post?categoryid=0&type=0&orderTime=1526981875455&visistCount=&pageLength='    http(url, function(error, res, body) {        response.end(body);    });}点击测试看结果:这样就可以拿到目标网址数据. 如何插入到数据库看下面代码：db.insert({  \"table\":\"XXX\",             //表名  \"data\":{\"a\":\"XXXX\",\"b\":\"XXXX\"}            //需要更新的数据格式为JSON},function(err,data){         //回调函数});上面是插入单行数据如果批量插入可以使用下面代码：function onRequest(request, response, modules) {var http = modules.oHttp;   var db = modules.oData;    var url = 'https://apiquan.ithome.com/api/post?categoryid=0&type=0&orderTime=1526981875455&visistCount=&pageLength='    http(url, function(error, res, body) {        //结果转为对象类型        var results =JSON.parse(body);        var arr = [];        //循环更新数据        for (var i in results) {            newdata = {                \"method\": \"post\",                \"path\": \"/1/classes/post\",                \"body\":results[i]            };            arr.push(newdata)        }        //获取数组对象        var bat = modules.oBatch;        //批量操作        bat.exec({            \"data\": {                \"requests\": arr            }        }, function (err, data) {            //回调函数            response.end(data);            return;        });                response.end(JSON.stringify(results.length));            });    }点击测试效果下如图：3.定时任务 当然你也可以设置个定时任务我这里设置结果：当然你也可以设置每小时每天每分钟每秒每隔5分钟等等规则可以自己定义具体请看云函数文档文档地址： 定时任务云函数文档这里我们把朋友圈的数据表建立并采集了相关数据下次我们在讲修改mpvue小程序代码。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    滴滴一下小程序专车来了（下）               小程序的拖拽、缩放和旋转手势                                                        原作者: 大王12                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 | 使用 canvas 生成朋友圈分享图片并保存到手机相册 ... ... ... ...                                                      • 开发 | 小程序也能像朋友圈一样「折叠全文」？有了这个技巧就能做！ ...                                                      • 微信小程序分享到朋友圈之曲线救国                                                      • 微信小程序分享朋友圈的实现思路与解决办法                                                      • 【资源分享】微信小游戏入门与实战 刷爆朋友圈                                                      • 如何开发小程序中的朋友圈功能                                                      • 小程序导出朋友圈海报详细记录                                                                                               "},{"title": "小程序实现长按删除图片 ", "author": "                  Rolan                  2018-5-19 00:07                ", "text": "                                                                                                                                                                                     说明最近在学小程序,遇到长按图片删除的问题,特此记录,记录自己的成长轨迹需求: 长按删除指定图片需要解决的问题长按事件如何表示出来?如何获取当前长按元素的下标?如何删除元素?解决办法长按事件是用bindlongpress(不会跟点击事件bindtap冲突);在wxml中添加索引index,然后在js中用currentTarget.dataset.index获取当前元素下标通过splice方法删除splice(index,1),删除一个当前元素具体实现<view class=\"uploader__files\">      <block wx:for=\"{{images}}\" wx:key=\"{{item.id}}\" >            <view class=\"uploader__file\" bindlongpress=\"deleteImage\" data-index=\"{{index}}\">               <image mode=\"aspectFill\" class=\"uploader__img\" src=\"{{item.path}}\" />            </view>      </block></view>在wxml中添加 bindlongpress=\"deleteImage\" data-index=\"{{index}}\" 来绑定事件并添加索引indexdeleteImage: function (e) {    var that = this;    var images = that.data.images;    var index = e.currentTarget.dataset.index;//获取当前长按图片下标    wx.showModal({      title: '提示',      content: '确定要删除此图片吗？',      success: function (res) {        if (res.confirm) {          console.log('点击确定了');          images.splice(index, 1);        } else if (res.cancel) {           console.log('点击取消了');           return false;                 }        that.setData({          images        });      }    })  }删除部分的代码注意currentTarget与target的区别currentTarget:绑定的事件当前元素及其子元素都会触发target: 绑定的事件 子元素不会被触发事件效果展示                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w　　　　51                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序运行流程看这篇就够了               (干货)微信小程序组件封装                                                        原作者:  Kerinlin                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序左滑删除效果                                                      • 删除微信web开发者工具中失效项目动态设置placeholder和按钮选中取消状态 ...                                                      • 微信小程序实现左滑删除                                                      • 微信小程序列表项滑动显示删除按钮                                                      • 微信小程序 App全局变量 保存 修改 读取滑动删除                                                      • 微信小程序删除处理                                                      • 微信小程序图片使用示例                                                      • 微信小程序实现图片双滑缩放大小                                                      • 开发一款图片上传+用户反馈(留言)小程序附前端+后端代码                                                                                               "},{"title": "微信小程序：从本地相册选择图片或使用相机拍照 ", "author": "                  Rolan                  2018-4-18 00:32                ", "text": "                                                                                                                                                                                     wx.chooseImage(OBJECT)从本地相册选择图片或使用相机拍照。OBJECT参数说明：示例代码：1 wx.chooseImage({2   count: 1, // 默认93   sizeType: ['original', 'compressed'], // 可以指定是原图还是压缩图默认二者都有4   sourceType: ['album', 'camera'], // 可以指定来源是相册还是相机默认二者都有5   success: function (res) {6     // 返回选定照片的本地文件路径列表tempFilePath可以作为img标签的src属性显示图片7     var tempFilePaths = res.tempFilePaths8   }                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    5分钟解决小程序的微信支付               微信小程序button组件自定义样式                                                        原作者: TrendY                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 【微信小程序】一个相册小程序源码几乎包含了前后端所有基本知识 ...                                                      • 小北微信小程序教程之 -- 实现完整的相册列表逻辑（小程序端&服务器端） ...                                                      • 小北微信小程序之--新建和编辑相册（小程序的表单提交）                                                      • 小北微信小程序教程之-- 相册内容浏览                                                      • 微信小程序 | 使用 canvas 生成朋友圈分享图片并保存到手机相册 ... ... ... ...                                                      • 微信小程序 从本地相册选择图片或使用相机拍照chooseImage()和预览图片previewImage() ...                                                      • 小程序之图片懒加载【完美方案你不来看看】                                                      • 小程序之保存图片到相册的几种方法                                                      • 微信小程序使用相机                                                                                               "},{"title": "Yii2小程序组件 ", "author": "                  Rolan                  2017-8-16 00:41                ", "text": "                                                                                                                                                                                     Yii2 Applet ExtensionYii2小程序组件 获取用户信息和会话密钥环境需求PHP >= 5.5安装composer require jtcczu/yii2-applet配置return [    //...    'components' => [        'applet' => [          'class' => 'Jtcczu\\Applet\\Applet',          'appid' => 'APPID',          'secret' => 'SECRET'        ]    ]]使用 $applet = Yii::$app->applet->makeSession($code);  $applet->getUser($encryptedData, $iv); //返回用户信息 $applet->checkSignature($rawData, $signature); //数据签名校验 $session = $applet->getSession();  $session->getOpenid(); //openid $session->getSessionKey(); //session_key $session->getUnionid(); //unionid            微信小程序api文档 https://mp.weixin.qq.com/debug/wxadoc/dev/api/api-login.html#wxloginobject快速开始小程序代码wx.login({        success: function (login) {          wx.getUserInfo({            success: function (res) {              wx.request({                url: 'xxx',                method : 'post',                data:{                    code : login.code,                    rawData : res.rawData,                    signature : res.signature,                    encryptedData : res.encryptedData,                    iv : res.iv                },                dataType : 'json',                success : function(res){                }              })            }          })        }      })后端代码public function actionTest(){      $contents = file_get_contents('php://input');  $data = json_decode($contents,true);  $user = Yii::$app->applet                   ->makeSession($data['code'])                   ->getUser($data['encryptedData'],$data['iv']);}                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从0开始写小程序（三、四）前台循环数据绑定 & 获取循环元素id以及wx.login登录操作 ...               微信小程序开发问答《六十五》 如何清除浮点数? & 图片链接加入控制台报错 ...                                                        原作者: jtcczu                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序组件化框架 WePY 在性能调优上做出的探究                                                      • 如何写一个微信小程序组件                                                      • 微信小程序组件之marquee                                                      • 小程序组件实现                                                      • 微信小程序UI组件、开发框架、实用库.                                                      • 微信小程序组件化（上）                                                      • 微信小程序开发组件化（下）                                                      • 微信小程序商品详情页交互源码（选择商品类型切换、预览商品图片） ...                                                      • 微信小程序getPhoneNumber快速获取用户手机号组件                                                      • 基本组件--(进度条、滑动选择器、开关选择器、复选框、)                                                      • 小程序自定义评分组件（精确度0.1星）                                                                                               "},{"title": "微信小程序腾讯视频插件的使用 ", "author": "                  Rolan                  2018-7-10 00:19                ", "text": "                                                                                                                                                                                     在开发一个小程序项目时需要在页面中观看视频就需要使用到微信小程序的腾讯视频插件这样就可以在页面中引用腾讯视频而无需使用自己的服务器进行视频的播放节约了很大的服务器开支。但是微信小程序插件的文档写的很不清楚因此将我的解决方法写在这里。一、在小程序中引入插件。进入微信公众平台在设置中找到第三方服务在插件管理中添加插件。搜索到腾讯视频点击添加同时打开腾讯视频的详情在里面找到该插件的appid与版本号。接着是代码部分在app.json中添加  \"plugins\": {    \"tencentVideo\": {      \"version\": \"1.1.1\",      \"provider\": \"wxa75efa648b60994b\"    }其中version是版本号provider是appid。二、在需要使用的页面中引用该插件的组件官方文档并没有关于该方法的具体说明所以会导致出现无法找到对应playerid的txv-video的问题打开想要使用插件页面的json文件在里面添加 \"usingComponents\": {    \"txv-video\": \"plugin://tencentVideo/video\"  }这就代表着可以在页面中使用txv-video组件啦三、在页面中使用组件进入wxml文件在里面添加<txv-video vid=\"vid\" playerid=\"txv1\"></txv-video>这一步很简单vid是腾讯视频的vidplayerid是该txv-video唯一识别码这个组件不能通过css进行样式修改四、在js中进行引入如果你不想在js中对该插件进行控制的话可以不引入。    const TxvContext = requirePlugin(\"tencentVideo\");    let txvContext = TxvContext.getTxvContext('txv1');    txvContext.play(); //播放这就是我成功引用腾讯视频插件的全部过程了希望能够帮助到一样使用这个插件遇到问题的人。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (3)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)jadew十年18不经意之间...                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序隐藏客服按钮用图片替代&增加提示卡片可随时关闭。 ...               小程序分享看这篇就够了                                                        原作者: liyx9292                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序添加视频video组件                                                      • 小程序上传视频预览                                                      • 小北微信小程序教程之-- 上传视频                                                      • 小程序音视频能力技术负责人解读“小程序直播”                                                      • 腾讯云独家详解小程序多人视频通话                                                      • 动手搭建第一个小程序音视频Demo                                                      • 猫眼小程序如何发展起来并留存用户？                                                      • 小程序打包插件开发体验                                                                                               "},{"title": "微信小程序异步处理 ", "author": "                  Rolan                  2017-11-11 00:22                ", "text": "                                                                                                                                                                                     直接看问题：然后看打印的结果：根据上面两图可以看出代码上先执行的网络请求再执行打印的变量但是从下面打印的结果来看先出结果的是执行打印变量的函数（aafn函数）再打印出网络请求success的回调里返回的数据和赋值后的变量的值；为什么先执行的aafn并且打印的值没有赋值上？因为wx.request是一个异步的请求所以数据请求的同时可以继续向下执行函数。所以这里值还没有赋值上就开始打印了变量的值；这种情况怎么解决呢？方法一： 嵌套在wx.request的success回调里执行aafn函数然后运行结果这里就取到值了但是如果逻辑很复杂需要用到很多层异步就像这样：asyncFn1(function(){  //...  asyncFn2(function(){    //...    asyncFn3(function(){      //...      asyncFn4(function(){        //...        asyncFn5(function(){           //...        });      });    });  });});这样代码看起来就很不好看代码的可读性和可维护性就不好了那怎么解决这个问题呢？Promise这种概念的产生很好地解决了这一切Promise是什么？这里我就不多说了有兴趣的自己去看一看 Promise介绍链接先看看Promise的方式：function asyncFn1(){  return new Promise(function (resolve, reject) {    //...  })}// asyncFn2,3,4,5也实现成跟asyncFn1一样的方式...调用asyncFn1()  .then(asyncFn2)  .then(asyncFn3)  .then(asyncFn4)  .then(asyncFn5);这样的话异步函数就可以依次执行了微信小程序的异步API怎么支持Promise呢？我们可以一个一个的用Promise去包装这些API但是这个还是比较麻烦的。不过小程序的API的参数格式都比较统一只接受一个object参数回调都是在这个参数中设置所以这为了统一处理提供了便利写一个工具方法来完成这样的工作首先需要引用一个叫bluebird.js的文件；进入 bluebird官网 下载：这个好像是不能下载的但是你可以点击进入然后复制在小程序里创建一个js文件将代码复制到这个js里面然后引用然后再写一个JS里面写工具方法：下面是prom.js然后需要使用的那个页面的js里引入prom.js：调用：打印结果这样就可以了完结。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序之生物识别               小北微信小程序之-- 添加照片（小程序图片上传功能）                                                        原作者: 西江无月                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 一斤代码：微信小程序中异步处理终极方案async/await                                                                                               "},{"title": "微信小程序基于万象优图实现图片 OCR ", "author": "                  Rolan                  2017-12-20 00:27                ", "text": "                                                                                                                                                                                     随着小程序开放越来越多的类目越来越多的企业将各种各样的需求开发成小程序而基于图像识别的名片识别、身份证识别或者普通文字的 OCR 也越来越多的被应用于各种场景中基于此腾讯云微信小程序解决方案团队将腾讯万象优图的身份证识别和文字印刷体 OCR 封装进 wafer2-node-sdk 中使得用户可以快速调用使用图片识别。现在通过 图像识别 Demo 一起来完成身份证和印刷体识别的快速开发吧！首先需要到腾讯云的万象优图控制台开通万象优图功能并且创建 Bucket。创建的 Bucket 最好为公有读私有写的权限。以下文档基于图像识别 Demo 进行介绍目前图像识别接口只有 Node.js SDK 提供。打开 server/config.js 添加上 qcloudAppId  qcloudSecretId  qcloudSecretKey 三个配置项并在代码目录中打开 CMD运行如下代码：cd server && npm i安装完成依赖选择小程序开发者工具右上角的【腾讯云】按钮点击【上传测试环境】上传代码到测试环境中一键部署程序。你也可以自行部署代码部署过程同 《自行部署 Node.js Demo》 这里不再介绍。查阅 Wafer Node.js SDK 的 API 文档 可以看到 SDK 提供了两个万象优图接口分别是身份证识别接口和印刷体 OCR 接口。身份证识别直接调用 ci.idCardIdentify 即可快速识别身份证根据文档该接口的第一个参数为要识别的图片地址。我们可以提前使用 SDK 的图片上传功能将图片上传到 COS 上获取图片的地址（Bucket 必须为公有读私有写）之后再调用身份证识别接口。接口的第二个参数为万象优图的 Bucket第三个参数为要识别的身份证的正面还是反面（0 代表带头像那面1 代表国徽那面）const data = await uploader(ctx.req);const { data: identifyResult } = await ci.idCardIdentify([data.imgUrl], 'qcloudtest', 0);同时身份证识别接口支持 批量识别 你可以提供多个图片地址进行识别。const { data: identifyResult } = await ci.idCardIdentify(['https://xxx.img.cn/xxx1.jpg', 'https://xxx.img.cn/xxx2.jpg'], 'qcloudtest', 0);识别的结果直接透传万象优图接口返回值具体数据结构可以参考： https://cloud.tencent.com/document/product/460/6895 。普通印刷体识别调用 ci.ocr 即可识别印刷体文字接口参数与身份证识别类似不过需要注意的是 OCR 接口仅支持对单个图片的识别一次只能识别一张图片。const data = await uploader(ctx.req);const { data: ocrResult } = await ci.ocr(data.imgUrl, 'qcloudtest', 0);识别的结果直接透传万象优图接口返回值具体数据结构可以参考： https://cloud.tencent.com/document/product/460/9519 。以上就是我们使用 SDK 如何快速开发身份证和图像识别你也可以使用我们的 Demo 体验一下身份证识别和印刷体识别。原创声明本文系作者授权云+社区-专栏发表未经许可不得转载。如有侵权请联系zhuanlan_guanli@qq.com删除。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    基于腾讯云智能语音的实时语音识别微信小程序的开发               基于 Wafer 2.0 搭建自己的第一个小程序                                                        原作者: jason                   来自: 极客头条                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小北微信小程序之-- 添加照片（小程序图片上传功能）                                                      • 微信小程序 | 使用 canvas 生成朋友圈分享图片并保存到手机相册 ... ... ... ...                                                      • 小程序上传图片到七牛                                                                                               "},{"title": "小程序之保存图片到相册的几种方法 ", "author": "                  Rolan                  2018-6-28 00:21                ", "text": "                                                                                                                                                                                     保存图片到本地有两种方法其一是网络图片保存到相册其二本地图片保存到相册。官方文档保存图片前需要授权因此我们先授权代码如下：//获取相册授权wx.getSetting({success(res) {if (!res.authSetting['scope.writePhotosAlbum']) {wx.authorize({scope:'scope.writePhotosAlbum',success() {console.log('授权成功')}})}}})//此方法可以写在app.js中也可以写在调用保存按钮时。获取授权第一种方法网络图片保存：var imgSrc = \"http://yijiao.oss-cn-qingdao.aliyuncs.com/images/http://tmp/wx1b4e5e756cd48af1.o6zAJsws4grEQvYrWTjBigy-6QaU.0llhudiKSF2V955a1c48350d9328ef064b4d36d12746.jpg\"    wx.downloadFile({      url: imgSrc,      success: function (res) {        console.log(res);        //图片保存到本地        wx.saveImageToPhotosAlbum({          filePath: res.tempFilePath,          success: function (data) {            wx.showToast({              title: '保存成功',              icon: 'success',              duration: 2000            })          },          fail: function (err) {            console.log(err);            if (err.errMsg === \"saveImageToPhotosAlbum:fail auth deny\") {              console.log(\"当初用户拒绝再次发起授权\")              wx.openSetting({                success(settingdata) {                  console.log(settingdata)                  if (settingdata.authSetting['scope.writePhotosAlbum']) {                    console.log('获取权限成功给出再次点击图片保存到相册的提示。')                  } else {                    console.log('获取权限失败给出不给权限就无法正常使用的提示')                  }                }              })            }          },          complete(res){            console.log(res);          }        })      }    })第二种方法：选择相册图片存入本地wx.chooseImage({count:1,// 默认9sizeType: ['original','compressed'],// 可以指定是原图还是压缩图默认二者都有sourceType: ['album','camera'],// 可以指定来源是相册还是相机默认二者都有success:function (res) {// 返回选定照片的本地文件路径列表tempFilePath可以作为img标签的src属性显示图片console.log(\"choose image\")console.log(res)var tempFilePath = res.tempFilePaths[0]wx.getImageInfo({src: tempFilePath,success:function (res) {console.log(\"get image info\")console.log(res)wx.saveImageToPhotosAlbum({filePath: res.path,success(res) {console.log(\"保存图片成功\")console.log(res)wx.showToast({title:'保存成功',icon:'success',duration:2000})},fail(err) {console.log('失败')console.log(err)if (err.errMsg == \"saveImageToPhotosAlbum:fail cancel\"){wx.openSetting({success(settingdata) {console.log(settingdata)if (settingdata.authSetting[\"scope.writePhotosAlbum\"]) {console.log('获取权限成功给出再次点击图片保存到相册的提示。')}else {console.log('获取权限失败给出不给权限就无法正常使用的提示')}}})}}})}})}})如有疑问请简信。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序——获取绑定事件元素的ID               微信小程序带图片弹窗简单实现                                                        原作者: honey缘木鱼                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小北微信小程序教程之-- 相册内容浏览                                                      • 微信小程序 | 使用 canvas 生成朋友圈分享图片并保存到手机相册 ... ... ... ...                                                      • 微信小程序 从本地相册选择图片或使用相机拍照chooseImage()和预览图片previewImage() ...                                                      • 微信小程序：从本地相册选择图片或使用相机拍照                                                      • 微信小程序开发之从相册获取图片 使用相机拍照 本地图片上传 ... ...                                                      • 微信小程序设置图片固定比例                                                                                               "},{"title": "微信小程序 类似弹出菜单特效，从右向左滑出 ", "author": "                  Rolan                  2018-2-24 00:27                ", "text": "                                                                                                                                                                                     想要实现的效果：点击圆形图标view从右向左滑出再次点击从左向右滑入wxml:  <view class=\"goods_btn {{s_move==false?'z_move':''}}\" catchtap='show_move'>    <image src='../../images/goods_btn.png' style='width:28rpx;height:28rpx;'></image>  </view>   <view class=\"move_box {{s_move==false?'move_t':''}} {{s_move==true&move_o==1?'move_tf':''}}\">    <view class='m_line'></view>    <view class='m_title'>校区</view>    <view class='m_school' style='margin-bottom:12rpx;'>      <block wx:for=\"{{school_object}}\" wx:key=\"{{index}}\">      <view>{{item}}</view>      </block>    </view>    <view class='m_school'>      <block wx:for=\"{{school_object2}}\" wx:key=\"{{index}}\">      <view>{{item}}</view>      </block>    </view>    <view class='m_title'>舞种</view>    <view class='m_school'>      <block wx:for=\"{{dance_object}}\" wx:key=\"{{index}}\">      <view>{{item}}</view>      </block>    </view>    <view class='m_title'>年龄</view>    <view class='m_school'>      <block wx:for=\"{{age_object}}\" wx:key=\"{{index}}\">      <view>{{item}}</view>      </block>    </view>    <view class='m_title'>课程</view>    <view class='m_course'>      <block wx:for=\"{{course_object}}\" wx:key=\"{{index}}\">      <view>{{item}}</view>      </block>    </view>    <view class='m_title'>难度</view>    <view class='m_course'>      <block wx:for=\"{{difficult_object}}\" wx:key=\"{{index}}\">      <view>{{item}}</view>      </block>    </view>    <view class='m_title'>价格</view>    <view class='m_school'>      <block wx:for=\"{{price_object}}\" wx:key=\"{{index}}\">      <view>{{item}}</view>      </block>    </view>    <view class='default_b'>      <view class='default_box'></view>      <view>设为默认选</view>    </view>    <view class='sure_b'>      <view catchtap='show_move'>确定</view>      <view catchtap='show_move'>取消</view>    </view>  </view>js:data: {    move_o:0,    s_move:true},show_move:function(){    let s_move=this.data.s_move;    this.setData({      s_move:!s_move,      move_o:1    })wxss:.move_t{  z-index: 22;   animation: mymove 1s 1;  animation-fill-mode:forwards; }.z_move{  z-index: 23!important;}@keyframes mymove{  from {right:-750px;}  to {right:0px;}}.move_tf{  z-index: 22;  animation: mymove2 1s 1;  animation-fill-mode:forwards; }@keyframes mymove2{  from {right:0px;}  to {right:-750px;}}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 从本地相册选择图片或使用相机拍照chooseImage()和预览图片previewImage() ...               微信小程序 for循环添加样式1                                                        原作者: Hakuna__Matata                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 for循环添加样式1                                                      • 微信小程序实现多折叠展开酷炫菜单                                                                                               "},{"title": "微信小程序开发问答《六十六》 菜单内容左右联动 & MD5加密 ... ", "author": "                  Rolan                  2017-8-17 00:41                ", "text": "                                                                                                                                                                                     1、微信小程序菜单内容左右联动小程序无法获取元素的宽高位置信息只能通过后台计算但是存在较大的机器误差不知有啥好的解决方案？git地址：https://github.com/Panfen/lumm如图所以左侧是菜单栏右侧是主体内容点击左侧菜单右侧滑动到相应的位置；右侧滑动过程也会改变左侧菜单的选中状态。本人的实现方案：所有元素大小单位用rpx;通过scrollbind(e) 的 e.detail.scrollHeight获取右侧滑动区域的总高度（单位px）通过物品高度和标题高度的比值计算出各自的实际高度（单位px）通过修改scrollTop（单位px）改变主体内容位置这样还是存在1px-100px的误差物品越多后面的累计误差会越大有没有更好的解决办法呢？答：测试了一下的确用scroll-view的scroll-to-view特性可以解决：wxml中修改：<scroll-view scroll-y style=\"height: 31.5em\" class=\"goods\" bindscroll=\"goodsScrollAct\"  scroll-into-view=\"{{toView}}\" >  <view class=\"box\" id=\"{{item.viewId}}\"  wx:for=\"{{allGoods}}\" wx:key=\"unique\" wx:for-index=\"typeId\">js文件中修改：page data中增加：menuType:['food','dust','bowl','cages','toys','tools'],toView:'cages',然后把下面函数修改一下：selectMenuAct: function (e) {//typenamevar id = e.target.dataset.id;var tType=this.data.menuType[id];console.log(e),this.setData({  scrollNum: id,  toView: tType  //scrollTop: this.data.heightList[id]});},测试环境下通过。scroll-into-view值应为某子元素id（id不能以数字开头）。设置哪个方向可滚动则在哪个方向滚动到该元素。2、微信小程序MD5加密一般很多语言都有MD5加密的库。如果你指的是数据加密怕数据明文不安全我建议使用base64 + 一些前缀或者后缀进行加密然后将数据传到服务器服务器再进行解密后去掉这些前后缀。比如明文是abc你可以加一下前缀变成123abc然后加密成为MTIzYWJj再发出去然后再解密就行了。一般MD5加密是不可逆的。而base64可以编码解码如下：package mainimport (    \"fmt\"    \"github.com/hunterhug/GoSpider/util\")func main() {    s := \"abc\"    prefix := \"123\"    base64e := util.Base64E(prefix + s)    fmt.Println(\"加密：\" + base64e)    fmt.Println(\"再解密：\" + util.Base64D(base64e))}结果加密：MTIzYWJj再解密：123abc百度百科介绍：Base64编码可用于在HTTP环境下传递较长的标识信息。例如在Java Persistence系统Hibernate中就采用了Base64来将一个较长的唯一标识符（一般为128-bit的UUID）编码为一个字符串用作HTTP表单和HTTP GET URL中的参数。在其他应用程序中也常常需要把二进制数据编码为适合放在URL（包括隐藏表单域）中的形式。此时采用Base64编码不仅比较简短同时也具有不可读性即所编码的数据不会被人用肉眼所直接看到。我的Golang语言自己封装的加密库一般是这样的：/*Copyright 2017 by GoSpider author.Licensed under the Apache License, Version 2.0 (the \"License\");you may not use this file except in compliance with the License.You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0Unless required by applicable law or agreed to in writing, softwaredistributed under the License is distributed on an \"AS IS\" BASIS,WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.See the License for the specific language governing permissions andlimitations under the License.*/package utilimport (    \"crypto/hmac\"    \"crypto/md5\"    \"crypto/sha256\"    \"encoding/base64\"    \"encoding/hex\"    \"fmt\"    \"net/url\"    \"strings\")// HMAC with the SHA256  http://blog.csdn.net/js_sky/article/details/49024959func ComputeHmac256(message string, secret string) string {    key := []byte(secret)    h := hmac.New(sha256.New, key)    h.Write([]byte(message))    return base64.StdEncoding.EncodeToString(h.Sum(nil))}// create md5 stringfunc Strtomd5(s string) string {    h := md5.New()    h.Write([]byte(s))    rs := hex.EncodeToString(h.Sum(nil))    return rs}func Md5(str string) string {    return Strtomd5(str)}// 字符串base64加密func Base64E(urlstring string) string {    str := []byte(urlstring)    data := base64.StdEncoding.EncodeToString(str)    return data}// 字符串base64解密func Base64D(urlxxstring string) string {    data, err := base64.StdEncoding.DecodeString(urlxxstring)    if err != nil {        return \"\"    }    s := fmt.Sprintf(\"%q\", data)    s = strings.Replace(s, \"\\\"\", \"\", -1)    return s}//url转义func UrlE(s string) string {    return url.QueryEscape(s)}//url解义func UrlD(s string) string {    s, e := url.QueryUnescape(s)    if e != nil {        return e.Error()    } else {        return s    }}现在大部分站点都开启https来保证数据安全。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序---保留小数(toFixed) 四舍五入 获取整数 string转int               thinkphp5+easywechat开发小程序支付                                                                                                                                                                /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发问答《六十》错误状态码(例如：401)的获取& 日期选择器的起始时间极限 ...                                                      • 微信小程序开发问答《六十一》 轮播图修改小点点 & 使用字体图标 ...                                                      • 微信小程序开发问答《六十二》 下拉出来的白底调色 & wx.navigateBack 传值到上一个界 ...                                                      • 微信小程序开发问答《六十三》设置某个页面为启动后打开的第一个页面 & 调试技巧 ...                                                      • 微信小程序开发问答《六十四》赋值undefined & wx for中对满足条件的项添加class ...  ...                                                      • 微信小程序开发问答《六十五》 如何清除浮点数? & 图片链接加入控制台报错 ...                                                      • 解决微信小程序 wx.request 请求的并发数限制、不支持异步问题 ...                                                      • 微信小程序开发问答《六十七》 页面栈的管理 & 图片不显示 ...                                                      • 微信小程序开发问答《六十八》处理订单多人同时支付问题 & thirdScriptError TypeErro ...                                                      • 微信小程序开发问答《六十九》radio样式不能自定义 & 多个input如何方便的获取提交 .. ...                                                      • 微信小程序开发问答《七十》微信小程序的for循环 & 小程序效果处理技巧 ... ... ... ...                                                      • 官方问答--微信小程序常见FAQ (17.8.21-17.8.27)                                                      • 微信小程序开发问答《七十一》picker选择日期 & image无法显示base64的图片 ... ... ...                                                      • 微信小程序开发问答《七十二》sticky header 效果 & 自定义 imageUrl 无效 ...                                                      • 微信小程序实现顶部、底部滑动联动                                                      • 微信小程序实现多折叠展开酷炫菜单                                                      • 小程序--前端AES加密                                                                                               "},{"title": "微信小程序silk格式转码成mp3格式 ", "author": "                  Rolan                  2018-4-9 00:28                ", "text": "                                                                                                                                                                                     最近小程序项目需要录制语音并上传到服务器经过查资料了解 目前微信小程序录音的文件后缀名是silk因此需要转换。经过查资料了解参考一下的地址https://github.com/kn007/silk-v3-decoder需要安装gcc ffmpegwget http://downloads.sourceforge.net/lame/lame-3.100.tar.gztar -zxvf lame-3.100.tar.gzcd lame-3.100./configure --prefix=/usr/localmakemake installln -s /usr/local/lib/libmp3lame.so.0.0.0 /usr/lib64/libmp3lame.so.0wget http://ffmpeg.org/releases/ffmpeg-3.4.1.tar.bz2tar -jxvf ffmpeg-3.4.1.tar.bz2cd ffmpeg-3.4.1./configure --prefix=/usr/local --pkg-config-flags=--static --enable-libmp3lame --disable-x86asmmakemake installcd /usr/local/softwget https://github.com/kn007/silk-v3-decoder/archive/master.zipunzip master.zipmv silk-v3-decoder-master silk-v3-decoderchmod -R +x /usr/local/soft/silk-v3-decoder/silk-v3-decoder/converter.sh file mp3                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发之SVG的使用               微信小程序实现多折叠展开酷炫菜单                                                        原作者: 坚强的蘑菇                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序语音搜索踩坑：silk文件格式转换在PHP中使用                                                      • 微信小程序silk录音文件转mp3                                                      • 微信小程序录音文件.silk上传服务器转mp3格式                                                      • 搭建https的silk录音文件语音识别服务的调用过程                                                                                               "},{"title": "浅谈微信小程序前端生态 ", "author": "                  Rolan                  2017-11-18 00:02                ", "text": "                                                                                                                                                                                     微信小程序去年刚推出内测就刷屏了笔者朋友圈好几天而后来几个月单从技术生态来看并不像人们预期那般火热。不过最近刚推出的web-view组件算是再次引发了一波小高潮。web-view组件中运行纯web应用“ web-view是一个可以用来承载网页的容器会自动铺满整个小程序页面”也就是说微信小程序中可以直接运行web页了。大胆猜想这一功能可能直接导致小程序数量增长迎来一波高峰。毕竟磨刀霍霍却一直资源不足的团队应该不少现在可以把已有H5应用嵌入到小程序webview容器中以最低的开发成本坐蹭微信流量红利何乐而不为呢？对于 web-view组件笔者做了些demo测试：所测试的线上M页功能未见异常dombom操作API未被屏蔽；顶部栏显示M页title且优先级高于小程序页面title；小程序页面跳转轨迹和 web -view中web页跳转轨迹会被连贯记录包括hashchange；M页间跳转层级不受限不同于小程序页面最多5层的限制；经测试内嵌M页调起转转APP正常；web -view组件  src属性支持动态赋值；从以上结果来看仅以小程序 web-view组件为容器迁移已有web应用到小程序中的方案应该可行包括基于hash路由的SPA。还有一点值得注意随着 web-view组件推出  Page .onShareAppMessage (options ) 函数参数中新增了 webViewUrl属性值当用户调起转发面板时  options .webViewUrl返回  web -view组件中当前加载的  url通过把  url添加到小程序页面分享路径中可以变相实现转发M页到好友会话的功能。以往的小程序开发体验过去几个月笔者一直在参与小程序项目从个人观点来说之前小程序的开发体验还有很大提升空间。首先小程序推出时间不长稳定性还不是特别理想；其次小程序与web同构的需求逐渐显现虽然 wepy、  mpVue等框架在尝试从语法层面尽可能做到与  vue技术栈的web项目同构但是两端特性API兼容依旧是个棘手问题；好在现在  web -view组件的推出一下使得同构问题不那么严峻了；最重要一点是之前小程序组件化机制不完善代码复用相对困难。而对于我们团队并行开发多个小程序且功能复用频繁的情况高效的代码复用方案又极为重要；针对代码复用问题我们选用了 wepy框架解决。  wepy提供了系统的组件化开发方案类似Vue语法支持npm引用能够方便的引入ES6语法CSS预处理器打包过程支持插件化扩展。整体来说wepy极大地提高了小程序组件化开发体验但是在具体组件开发中我们也遇到了一些问题。由于小程序不支持动态模板且小程序的视图更新只能基于  page data中挂载的数据这些与web开发不同的地方必然会对框架设计有所限制在实际开发中对 slot模板片段嵌套组件间  computed数据同步等复杂组件应用上体验还是有些缺陷。好在从基础库SDK v1.6.3开始小程序新增了  Component 构造器 开始原生支持自定义组件开发。正当笔者还在想 wepy等以往的组件化框架是不是会逐渐过渡到基于  Component 构造器 时发现蘑菇街团队已经高效的开源了基于 Component的组件化方案  MinMin采用单文件的方式来开发组件, 在单文件编译环节提供了CSS预处理器等一些额外的赋能同时也支持插件扩展。很期待新版基础库覆盖率足够高后能够尝试 Component构造器的组件化方案相信开发体验一定会大有提升。未来的混合开发需求小程序隔离了JSCore和webview渲染内核通过中间层数据传输接口异步的将数据从JS逻辑层发送到视图层；这使得微信可以更好的对小程序数据传递和响应时间等做监控但在渲染性能和开发体验方面并未明显优于web开发。同时2M代码限制也使得像“转转官方”这样已经2000+KB的小程序必须考虑引入web内容再有就是小程序审核发布机制使得它终究不能像web一样迭代迅速。综上也许“小程序页面+web页”混合开发（甚至web更重）会成为以后的新趋势。考虑混合开发必然会遇到“web-view网页与小程序页面通信”的场景而现在两者之间不支持除JSSDK提供的接口之外的通信。从web页新开一个小程序页面: 可使用 wx .miniProgram .navigateTo等几个跳转接口通过path参数携带数据跨页面；从小程序页面新开一个web页：可以把携带数据的url动态赋值给 <web-view/> .src 属性实现数据传递。这里有一点要说明 <web-view/>.src属性是一个单向传递的数据  web -view内的url变更并不能反馈到src属性值中；而对于回退到上一页面需要携带数据的场景目前能想到的通信方式只有通过服务端中转在回退到的页面 onShow钩子中拉新数据；因为  navigateBack或者  wx .miniProgram .navigateBack等方法并没有能够携带跨页面数据的参数。在之前的小程序页面开发中两个小程序页面的返回场景下我们可以在  A 页面 中把数据存入 storage或者js模块返回  B 页面后在 onShow中获取数据。而混合模式下  web -view组件环境中  localstorage和小程序  storage并不共用存储空间  web -view中JS执行引擎和小程序页面的JSCore环境也不能共享JS模块。期待展望未来的小程序功能升级笔者最期待的大概有两点：小程序页面和 web -view页面间的通信能有比较系统高效的接口支持；支持打包部分web静态资源到小程序包中并可在 web -view内嵌网页中本地加载。总结来说在笔者看来最希望小程序的功能迭代能够往“提供更高效、微信开放功能更强大的定制化webview容器”方向发展。尽可能减小web应用与小程序的同构成本相信这对小程序开发生态甚至产品生态发展都有积极影响。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小北微信小程序教程之-- 相册内容浏览               新零售的转折点：微信小店小程序                                                        原作者: 大转转FE                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 【前端样例】微信小程序多商品评价评星提交                                                      • 支付宝小程序PHP全栈开发--前端样式的设计.acss样式详解                                                      • 前端开发--微信小程序中页面代码中的模板封装                                                      • 前端浏览器缓存及代码部署                                                      • 微信小程序前端坑整理                                                      • 前端开发常见问题精选（三）                                                                                               "},{"title": "微信小程序语音识别服务搭建全过程解析（https api开放，支持新接口mp3录音、老接口si ... ", "author": "                  Rolan                  2017-11-11 00:08                ", "text": "                                                                                                                                                                                     silk v3（或新录音接口mp3）录音转olami语音识别和语义处理的api服务（ubuntu16.04服务器上实现）重要的写在前面重要事项一：所有相关更新我优先更新到我个人博客中其它地方的文章属于本人或他人转发不一定及时同步。原文链接是： http://www.happycxz.com/m/?p=32重要事项二：目前本文中提到的API已支持微信小程序录音文件格式：silk v3、mp3。注：微信小程序开发工具上的录音不论是新接口还是老接口都是webm/base64格式虽然后辍名是silk（或mp3）但不是真正的silk v3（或mp3）格式的打开看头部是 data:audio/webm;base64, 开头的。为了便于调试2017年9月份时我补逻辑给支持上了但是：我在2017年11月份发现原有的webm/base格式又不支持了。api服务器端代码没有动过跟踪查过目前仅发现在2017年10月份之前用微信小程序开发工具录的文件还是可以支持的在10月份之后的文件就不支持了具体什么原因只能问老马家的人了。结论是：调用我本文中提到的两个接口只能用真机做测试不能用电脑录音来测试语音识别了。重要事项三：想要用我这个API务必先去cn.olami.ai申请appKey和appSecret然后将appKey告知我我加进支持列表方可调用二者缺一不可。文末有将有调用此文提到的API服务的案例以及源码分享文章链接。调用案例：“遥知之”智能小秘欢迎扫码体验：重要事项四：欢迎转载本文没有什么别的要求请保留：原文链接：http://www.happycxz.com/m/?p=32本文所有源码对应码云链接：https://gitee.com/happycxz/silk2asr本文所有源码对应github链接：https://github.com/happycxz/silk2asr为什么做？前不久刚发布了一个智能生活信息查询的小助手“遥知之”可惜只能手动输入来玩这一点体验很不好因为微信小程序录音是silk格式的现在主要的语音识别接口都不支持。在网上搜了下相应的功能也只有php做的开源代码实现的silk转wav的服务器代码首先我不熟悉PHP其次也不知道后期有没有维护干脆自己做一个tomcat + java版的权当学习娱乐一下。怎么做？准备环境先需要有一个支持https的服务器我目前用的服务器是阿里云秒杀的免费最低配置的服务器预装的ubuntu16.04 LTS版然后自己捣鼓一下配置上了https具体是用 nginx + let's encrypt + tomcat来提供的https的API。这里不详细介绍感兴趣的自己研究下。需要一个silk解码器网上有一牛在2015年年初曾经发贴讨论过这个话题：silk v3 编码的音频怎么转换成 wav 或 mp3 之类的？而且此牛后面有持续研究提供了开源的silk_v3_decoder项目具体见：kn007大牛的silk_v3_decoder对了开源项目是github上的服务器上装个git这不用额外再说明了吧。搭建服务步骤下载silk-v3-decoder基本就是在服务器上找个目录把大牛kn007的项目下载下来。root@alijod:/home/jod/wechat_app# mkdir downloadroot@alijod:/home/jod/wechat_app# cd download/root@alijod:/home/jod/wechat_app/download# git clone https://github.com/kn007/silk-v3-decoder.gitCloning into 'silk-v3-decoder'...remote: Counting objects: 634, done.remote: Total 634 (delta 0), reused 0 (delta 0), pack-reused 634Receiving objects: 100% (634/634), 72.79 MiB | 9.50 MiB/s, done.Resolving deltas: 100% (352/352), done.Checking connectivity... done.root@alijod:/home/jod/wechat_app/download# lltotal 12drwxr-xr-x 3 root root 4096 Sep 18 10:11 ./drwxr-xr-x 7 root root 4096 Sep 18 10:11 ../drwxr-xr-x 5 root root 4096 Sep 18 10:11 silk-v3-decoder/root@alijod:/home/jod/wechat_app/download# ls silk-v3-decoder/converter_beta.sh  converter.sh  LICENSE  README.md  silk  windows看上述目录其实只用到了silk这个目录和converter.sh这个脚本。silk目录中的C代码需要gcc编译converter.sh脚本需要修改一下后续都会提。编译silk_v3_decoder根据https://github.com/kn007/silk-v3-decoder上的README用上这个工具需要gcc和ffmpeggcc是在编译silk时执行make时用到的（普及一下小白）ffmpeg其实是脚本里要用的与编译无关。事实是ffmpeg在整个服务搭建过程确实不是必备的后文将有针对这个额外说明只是本人偷懒暂时不想再深入研究了。gcc的环境如果没有安装自己网搜吧这里不扯了直接进入正题：root@alijod:/home/jod/wechat_app/download# cd silk-v3-decoder/silk/root@alijod:/home/jod/wechat_app/download/silk-v3-decoder/silk# lltotal 32drwxr-xr-x 5 root root  4096 Sep 18 10:11 ./drwxr-xr-x 5 root root  4096 Sep 18 10:11 ../drwxr-xr-x 2 root root  4096 Sep 18 10:11 interface/-rw-r--r-- 1 root root  3278 Sep 18 10:11 Makefiledrwxr-xr-x 2 root root 12288 Sep 18 10:11 src/drwxr-xr-x 2 root root  4096 Sep 18 10:11 test/root@alijod:/home/jod/wechat_app/download/silk-v3-decoder/silk# make……………………（这里是一大段编译过程日志）…………a - src/SKP_Silk_scale_vector.ogcc -c -Wall -enable-threads -O3   -Iinterface -Isrc -Itest  -o test/Decoder.o test/Decoder.ctest/Decoder.c: In function ‘main’:test/Decoder.c:187:9: warning: ignoring return value of ‘fread’, declared with attribute warn_unused_result [-Wunused-result]         fread(header_buf, sizeof(char), 1, bitInFile);         ^g++  -L./ test/Decoder.o -lSKP_SILK_SDK -o decoderroot@alijod:/home/jod/wechat_app/download/silk-v3-decoder/silk# lsdecoder  interface  libSKP_SILK_SDK.a  Makefile  src  testroot@alijod:/home/jod/wechat_app/download/silk-v3-decoder/silk# 可以看到上面编译过程中最后出现了一个warning不过没关系ls查一下第一个“decoder”就是我们要用的binary啦有它就证明编译成功了。测试silk_v3_decoder功能接下来就要验证一下编出来的这个能不能用了。根据https://github.com/kn007/silk-v3-decoder上的README摘下来一段：sh converter.sh silk_v3_file/input_folder output_format/output_folder flag(format)比如转换一个文件使用：sh converter.sh 33921FF3774A773BB193B6FD4AD7C33E.slk mp3注意：其中33921FF3774A773BB193B6FD4AD7C33E.slk是要转换的文件而mp3是最终转换后输出的格式。参考上面那个例子就好了脚本参数只有两个一个是源文件相对或绝对路径另一个是目标格式。也就是说上述命令会将33921FF3774A773BB193B6FD4AD7C33E.slk（注意例子里是slk后辍你自己在获取微信小程序录音重命名时如果是.silk别疑惑了linux环境文件后辍名是没有实际意义的感兴趣自己网搜to小白）转码成33921FF3774A773BB193B6FD4AD7C33E.mp3。没有silk源文件？别急我准备了个silk_v3录音文件附带着转出来的mp3一起放在我服务器上了需要的可以去下载（右击后另存即可mp3可以在线播放silk播放不了直接单击会“403”）：微信小程序原始录音文件：sample.silk converter.sh脚本转码后的文件：sample.mp3附上我转码的操作过程：root@alijod:/home/jod/wechat_app/download/silk-v3-decoder# lltotal 48drwxr-xr-x 5 root root 4096 Sep 18 10:43 ./drwxr-xr-x 3 root root 4096 Sep 18 10:11 ../-rw-r--r-- 1 root root 4131 Sep 18 10:11 converter_beta.sh-rw-r--r-- 1 root root 3639 Sep 18 10:11 converter.shdrwxr-xr-x 8 root root 4096 Sep 18 10:11 .git/-rw-r--r-- 1 root root 1076 Sep 18 10:11 LICENSE-rw-r--r-- 1 root root 3582 Sep 18 10:11 README.md-rw-r----- 1 root root 6188 Sep 18 10:43 sample.silkdrwxr-xr-x 5 root root 4096 Sep 18 10:26 silk/drwxr-xr-x 3 root root 4096 Sep 18 10:11 windows/root@alijod:/home/jod/wechat_app/download/silk-v3-decoder# root@alijod:/home/jod/wechat_app/download/silk-v3-decoder# root@alijod:/home/jod/wechat_app/download/silk-v3-decoder# sh converter.sh sample.silk mp3-e [OK] Convert sample.silk To sample.mp3 Finish.root@alijod:/home/jod/wechat_app/download/silk-v3-decoder# lltotal 68drwxr-xr-x 5 root root  4096 Sep 18 10:43 ./drwxr-xr-x 3 root root  4096 Sep 18 10:11 ../-rw-r--r-- 1 root root  4131 Sep 18 10:11 converter_beta.sh-rw-r--r-- 1 root root  3639 Sep 18 10:11 converter.shdrwxr-xr-x 8 root root  4096 Sep 18 10:11 .git/-rw-r--r-- 1 root root  1076 Sep 18 10:11 LICENSE-rw-r--r-- 1 root root  3582 Sep 18 10:11 README.md-rw-r--r-- 1 root root 17709 Sep 18 10:43 sample.mp3-rw-r----- 1 root root  6188 Sep 18 10:43 sample.silkdrwxr-xr-x 5 root root  4096 Sep 18 10:26 silk/drwxr-xr-x 3 root root  4096 Sep 18 10:11 windows/关于converter.sh脚本vim打开converter.sh脚本显示一下行号（vim中输入\":set nu\"后回车我为小白操心不少）想要简单使用其实只需要关注最后面这一段如果想要深入研究最好是把脚本完整过程搞懂。 82 $cur_dir/silk/decoder \"$1\" \"$1.pcm\" > /dev/null 2>&1 83 if [ ! -f \"$1.pcm\" ]; then 84         ffmpeg -y -i \"$1\" \"${1%.*}.$2\" > /dev/null 2>&1 & 85         ffmpeg_pid=$! 86         while kill -0 \"$ffmpeg_pid\"; do sleep 1; done > /dev/null 2>&1 87         [ -f \"${1%.*}.$2\" ]&&echo -e \"${GREEN}[OK]${RESET} Convert $1 to ${1%.*}.$2 success, ${YELLOW}but not a silk v3 encoded file.${RESET}\"&&exit 88         echo -e \"${YELLOW}[Warning]${RESET} Convert $1 false, maybe not a silk v3 encoded file.\"&&exit 89 fi 90 ##ffmpeg -y -f s16le -ar 24000 -ac 1 -i \"$1.pcm\" \"${1%.*}.$2\" > /dev/null 2>&1 91 ffmpeg -y -f s16le -ar 12000 -ac 2 -i \"$1.pcm\" -f wav -ar 16000 -ac 1 \"${1%.*}.$2\" > /dev/null 2>&1 92 ffmpeg_pid=$! 93 while kill -0 \"$ffmpeg_pid\"; do sleep 1; done > /dev/null 2>&1 94 rm \"$1.pcm\" 95 [ ! -f \"${1%.*}.$2\" ]&&echo -e \"${YELLOW}[Warning]${RESET} Convert $1 false, maybe ffmpeg no format handler for $2.\"&&exit 96 echo -e \"${GREEN}[OK]${RESET} Convert $1 To ${1%.*}.$2 Finish.\" 97 exit其实关键的两行也就是Line 82和Line 90。第82行就是调用我们上文编出来的decoder解码silk_v3文件第90行是将silk_v3文件解码出来的raw data数据转成相应格式。这里额外说明一下我跟这两行的几个插曲：插曲一：speex压缩我做这个SILK语音识别服务的起初目的是让我的“遥知之”支持语音输入功能“遥知之”上用的OLAMI接口也有语音识别而且研究了一下他们的JAVA SDK和在线文档从在线文档（OLAMI 文档中心->语音识别接口文档->“支持的音频格式”）上看是支持wav格式另外支持speex压缩。wav格式文件是很占空间的（相当于PCM原始采样数据未经压缩的加了一个文件头）如下图所示（可能实际speex压缩的效果会更好一点）：如果将数据通过speex压缩就只需要脚本中的第62行就不用依赖ffmpeg去转码也可以直接省流量上传到OLAMI语音识别服务器了。这里就是为什么我前面说到ffmpeg并不是此服务搭建中必备之原因。如果通过speex会大大降低传输效率于是期间我有花蛮长时间在研究如何将pcm数据转成speex的比如怎么调用c代码实现的speex的编码（java下通过JNI调用speex的encoder研究未果放弃了这个方案）后来又找了jspeex（java版的speex codec）等等后面因有另一个省事方案这里用jspeex的方案就中断未深入研究了其实应该是行的通的。在QQ群（群号：656580961）里提了一下热心的群主“黄眉毛”说olami java sdk里默认是将wav或pcm通过speex压缩传输的这样一来我只需要将wav或pcm对接olami java sdk就可以实现“省流量”传输到olami语音识别服务器了。这就是我最终采用的省事方案。插曲二：采样率不适配发现通过微信小程序端录音出来的silk v3文件经过kn007的converter.sh转出来的wav文件再送到olami语音识别接口发现识别效果很糟把wav文件拿出来听听似乎也正常。这时候想起来脚本中PCM转wav是按24K转的转出来的WAV应该是24K的而olami语音识别端支持的是16K（讯飞还支持8K的）可能是这个采样率不一致导致的识别率差网搜了一下还真有前人碰到过相同问题参见此文文中提到的“误打误撞”那一段：从微信中提取语音文件并转换成文字的全自动化解决方案 他的误打误撞的原理应该是小程序录音就是双通道12K的然后ffmpeg额外指定一下参数将双通道12K的数据流转成16K的wav。好了离不开ffmpeg了需要它帮着转采样率呀speex压缩又不负责解决采样率转换的问题。重要的事说三遍：在原始脚本的基础上修改一下第90行：重要的事说三遍：在原始脚本的基础上修改一下第90行：重要的事说三遍：在原始脚本的基础上修改一下第90行：ffmpeg -y -f s16le -ar 12000 -ac 2 -i \"$1.pcm\" -f wav -ar 16000 -ac 1 \"${1%.*}.$2\" > /dev/null 2>&1插曲三：假silk（或mp3）真webm/base64格式在使用微信小程序开发工具模拟手机做调试时录音文件不能被silk和ffmpeg转vim打开一看头部是“data:audio/webm;base64,”。由此引伸出一个现象：微信小程序的录音不全是silk v3（或mp3）格式其中还有刚刚提到的webm/base64的好像还有AMR格式的听kn007大神说还有混淆格式也就是那种一个文件含多种格式混合的也不知道为什么会有这种情况。关于webm/base64格式kn007的回复是base64 decoder然后直接ffmpeg转于是我分两步实现：第一步：用java代码做base64 decoder再将文件写到 xxx.webm文件中这部分简单可参考微信小程序 录音文件格式silk 坑那样做即可。第二步：再调用ffmpeg命令直接转码成wav主要是调用一下下述转码命令转成16K的WAV：ffmpeg -i \"$1\" -f wav -ar 16000 -ac 1 \"${1%.*}.$2\" > /dev/null 2>&1其中调用ffmpeg命令容易出现失败原因之一可能会是文件读写权限不足原因之二可能会是调用ffmpeg后需要等ffmpeg进程消失即转码任务完成才退出。 觉得我个人碰到的问题应该是原因之二导致的因为我确实是将/usr/bin/ffmpeg设置成了777权限还是会转失败将调ffmpeg命令的部分在脚本中实现并且加上kn007大神converter.sh中那样的等待ffmpeg完成的部分就搞定了。为了让脚本更通用我将上述解决采样率不匹配的问题修改后的脚本基础上又添加了对webm格式的单独ffmpeg转码支持（通过判断传入第1个参数的后辍是否是webm来判断是不是直接ffmpeg转码然后exit简单粗暴并且高效！）大概在脚本的上方添加下面这一段：SOURCE_FILE_SUFFIX=${1##*.}echo -e \"XXXX SOURCE_FILE_SUFFIX:${SOURCE_FILE_SUFFIX}\"if [[ \"${SOURCE_FILE_SUFFIX}\" == \"webm\" || \"${SOURCE_FILE_SUFFIX}\" == \"mp3\" ]]; then        ## if webm, ffmpeg it directly. webm/base64 had been base64 decode on api.happycxz.com already.        ## if mp3, ffmpeg it directly. mp3 do not need to decode, can be convert to wav directly.        echo -e \"begin to ffmpeg $2 from webm now...\"        ##ffmpeg -i \"$1\" -f wav -ar 16000 -ac 1 \"${1%.*}.$2\" > ffmpeg.cxz.log 2>&1        ffmpeg -i \"$1\" -f wav -ar 16000 -ac 1 \"${1%.*}.$2\" > /dev/null 2>&1        ##ffmpeg -i \"$1\" -f wav \"${1%.*}.$2\" > /dev/null 2>&1        ffmpeg_pid=$!        while kill -0 \"$ffmpeg_pid\"; do sleep 1; done > /dev/null 2>&1        [ ! -f \"${1%.*}.$2\" ]&&echo -e \"${YELLOW}[Warning]${RESET} Convert $1 false, maybe ffmpeg no format handler for $2.\"&&exit        echo -e \"${GREEN}[OK]${RESET} Convert $1 To ${1%.*}.$2 Finish.\"        exitelse        echo -e \"begin to silk decoder flow...\"        ## if not webm, follows default silk decoder road.fi(注：以上脚本片断在2017.11.09更新了mp3部分支持因为小程序录音新接口已经支持mp3格式录音录音文件直接经ffmpeg转wav即可)至此converter_cxz.sh修改结束。搭建web服务及主要代码说明前面相当于评估可行性基本验证了从小程序录音文件 xx.silk 到语音识别API能认的数据或文件格式这条路走通了接下来就是堆JAVA代码实现细节部分了。创建SPRINMVC工程大概的工程目录结构如下：com.happycxz.controller中有两个controller：第1个AdditionalController.java是用来查服务器状态和在线更新数据用的可忽略。第2个OlamiController.java是对接微信小程序silk文件上传API接口的代码如下：package com.happycxz.controller;import java.io.BufferedReader;import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.FileOutputStream;import java.io.IOException;import java.io.InputStreamReader;import java.security.NoSuchAlgorithmException;import java.util.Map;  import javax.servlet.ServletException;  import javax.servlet.http.HttpServletRequest;  import javax.servlet.http.HttpServletResponse;  import javax.servlet.http.Part;import org.springframework.stereotype.Controller;  import org.springframework.util.StringUtils;  import org.springframework.web.bind.annotation.RequestMapping;  import org.springframework.web.bind.annotation.RequestParam;  import org.springframework.web.bind.annotation.ResponseBody;import com.happycxz.olami.AsrAdditionInfo;import com.happycxz.olami.OlamiEntityFactory;import com.happycxz.olami.SdkEntity;import com.happycxz.utils.Configuration;import com.happycxz.utils.Util;import com.sun.org.apache.xml.internal.security.utils.Base64;  /**  * olami与微信小程序 接口相关对接 * @author Jod */@Controller  @RequestMapping(\"/olami\")  public class OlamiController {    //保存linux shell命令字符串    private static final String SHELL_CMD = Configuration.getInstance().getValue(\"local.shell.cmd\", \"sh /YOUR_PATH/silk-v3-decoder/converter_cxz.sh %s wav\");    //保存silk_v3, mp3和wav文件的目录放在web目录、或一个指定的绝对目录下     private static final String localFilePath = Configuration.getInstance().getValue(\"local.file.path\", \"/YOUR/LOCAL/VOICE/PATH/\");;      static {        Util.p(\"OlamiController base SHELL_CMD:\" + SHELL_CMD);        Util.p(\"OlamiController base localFilePath:\" + localFilePath);    }    @RequestMapping(value=\"/asr\", produces=\"plain/text; charset=UTF-8\")      public @ResponseBody String asrUploadFile(HttpServletRequest request, HttpServletResponse response, @RequestParam Map p)              throws ServletException, IOException {          return processBase(request, p, false);    }      @RequestMapping(value=\"/mp3asr\", produces=\"plain/text; charset=UTF-8\")      public @ResponseBody String asrUploadFileMp3(HttpServletRequest request, HttpServletResponse response, @RequestParam Map p)              throws ServletException, IOException {        return processBase(request, p, true);    }    public String processBase(HttpServletRequest request, @RequestParam Map p, boolean isMp3)              throws ServletException, IOException {          AsrAdditionInfo additionInfo = new AsrAdditionInfo(p);        if (additionInfo.getErrCode() != 0) {            //参数不合法或者appKey没有在支持列表中备录            return Util.JsonResult(String.valueOf(additionInfo.getErrCode()), additionInfo.getErrMsg());          }        String localPathToday = localFilePath + getSrcFmt(isMp3) + File.separator + Util.getDateStr() + File.separator;        // 如果文件存放路径不存在则mkdir一个          File fileSaveDir = new File(localPathToday);          if (!fileSaveDir.exists()) {              fileSaveDir.mkdirs();          }        int count = 1;        String asrResult = \"\";        for (Part part : request.getParts()) {              String fileName_origin = extractFileName(part);            //这里必须要用原始文件名是否为空来判断因为part列表是所有数据前三个被formdata占了对应文件名其实是空            if(!StringUtils.isEmpty(fileName_origin)) {                Util.p(\"originFileName[\" + count + \"]:\" + fileName_origin);                String fileName = additionInfo.getVoiceFileName(isMp3);                //DEBUG on windows, add temp path preffix to local D: to preserve part.write exception.                //String recFile = \"D:\" + localPathToday + fileName;                String recFile = localPathToday + fileName;                Util.p(\"recFileName[\" + count + \"]:\" + recFile);                part.write(recFile);                if (webmBase64Decode2Wav(recFile)) {                    //support webm/base64 in webmBase64Decode2Wav(), wxapp develop IDE record format.                     //even if the suffix is xx.silk(wx.startRecord generate) or xx.mp3(wx.getRecorderManager generate)                    //if webm base64 format , and xxxx.webm file is temporary created, xxxx.wav was last be converted.                } else {                    // run script to convert silk_v3 or mp3 to wav                    Util.RunShell2Wav(SHELL_CMD, recFile);                }                // get wave file path and name, prepare for olami asr                String waveFile = DotMp3OrDotSilk2DotOther(recFile, \"wav\");                Util.p(\"OlamiController.asrUploadFile() waveFile:\" + waveFile);                if (new File(waveFile).exists() == false) {                    Util.w(\"OlamiController.asrUploadFile() wav file[\" + waveFile + \"] not exist!\", null);                    return Util.JsonResult(\"80\", \"convert \" + getSrcFmt(isMp3) + \" to wav failed, NOW NOT SUPPORT WXAPP DEVELOP RECORD because it is not \" + getSrcFmt(isMp3) + \" format. anyother reason please tell QQ:404499164.\");                 }                try {                    SdkEntity entity = OlamiEntityFactory.createEntity(additionInfo.getAppKey(), additionInfo.getAppSecret(), additionInfo.getUserId());                    asrResult = entity.getSpeechResult(waveFile);                    Util.p(\"OlamiController.asrUploadFile() asrResult:\" + asrResult);                } catch (NoSuchAlgorithmException | InterruptedException e) {                    Util.w(\"OlamiController.asrUploadFile() asr NoSuchAlgorithmException or InterruptedException\", e);                } catch (FileNotFoundException e) {                    Util.w(\"OlamiController.asrUploadFile() asr FileNotFoundException\", e);                    return Util.JsonResult(\"80\", \"convert \" + getSrcFmt(isMp3) + \" to wav failed, NOW NOT SUPPORT WXAPP DEVELOP RECORD because it is not \" + getSrcFmt(isMp3) + \" format. anyother reason please tell QQ:404499164.\");                 } catch (Exception e) {                    Util.w(\"OlamiController.asrUploadFile() asr Exception\", e);                }            }            count++;        }        //防止数据传递乱码        //response.setContentType(\"application/json;charset=UTF-8\");        return Util.JsonResult(\"0\", \"olami asr success!\", asrResult);      }    private static String getSrcFmt(boolean isMp3) {        return (isMp3 ? \"mp3\":\"silk_v3\");    }    /**     * 将  xxxxx.silk 文件名转 xxxx.wav     * @param silkName     * @param otherSubFix     * @return     */    private static String DotMp3OrDotSilk2DotOther(String recName, String otherSubFix) {        int removeByte = 4;        if (recName.endsWith(\"silk\")) {            removeByte = 4;        } else if (recName.endsWith(\"slk\") || recName.endsWith(\"mp3\")) {            removeByte = 3;        }        return recName.substring(0, recName.length()-removeByte) + otherSubFix;    }    /**      * 从content-disposition头中获取源文件名      *       * content-disposition头的格式如下：      * form-data; name=\"dataFile\"; filename=\"PHOTO.JPG\"      *       * @param part      * @return      */    private String extractFileName(Part part) {          String contentDisp = part.getHeader(\"content-disposition\");          String[] items = contentDisp.split(\";\");          for (String s : items) {              if (s.trim().startsWith(\"filename\")) {                  return s.substring(s.indexOf(\"=\") + 2, s.length()-1);              }          }          return \"\";      }    /**     * 通过filePath内容判断是否是webm/base64格式如果是先decode base64后再直接ffmpeg转wav     * 如果不是返回false丢给外层继续当作silk v3去解     * @param filePath     * @return     */    public static boolean webmBase64Decode2Wav(String filePath) {        boolean isWebm = false;        try {            String encoding = \"utf-8\";            File file = new File(filePath);            // 判断文件是否存在            if ((file.isFile() == false) || (file.exists() == false)) {                Util.w(\"webmBase64Decode2Wav() no file[\" + filePath + \"] exist.\", null);            }            StringBuilder lineTxt = new StringBuilder();            String line = null;            try (            InputStreamReader read = new InputStreamReader(new FileInputStream(file), encoding);            BufferedReader bufferedReader = new BufferedReader(read);) {                while ((line = bufferedReader.readLine()) != null) {                    lineTxt.append(line);                }                read.close();            } catch (Exception e) {                Util.w(\"webmBase64Decode2Wav() exception0:\", e);                return isWebm;            }            String oldData = lineTxt.toString();            if (oldData.startsWith(\"data:audio/webm;base64,\") == false) {                Util.d(\"webmBase64Decode2Wav() file[\" + filePath + \"] is not webm, or already decoded.\" );                                               .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小北微信小程序之-- 添加照片（小程序图片上传功能）               微信小程序仿微信、QQ 向左滑动删除操作                                                        原作者: happycxz                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序语音与讯飞语音识别踩坑过程                                                      • 微信小程序之语音识别(附小程序+服务器源码)                                                      • 搭建https的silk录音文件语音识别服务的调用过程                                                      • 基于腾讯云智能语音的实时语音识别微信小程序的开发                                                      • 微信小程序录音与播放录音                                                      • 小程序wx.setScreenBrightness/wx.getScreenBrightness接口测试                                                      • 小程序实现语音识别到底要填多少坑？                                                      • 小程序wx.getRecorderManager()录音管理                                                                                               "},{"title": "github精选：微信小程序说明：数据绑定及条件渲染,列表渲染 ", "author": "                  天下雪                  2016-12-8 14:03                ", "text": "                                                                                                                                                                                     作者：ktont来自github数据绑定字符串运算  <view class=\"price\">{{info.name + info.family.addr}}</view>如果info是空不会报错生成的结果和JS相同。undefined + undefined = NaN如果family是空不会报错生成的结果和JS相同。string + undefined = stringundefined如果属性都有效正常的加法运算之所以这样的原因是因为微信的语法解析分三部分优先级高的点引用在先加法在后。是这样的    var scr = \"info.name + info.family.addr\".split(' ')    var oper = scr[1];    \"info.name\".split('.').find in dataMap    \"info.family.addr\".split('.') find in dataMap    if(null) {        return undefined    }    //注意：想想oper是undefined会怎样？    eval(a oper b) || ''目前支持的operation有所有算术运算、位运算和逻辑运算三目运算。所以就不难理解下面的写法将会引发致命错误    <view class=\"price\">{{info.name info.family.addr}}</view>因为找不到operationView Thread抛出错误。渲染失败页面呲掉。    <view class=\"price\">{{info.name}}{{info.family.addr}}</view>这是最安全的写法不过很难看懂。它相当于输出（渲染）console.log(a||''); console.log(b||'');然而下面的哈哈它就不是一个运算了    <view class=\"price\">{{info.name}} + {{info.family.addr}}</view>而是输出（渲染）    console.log(a||''); console.log('+'); console.log(b||'');条件渲染wx:if  <view wx:if=\"{{name}}\">{{name}}</view>当name是null,0,false特别是空字符串''时这些js判断为假的值wx:if也判断为假。Tip: 此时的行为和js相同。  <view wx:if=\"{{obj.val.name}}\">{{name}}</view>当obj不存在的时候即：obj===undefined。不管引用了多少层。wx:if什么都不做并不出错。Tip: 此时的行为和js不同不过极可能正是你想要的效果。列表渲染wx:for  <block wx:for=\"{{obj}}\"><view>{{item}}</view></block>如果obj是null, '', false等js认为的空什么都不做如果obj是{},[]空对象什么都不做如果是字符串则每个字符为一个元素如果是个对象则输出valueitem为value。比如{id:1, name:'abc'}输出1和abc如果是个数组则输出每个元素item为元素Tip: 此时的行为和js相同。  <block wx:for=\"{{obj.data.name}}\"><view>{{item}}</view></block>当obj不存在的时候即：obj===undefined。不管引用了多少层。wx:if什么都不做并不出错。Tip: 此时的行为和js不同不过极可能正是你想要的效果。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序讲解《一》——宏观了解心中有数               从零入门系列《二》手动创建目录结构                                                        原作者: ktont                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • github精选：构建自己的第一个小程序                                                      • 微信小程序开发--条件渲染详解                                                                                               "},{"title": "微信小程序开发之——flex布局（附源码下载） ", "author": "                  天下雪                  2016-12-7 00:29                ", "text": "                                                                                                                                                                                     作者：SundayAaron；已经获得授权；打开微信小程序开发工具新建Hello word项目删除掉无用的代码。flex-directionflex-direction属性表示布局的方向 有两个值： row | column 默认属性是row 行布局html代码如下：<view class=\"section\">  <view class=\"section__title\">flex-direction: row</view>  <view class=\"flex-wrp\" style=\"flex-direction:row;\">    <view class=\"flex-item bc_green\">1</view>    <view class=\"flex-item bc_red\">2</view>    <view class=\"flex-item bc_blue\">3</view>  </view></view>1234567812345678效果图： flex-direction: column属性：<view class=\"section\">  <view class=\"section__title\">flex-direction: column</view>  <view class=\"flex-wrp\" style=\"flex-direction:column;height: 100%;\">    <view class=\"flex-item bc_green\">1</view>    <view class=\"flex-item bc_red\">2</view>    <view class=\"flex-item bc_blue\">3</view>  </view></view>1234567812345678flex-direction: column效果图： justify-contentjustify-content:弹性项目在主轴main-axis线上的对齐方式； 值：flex-start | flex-end | center | space-between | space-around （注：当横向排列时 主轴就是x轴；反之则是y轴。）justify-content:flex-start<view class=\"section\">  <view class=\"section__title\">justify-content:flex-start</view>  <view class=\"flex-wrp\" style=\"flex-direction:row;justify-content:flex-start;\">    <view class=\"flex-item bc_green\">1</view>    <view class=\"flex-item bc_red\">2</view>    <view class=\"flex-item bc_blue\">3</view>  </view></view>1234567812345678效果图： flex-end | center | space-between | space-around 值同理 align-itemsalign-Items表示在垂直方向上的布局情况定义在父级容器中； 有 flex-start | flex-end | center |stretch 四个值。align-items:flex-start;<view class=\"section\">  <view class=\"section__title\">align-items:flex-start;</view>  <view class=\"flex-wrp\" style=\"flex-direction:row;align-items:flex-start;\">    <view class=\"flex-item bc_green\">1</view>    <view class=\"flex-item bc_red\">2</view>    <view class=\"flex-item bc_blue\">3</view>  </view></view>1234567812345678效果图： align-items:center;<view class=\"section\">  <view class=\"section__title\">align-items:center;</view>  <view class=\"flex-wrp\" style=\"flex-direction:row;align-items:flex-start;\">    <view class=\"flex-item bc_green\">1</view>    <view class=\"flex-item bc_red\">2</view>    <view class=\"flex-item bc_blue\">3</view>  </view></view>1234567812345678效果图： align-items:flex-end;<view class=\"section\">  <view class=\"section__title\">align-items:flex-end;</view>  <view class=\"flex-wrp\" style=\"flex-direction:row;align-items:flex-end;\">    <view class=\"flex-item bc_green\">1</view>    <view class=\"flex-item bc_red\">2</view>    <view class=\"flex-item bc_blue\">3</view>  </view></view>1234567812345678源码下载：flex布局.zip                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    github精选：微信小程序入门简要教程               从零入门系列《一》安装工具及项目的创建                                                        原作者: SundayAaron                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 水牛01248：flex布局示例                                                      • 微信小程序源码解析：数字累加动态效果（附demo）                                                      • 在微信小程序中学习flex布局                                                      • 从微信小程序看待FlexBox布局                                                      • 微信小程序 View：flex 布局                                                                                               "},{"title": "WeScale 技术篇 —— mpvue 与微信小程序的火花 ", "author": "                  Rolan                  2018-4-10 00:32                ", "text": "                                                                                                                                                                                     介绍项目介绍WeScale 定位为音乐训练小程序初期规划了基础音阶的三个训练以及他们的镜像模式。数字简谱字母简谱数字简谱对字母简谱后期看情况更新追加其他训练。产品展示扫描下方小程序码或在微信小程序中搜索 WeScale即可使用。人员介绍Myou Aki ：明神北漂前端总有奇奇怪怪的想法想要实现适合做产品的前端Dr.Chan ：老陈后端、前端通吃长得帅说话又好听的茂名吃货Jackliu ：大坚产品、伪前端不想做前端的产品不是好司机缘起明神每晚都要练着他的电吉他敲着他的木鱼突然一道光在脑海中闪过机智的他迅速捕获到当晚凌晨三点做完了这次小程序的原型。之前和老陈搞了个 A股股票助手 — stock-helper 这次有明神带路我们都想积累点小程序开发的经验于是我和老陈就上车了。（滴~~学生卡）恰逢美团刚刚开源了 mpvue 短短几周就迅速获得几千个 star在 mpvue 开源前最流行的应该是 wepy 。据说用 mpvue能够像德芙一样顺滑地使用 vue 写微信小程序于是我们开始了踩坑之路。项目统计预计一周完成毕竟是大家都有正经事要做硬是拖到了两周才完成。四个分支总计提交 51次越到 deadline 提交越多目前已发布 v1.0.0 版本已审核上线。踩到的坑微信小程序不能使用本地资源这个坑很常见微信小程序不支持本地引用图片、音频、视频所以需要外链。对于图片还可以使用 Base64 编码直接在 html 或 css 中引用。根据图片根据图片体积或者可维护性考虑酌情使用外链或者Base64编码。新增页面需要 npm run dev这个是 mpvue 的问题。常见问题可以发现。解决的方法就是手动 npm run dev 一下。生命周期问题mpvue 是兼容微信小程序的生命周期与 vue 的生命周期也就是 vue 实例会接管小程序 Page 实例的生命钩子因此需要使用到小程序的生命周期钩子时可将相应的钩子方法定义在 vue 实例中如定义当前Page的分享标题内容图片：new Vue({  data () {    return {      score: ''    }  },  onShareAppMessage (res) {    return {      title: '我获得 ' + this.score + ' 分快来一起掌握基础音阶知识吧！',      path: '/pages/index/index',      imageUrl: 'https://wechat.dddog.com.cn/static/wescale.jpg'    }  }})这个不知道如何描述大致是非当前页面的 create() 会在当前页面执行解决方法用小程序的 onload()/ vue 的 mounted()遇到问题看图就好：Class 与 Style 绑定不支持 vue 官方文档：Class 与 Style 绑定 中的 classObject 和 styleObject 语法。 暂不支持在组件上使用 Class 与 Style 绑定不支持就不用咯~没有 BOM／DOM 操作mpvue 使得开发者可以使用标准 html、css 去编写小程序当我们查看 mpvue 项目中的 dist 文件夹时可以发现编写的 html、css 被解析成了小程序的 wxml、wxss 固然小程序的运行环境也就是非标准的 WebView 了。因此我们web开发进行经常使用的 browser、navigator 实例自然是无法使用了取而代之的是使用小程序浏览器提供的API —— wx实例去操作native元素。至于 DOM 操作即使在vue中也是不建议使用的还是用数据驱动去转化吧。也就是说所有关于 BOM / DOM 的操作都不行。用 vue 第三方 UI库时要注意 Dom 和 Bom 相关的 API 操作都无法实现。 解决方案： 这块主要是动画不能用那就用 css3 咯~组件名不要和微信的组件名重名试着写一个 swicth 的组件发现渲染结果不对查了原因才发现微信小程序也有个 switch 的组件。 解决方案： 改名字啊。命名规范！微信小程序多声道按正常的套路去使用小程序的 api —— wx.createInnerAudioContext() 是无法创建多声道的。本次技术的难点也在于如何创建微信小程序的多声道。查了一圈的资料关于这点的资料甚少。查到一篇博客通过创建多个 innerAudioContext 实例化对象轮流调用的方式。对于原作者说小程序只能同时存在5个音频实例这一定不敢苟同。毕竟我直接创建了 30个都没问题哈哈const audioContextNum = 30let globalAudioContext = Array.from({ length: audioContextNum },  (v, k) => wx.createInnerAudioContext())如何寻找当前可用的声道也是个难点大致的思想是把正在播放的实例封锁待实例的 onEnded() 回调执行时取消封锁使用时需要遍历所有实例寻找当前可用的实例看实例代码(与实际代码有删改)：// 自动寻找一个当前可用的 audioContext 实例export function playedMusic (url) {  let contextList = store.getters.globalAudioContext  while (contextList !== store.getters.audioContextStatus.map(item => item === false).length) {    let audioContextStatus = store.getters.audioContextStatus    let index = store.getters.currentAudioIndex    // 如果当前可用封锁    if (audioContextStatus[index]) {      store.commit('setAudioContextStatus', {index, status: false})      break    } else {      // 否则 ++index      store.commit('setCurrentAudioIndex', ++index)    }  }  const resultPromise = new Promise((resolve, reject) => {    contextList[index].onPlay(() => {})    contextList[index].onError((res) => {      reject(res)    })    contextList[index].onEnded((res) => {      reset(resolve)    })  })  return resultPromise}微信小程序的缓存实际开发过程中发现。如果不预先对音频进行缓存实际播放时会有一定的延迟视网络情况。解决方案是先预加载然后存在小程序的缓存中官网介绍缓存有 10 M足够用了。 首先是下载文件 wx.downloadFile()得到 tempFilePath再把临时文件保存为本地文件 wx.saveFile(),得到 savedFilePath再将本地文件的的路径保存在缓存中 wx.setStorage()。这么多异步操作当然用 Promise 再封装一下啦。多文件的下载、保存、缓存, 回调、递归的思想：// 加载资源, 加载完隐藏loading  _load(0, () => {    // 更改Audio.js的config对象属性。    config.musicUrl = JSON.parse(musicUrlTemp)    const temp = JSON.parse(musicUrlTemp)    temp.tempVerison = tempVerison    wx.setStorage({key: 'musicUrl', data: temp})    wx.hideLoading()  })  function _load (index, callback) {    if (!musicUrlArr[index]) {      callback()    } else {      downloadFile(musicUrlArr[index]).then((tempFilePath) => {        saveFile(tempFilePath).then((savedFilePath) => {          musicUrlTemp = musicUrlTemp.replace(            musicUrlArr[index],            savedFilePath          )          index++          _load(index, callback)        })      })    }  }缓存是否存在及缓存版本的判断：// 判断是否已有缓存且缓存版本正确  if (temp && temp.tempVerison === tempVerison) {    return false  }全局变量遇到很多需要全局变量特别是状态的最好统一管理。vue 的vuex 是专为 Vue.js 应用程序开发的状态管理模式。使用过程遇到的坑是无法使用它的辅助函数 mapState、 mapGetters、 mapActions、 mapMutations 等。看下 mpvue 的 issue 感觉是 mpvue 的问题。 解决方案： 用最原始的 store.commit()、 store.getter数据分析及合法域名调用微信小程序的网络请求 wx.request()、 wx.downloadFile() 之类 都需要 https 协议。 调微信的数据分析还要隔两个小时获取 access_token, 这些就是要服务器端的配置了。条件： 域名及域名证书、服务器获取 token 及 服务器写接口返回静态文件及微信的数据分析接口 可以参考这个, node.js 写的写的很随意随便看看。ES6 的模块动态引用参考 博客 :ES6 模块中的值属于【动态只读引用】。只说明一下复杂数据类型。对于只读来说即不允许修改引入变量的值 import 的变量是只读的不论是基本数据类型还是复杂数据类型。当模块遇到 import 命令时就会生成一个只读引用。等到脚本真正执行时再根据这个只读引用到被加载的那个模块里面去取值。对于动态来说原始值发生变化 import 加载的值也会发生变化。不论是基本数据类型还是复杂数据类型。// b.jsexport let counter = {  count: 1}setTimeout(() => {  console.log('b.js-1', counter.count)}, 1000)// a.jsimport { counter } from './b.js'counter = {}console.log('a.js-1', counter)// Syntax Error: \"counter\" is read-only虽然不能将 counter 重新赋值一个新的对象但是可以给对象添加属性和方法。此时不会报错。这种行为类型与关键字 const 的用法。// a.jsimport { counter } from './b.js'counter.count++console.log(counter)// 2致谢致谢所有参与产品、开发、测试贡献出创意想法与建议的小伙伴。我们有个小团队自嘲为“咸鱼科技”谁说咸鱼不能有梦想哈哈。我们还需要 UI、运营等如果你有想法、有创意、有技能可以加入我们的小团队！2333~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序实现多折叠展开酷炫菜单               给微信聊天记录添加截图功能                                                        原作者: Jackliu007888                   来自: 稀土掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 在 mpvue 使用 echarts 小程序组件                                                      • 记一次mpvue-loader源码探究                                                      • Mpvue 小程序转 Web 实践总结                                                      • 在小程序、mpvue中使用flyio发起网络请求                                                      • 在小程序/mpvue中使用flyio发起网络请求                                                      • 美团小程序框架mpvue(花名：没朋友)蹲坑指南                                                      • 使用mpvue开发小程序通用能力封装                                                      • 记一次基于mpvue的小程序开发及上线实战                                                      • 基于mpvue的简单弹窗组件mptoast                                                      • 基于 mpvue 框架的小程序选择组件支持单列多列级联                                                                                               "},{"title": "理解微信小程序技术架构 ", "author": "                  Rolan                  2017-8-5 00:40                ", "text": "                                                                                                                                                                                     视图层和逻辑层分离通过数据驱动事件交互不直接操作DOM视图层负责渲染页面结构逻辑层负责逻辑处理、数据请求、接口调用等视图层与逻辑层通过数据和事件进行通信逻辑层提供数据给视图层视图层通过绑定/捕获事件发起交互让逻辑层处理视图使用WebView渲染JS由JSCore(IOS)/X5(Android)/nmjs(DevTool)渲染解析JSBridge下架起上层开发与Native（系统层）的桥梁使得小程序可通过API使用原生的功能且部分组件为原生组件实现从而有良好体验附：浏览器内核了解点击预览组件wxml为微信开发的一种标记语言只能使用其指定的组件（view, text, navigator, image, button等详见文档<组件>）。View - Component小程序的组件基于Web Component标准使用Polymer框架实现Web ComponentView - Native Component目前Native实现的组件有 <canvas/> <video/> <map/> <textarea/>Native组件层在WebView层之上wxss样式表支持大部分CSS特性不支持多层选择器-避免被组件内结构破坏style：style 接收动态的样式在运行时会进行解析请尽量避免将静态的样式写进 style 中以免影响渲染速度。<view style=\"color:{{color}};\" />拓展：尺寸单位：添加尺寸单位rpx可根据屏幕宽度自适应样式导入：使用@import语句可以导入外联样式表生命周期微信小程序生命周期分“应用生命周期”和“页面生命周期”。应用生命周期含onLaunch, onShow, onHide状态onLaunch, onShow可获取打开小程序时的相关参数path, query, scene shareTicket referrerInfo注册为App({})一个小程序只有一个App({})。页面生命周期含onLoad, onShow, onHide, onReady, onUnloadonLoad可获取其他页面打开当前页面时所所调用的query参数注册为Page({})每个页面有且必须有一个Page({})。不清楚的地方多多重复查看文档说明：注册程序注册页面页面栈：页面导航getCurrentPages(): 获取当前页面栈的实例以数组形式按栈的顺序给出第一个元素为首页最后一个元素为当前页面。Tip：不要尝试修改页面栈会导致路由以及页面状态错误。页面深度最多为5层也就是页面栈里最多只能有5个页面超过的话调用导航就会失效因此要选用合适的导航方式及时释放页面。navigate：A -> B 其页面栈依次为：A - ABredirect: A -> B 其页面栈依次为：A - B不同导航方式致页面栈的变化图解可查看这篇文章：小程序基础篇之页面路由数据通信机制数据单向绑定：使用 Mustache 语法（双大括号）将变量包起来动态数据均来自对应 Page 的 data可以通过setData({})方法修改数据。<view>{{ message }}</view>事件绑定：写法同组件的属性以 key、value 的形式key 以bind或catch开头然后跟上事件的类型如bindtap, catchtouchstartvalue 是一个字符串需要在对应的 Page 中定义同名的函数函数参数则通过在组件上加data-域。<view data-param=”value” bindtap=”showModal”></view> 详细的说明还是查阅文档：注册页面：着重看变量和事件部分 视图层-WXML-数据绑定视图层-WXML-事件提醒一下熟悉vuejs的朋友应该很容易上手略读一遍文档就基本明白了但要留意下数据不是双向绑定的改变变量值需要通过setData({})事件传参是通过data域遍历及条件语句中变量/语句仍需带{{ }}等总之多看文档避免踩这种用法有误的坑。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)肥肥说                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序中引用FontAwesome字体               微信小程序UI组件、开发框架、实用库.                                                                           来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序学习记录《一》：目录结构介绍开发工具菜单介绍 ... ...                                                      • 从零入门系列《二》手动创建目录结构                                                      • 微信小程序探究：运行环境目录结构模版语言及事件系统 ...                                                      • 微信小程序开发详解《一》开发准备开发工具使用简介工程目录结构 ...                                                      • 微信小程序 结构以及常见问题                                                      • 微信小程序开发手记《一》：项目的代码结构                                                      • 为微信小程序增加mixin扩展                                                      • Android开发不用学CSS从0开始学习微信小程序                                                                                               "},{"title": "微信小程序菜单实现 ", "author": "                  Rolan                  2017-7-10 00:38                ", "text": "                                                                                                                                                                                     最近一个月都在做微信小程序作为一个Android开发者在这一个月很少写Android的代码真是悲催好在现在已经完整的把小程序做完了下周就继续开始我的Android生涯了现在回过头来写写自己认为比较常见的一些功能的实现来帮助小程序学习爱好者学习参考。今天的这篇文章是关于微信小程序菜单的实现话不多说上图。源码传送门通过效果图我们看到窗口最上面是两个菜单按钮它是固定悬浮在最上面当点击时分别显示状态选择和时间选择那此处状态就是我们购物订单的状态有全部待付款等并且当前选中的状态加上红色的边框让用户知道当前的选择项。那点击时间时就显示显示开始日期和结束日期当点击确定时对当前日期时间段的购物订单进行过滤。状态和时间菜单按钮实现菜单按钮实现很简单使用display：flex属性使用position: fixed将其定位窗口显示 top: 0;left: 0;悬浮在最上面。上下都加上边框。&ltview class=\"top-menu\">    &ltview bindtap=\"showMenuTap\" data-type=\"1\">状态</view>    &ltview class=\"line\"></view>    &ltview bindtap=\"showMenuTap\" data-type=\"2\">时间</view>  </view>样式.top-menu {  display: flex;  position: fixed;  height: 80rpx;  z-index: 10;  background-color: #fff;  width: 100%;  top: 0;  left: 0;  align-items: center;  justify-content: space-around;  border-top: 2rpx solid #ddd;  border-bottom: 2rpx solid #ddd;  font-size: 11pt;  color: #bdbdbd;}.line {  width: 2rpx;  height: 100%;  background-color: #ddd;}两个菜单中间的分割线我使用了一个view当然依然可以使用border属性。在此处给加个z-index属性。稍后会介绍到他的作用。弹出菜单实现&ltview wx:if=\"{{menuType==1}}\" class=\"state-menu \"  hidden=\"{{!isVisible}}\">  &ltview class=\"state-item {{status==1?'border':''}}\" bindtap=\"selectState\" data-status=\"1\">全部</view>  &ltview class=\"state-item {{status==2?'border':''}}\" bindtap=\"selectState\" data-status=\"2\">待付款</view>  &ltview class=\"state-item {{status==3?'border':''}}\" bindtap=\"selectState\" data-status=\"3\">待发货</view>  &ltview class=\"state-item {{status==4?'border':''}}\" bindtap=\"selectState\" data-status=\"4\">配送中</view>  &ltview class=\"state-item {{status==5?'border':''}}\" bindtap=\"selectState\" data-status=\"5\">待收货</view>  &ltview class=\"state-item {{status==6?'border':''}}\" bindtap=\"selectState\" data-status=\"6\">待评价</view>  &ltview class=\"state-item {{status==7?'border':''}}\" bindtap=\"selectState\" data-status=\"7\">退款</view>  &ltview class=\"state-item {{status==8?'border':''}}\" bindtap=\"selectState\" data-status=\"8\">已取消</view></view><!--日期选择-->&ltview wx:elif=\"{{menuType==2}}\" class=\"state-menu\" hidden=\"{{!isVisible}}\">  &ltview class=\"date\">    &ltview class=\"classname\">开始日期: </view>    &ltpicker mode=\"date\" value=\"{{date}}\" data-type=\"1\" bindchange=\"bindDateChange\">      &ltview class=\"classname\">{{begin==null?'不限':begin}}</view>    </picker>  </view>  &ltview class=\"date\">    &ltview class=\"classname\">结束日期: </view>    &ltpicker mode=\"date\" value=\"{{date}}\" data-type=\"2\" bindchange=\"bindDateChange\">      &ltview class=\"classname\">{{end==null?'不限' : end}}</view>    </picker>  </view>  &ltbutton class=\"date-btn\" bindtap=\"sureDateTap\">确定</button></view>样式.state-menu {  display: flex;  position: fixed;  left: 0;  height: 200rpx;  top: 80rpx;  width: 100%;  z-index: 9;  background-color: #fff;  flex-direction: row;  border-bottom: 2rpx solid #ddd;  justify-content: space-around;  align-items: center;  flex-wrap: wrap;}.state-item {  width: 20%;  height: 70rpx;  font-size: 11pt;  line-height: 70rpx;  text-align: center;  border-radius: 10rpx;  border: 2rpx solid #ddd;}.border.state-item {  border: 2rpx solid #c4245c;}.date {  min-width: 40%;  display: flex;  font-size: 11pt;  color: #bdbdbd;  align-items: center;}.date-btn {  min-width: 80%;  font-size: 12pt;  background-color: #c4245c;  color: #fff;}弹出菜单我们设置高度为200rpx,依然使用position属性fixed将其固定在菜单按钮下面由于菜单按钮我们设置的高度是80rpx,为了显示在菜单按钮下面我们将top设置为80rpx.flex-wrap指定为wrap作用就是当item超出屏幕宽度时自动换行。由于我们设置状态的state-item的宽度为20%,所以当显示四个item时会换新行显示（五个item100%再加上border会超过宽度所以第五个在新行显示（使用box-sizing: border-box可让border宽度输入item的宽度即item的20%包含border宽度））。picker 组件是底部弹起的滚动选择器现支持三种选择器通过mode来区分分别是普通选择器（mode = selector）时间选择器（mode = time）日期选择器（mode = date）默认是普通选择器所以我们在此处设置mode = date。并且可以通过start设置有效日期范围的开始字符串格式为\"YYYY-MM-DD\"通过end设置有效日期范围的结束字符串格式为\"YYYY-MM-DD\"。选择的日期通过e.detail.value获得。透明蒙版效果当我们使用系统组件picker 弹出选择器时我们会看到有一个透明的蒙版效果那么我们也实现一个蒙版效果&ltview class=\"dialog-mask\" style=\"visibility:{{isVisible ? 'visible':'hidden'}}\" bindtap=\"hideMenuTap\"/>样式.dialog-mask {  position: fixed;  top: 0;  left: 0;  right: 0;  bottom: 0;  z-index: 8;  background: rgba(0, 0, 0, 0.3);}我们给蒙版设置了一个点击事件当点击时直接隐藏弹出菜单样式使用了position：fixed属性并将top,left,right,bottom都设置为0即将蒙版全屏显示设置背景黑色透明的为0.3.此处依然使用了 z-index z-index是z轴显示的深度值越大离我们越近即值大会显示在值小的上面。所以我们将蒙版 z-index设置为8菜单按钮设置为10弹出菜单设置为9.这样也就看到文章开头图中的效果。动画实现通过上面的实现已经可以达到我们想要的效果但是显示和隐藏的时候比较突兀我们再给它加点动画动画的实现其实很简单在这里介绍两种实现动画的方式第一个是直接使用在样式文件wxss中实现另一种是通过微信小程序提供的动画Api实现。需要注意的是如果添加动画不能使用hidden属性显示隐藏弹出菜单而是使用visibility否则看不到动画效果。样式文件wxss实现方式:.hidden.state-menu {  transform: translateY(-200rpx);  transition: all 0.4s ease;  visibility: hidden;}.show.state-menu {  transform: translateY(0);  transition: all 0.4s ease;  visibility: visible;}&ltview wx:if=\"{{menuType==1}}\" class=\"state-menu {{isVisible?'show':'hidden'}}\">API createAnimation创建动画方式微信小程序提供了createAnimation创建动画包括平移旋转缩放倾斜等并且实现方式简单在这里就不在详细介绍API了具体可参看官方文档//定义变量var animation//在page中data中加入变量animationData: {}//onLoad初始化变量animation  var animation = wx.createAnimation({      duration: 500,      transformOrigin: \"50% 50%\",      timingFunction: 'ease',    })    this.animation = animation;// 执行动画函数  startAnimation: function (isShow, offset) {    var that = this    var offsetTem    if (offset == 0) {      offsetTem = offset    } else {      offsetTem = offset + 'rpx'    }   //translateY可以加入单位（如20+'rpx'或者20+'vh'不写单位时默认px）当0时不能加单位,否则动画无效果    this.animation.translateY(offset).step()    this.setData({      animationData: this.animation.export(),      isVisible: isShow    })  },然后只需要在view标签中加入animation=\"{{animationData}}\"就可以看到动画效果了。到这里已经实现了所以效果当然侧滑或者从下面弹出等都可以通过这个思想实现。文中js的一些逻辑代码没在文中贴出代码我已上传Github可以 前往查看                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)仟品小程序                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发之formId使用（模板消息）、跨页面获取数据示例 ...               微信小程序分页加载                                                        原作者: Code4Android                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • Java 微信公众号菜单关联小程序                                                      • 微信小程序--下拉菜单(带动画)实现                                                      • Demo分析学习《三》破车：音乐播放循环上首/下首菜单                                                      • 微信小程序---美团顶部搜索框&菜单                                                      • javascript/微信小程序中将String进行Base64编码并UTF-8格式输出                                                      • 微信小程序分页加载                                                      • 微信小程序实现多折叠展开酷炫菜单                                                                                               "},{"title": "微信小程序的this和that，触摸水波涟漪效果 ", "author": "                  天下雪                  2017-2-13 00:09                ", "text": "                                                                                                                                                                                     一：this和that分享者：别寒原文地址 微信小程序中在wx.request({});方法调用成功或者失败之后有时候会需要获取页面初始化数据data的情况这个时候如果使用this.data来获取会出现获取不到的情况调试页面也会报undefiend。原因是在javascript中this代表着当前对象会随着程序的执行过程中的上下文改变在wx.request({});方法的回调函数中对象已经发生改变所以已经不是wx.request({});方法对象了data属性也不存在了。官方的解决办法是复制一份当前的对象如下：var that=this;//把this对象复制到临时变量that 在success回调函数中使用that.data就能获取到数据了。不过还有另外一种方式也很特别是将success回调函数换一种声明方式如下：success: res =>{    this.setData({            loadingHidden: true,            hideCommitSuccessToast: false    })}在这种方式下this可以直接使用完全可以获取到data数据。再给一个完整的例子：      success: res => {        if (res.data.code != 0) {          // 提交失败          this.setData({            loadingHidden: true,            hiddenTips: false,            tipsContent: res.data.message          })        } else {          // 提交成功          this.setData({            loadingHidden: true,            hideCommitSuccessToast: false          })          subBtn = false;          // 定时3秒消失          setTimeout(() => {            this.setData({              hideCommitSuccessToast: true            })            wx.navigateBack({ delta: 2 });          }, 2000);        }      }二：触摸水波涟漪效果分享者：未知原文地址 效果html代码<view class=\"ripple\" style=\"{{rippleStyle}}\"></view><view class=\"container\" bindtouchstart=\"containerTap\"></view>css代码.container{    width:100%;    height:500px;}.ripple {    background-color: rgba(0, 0, 0, 0.8);    border-radius: 100%;    height:10px;    width:10px;    margin-top: -90px;    position: absolute;    -webkit-transform: scale(0);}@-webkit-keyframes ripple {    100% {    -webkit-transform: scale(12);    transform: scale(12);    background-color: transparent;    }}js代码containerTap:function(res){    console.log(res.touches[0]);    var x=res.touches[0].pageX;    var y=res.touches[0].pageY+85;    this.setData({      rippleStyle:''    });    this.setData({      rippleStyle:'top:'+y+'px;left:'+x+'px;-webkit-animation: ripple 0.4s linear;animation:ripple 0.4s linear;'    });  }                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                (2)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)wlimoliy42hz6786@vip.qq.clby2585982                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    新手常见问题集锦《五》               从微信小程序看待FlexBox布局                                                                           来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 滑动的顶部tab选项卡简易table表格swiper图片显示不完整                                                      • 微信小程序动态的显示或隐藏控件带参传递的界面跳转的两种方式 ...                                                      • 利用screenWidth与screenHeight手算布局,tomcat http 转 https加密解密算法的nodejs ...                                                      • 微信小程序实用小技巧设置头像数据存储与取值                                                      • 微信小程序radio不能改变大小？那我自己写一个吧                                                      • 文字超出限制在末尾加省略号showToast消息提示接口,在图片未能正确加载时 显示默认 ...                                                      • JS动态修改样式引用其他js里的方法获得用户输入内容                                                                                               "},{"title": "新手布局福音！微信小程序使用flex的一些基础样式属性 ", "author": "                  天下雪                  2016-12-4 17:01                ", "text": "                                                                                                                                                                                                                                                                 本文为本站原创如需转载分享请标注作者Nazi及原文链接；http://www.wxapp-union.com/forum.php?mod=viewthread&tid=1209Flex布局相对于以前我们经常所用到的布局方式要好的很多在做微信小程序的时候要既能符合微信小程序的文档开发要求又能使用不同以往的居中方式并减少css的相关样式声明。先来看看关于flex的一张图：    从上面可以看到一些flexbox的相关信息main axis 和 cross axis 指的是flexbox内部flex项目（flex item）的排列方向通俗点说就是里面的flex项目是按照横轴或者纵轴排列的顺序方向。main start 和 main end 是指项目的开始和项目的结束是按照排列方向的起点和终点。再来看看flex的相关属性：我们给定一个结构：<div class=\"container\"><div class=\"item1\"></div><div class=\"item2\"></div><div class=\"item3\"></div>...</div>在微信小程序里面可以是这样的结构：<view class=\"container\"><view class=\"item1\"></view><view class=\"item2\"></view><view class=\"item3\"></view>...</view>当我们要用时这个布局的时候对于外层的结构我们对他的css样式设定：<style type=\"text/css\">.container{display: flex; /*or inline-flex*/}</style>接下来我们就需要来规定这个item排列的方向了依旧对外层结构css设定：.container{display: flex; /*or inline-flex*/flex-direction: row;}flex-direction这个属性是用来规定flex项目在轴方向上面排列的顺序他有这样几个属性：flex-direction: row | row-reverse | column | column-reverse;row 如果规定的方向是 ltr（left to right）项目一次从左往右排列如果规定的方向是 rtl（right to left）项目一次从右往左排列row是默认值。row-reverse如果规定的方向是 ltr（left to right）项目一次从右往左排列如果规定的方向是 rtl（right to left）项目一次从左往右排列row 和 row-reverse 是相反的。column 跟row是类似的只不过是从上到下的方向排列的。column-reverse 跟row-reverse 是类似的只不过是从下到上的方向排列的。 对于有时候并不想让所有的项目都在一行排列的话（多行显示）我们添加flex-wrap：.container{display: flex; /*or inline-flex*/flex-direction: row;flex-wrap：wrap；}flex-wrap是决定项目是否多行显示的属性项目默认情况下是在一行下显示的。flex-wrap: nowrap | wrap | wrap-reverse;nowrap 指的是在一行显示不换行；wrap 指的是多行显示；wrap-reverse 指的是多行显示但是跟规定排列方向相反； flex-flow是 flex-direction 和 flex-wrap 的缩写flex-flow: <‘flex-direction’> || <‘flex-wrap’>上面css即：[CSS] 纯文本查看 复制代码.container{display: flex; /*or inline-flex*/flex-flow：row wrap；}在我们一些需要构建的布局里我们还需要去让他能够自由的伸缩这也是flex布局的优势之一能够极大的方便我们去提升效率。用于在主轴上对齐伸缩的项目属性：justify-content。他的属性有：justify-content: flex-start | flex-end | center | space-between | space-around;不同属性值下他的表现：css样式为：.container{width: 100%;height: 400px;background-color: #ccc;display: flex; /*or inline-flex*/flex-flow:row wrap;justify-content:flex-start;}.item{flex:0 0 30%;}.item1{background-color:#0074e0;}.item{background-color:#008c00;}.item3{background-color:#be0000;}flex-start flex-end center space-between space-around  flex-start(默认值),项目向起始位置靠齐第一个项目所在轴的起点位置对齐后面的项目与前一个项目的边外边对齐。flex-end项目向结束位置最后一个项目所在轴的终点位置对齐前面的项目与后一个项目的边外边对齐。center项目向一行的中间位置对齐可以说成是此行的居中对齐。在某些居中需求下的css样式布局既可以选择这个样式声明space-between,项目会平均的分布在一行里面。项目的第一项和最后一项会与轴的起点和终点边靠齐。其他的项目则平均分布早剩余的空间里面。space-around项目会平均分布在一行里。两端会保留一半的空间。 在多行存在的情况有一个和justify-content类似的属性只不过他是作用在相对于轴的垂直方向上的。属性值如下：align-content: flex-start | flex-end | center | space-between | space-around | stretch; 不同属性值下的表现：(横轴上规定的是 flex-start)css样式为：.container{width: 100%;height: 400px;background-color: #ccc;display: flex;/*or inline-flex*/flex-flow:row wrap;justify-content:flex-start;align-content: flex-start;}.item{flex:0 0 30%;min-height: 100px;}.item1,.item6{background-color:#0074e0;}.item2{background-color:#008c00;}.item5{background-color:#234567;}.item3,.item4{background-color:#be0000;}flex-start  flex-end  center space-between space-around  flex-start(默认值),项目向起始位置靠齐第一个项目所在轴的起点位置对齐后面的项目与前一个项目的边外边对齐。flex-end项目向结束位置最后一个项目所在轴的终点位置对齐前面的项目与后一个项目的边外边对齐。center项目向一行的中间位置对齐可以说成是此行的居中对齐。在某些居中需求下的css样式布局既可以选择这个样式声明space-between,项目会平均的分布在一行里面。项目的第一项和最后一项会与轴的起点和终点边靠齐。其他的项目则平均分布早剩余的空间里面。space-around项目会平均分布在一行里。两端会保留一半的空间。 虽然方式跟justify-content是一样的但是因为轴的不同起始点和终点是不同的所以显示的方式是一直的但是方向上的效果看起来会有点差异。 关于stretch 由于上面的项目设定了高度当项目的高度不是固定值得时候stretch的表现如下：  也就是说侧轴的长度是不是固定值得时候各行会扩大占据剩下的空间。 接下来 在介绍两个属性align-items 和 align-selfalign-items: flex-start | flex-end | center | baseline | stretch;align-self: auto | flex-start | flex-end | center | baseline | stretch; align-items是在所有项目上的对齐方式。align-self是在单独的项目上的对齐方式。不同属性值下的表现：(横轴上规定的是 flex-start)css样式为：.container{width: 100%;height: 400px;background-color: #ccc;display: flex;/*or inline-flex*/flex-flow:row wrap;justify-content:flex-start;align-items: flex-start;}.item{flex:0 0 30%;min-height: 100px;}align-items: flex-start align-self: flex-start   修改样式：（后面的修改下同）.container{width: 100%;height: 400px;background-color: #ccc;display: flex;/*or inline-flex*/flex-flow:row wrap;justify-content:flex-start;/*align-items: flex-start;*/}.item{flex:0 0 30%;min-height: 100px;max-height: 300px;}.item：nth-child（2）{max-height: 200px; align-self: flex-start;}align-items: flex-end align-self: flex-end align-items: center; align-self: center; align-items:baseline; align-self:baseline;(为了更好的能看出效果这里限制所有的项目最小高度为100px最大高度不定) align-items: stretch; / align-self: stretch;侧轴的长度属性为auto 这个值会使外边距盒子的尺寸按照min/max 的长度接近所在行的尺寸 另外：float clear vertical-align 在flex布局里里面是无效的。属性介绍到这里就来先看看这个布局的灵活性是如何体现的。当只有一个flex项目的时候结构如此下：<div class=\"container\"><div class=\"item1\"></div></div>在微信小程序里面可以是这样的结构：<view class=\"container\"><view class=\"item1\"></view></view>给他设定才css样式.container{width: 100%;height: 400px;background-color: #ccc;display: flex;flex-flow:row wrap;justify-content:flex-start;}.item1{background-color: #0074e0;width: 50px;height: 50px;}显示是这样的： 但是要让他完全居中的样子比如： css样式设定如下.container{width: 100%;height: 400px;background-color: #ccc;display: flex;flex-flow:row wrap;justify-content:center; /*样式修改在这里*/align-items: center; /*样式修改在这里*/}.item1{background-color: #0074e0;width: 100px;height:100px;}现在让他在右下角显示如下： CSS样式设置：.container{width: 100%;height: 400px;background-color: #ccc;display: flex;flex-flow:row wrap;justify-content:flex-end; /*样式修改在这里*/align-items:flex-end; /*样式修改在这里*/}.item1{background-color: #0074e0;width: 100px;height:100px;}在加上一个项目：（后面新增不再赘述）<div class=\"container\"><div class=\"item1\"></div><div class=\"item2\"></div></div>在微信小程序里面可以是这样的结构：<view class=\"container\"><view class=\"item1\"></view><view class=\"item2\"></view></view>左上横排.container{width: 100%;height: 400px;background-color: #ccc;display: flex;flex-flow:row wrap;justify-content:flex-start;align-items:flex-start;}水平方向居中.container{width: 100%;height: 400px;background-color: #ccc;display: flex;flex-flow:row wrap;justify-content:center;align-items:flex-start;}两个项目不贴在一起.container{width: 100%;height: 400px;background-color: #ccc;display: flex;flex-flow:row wrap;justify-content:space-around;align-items:flex-start;}从上面的列子看来仅仅只是就该某些css的属性就能达到以前需要花大量css样式的声明才能达到的效果。再看看下面这个.container{width: 400px;height: 400px;background-color: #ccc;display: flex;flex-flow:row wrap;justify-content:space-around;align-items:space-around;align-content: space-around;}仅仅只是添加下一条css样式然后增加项目个数修改下外框的宽高度就有这样的效果显示。 一些基本的flex布局的样式就说到这里了这只是一个很小的点其他的更多的是体现出这布局项目里面的伸缩的计算方式 排列方式如：order flex-grow flex-shrink flex-basis 等。更多的技巧则需要自己去深层次的探索。这里仅仅只是基础大神们无视就好。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)JesseChiu                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            layout使用教程：小程序UI设计（1）-轻松布局               Flexbox in CSS可视化文档（英文版）                                                        原作者: Nazi                   来自: 本站                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • Flexbox in CSS可视化文档（英文版）                                                      • 水牛01248：flex布局示例                                                      • 在微信小程序中学习flex布局                                                      • 微信小程序代码编辑工具中组件的默认样式设定                                                      • 从微信小程序看待FlexBox布局                                                      • 微信小程序 View：flex 布局                                                                                               "},{"title": "微信小程序控件学习：view的flex布局《下》 ", "author": "                  天下雪                  2016-11-8 19:51                ", "text": "                                                                                                                                                                                     分享者：mayChunJ ；本文写于公测之前如有出入请以官方文档为准；上一章即微信小程序之view的flex布局(1)里我们学习了flex容器的属性总结一下它里面包括(1)flex-direction 设置容器内子元素即flex-item的排列方向。(2)flex-warp 设置容器内子元素是否换行。(3)justify-content 设置子元素在横轴即X轴的排列位置(4)align-items 设置子元素在Y轴的排列位置(5)align-content 设置子元素在多个主轴线上排列的位置。下面我们来讲讲 flex-item的属性在flex容器中每个子元素就是一个flex-item.第一个属性 orderorder:<index>   order属性定义项目的排列顺序。数值越小排列越靠前默认为0。wxss文件如果item没有设置order则order默认为0如图我设置了view2,3,4的位置为3,2,1 看效果图：order效果图第二个属性 flex-growflex-grow属性定义项目的放大比例默认为0即如果存在剩余空间也不放大。如果所有项目的flex-grow属性都为1则它们将等分剩余空间（如果有的话）。如果一个项目的flex-grow属性为2其他项目都为1则前者占据的剩余空间将比其他项多一倍。效果看图：wxss文件效果图因为设置了view34设置了left-align属性 所以没有均分大家可以去掉尝试一下。第三个属性flex-shrink属性flex-shrink属性定义了项目的缩小比例默认为1即如果空间不足该项目将缩小。如果所有项目的flex-shrink属性都为1当空间不足时都将等比例缩小。如果一个项目的flex-shrink属性为0其他项目都为1则空间不足时前者不缩小。直接上图  效果图第四个属性flex-basis属性flex-basis属性定义了在分配多余空间之前项目占据的主轴空间（main size）。浏览器根据这个属性计算主轴是否有多余空间。它的默认值为auto即项目的本来大小。第五个属性align-self属性属性align-self属性允许单个项目有与其他项目不一样的对齐方式可覆盖align-items属性。默认值为auto表示继承父元素的align-items属性如果没有父元素则等同于stretch。align-self效果图该属性可能取6个值除了auto其他都与align-items属性完全一致。资料地址   demo下载：WXDemo-master.zip                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)yuanhkp                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序控件学习：view的flex布局《上》               微信小程序学习点滴《十一》：选择器 时间选择器 日期选择器 地区选择器 ... ...                                                        原作者: mayChunJ                    来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序控件学习：view的flex布局《上》                                                      • 水牛01248：flex布局示例                                                      • 在微信小程序中学习flex布局                                                      • 从微信小程序看待FlexBox布局                                                      • 微信小程序 View：flex 布局                                                      • 微信小程序控件 圆形图片                                                                                               "},{"title": "猫眼小程序如何发展起来，并留存用户？ ", "author": "                  Rolan                  2018-7-12 00:02                ", "text": "                                                                                                                                                                                     2018年6月份小程序榜单中“猫眼电影演出”排名第14位这款小程序在2017年11月底上线半年内用户破亿。在内部猫眼有一个部门研究微信生态、小程序总结头部团队、头部产品的成功方法论通过大量的ABtest尝试不同运营策略当然这些策略打法也将在暑期电影热门档期陆续推出。 其实看电影这件事本身就带着天然的强社交属性购买电影票的用户90%上下都购买两张或两张以上。再看小程序的土壤生于微信、长于微信当然现在猫眼已经走出微信并走到线下但小程序的应用场景最终还是落回到围绕强关系链、去中心化的微信生态系统。因此都是立足于强关系链的猫眼娱乐和微信小程序的结合就变得自然且关键值得投入更多资源去探索。众所周知小程序的容量只有几兆能够承载的内容服务是相对比较有限的。这种情况下如何去做小程序呢？一、小功能优于大系统这是产品团队内部针对小程序的定位提炼的第一句话。大家可以打开“猫眼”APP首页有电影票、演出票、赛事等购票入口有娱乐八卦内容还有电视剧、综艺等专业的内容评分版块。我们很清楚企业在发展的过程中从单一业务开始当夯实单一业务后一定会往行业、产业的横向或纵深发展不可能长期仅依赖单一业务支撑势必会做全产业链布局因此App上看起来有大量围绕猫眼娱乐定位的其它综合业务。但大家打开微信钱包点击那只「猫头」：小程序“猫眼电影演出”你们会发现功能极简首页只显示和电影购票有关的信息用户进来很明确就是“购票”。有人可能会用拼多多来反驳：你看他们App和小程序长一样。但对比京东、淘宝等综合型电商平台会发现拼多多提供的是一个极简的电商路径首页除了“banner”和“功能入口”的裂变功能就只有商品的标准化陈列没有复杂的电商楼层运营没有rich化的视频／直播等运营手段更没有社区／购物模块有的只是清晰的商品sku列表用户进来要做什么很清晰。所以拼多多原本提供给用户的就是一个极简的拼团体验从前端看已经做到了“功能式的极简”所以大家就能理解为什么拼多多的小程序和APP长得差不多。在小程序设计上一定要记住不要去做大而全一定要做小而美用户认知清晰、路径极简。在内部团队是这样思考的：小程序必须能用一个词来概括它。而且不是一个特别泛的词一定是切一个点当你切的点足够小时用户留存就会非常高。比如不建议用移动App时代的“出行必备神器-机酒车团旅行攻略”来定位小程序但你可以拆成“酒店预订”、“机票／火车票”、“租车”等分场景的小而美的独立小程序.如猫眼电影演出就是来“买票”的所有内容资讯、电视剧、书籍评分等统统不提供当然未来会有其它小程序载体实现。这就是我们说的“功能大于系统”也就是关于小程序定位的思考。二、小舰队优于大航母这句话是团队在思考“产业布局”下的复杂业务协同时提炼出来的“矩阵”模式——小舰队优于大航母团队也在考虑可能会做小程序矩阵。前段时间内部有一个讨论：微信生态像什么？结论是特别像以前PC时代的浏览器小程序是浏览器里的每一个网页。当你希望多元化服务更多呈现在小程序、微信生态里就要思考可能需要做多个小程序而不是单一的小程序去包罗万象。这就是小舰队优于大航母的逻辑。明白了这一点在小程序上的布局我们就会比较清晰地知道该何去何从如何做相对正确的决策。三、拉力优于推力这是针对运营的提炼。这句话出自《爆裂》在小程序运营中我们体会非常深刻。回想一下 App获得一个新用户成本可能要几块甚至十几块钱很多大企业首单获客成本甚至几百块钱但小程序如果运营得当获客成本很低至少这个阶段还是有非常大的价值洼地。怎么理解“拉力优于推力”呢？思考一下不管是PC时代还是移动APP时代我们研究最多的用户模型是什么？就是漏斗模型。企业花很多钱和资源获取大量的流量再把流量拉回到自己的平台上然后一层一层做漏斗模型不断地从底部开始优化漏斗从而留住更多用户。但微信生态的世界不是这样的。每一个进来的用户都是我们需要重视的关键人物他们既是流量也是流量拉力；由于微信生态的系统性完善让用户行为模型由传统的漏斗模型的“推力”模式升级为“开发者和用户双赢”的反漏斗模型的“拉力”模式。拉力让用户获取成本极低举个例子猫眼小程序在今年4､5月份我们分别上线了砍价、集卡用来做“拉力”模型的测试当然中间被黄牛刷过票现在风控都已经很完善了目前能做到一个新设备用户的成本不足1毛钱1个新客下单用户的成本在5元左右。当然我们还在花精力在研究留存策略我们同样笃定留存策略也会在传统的留存之上可以有更适应微信生态的留存策略。这些用户行为模型、成本结构在PC互联网、APP时代是很难想象的。再举个例子前段时间玩一个小游戏把同学“抛”上天空看谁抛的高起初是一个人先玩然后把游戏分享到群里接下来大家在群里一起玩看排名从只能抛几百米练习到几千米、最后成功晋级到万米俱乐部朋友们在群里一起PK一起讨论。这只是一个小游戏因为一个人的喜欢带动了一群人的被动发现和主动参与。猫眼曾对用户购票行为做过调研发现很多人买电影票不是为自己买而是帮父母买买完后把购票信息分享给父母；同事好友周末相约看电影也是由一个人购票完后在群里分享大家AA付款。有很多类似这样的场景我们正在努力让这些场景逐步的小程序化微信生态是一个集聊天和应用为一体的土壤能够帮助产品很好地做主动传播和裂变。但这种裂变不是诱导分享其实我个人认为诱导分享价值不大让用户做一个分享再拿到一个特权可以多玩几次这种策略是短视的唯有符合用户实际需求的价值趋动下的传播才是更长线的。这种有价值的分享裂变就是刚提及的反漏斗模型也就是拉力。价值是“勾子”我们要为每一个参与者来创造这种“勾子”让用户主动去传播它从而带动更多人参与。所以我认为拉力优于推力。最后再说说人小程序和以往社交场景有很大不一样过去最具代表性的就是Facebook一个也是需要双向好友关系的去中心化社交场景。但不一样的是微信好友上限只有5000人每个群上限也只有500人；Facebook没有这个限制可以无限加好友好友越多商业价值越大。所以在Facebook的信息连接也是围绕人但对开发者来说做社群裂变、社群营销核心要思考的是如何以“有影响力的人+大圈子”为核心构建所有的产品。可是微信生态的核心场景就是服务于普通人所有的底层能力建设最终也都是服务于普通用户。那么我们如何以“普通人+小圈子”为核心构建产品；这个产品可能更私密（比如给父母买个票、AA好友购票）、可能更生活（油盐酱醋）可能更接地气（拼团图个便宜、砍价占点小便宜）。四、在小程序的世界里“普通人优于权威者、小群组优于大粉丝”猫眼在做整个产品设计时都会围绕小群组、围绕普通人、围绕拉力、围绕“小舰队”、围绕小功能围绕这些关键词来思考和设计整个微信生态下的小程序布局。这是以用户为核心的扩散层级示意图引自《小群效应》问：您刚讲到积累大KOL没有小群好但私密小群数量非常多管理成本极高如果是一个公众号可能十个人就搞定了如果一万个微信群怎么样高效率运营和管理？张博：究竟你是要靠“推力”让用户参与你的运营还是因为产品本身具备强“拉力”有更强的社交价值所以用户会主动传播？在“拉力”作用下社群传播是自然发酵的而不是我们强推用户去做的这是一个根本性的问题。比如用户购买了一张票后会获得10个红包可以分享给10个好友当好友买电影票时就会少10块钱这些都是基于用户社交价值而去自发传播的。所以从内而外我们的运营策略是“拉力优于推力”而不是要经营许多的群组去做“推力”。至于非要说如何管理群组这是另一个话题是社群范畴的模式探讨。问：猫眼在微信钱包里有一个入口得天独厚的优势普通创业者是没有的。如果没有这个入口猫眼小程序会怎么推广？张博：猫眼的确有得天独厚的资源在微信钱包有一个入口。上线时几乎绝大部分流量都来自于这个入口后来阶段性地做到了近一半流量来自于对话框和任务栏。这是因为我们做了一些裂变运营的功能测试让整个流量结构发生了变化当然还只是在不同策略的测试阶段并没有大规模放开暑期档会陆续放开这些有用户价值的运营举措。或者我们来讲讲「拼多多」只讲流量部分「拼多多」不是因为有了入口才有的流量。拼多多一是把微信生态的规则研究的非常透彻围绕规则不断快速推出有社交价值的裂变策略同时拼多多小程序和App本身的产品设计又是极简。二是把所有功能都结合社交属性连“签到”这么一个朴素、传统、甚至标准化的功能都可以和社交裂变结合起来签到、签到后分享、签到后群签透过如此一个小点去看拼多多的社交打法可见一斑。拼多多的产品经理把“社交属性”像血液一般流淌于每一个功能点、每一个用户可能触达到的场景上这或者正是拼多多的流量推广之道。 作者：张博猫眼副总裁来源：微信公众号“见实（ID：jianshishijie）”本文由 @见实 授权发布于人人都是产品经理。未经许可禁止转载题图来自 Pexels 基于 CC0 协议                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小游戏大能量数据见证100天：2000＋款游戏100＋项能力千万级日流水111 ...               小程序广告组件全量开放                                                        原作者: 张博                   来自: 微信公众号“见实（ID：jianshishijie）                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 轻应用开发的\"下半场\"会是一场鸡肋反击战吗？                                                      • 浅谈：如何策划小程序拼团活动？                                                      • 小程序浅析                                                      • 微信小程序腾讯视频插件的使用                                                      • 微信小程序 canvas 绘图问题总结                                                      • 小程序“三国杀”：百度向左微信、支付宝向右                                                                                               "},{"title": "动手搭建第一个小程序音视频Demo ", "author": "                  Rolan                  2018-1-5 00:19                ", "text": "                                                                                                                                                                                     腾讯云提供了全套技术文档和源码来帮助您快速构建一个音视频小程序但是再好的源码和文档也有学习成本为了尽快的能调试起来我们还提供了一个免费的一键部署服务：您只需轻点几下鼠标就可以在自己的账号下获得一个音视频小程序同时附送一台拥有独立域名的测试服务器让您可以在 5 分钟内快速构建出自己的测试环境。通过微信公众平台授权登录腾讯云打开 微信公众平台 注册并登录小程序按如下步骤操作：单击左侧菜单栏中的【设置】。单击右侧 Tab 栏中的【开发者工具】。单击【腾讯云】进入腾讯云工具页面单击【开通】。使用小程序绑定的微信扫码即可将小程序授权给腾讯云开通之后会自动进去腾讯云微信小程序控制台显示开发环境已开通此时可以进行后续操作。注意：此时通过小程序开发者工具查看腾讯云状态并不会显示已开通已开通状态会在第一次部署开发环境之后才会同步到微信开发者工具上。进入微信公众平台后台开通腾讯云腾讯云微信小程序控制台免费开通腾讯云服务1 开通直播服务1.1 申请开通视频直播服务进入 直播管理控制台如果服务还没有开通则会有如下提示:点击申请开通之后会进入腾讯云人工审核阶段审核通过后即可开通。1.2 配置直播码直播服务开通后进入【直播控制台】>【直播码接入】>【接入配置】(https://console.cloud.tencent.com/live/livecodemanage) 完成相关配置即可开启直播码服务：点击【确定接入】按钮即可。1.3 获取直播服务配置信息从直播控制台获取bizid、pushSecretKey后面配置服务器会用到：2. 开通云通信服务2.1 申请开通云通讯服务进入云通讯管理控制台如果还没有服务直接点击直接开通云通讯按钮即可。新认证的腾讯云账号云通讯的应用列表是空的如下图：点击创建应用接入按钮创建一个新的应用接入即您要接入腾讯云IM通讯服务的App的名字我们的测试应用名称叫做“RTMPRoom演示”如下图所示：点击确定按钮之后就可以在应用列表中看到刚刚添加的项目了如下图所示：2.2 配置独立模式上图的列表中右侧有一个应用配置按钮点击这里进入下一步的配置工作如下图所示。2.3 获取云通讯服务配置信息从直播控制台获取SdkAppid、accountType、privateKey、administrator后面配置服务器会用到：从验证方式中下载公私钥解压出来将private_key用文本编辑器打开如：-----BEGIN PRIVATE KEY-----MIGHAgEAsUj5ep7r9TVxTrZiSpXQKhRANCAASuxr7AJGiXRqGpiO7pPrLAchyORcY5uWCqVm+QFTn0H+ZcHP93ss3OhgZKh8pq+g7X26dW5fQkiSH1PXG/FYzbTbMHaWCqVm+QFTn0H+QKhRANCAASuxr7AJGiXRqGpiO7pPr7jTFTmg-----END PRIVATE KEY-----将其转换成字符串形式如下所示后面在server配置文件中使用：\"-----BEGIN PRIVATE KEY-----\\r\\n\"+\"MIGHAgEAsUj5ep7r9TVxTrZiSpXQKhRANCAASuxr7AJGiXRqGpiO7pPrLAchyORc\\r\\n\"+\"Y5uWCqVm+QFTn0H+ZcHP93ss3OhgZKh8pq+g7X26dW5fQkiSH1PXG/FY\\r\\n\"+\"zbTbMHaWCqVm+QFTn0H+QKhRANCAASuxr7AJGiXRqGpiO7pPr7jTFTmg\\r\\n\"+\"-----END PRIVATE KEY-----\\r\\n\"三、安装微信小程序开发工具下载并安装最新版本的微信开发者工具使用小程序绑定的微信号扫码登录开发者工具。微信开发者工具四、下载 Demo访问 SDK+Demo获取小程序 Demo 和后台源码。五、上传和部署代码打开第三步安装的微信开发者工具点击【小程序项目】按钮。输入小程序 AppID项目目录选择上一步下载下来的代码目录点击确定创建小程序项目。再次点击【确定】进入开发者工具。注意： 目录请选择 RTMPRoom 根目录。包含有 project.config.json请不要只选择 wxlite 目录！上传代码  开发者工具打开 Demo 代码中 server 目录下的 config.js 文件将其中的 bizid、pushSecretKey、APIKey、sdkAppID、accountType、administrator、privateKey配置成上述直播服务及云通信服务里生成的值并保存。修改 MySQL 密码点击界面右上角的【腾讯云】图标在下拉的菜单栏中选择【上传测试代码】。  上传按钮选择【模块上传】并勾选全部选项然后勾选【部署后自动安装依赖】点击【确定】开始上传代码。选择模块上传成功上传代码完成之后点击右上角的【详情】按钮接着选择【腾讯云状态】即可看到腾讯云自动分配给你的开发环境域名：  查看开发域名完整复制（包括 https://）开发环境 request 域名然后在编辑器中打开 wxlite/config.js 文件将复制的域名填入 url 中并保存保存之后编辑器会自动编译小程序左边的模拟器窗口即可实时显示出客户端的 Demo：修改客户端配置在模拟器中编译运行点击多人音视频进入在右侧的console里面可以看到登录成功的log表示配置成功。   登录测试常见问题 FAQ1. 运行小程序进入多人音视频看不到画面?请确认使用手机来运行微信开发者工具内部的模拟器目前还不支持直接运行请确认小程序基础库版本 wx.getSystemInfo 可以查询到该信息1.7.0 以上的基础库才支持音视频能力。请确认小程序所属的类目由于监管要求并非所有类目的小程序都开发了音视频能力已支持的类目请参考 DOC。如有更多需求或希望深度合作可以提工单或客服电话（400-9100-100）联系我们。原创声明本文系作者授权云+社区-专栏发表未经许可不得转载。如有侵权请联系 zhuanlan_guanli@qq.com 删除。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序—跳一跳Android游戏助手(外挂)使用教程               微信小程序--TabBar不出现                                                        原作者: 小程序音视频产品经理                   来自: 腾讯云                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序腾讯视频插件的使用                                                                                               "},{"title": "小程序打包插件开发体验 ", "author": "                  Rolan                  2018-8-6 00:06                ", "text": "                                                                                                                                                                                     相信开发过插件的同学都看过Writing a Plugin 或类似的文章因为 mini-program-webpack-loader 这个工具开发时正好 webpack 4 发布了所以就阅读了这篇文章顺便看了以下几篇文档。Writing a PluginPlugin PatternsPlugin APILoader API如果你看过文档相信你一定知道：每个插件必须要有 apply 方法用于 webpack 引擎执行你想要执行的代码。两个重要的对象 Compiler 和 Compilation你可以在上面绑定事件钩子（webpack 执行到该步骤的时候调用）具体有哪些事件钩子可以阅读Compiler hooks。module 和 chunk 的关系我们可以理解为每个文件都会有一个 module而一个 chunk 则是由多个 module 来组成。webpack 整个打包流程有那些事件如何写一个简单的 loader如果感觉无从着手可以继续看看我是如何一步步开发并完善 mini-program-webpack-loader 来打包小程序的。小程序有一个固定的套路首先需要有一个 app.json 文件来定义所有的页面路径然后每个页面有四个文件组成：.js.json.wxml.wxss。所以我以 app.json 作为 webpack entry当 webpack 执行插件的 apply 的时候通过获取 entry 来知道小程序都有哪些页面。大概流程像下面一张图一个小程序打包插件差不多就这样完成了。这里使用了两个插件 MultiEntryPluginSingleEntryPlugin。为什么要这样做呢？因为 webpack 会根据你的 entry 配置（这里的 entry 不只是 webpack 配置里的 entryimport(), require.ensure() 都会生成一个 entry）来决定生成文件的个数我们不希望把所有页面的 js 打包到一个文件需要使用 SingleEntryPlugin 来生成一个新的 entry module；而那些静态资源我们可以使用 MultiEntryPlugin 插件来处理把这些文件作为一个 entry module 的依赖在 loader 中配置 file-loader 即可把静态文件输出。伪代码如下：const MultiEntryPlugin = require('webpack/lib/MultiEntryPlugin'); const SingleEntryPlugin = require('webpack/lib/SingleEntryPlugin');  class MiniPlugin {    apply (compiler) {        let options = compiler.options        let context = compiler.rootContext        let entry = options.entry        let files = loadFiles(entry)        let scripts = files.filter(file => /\\.js$/.test(file))        let assets = files.filter(file => !/\\.js$/.test(file))               new  MultiEntryPlugin(context, assets, '__assets__').apply(compiler)                scripts.forEach((file => {            let fileName = relative(context, file).replace(extname(file), '');            new SingleEntryPlugin(context, file, fileName).apply(compiler);        })    } }复制代码当然如果像上面那样做你会发现最后会多出一个 main.jsxxx.js（使用 MultiEntryPlugin 时填的名字）main.js 对应的是配置的 entry 生成的文件xxx.js 则是 MultiEntryPlugin 生成的。这些文件不是我们需要的所以需要去掉他。如果熟悉 webpack 文档我们有很多地方可以修改最终打包出来的文件如 compiler 的 emit 事件compilation 的 optimizeChunks 相关的事件都可以实现。其本质上就是去修改 compilation.assets 对象。在 mini-program-webpack-loader 中就使用了 emit 事件来处理这种不需要输出的内容。大概流程就像下面这样：小程序打包当然没这么简单还得支持wxml、wxss、wxs和自定义组件的引用所以这个时候就需要一个 loader 来完成了loader 需要做的事情也非常简单 —— 解析依赖的文件如 .wxml 需要解析 import 组件的 srcwxs 的 src.wxss 需要解析 @importwxs 的 require最后在 loader 中使用 loadModule 方法添加即可。自定义组件一开始在 add entry 步骤的时候直接获取了所以不需要 loader 来完成。这个时候的图：这样做也没什么问题可是开发体验是比较差的如再添加一个自定义组件一个页面webpack 是无感知的所以需要在页面中的 .json 发生改变时检查是不是新增了自定义组件或者新增了页面。这个时候遇到一个问题自定义组件的 js 是不能通过 addModule 的方式来添加的因为自定义组件的 js 必须作为独立的入口文件。在 loader 中是做不了所以尝试把文件传到 plugin 中（因为 plugin 先于 loader 执行所以是可以建立 loader 和 plugin 通信的）。简单粗暴的方式：// loader.jsclass MiniLoader {}module.exports = function (content) {    new MiniLoader(this, content)}module.exports.$applyPluginInstance = function (plugin) {  MiniLoader.prototype.$plugin = plugin}// plugin.jsconst loader = require('./loader')class MiniPlugin {    apply (compiler) {        loader.$applyPluginInstance(this);    }}复制代码但是...。文件是传到 plugin 了可是再使用 SingleEntryPlugin 时你会发现没效果。因为在 compiler make 之后 webpack 已经不能感知新的 module 添加了所以是没有用的这个时候就需要根据文档猜怎么样才能让 webpack 感知到新的 module根据文档中的事件做关键字查询可以发现在编译完成的时候会调用 compilation needAdditionalPass 事件钩子：this.emitAssets(compilation, err => {    \tif (err) return finalCallback(err);        \tif (compilation.hooks.needAdditionalPass.call()) {    \t\tcompilation.needAdditionalPass = true;        \t\tconst stats = new Stats(compilation);    \t\tstats.startTime = startTime;    \t\tstats.endTime = Date.now();    \t\tthis.hooks.done.callAsync(stats, err => {    \t\t\tif (err) return finalCallback(err);        \t\t\tthis.hooks.additionalPass.callAsync(err => {    \t\t\t\tif (err) return finalCallback(err);    \t\t\t\tthis.compile(onCompiled);    \t\t\t});    \t\t});    \t\treturn;    \t}        \tthis.emitRecords(err => {    \t\tif (err) return finalCallback(err);        \t\tconst stats = new Stats(compilation);    \t\tstats.startTime = startTime;    \t\tstats.endTime = Date.now();    \t\tthis.hooks.done.callAsync(stats, err => {    \t\t\tif (err) return finalCallback(err);    \t\t\treturn finalCallback(null, stats);    \t\t});    \t});    });复制代码如果在这个事件钩子返回一个 true 值则可以使 webpack 调用 compiler additionalPass 事件钩子尝试在这里添加文件果然是可以的。这个时候的图就成了这样：当然小程序打包还有些不同的地方比如分包如何用好 splitchunk就不在啰嗦了当你开始以后你会发现有很多的方法来实现想要的效果。插件开发到这里差不多了总的来说webpack 就是变着花样的回调当你知道每个回调该做什么的时候webpack 用起来就轻松了。明显我不知道因为在开发过程中遇到了一些问题。遇到的问题1.如何在小程序代码中支持 resolve aliasnode_modules？既然是工具当然需要做更多的事情有赞的小程序那么复杂如果支持 resolve aliasnode_modules 可以使得项目更方便维护或许你会说这不是 webpack 最基本的功能吗不是的我们当然是希望可以在任何文件中使用 aliasnode_modules 支持的不仅仅是 js。当然这样做就意味着事情将变得复杂首先就是获取文件路径必须是异步的因为在 webpack 4 中 resolve 不再支持 sync。其次就是小程序的目录名不能是 node_modules这时就需要一种计算相对路径的规则还是相对打包输出的而不是相对当前项目目录。2.多个小程序项目的合并有赞从小程序来讲有微商城版有零售版以及公共版其中大多基础功能业务都是相同的当然不能再每个小程序在开发一次所以这个工具具备合并多个小程序当然是必须的。这样的合并稍微又要比从 node_modules 中取文件复杂一些因为需要保证多个小程序合并后的页面是正确的而且要保证路径不变。这两个问题的最终的解决方案既是以 webpack rootContext 的 src 目录为基准目录以该目录所在路径计算打包文件的绝对路径然后根据入口文件的 app.json 所在目录的路径计算出最终输出路径。exports.getDistPath = (compilerContext, entryContexts) => {  /**   * webpack 以 config 所在目录的 src 为打包入口   * 所以可以根据该目录追溯源文件地址   */  return (path) => {    let fullPath = compilerContext    let npmReg = /node_modules/g    let pDirReg = /^[_|\\.\\.]\\//g    if (isAbsolute(path)) {      fullPath = path    } else {      // 相对路径：webpack 最后生成的路径打包入口外的文件都以 '_' 表示上级目录      while (pDirReg.test(path)) {        path = path.substr(pDirReg.lastIndex)        fullPath = join(fullPath, '../')      }      if (fullPath !== compilerContext) {        fullPath = join(fullPath, path)      }    }    // 根据 entry 中定义的 json 文件目录获取打包后所在目录如果不能获取就返回原路径    let contextReg = new RegExp(entryContexts.join('|'), 'g')    if (fullPath !== compilerContext && contextReg.exec(fullPath)) {      path = fullPath.substr(contextReg.lastIndex + 1)      console.assert(!npmReg.test(path), `文件${path}路径错误：不应该还包含 node_modules`)    }    /**     * 如果有 node_modules 字符串则去模块名称     * 如果 app.json 在 node_modules 中那 path 不应该包含 node_modules      */    if (npmReg.test(path)) {      path = path.substr(npmReg.lastIndex + 1)    }    return path  }}复制代码3.如何把子包单独依赖的内容打包到子包内解决这个问题的方法是通过 optimizeChunks 事件在每个 chunk 的依赖的 module 中添加这个 chunk 的入口文件然后在 splitChunk 的 test 配置中检查 module 被依赖的数量。如果只有一个并且是被子包依赖则打包到子包内。4.webpack 支持单文件失败这是一个未解决的问题当尝试使用 webpack 来支持单文件的时候好像没那么方便：单文件拆分为四个文件后可以使用 emitFile 和 addDependency 来创建文件但是创建的文件不会执行 loader使用 loadModule 会因为文件系统不存在该文件会报错                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序—九宫格心形拼图效果               支付宝小程序日期选择组件 datePicker 封装                                                        原作者: 刘某                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 技术课 | 开发小程序插件遇到问题？微信开发哥来教你！                                                      • Android\"挂逼\"修练之行--微信小程序逆向辅助插件工具开发详解 ...                                                      • 看大神如何玩转微信小程序日历插件？                                                      • ［插件使用］wepy 微信小程序使用 腾讯视频插件                                                      • 微信小程序腾讯视频插件的使用                                                                                               "},{"title": "微信小程序商品详情页交互源码（选择商品类型切换、预览商品图片） ... ", "author": "                  Rolan                  2017-8-19 00:47                ", "text": "                                                                                                                                                                                     maker一下自己捣鼓的商品详情页主要是选择商品类型的交互和样式点击不同类型切换图片和文字商品增加减少还有商品预览图片（本地图片无法预览！！！）。。源码下载：http://download.csdn.net/download/dknightl/99398721.效果图2.wxml<view class=\"swiper_area\">  <swiper indicator-dots=\"{{indicatorDots}}\" indicator-color=\"#fff\"    autoplay=\"{{autoplay}}\" interval=\"{{interval}}\" duration=\"{{duration}}\">    <block wx:for=\"{{imgUrls}}\">      <swiper-item data-img=\"{{item.flower_image}}\" bindtap=\"seeSwiperAll\">        <image data-id=\"{{item.flower_id}}\" src=\"{{item.flower_image}}\" class=\"slide-image\" />      </swiper-item>    </block>  </swiper></view><view class=\"goods_infor_top\">  <view class=\"goods_title\">{{good.good_name}}  </view>  <view class=\"good_description\">    <text class=\"description_content\">{{good.good_mark}}</text>  </view>  <view class=\"good_info_bottom display-flex-row\" style=\"\">    <view class=\"good_price\">      <text class=\"color_ff6700 good_dis_price pdr10rpx display-ib\">¥{{goodPrice}}/{{good.good_unit}}</text>       <block wx:if=\"{{good.good_column=='100903'}}\">        <text class=\"good_orin_price td-lt display-ib\">          ¥{{goodOrinPrice}}        </text>       </block>      </view>    <view class=\"sale\">      <text class=\"good_sale_count display-ib\" style=\"\">销量:{{good.good_sell}}</text>       </view>          </view></view><view bindtap=\"viewFlowerArea\" class=\"choose_catalog_area bg_fff display-flex-row\">  <view class=\"fl\">选择花色:    {{flowerNameSelect}}  </view>  <image class=\"arrow_right fr\" src=\"../../image/icon-arrow.png\"/></view><view  class=\"commodity_screen\" bindtap=\"hideModal\" wx:if=\"{{showModalStatus}}\"></view><view  animation=\"{{animationData}}\"    class=\"catalog_area bg_fff {{isHidden == 1 ? 'display-block':'display-none'}}\">  <view class=\"catalog_title\">      <image class=\"thumbnails\" src=\"{{flowerImgSelect}}\" mode=\"aspectFill\"></image>      <view class=\"info_tip\">        <view class=\"good_dis_price\">¥{{goodPrice}}</view>          <view class=\"choosed_catalog text-hidden\">{{flowerNameSelect}}</view>      </view>       <image class=\"cancel\" bindtap=\"hideModal\" src=\"../../image/delete.png\"></image>         </view>  <scroll-view                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    实战案例-- 用Java编写基础小程序               Charlotte微信小程序开发（一）--数据存储                                                        原作者: dKnightL                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 用Baas在腾讯云上开发小程序-系列4：实现客户侧商品列表、商品详情页程序 ...                                                      • 微信分享图片压缩问题解决方案                                                      • Yii2小程序组件                                                      • 微信小程序--引用公共js里的方法                                                      • 微信小程序---保留小数(toFixed) 四舍五入 获取整数 string转int                                                      • 微信小程序--后台数据管理实现商品数据的动态展示、维护                                                      • 喂快给我打一个小程序预览码                                                                                               "},{"title": "腾讯云独家详解小程序多人视频通话 ", "author": "                  Rolan                  2018-1-5 00:30                ", "text": "                                                                                                                                                                                     功能体验在微信小程序中搜索 腾讯视频云 可以加载到我们的演示用小程序其中 多人音视频 功能可用于体验和测试多人音视频通话功能。出于 UI 美观和画面大小的考虑Demo 中仅支持了最多四人的视频通话您可以通过修改源码中的限制参数来调整这个数值。技术指标通讯延迟：300ms - 800ms底层协议：基于 UDP 协议构建并遵循 RTMP 标准对音视频数据进行切分和封装支持丢包恢复和网络自适应。安全加密：每次连接都独立启用一对全新的非对称加密密钥整个通讯过程无法监听和篡改。支持录制：如果需要可以在云端进行录制适用于在线客服、金融开户等商用音视频解决方案支持私有化部署。双人vs多人双人音视频仅仅是两个端之间交换 URL 这么简单但是从双人通话到多人通话问题的复杂性就迅速增加了。如下是一种解决问题的思路即每个端都要维护好各端的状态信息：这种方案的对于终端开发不是很友好代码会很复杂也不易阅读更重要的是它极易引入各端信息不一致的 BUG。所以我们可以考虑让 Server 来协助解决这个问题：我们可以将房间中的成员都交给 Server 来管理由于 Server 的信息是集中的因此不会出现信息不一致性的 BUG只要各个终端在需要的时候从 Server 同步最新的成员列表到本地（GET LIST）即可同时新成员的加入或者退出亦可由 Server 完成通知。为了帮您更好的实现基于 Server 的解决方案我们推荐您使用 RTCRoom 解决方案：<h2 id=\"RTCROOM\">RTCROOM </h2>RTCRoom（RealTime ChatRoom）存在的意义在于封装双人或者多人音视频实现过程中需要考虑的各种细节逻辑问题比如房间管理、状态同步消息收发等等让您只需要面对几个非常简单的接口从而快速构建自己的音视频能力。原理解读ClientRTCRoom 的 Client 部分（小程序上的 RTCRoom 是一个叫做 rtcroom.js 的 javascript 文件） 提供了一组 API 接口：CreateRoom 创建一个双人（或多人）视频通话房间调用这个接口的人即为创建者。EnterRoom进入一个已经创建好的视频通话房间调用这个接口的人即为参与者。ExitRoom 退出一个视频通话房间在我们的默认实现中如果是创建者退出房间将被解散您可以根据自己的需要进行调整。SendTxtMsg发送文本消息用于作为视频交流的辅助手段通常是用来发送一些不重要的系统通知。事件通知 事件通知比如新的与会者加入或者有人离开等等。小程序的限制由于小程序是严格遵循数据驱动的设计理念所以不支持动态创建 <live-pusher> 和 <live-player> 对象, 因此我们还无法做到让您无需关心这两个标签而直接使用 RTCRoom因此小程序端的 Demo 代码要比 iOS、Android 以及 Win 平台要复杂一点点。Server列表管理 RTCRoom 的 Server 部分是一组用于 房间列表管理 和 成员列表管理 的简单代码实现。以视频会议为例一个公司同时可能会有多个进行中的视频会议那么每一个会议都是一个房间每一个房间里又有多个与会者。所以对于房间的管理和对于房间中成员的管理就是 Server 部分的工作。事件通知同时Server 还有一个重要职责就是当房间解散以及成员进出时通过 IM 消息通道通知房间里的各个成员。由于腾讯云已经有非常成熟的 IM 通讯解决方案所以我们直接复用腾讯云 IM 实现房间内各成员的状态通知。心跳机制 除了音视频链路小程序和 Server 之间最好还要加一个心跳机制这种方式用于甄别微信是否发生了意外崩溃您也可以使用腾讯云音视频链路的中断通知来达到同样效果但是接入复杂性要高很多。源码下载RTCRoom 是一套开源实现在 iOSAndroidWindows、小程序以及服务器端均有一套示例源码。其中客户端的源码主要是提供 CreateRoom、EnterRoom、ExitRoom 等进出房间的接口而服务端源码则用于房间管理并通过腾讯云通讯（IM）服务向房间内成员发送事件通知。操作系统下载链接源码位置小程序DOWNLOAD小程序源码 zip 包中的 wxlite 文件夹服务端DOWNLOAD小程序源码 zip 包中的 server 文件夹iOSDOWNLOADSDK 开发包 RtcRoom.mAndroidDOWNLOADSDK 开发包 RtcRoom.javaWindowsDOWNLOADDemo 源码中的 RTCRoom.h+RTCRoom.cpp小程序端源码包的内部目录结构：RTMPRoom├── README.md├── server               //后台代码目录具体目录节后见文档稍后部分├── wxlite               //腾讯视频云小程序目录├── ├── pages            //腾讯视频云小程序界面主目录├── ├── ├── main         //腾讯视频云小程序主界面├── ├── ├── liveroom     //腾讯视频云小程序直播体验室├── ├── ├── ├────roomlist//腾讯视频云小程序直播体验室列表界面├── ├── ├── ├────room    //腾讯视频云小程序直播体验室直播界面├── ├── ├── doubleroom   //腾讯视频云小程序双人音视频├── ├── ├── ├────roomlist//腾讯视频云小程序双人音视频在线列表├── ├── ├── ├────room    //腾讯视频云小程序双人音视频视频聊天界面├── ├── ├── multiroom    //腾讯视频云小程序多人音视频├── ├── ├── ├────roomlist//腾讯视频云小程序多人音视频在线列表├── ├── ├── ├────room    //腾讯视频云小程序多人音视频视频聊天界面├── ├── ├── cameraview   //腾讯视频云小程序双人、多人聊天推流自定义组件├── ├── ├── play         //腾讯视频云小程序播放界面├── ├── ├── push         //腾讯视频云小程序推流界面├── ├── ├── rtpplay      //腾讯视频云小程序低延时播放界面├── ├── ├── vodplay      //腾讯视频云小程序点播播放界面├── ├── ├── Resources    //腾讯视频云小程序资源目录├── ├── lib              //小程序使用的通用库目录├── ├── utils            //腾讯视频云小程序界工具库目录├── ├── ├── rtcroom.js   //腾讯视频云小程序双人、多人音视频库文件├── ├── ├── liveroom.js  //腾讯视频云小程序单向音视频库文件└── └── config.js        //配置文件主要配置后台服务器地址服务端端源码包的内部目录结构：server├── README.md├── app.js    // 服务器端 的主入口文件使用 Koa 框架在 `app.js` 创建一个 Koa 实例并响应请求。├── double_room                // 双人实时音视频房间每个js文件对应一个https接口的实现│   ├── index.js  │   ├── get_im_login_info.js│   ├── get_push_url.js│   ├── create_room.js│   ├── destroy_room.js│   ├── add_pusher.js│   ├── delete_pusher.js│   ├── get_pushers.js│   ├── pusher_heartbeat.js│   └── get_room_list.js├── multi_room                // 多人实时音视频房间每个js文件对应一个https接口的实现│   ├── index.js│   ├── get_im_login_info.js│   ├── get_push_url.js│   ├── create_room.js│   ├── destroy_room.js│   ├── add_pusher.js│   ├── delete_pusher.js│   ├── get_pushers.js│   ├── pusher_heartbeat.js│   └── get_room_list.js├── live_room                 // RTMP直播房间业务逻辑每个js文件对应一个https接口的实现│   ├── index.js│   ├── get_im_login_info.js│   ├── get_push_url.js│   ├── create_room.js│   ├── destroy_room.js│   ├── add_pusher.js│   ├── delete_pusher.js│   ├── get_pushers.js│   ├── pusher_heartbeat.js│   └── get_room_list.js├── utils                     // 存放服务器端辅助接口的目录│   ├── index.js│   ├── get_test_pushurl.js│   ├── get_test_rtmpaccurl.js│   ├── getlogfile.js│   └── logfilelist.js├── logic                     //│   ├── im_mgr.js             // 云通信相关的处理主要功能│   ├── live_util.js          // 辅助函数负责生成推流地址以及播放地址以及用户ID分配和房间ID分配的功能│   ├── double_room_mgr.js    // 双人实时音视频房间管理模块│   ├── multi_room_mgr.js     // 多人实时音视频房间管理模块│   └── live_room_mgr.js      // 标准 RTMP 直播房间管理模块├── middlewares│   ├── bodyparser.js│   └── response.js├── config.js                 // 配置腾讯云直播服务和云通讯服务的相关参数如推流防盗链keybizid等├── log.js                    // 后台日志模块主要记录请求响应和错误两大类日志。├── log_config.js             ├── package.json├── process.json├── nodemon.json├── qcloud.js└── routes      └── index.js      // 服务器端路由定义文件：即每个 https 接口具体是由哪个 js 文件所实现的一键部署下载源码只需要点几下鼠标但是让 RTCRoom 跑起来却未必是件容易的事情尤其是在您没有服务器的情况下。考虑到这一点我们提供了免费的一键部署服务您只需要免费开通几项腾讯云服务即可在 5 分钟时间内快速搭建出自己的调试环境。双人场景RTCRoom 不仅仅可用于多人场景双人视频通话也可以使用而且要比从零开始用 <live-pusher> 和 <live-player> 构建双人视频通话功能要简单的多。原创声明本文系作者授权云+社区-专栏发表未经许可不得转载。如有侵权请联系zhuanlan_guanli@qq.com删除。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)313731418baobaoxiaoxuan                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    初级前端小程序项目加载速度优化               微信小程序—跳一跳Android游戏助手(外挂)使用教程                                                        原作者: 小程序音视频产品经理                   来自: 极乐头条                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序腾讯视频插件的使用                                                                                               "},{"title": "小程序分享，看这篇就够了 ", "author": "                  Rolan                  2018-7-12 00:21                ", "text": "                                                                                                                                                                                     官方文档最近在调研小程序的分享能力本篇文档主要是调研小程序关于分享方面的玩法目的是学习小程序在项目应用以及玩法链上的扩展。API层面onShareAppMessage小程序如果想对外分享必须在 page 里面定义 onShareAppMessage 函数来配置页面分享转发相关的信息。只有定义了此事件处理函数右上角菜单才会显示 “转发” 按钮用户点击转发按钮的时候会调用此事件需要 return 一个 Object用于自定义转发内容一个页面可能会有多个分享可以由插入的参数options来判断具体是由哪个位置进行分享从而做不同的逻辑判断。return对象的返回函数：如果定义了该事件又不想通过页面menu转发可以通过 hideShareMenu来隐藏掉注意事项：转发后不添加imageUrl的话将截图作为转发的默认图片。from 字段可以通过在转发成功后调取的 success、complete 来进行对 menu 和 button 的不同操作如果有携带 shareTicket 值会在 success 回调产生返回结果在 shareTickets 字段中是一个数组可以做一定处理wx.showShareMenu一般是用来配置相关的参数常见的如 withShareTicket 用它来获取群信息群的相关标示。wx.showShareMenu({  withShareTicket: true})复制代码wx.hideShareMenu隐藏menu级别的转发功能但是button中还存在着转发。如果先设置 showShareMenu 并且配置了 withShareTicket再用 hideShareMenu 方法通过按钮转发照样能获取 shareTicket如下：wx.showShareMenu({  withShareTicket: true})wx.hideShareMenu({})复制代码wx.updateShareMenu更新shareMenu信息需要用update操作哦这里需要注意下一般都是会更新 withShareTicket 属性。wx.getShareInfo在拿到了shareTicket信息后可以由此API获取转发详细信息wx.getShareInfo({    shareTicket: res.shareTickets[0],    success: ...    fail: ...})复制代码相关回调的参数{    errMsg: \"getShareInfo:ok\",     iv: \"gRHeFU+Nhr36RmladCXnRQ==\",     encryptedData: \"IQ/RwZLeQFUGuxv0bBfOrL/KLnXO+bxcyCBru5lB92FkHIg8ae…7TnHwU+rqgerFKvpvS5JbFyh+9liUqyb2bk6/LETYQ+h/FQ==\"}复制代码由iv和encryptedData进行解密可以拿到openGId的值。为当前群对当前小程序的唯一值。额外还可以拿到群名称等更多的开放数据。button转发页面内需要转发时需要给 button 组件设置 open-type=\"share\" 并在触发的地方判断来源。获取分享链接流程在小程序中获取openGId主要有两种途径也一般围绕着两种途径做分享相关的开发：当用户打开 withShareTicket 的卡片时可以在onLauch或者 getShareInfo 中获取加密信息并且传给服务端获得openGId。当用户分享成功后会在回调里收到一个 shareTicket 然后通过 getShareInfo 来获得加密信息获得openGId。拓展玩法APP分享到小程序传统APP要以小程序卡片的形式分享到微信需要满足以下几个条件：要求发起分享的App与小程序属于同一微信开放平台帐号；支持分享小程序类型消息至好友会话不支持“分享至朋友圈” “收藏”；微信客户端版本要求：6.5.6及以上微信客户端版本若客户端版本低于6.5.6小程序类型分享将自动转成网页类型分享。开发者必须填写网页链接字段确保低版本客户端能正常打开网页链接；支持分享大图卡片样式自定义图片建议长宽比是 5:4。6.5.9及以上版本微信客户端小程序类型分享使用大图卡片样式。支持分享开发版/体验版小程序为支持开发者调试开发者工具包支持分享开发版/体验版小程序至微信开发者可控制分享的小程序版本。具体流程图如下：朋友圈打开小程序在朋友圈中发布图片附带小程序二维码用户把图片分享到朋友圈中看到的一方即可长恩识别在微信中打开小程序。 通过这个玩法实现了把小程序「分享」到朋友圈。至于图片的生成canvas和服务器端生成都是比较成熟的解决方案。小程序支持打开APP这个玩法有一个前提：小程序卡片必须是由APP分享出去才可以打开APP功能流程图如下：该途径可以作为小程序对于app的补充： 产品可以通过 App 和小程序实现场景互补。比如用户 Sherry 将一个文档分享给用户 KevinKevin 可以在小程序内直接查看。如果需要编辑则可以直接打开 App 完成协同处理。这样一来小程序不需要做的很重只需满足基本功能更多功能由 App 来补充。case举例：用户代打车用户A想让用户B代打车用户A将行程分享给用户B用户B微信打开小程序之后跳转美团打车APP完成相关复杂操作。小程序向公众号导流在小程序中可以利用一些引导性文案指引用户点击进入客服会话页面然后客服自动回复一条公众号图文消息而图文消息则有引导关注公众号获取更多服务的指引文案。（ 经典用法但是小心被封 ）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)chowyz                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序腾讯视频插件的使用               我与小程序的故事以及小程序框架选型                                                        原作者: 大明                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序区分分享到群和好友                                                      • iOS分享微信小程序                                                      • 【资源分享】微信小游戏入门与实战 刷爆朋友圈                                                      • 『技术分享』—— 我的第一个微信小程序-趣闻                                                      • 微信小程序利用canvas生成海报分享图片                                                      • 轻松生成小程序分享海报                                                                                               "},{"title": "微信小程序UI组件、开发框架、实用库. ", "author": "                  Rolan                  2017-8-10 00:24                ", "text": "                                                                                                                                                                                     UI组件weui-wxss ★852 - 同微信原生视觉体验一致的基础样式库Wa-UI ★122 - 针对微信小程序整合的一套UI库wx-charts ★105 - 微信小程序图表工具wemark ★85 - 微信小程序Markdown渲染库WeZRender ★36 - 微信小程序Canvas增强组件wetoast ★21 - 仿照微信小程序提供的showToast功能wxapp-charts ★20 - 微信小程序图表charts组件WeiXinProject ★18 - 列表的上拉刷新和上拉加载citySelect ★16 - 微信小程序城市选择器开发框架Labrador ★391 - 微信小程序模块化开发框架wepy ★383 - 小程序组件化开发框架wxapp-devFrame ★27 - 小程序基本的开发框架实用库wxParse ★412 - 微信小程序富文本解析自定义组件wechat-weapp-redux ★102 - 微信小程序Redux绑定wilddog-weapp ★44 - 野狗微信小程序客户SDKwafer-client-sdk ★40 - 微信小程序客户端腾讯云增强 SDKWxNotificationCenter ★29 - 微信小程序通知广播模式类开发工具weapp-ide-crack ★4454 - 微信小程序IDE及破解攻略wept ★799 - 实时微信小程序开发工具weapp-quick ★296 - “微信Web开发者”拷贝工具Wxapp.vim ★155 - 微信小程序开发 Vim 插件Matchmaker ★80 - 专为微信小程序开发的插件wechat_web_devtools ★72 - 微信开发者工具Linux版miniapps ★67 - 小程序项目脚手架工具服务端NAMI ★28 - 专为小程序而生的服务端开发容器Wafer 服务端 SDK - Java ★28 - 企业级微信小程序全栈方案m-mall-admin ★26 - 创建REST API的样板应用weapp-php-server-sdk ★23 - 腾讯云微信小程序云端解决方案weapp-node-server-demo ★20 - Wafer 服务端 Demo其他wxapp-redux-starter ★58 - 提供方便快捷的微信小程序开发环境Demoweapp-demo ★727 - 仿豆瓣电影微信小程序wechat-weapp-gank ★537 - Gank微信小程序SmallAppForQQ ★460 - 微信小程序高仿QQ应用wechat-weapp-mall ★430 - 微信小程序移动端商城weapp-wechat-zhihu ★297 - 微信中的知乎wecqupt ★255 - 在微信内被便捷地获取和传播仿芒果TV ★188 - 微信小程序demoweChatApp-Run ★173 - 跑步微信小程序Demowechat-v2ex ★173 - 简单的v2ex微信小程序wechat-weapp-taobao ★153 - 微信小程序demo 仿手机淘宝weapp-weipiao ★141 - 微信小程序-微票wechat-app-zhihudaily ★134 - 微信小程序-知乎日报fenda-mock ★125 - 使用微信小程序实现分答这款APP的基础功能weapp-boilerplate ★112 - 一个为微信小程序开发准备的基础骨架腾讯云微信小程序 ★111 - 一站式解决方案客户端示例wechat_mall_applet ★103 - 巴爷微信商城的简单版本wechat-app-music ★91 - 微信小程序： 音乐播放器wechat-weapp-mapdemo ★76 - 微信小程序开发demo-地图定位m-mall ★67 - 实现一个移动端小商城wechat-weapp-movie ★66 - 微信小程序 - 电影推荐wechat-weapp-redux-todos ★61 - 微信小程序集成Redux实现的Todo listwxapp-socket-io ★61 - 微信小程序的SocketIO客户端weapp-douban-film ★59 - 微信小程序 - 豆瓣电影weapp-demo-session ★58 - 微信小程序示例一笔到底Artand ★55 - 微信小程序wepy-wechat-demo ★54 - wepy仿微信聊天界面weapp-one ★47 - 仿 「ONE · 一个」 的微信小程序BearDiary ★44 - 微信小程序之小熊の日记wechat-chat ★44 - 微信小程序版聊天室wxapp-sCalc ★41 - 微信小程序版简易计算器适合入门练手wechat-weapp-demo ★41 - 一个简单的微信小程序购物车DEMOwxflex ★38 - 微信小程序的Flex布局demo番茄时钟 ★35 - 番茄时钟微信小程序版weapp-newsapp ★35 - 微信小程序-公众号热门文章信息流wxapp-hiapp ★33 - HiApp 微信小程序版weapp-github ★33 - 微信小程序的简单尝试weapp-girls ★31 - 通过Node.js实现的妹子照片爬虫微信小程序weapp-V2ex ★30 - V2ex 微信小程序版wechat-app-flexlayout ★28 - 从FlexLayout布局开始学习微信小程序wechatapp-news-reader ★26 - 新闻阅读器wechat-app-xiaoyima ★24 - 仿大姨妈的微信小程序yiyaowang-wx ★21 - 医药网原生APP的微信小程序DEMOweapp-node-server-demo ★20 - Wafer 服务端 Demoweapp ★19 - 小程序 hello world 尝鲜weapp-demo-breadtrip ★19 - 基于面包旅行 API 制作的微信小程序示例WeChatMeiZhi ★17 - 微信小程序版妹纸图wxreading ★17 - 微信小程序跟读WXBaiSi ★16 - 微信小程序仿百思不得姐hotapp-notepad ★16 - 微信小程序HotApp云笔记wxapp-2048 ★16 - 微信小程序2048weapp-500px ★16 - 微信小程序netmusic-app ★14 - 仿网易云音乐APP的微信小程序WxMasonry ★14 - 微信小程序瀑布流布局模式GankCamp-WechatAPP ★13 - 微信小程序版干货集中营PigRaising ★13 - 专注管理时间的微信小程序weapp-lolgame ★12 - 英雄联盟(LOL)战绩查询WexinApp_1024 ★12 - 简单的实现了1024的游戏规则weapp-douban-movie ★12 - 微信小程序版豆瓣电影jspapa-wx ★10 - jspapa微信小程序版本wechat-app-githubfeed ★8 - 微信小程序试玩wxSortPickerView ★8 - 微信小程序首字母排序选择表liwushuoapp ★8 - 微信小程序开发的Appwx-mina-meteor ★8 - 一个 meteor 的 React todo list 例子caipu_weixin ★7 - 微信小程序健康菜谱weapp-LeanCloud ★7 - LeanCloud 的微信小程序用户登陆Demowx-mime ★5 - 微信小程序版的扫雷以上内容非本人整理此处仅做收藏                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    理解微信小程序技术架构               微信小程序开发实战&电影小程序之（1）——基础目录、欢迎页面的创建 ...                                                        原作者: icyhoo58694                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 如何写一个微信小程序组件                                                      • 小程序组件实现                                                      • Android开发不用学CSS从0开始学习微信小程序                                                      • 微信小程序开发相关记录                                                      • Yii2小程序组件                                                      • 微信小程序getPhoneNumber快速获取用户手机号组件                                                      • 微信小程序的dva集成                                                      • 微信小程序快速上手：框架以及主体                                                      • 基本组件--(进度条、滑动选择器、开关选择器、复选框、)                                                      • 小程序开发有用的库 - css 篇                                                      • 写给 Android 开发的小程序 UI 布局指南（一）                                                                                               "},{"title": "小程序--前端AES加密 ", "author": "                  Rolan                  2018-4-17 00:21                ", "text": "                                                                                                                                                                                     一.前言什么是AES加密：高级加密标准（英语：Advanced Encryption Standard缩写：AES）在密码学中又称Rijndael加密法是美国联邦政府采用的一种区块加密标准。这个标准用来替代原先的DES已经被多方分析且广为全世界所使用。经过五年的甄选流程高级加密标准由美国国家标准与技术研究院（NIST）于2001年11月26日发布于FIPS PUB 197并在2002年5月26日成为有效的标准。2006年高级加密标准已然成为对称密钥加密中最流行的算法之一。AES加密的应用场景AES加密可逆转加密前后端公用一个秘钥来加密解密二.难点：小程序引入第三方库前后端加密解密类型相匹配三.操作：很多人说小程序怎么引入第三方库：下载文件1.exports 出来,exports可以把该文件当做模块暴露出来（下次说一下exports、exports defult、model exports的区别）2.在使用到的文件里引用它// aes.js文件`/*CryptoJS v3.1.2code.google.com/p/crypto-js(c) 2009-2013 by Jeff Mott. All rights reserved.code.google.com/p/crypto-js/wiki/License/*var CryptoJS=CryptoJS||function(u,p){var d={},l=d.lib={},s=function(){},t=l.Base={extend:function(a){s.prototype=this;var c=new s;a&&c.mixIn(a);c.hasOwnProperty(\"init\")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty(\"toString\")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},r=l.WordArray=t.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=p?c:4a.length},toString:function(a){return(a||v).stringify(this)},concat:function(a){var c=this.words,e=a.words,j=this.sigBytes;a=a.sigBytes;this.clamp();if(j%4)for(var k=0;k>>2]|=(e[k>>>2]>>>24-8*(k%4)&255)<<24-8*((j+k)%4);else if(65535>>2]=e[k>>>2];else c.push.apply(c,e);this.sigBytes+=a;return this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<32-8*(c%4);a.length=u.ceil(c/4)},clone:function(){var a=t.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var c=[],e=0;e>>2]>>>24-8*(j%4)&255;e.push((k>>>4).toString(16));e.push((k&15).toString(16))}return e.join(\"\")},parse:function(a){for(var c=a.length,e=[],j=0;j>>3]|=parseInt(a.substr(j,2),16)<<24-4*(j%8);return new r.init(e,c/2)}},b=w.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var e=[],j=0;j>>2]>>>24-8*(j%4)&255));return e.join(\"\")},parse:function(a){for(var c=a.length,e=[],j=0;j>>2]|=(a.charCodeAt(j)&255)<<24-8*(j%4);return new r.init(e,c)}},x=w.Utf8={stringify:function(a){try{return decodeURIComponent(escape(b.stringify(a)))}catch(c){throw Error(\"Malformed UTF-8 data\");}},parse:function(a){return b.parse(unescape(encodeURIComponent(a)))}},q=l.BufferedBlockAlgorithm=t.extend({reset:function(){this._data=new r.init;this._nDataBytes=0},_append:function(a){\"string\"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,e=c.words,j=c.sigBytes,k=this.blockSize,b=j/(4k),b=a?u.ceil(b):u.max((b|0)-this._minBufferSize,0);a=bk;j=u.min(4a,j);if(a){for(var q=0;qa._data=this._data.clone();return a},_minBufferSize:0});l.Hasher=q.extend({cfg:t.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){q.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,e){return(new a.init(e)).finalize(b)}},_createHmacHelper:function(a){return function(b,e){return(new n.HMAC.init(a,e)).finalize(b)}}});var n=d.algo={};return d}(Math);(function(){var u=CryptoJS,p=u.lib.WordArray;u.enc.Base64={stringify:function(d){var l=d.words,p=d.sigBytes,t=this._map;d.clamp();d=[];for(var r=0;r>>2]>>>24-8(r%4)&255)<<16|(l[r+1>>>2]>>>24-8*((r+1)%4)&255)<<8|l[r+2>>>2]>>>24-8*((r+2)%4)&255,v=0;4>v&&r+0.75v>>6(3-v)&63));if(l=t.charAt(64))for(;d.length%4;)d.push(l);return d.join(\"\")},parse:function(d){var l=d.length,s=this._map,t=s.charAt(64);t&&(t=d.indexOf(t),-1!=t&&(l=t));for(var t=[],r=0,w=0;w<l;w++)if(w%4){var v=s.indexOf(d.charAt(w-1))<<2*(w%4),b=s.indexOf(d.charAt(w))>>>6-2*(w%4);t[r>>>2]|=(v|b)<<24-8*(r%4);r++}return p.create(t,r)},_map:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"}})();(function(u){function p(b,n,a,c,e,j,k){b=b+(n&a|~n&c)+e+k;return(b<>>32-j)+n}function d(b,n,a,c,e,j,k){b=b+(n&c|a&~c)+e+k;return(b<>>32-j)+n}function l(b,n,a,c,e,j,k){b=b+(n^a^c)+e+k;return(b<>>32-j)+n}function s(b,n,a,c,e,j,k){b=b+(a^(n|~c))+e+k;return(b<>>32-j)+n}for(var t=CryptoJS,r=t.lib,w=r.WordArray,v=r.Hasher,r=t.algo,b=[],x=0;64>x;x++)b[x]=4294967296u.abs(u.sin(x+1))|0;r=r.MD5=v.extend({_doReset:function(){this._hash=new w.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(q,n){for(var a=0;16>a;a++){var c=n+a,e=q[c];q[c]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360}var a=this._hash.words,c=q[n+0],e=q[n+1],j=q[n+2],k=q[n+3],z=q[n+4],r=q[n+5],t=q[n+6],w=q[n+7],v=q[n+8],A=q[n+9],B=q[n+10],C=q[n+11],u=q[n+12],D=q[n+13],E=q[n+14],x=q[n+15],f=a[0],m=a[1],g=a[2],h=a[3],f=p(f,m,g,h,c,7,b[0]),h=p(h,f,m,g,e,12,b[1]),g=p(g,h,f,m,j,17,b[2]),m=p(m,g,h,f,k,22,b[3]),f=p(f,m,g,h,z,7,b[4]),h=p(h,f,m,g,r,12,b[5]),g=p(g,h,f,m,t,17,b[6]),m=p(m,g,h,f,w,22,b[7]),f=p(f,m,g,h,v,7,b[8]),h=p(h,f,m,g,A,12,b[9]),g=p(g,h,f,m,B,17,b[10]),m=p(m,g,h,f,C,22,b[11]),f=p(f,m,g,h,u,7,b[12]),h=p(h,f,m,g,D,12,b[13]),g=p(g,h,f,m,E,17,b[14]),m=p(m,g,h,f,x,22,b[15]),f=d(f,m,g,h,e,5,b[16]),h=d(h,f,m,g,t,9,b[17]),g=d(g,h,f,m,C,14,b[18]),m=d(m,g,h,f,c,20,b[19]),f=d(f,m,g,h,r,5,b[20]),h=d(h,f,m,g,B,9,b[21]),g=d(g,h,f,m,x,14,b[22]),m=d(m,g,h,f,z,20,b[23]),f=d(f,m,g,h,A,5,b[24]),h=d(h,f,m,g,E,9,b[25]),g=d(g,h,f,m,k,14,b[26]),m=d(m,g,h,f,v,20,b[27]),f=d(f,m,g,h,D,5,b[28]),h=d(h,f,m,g,j,9,b[29]),g=d(g,h,f,m,w,14,b[30]),m=d(m,g,h,f,u,20,b[31]),f=l(f,m,g,h,r,4,b[32]),h=l(h,f,m,g,v,11,b[33]),g=l(g,h,f,m,C,16,b[34]),m=l(m,g,h,f,E,23,b[35]),f=l(f,m,g,h,e,4,b[36]),h=l(h,f,m,g,z,11,b[37]),g=l(g,h,f,m,w,16,b[38]),m=l(m,g,h,f,B,23,b[39]),f=l(f,m,g,h,D,4,b[40]),h=l(h,f,m,g,c,11,b[41]),g=l(g,h,f,m,k,16,b[42]),m=l(m,g,h,f,t,23,b[43]),f=l(f,m,g,h,A,4,b[44]),h=l(h,f,m,g,u,11,b[45]),g=l(g,h,f,m,x,16,b[46]),m=l(m,g,h,f,j,23,b[47]),f=s(f,m,g,h,c,6,b[48]),h=s(h,f,m,g,w,10,b[49]),g=s(g,h,f,m,E,15,b[50]),m=s(m,g,h,f,r,21,b[51]),f=s(f,m,g,h,u,6,b[52]),h=s(h,f,m,g,k,10,b[53]),g=s(g,h,f,m,B,15,b[54]),m=s(m,g,h,f,e,21,b[55]),f=s(f,m,g,h,v,6,b[56]),h=s(h,f,m,g,x,10,b[57]),g=s(g,h,f,m,t,15,b[58]),m=s(m,g,h,f,D,21,b[59]),f=s(f,m,g,h,z,6,b[60]),h=s(h,f,m,g,C,10,b[61]),g=s(g,h,f,m,j,15,b[62]),m=s(m,g,h,f,A,21,b[63]);a[0]=a[0]+f|0;a[1]=a[1]+m|0;a[2]=a[2]+g|0;a[3]=a[3]+h|0},_doFinalize:function(){var b=this._data,n=b.words,a=8this._nDataBytes,c=8b.sigBytes;n[c>>>5]|=128<<24-c%32;var e=u.floor(a/4294967296);n[(c+64>>>9<<4)+15]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;n[(c+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;b.sigBytes=4(n.length+1);this._process();b=this._hash;n=b.words;for(a=0;4>a;a++)c=n[a],n[a]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360;return b},clone:function(){var b=v.clone.call(this);b._hash=this._hash.clone();return b}});t.MD5=v._createHelper(r);t.HmacMD5=v._createHmacHelper(r)})(Math);(function(){var u=CryptoJS,p=u.lib,d=p.Base,l=p.WordArray,p=u.algo,s=p.EvpKDF=d.extend({cfg:d.extend({keySize:4,hasher:p.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,r){for(var p=this.cfg,s=p.hasher.create(),b=l.create(),u=b.words,q=p.keySize,p=p.iterations;u.lengthl)}})();CryptoJS.lib.Cipher||function(u){var p=CryptoJS,d=p.lib,l=d.Base,s=d.WordArray,t=d.BufferedBlockAlgorithm,r=p.enc.Base64,w=p.algo.EvpKDF,v=d.Cipher=t.extend({cfg:l.extend(),createEncryptor:function(e,a){return this.create(this._ENC_XFORM_MODE,e,a)},createDecryptor:function(e,a){return this.create(this._DEC_XFORM_MODE,e,a)},init:function(e,a,b){this.cfg=this.cfg.extend(b);this._xformMode=e;this._key=a;this.reset()},reset:function(){t.reset.call(this);this._doReset()},process:function(e){this._append(e);return this._process()},finalize:function(e){e&&this._append(e);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(b,k,d){return(\"string\"==typeof k?c:a).encrypt(e,b,k,d)},decrypt:function(b,k,d){return(\"string\"==typeof k?c:a).decrypt(e,b,k,d)}}}});d.StreamCipher=v.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var b=p.mode={},x=function(e,a,b){var c=this._iv;c?this._iv=u:c=this._prevBlock;for(var d=0;dc[d]},q=(d.BlockCipherMode=l.extend({createEncryptor:function(e,a){return this.Encryptor.create(e,a)},createDecryptor:function(e,a){return this.Decryptor.create(e,a)},init:function(e,a){this._cipher=e;this._iv=a}})).extend();q.Encryptor=q.extend({processBlock:function(e,a){var b=this._cipher,c=b.blockSize;x.call(this,e,a,c);b.encryptBlock(e,a);this._prevBlock=e.slice(a,a+c)}});q.Decryptor=q.extend({processBlock:function(e,a){var b=this._cipher,c=b.blockSize,d=e.slice(a,a+c);b.decryptBlock(e,a);x.call(this,e,a,c);this._prevBlock=d}});b=b.CBC=q;q=(p.pad={}).Pkcs7={pad:function(a,b){for(var c=4b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,l=[],n=0;n>>2]&255}};d.BlockCipher=v.extend({cfg:v.cfg.extend({mode:b,padding:q}),reset:function(){v.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var n=d.CipherParams=l.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),b=(p.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?s.create([1398893684,1701076831]).concat(a).concat(b):b).toString(r)},parse:function(a){a=r.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=s.create(b.slice(2,4));b.splice(0,4);a.sigBytes-=16}return n.create({ciphertext:a,salt:c})}},a=d.SerializableCipher=l.extend({cfg:l.extend({format:b}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var l=a.createEncryptor(c,d);b=l.finalize(b);l=l.cfg;return n.create({ciphertext:b,key:c,iv:l.iv,algorithm:a,mode:l.mode,padding:l.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);return a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return\"string\"==typeof a?b.parse(a,this):a}}),p=(p.kdf={}).OpenSSL={execute:function(a,b,c,d){d||(d=s.random(8));a=w.create({keySize:b+c}).compute(a,d);c=s.create(a.words.slice(b),4c);a.sigBytes=4b;return n.create({key:a,iv:c,salt:d})}},c=d.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:p}),encrypt:function(b,c,d,l){l=this.cfg.extend(l);d=l.kdf.execute(d,b.keySize,b.ivSize);l.iv=d.iv;b=a.encrypt.call(this,b,c,d.key,l);b.mixIn(d);return b},decrypt:function(b,c,d,l){l=this.cfg.extend(l);c=this._parse(c,l.format);d=l.kdf.execute(d,b.keySize,b.ivSize,c.salt);l.iv=d.iv;return a.decrypt.call(this,b,c,d.key,l)}})}();(function(){for(var u=CryptoJS,p=u.lib.BlockCipher,d=u.algo,l=[],s=[],t=[],r=[],w=[],v=[],b=[],x=[],q=[],n=[],a=[],c=0;256>c;c++)a[c]=128>c?c<<1:c<<1^283;for(var e=0,j=0,c=0;256>c;c++){var k=j^j<<1^j<<2^j<<3^j<<4,k=k>>>8^k&255^99;l[e]=k;s[k]=e;var z=a[e],F=a[z],G=a[F],y=257a[k]^16843008k;t[e]=y<<24|y>>>8;r[e]=y<<16|y>>>16;w[e]=y<<8|y>>>24;v[e]=y;y=16843009G^65537F^257z^16843008e;b[k]=y<<24|y>>>8;x[k]=y<<16|y>>>16;q[k]=y<<8|y>>>24;n[k]=y;e?(e=z^a[a[a[G^z]]],j^=a[a[j]]):e=j=1}var H=[0,1,2,4,8,16,32,64,128,27,54],d=d.AES=p.extend({_doReset:function(){for(var a=this._key,c=a.words,d=a.sigBytes/4,a=4((this._nRounds=d+6)+1),e=this._keySchedule=[],j=0;j>>24]<<24|l[k>>>16&255]<<16|l[k>>>8&255]<<8|l[k&255]):(k=k<<8|k>>>24,k=l[k>>>24]<<24|l[k>>>16&255]<<16|l[k>>>8&255]<<8|l[k&255],k^=H[j/d|0]<<24);e[j]=e[j-d]^k}c=this._invKeySchedule=[];for(d=0;dd||4>=j?k:b[l[k>>>24]]^x[l[k>>>16&255]]^q[l[k>>>8&255]]^n[l[k&255]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,t,r,w,v,l)},decryptBlock:function(a,c){var d=a[c+1];a[c+1]=a[c+3];a[c+3]=d;this._doCryptBlock(a,c,this._invKeySchedule,b,x,q,n,s);d=a[c+1];a[c+1]=a[c+3];a[c+3]=d},_doCryptBlock:function(a,b,c,d,e,j,l,f){for(var m=this._nRounds,g=a[b]^c[0],h=a[b+1]^c[1],k=a[b+2]^c[2],n=a[b+3]^c[3],p=4,r=1;r>>24]^e[h>>>16&255]^j[k>>>8&255]^l[n&255]^c[p++],s=d[h>>>24]^e[k>>>16&255]^j[n>>>8&255]^l[g&255]^c[p++],t=d[k>>>24]^e[n>>>16&255]^j[g>>>8&255]^l[h&255]^c[p++],n=d[n>>>24]^e[g>>>16&255]^j[h>>>8&255]^l[k&255]^c[p++],g=q,h=s,k=t;q=(f[g>>>24]<<24|f[h>>>16&255]<<16|f[k>>>8&255]<<8|f[n&255])^c[p++];s=(f[h>>>24]<<24|f[k>>>16&255]<<16|f[n>>>8&255]<<8|f[g&255])^c[p++];t=(f[k>>>24]<<24|f[n>>>16&255]<<16|f[g>>>8&255]<<8|f[h&255])^c[p++];n=(f[n>>>24]<<24|f[g>>>16&255]<<16|f[h>>>8&255]<<8|f[k&255])^c[p++];a[b]=q;a[b+1]=s;a[b+2]=t;a[b+3]=n},keySize:8});u.AES=p._createHelper(d)})();module.exports = {CryptoJS: CryptoJS}`// main.js//引入aes  var fun_aes = require('../../utils/aes.js');  //引用AES源码js//加密加密解密   //十六位十六进制数作为秘钥var key = fun_aes.CryptoJS.enc.Utf8.parse(\"3454345434543454\");  //十六位十六进制数作为秘钥偏移量var iv  = fun_aes.CryptoJS.enc.Utf8.parse('6666666666666666'); //秘钥和偏移量后台会给前端//封装加密Encrypt: function (word) {    var srcs = fun_aes.CryptoJS.enc.Utf8.parse(word);    var encrypted = fun_aes.CryptoJS.AES.encrypt(srcs, key, { iv: iv, mode: fun_aes.CryptoJS.mode.CBC, padding: fun_aes.CryptoJS.pad.Pkcs7 });    return encrypted.ciphertext.toString().toUpperCase();},//封装解密Decrypt: function (word) {    var encryptedHexStr = fun_aes.CryptoJS.enc.Hex.parse(word);    var srcs = fun_aes.CryptoJS.enc.Base64.stringify(encryptedHexStr);    var decrypt = fun_aes.CryptoJS.AES.decrypt(srcs, key, { iv: iv, mode: fun_aes.CryptoJS.mode.CBC, padding: fun_aes.CryptoJS.pad.Pkcs7 });    var decryptedStr = decrypt.toString(fun_aes.CryptoJS.enc.Utf8);    return decryptedStr.toString();}//使用//把加密好的给后台就好了解密前端可以自己校验自己解密好的是不是和原始数据一样；四 . demo （有aes、base64、md5、sha1的加密）Github地址： ​https://github.com/19L/encrypt五.最后分享一个工具真的很有用http://www.seacha.com/tools/aes.html#六.友情提示：特别留意加密结果编码方式有base64和16进制两种前后台要统一。七.加密库（crypto.js） https://github.com/brix/crypt...7.如果觉得有帮助请点赞哦！！By:Beast(彭)                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序如何像vue操作一样在动态绑定类名？               微信小程序：蓝牙BLE连接10003问题分析及解决                                                        原作者: Beast                    来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信加密数据解密报错-41003                                                      • 小程序端JS加密传输PHP端解密                                                      • 微信小程序--实现密码加密                                                      • 微信小程序加密数据解密算法Go版                                                      • 微信小程序开发问答《五十》实现点击返回顶层 & md5加密 ... ...                                                      • 微信小程序开发问答《六十六》 菜单内容左右联动 & MD5加密 ...                                                                                               "},{"title": "前端开发常见问题精选（三） ", "author": "                  Rolan                  2017-10-19 00:32                ", "text": "                                                                                                                                                                                     一、如何禁止微信h5页面默认下拉并且同时页面局部可滚动？众所周知微信浏览器默认是可以上拉和下拉的就像下面这样：然而有时候我们需要禁止它那该怎么做呢？1. 禁止页面的touchmove事件document.addEventListener('touchmove',function(e){    e.preventDefault();});该方法简洁明了但是问题来了浏览器默认下拉是禁掉了可页面却不能滑动了。因此该方法只适用于在单屏内能够显示全内容的页面。2. 使用iScroll.js插件该方法才是真正要提到的既可以禁止浏览器默认下拉也能同时让页面局部可滚动。使用iScroll.js插件时需要注意一下几点：① 调用该插件的对象元素只能存在一个子元素也就是说如果在滚动区域中存在多个子元素需要使用一个元素来包裹它们。② 调用该插件的对象元素样式中最好不要设置外边距否则可能出现宽高计算不准确的情况。③ 使用该插件的默认状态下滚动区域内的按钮、链接等一切可点击元素均失效如需恢复正常点击可以配置options.click为true。iScroll.js插件的具体用法可以参考：http://wiki.jikexueyuan.com/project/iscroll-5/。二、Less中写border-radius时用到 “/” 时该如何处理？不知道大家现在写CSS是怎么写呢？是直接写原生的CSS还是使用像Sass或Less这样的预编译语言呢？如果你是习惯使用Less那么遇到border-radius中的 “/” 该如何处理呢？大家可能都知道border-radius有很多种写法不知道的话可以看《你不知道的CSS3圆角》这篇文章其中有比较详细的介绍。然而如果是在Less中直接写 “/” 可不行因为它会被认为是个除号而直接参与运算了。这时的解决方法就是使用 e(“/”) 来替代比如像下面这样：//Less代码.box{ border-radius: 5px e(\"/\") 10px;}//编译后的CSS代码.box{ border-radius: 5px / 10px;}三、Less中如何写循环？Less中的循环其实就像是其他编程语言中通常意义上的递归调用用法如下：.loop(@n, @i:1) when (@i <= @n){    // 此处仅为函数定义  .loop(@n,@i+1);}.loop(4);    // 此处为函数调用代表循环4次其中loop是方法名可以由自己喜好定义i 是循环因子n 是循环次数。比如想要给列表元素有规律地依次设置不同大小可以这样写：//Less代码.loop(@n, @i:1) when (@i <= @n){    // 此处仅为函数定义  li:nth-child(@{i}){     // 注意此处需用 {} 将 i 括起      width: @i*100px;      height: @i*100px;  }  .loop(@n,@i+1);}.loop(4);//HTML代码                这时四个 li 元素的宽高分别为 100、200、300和400。四、如何将一个数组中的元素全部赋值给另外一个数组？你可能会想这还不简单将 a 数组直接赋值给 b 数组不就行了吗？ 就像下面这样：var a = [1,2,3];var b = a;实际上通过这种方式赋值只不过是将 a 数组所在地址赋值给了 b如果 b 中元素改变其实也就改变了 a 元素那么该如何保证赋值操作之后改变 b 而不会影响 a 呢？其实这里就涉及到的深拷贝和浅拷贝的区别了。简单来说浅拷贝其实就是简单地对地址的赋值上面例子就是浅拷贝。而这里我们要说的是数组的深拷贝也就是开辟一个新的存储地址然后将 a 数组中的所有元素存入该新地址中最后将 b 指向该地址。具体实现其实非常简单：b = [].concat(a);我们知道JS数组方法中的concat()是用于合并两个数组的返回的是一个新的数组。以上是我在工作当中所遇到的一些问题总结在此与大家共勉！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                   微信小程序中做用户登录与登录态维护的实现详解                                                        原作者: 前端微站                   来自: 微信                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 使用LeanCloud(一)前端使用                                                      • 前端开发--微信小程序中页面代码中的模板封装                                                      • 前端浏览器缓存及代码部署                                                      • 微信小程序前端坑整理                                                      • 微信小程序：开发之前要知道的三件事                                                      • 浅谈微信小程序前端生态                                                      • 小程序常见问题汇总                                                                                               "},{"title": "微信小程序前端坑整理 ", "author": "                  Rolan                  2017-10-17 00:04                ", "text": "                                                                                                                                                                                     坑1、没有DOM无法使用熟悉的$查找、document.getElementById等等这些操作小程序取而代之的是数据绑定技术所谓的数据驱动就是数据改变之后视图展示跟着自己会变。DOM没了所以只好频繁的使用this.setData({})来操作页面属性。tip：在方法最初最好添加 var than = this; 使用than代替this否则方法内部函数的this会被替代。 坑2、图片问题除tapbar外背景图无法使用本地资源替代方式是使用base64资源或者外网加载。每个image标签底部有一条透明间隔非padding非margin。在图片前面做遮罩层时可能会被坑。 坑3、跳转小程序页面跳转打开最多五层超出五层不会跳转了所以大家要注意可以在跳转的时候关闭前一个页面。 坑4、wxml标签wxml的标签跟html里面的一些标签是一样的就说view标签就相当于div标签text标签相当于span标签吧然就是表单元素这里就要注意了在微信小程序中表单元素都是原生组件微信小程序中原生组件层级最高所以在用inputcanvasmap这些组件就要注意了。其中在样式上不支持overflow-x/overflow-y只可使用overflow。在input标签中会出现placeholder文字位置不固定可使用使用placeholder-class属性修改placeholder样式。input标签无法设置 font-family; 。对input直接float：left也是不行的要在input外面套view然后对其进行浮动。scroll-view组件注意事项：1、不要在scroll-view 中使用 textarea、map、canvas、video 组件2、scroll-into-view 的优先级高于 scroll-top。3、在滚动 scroll-view 时会阻止页面回弹所以在 scroll-view 中滚动是无法触发 onPullDownRefresh。在map组件中只能使用cover-view标签在cover-view标签下只能使用cover-view以及cover-image标签这两种标签在样式上的问题非常多不建议使用问题1、当使用display:none;做隐藏的时候其内容文字会出现在屏幕右上角建议使用 wx:if=\"false\"或position:absolute;left:-1000rpx;这种方式做隐藏。2、border不支持单边。3、不支持padding的使用在安卓端会出现padding消失的问题。 坑5、动画问题在小程序中当有两个元素同时发生变化时会出现冲突导致其中一个变化而另一个不做变化所以要使用setTimeout方法避免元素同时出现变化。 坑6、js问题js执行顺序在开发者工具中执行先执行aap.js然后执行其他js文件但在手机上app.js和其他js是同时执行的就比如说你在app.js里面向本地存储一个变量然后再去index.js里面取这个变量在开发者工具中是可以取到的但在手机上它会取不到的。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)日子如此难熬蒲公英的悠悠                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序支付c#后台实现               微信小程序上传头像                                                        原作者: unlimite                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序之新手填坑                                                      • 跳坑《一百七十六》蓝牙API使用指南                                                      • 微信小程序开发需要注意的30个坑                                                      • 微信支付遇到的坑                                                      • 微信小程序的一个坑: canvas 图表                                                      • 微信小程序填坑记录                                                      • 微信小程序开发之IOS/Android兼容坑                                                      • 前端开发常见问题精选（三）                                                      • 送给将要写小程序的你                                                      • 浅谈微信小程序前端生态                                                                                               "},{"title": "前端浏览器缓存及代码部署 ", "author": "                  Rolan                  2017-10-16 00:21                ", "text": "                                                                                                                                                                                     前言最近手上刚刚拆掉石膏去楼下房友帮忙。楼下房友领导来自阿里前端用的是阿里的ant-design设计将设计图上传到蓝湖聊天工具也采用阿里的钉钉。有时间我也多多去楼下房友交流学习多交流就会有提升。最近也比较忙好久没有更新博客了。闲言少叙今天主要谈谈前端性能优化之浏览器缓存。浏览器缓存我前面写过浏览器缓存的文章也写过html5离线缓存关于这些缓存我们很容易搞不清例如：200 OK (FROM MemoryCache、FROM DiskCache) 及 304 NOT MODIFIED 还有 application cache (离线缓存)等等。200 from memory cache 不访问服务器直接读缓存从内存中读取缓存。此时的数据时缓存到内存中的当kill进程后也就是浏览器关闭以后数据将不存在。但是这种方式只能缓存派生资源200 from disk cache 不访问服务器直接读缓存从磁盘中读取缓存当kill进程时数据还是存在。这种方式也只能缓存派生资源304 Not Modified 访问服务器发现数据没有更新服务器返回此状态码。然后从缓存中读取数据。三级缓存原理先去内存看如果有直接加载如果内存没有择取硬盘获取如果有直接加载如果硬盘也没有那么就进行网络请求加载到的资源缓存到硬盘和内存一般浏览图片如下流程：访问-> 200 -> 退出浏览器再进来-> 200(from disk cache) -> 刷新 -> 200(from memory cache)application cache和上面缓存有点区别是离线缓存就是资源可以从硬盘上读取而不用联网即使断网用户也可以浏览。设置浏览器缓存304是协商缓存还是要和服务器通信一次要想断绝服务器通信就要强制浏览器使用本地缓存（cache-control/expires）一般有如下几种方式设置浏览器缓存。1、通过HTTP的META设置expires和cache-control  http-equiv=\"Cache-Control\" content=\"max-age=7200\" />  http-equiv=\"Expires\" content=\"Sun Oct 15 2017 20:39:53 GMT+0800 (CST)\" />这样写的话仅对该网页有效对网页中的图片或其他请求无效。2、apache服务器配置图片cssjsflash的缓存这个主要通过服务器的配置来实现这个技术如果使用apache服务器的话可以使用mod_expires模块来实现：编译mod_expires模块：Cd  /root/httpd-2.2.3/modules/metadata/usr/local/apache/bin/apxs -i -a -c mod_expires.c //编译先打开httpd.conf文件然后查找expires这个模块找到后删除左边的#号表示打这个模块并重启apache服务器编辑httpd.conf配置：添加下面内容 mod_expires.c>ExpiresActive onExpiresDefault \"access plus 1 month\"ExpiresByType text/html \"access plus 1 months\"ExpiresByType text/css \"access plus 1 months\"ExpiresByType image/gif \"access plus 1 months\"ExpiresByType image/jpeg \"access plus 1 months\"ExpiresByType image/jpg \"access plus 1 months\"ExpiresByType image/png \"access plus 1 months\"EXpiresByType application/x-shockwave-flash \"access plus 1 months\"EXpiresByType application/x-javascript      \"access plus 1 months\"#ExpiresByType video/x-flv \"access plus 1 months\"3、php等设置php  header(\"Cache-Control: public\");  header(\"Pragma: cache\");  $offset = 30*60*60*24; // cache 1 month  $ExpStr = \"Expires: \".gmdate(\"D, d M Y H:i:s\", time() + $offset).\" GMT\";  header($ExpStr);?>或者$seconds_to_cache = 3600;$ts = gmdate(\"D, d M Y H:i:s\", time() + $seconds_to_cache) . \" GMT\";header(\"Expires: $ts\"); header(\"Pragma: cache\");header(\"Cache-Control: max-age=$seconds_to_cache\");缓存情况下前端代码部署问题一：有了缓存如何进行前端代码更新呢？我们可以在资源文件或者图片后面添加版本号如下图。问题二：但是所有文件都加了版本号之后我们只更改了一个文件其他文件的缓存不是浪费了吗？解决这个问题我们可以用 数据摘要要算法对文件求摘要信息摘要信息与文件内容一一对应。如下图：这样就解决了这个问题。问题三：新的问题又来了文件发布怎么办？1、先部署页面再部署资源：在二者部署的时间间隔内如果有用户访问页面就会在新的页面结构中加载旧的资源并且把这个旧版本的资源当做新版本缓存起来其结果就是：用户访问到了一个样式错乱的页面除非手动刷新否则在资源缓存过期之前页面会一直执行错误。2、先部署资源再部署页面：在部署时间间隔之内有旧版本资源本地缓存的用户访问网站由于请求的页面是旧版本的资源引用没有改变浏览器将直接使用本地缓存这种情况下页面展现正常；但没有本地缓存或者缓存过期的用户访问网站就会出现旧版本页面加载新版本资源的情况导致页面执行错误但当页面完成部署这部分用户再次访问页面又会恢复正常了。好的上面一坨分析想说的就是：先部署谁都不成！都会导致部署过程中发生页面错乱的问题。所以访问量不大的项目可以让研发同学苦逼一把等到半夜偷偷上线先上静态资源再部署页面看起来问题少一些。如何解决这些问题呢？这个问题起源于资源的 覆盖式发布用 待发布资源 覆盖 已发布资源就有这种问题。解决它也好办就是实现 非覆盖式发布如下图：看上图用文件的摘要信息来对资源文件进行重命名把摘要信息放到资源文件发布路径中这样内容有修改的资源就变成了一个新的文件发布到线上不会覆盖已有的资源文件。上线过程中先全量部署静态资源再灰度部署页面整个问题就比较完美的解决了。总结如下：1、 配置超长时间的本地缓存 —— 节省带宽提高性能2、采用内容摘要作为缓存更新依据 —— 精确的缓存控制3、 静态资源CDN部署 —— 优化网络请求4、更资源发布路径实现非覆盖式发布 —— 平滑升级                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 wepy wx.previewImage 封装               微信小程序开发问答《七十七》encryptedData解密 & canvas 设置opacity：0无效 ... .. ...                                                        原作者: haorooms                   来自: haorooms                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序自带缓存数据库使用                                                      • 微信小程序缓存--根据不同的id来进行设置和读取缓存                                                      • 微信小程序之数据缓存                                                      • 前端开发常见问题精选（三）                                                      • 微信小程序日常开发中常遇到的错误代码                                                      • 浅谈微信小程序前端生态                                                      • 微信小程序--缓存的二次开发封装                                                                                               "},{"title": "github精选：微信小程序入门简要教程 ", "author": "                  天下雪                  2016-12-6 15:06                ", "text": "                                                                                                                                                                                     本文作者tofuxb来自github文件类型.js ———— JavaScript文件.json —— 配置文件定义窗口颜色、字体颜色等.wxml —— Weixin Markdown language类似HTML.wxss —— Weixin Style Sheets类似CSS入口文件小程序根目录一般有三个文件：app.js、app.json、app.wxssapp.json必须要有这个文件！！否则IDE会报错！这是小程序的配置入口可对整个小程序进行全局配置包括页面路径、窗体表现、设置网络超时时间设置多tab等。// app.json{    \"pages\":[        \"pages/index/index\",        \"pages/logs/logs\"    ],    \"window\":{        \"backgroundTextStyle\": \"light\",        \"navigationBarBackgroundColor\": \"#fff\",        \"navigationBarTitleText\": \"WeChat\",        \"navigationBarTextStyle\": \"black\"    }}app.js必须要有这个文件！！否则IDE会报错！可用来声明全局变量监听并处理小程序生命周期函数。//app.jsApp({    onLaunch: function () {        //调用API从本地缓存中获取数据        var logs = wx.getStorageSync('logs') || []        logs.unshift(Date.now())        wx.setStorageSync('logs', logs)    },    getUserInfo:function(cb){        var that = this        if(this.globalData.userInfo){          typeof cb == \"function\" && cb(this.globalData.userInfo)        }else{            //调用登录接口            wx.login({                success: function () {                  wx.getUserInfo({                    success: function (res) {                      that.globalData.userInfo = res.userInfo                      typeof cb == \"function\" && cb(that.globalData.userInfo)                    }                  })                }            })        }    },    globalData:{        userInfo: null    }})app.wxss不是必须的用于定义全局样式。运行机制微信小程序背后运行的是一个MINA框架。这里做简单的描述其运行机制。在微信开发工具的console中输入openVendor()会打开文件夹其中包含以下四个文件：wcc、wcsc、WAService.js、WAWebview.jswcc 将wxml转化成一个generateFunc执行后可得到一个virtual_dom。wcsc 将wxss转化成cssWAService.js 提供service层大部分功能包含WeixinJSBridge、Reporter、wx、appServiceEngine等。WAWebview.js 提供view层大部分功能包含WeixinJSBridge、Reporter、wx、esparser等。对这块感兴趣的童鞋我找了一些相关文章：微信小程序架构分析 (上)微信小程序架构分析 (中)微信小程序架构分析 (下)逻辑层注册程序App() 函数用来注册一个小程序。接受一个 object 参数其指定小程序的生命周期函数等。object参数包含：onLaunch onShow onHidegetApp() 全局函数可获取到小程序实例。注册页面Page() 函数用来注册一个页面。接受一个 object 参数其指定页面的初始数据、生命周期函数、事件处理函数等。object参数包含：data onLoad onReady onShow onHide onUnload onPullDownRefreshonReachBottom生命周期：Page.prototype.setData()setData() 用于将数据从逻辑层发送到视图层并更改对应 this.data 的值参数格式接受一个对象以key和value的形式表示将this.data中的key对应的值改成value其中key可以非常灵活如 array[2].message, a.b.c。模块化目前不支持node_modules可以通过require(path)自行引入但要注意不能引入使用了window和document对象的模块。视图层WXML (Weixin Markup Language) 这部分比较简单可直接看官方文档。WXSS (Weixin Style Sheets) 官方文档注意事项：background-image 在模拟器中可使用相对路径中的图片但在真机中必须使用 外链图片 或者base64图片组件库在小程序中我们只能使用官方推出的标签组件目前大致分为 视图容器、基础内容、表单组件、操作反馈、导航、媒体组件、地图、画布。这里放点干货：view 类似div一样的盒模型不能识别 \\n 。navigator 导航支持相对路径和绝对路径最多存在5级页面。小程序中不能跳转到外部url默认是打开新页面如果要重定向需添加 redirect。image 与img最大区别在于小程序是通过background-image来实现的有默认高宽320*240不支持auto。此外提供了3中缩放模式和9中裁剪模式。详情点击官方文档API小程序提供了丰富的微信原生API如获取用户信息本地存储支付功能等。详情点击官方文档说明：* wx.on 开头的API是监听某个事件发生的接口接受一个CALLBACK函数作为参数。* 若无特殊约定其他API都是接受一个OBJECT作为参数可通过指定 success fail complete 来接收接口调用结果。此处为注意事项：wx.request 最多同时进行5个请求而且在真机调试中需要使用 https 协议并且域名需要在微信管理后台添加。这里有一个官方没说明的 坑 ：POST请求。POST请求需要添加header: { \"content-type\": \"application-x-www-form-urlencoded\" }并且data不能使用object的方式要自行转码为a=1&b=2。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序：tabbar未显示页面之间传参picker组件取值               微信小程序开发之——flex布局（附源码下载）                                                        原作者: tofuxb                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • github精选：构建自己的第一个小程序                                                                                               "},{"title": "从零入门系列《一》安装工具及项目的创建 ", "author": "                  天下雪                  2016-12-7 11:03                ", "text": "                                                                                                                                                                                                                                                                 本系列作者：loveDoDream_zzt为面向全新入门者而分享此处全新入门者是指对小程序毫无了解的同学；mac版安装和Windows版安装差不多, 现以mac版为例:一.下载工具包 下载地址:https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html?t=1474644089604二. 安装步骤步骤如图所示:1. 将下载好的工具包拖入Applications中2. 在应用程序中双击打开3. 微信扫码登录4. 选择类型,结束安装项目创建的步骤:(以mac版为例)1.在\"应用程序\"中,双击\"微信web开发者工具.app\", 如图:2. 选择类型3.点击\"+\"4.点击无AppID注:因为没有开发资格所以要选择无AppID假如需要appid可以参考此贴：个人无appid如何进行申请开发者权限简单操作步骤5.填写项目名称和项目目录注意两点:1.项目文件夹不能用中文;2.新建项目文件夹要建一个空的文件夹。6.新建之后的文件目录结构app.js------应用程序逻辑app.json------应用程序配置app.wxss------应用程序公共样式7. 添加hello world8.运行结果代码示例： 1 //app.js 2 App({ 3   onLaunch: function () { 4  5     //程序加载的时候添加 6     console.log('hello world') 7  8     //调用API从本地缓存中获取数据 9     var logs = wx.getStorageSync('logs') || []10     logs.unshift(Date.now())11     wx.setStorageSync('logs', logs)12   },13   getUserInfo:function(cb){14     var that = this15     if(this.globalData.userInfo){16       typeof cb == \"function\" && cb(this.globalData.userInfo)17     }else{18       //调用登录接口19       wx.login({20         success: function () {21           wx.getUserInfo({22             success: function (res) {23               that.globalData.userInfo = res.userInfo24               typeof cb == \"function\" && cb(that.globalData.userInfo)25             }26           })27         }28       })29     }30   },31   globalData:{32     userInfo:null33   }34 })                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序开发之——flex布局（附源码下载）               git精选：微信小程序新手跳坑指南21条                                                        原作者: loveDoDream_zzt                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序开发之formId使用（模板消息）、跨页面获取数据示例 ... ", "author": "                  Rolan                  2017-7-8 00:34                ", "text": "                                                                                                                                                                                     小程序的模板消息\" style=\"height: 35px; line-height: 1.5; color: rgb(255, 255, 255); padding: 0px 10px; border-radius: 3px; box-shadow: rgb(43, 62, 83) 3px 3px 5px; font-size: 22px; margin: 10px 20px 10px 0px; text-indent: 10px; background: rgb(128, 128, 128);\">基于微信小程序的模板消息官方文档基于微信的通知渠道我们为开发者提供了可以高效触达用户的模板消息能力以便实现服务的闭环并提供更佳的体验。模板推送位置：服务通知模板下发条件：用户本人在微信体系内与页面有交互行为后触发详见下发条件说明模板跳转能力：点击查看详情仅能跳转下发模板的该帐号的各个页面使用案例场景描述：前台获取 formId 送至后台由后台实现模板消息的发送。（此处由于 formId 只能由用户触发表单提交操作产生故前台需要将每次产生的formId发送至后台由后台保存并在适当时候调用微信接口向用户发送模板消息）代码实现：//example.wxml<form bindsubmit=\"submit\" report-submit='true' >  <button form-type=\"submit\" type=\"default\" size=\"mini\">提交</button></form>//example.jssubmit: function (e) {  console.log(e.detail.formId);}注意：因为我们是在开发者工具中测试所以得到的formId值为the formId is a mock one。在真机中我们可以得到一个具体的值利用该值结合其他参数就可以发送模板消息啦所以测试真实场景务必在真机中测试微信目前的限制是在如下两种情况下小程序才能够正常的使用模板消息：在小程序内使用了微信支付接口在小程序里用户点击了表单而且该表单的report-submit属性值为true时。index.wxml<navigator  class=\"navs\" url=\"{{urls}}\">    中国</navigator>index.jsPage({  data: {    urls:'/pages/lanbo/lanbo?title=我是Index里面的title数据'  }}) 要跳转的页面lanbo页面lanbo.wxml<text>pages/lanbo/lanbo.wxml</text>lanbo.jsPage({  data: {    },  onLoad: function (options) {    this.setData({      title:options.title    });    console.log(this.data.title);  }})跳转页面之后请在调试模式下中的console下查看数据。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序获取当前所在城市               微信小程序菜单实现                                                        原作者: @疯狂的迈步                   来自: 博客园                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 跟着小猪来做小程序开发：获取FormId                                                      • javascript/微信小程序中将String进行Base64编码并UTF-8格式输出                                                      • 微信小程序模板消息群发解决思路                                                      • 微信小程序简单收集formid无限次发送模板消息                                                                                               "},{"title": "基于 mpvue 框架的小程序选择组件，支持单列，多列，级联 ", "author": "                  Rolan                  2018-5-15 00:28                ", "text": "                                                                                                                                                                                     在 mpvue 开源之初写了 用 vue 写小程序基于 mpvue 框架重写 weui 。当时用的是小程序的原生组件没有对其进行封装和组件化。而对于现在的前端开发环境 组件化  模块化  工程化 以及 自动化 已经是一种标配。而 mpvue 框架又提供了一个很好的组件化开发平台因此就对小程序中的 picker 组件进行封装使其在用 mpvue 开发的时候能够用快速的实现 picker 的功能。为什么封装 picker 组件其实小程序提供了原生的 picker 组件但是在开发的时候会发现在 android 手机上看到的 picker 效果与 微信开发者工具 预览的效果不一样其实就是丑了一点点...在小程序中使用 picker 的地方很多很常见。使用安装npm install mpvue-picker --save 或者 cnpm install mpvue-picker --save在页面中使用<template>  <div class=\"mpvue-picer\">    <button @click=\"showPicker\">test for mpvuePicker</button>    <mpvue-picker ref=\"mpvuePicker\" :pickerValueArray=\"pickerValueArray\" :pickerValueDefault='pickerValueDefault' @pickerConfirm=\"pickerConfirm\"></mpvue-picker>  </div></template><script>import mpvuePicker from 'mpvue-picker';export default {  components: {    mpvuePicker  },  data() {    return {      pickerValueArray: ['住宿费', '礼品费', '活动费', '通讯费', '补助'],      pickerValueDefault: [1]    };  },  methods: {    showPicker() {      this.$refs.mpvuePicker.show();    },    pickerConfirm(e) {      console.log(e);    }  }};</script><style></style>初始化在父组件中调用 mpvuePicker 实例中的 show 方法即可。参数说明mode说明：picker 组件类型类型：String可选值：selector（单列）multiSelector（多列）multiLinkageSelector（级联）是否必填： 否默认值：selectorpickerValueArray说明：picker 渲染数据类型：Array可选值：-是否必填： 是默认值：-pickerValueDefault说明：picker 默认选中值类型：Array可选值：-是否必填： 否默认值：[]deepLength说明：几级联动类型：Number是否必填： 否默认值：2onChange说明：picer 组件滚动时回调返回选中的数组索引类型：EventHandle可选值：-是否必填： 否默认值：-onConfirm说明：picer 组件点击确定时回调返回选中的数组索引类型：EventHandle可选值：-是否必填： 否默认值：-效果相关数据结构说明单列pickerValueArray: ['住宿费', '礼品费', '活动费', '通讯费', '补助']多列pickerValueArray: [  ['中国', '美国', '日本', '俄罗斯'],  ['茶', '咖啡', '寿司', '奶酪'],  ['歼20', 'F22', '秋月级', 'T50']]点击展开二级联动数据结构pickerValueArray:[  {    label: '飞机票',    value: 0,    children: [{      label: '经济舱',      value: 1    },    {      label: '商务舱',      value: 2    }    ]  },  {    label: '火车票',    value: 1,    children: [{      label: '卧铺',      value: 1    },    {      label: '坐票',      value: 2    },    {      label: '站票',      value: 3    }    ]  },  {    label: '汽车票',    value: 3,    children: [{      label: '快班',      value: 1    },    {      label: '普通',      value: 2    }    ]  }]点击展开三级联动数据结构pickerValueArray:[  {    label: 'phone',    value: 0,    children: [      {        label: 'iphone',        value: 1,        children: [{          label: 'iphoneX',          value: 1        },        {          label: 'iphone8',          value: 2        }, {          label: 'iphone8 Plus',          value: 3        }]      },      {        label: 'android',        value: 1,        children: [          {            label: 'vivo',            value: 1          },          {            label: '魅族',            value: 2          }, {            label: '小米',            value: 3          }        ]      }    ]  },  {    label: 'PC',    value: 0,    children: [      {        label: 'mac',        value: 1,        children: [          {            label: 'macbook Pro',            value: 1          },          {            label: 'iMac',            value: 2          }, {            label: 'mackbook',            value: 3          }, {            label: 'mackbook air',            value: 3          }        ]      },      {        label: 'windows',        value: 1,        children: [          {            label: 'dell',            value: 1          },          {            label: 'surface',            value: 2          }, {            label: 'thinkpad',            value: 3          }        ]      }    ]  }]相关说明对于多级联动由于没有动态添加 picker 列数以及动态渲染其值因此目前只支持 二级联动和三级联动。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序利用Canvas绘制图片和竖排文字               只需两步获取任何微信小程序源码                                                        原作者:  KuangPF                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 在小程序、mpvue中使用flyio发起网络请求                                                      • 在小程序/mpvue中使用flyio发起网络请求                                                      • WeScale 技术篇 —— mpvue 与微信小程序的火花                                                      • 使用mpvue开发小程序通用能力封装                                                      • 记一次基于mpvue的小程序开发及上线实战                                                      • 基于mpvue的简单弹窗组件mptoast                                                      • 基于mpvue的小程序markdown适配解决方案                                                      • mpvue study                                                      • mpvue开发小程序所遇问题及h5转化方案                                                      • 适配mpvue平台的的微信小程序日历组件mpvue-calendar                                                      • 开发笔记：使用 mpvue 开发斗图小程序                                                      • 强烈推荐：绝对是最好的一个小程序开源框架                                                      • 小程序第三方框架对比 ( wepy / mpvue / taro )                                                                                               "},{"title": "基于mpvue的简单弹窗组件mptoast ", "author": "                  Rolan                  2018-4-23 00:34                ", "text": "                                                                                                                                                                                     介绍mptoast 是一个基于mpvue的简单弹窗组件 github地址：https://github.com/noahlam/mpvue-toast特性轻量 目前整个项目未打包前大概只有120行代码(包括注释)5kb左右(包括图标) 配置少 尝试过无数种优化方法只为减少配置 冗余少 每个页面（page）只需要引入一次该页面里面如果有多个子组件可以跟页面共用一个无需重复引入。 使用简单 除了必须的在page页面对组件import注册和html引入（这些麻烦的东西由于mpvue不支持的原因暂时无法做到优化）其他的使用只需一行简单的代码 this.$mptoast('提示消息‘)即可实现弹窗 可定制性强 提供用户重写样式的属性只需传入一个定义好的样式类名既可实现对原有样式的覆盖（具体请看参数说明） 安装1.安装vuex如果你项目还没使用的话。请放心虽然mptoast依赖vuex,你不会接触到任何有关vuex的代码。添加vuex只为让你写更少的代码。npm i vuex2.安装mptoastnpm i mptoast -D或者yarn add mptoast --dev3.在项目的主配置文件（一般位于src/main.js）加入以下代码import mpvueToastRegistry from 'mptoast'mpvueToastRegistry(Vue)4.在你需要弹窗的页面引入组件并注册然后在页面内加入一个你注册的组件就可以在js里面调用this.$mptoast()了 以下是一个简单的实例<template>  <div>    <-- 省略其他代码 -->    <mptoast />  </div></template><script>import mptoast from 'mptoast'export default {  components: {    mptoast  },  data () {    return {}  },  methods: {    showToast () {      this.$mptoast('我是提示信息')    },  }}</script>至于为什么没办法做到像vue组件那样引入一次就可以在所有页面使用我想我必须得解释以下因为mpvue目前还不支持全局的组件我尝试过很多种变通办法都行不通甚至为了让大家使用的时候少输入几个字少一些冗余我都做了很多尝试和优化目前mpvue团队已经在考虑新增全局组件功能我会时刻关注一旦支持我这边也立马做支持。参数说明参数分2种类型一种是多个参数另一个种则少只接收一个对象一 多个参数以下代码是一个多个参数调用的简单实例this.$mptoast('温馨提示', 'success', 2000)二 单个object对象object对象参数的功能其实跟上面多个参数的对应的功能是一样的只是写法不同而已我们直接看代码this.$mptoast({  text: '温馨提示',        // 显示文本  icon:'success'          // 图标类型  duration:  2000,        // 关闭时间  textClass: 'my-class'   // 样式类名  iconClass: 'icon-class' // 图标类名})需要注意的是以上参数如果传入错误的类型先会进行类型转换如果转换失败的可能会报错。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    记一次基于mpvue的小程序开发及上线实战               微信小程序全局状态管理并提供Vuex的开发体验                                                        原作者: noahlam                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 美团小程序框架mpvue(花名：没朋友)蹲坑指南                                                      • WeScale 技术篇 —— mpvue 与微信小程序的火花                                                      • 使用mpvue开发小程序通用能力封装                                                      • 记一次基于mpvue的小程序开发及上线实战                                                      • 微信小程序判断是否转发到群聊                                                      • 基于 mpvue 框架的小程序选择组件支持单列多列级联                                                      • mpvue study                                                      • 适配mpvue平台的的微信小程序日历组件mpvue-calendar                                                      • 开发笔记：使用 mpvue 开发斗图小程序                                                                                               "},{"title": "layout使用教程：小程序UI设计（1）-轻松布局 ", "author": "                  天下雪                  2016-12-1 18:00                ", "text": "                                                                                                                                                                                                                                                                 工欲善其事必先利其器。下面为大家介绍一款工具软件如何做到轻松布局。工具简介：小程序layout设计工具可视化方式进行小程序UI设计。通过鼠标拖拽组件方式进行UI布局。工具提供符合微信视觉统一的模板并且按照FlexBox方式可视化布局。自动生成wxml和wxss复制到微信开发者工具中即可同步显示。视频介绍请移步优酷http://v.youku.com/v_show/id_XMTgyNTQ4NDcyMA==.html我们平时开发工作中都会有这种情况发生为了能够完成一个布局css改了之后刷新页面不对再改css再刷新看效果。这样重复的工作不知道要做多少遍才能得到最终效果。现在方便了通过使用这款layout设计工具可以大大提高开发效率。小程序布局使用的是flexbox方式。这种方式在布局上有非常多的组合作为开发人员需要非常熟悉这些属性的做好布局。下面的是最常用的属性：justify-contentflex-startflex-endcenterspace-betweenspace-aroundalign-itemsflex-startflex-endcenterstretchalign-contentflex-startflex-endcenterspace-betweenspace-aroundstretch以上三个属性的组合是5*4*6结果是多少自己算吧。但是通过工具的使用只要通过属性设置面板的操作便可以做到所见即所得的效果。设置这些属性后工具中自动调整布局效果。无需我们修改代码-刷新效果-修改代码-刷新效果这样无为的循环了。设计之后wxml和wxss代码是自动生成的复制到微信开发者工具中即可看到一样的效果。你们计算出来组合结果了吗？由于组合较多这里我就不一一演示了。下面截图是几个例子。上图中是flexbox属性组合使用的示例。大家可以下载软件实际动手操作一下。下载链接在http://www.wxapp-union.com/forum.php?mod=viewthread&tid=845的正文中。大家可以根据下面的截图实际操练一下并请将设计结果截图跟帖吧。熟练掌握工具之后大家可以实际比较一下自己写wxml和wxss的时间和使用工具设计的时间。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            手机界面设计尺寸规范               新手布局福音！微信小程序使用flex的一些基础样式属性                                                        原作者: comeonliuqd                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序layout可视化设计工具介绍                                                                                               "},{"title": "微信小程序 canvas 绘图问题总结 ", "author": "                  Rolan                  2018-7-11 00:06                ", "text": "                                                                                                                                                                                     业务中碰到微信小程序需要生成海报进行朋友圈分享这个是非常常见的功能没想到实际操作的时候花了整整一天一夜才搞好微信的 canvas 绘图实在是太难用了官方快点优化一下吧。业务非常简单只需要将用到的图片文案素材拼装到一张图片保存到本地就可以了。首先创建画布将一张网上的图片画到画布上。const ctx = wx.createCanvasContext('shareCanvas');ctx.drawImage(\"https://img3.doubanio.com/view/photo/l/public/p2327709524.jpg\", 0, 0, 300, 400);ctx.draw();复制代码网络图片这时候出现一个问题：在模拟器上没有报错可是真机测试却什么也没画出来。网上搜索一阵发现微信小程序的 canvas.drawImage 是不支持网络图片的只支持本地图片。所以任何的网络图片都需要先缓存到本地再通过 drawImage 调用存储的本地资源进行绘制缓存可以通过 wx.getImageInfo 和 wx.downloadFile 实现这次选用了 wx.getImageInfo, wx.downloadFile 没有试过不知道可不可以。wx.getImageInfo({  src: 'https://img3.doubanio.com/view/photo/l/public/p2327709524.jpg',  success: function (res) {    console.log(res.width)    console.log(res.path)  }})复制代码这个方法可以拿到存储的本地图片地址长宽以及一些简单的图形变化将本地缓存的图片地址保存到全局变量或者缓存供 wx.drawImage 调用。还有一点需要注意的是 draw 方法是异步的如果图片还没加载成功有可能画出来的是空的所以 draw 方法通常都会带有定时器这样的回调。ctx.draw(true,setTimeout(function(){    wx.canvasToTempFilePath({        canvasId: 'shareCanvas',        success: function(res){            that.data.tmpPath = res.tempFilePath        },    })},1000));复制代码图片保存的授权问题绘图后通过 1 秒的延时将画好的新图片保存到本地然后通过 wx.saveImageToPhotosAlbum() 保存到手机相册。这一步存在授权问题需要考虑拒绝授权后的兼容性也就是如果用户拒接授权以后怎么办？常见的做法是先通过 wx.getSetting() 获取用户的权限设置如果用户拒绝了访问相册的权限可以跳转到授权设置页面要求用户更改授权信息。小程序的授权设置 api 已经弃用了现在只能通过组件形式将 button 的 open-type 属性设置成 openSetting自动跳转到设置页面总体来说没有之前方便了。如果页面本来已经有 button可以先将 open-type 属性设成 null当遇到需要跳转的逻辑再通过 setData 设置这样处理非常复杂很容易出错但是可以节省页面或者跳转；另一种处理方式是当没有授权时先跳转到说明页面说明需要授权的信息在这个页面上添加一个 open-type 的button点击以后跳转到设置页面这次我们采用的是第一种方法：文字编辑换行下一步是文字编辑的问题微信画文字是不支持自动换行的所以只能手动计算每一行能够容纳的文字个数进行手动换行比如一个文字加间距占 10 px一行整体可以使用 100 px那就是每行只能容纳 10 个字第 11 个字另起一行开始画。将文字分割成 10 个字的数组：function canvasWorkBreak(maxWidth, fontSize, text) {  const maxLength = maxWidth / fontSize  const textLength = text.length  let textRowArr = []  let tmp = 0  while (1) {    textRowArr.push(text.substr(tmp, maxLength))    tmp += maxLength    if (tmp >= textLength) {      return textRowArr    }  }}复制代码将数组一行一行画到画布上：var height = 200for (let item of ['我的舍利佛','搜房法拉']) {    if (item !== 'a') {        ctx.setFontSize(16);        ctx.setFillStyle(\"#484a3d\");        ctx.fillText(item, 20, height);        height += 50;    }}复制代码多图绘制把每一种元素画完以后整个海报制作的流程就已经跑通了但并不代表在实际业务中就可以使用了。首先面对的是海报生成的质量问题假设我们的手机像素是 320 * 400 的如果要将图片展示在手机上用于预览只有两种选择：画一个分辨率小于手机分辨率的海报让手机能完整的展示出来。但是这样的海报由于分辨率小下载到手机相册分享用大屏手机观看的时候就非常影响体验了。这种做法的解决方案可以是画 2 张图手机预览时隐藏大图只显示小图；下载的时候将大图保存起来。画一张大图直接通过 previewImage 进入手机预览模式预览模式的图片可以直接保存到本地。这种方案的缺点在于预览模式无法设计 UI且下载的时候不能自定义文案由于下载保存的入口很隐蔽用户不一定能发现。图片太长怎么办？上面的图实际上是比较长的你可以截取一部分显示出来这样图片看起来就会更协调。在通过正常比例绘制完图片以后可以通过填充矩形的方式覆盖一部分图片然后在矩形上输入其他的内容这样图片的一部分就被隐藏起来了。按钮置于最上层由于 canvas 是优先级最高的总是会覆盖页面上的其他内容所以「保存图片」的按钮可能会被覆盖掉而显示不出来可以通过在 button 上套一层 cover-view 来解决。总结图片绘制本来应该是一个非常简单也非常成熟的技术其他的框架都会有对应的组件来处理这些事情可是微信小程序的 canvas 绘制可以用「非常难用」来形容希望微信团队能尽快优化。你可以点击「阅读原文」获取源码。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序上传一张或多张图片到阿里云OSS               扫码付小程序优化实践                                                        原作者: 和牛                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序canvas绘制坐标图                                                      • 微信小程序canvas尺寸设置                                                      • 微信小程序 canvas 雪花效果 闪动星星效果                                                      • 小程序利用Canvas绘制图片和竖排文字                                                      • 微信小程序利用canvas生成海报分享图片                                                      • 猫眼小程序如何发展起来并留存用户？                                                      • 小程序开发技巧总结                                                      • 微信小程序：漫画小程序项目总结                                                      • 微信小程序 canvas区间滑动选取                                                      • JDC | 京东设计中心--小程序实战总结                                                      • Canvas绘图在微信小程序中的应用:生成个性化海报                                                                                               "},{"title": "小程序“三国杀”：百度向左，微信、支付宝向右 ", "author": "                  Rolan                  2018-7-13 00:08                ", "text": "                                                                                                                                                                                     图片来源@视觉中国只用了不到一周齐车大圣 CTO 孙熙就带领团队做出了一款百度智能小程序。技术层面上开发一款百度小程序并无太大难度“在微信小程序上改几行代码就能跑起来”。不过结合手机百度的平台特性孙熙作为第一批吃螃蟹的人还是在样式调整与 AI 能力的接入上花了些功夫。6月初这款名为“齐车大圣查违章”的小程序在百度 APP 内上线当用户搜索“违章”等类似关键词时首个搜索结果便会出现违章查询、缴费等功能入口再次点击后即可调用齐车大圣的查违章小程序。一个月后百度AI开发者大会举行百度副总裁沈抖正式发布了百度智能小程序并宣布携程、苏宁易购、唯品会、优信二手车、齐车大圣等上百家企业成为首批接入百度小程序生态的合作伙伴。携程、苏宁易购、唯品会、齐车大圣等上百家企业成为首批接入百度小程序生态的合作伙伴根据沈抖介绍百度小程序将成为业界首个开放的小程序生态。这种开放体现在“一端开发多端运行”即在百度小程序平台开发后既可以在百度系 App（百度App、百度贴吧、百度网盘等）运行也可以加载在外部App（哔哩哔哩、58同城等）上。更具诱惑力的是 百度将开放出自身平台流量导入小程序的开发者生态。“DAU （日活跃用户）在一个月内增长了370%。” 齐车大圣在上述公布了查违章小程序的活跃数据。孙熙向钛媒体透露“齐车大圣在微信、支付宝均开发过小程序但百度小程序的活跃度要比在其他平台的小程序高出200%。”当然这一数据与百度平台的流量分配机制关系密切。流量还是流量2017年1月微信之父张小龙发布了微信小程序；同年9月支付宝小程序宣布公测作为这个市场的后进者百度小程序该如何吸引开发者？答案自然是“入口和流量”。在小程序入口的设置上微信也经过了一段试错期。由于初期入口过深用户难以触达微信小程序在发布的前半年曾在活跃度上遭遇瓶颈；此后微信不断延伸入口新增公众号跳转、下拉页面、搜一搜等超过60个入口。同理支付宝也在 App 内为小程序铺设了35个入口以更快激活小程序生态。有了先行者们的前车之鉴 百度在小程序的诞生初期就毫不吝惜地将其百度 APP 的1.5亿日活主动导流给开发者。 孙熙就为钛媒体展示了百度为齐车大圣查违章小程序提供的多个入口包括：1、首页“我的”、“常用服务”一栏中有“查违章”的单独入口。2、用户搜索“违章”等近似关键词会在搜索页面显示。3、对于使用过查违章小程序的用户一旦有了新的违章信息会在百度 APP 的信息流中显示提醒页面。4、对于使用过查违章小程序的用户一旦有了新的违章信息百度 APP 会使用弹窗提醒用户。百度为齐车大圣查违章小程序提供的多个入口包括搜索页面、信息流与 App推送除此以外百度小程序在打开方式上有着微信、支付宝不具备的跳转能力： 未来百度小程序可经由网页链接直接调取；同时支持微信好友、朋友圈转发 （目前微信内分享百度小程序仍需跳转至百度 APP 才能打开百度正对该打开方式进行优化）。目前百度小程序以定向邀请码的形式从各垂直品类选出适合的开发者。但据百度官方透露到今年12月百度小程序会彻底实现开源这意味着开发者使用一套开发语言推出的小程序可以同时在百度 APP、B 站、携程等多个平台运行。举一个跨平台小程序的使用场景：当一款外卖类百度小程序接入 Bilibili后用户在 B 站看视频累了可以直接调用该百度小程序叫外卖而不用再单独唤起一个外卖 APP。相比微信、支付宝小程序在各自体系内的发展百度小程序尤其注重对外部生态及合作伙伴的开放这与它在小程序战场上对自身短板的认知有关。单从流量来说根据最新公开数据：百度 APP 日活用户为1.5亿支付宝全球年度活跃用户为8.7亿（支付宝尚未公布过日活/月活指标）；微信全球月活跃用户则超过10亿尽管数据单位不同但在用户基数与活跃度上百度 APP 确实略逊于微信与支付宝。在 PC 时代百度曾凭借搜索成为门户时代的流量霸主但当社交与支付给了对手新时代的船票原本分散在网站的流量涌入一个又一个 APP 这种割裂的生态让百度始终在移动端缺乏一个爆发式的增长点。百度小程序就承载了百度 APP 在移动互联时代的野心。“微信小程序做了非常好的探索但没有解决互联网生态割裂的现状。互联网的流量只集中在这几个大的路径上是不够的 当我们用开放的小程序与合作伙伴共同打开入口后流量才会再次流动起来。 ”沈抖对钛媒体说。在沈抖看来百度小程序的开放将会为百度 APP 与开发者带来双赢：一方面开发者将得到百度 APP 以外的更多入口与触达机会；另一方面百度也将借由小程序的展现形式渗透进合作伙伴的 APP以重现门户时代百度搜索“无处不在”的应用图景。5年前的“轻应用”和今天的“小程序”百度小程序产品是不是似曾相识？早在2013年 时任百度副总裁李明远曾推出“轻应用” 。在当年的百度世界大会中李明远曾列举出轻应用的四个特点：1、无需下载即搜即用；2、可被搜索与智能分发；3、享有原生 APP 体验；4、提供订阅推送沉淀用户。——几乎与五年后我们看到的百度“小程序”并无二致。2013年时任百度副总裁李明远推出“轻应用”不过“轻应用”的推出有些生不逢时。外部环境中Html 5 语言与 4G 网络在当时尚未成熟移动端流量处在井喷前夜轻应用的活跃度并未达到预期；内部来看轻应用主打的“即用即走”与当时百度刚刚收购的 “91手机助手”在分发模式上产生冲突这让李明远对下一代移动互联网产品的探索步履维艰。2016年李明远黯然离开百度轻应用也随之沉寂。如今新一轮的尝试则交由被李彦宏寄予厚望的“百度内容生态部门”。内容生态部的由来是百度在2017年合并了原本分散的搜索与内容体系。目前内容生态部的业务包括百度 APP、信息流（好看视频、百家号）、百度浏览器等由2012年加入百度的副总裁沈抖负责。该部门隶属于百度高级副总裁向海龙分管的搜索公司。与轻应用的处境艰险截然相反百度小程序犹如含着金汤匙出生。据《财经》报道 内容生态事业部在百度享有极高的优先级沈抖本人也是百度当红的高管之一。 在 百度前总裁兼COO 陆奇离职 之前沈抖曾直接向陆奇汇报李彦宏也会亲自过问。百度副总裁沈抖在公开场合李彦宏也不止一次表达过他对信息流业务的重视。今年1月当被问及为何从未亲口表态“All in AI”时李彦宏曾这样表示：“我说话还是倾向于留有余地我不希望说出百度 All  in  AI 的时候指的是百度所有资源都去做无人车、度秘了其实不是的 我们大多数的资源可能还是在百度搜索、百度的信息流。”相比仍需持续投入的无人驾驶、AI 音箱搜索与信息流业务在百度属于“现金牛”。今年4月27日百度发布2018财年Q1未经审计财报第一财季总营收为人民币209亿元（约合33.3亿美元）其中“百度核心”（Baidu Core即搜索服务与交易服务的组合）总营收为人民币161亿元（约合25.7亿美元）同比增长26％在总营收中所占比例为达到了77%。这一系列的因果也最终反馈在百度小程序的产品模式上—— 相比微信、支付宝小程序对中心化入口、广告接入的克制百度小程序有着更为明确的商业化形态。7月5日百度 AI 开发者大会“智能小程序”分会场在沈抖的开场陈述环节过后百度商品推广部总经理丁灿彪紧接着登场对百度小程序与携程、苏宁等合作伙伴的案例进行展示具体的手段包括：搜索广告直接跳转小程序；增加下拉菜单页；以及线下影院、贩卖机等百度聚屏入口。“百度小程序会帮广告主把流量接入所有生态链的合作伙伴这将极大提高百度现有的流量转化也增加了可采买流量的范围。”沈抖对钛媒体说。简而言之 百度小程序在产品形态的开放完全可以替代现有的移动端 H5 、App Store 跳转等展示型广告这无疑为百度 APP 的上的广告主提供了更具效率的转化模式。“从搜索广告到百度网盟线上流量变现是百度的优势小程序比单纯的信息流广告有了更好的触达这就提升了百度体系内流量的广告溢价。”爱卡汽车高级副总裁崔岷告诉钛媒体。可以预见的是“小程序型”的移动端广告将成为企业在百度生态内投放的首选这也成为百度小程序在上线初期就能撬动上百家企业合作的有力杠杆。另一方面小程序也让移动端的广告与服务边界变得更加模糊。以携程为例其上线的火车票智能小程序不仅呈现在用户主动搜索入口当用户查看诸如“迪士尼”之类的关键词时百度 APP 会通过信息流推送迪士尼的相关介绍文章并将携程的订票小程序内嵌在文章页面这让火车票智能小程序的订单转化率在20天内提升了44%。下一个“拼多多”？微信、支付宝、百度三家小程序有着截然不同的生态特征。微信小程序讲究产品克制同时在“构建生态”与“重塑规则”中不断寻求平衡。以电商场景为例小程序电商平台 See 的 CEO 万旭成曾在接受钛媒体采访 时表示微信希望用小程序社交电商的方式把万千个微信群、公众号、聊天页面像毛细血管一样连接起来。这符合腾讯去中心化的坚持也让微信生态得以诞生“拼多多”这样的独角兽。2017年1月“微信之父”张小龙发布微信小程序。支付宝小程序追求行业纵深 迄今为止支付宝一直未对个人开发者开放小程序接入资格。不过 结合蚂蚁金服的集团优势支付宝小程序在信用免押、生活服务等工具型小程序领域不断深耕。 有消息人士对钛媒体透露近期支付宝小程序在集团内的战略地位有所上升未来将与支付宝“行业频道”、“生活号”等内容进一步打通。百度小程序则走上另外一条路。在以广告分发逻辑撬动 B 端合作伙伴后百度所寻求的绝对开源让市场上的开发者蠢蠢欲动——凭借巨头的流量红利是否会有诞生下一个“拼多多”的可能？从场景来看微信的强社交属性让其小程序生态以文娱游戏、拼团电商为主支付宝则有着显著的金融服务标签而百度似乎并未带有明确的场景指向。这将赋予了百度小程序野蛮生长的可能性。以搜索起家的百度解决的是用户对于信息的获取需求而信息本身的无边界也让百度具备连接商品（电商）；连接服务（工具）；连接用户（社区）等多种可能性。而小程序较低的开发成本、开放的流量、多种用户触达手段……每一项都是创业者刚需的要素。另外百度的 AI 能力也成为开发者选择百度小程序的原因。根据崔岷透露类似爱卡汽车等垂直内容社区在用户规模达到一定阶段后难免会遭遇涉黄等不良信息而百度在内容审核层面的语义识别技术、以及语音、视觉、自然语言处理等 AI 能力部分已封装完成由开发者直接调用。可这是否意味着百度即将成为创业者“淘金”的下一阵地？“ 百度的问题在于没有社交关系链。 广告可以撬动用户使用第一次但很难再次留住用户这就无法沉淀流量。”险峰长青投资经理杜暮雨对钛媒体说。杜暮雨曾主导了险峰长青对社群电商“好衣库”的天使轮投资。另外百度的账号体系相对薄弱即使百度小程序能支持网页链接跳转与微信好友转发但仍然无法复制微信内的社交场景。“社交场景是留住用户的核心比如我为什么要使用一款名片类小程序不是因为它是记录信息的工具而是因为社交。”杜暮雨说。相比2017年张小龙公布微信小程序后的百家争鸣多数人对如今的百度小程序依然处于观望状态钛媒体也向多位创投机构负责人询问小程序的投资机会但大多以“不了解”、“没关注”的回复为主。不过肯定的是对于百度与开发者来说“小程序”势必会成为百度在移动端探索中浓墨重彩的一笔至于这个生态能否诞生下一个“拼多多”式的机会没人能给出答案。 （本文首发钛媒体采访/苏建勋作者/苏建勋）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序研究报告：3大趋势揭示小程序的边界（附排行榜） ...               突发！微信放大招开放50个小程序超级入口                                                        原作者:  钛媒体                   来自:  钛媒体                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序浅析                                                      • 猫眼小程序如何发展起来并留存用户？                                                      • 小程序广告组件全量开放                                                      • 微信小程序的下一步：支持 NPM、小程序云、可视化编程、支持分包 ... ...                                                      • 微信小程序研究报告：3大趋势揭示小程序的边界（附排行榜） ...                                                      • 谷歌“猜画小歌”入驻微信小程序折射 Google AI 入局中国的野心 ...                                                      • 微信小程序再推iOS虚拟支付整改方案我们给开发者总结3条有效应对措施 ...                                                                                               "},{"title": "小程序—九宫格心形拼图效果 ", "author": "                  Rolan                  2018-8-2 00:28                ", "text": "                                                                                                                                                                                     前几天在朋友圈看到好几次这种图片。这种图片是用九张图片拼成的一个心形。感觉很有趣就上网查了查怎么做大部分的说法就是用美图秀秀的拼图功能来做 在微信小程序中也有专门做心形拼图的小程序我都试了试之后感觉还可以更加简单一些于是我就自己做了个小程序。实现小程序的思路1、有两个 canvas一个小的 canvas 显示最后会是什么样子一个大的 canvas 用来最后进行截图生成图片保存到相册。通过CSS的定位把大的 canvas 移到屏幕外面不让用户看到就可以了。而如果用小的canvas 保存图片的话最后的图片有些模糊。2、canvas 可以看成一个 9 * 9 的网格用一个叫 heart 的数组来表示就是这样的。用其中的小格子来拼出心形根据数组的内容在 canvas 上进行渲染。小程序的功能这个小程序有 选择单张图片选择多张图片补充图片保存图片重置推荐意见反馈这几个功能。选择单张图片当用户点击心形区域的时候就可以选择单张图片调用wx.chooseImage 就可以从本地相册选择图片然后就把这张图画在 canvas上具体画的位置就是用户点击的位置。在小的 canvas上绑定touchend 事件触发事件后事件中有一个changedTouches 属性这是一个保存了当前变化的触摸点信息的数组这个数组中的元素有 x 和 y 属性也就是触摸点距离 canvas 左上角的距离。// 触摸点在 x 轴的值var x = e.changedTouches[0].x;// 触摸点在 y 轴的值var y = e.changedTouches[0].y;复制代码有 x 轴 和 y 轴的距离后算出具体应该画在哪个格子上。//grid 表示一个格子的宽度// 确定 x 轴是在第几个格子x = Math.floor(x / grid);// 确定 y 轴是在第几个格子y = Math.floor(y / grid);复制代码知道在哪个格子画之后就要确定画图片的哪部分了因为所有的格子都是正方形的但是用户选择的图片不一定是正方形如果压缩成正方形会很难看所以我画的时候选择了正中间的部分来画通过wx.getImageInfo 来获取图片信息以短边为正方形的宽然后从 （长边 - 短边）/2 的地方来画。// 获取图片的宽和高var width = res.width;var height = res.height;//  如果图片不是正方形只画中间的部分// sWidth 表示正方形的宽var sWidth = width > height ? height : width;// sx 是源图像的矩形选择框的左上角 X 坐标var sx = 0;// sy 是源图像的矩形选择框的左上角 y 坐标var sy = 0;if (width > height) {\tsx = (width - height) / 2;}if (width < height) {\tsy = (height - width) / 2;}复制代码知道画什么在哪里画之后调用 canvasContext.drawImage 来画就可以了。选择多张图片选择多张图片同样是调用wx.chooseImage 方法成功选择多张图片后返回的对象中有一个tempFilePaths 属性这个属性保存了图片的本地文件路径列表。然后遍历 heart 数组也就是保存心形数据的数组如果数组中某个元素的值是1也就是说在心形范围内就按顺序从 tempFilePaths 中取一张图片画上去画的时候同样的如果不是正方形就只画中间的部分。补充图片在 image 的文件中有保存几张图片用来补充心形他们的路径保存在一个数组中。// 用来补充心形的图片 images: [   '../../images/1.jpg',   '../../images/2.jpg',   '../../images/3.jpg',   '../../images/4.jpg',   '../../images/5.jpg',   '../../images/6.jpg',   '../../images/7.jpg',   '../../images/8.jpg',   '../../images/9.jpg',   '../../images/10.jpg', ]复制代码然后就是遍历 heart 数组如果数组的某个元素的值是1就随机从这组图片中选择一张画上去。画一张图片画多张图片补充图片他们都是在 canvas 上画图片为了避免已经画了图片的位置被覆盖他们所画的图片的等级是不同的。补充图片：1画多张图片：2画一张图片：3复制代码等级高的可以覆盖等级低的等级低的不能覆盖等级高的同等级的除了画多张图片的不能覆盖其余的两种情况都可以覆盖。简单意思就是： 补充图片补充完了之后再补充会把原来补充的覆盖掉但是用户选择的图片不会被覆盖掉。画多张图片可以覆盖掉补充的图片但用户选择的图片也不会覆盖掉。画一张图片不管这个位置有没有图片都会再画一张。保存图片保存图片的时候就是按顺序对大的 canvas 进行截取然后保存成图片主要靠 wx.canvasToTempFilePath 这个API来实现这个 API 可以把当前画布指定区域的内容导出生成指定大小的图片并返回文件路径。这里要注意几个细节1、为了避免最后保存的图片有黑色背景最好开始的时候就在 canvas 上画一个 和 canvas 大小一样的矩形矩形填充上颜色。2、为了保存的图片在用户的相册中也能保持心形。需要按下面这个顺序来保存图片3、 wx.canvasToTempFilePath 中有两个选填的参数 destWidth 和 destHeight这个两个参数决定 输出图片宽度和高度如果不是准确的知道是多少用默认值就可以。destWidth 和 destHeight 单位是物理像素（pixel）canvas 绘制的时候用的是逻辑像素（物理像素=逻辑像素 * density）所以这里如果只是使用 canvas 中的 width 和 height（逻辑像素）作为输出图片的长宽的话生成的图片 width 和 height 实际上是缩放了到 canvas 的 1 / density 大小了所以就显得比较模糊了。而默认值是 width * 屏幕像素密度文档中提到的屏幕像素密度应该不是指每英寸屏幕所拥有的像素数而是指设备像素比（pixelRatio）也就是用多少个物理像素去显示 1px 的 CSS 像素。 用APIwx.getSystemInfo 可以查看设备像素比wx.getSystemInfo({  success: function(res) {    console.log(res.pixelRatio)  }})复制代码这里如果我的理解有误还请知道的小伙伴指出。说了这么多主要就是想说用默认的值其实就已经很清晰了。4、因为要保存9张图片所以需要一些时间这个时候就需要一个进度条了保存图片的时候显示进度条禁用保存按钮毕竟点击一下按钮就是9张图片所以这个时候还是禁用了好每保存一张图片进度条的值就 +12 超过100的时候就表示 9张图片都保存好了。而微信小程序中也刚好有 进度条（progress）这个组件 。重置这个功能就是遍历 heart 数组用一种颜色根据数组内容把心形画出来。然后再在 x 轴 和 y 轴上画两条线行成九宫格的样子。推荐 和 意见反馈<button open-type='share'>推荐给朋友</button> <button open-type='feedback'>意见反馈复制代码这个两个功能就是用了微信小程序的button 组件这里需要注意的就是在清除 button 的默认样式时需要把 button 的 after 伪元素的边框也去掉。button::after{  border: 0; }复制代码可以优化的地方有一些地方是小程序在替用户做选择比如如果所选择的图片不是正方形就画中间的部分但是中间的部分不一定是用户想要的而如果每张图片都要用户自己来选择画哪部分一共81张图片显然是有些麻烦了这里还可以继续优化下。还有在补充图片的时候补充的图片也不一定是用户喜欢的所以这部分再考虑是不是可以加一些标签用户选择不同的标签来补充符合标签的图片类似 QQ音乐的歌词海报这样。总结这次做的这个九宫格心形拼图的小程序第一版已经上线了。开源地址： github.com/FEWY/jigsaw如果你喜欢这个小程序的话可以 star 支持一下。这个小程序不管在代码还是功能上都还有许多地方可以继续优化如果有需要的朋友可以直接拿去改。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)lyqlyq开发小白                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    撸一个小程序前置授权组件               小程序打包插件开发体验                                                        原作者:  FEWY                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 canvas 雪花效果 闪动星星效果                                                      • 小程序效果--星星评价（网页通用）                                                      • 微信小程序仿APP section header 悬停效果                                                      • 微信小程序--旋转木马/缩放轮播图效果                                                                                               "},{"title": "微信小程序—跳一跳，Android游戏助手(外挂)使用教程 ", "author": "                  Rolan                  2018-1-5 00:39                ", "text": "                                                                                                                                                                                     作为一名有着丰富实战经验的Android开发人员作为一个有着一定基础和实战的逆向新司机第一次面对github上的这个项目自己也是懵的即使看完了README,也还是不知道从何下手。在此之前玩游戏从未使用过游戏助手之类的。那么我在想作为小半个专业选手尚且这样广大小白又能比我好到哪里去呢？ 以前我也曾经是个单纯的好骚年啊！后来经过仔细阅读README加上摸索和查看源码才慢慢走上正途；下面记录一下以备你查看：成果图片说明：本人排行第二记得我自己才跳了昨天一百七十多分大多数都是在临近的几次跳跃是挂掉的。今天使用游戏助手后成绩涨了好几倍。答疑解惑： github排行别人刷到一万多分你才几千分 ？ 原因是：微信出了新防外挂举措随机检测屏幕按压是模拟按压还是真实按压模拟按压将不能上传成绩。答疑解惑： 那么我是怎么把成绩上传的呢？ 原因是：所谓道高一尺魔高一丈微信有张良计我有过墙梯：我在每次模拟按压结束时迅速进行一次精简的真实按压意图盖过模拟按压检测,最后我成功了。具体操作将在经验中分享。原理原理部分是针对同行或者有兴趣的朋友了解一下不需要可以跳过直接进行实战哦。 该游戏助手主要通过adb 命令来截图和模拟按压。截图的目的有两个：一个是确定手机分辨率然后确定估算跳跃距离和按压时长之间的比例关系；第二个作用是用来识别起跳点和目标点所在的xy坐标用来计算距离。模拟按压的目的就不多说了。 更专业更具体的写法和算法请移步github或者查看源码。例如：实战第一步 下载：点击Clone or Download 选择Download ZIP然后解压如下图：Android目录是核心目录：功能jar包（build包下）和源码文件（src包下）。 Samples和README.md则是一些示例图片和说明文字可以忽略。第二步 搭建运行环境：该游戏助手需要在电脑上运行需要将手机通过USB连接到电脑。由于该助手是用Java写的所以需要下载JDK配置Java运行环境。（十分简单不会可以自行百度。）该助手通过adb命令实现的截图和模拟按压所以请自行百度adb.exe下载后放置在前面解压缩的Android/build/libs文件夹内。第三步 开始尝试运行Android.jar 使用USB将手机连接到电脑手机要打开开发者选项允许USB调试（具体自行百度）； 按住WIN+R输入cmd 按回车命令行工具cmd 使用cd命令打开Android/build/libs文件夹命令如下：cd 后面的具体路径以自己电脑上的路径为准； 按回车继续输入命令：java -jar Android.jar 按回车：可能出现三种情况： 第一种 ：恭喜你你可以打开跳一跳小程序就看着他自动在跳到了靶心注意不要误碰屏幕边缘哦。不过别高兴太早等你看着分数跳到理想分数时你轻触屏幕结束比赛却发现微信提示你成绩无法上传之类的等于你白等了这半天不过别急还记得前面说过的快速原地跳一下后面有点个人经验可以看下。第二种：出现弹窗提示缺少AdbWinApi.dll文件； 请自行百度下载文件64位操作系统放置在c://Windows/SysWOW64文件夹里32位操作系统放置在C://Windows/System32文件夹下即可。第三种：出现在执行adb截图命令失败； 原因是adb没有检测到有手机连接或者缺少相关驱动程序请自行百度使用adb连接手机主要是驱动---端口号被占---数据线等问题遇到这种问题不要急躁多试几次或者先放下过几个小时再试亦或者开关机重启等耐心点总会有结果的。经验这里的经验主要是针对躲避模拟按压检测的原地跳一下的问题：要敏捷---在跳跃到目的地的一瞬间原地跳一下或者近距离跳一下因为要赶在截图计算距离之前完成本地跳动不然计算后的距离错误导致跳空等事故；看情况---因为模拟按压检测的位置是随机的这是个概率事件所以建议你每次都原地跳一下但是也要看情况有时已经在边缘就不要跳了 我的经验是跳到中心的时候原地跳一下因为跳到中心游戏会有提示音以及波纹特效可以很明显的把握看住机会；及时调整---发现连续几次都跳不到中心的时候建议放任让他自己跳等跳到中心的时候再原地跳；忽略音乐盒井盖等加分停留果断进行原地跳---个人觉得这几个地方是检测的高危区域（未看源码）用连续中心加分来弥补这些停留的加分。其他经验自己在实际中总结哦！尾声配置过程中的问题尽量百度哦！会用百度也是一种能力！ 游戏而已建议开发人员还是查看源码学习一下。非专业人士勿要沉迷游戏！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)313731418                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    腾讯云独家详解小程序多人视频通话               动手搭建第一个小程序音视频Demo                                                        原作者: JACK1484986596654                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序跳一跳的游戏辅助实现                                                      • 一次不成功的深度学习实践 - 微信跳一跳                                                      • 揭密微信跳一跳小游戏那些外挂                                                      • 微信小程序之二：元宵灯笼连连看小游戏                                                      • 玩Android微信小程序版                                                                                               "},{"title": "Android\"挂逼\"修练之行--微信小程序逆向辅助插件工具开发详解 ... ", "author": "                  Rolan                  2018-5-10 11:35                ", "text": "                                                                                                                                                                                     一、前言之前一篇文章已经详细介绍了 微信小程序包的格式 在之前文章中也了解到小程序包存放在沙盒目录但是微信为了让小程序包安全就对文件名做了一个处理导致我们很难找到对应的小程序对应的包文件所以本文就来开发一个辅助插件可以查看微信小程序的appid以及快速找到对应的小程序包文件然后利用之前的解析工具直接本地解析程序包即可下面就开始我们的表演吧！二、添加小程序菜单首先第一步还是国际惯例我们如果想暂时小程序的一些信息包括appid版本号本地存放路径文件名等那么如何在微信页面中展示呢？首先来看一下小程序的页面：然后我们就开始找到这个布局菜单添加我们想要的菜单信息了这个找入口有很多方式比如可以通过字符串信息反编译之后去找对应的id值或者是利用ui工具直接查看id信息这里我就用这种方式：看到了id是c8p然后去反编译微信之后在values/public.xml中查找这个值记得是type=id,name=c8p这一项哦：找到之后把id值转化成十进制然后去Jadx中搜索吧这里要注意我也说了很多遍了微信做了拆包操作而且微信包很大直接用Jadx打开微信会卡死的所以需要解压依次打开它的所有dex文件即可然后就是挨个dex中搜这个值即可：然后继续查找：查看引用的地方：点击进去查看定义：然后就来到这个类用的是RecyclerView控件了这个类应该就是操作初始化底部菜单的地方了我们需要找到这个控件的adapter查看如何添加菜单的因为拆包导致这个类被分的很开而这个类有很多内部类所以我们依次在每个dex中查找这个包下的这个类以及他的内部类最终在这个地方看到：这里就要对android应用开发有点熟练了应用开发都用过RecyclerView控件他的adapter编写格式都是统一的这里看到及时混淆了一看大致逻辑就清楚了。不过可惜的是这个地方有个很大的坑害得我浪费很多时间：我一直在g类中找a这个方法但是找了好几遍都没找到结果在smali代码中找到了：所以说没有一个工具是万能的千万别相信任何一个工具。被坑残了。然后我们看到返回值其实是g类的局部变量qWf类型是com.tencent.mm.ui.base.n可以直接搜这个类看看：看到这里就明白了这个是微信内部的统一菜单类有一个菜单子选项的列表然后继续回去看g类的那个变量qWf：看看他在哪里初始化的：点击进行查看：好了在这里初始化的所以我们就可以进行hook操作了：hook操作就不多解释了很简单了结合反射即可：注意这里的菜单内容先不要关心后面会介绍如何获取小程序的appid和版本号以及保存路径的然后运行模块查看添加的菜单信息：好了到这里我们就把这三个菜单添加好了第一个菜单是为了查看小程序的appid和版本号信息点击可以复制第二菜单是小程序包的保存路径点击可以复制路径。第三个是解析小程序包源码。主要借助之前介绍的解析小程序包工具。三、获取小程序的相关信息那么下面继续来看如何获取小程序包的appid和版本号信息以及本地保存的文件路径入口也很操作用ui工具查看当前布局即可不过这里我在介绍新的技巧就是用adb shell dumpsys activity top命令查看view结构：我们知道WX内部的所有WebView都是自己开发的x5内核而小程序加载肯定得用WebView的所以从这找到突破口然后去Jadx找这个u类而且在之前分析过了微信小程序的功能都在com.tencent.mm.plugin.appbrand这个包下面的：看到这个类果然是继承微信的内部统一WebView然后无意中发现这个类中有appid字段了为什么我们会按照这思路去找appid呢？因为小程序入口在webview加载的那么肯定在这个地方用到了appid了所以我们的思路没有问题的继续查看这个字段的使用：看到这个地方在构造一个webview需要加载的url信息看到appid参与其中了还有一个字段其实这个就是小程序的版本号后面我们会看到。我们可以先hook这个方法看看appid是否能获取到：这里做了一个处理就是把appid分离出来以及版本号然后保存到全局变量中用于菜单显示使用我们运行模块看看运行结果：我们知道小程序的appid都是wx开头的这里可以看到的确拿到了appid值那么第二个到底是不是版本号呢？后面会说先来看看如何获取小程序包路径信息这里我们这么操作因为我们在之前已经知道了小程序包都是放在这个目录下：/data/data/com.tencent.mm/MicroMsg/4d0238658a35658e7bc9597a2de4d49e/appbrand/pkg/ 我们全局搜索wxapkg看看这个文件名是如何定义的：找到这个地方格式和我们看到的很类似这样我们直接hook这个方法看看返回值路径是什么以及传入的参数是啥：运行模块查看结果：看到这里发现第一个参数就是小程序appid第二个参数很有可能就是版本号返回的路径也是上面我们知道的那么有的同学好奇了这里直接hook然后保存一下路径不就可以了吗？其实我们在hook发现这个方法只有首次加载程序包会调用。但是我们想要的效果是每次打开小程序点击菜单都能看到。如果保存很不方便。所以这里我们直接用appid和版本号进行构造构造方式如下：小程序appid字符串的hashCode值和版本号即可。有了之前的固定路径那么就可以了。下面再来看一下这个参数到底是不是版本号呢？查看这个ae方法的调用地方：这里通过字段名称就可以看到就是版本号了。所以到这里我们就把小程序的appid版本号路径构造方法获取到了下面操作就简单了。需要hook上面继承webview类的u类的aeN方法即可然后通过分解获取到appid和版本号上面已经运行有结果了这里不在演示了：看到这个方法是每次打开小程序都会调用我们只要做个简单判断有appid和版本号就保存到全局变量。然后在打开菜单的时候把这两个信息放到菜单中然后在利用这两个字段构造出本地小程序包的路径放在第二菜单中。最后一个菜单就是解析小程序了。这里我们的操作很简单了先把沙盒中的wxapkg拷贝到SD卡下的指定目录然后在借助之前写的解析小程序包工具直接解析即可。四、添加菜单点击事件下面还有一个问题就是菜单的点击事件这个我们还是要回到之前的g类中以及内部类中进行查看最终找到这个类因为g类和内部类不是很多按个找dex很快就定位到了：然后我们拦截这个onItemClick方法处理0,1,2这三个我们添加的菜单点击事件即可：这样我们就处理了三个菜单选项的点击事件了菜单名称使用之前hook成功的appid值路径构造是appid值和版本号即可主要说一下最后的解析工作：先把wxapkg包从沙盒中拷贝到SD卡的指定目录中然后传入路径开始执行我之前写的解析小程序包的工具即可。严重声明本文的意图只有一个就是通过分析app学习更多的逆向技术如果有人利用本文知识和技术进行非法操作进行牟利带来的任何法律责任都将由操作者本人承担和本文作者无任何关系最终还是希望大家能够秉着学习的心态阅读此文。 鉴于安全问题样本和源码都去编码美丽小密圈自取！微信扫一扫进入小密圈：五、总结好了到这里我们就把整个工具插件写完了我们主要分为三部分：第一部分：添加菜单用于展示小程序的信息包括appid版本号本地程序包路径。第二部分：通过分析获取到小程序的appid版本号信息保存用于第一步的菜单内容展示。第三部分：添加子菜单的点击事件路径和appid点击就是赋值信息。解析小程序包直接调用之前的工具即可。而在这三部分的突破口都是利用界面View分析获取到的有两种方式：一种是借助UI分析工具一种是利用adb命令；两种方式都是可以操作使用的。下面来看看我们操作的效果吧：复制路径和appid值解析程序包到本地到这里我们就完成了本次操作大家可以看到这个插件对于小白用户没啥用途但是对于我们后续的逆向操作非常有用的我们如果想逆向哪个小程序直接解压看源码即可。也可以拷贝到电脑上进行分析更方便了。其实每次写微信插件都很费劲的原因就在于微信包太大了导致电脑非常的卡。所以写个插件不容易喜欢的就点个赞分享吧！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序radio点选框再次点击取消               小程序•小故事——获取用户信息                                                        原作者: 尼古拉斯_赵四                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序开发十问                                                      • 模块化高效开发微信小程序——汽车试驾                                                      • 小程序如何获取群聊的openGid以及名称                                                      • 小程序打包插件开发体验                                                      • 玩Android微信小程序版                                                                                               "},{"title": "微信小程序--TabBar不出现 ", "author": "                  Rolan                  2018-1-9 00:22                ", "text": "                                                                                                                                                                                     今天打算开始实战一个微信小程序项目一开始就踩坑了正确设置了TabBar但是TabBar就是不能显示出来后面才找到原因这里记录下：app.json正确代码：{  \"pages\":[    \"pages/index/index\",     \"pages/leader/leader\",        \"pages/leader/stories/stories\",     \"pages/leader/authors/authors\",     \"pages/stack/stack\",    \"pages/stack/booklist/booklist\",     \"pages/stack/booklist/bookdetail/bookdetail\",    \"pages/bookdesk/bookdesk\",     \"pages/mine/mine\",    \"pages/mine/news/news\",        \"pages/logs/logs\"   ],  \"window\":{    \"backgroundTextStyle\":\"light\",    \"navigationBarBackgroundColor\": \"#fff\",    \"navigationBarTitleText\": \"网易蜗牛读书\",    \"navigationBarTextStyle\":\"black\"  },  \"tabBar\":{    \"color\":\"#999999\",    \"selectedColor\":\"#444444\",    \"backgroungColor\":\"#ffffff\",    \"borderStyle\":\"#e0e0e0\",    \"list\": [      {        \"pagePath\":\"pages/leader/leader\",        \"iconPath\": \"assets/icons/lingdu.png\",        \"selectedIconPath\": \"assets/icons/lingdu_sel.png\",        \"text\":\"领读\"      },      {        \"pagePath\":\"pages/stack/stack\",        \"iconPath\": \"assets/icons/stack.png\",        \"selectedIconPath\": \"assets/icons/stack_sel.png\",        \"text\":\"分类\"      },      {        \"pagePath\": \"pages/bookdesk/bookdesk\",        \"iconPath\": \"assets/icons/bookdesk.png\",        \"selectedIconPath\": \"assets/icons/bookdesk_sel.png\",        \"text\":\"书桌\"      },      {        \"pagePath\":\"pages/mine/mine\",        \"iconPath\": \"assets/icons/mine.png\",        \"selectedIconPath\": \"assets/icons/mine_sel.png\",        \"text\":\"我的\"      }    ]  }}这里注意显示解决有两种方式：1.pages里的首个页面必须在list数组里有配置所以在lists数组里加一个字典对象即可。{        \"pagePath\":\"pages/index/index\",        \"iconPath\": \"assets/icons/index.png\",        \"selectedIconPath\": \"assets/icons/index_sel.png\",        \"text\":\"首页\" }但是我的TabBar又不想有这个item显示这里看第二种解决办法。2.pages数组的第一项必须是tabBar的list数组的一员：这里有个疑惑：百度了解决方法显示将list数组加了index的模块item后面不想要index模块在TabBar显示然后又删除再运行问题就解决了也没有设置pages数组的第一项必须是tabBar的list数组的一员。解决了就好知道的大神可以留言告诉我哟！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)w　测试87w枪79                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    动手搭建第一个小程序音视频Demo               微信小程序中的分享事件                                                        原作者: 玉思盈蝶                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序tabBar不生效                                                      • 微信小程序：完成一个tabbar+下拉刷新组件需要经历什么坑                                                      • 微信小程序跳转tabBar携带参数怎么办？                                                      • 小程序中tabBar的使用心得                                                      • 小程序tabBar跳转页面并隐藏tabBar                                                      • 微信小程序自定义tab多层tab嵌套实现                                                      • 小程序tabbar这套方案全搞定！                                                                                               "},{"title": "小程序浅析 ", "author": "                  Rolan                  2018-7-10 00:10                ", "text": "                                                                                                                                                                                     一、小程序VS APP1、什么是小程序2017年1月9日0点微信小程序正式上线。那么小程序是什么呢？小程序即运行在微信上的一款功能性软件或者应用。用户无需下载无需安装无需卸载；用户扫一扫或者搜一搜就可以找到应用方便快捷即用即走；开发成本低；传播渠道成熟迅捷。2、小程序VS app1、页面布局（可设计、不可设计区域）二、小程序设计规范小程序内的所有页面右上角都会放置小程序官方菜单样式如图；在设计抑或开发中都要尽量避免在此位置放置交互性元素或其它设计需要为小程序官方菜单留出位置以避免交互上的bug。2、小程序菜单官方深浅配色方案小程序官方菜单有两套配色方案设计或开发时可根据设计风格进行选择；小程序不再像微网站那么死板状态栏和菜单栏可根据设计风格而改变不再是必须为微信的top形态给与设计和开发更为广阔的发展空间。同时给与商家更好的展示自身品牌的效应。3、启动页启动页是展示品牌形象的重要页面之一小程序的启动页是官方制定的样式布局不可更改无需开发者开发。页面由品牌logo+品牌名称+加载状态 组成页面简单明了既体现了小程序这一平台的统一性又很好的突出了品牌形象。4、页面下拉加载样式微信小程序官方提供了深浅两套下拉加载样式无需开发者开发加载反馈在页面开发过程中不可避免的会被用到；在页面加载等待时开发者应尽量给与一些简单的加载小动画以免用户误以为页面被卡死；加载时间也不宜过长会引发用户的焦躁感；加载动画不宜五花八门做到尽量统一。几个常见的加赞模式：页面内加载、模态加载（附着于整个页面的加载样式目的不明确易使用户焦灼）、局部加载、全局加载。  举例说明：5、微信小程序官方发布控件三、小程序设计注意事项1、导航明确来去自如在设计页面时要即时告知用户所在位置并让用户知道接下来可以去到哪里怎么回到上一步；微信小程序没有对导航栏的样式进行限制设计师可根据自身小程序的需要自行设计建议每个页面都有回到上一级的操作。2、减少等待反馈及时页面加载时间不宜过长时间不可控时要及时给出反馈避免引起用户的焦躁情绪；加载异常时为避免用户迷茫应及时给出提示告诉客户原因并给出解决办法以便用户找到退路。例：3、轻量简洁统一稳定小程序不同于APP小程序应该遵循化繁为简保留并突出主要功能能舍弃的尽量舍弃最大化的使产品轻量化；整个小程序产品要时刻注意不同页面之间的风格、交互的统一性和延续性统一的页面体验以及具有延续性的元素都能很好的减少用户的学习负担会使整个小程序简洁优雅更容易留住用户。现在很多APP都有做小程序大多对比很明显小程序保留主要功能显得更加轻量简洁例如美团最明显的变化就是底部菜单由五个精简为三个并不影响用户的主流需求。转载时请注明出处及相应链接本文永久地址：https://blog.yayuanzi.com/24328.html                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    轻应用开发的\"下半场\"会是一场鸡肋反击战吗？                                                                       原作者: IT985博客                   来自: IT985博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 猫眼小程序如何发展起来并留存用户？                                                      • 小程序“三国杀”：百度向左微信、支付宝向右                                                                                               "},{"title": "实战案例-- 用Java编写基础小程序 ", "author": "                  Rolan                  2017-8-19 00:22                ", "text": "                                                                                                                                                                                     如果是刚接触或者刚学习Java练习一些基础的算法还是必须的可以提升思维和语法的使用。1、输出两个int数中的最大值import java.util.Scanner;  public class demo {      public static void main(String[] args) {          Scanner scanner = new Scanner(System.in);          System.out.println(\"请依次输入两个整数：a,b（以空格隔开）\");          /*比较两个数的大小*/          int a = scanner.nextInt();          int b = scanner.nextInt();          int max;          if(a >= b){              max = a;          }else {              max = b;          }          System.out.println(\"最大值为\"+max);          }      }  } 2、输出三个int数中的最大值package demo;  import java.util.Scanner;  public class demo {      public static void main(String[] args) {          Scanner scanner = new Scanner(System.in);          System.out.println(\"请依次输入两个整数：a,b（以空格隔开）\");           int a = scanner.nextInt();          int b = scanner.nextInt();          int c = scanner.nextInt();          scanner.close();          /*方法一*/          int d=(a>b)?a:b;          int e=(d>c)?d:c;          System.out.println(\"最大值为\"+e);          /*方法二*/          if(a>b && a>c){              System.out.println(\"最大值为\"+a);          }else if(b>c && b>a){              System.out.赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    Flex 实现表格布局 （微信小程序）               微信小程序商品详情页交互源码（选择商品类型切换、预览商品图片） ...                                                        原作者: Wendy-lxq                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • Java 微信公众号菜单关联小程序                                                      • Java 后台 实现小程序支付                                                      • java微信小程序参数二维码生成带背景图加字体(无限生成)                                                      • javascript/微信小程序中将String进行Base64编码并UTF-8格式输出                                                      • 微信小程序 java服务端记                                                      • 微信小程序加密数据解密的java实现                                                      • POI微信小程序实战                                                      • 解决微信小程序 wx.request 请求的并发数限制、不支持异步问题 ...                                                      • 微信小程序实战--成语接龙小程序                                                      • 微信小程序实战--王者图鉴                                                      • java实现微信小程序登录态维护                                                      • 微信小程序基础                                                                                                                                                   1 条回复                                                                                     DEde                              2017-8-21 20:46                                       多谢！    回复                                                               \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                        推荐教程开发小程序折叠面板2020-02-16小程序对文件及后缀名解析2020-02-16小程序后端 egg 框架开发记录2020-02-16           最新Demo同城小程序代码2020-01-09汽车养护2020-01-07微信答题小程序仿头脑王者源码2020-01-02微信小程序图书共享借阅全套模板2019-12-10行政后勤服务小程序2019-11-28微信小程序--蓝牙控制音乐播放小车2019-11-15微信小程序--颜色选择器2019-11-13求小程序源码2019-11-04微信小程序--垃圾分类小程序2019-10-25            jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092513|92cfdc2aa5759611f4c64600cdd2642d|2';\t\t\t\t\t\t"},{"title": "小程序如何像vue操作一样在动态绑定类名？ ", "author": "                  Rolan                  2018-4-16 00:37                ", "text": "                                                                                                                                                                                     小程序开发中遇到这样一个问题... 排行榜开发的时候前三名的样式不同其余的样式一样。但是都是通过同一元素来遍历的,当时卡了一下。后来发现有module模块化这一概念,于是查了下api一下子就做出来了。就是不同名次上边的样式根据实际情况展示效果。模块化我们可以将一些公共的代码抽离成为一个单独的 js 文件作为一个模块。模块只有通过 module.exports 或者 exports 才能对外暴露接口。 通俗的将就是自身独立作用域只作用于该模块与js互不影响。主要代码module部分 <wxs module=\"rank\">            var indexof = function(index){                switch(index){                    case 0:                        return 'first-price';                        break;                    case 1:                         return 'second-price';                        break;                    case 2:                         return 'third-price';                        break;                }            };            module.exports.style = indexof;        </wxs>view <view class=\"weui-badge {{rank.style(index)}}\">{{index + 1}}</view>有什么好的方法或者问题都可以互相交流哦~ 喜欢的点个赞哦~                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 弧线效果实现               小程序--前端AES加密                                                        原作者: Jerry_lxb                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 在 mpvue 使用 echarts 小程序组件                                                      • 记一次mpvue-loader源码探究                                                      • Mpvue 小程序转 Web 实践总结                                                      • 在小程序、mpvue中使用flyio发起网络请求                                                      • 使用mpvue开发小程序通用能力封装                                                                                               "},{"title": "小程序常见问题汇总 ", "author": "                  Rolan                  2017-11-27 00:08                ", "text": "                                                                                                                                                                                     1.微信小程序规定页面路径最多只能是五层当进入第五层页面之后wx.navigateTo将不能正常打开新页面。请避免多层级的交互方式或者使用如下方式解决：（1）wx.navigateBack({  delta: 2})关闭当前页面返回上一页面或多级页面delta--返回的页面层数（2）wx.reLaunch({  url: 'index?id=1'})关闭所有页面打开到应用内的某个页面。（3）wx.redirectTo({  url: 'test?id=1'})使用redirectTo代替navigateTo（关闭当前页面跳转到应用内的某个页面） 注：tab定义过的页面跳转只能用wx.switchTab跳转wx.navigateTo等跳转无效2.tabBar图标必须是相对路径3.防止重复提交和打开多个页面的方法：（1）定义一个data来作为判断依据如　　bindtap=\"{{(isConfirmBuy==0)?'':'confirmBuy'}}\"（此方法仅针对多次点击按钮事件表单重复提交无效）（2）根据点击事件的时间戳来判断如function bindViewTap(e) {//该方法针对快速点击多次跳转多次引起的BUGvar time = e.timeStamp;//console.log(time+\"---\"+app.globalData.lastTapTime+\"---\"+Math.abs(time-app.globalData.lastTapTime))//设置无效点击根据自己的需求设置这里navigateTo切换页面到动画结束需要的时间为500毫秒左右if (Math.abs(time - app.globalData.lastTapTime) < 500 && app.globalData.lastTapTime != 0) {//app.globalData.lastTapTime = time; //这里一定更新无效点击的时间return false;}else{app.globalData.lastTapTime = time;return true;}//更新有效点击的时间}//定义公共方法var bvt = common.bindViewTap(e);if(!bvt) return false;//事件最开始调用（推荐）4.赋值写法：this.setData({ 'status':false }); 有效         this.data.status= true 无效5.注意将上传下载网络请求等接口地址设置白名单。6.小程序onLaunch里面异步取值导致首页onload取值取不到的问题方案：（1）做个启动页过度 （2）把下面的方法放到异步请求成功后的success里面if (getCurrentPages().length != 0) {  getCurrentPages()[getCurrentPages().length - 1].onLoad()}7.小程序之间的跳转问题：（https://mp.weixin.qq.com/debug/wxadoc/dev/api/navigateToMiniProgram.html）（1）相互跳转的小程序必须关联同一个公众号（2）小程序跳转需通过extraData传值和取值可通过App.onShow()获取App.onLaunch()获取好像拿不到。8.理论上只有表单提交和支付场景下可以发送模板消息（表单提交场景下为 submit 事件带上的 formId；支付场景下为本次支付的 prepay_id）（1）支付当用户在小程序内完成过支付行为可允许开发者向用户在7天内推送有限条数的模板消息（1次支付可下发3条多次支付下发条数独立互相不影响）（2）提交表单当用户在小程序内发生过提交表单行为且该表单声明为要发模板消息的开发者需要向用户提供服务时可允许开发者向用户在7天内推送有限条数的模板消息（1次提交表单可下发1条多次提交下发条数独立相互不影响）实际应用时可以通过模拟表单提交获取多个formId再保存下来这样7天之内就可以随时给用户发送模板消息以实现批量发送的效果。如：<form bindsubmit=\"goOrderList\" report-submit=\"true\"><button class=\"list\" data-za-title=\"我的订单\" formType=\"submit\" hover-class=\"none\">我的订单</button></form>9.map、canvas、video、textarea 是由客户端创建的原生组件原生组件的层级是最高的所以页面中的其他组件无论设置 z-index 为多少都无法盖在原生组件上。 原生组件暂时还无法放在 scroll-view 上也无法对原生组件设置 css 动画10.微信小程序showToast都是带icon的如果需要不带icon的toast需要自己封装11.wx.showModal微信自带对话框content不支持html类型数据仅支持txt支持\\n\\r所以扩展性不好。(复杂情况下推荐自己写)12.连续快速点击input获取焦点后马上点击按钮input不会失去焦点键盘不会收起应用场景如发送验证码。13.微信小程序授权问题：如果拒绝授权短时间内微信不会重新调起授权框让用户重新授权。处理方案：1.判断用户授权操作如果拒绝弹出确认框提示用户“将无法正常使用小程序建议删除小程序重新进入或者手动授权是否手动授权？”用户点击确定跳到设置界面手动授权用户点击取消跳到取消授权页面（需开发）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    黄秀杰--Node后端优雅使用Bmob               微信小程序开发问答《八十》实现 sticky header 效果 & input标签中文字被遮盖 ...                                                        原作者: 名字好难起                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发问答《六十八》处理订单多人同时支付问题 & thirdScriptError TypeErro ...                                                      • 微信小程序开发问答《七十三》登录相关问题 & 上传logo返回后不能同步 ... ...                                                      • 关于小程序swiper的问题                                                      • 微信小程序开发问答《七十五》调试界面鼠标指针消失问题 & 图片资源路径 ...                                                      • 前端开发常见问题精选（三）                                                      • 小程序支付常见问题解答                                                      • 微信小程序开发调试常见问题&解决                                                                                               "},{"title": "微信小程序开发之IOS/Android兼容坑 ", "author": "                  Rolan                  2017-9-20 00:39                ", "text": "                                                                                                                                                                                     一、时间转换问题：这不只是小程序上面的问题是ios系统 都有这个问题就是new  Date(\"2017-06-16\") 在IOS会出现NAN的情况所以对于时间转换需要另行封装解决方案如下1.替换”-“为”/“2.删除”.“后面的字符串（带毫秒也会有问题）代码如下： /**     * 字符串转换为时间     * @param  {String} src 字符串     */    strToDate(dateObj){      dateObj = dateObj.replace(/T/g, ' ').replace(/\\.[\\d]{3}Z/, '').replace(/(-)/g, '/')      dateObj = dateObj.slice(0, dateObj.indexOf(\".\"))     return new Date(dateObj)    } 二、fixed定位问题整个页面的fixed定位在ios下下拉会触发下拉事件但是没有动画效果。Android就能正常运行flex中使用 绝对定位ios出现严重错位导致父级元素也会变成绝对定位Android能达到理想效果总而言之 尽量不用fixed三、absolute定位问题1.使用absolute定位并且宽带设置了100% 并且设置了padding就会导致屏幕宽度溢出出现页面左右可以移动的bug模拟器上是没有问题但是真机上是有这个问题的。这个问题让我调试并痛苦了许久2.使用absolute并且当前元素是flex容器这种情况在Ios下面布局不会起到左右会出现所有元素转换成了absloute并且文字错位3.总而言之 尽量不用 absolute四、 word-spacing在button中的问题有时候在使用大按钮的时候两个字中间希望有段间距但是目前没有找到能使用的占位符所以使用了的word-spacing加空格 这个方法来设置文字的间距但是在iPhone6s 上两个字中间一个空格的时候整体会向右偏必须设置两个空格才正常！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发问答《七十四》Math.js如何引入 &  表单无法提交 ...               微信小程序循环以及嵌套循环的总结                                                        原作者: hiphopC                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 官方问答精选《十》小程序支持SVGstring.startsWith不兼容android ... ...                                                      • 微信小程序兼容性问题                                                      • 微信小程序小总结：解析xml问题解析html问题兼容Promise和Generator ...                                                      • 微信小程序 收货地址API 兼容低版本                                                      • 微信小程序语音录制和播放的一些坑ios 和 android 的 布局兼容问题 ...                                                      • 支付宝也入局 小程序成了巨头的新战场                                                      • iOS开发做微信小程序学习小结（一）                                                      • JABrea--从iOS的世界初探微信小程序开发遇的坑与喜(持续更新...) ...                                                      • 微信小程序前端坑整理                                                      • 微信小程序通过java后台传的ID值进入不同页面                                                      • 从iOS的世界初探微信小程序开发时收集的坑(持续更新...)                                                      • 玩Android微信小程序版                                                      • 微信小程序开发如何优雅地兼容                                                                                               "},{"title": "微信小程序填坑记录 ", "author": "                  Rolan                  2017-9-7 00:08                ", "text": "                                                                                                                                                                                     在wxml文件中使用text标签时内容不能与标题对齐的问题  <view class=\"mod t-sign-time\">          <text>商品条码</text>          <text class=\"value\">          67882932222222222</text>  </view>微信编译器识别到text中含有空行导致。修改如下:  <view class=\"mod t-sign-time\">          <text>商品条码</text>          <text class=\"value\">67882932222222222r33ddfdfdfdf</text> </view>文本无法居中当设置display为inline-block时遇到文本内容设置text-align: center始终无法居中的问题。虽然设置display: flex可以解决文本居中的问题但整体View上的多个控件布局会乱。最后设置line-height: 31px;解决问题。(其中31px为该视图控件的                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)guo52798                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发--页面传值               微信小程序的Web API接口设计及常见接口实现                                                        原作者: XibHe                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序跳坑记：uploadFile:fail与一键登录之无法识别json数据 ...                                                      • 跳坑指南《七十》如何让微信小程序服务类目审核通过                                                      • 跳坑指南《七十一》微信小程序真机预览跟本地不同的问题                                                      • 跳坑《四十七》微信小程序支付（微信支付签名错误）                                                      • 新手跳坑-微信小程序判断显示与不显示 wx:if=\"false\"                                                      • 跳坑《九十》带参数二维码相关知识（带参二维码）                                                      • 跳坑《一百二十三》微信支付（微信小程序支付）                                                      • 跳坑《一百八十六》支付签名校验失败                                                      • 跳坑《一百七十六》蓝牙API使用指南                                                      • 微信小程序前端坑整理                                                      • 微信小程序爬坑日记                                                                                               "},{"title": "小程序自带缓存数据库使用 ", "author": "                  Rolan                  2017-5-15 00:51                ", "text": "                                                                                                                                                                                     小程序之所以能有优秀流畅的表现另一方面是依托微信宿主从网络层面保证充足的带宽和速度响应要知道当年为了对抗MSN。QQ单点突破对网络基础设置到技术架构做了众多的优化才有了后来腾讯云、微信这样快速崛起的Big Thing。//将数据存储在本地缓存中指定的 key 中                            wx.setStorage(OBJECT)wx.setStorageSync(KEY,DATA)//从本地缓存中异步获取指定 key 对应的内容wx.getStorage(OBJECT)wx.getStorageSync(KEY)//异步获取当前storage的相关信息wx.getStorageInfo(OBJECT)wx.getStorageInfoSync()//success返回的内容中有keys(Array)\\currentSize(Number)\\limitSize(Number),//分别表示当前缓存中key、占用的空间大小、限制的空间大小//从本地缓存中异步移除指定 key wx.removeStorage(OBJECT)wx.removeStorageSync(KEY)//清理本地数据缓存。wx.clearStorage()wx.clearStorageSync()小程序缓存可以理解为NOSQL的数据库类似Memcached\\Redis这样的数据库官方的要求是本地最多10MB,对于产品初始化数据的加载已经足够了。对于不同的小程序采用了沙盒机制别的小程序不会访问到你的小程序当然你也不能访问到别人的小程序。上面API列表组中提供的函数组中第一个函数所以对应的OBJECT参数中都可以带success、fail、complete函数第二行是同步函数都不需要带这些参数在使用的过程中要注意尤其是要做网络请求之前需要获取本地的身份信息。最好是用同步方法避免空值传递。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序联盟荣誉出品：微信小程序开发实战宝典               微信小程序使用第三方库报错的问题                                                        原作者: 李华栋                   来自: 文章来源                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 前端浏览器缓存及代码部署                                                                                               "},{"title": "微信小程序之数据缓存 ", "author": "                  yuzeng84                  2017-8-11 11:55                ", "text": "                                                                                                                                                                                     在H5之前缓存一般都是用cookie但是cookie的存储空间太小。于是H5增加了新的缓存机制即localstorage 和 sessionstorage具体的介绍就不在多说。在微信小程序中数据缓存其实就和localstorage 的原理差不多所以理解起来并不难。下面我们来一起实现一下。效果图展示：  我们在index页面存入数字11然后在跳转到新页面在将缓存中的11取出渲染到当前页面。具体代码如下：index页面：<span style=\"font-size:24px;\"><view class=\"btn-area\">  <navigator url=\"../navigator/navigator?title=我是navi\">跳转到新的页面post情求</navigator>  <navigator url=\"../redirect/redirect?title=我是red\" redirect>跳转到当前页面</navigator></view></span><view>  <input style=\"border:2rpx solid red\" placeholder=\"输入信息\" bindinput=\"getInput\" />  <button style=\"border:2rpx solid yellow\" bindtap=\"saveInput\">存入</button></view>1234567891012345678910index的js：//index.js//获取应用实例var app = getApp()Page({  data: {    storage:''  },  onLoad: function () {    var that = this  //获取输入值  getInput:function(e){    this.setData({      storage:e.detail.value    })  },  //存储输入值  saveInput:function(){    wx.setStorageSync('storage', this.data.storage)  }})12345678910111213141516171819202122231234567891011121314151617181920212223跳转页面：<view>从存储中得到的数据:{{storage}}</view>11跳转页面的js：var app = getApp();var that;  Page( {    data: {        storage:''  },    onLoad: function(options) {      that = this;     //获取存储信息    wx.getStorage({      key: 'storage',      success: function(res){        // success        that.setData({          storage:res.data        })      }    })  }})  1234567891011121314151617181920212212345678910111213141516171819202122                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    【基础】微信小程序flex布局               Ubuntu 16.04 下部署Node.js+MySQL微信小程序商城                                                        原作者: king-w                   来自: qq_33401924的博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 前端浏览器缓存及代码部署                                                      • 微信小程序--缓存的二次开发封装                                                                                               "},{"title": "微信小程序缓存--根据不同的id来进行设置和读取缓存 ", "author": "                  Rolan                  2017-6-12 00:53                ", "text": "                                                                                                                                                                                     本文是根据不同的id来进行设置和读取缓存是同步缓存的方式：jonNums.count 是接口返回的数据  是报名总人数newNumber  新的报名总人数 - 缓存上次的报名总人数 = 新增报名人数[javascript] view plain copy print?onLoad: function (options) {     var that = this;     var activityId = options.activityId;     //报名表人数统计     wx.request({       url: domain + '/activityjoin/selectJoinCount',       data: { activityId: activityId },       method: 'GET',       success: function (res) {               var jonNums = res.data;         var newNumber = jonNums.count - wx.getStorageSync('jonNumsed' + activityId) //获取缓存             wx.setStorageSync('jonNumsed' + activityId, jonNums.count);//设置缓存           if (jonNums.count) {           activityId                 }           jonNums.joinCount = jonNums.count;           that.setData({ newNumber: newNumber, jonNums: jonNums })       }     })       },                                               .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序的wxml文件和wxss文件在webstrom的支持               通过微信小程序“运维密码”实现SSH双因子认证                                                        原作者: wy_Blog                   来自: csdn博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序--二次封装的缓存框架 wCache（支持缓存时间、默认值） ...                                                      • 微信小程序本地缓存数据增删改查                                                      • 微信小程序--数据缓存API整理                                                      • 微信小程序--实现多个按钮toggle功能                                                      • 前端浏览器缓存及代码部署                                                                                               "},{"title": "git精选：微信小程序新手跳坑指南21条 ", "author": "                  天下雪                  2016-12-7 11:30                ", "text": "                                                                                                                                                                                        本文作者wardenger来自github如果你很幸运有APPID那么你就可以在真机上预览但同时你发送的请求必须是合法域名而假如你没有APPID那么你就不能在真机上预览因此你就没有所谓合法域名的限制。使用bind事件绑定不会阻止冒泡事件向上冒泡而catch事件绑定可以阻止冒泡事件向上冒泡。使用竖向滚动时需要给 scroll-view 一个固定高度。一个应用同时只能打开5个页面当已经打开了5个页面之后wx.navigateTo不能正常打开新页面。请避免多层级的交互方式或者使用wx.redirectTo。循环加载JSON数据集合时如果其中有项是null在开发工具中加载正常但是在手机中浏览时显示空白页并且调试时没有错误信息所以需要对可能为null的数据进行判断。个人开发者无法申请微信小程序；目前微信仅支持企业、政府、媒体、其他组织申请。一个小程序账号只有一个管理员（可修改）可以绑定10位开发者。JsCore是一个没有窗口对象的环境所以不能在脚本中使用window也无法在脚本中操作组件。样式表不支持级联选择器。WXSS支持以.开始的类选择器；可以使用标签选择器控制同一类组件的样式。本地资源无法通过 css 获取。background-image：可以使用网络图片或者 base64或者使用标签。可以在app.josn中设置各种网络请求的超时时间或者打开debug选项。 \"networkTimeout\": {    \"request\": 10000,    \"connectSocket\": 10000,    \"uploadFile\": 10000,    \"downloadFile\": 10000  },  \"debug\": true页面是通过Page对象来渲染的每个页面对应的js文件必须要创建page最简单的方式就是在js文件下写入Page({})在page中有管理页面渲染的生命周期以及数据处理事件都在这完成。所以：养成创建页面的同时在js文件先创建Page的习惯。如果遇到 tabBar 设置不显示的情况原因有很多直接去app.json这个文件页面数据传递微信小程序路由（页面跳转）是通过API wx.navigateTo或者wxml中组件实现的不管哪种实现都会有一个重要的参数就是url它指定了要跳转的页面并且页面之间数据传递也是通过url来实现的这个数据传递有点类似于我们使用的get网络请求把参数都拼接在要跳转界面地址的后面并以“？”连接。然后将要传入的数据以键和值的形式追加在”?”后面多个参数直接用”&”符合。<navigator url=\"/pages/dynamic/dynamic?title={{item.title}}&message={{item.message}}\">而数据接收是在js文件的page里接收的page生命周期有一个onLoad函数它就是做一些初始化数据的工作onLoad函数有一个参数options我们就可以通过key将数据获取.onLoad:function(options){// 页面初始化 options为页面跳转所带来的参数console.log(options.title) //这里是接收参数console.log(options.message)}重力感应。重力监听函数监听重力数据频率为：5次/秒有XYZ三个参数XYZ的取值都有一个范围[-11]。把手机看成一个长方形屏幕左下角为圆点短边向右为X长边为Y垂直于屏幕为Z。哪个轴对着天就是－1对着地就是1。比如上图所示XY都等于0Z等于-1。因为只有Z轴对着天而XY既没有对着天也没有对着地所以值是0。wx.onAccelerometerChange(function(res) {  console.log(res.x)  console.log(res.y)  console.log(res.z)})声音播放。微信小程序对于声音方面的内容提供了录音音频播放（wx.playVoice）音乐播放（wx. playBackgroundAudio）三个大类。在调用网络音频资源时wx.playVoice均不能正常播放而官方的用法是播放录音的文件所以可以大胆的猜测wx.playVoice是为了播放录音的音频而不能播放音乐。wx. playBackgroundAudio官方是只要求dataUrl这一个参数是必须的但是在真机环境下必须加上title这个参数还有就是不知道是不是手机支持问题在手机端不支持wav音频文件MP3能正常使用。简单总结就是： wx. playBackgroundAudio在真机环境下最好引用mp3类音频并且加上title属性。分割线用1rpx的时候有时候有些分辨率不显示记得将单位改成px就可以了。Page中的function方法名不能设置为setData否则函数将不能正常工作如果你遇到这个报错： \"Parse app.json error： SyntaxError: Unexpected token / in JSON at position 332\"那么很可能是因为你在 .json 文件中用了注释该文件是不能有任何注释的。在清空输入框时要注意：input的初始值不能设置为空('')否则清空时会失效。当你尝试用第三方API作为自己的数据来源时你不得不面临授权登陆的问题而小程序是不支持解析原始HTML的因而你没办法渲染第三方API让用户输入用户名和密码的界面所以尝试第三方API时请慎重考虑。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    从零入门系列《一》安装工具及项目的创建               书籍讯息介绍：微信小程序开发实战                                                        原作者: wardenger                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • github精选：微信小程序入坑指南                                                      • 微信小程序跳坑记：uploadFile:fail与一键登录之无法识别json数据 ...                                                                                               "},{"title": "微信小程序layout可视化设计工具介绍 ", "author": "                  天下雪                  2016-11-20 14:13                ", "text": "                                                                                                                                                                                                                                                                 先看下工具截图视频介绍$('swf_qGp').innerHTML=AC_FL_RunContent('width', '520', 'height', '390', 'allowNetworking', 'internal', 'allowScriptAccess', 'never', 'src', encodeURI('http://player.youku.com/player.php/sid/XMTgyNTQ4NDcyMA==/v.swf'), 'quality', 'high', 'bgcolor', '#ffffff', 'wmode', 'transparent', 'allowfullscreen', 'true');此工具通过可视化操作进行布局依据iphone6尺寸设置画布可以自动生成rpx和百分比的wxss。后续还会增加js代码自动生成。工具中组件按照微信小程序开发规范进行了缺省设置margin、padding、fontsize、fontfamily、color等属性按照微信视觉一致规范定制而成。软件左侧是常用组件中间是画布右侧是wxss属性设置面板。wviewrow组件是小程序view的延伸自动设置主轴：row。wviewcolumn组件是小程序view的延伸自动设置主轴：column。wtextinput#组件按照微信规范设置字体大小。wscrollview对应微信的scroll-view组件。wswiper对应微信的swiper组件。布局之后点击下面的wxmlwxsswxsspercent（百分比单位）wxssrpx（rpx单位）标签自动生成代码。工具下载链接：http://pan.baidu.com/s/1slrjKXR                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序组件化方案示例               微信小程序之会话处理                                                        原作者: comeonliuqd                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序网页端设计工具：coolsite360                                                      • layout使用教程：小程序UI设计（1）-轻松布局                                                                                               "},{"title": "小程序上传一张或多张图片到阿里云OSS ", "author": "                  Rolan                  2018-6-29 00:32                ", "text": "                                                                                                                                                                                     效果图：效果图 一.准备工作1.登录阿里云服务器配置需要的参数AccessKeySecret和OSSAccessKeyId。2.Base64,hmac,sha1,crypto相关算法签名算法去下载3.WeUI组件上传图片（使用方法请参考https://www.jianshu.com/p/010cea4202b8）4.上传图片主要的代码为： uploadAliyun.js注意：在小程序的配置位置如图：项目中js的位置 5.选图片的方法：点击确定上传到的代码（多张图片）：uploadImg.wxss代码：@import \"../../weui.wxss\"; 6.上传成功后的结果如图：结果 其中images/http://tmp/wx1b4e5e756cd48af1.o6zAJsws4grEQvYrWTjBigy-6QaU.0llhudiKSF2V955a1c48350d9328ef064b4d36d12746.jpg 就是在阿里云服务器的图片名称拼接上\"http://yijiao.oss-cn-qingdao.aliyuncs.com/images/http://tmp/wx1b4e5e756cd48af1.o6zAJsws4grEQvYrWTjBigy-6QaU.0llhudiKSF2V955a1c48350d9328ef064b4d36d12746.jpg\"才是完整图片。该demo gitHub的下载地址：https://github.com/dt8888/uploadImage如有疑问请发简信给我定会回复。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序专题之setData               微信小程序 canvas 绘图问题总结                                                        原作者: honey缘木鱼                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序上传阿里云视频文件流程及代码                                                      • 微信小程序https安全链接 阿里云 ssl证书 部署                                                      • 阿里云服务器绑定https                                                      • [微信小程序]上传图片到阿里云OSS                                                      • 微信小程序设置图片固定比例                                                      • 小程序生成图片库                                                      • 微信小程序朋友圈分享图片生成方案实现                                                                                               "},{"title": "手机界面设计尺寸规范 ", "author": "                  天下雪                  2016-11-28 11:01                ", "text": "                                                                                                                                                                                                                                                                 iPhone界面尺寸设备分辨率PPI状态栏高度导航栏高度标签栏高度iPhone6P、6SP、7P1242×2208 px401PPI60px132px146pxiPhone6 - 6S - 7750×1334 px326PPI40px88px98pxiPhone5 - 5C - 5S640×1136 px326PPI40px88px98pxiPhone4 - 4S640×960 px326PPI40px88px98pxiPhone & iPod Touch第一代、第二代、第三代320×480 px163PPI20px44px49pxiPhone图标尺寸：设备App Store程序应用主屏幕Spotlight搜索标签栏工具栏和导航栏iPhone6P - 6SP - 7(@3×)1024×1024 px180×180 px114×114 px87×87 px75×75 px66×66 pxiPhone6 - 6S - 7 (@2×)1024×1024 px120×120 px114×114 px58×58 px75×75 px44×44 pxiPhone5 - 5C - 5S (@2×)1024×1024 px120×120 px114×114 px58×58 px75×75 px44×44 pxiPhone4 - 4S (@2×)赞赏                                                               邀请                                                                                                                                                                                      鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)一尘绿叶                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序：设计的6个关键词及设计思路               layout使用教程：小程序UI设计（1）-轻松布局                                                        原作者: 图翼                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序学习点滴《三》：开发工具及开发环境配置尺寸单位rpx与px,rem相互转换 ...                                                      • 微信小程序UI规范                                                                                                                                                                       2 条回复                                                                                     天下雪                              2016-11-28 19:50                                       一尘绿叶: 好家伙,真齐全!谢了同学假如自己有好东西欢迎分享在资源区或是综合交流区里大家互相促进    回复                                                                            一尘绿叶                              2016-11-28 19:46                                       好家伙,真齐全!谢了    回复                                                               \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                                                                                   jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092514|08d9f55b17200c56b229785452fcc4c6|2';\t\t\t\t\t\t"},{"title": "Canvas绘图在微信小程序中的应用:生成个性化海报 ", "author": "                  Rolan                  2018-9-30 00:36                ", "text": "                                                                                                                                                                                     一、Canvas应用的背景(个人理解)及基础语法背景从2012年开始微信那个时候用户的积累的量已经非常大了推出公众号当然大屏智能手机在那个时候也流行传统的大众媒体逐步消亡像微信公众号这样的新媒体盛行。企业的广告投入开始从电视等传统媒体向基于圈层文化的新媒体精准营销转移甚至很多企业尤其互联网企业开始思考如何利用用户的自传播这种方式去宣传企业、实现商业目标。而用户的自传播很好的途径就是生产个性化的海报。举个最常见的例子我第一次使用Keep是因为在朋友圈看到朋友分享她运动量的一个截图当时在我看来非常酷有心率脉搏呀、时速运动量啊、消耗的卡路里等还有一个二维码然后我就点了下载了Keep这整个获客成本几乎为0秒秒钟就多了一个用户。而实现这一过程的技术手段就可以用canvas。所以canvas的盛行与企业的精准营销和用户的自传播有很大的关系。如极客时间的一些实现案例：大家看第一张图的话是在2017年末的时候Qcon全球软件开发大会预热阶段的海报。然后我们为程序员做了一个生成2018年关键字的一张海报文案都非常有趣啊。第二张的话是在2018年元旦的时候做的极客时间助手这个小程序当初主要是为程序员做的2018年新年签。那面就是一些极客时间的专栏包括用户留言你留言随手可以生成一张海报可以转发等等大概就是这样。基础语法Canvas本质是一个可以使用脚本(通常为JavaScript)来绘制图形的 HTML 元素默认大小为300像素×150像素(宽×高像素的单位是px),通过JavaScript上下文对象动态创建图像。比如画线、画矩形、涂颜色甚至生成带二维码的海报。原理就是一笔一笔的画画一条横线再画一条横线等等就是不断地创建路径、绘制路径然后把这个路径封闭起来可以涂色之类的他的底层的封装就是放到一个数组里形成一个路径的数组将这个数组传到js底层的一个方法然后去绘制。举个栗子：画一个头像首先你需要把这张图片画canvas上面比如说你画你这个头像就是正方形就在(0,0)开始画一个图片。那么你在这个图片的中心作为原点然后你画一个圆形。然后你再利用canvas语法画一个圆弧在这个圆弧路径以外设置不可见以内设置可见这个时候就形成了一个圆形头像。  <canvas id=\"canvas\" width=\"300\" height=\"300\"></canvas>  <script>    const canvas = document.getElementById('canvas')    const ctx = canvas.getContext('2d')    const img = new Image()    img.onload = function() {      circleImg(ctx, img, 100, 100, 50)    }    img.src=\"https://avatar-static.segmentfault.com/289/811/2898115528-58c35e9b79717_big64\"    function circleImg(ctx, img, x, y, r) {      ctx.save()      let d = 2 * r      let cx = x + r      let cy = y + r      ctx.arc(cx, cy, r, 0, 2 * Math.PI)      ctx.stroke();      ctx.clip()      ctx.drawImage(img, x, y, d, d)      ctx.restore()    }    // 微信小程序中的[canvas](https://developers.weixin.qq.com/miniprogram/dev/component/canvas.html)与HTML5的canvas在语法有些区别比如API就不一样    // 另外小程序中的canvas因为是原生组件的层级是最高的所以页面中的其他组件无论设置 z-index 为多少都无法覆盖原生组件  </script>二、常用的\"生成海报\"的方式我们会经常在朋友圈看到什么算命、性格分析、测算你的智商、情商等等这些东西都是由用户分享出一张图片(海报)这个图片就是用canvas做成的上面画了二维码二维码是一个数组两个或循环嵌套画小黑点用户识别这个二维码之后就进入他的程序经过程序跑出来的测试结果啊什么的点保存的时候就会生成一张个性海报明白。怎么生成这种个性化海报呢？2.1 字符串模板此处应有案例主要实现：与服务端约定好数据格式-->前端做好模板-->服务端用第三方工具渲染返回到客户端img首先与服务端约定好数据格式比如关键字是什么、头像URL、昵称等等把所有放数据格式的地方用{{{}}}嵌套告诉后端位置；然后将前端模拟数据抠去比如user.tags把这一段html的字符串模板给到服务端最后服务端拿到数据通过html2canvas这样的第三方工具把图片渲染返回给客户端展示让用户可以长按这张图片保存到手机相册。这是比较传统的方式早些年基本上都是通过这种方式。有什么弊端呢？一是第三方工具维护不及时、不支持flex布局、ES6等语法二是调试不方便三是高并发的时候会出问题特别是生成的是高清无码的海报的时候2.2 canvas绘制案例: '极客时间小助手'小程序主要实现：前端直接通过canvas生成海报摇晃手机抽取新年签跳到第一个页面需要绘制头像、关键字以及保存按钮黄色的保存按钮其实就是呃一张透明的png图片把它画上去。那在这个button上面儿需要固定一个宽高和它差不多大小的一个空的、透明的div在这个div上加点击事件这个事件就是调第二张要保存的那个canvas。第二张这个是没有保存按钮的但有二维码。带二维码的这张canvas放哪里呢？一种方案是定位给一个特别大的top或left让它不显示在屏幕里边；另一个方案是层级预览的这张canvas在真正要保存canvas图片之上但是会有问题。手机浏览器版本低的话定了层级不管用一些安卓手机也会有问题有时候会浮上来没被盖住。当然如果要实现保存高清图的话还是需要处理的那就是放大不过这个是笨方法。最优的方法是拆解这张图像确保导出的canvas是最高清的而且对用户来说也是最省流量的。解析：进到首页其实关键字在本地就随机取完了在首页index.js中的onShow方法中就通过wx.getStorageSync缓存了要画的元素比如关键字(这里是图片)、关键字解析语(也是图片,毕竟微信小程序的canvas不支持字体)等等。摇一摇触发重力感应事件wx.onAccelerometerChange监听里面的事件获取用户授权拿到头像并跳转到poster页面。直接就开始画两张图片一张有二维码的(shakepage1)一张有button的(shakepage2)这里二维码是'死码',button也是在图片的基础上覆盖一个view画完之后调canvasToTempFilePath保导出那张带码的此时带码的这张通过css设置visibility: hidden隐藏起来。点击按钮触发saveImageToPhotosAlbum将导出的这张 图片保存到手机相册这里需要授权相应的要做一些处理比如用户拒绝授权之后再次点击需要 wx.showModal再次请用户授权。基本代码如下：(详细源码))      wx.canvasToTempFilePath({        x: 0,        y: 0,        width: this.data.screenWidth,        height: this.data.screenHeight,        destWidth: this.data.screenWidth * this.data.pixelRatio,  // pixelRatio为设备的像素比          destHeight: this.data.screenHeight * this.data.pixelRatio,        canvasId: \"canvasid\",        success: function(e) {          console.log(e)          this.setData({            bjtempFilePath: e.tempFilePath  // 拿到要保存的图片路径          }, function() {});        },        fail: function(e) {          console.log(e);        }      })  onUserSaveImageRight: function () {    console.log(\"-click-\");    var _this = this;    if (!wx.saveImageToPhotosAlbum) return wx.showModal({      title: \"提示\",      content: \"当前微信版本过低无法使用该功能请升级到最新微信版本后重试。\"    }), void console.log(\"version low\");    wx.getSetting({      success: function (res) {        res.authSetting[\"scope.writePhotosAlbum\"] ? (console.log(\"1-已经授权《保存图片》权限\"), _this.saveimgfn()) : wx.authorize({          scope: \"scope.writePhotosAlbum\",          success: function () {            console.log(\"用户对相册-授权成功\"), _this.saveimgfn();          },          fail: function () {            wx.showModal({              title: \"提示\",              content: \"请您授权保存到系统相册\",              showCancel: !1,              success: function (res) {                res.confirm && wx.openSetting({                  success: function (res) {                    res.authSetting[\"scope.writePhotosAlbum\"] ? setTimeout(function () {                      _this.saveimgfn();                    }, 500) : wx.showModal({                      title: \"提示\",                      content: \"您未授权无法将海报保存到相册你可以截屏得到海报或者再次点击'保存海报'按钮并授权\",                      showCancel: !1                    });                  }                });              }            });          }        });      }    });  },  saveimgfn: function () {    var filePath = this.data.bjtempFilePath;    console.log(filePath), filePath ? wx.saveImageToPhotosAlbum({      filePath: filePath,      success: function (res) {        wx.showToast({          title: \"保存成功\",          icon: \"success\",          duration: 1500        });      },      fail: function () {        wx.showToast({          title: \"保存失败\",          icon: \"fail\",          duration: 1500        });      }    }) : this.saveImage()三、极客时间小程序-生成各种海报的解决方案微信小程序canvas与HTM5的canvas对比微信小程序canvas中层级z-index失效小程序中canvas拥有最高级无法二次设置;微信小程序canvas不支持字体功能特殊字体只能用图片代替;微信小程序canvas不支持绘制在线图片需要下载再绘制(安全域名的锅)微信小程序canvas可以实现不同尺寸屏幕自适应    var rpx;    //获取屏幕宽度获取自适应单位    wx.getSystemInfo({      success: function(res) {        rpx = res.windowWidth/750      },    })    // 在绘制方法中将参数乘以相对单位即可实现自适应    const s = wx.createCanvasContext(\"canvas\")    s.drawImage(Url, 0, 0, 265 * rpx, 262.5 * rpx) 如何导出高清海报、如何封装；wx.canvasToTempFilePath({    canvasId: 'image-save',    x: 0,    y: 0,    success: res => {       wx.saveImageToPhotosAlbum({         filePath: res.tempFilePath,         success: () => {           this.setData({saving: false})           utils.success('保存成功')           setTimeout(() => {wx.navigateBack()}, 500)         },         fail: err => {           this.setData({saving: false})           wx.getSetting({             success: res => {               if(!res.authSetting || !res.authSetting['scrop.writePhotoAlbum']){                 wx.openSetting()               }             }           })         }       })    }})                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    清新小程序实战：和你的100个愿望清单（云开发）               微信小程序踩坑系列——从wx.request谈谈异步处理                                                        原作者: 胡琦                   来自: ssegmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 canvas 雪花效果 闪动星星效果                                                      • 小程序利用Canvas绘制图片和竖排文字                                                      • 微信小程序 canvas 绘图问题总结                                                      • canvas里的图片如何自适应                                                      • 微信小程序 canvas圆角矩形的绘制                                                      • 实现小程序canvas拖拽功能                                                      • 小程序 Canvas绘图不同尺寸设备 UI兼容的两个解决方案                                                      • 微信小程序-canvas绘制文字实现自动换行                                                                                               "},{"title": "微信小程序研究报告：3大趋势，揭示小程序的边界（附排行榜） ... ", "author": "                  Rolan                  2018-7-13 00:02                ", "text": "                                                                                                                                                                                     文章来源：  QuestMobile原标题《QuestMobile微信小程序深度洞察研究报告：三大维度价值涌现精准营销、唤起转化、连接线下》一、小程序的边界在哪里？1、移动小程序可连接生活场景且发展受微信APP内生态影响小程序通过与APP等联动共同构成网络生态主要价值体现在可连接物理形态的产品和线下服务并通过社交裂变带来短期引爆效应形成长期分享形态。同时小程序受微信生态的影响发展边界也非常清晰。2、覆盖人群边界：微信小程序基本可覆盖全部移动网民使用场景已形成3、细分行业发展边界：金融理财（支付）、小游戏、旅游出行、移动购物等小程序更贴近小程序应用场景而发展较快4、运营边界：除小游戏外微信小程序的用户留存率较APP显著偏低小程序的导流价值更为突出对于微信小程序“留存率不高”的认知需在不同领域具体分析：小游戏：导流或分流取决于APP对目标用户的分层运营能力；购物小程序：营销和导流价值更为突出；小程序旅行服务：小程序的留存率与用户的使用情况接近鉴于旅游服务需求的低频属性旅行服务TOP小程序的留存率并不低。5、发展基础边界：站在巨人的肩膀上更易领风骚TOP100小程序中腾讯系占28%。腾讯对小程序进行全面布局自有小程序主要分布在游戏类和生活类如果加上合作/控股方的小程序则基本覆盖主要行业。腾讯系和非腾讯系的头部小程序均集中在游戏行业非腾讯的小程序用户规模不输腾讯系。6、发展基础边界：移动互联网将小程序纳入生态更易产生联动价值；传统企业单点作战在特定环节发挥小程序价值。7、小程序应用场景边界：支付、游戏和工具最相关其中垂直类工具类型丰富小程序主要应用场景的特征为：1）刚需应用以支付类为主连接的线下应用场景有餐饮、交通出行等；2）工具类应用碎片化、垂直化以核心功能满足更为细分的应用场景；3）连接线下相对低频服务包括旅游出行、二手交易等；4）延续已有移动应用场景增加分享功能如小游戏、移动购物、内容服务等。二、布局小程序的价值是什么？企业小程序运营图谱企业小程序运营案例概览1. 连接内容案例：传统媒体通过小程序实现在线触达用户—新华社微悦读区别于APP的大而全新华社微悦读小程序以“小而美”的形式主打【首页】【图视】【现场】三块内容主题前两类内容配合分享页面通过社交裂变获取新增用户；后一类内容以直播、弹幕等形式让用户参与其中对于用户粘性的提升有较强的效果。2. 连接服务案例2.1 携程旅行小程序连接多元服务场景携程小程序同样由多个小程序矩阵组成以主场景——特色场景——个性化触点为用户提供更简洁高效的服务。2018年6月携程小程序周日均活跃用户数峰值超900万。2.2 i麦当劳小程序矩阵提供分层服务麦当劳建立小程序服务矩阵4个小程序分别触达指定细分服务领域实现用户分层服务。2.3 传统零售星巴克通过小程序实现线上线下联动营销相比APP星巴克用星说小程序强调的是社交属性通过赠送好友饮品卡或星礼卡满足人们社交需求的同时也能通过多级传播形成裂变效应增加线下门店人流量。2018年6月星巴克用星说小程序月日均活跃用户数达8.5万用户规模趋于稳定。2.4 共享充电宝小程序体现便捷服务价值QuestMobile数据显示以街电、小电充电为代表的小程序用户规模十分可观除街电APP外其余充电宝APP用户规模非常小可见对于充电宝“用完即走”一类的服务小程序是比APP更适合的载体。2.5 粤省事小程序实现公共服务移动化公共服务小程序聚合服务简化服务流程。以粤省事为例可办理142项政务服务事项包括公积金、社保医保等服务以及驾驶证等十大证件服务。QuestMobile数据显示2018年6月粤省事微信小程序周平均活跃用户数超30万。3. 连接商品案例3.1 小程序+便捷优惠购物—转转QuestMobile数据显示转转微信小程序周活跃用户数在短短三周从百万增长至千万超过APP的用户规模；但从用户留存率来看转转微信小程序的使用场景和用户需求仍不太稳定。3.2 轻奢品牌通过小程序实现在线营销和获客留存—MICHAEL KORSMICHAEL KORS小程序于2017年8月底上线主要是为会员提供服务提升会员体验增加会员粘性促进销售。4. 小游戏：微信小程序游戏的主要类型为休闲类游戏和游戏工具微信小游戏发展如火如荼爆款层出不穷基于微信生态强大的社交连接基础微信小游戏的发展如火如荼平均每两三周就会有爆款小游戏问世。以6月为例据QuestMobile数据监测损友圈和派派是增长最快的小程序游戏之一其中损友圈已跻身小程序2018年6月MAU TOP10 。5. 工具应用：提供便捷功能连接线下服务沃尔玛小程序为用户提供查找附近门店、扫码购物等服务2018年6月25日-7月1日周活跃用户数超110万。三、小程序的未来会好吗？趋势1. 应用小程序实现用户分层触达消费分层用户精分是消费趋势之一。相较于APP小程序更适于触达细分人群。用户分层触达方式主要有： 1）既有服务的移动端延展延续已有品牌和目标人群的定位； 2）针对目标特定人群提供细分服务或基于细分领域小程序触达目标人群。趋势2.应用小程序为传统企业整合营销的必需环节小程序参与整合营销的环节包括：1）连接线上营销和线下活动；2）实现客户管理和营销信息分享相结合；3）独立成为电商小平台；4）实物促销与社交传播式营销活动相结合。趋势3.应用小程序成为连接智能硬件的快捷方式以米家为例小程序连接智能硬件的方式正在逐渐被用户接受。微信小程序手机游戏行业-TOP10微信小程序旅游出行行业-TOP10微信小程序传统行业-TOP10TOP10-微信小程序+APP-DAU榜                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序的下一步：支持 NPM、小程序云、可视化编程、支持分包 ... ...               小程序“三国杀”：百度向左微信、支付宝向右                                                        原作者: HTML5梦工场                   来自: HTML5梦工场                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序“三国杀”：百度向左微信、支付宝向右                                                      • 速途研究院：2018年Q3小程序生态市场研究报告                                                                                               "},{"title": "微信小程序--旋转木马/缩放轮播图效果 ", "author": "                  Rolan                  2018-7-27 00:21                ", "text": "                                                                                                                                                                                     话不多说先上图.gif文章涉及技术点微信小程序原生Swiper控件Wxss Transform、Transition轮播条滚动回调控制微信小程序条件渲染、列表渲染全部实现代码加起来也就三四十行大部分还用来写wxml UI代码所以功能实现起来非常简单。 首先将问题简单化能用原生组件实现出我们想要的效果绝不自己开发Component。原因：我懒+我自己写的也不敢说性能堪比原生组件先来分析一波gif中我们需要实现效果和哪些效果可以直接修改原生Swiper的属性就能实现的我们需要自己实现的功能自动滚动+手动拖拽 （原生组件帮我们完成 Property：autoplay） 面板指示点 （原生组件帮我们完成 Property：indicator-dots） 左右可以露出非Active状态图的边缘（即Quiet状态 后文class会以这两个名字定义） （原生组件帮我们完成 Property：previous-margin、next-margin） 图片滚动到中心位置放大滚动出去缩小 （我们手写实现利用技术点中提到的滚动回调+条件渲染。其中滚动回调用 Property：bindchange） 这样看下来就很清晰了需要我们实现的只有一个动画放大缩小。再进一步就能分成两种实现方式:wxss实现 js实现很显然wxss实现代码很少也能达到同样的效果so~//.wxml  <swiper class='swiperClass' autoplay indicator-color=\"#a39f99\" indicator-active-color=\"#f49641\" indicator-dots  interval=\"2000\" duration=\"1000\" previous-margin=\"30px\" next-margin=\"30px\" circular bindchange=\"bindchange\" style='height: {{swiperHeight}}px'>    <block wx:for=\"{{imgUrls}}\" wx:key=\"{{index}}\">      <swiper-item>        <image src=\"{{item}}\" class=\"slide-image {{swiperIndex == index ? 'active' : 'quiet'}}\" mode='aspectFill'>        </image>      </swiper-item>    </block>  </swiper>//.wxss.swiperClass {  margin: 0;  margin-top: 10px;}.slide-image {  width: 100%;  height: 90%;  border-radius: 10px;  position: relative;}image.active {  transform: none;  transition: all 0.2s ease-in 0s;}  image.quiet {  transform: scale(0.8333333);  transition: all 0.2s ease-in 0s;}//.jsdata: {    imgUrls: [      'xxx',      'xxx',      'xxx',      'xxx'    ],    swiperIndex: 0 //这里不写第一次启动展示的时候会有问题  },bindchange(e) {    this.setData({      swiperIndex: e.detail.current    })  },上面Swiper控件里面还有设置宽高的属性就随便填几个数测试就好了不影响主要功能。注意身体小心秃顶                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (8)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (8 人)昱凯lyqlyq带带大师兄wWI44w一路平95开发小白lizole无异有道                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序中短信验证码登录全流程及代码               两天撸一个天气应用微信小程序                                                        原作者: 一个程序猿的每一天                    来自: 简书                                                                                      /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序—九宫格心形拼图效果                                                                                               "},{"title": "微信小程序 canvas区间滑动选取 ", "author": "                  Rolan                  2018-9-1 00:21                ", "text": "                                                                                                                                                                                     目标js文件使用 import 引入; 然后在onLoad(){}里面要一下写入例如: this.selectInterval = new selectInterval({属性});        this.selectInterval = new SelectInterval({        canvasId:'canvas',             值必须是canvas组件的canvas-id属性的值        canvasHeight:100,              值必须是当前画布的高度        Xaxis:{left:30,right:345},     { left:30, 横条的左端 right:345, 横条的右端 }(right必须大于left,如果不传有默认值)        scale:[10,20,30],              刻度值Array类型,取值以一个不变数为常量不断递增,数组任何两个前后值相减要恒等于这个常量,如果数组第一个值不是0,                                      会默认在数组前面添加一个0,但是0这个值不会在canvas上显示,(当数组长度是2的时候,                                 可以设置任意大于零的数值,但第二个值必须大于第一个值);        Yaxis:[125,5],                 刻度值Array类型,第一个值是绘制的横条的起始高度,第二个值是横条本身的高度(如果不传默认[125,5])        manner:true,                   切换选择滑动点的上方在滑动的时候是否有跟随圆球如果值为false那么明确显示区间滑动所得的最小值与最大值        bothEndsNear:310,              可以设置刻度值和尺度点距离横条的开头与终点的距离,不传默认居中        // decimalPoint:10,            刻度值/decimalPoint,可以使刻度值变小数,必须是10的倍数,可以不传        // rightSliderStop:2,          值为一个Boolean或者在manner的值为true的时候可填number,可以不传;而number的值就是最大值与最小值的差设置后两个滑动点是不会滑动到小于这个number的距离        showTitle:{            name:'km',                   String类型,用作设置单位            size:15,                     标签字体大小,Number类型            title:'#1384e0',             头部标签的字体颜色或者圆球里面的字体颜色,String类型            positionX:100,               标签字体在canvas横向的位置,Number类型只有manner为false或者不传的时候生效            positionY:80,                标签字体或者圆球在canvas纵向的位置,Number类型            isfollow:{                   跟随圆球大小与颜色的设置,manner的值为false或不传的时候,这个属性可以不给                view:true,           manner的值为true时view的值必须为true                roundSize:12,        圆球大小                roundColor:'rgba(10, 113, 238, 0.8)' 圆球的颜色            }        },(如果不传不会显示头部标签)        scaleIn:{            name:'km',                   String类型,用作设置单位            size:10,                     控制刻度值字体的大小,Number类型            valueY:108,                  刻度值在canvas纵坐标的位置,Number类型            pointY:113                   尺度点在canvas纵坐标的位置,Number类型        },(如果不传不会显示刻度值)        colour:{            colorBar:['#e5e5e5','#1384e0'],     横条的颜色,Array类型,第一个是横条的底色,第二个是取值范围的颜色            roundColor:['#ffffff','#e5e5e5'],   圆圈颜色,Array类型,第一个是圆的颜色,第二个是圆的边框颜色            scale:['#000000','#999999']         刻度数值的字体颜色        },(如果不传会显示上面的默认参数)        selectedInterval:{            min:15,            max:23         },(min不能大区等于max,如果不传只会显示在横条的两端)        round:{            radius:10,            edgeLine:2        },(如果不传会默认圆的半径为10,边框为2)        // image:{        //  url:'../../assets/image/spot-a.png',   图片的本地路径值为String类型；值可以为数组但是如果是数组时数组的长度必须是2        //  width:20,                              设置图片的宽度        //  height:24                              设置图片的高度        // },(如果不传不会显示图片)        followValue:{            name:'',                               String类型,用作设置单位            color:'#f8835f',            size:10,                               设置字体大小            leftY:151,                             随数值在canvas纵向的位置            rightY:151        }(如果不传不会显示跟随数值)    });/**Page({})里面创建如下属性 必须自定义(e){ bindtouchstart    this.selectInterval.move(e.changedTouches[0].x,e.changedTouches[0].y);},自定义(e){ bindtouchmove    this.selectInterval.meter(e.changedTouches[0].x);},自定义(e){ bindtouchend    this.selectInterval.texthints((min,max)=>{        参数min/max返回的值是最小/大价格,超过最大值max返回null        console.log(min,max);    },true);初始化时传入manner属性的值为true时候,这个函数的第二个参数的true就要传,不传也没什么问题只是结果会有不同;},<canvas canvas-id=\"canvas\" bindtouchstart=\"自定义\" bindtouchmove=\"自定义\" bindtouchend=\"自定义\"></canvas>画布css样式width:100%;box-sizing: border-box;height: 自定义rpx;                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)wCHN42                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序可实时改变转速的css3旋转动画               微信小程序集成 Jenkins                                                        原作者: aloneqi                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 canvas 雪花效果 闪动星星效果                                                      • 小程序利用Canvas绘制图片和竖排文字                                                      • 微信小程序利用canvas生成海报分享图片                                                      • 微信小程序 canvas 绘图问题总结                                                      • canvas里的图片如何自适应                                                      • 微信小程序 canvas圆角矩形的绘制                                                      • 【微信小程序】Text2Image                                                      • 小程序 Canvas绘图不同尺寸设备 UI兼容的两个解决方案                                                      • 微信小程序-canvas绘制文字实现自动换行                                                                                               "},{"title": "微信小程序再推iOS虚拟支付整改方案，我们给开发者总结3条有效应对措施 ... ", "author": "                  Rolan                  2018-8-20 00:02                ", "text": "                                                                                                                                                                                     几日前微信发出一则《关于小程序虚拟支付内容和服务的整改通知》内容如下：你好基于微信小程序平台运营规范开发者在iOS系统上提供的虚拟物品不能展现任何购买、支付的功能、页面、按钮即使实际上它们都不可使用；也不得引导至外部网页或APP来实现支付功能。请尽快排查当前小程序是否存在违规内容并于8月11日00:00前更新整改结果到线上版本。逾期未整改的小程序平台将参照《微信小程序平台运营规范》14.6虚拟支付相关规则暂停当前小程序iOS端用户访问。 从这则通知可以看到过去绕过iOS虚拟支付规则的玩法现在都不行了。 曲线救国已成过去式据晓程序观察（yinghoo-tech）了解iOS端一直都不能使用虚拟支付这个新的提示又是什么意思？ 这次通知中有3个重点内容：1、 不要在平台上展示任何支付功能包括货架（价格标签）、购买/支付/订阅等功能或按钮。 这是说诸如知识付费类的小程序在iOS端与安卓版的界面都会有类似“订阅课程”等标识但之后iOS端的小程序界面这些标识都不能再显示了。连展示都不能有这是对新规则的进一步细化、明示。此类标识都将被禁止这类呈现货架价格、提示购买的行为将被禁止2、不要试图引导用户到微信公众号、H5、App或是任何外链进行付费。以前部分开发者使用了如下两种曲线救国的方式从最新的通知来看微信正在进一步让规则细化让这两种方式将彻底成为过去：小程序跳转App。由于小程序支持打开App功能iOS系统内如需使用“虚拟支付”功能的开发者可以引导用户跳转至App进行支付；引导至公众号。很多公众号主页的菜单栏有充值功能比如移动充租赁类公众号、第三方电信服务公众号等等。开发者可以在小程序中为用户提供去往公众号的路径让用户去公众号完成支付。以上这些形态都需要修改3、本周内尽快整改避免被违规处理。 注意不是所有提供支付功能的小程序都要被整改仅仅只有涉及“虚拟支付”的小程序需要调整。什么是虚拟支付？说白了就是购买非实物摸不到的物品。比如：VIP会员、充值、课程、虚拟物品等等。 受到影响的首当其冲就是内容付费类的小程序关停iOS版虚拟支付功能将对这些小程序既有的变现模式带来极大冲击。而其他涉及虚拟支付的答题类和虚拟礼物类小程序也都会受到波及。 影响范围仅限iOS端Android不受影响开发者们依然可以在安卓版本的小程序内提供虚拟支付。 开发者别焦虑这里有三大应对攻略通知来得很突然很多开发者还一脸懵逼别担心为了不避免因调整不及时被封禁我们为大家总结了三大应对攻略。1、关闭付费通道。7月下旬微信就切断了小程序iOS虚拟支付的接口。关闭付费通道是最一劳永逸的解决办法最好将虚拟支付的指示文字都一并删除以避免毫无必要的误会。 以会员卡业务为例近日小程序「腾讯视频」就关闭了会员卡开通渠道原本会员开通按钮仅显示“你还不是会员”不再提供开通服务。2、所有的付费调整成免费。有些小程序的收费功能其实可以变成免费功能结合其他比如：分享、签到、会员注册可得到奖励的社交玩法不仅能增加小程序的用户粘性还能达到流量增长的目的。同时高曝光的小程序还能进一步增加流量主广告收入。 可以参考下面这款小程序。3、直接提示不可服务。对于虚拟支付比较集中的在线课程会员等可以以免费的形式对外。或者先在其他渠道做这些服务。但如果不愿意免费就最好直接提示不可服务提示语最好不要出现Apple和iOS相关关键词。 小程序「网易公开课精品」已经率先用这种方式完成整改在线课程显示为无法订阅。不过依然可以试听让用户了解产品以便日后平台规则若有调整可以重新开放订阅。另外所有小游戏目前仅支持安卓端的道具内购iOS端小游戏也一样要进行整改了类似下图的价格标签与“充值”字样都不能显示。鉴于微信多次对于小程序虚拟支付进行限制本次整改我们预测是微信和苹果对于规则协调的最新结果因此我们建议开发者在政策明朗之前暂时先不要触及iOS虚拟支付相关业务。另一条路是开发者可以暂时专注安卓端的小程序虚拟支付毕竟根据市场研究机构Kantar发布的2018年第二季度智能手机行业的报告在中国市场安卓在第二季度占据了80.4%的市场份额iOS只有19.5%比例为八二开安卓用户还是拥有数量上的优势。 iOS生态内的虚拟支付一直命运起伏苹果对虚拟支付的管控有迹可循。 众所周知苹果一直有着IAP（in-App Purchase道具内购）规则App Store审核指南规定：“如果您想要在App内解锁特性或功能 (解锁方式有：订阅、游戏内货币、游戏关卡、优质内容的访问权限或解锁完整版等)则必须使用 App 内购买项目。”任何经过IAP机制的购买行为苹果公司都要抽取其中30%作为手续费。 从国外经验来看系统和平台的双重收费是有先例的以Facebook上Instant Games为例App Store或者Google play也都要收“过路费”。 根据“游戏陀螺”的报道Facebook 已经在近日为 Instant Games 开放内购内购的分成比例是3:7。开发者拿70%在Google Play扣除了分成后的营收中Instant Games再拿30%所以开发者实际拿到手是49%。微信也在一直积极配合苹果对虚拟支付的规则并寻求解决方法。苹果一出政策微信就会调整。在小程序诞生之初微信就在《微信小程序平台运营规范》里明确表示：iOS系统下微信小程序暂不得为虚拟物品购买提供支付功能。 今年5月更是发布明确公告：“除小游戏类目的安卓内购功能小程序暂不支持虚拟支付。” 诸如「腾讯视频」这样的官方小程序也一样暂停了iOS端小程序的虚拟支付功能一视同仁没有例外。小程序生态内最受瞩目的“现金牛”小游戏iOS端如今同样不支持道具内购。事实上这次规则调整早就有所预示7月下旬微信就关闭了iOS虚拟支付的接口 从产品层截断了虚拟支付的路径充分遵守了苹果相关规则。不过鉴于iOS虚拟支付多变的“历史轨迹”我们建议开发者不要着急最不变的就是变化木尚未成舟大家要做的就是深耕产品抓住用户喜好用更多的创新来挖掘微信10.3亿月活用户这个流量池。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    第一次次来小程序               今年爆款小程序流量裂变的秘诀是什么                                                        原作者: Miss豆教授                   来自: 晓程序观察                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序“三国杀”：百度向左微信、支付宝向右                                                      • 支付宝首页置顶小程序入口                                                      • 小程序开发火爆微信、支付宝官方同时提醒商家别上当                                                      • “微信、支付宝小程序”骗局：百元程序要价几万                                                      • 微信小程序支付功能开发与踩坑经验总结                                                      • 微信小程序再推iOS虚拟支付整改方案开发者该怎么办？                                                                                               "},{"title": "小程序tabbar这套方案全搞定！ ", "author": "                  Rolan                  2018-10-31 00:12                ", "text": "                                                                                                                                                                                     关于微信小程序的tarbar相信你们都不会陌生 在实现小程序微信原装的tabbar却比较呆板不够精致往往不符合自己的要求这个时候怎么办呢这套方案接着！先简单的来说一下主要思想:自定义字体图标组件以及tabbar组件在tabbar中引用自定义字体图标组件。先说一下这套方案的优点：图片换成字体,体积小,请求减少,性能提高自己定义tabbar,能够从细节各方面达到自己的要求精确到1像素组件可以根据自己的条件来更换tabbar图标（比如你点进一个页面想把这个页面的tabbar样式自己更换） 总而言之就是自由性很大精准性良好能够去随心所欲的打造你的专属tabbar!实现这套方案核心还是自定义组件那就从这开始聊：一个自定义组件由 json wxml wxss js 4个文件组成。一个页面要引用一个组件时只需要在该页面的json配置下添加如下{//声明引用一个组件 配置好你的组件引用路径  \"usingComponents\": {    \"icon\": \"../../components/icon/index\"  }}复制代码然后再页面上添加组件的标签即可。//这样就能够在你的页面中添加组件<icon type=\"\" color=\"\" size=\"\"/>复制代码如果对于组件的定义仍有疑惑的可以参考这份文档： 官方关于自定义组件的文档OK 下面我们正式来讲这份方案：先定义字体图标组件在阿里图标库里面挑选好你所需要的字体选择下载代码。 这里我选择的是其中的_fontclass方案把iconfont.css内的内容拷贝到你创建的icon目录下的index.wxss3. 将该目录下index.json添加{  //声明这一组文件设为自定义组件  \"component\": true,  \"usingComponents\": {}}复制代码在index.wxml中定义该组件的结构<!-- 注意style里面的分号！ --><text class=\"iconfont icon-{{type}}\" style=\"color:{{color}}; font-size:{{size}}rpx\" ></text>复制代码在js里面配置他的属性//这里定义了3个自定义属性他们通过{{}}与wxml中的数据连接起来 Component({  properties: {    type: {      type: String,      value: ''    },    color: {      type: String,      value: '#000000'    },    size: {      type: Number,      value: '45'    }  }})复制代码到此字体图标组件搞定。现在开始第二步搞定tabbar组件。首先做在json中添加配置{  \"component\": true,  //声明对字体图标组件的引用  \"usingComponents\": {    \"icon\": \"../../components/icon/index\"  }}复制代码写wxml结构<view class=\"weibo-tabbar\" >//绑定回首页事件此处的data-hi中的数据是为了传递到e.currentTarget.dataset.hi//通过这个数据我们可以用来判断是否处于首页然后在js中配置可以阻扰原地跳转    <view class=\"item-left\"  bindtap=\"goHome\" data-hi=\"{{isIndex}}\">            <icon type=\"shouye\" color=\"{{isIndex?'#000000':'#b1b1b1'}}\" size=\"45\"/>            <text class=\"1\" style=\"color:{{isIndex?'#000000':'#b1b1b1'}}\">首页</text>    </view>    <block wx:if=\"{{isInner}}\">        <view class=\"item-right\" style=\"color:#b1b1b1\" bindtap=\"goShare\">        <icon type=\"fenxiang\" color=\"gray\" size=\"45\"/>            <text class=\"2\">分享</text>        </view>    </block>    <block wx:else>        <view class=\"item-right\"  bindtap=\"goInfo\" data-hi=\"{{isIndex}}\">        <icon type=\"wode\" color=\"{{isIndex?'#b1b1b1':'#000000'}}\" size=\"45\"/>            <text class=\"2\" style=\"color:{{isIndex?'#b1b1b1':'#000000'}}\">我的</text>        </view>    </block></view>复制代码再配置js属性及方法const app = getApp();Component({  properties: {    isIndex: { // 是否主页                  type: Boolean,      value: false,    },    isInner: { //是否内部页面      type: Boolean,      value: false,    },  },  data: {    // 这里是一些组件内部数据    someData: {}  },  methods: {    // 这里是一个自定义方法    goHome: (e) => {      // 判断是否为主页面防止原地跳转      if(!e.currentTarget.dataset.hi){        wx.redirectTo({          url: \"/pages/index/index\"        })      }    },    goShare: function () {    },    goInfo: (e) => {        if(e.currentTarget.dataset.hi){        wx.redirectTo({          url: \"/pages/info/info\"        })      }    }  }})复制代码配置样式wxss.weibo-tabbar {    bottom: 0;    height: 97rpx;    padding: 12rpx 0rpx;    display: flex;    width: 100%;    position: fixed;    background: #ffffff;    box-sizing: border-box;}//产生优雅的0.5px边框.weibo-tabbar::after {    content: \"\";    position: absolute;    width: 200%;    height: 200%;    top: 0;    left: 0;    border-top: 1rpx solid rgba(177, 177, 177, 0.4);    transform: scale(0.5);    transform-origin: 0 0;  }  //这里用flex布局移动端flex布局确实很爽  .weibo-tabbar .item-left, .item-right{   //这里有一处坑若不不设置他的层级变大的话   //你是点不到这个item按钮的当然也不会产生触碰事件    z-index: 999;    width: 50%;    display: flex;    justify-content: center;    align-items: center;    flex-direction: column;    font-size: 20rpx;    color: #b1b1b1;}.shouye, .wode {    height: 45rpx;    width: 45rpx;}复制代码到此你只需要在你的页面优雅的添加一行就能在你的页面中产生tabbar//此处isIndex是给组件的属性传输值别属性不添加即为默认属性值<tabbar isIndex=\"true\"></tabbar>复制代码结果：哇看了半天就出这么一个小东西！其实大道至简掌握这套方案能够适配你需要的所有tabbar他的颜色、大小、位置都可以自己掌控重要的是这个解决方案。最后强调一下里面的一些坑按钮的样式层级z-index要提高属性值与{{}}传输的把握style=\"color:{{color}}; font-size:{{size}}\" 注意里面的;号                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序多层嵌套循环三级数组遍历               微信小程序之animation底部弹窗动画（两种方法）                                                                           来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序跳转tabBar携带参数怎么办？                                                      • 小程序中tabBar的使用心得                                                      • 小程序tabBar跳转页面并隐藏tabBar                                                      • 微信小程序--TabBar不出现                                                      • 小程序学习笔记1-tabBar、轮播图和九宫格                                                                                               "},{"title": "Flex 实现表格布局 （微信小程序） ", "author": "                  Rolan                  2017-8-18 00:35                ", "text": "                                                                                                                                                                                     微信小程序自己开发了一套 wxml + wxss对许多 HTML 标签和 CSS 属性不支持。不支持 table 标签推荐使用 flex 布局。自然而然的想法：flex 嵌套效果还不错贴代码如下：<view id=\"panel\" class=\"flex-column\">  <view class=\"flex-cell flex-row\">    <text class=\"flex-cell flex-row\">1</text>    <text class=\"flex-cell flex-row\">2</text>    <text class=\"flex-cell flex-row\">3</text>    <text class=\"flex-cell flex-row\">4</text>  </view>  <view class=\"flex-row flex-cell\">    <text class=\"flex-cell flex-row\">1</text>    <text class=\"flex-cell flex-row\">2</text>    <text class=\"flex-cell flex-row\">3</text>    <text class=\"flex-cell flex-row\">4</text>  </view>  <view class=\"flex-row flex-cell\">    <text class=\"flex-cell flex-row\">1</text>    <text class=\"flex-cell flex-row\">2</text>    <text class=\"flex-cell flex-row\">3</text>    <text class=\"flex-cell flex-row\">4</text>  </view>  <view class=\"flex-row flex-cell\">    <text class=\"flex-cell flex-row\">1</text>    <text class=\"flex-cell flex-row\">2</text>    <text class=\"flex-cell flex-row\">3</text>    <text class=\"flex-cell flex-row\">4</text>  </view>  <view class=\"flex-row flex-cell\">    <text class=\"flex-cell flex-row\">1</text>    <text class=\"flex-cell flex-row\">2</text>    <text class=\"flex-cell flex-row\">3</text>    <text class=\"flex-cell flex-row\">4</text>  </view></view>#panel{  height:65vh;  background:#fff;}#panel text{  line-height: 13vh;  border-right: 1rpx solid #ddd;  border-bottom: 1rpx solid #ddd;}.flex-row{  display: flex;  flex-direction: row;  justify-content: center;  align-items: center;}.flex-column{  display: flex;  flex-direction: column;  justify-content: center;  align-items: stretch;}.flex-cell{  flex: 1;}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    thinkphp5+easywechat开发小程序支付               实战案例-- 用Java编写基础小程序                                                        原作者: ppJuan                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 View：flex 布局                                                      • 微信小程序 瀑布流布局                                                      • [微信小程序]入门学习知识点_UI布局                                                      • 黄秀杰小程序入门佳品——增删改查+页面跳转+传值取值+布局样式 ... ... ...                                                      • 微信小程序开发--从block盒式布局到Flex弹性布局                                                      • 【基础】微信小程序flex布局                                                      • 解决微信小程序 wx.request 请求的并发数限制、不支持异步问题 ...                                                      • Flex布局                                                      • Flex布局在小程序的使用                                                                                               "},{"title": "微信小程序radio点选框，再次点击取消 ", "author": "                  Rolan                  2018-5-10 00:31                ", "text": "                                                                                                                                                                                     radio点击当前选项取消选择在网上尝试找了很多方法都不生效通过给radio绑定一个点击事件（bindtap）来实现这一功能直接看代码：index.wxml：<view class=\"page\">    <view class=\"page__hd\">        <text class=\"page__title\">radio</text>        <text class=\"page__desc\">单选框</text>    </view>    <view class=\"page__bd\">        <view class=\"section section_gap\">            <radio-group class=\"radio-group\" bindchange=\"radioChange\">                <radio  class=\"radio\"   bindtap = \"bindtap1\" wx:for-items=\"{{items}}\" wx:key=\"name\" value=\"{{item.name}}\" checked = \"{{item.checked}}\">                    <text>{{item.value}}</text>                </radio>            </radio-group>        </view>    </view></view>index.wss:.radio-group {    border-bottom: 1px solid #ddd;}.radio {    display: block;    border-top: 1px solid #ddd;    padding: 5px;}index.js:Page({  data: {    items: [      { name: 'USA', value: '美国', checked:false},      { name: 'CHN', value: '美国', checked: true },      { name: 'BRA', value: '巴西', checked: false},      { name: 'JPN', value: '日本', checked: false},      { name: 'ENG', value: '英国', checked: false},      { name: 'FRA', value: '法国', checked: false},    ],    aa:'CHN'  },  bindtap1:function(e){    var items = this.data.items;    for (var i = 0; i < items.length; i++){      if (items[i].name == this.data.aa){        for (var j = 0; j < items.length; j++) {          // console.log(\"items[j].checked = \", items[j].checked);          if (items[j].checked && j != i) {              items[j].checked = false;            }        }        items[i].checked = !(items[i].checked);        console.log(\"-----:\" ,items);        // this.setData(this.data.items[i]);      }    }    this.setData({      items: items    });  },  radioChange: function (e) {  // for(var i = 0;i<this.data.items.length;i++){  //   if (this.data.items[i].checked){  //     // console.log('radio发生change事件携带value值为：', this.data.items[i].name)  //   }  // }    this.data.aa = e.detail.value;    console.log(this.data.aa);  }})通过这样就可以实现radio的再次点击取消掉选择。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序出现bug如何快速让用户提供信息？               Android\"挂逼\"修练之行--微信小程序逆向辅助插件工具开发详解 ...                                                        原作者: 度度度                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序把玩《六》：picker组件radio组件slider组件                                                      • 微信小程序radio不能改变大小？那我自己写一个吧                                                      • 微信小程序开发问答《六十九》radio样式不能自定义 & 多个input如何方便的获取提交 .. ...                                                                                               "},{"title": "微信小程序基础 ", "author": "                  Rolan                  2018-3-7 00:25                ", "text": "                                                                                                                                                                                     2018 年过了不到一个月时间虽短但有一样新东西在这短短时间里就火了起来。从“跳一跳”到“坦克大战”再到“头脑王者”微信小游戏好像突然将时间拉回到了过去。餐桌上、休息时大家不再是各自刷着微博、段子而是聚在一起开始一场场紧（ge）张（zhong）刺（zhuang）激（bi）的对战。小游戏充分利用了人们零碎的时间并将娱乐和社交有效地结合起来。在小游戏推出之前本人是看衰小程序的所以一直没有入坑。然而小游戏狠狠地打了我的脸它的出现让我眼前一亮不单单让我觉得小游戏有着很大的想象空间更让我觉得微信这个平台有着无限的可能。当前微信是将小游戏作为小程序的一个分类所以暂时先亡羊补牢看看什么是小程序。小程序要学一样新东西的最好办法自然是看官网教程。小程序的官网是微信公众平台其他什么乱七八糟的都是外包广告啦~在官网上可以轻松地找到小程序和小游戏的教程。微信的教程也相当详细这边就不再赘述了。如果跟着教程走其中第二步微信会推荐你安装一个开发者工具这里要吹一波这个工具。接近完美的开发者工具新版的开发者工具和之前仅能够用于调试的代理工具完全不同可以说是鸟枪换炮。接着就来看一下这个工具到底惊艳在哪里？首次打开工具你会看到一个类似下图的界面会让你填一些项目的基础信息。其中的 AppID 可以通过注册获得不过即使没有 AppID 也可以先创建项目进行开发这里先选体验小程序。如果选择一个空文件夹作为项目的目录那么在工具的最下方就会出现一个模板项目的选项。勾选它创建的项目就包含了一个微信的 Demo 项目。这个小功能当然不是这个工具的亮点所在这里先点确定生成一个 Demo 项目。登登登等~有没有被惊艳到？工具左上角的 3 个按钮分别控制模拟器、编辑器和调试器区域的显示与否。模拟器和调试器的模样是不是非常熟悉？[滑稽]这个开发者工具可以说是集成了浏览器和 IDE以及代理等工具于一身所有的开发工作几乎可以在这一个工具中完成再也不用在一个个应用之间来回切换了。整洁、干净、完美！（要被吸粉了...）PS: 虽然可以在设置里修改编辑器的配置不过和真正的 IDE 比样子还是丑了一点。开发工具就说到这更多功能等你自己去探索。看完了酷炫的工具平复一下心情继续来看 Demo 项目。WXML, WXSS 和 WXS在 Demo 项目中你会看到两种新类型的文件：.wxml 和 .wxss。这也是我之前看（xian）衰（qi）小程序的主要原因它并没有使用标准的文件类型及语法而是创立了一套微信自己的标准。WXML先看一下 wxml 里面究竟有什么名堂？<!--index.wxml--><view class=\"container\">  <view class=\"userinfo\">    <button wx:if=\"{{!hasUserInfo && canIUse}}\" open-type=\"getUserInfo\" bindgetuserinfo=\"getUserInfo\"> 获取头像昵称 </button>    <block wx:else>      <image bindtap=\"bindViewTap\" class=\"userinfo-avatar\" src=\"{{userInfo.avatarUrl}}\" background-size=\"cover\"></image>      <text class=\"userinfo-nickname\">{{userInfo.nickName}}</text>    </block>  </view>  <view class=\"usermotto\">    <text class=\"user-motto\">{{motto}}</text>  </view></view>是不是又很熟悉？这不就是多了些默认组件的 vue 嘛。需要注意的是{{}} 与引号之间不能有空格否则会解析为字符串。其他语法层面就没有什么难点了再撸一遍基础组件文档就差不多了。WXSSwxss 的变化就更小了就多提供了一个单位 rpx。1rpx 等于屏幕尺寸的 1/750。（UI 出 750 的图就很好做啦...）剩下就提供了一些简单的选择器类、Id、元素和前后的伪类没有其他的学习成本。最后说一下 wxs（Demo 项目中没有用到）。WXS什么是 WXS？微信官方是这样说的：WXS（WeiXin Script）是小程序的一套脚本语言结合 WXML可以构建出页面的结构。wxs 与 javascript 是不同的语言有自己的语法并不和 javascript 一致。但是整个文档看下来除了在模块的处理上有些许的不同之外其他可以说是破产版的 js 吧。既然它是 js 的子集那么都用 js 来写也没什么毛病暂时也没有看出什么场景必须使用它。感觉整套都是 kpi 的产物哪...小程序其他的配置文件文档里已经写得很清晰了。至此小程序的基础就暂告一段落下篇将关于小游戏相关内容敬请期待。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发必备神器-Grace               微信小游戏初试                                                        原作者: DiscipleD                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 实战案例-- 用Java编写基础小程序                                                      • 小程序基础篇之页面路由                                                      • 微信官方小程序基础教程 - 起步                                                      • 微信官方小程序基础教程 - 代码构成                                                      • 微信官方小程序基础教程 - 小程序能力                                                      • 微信官方小程序基础教程 - 发布前的准备                                                      • 微信官方小程序基础教程 - 上线                                                      • 微信小程序入门-指南针                                                                                               "},{"title": "微信小程序开发调试，常见问题&解决 ", "author": "                  Rolan                  2017-11-24 00:28                ", "text": "                                                                                                                                                                                     在web开发的时候调试这一环是很重要的之前日常调试主要使用chrome浏览器不过最近在进行微信公众号开发的时候直接使用chrome进行调试总是感觉很麻烦因为涉及到微信验证及跨域等问题。当然在此之前试了很多其它的调试方法不过感觉还是微信官方提供的调试工具来得实在。下面记录下以便自己以后查看。下载&安装　　微信开发者工具：https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1455784140　　  微信小程序开发者工具：https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html?t=2017119　　上面是获取安装包的地址选择自己需要的版本进行下载安装。其实这两个工具都是微信官方出的工具应该是不同的版本暂且叫“微信开发者工具”和“微信小程序开发者工具”吧。其不同是“微信开发者工具”主要是对公众号web的调试在chrome的基础上进行修改的可以通过usb链接电脑进行真机调试。而微信小程序开发者工具则涵括了公众号开发调试和微信小程序开发调试不过试了下公众号开发调试的时候不能通过usb连接调试。　　安装时候要注意的是这两个工具要安装在不同目录不然会提示安装失败。并且要注意的是安装第二个的时候要把桌面已安装的快捷图标改名否则会被覆盖。设置跨域　　“微信开发者工具”在安装成功后桌面找到新增的快捷图标右击”属性->快捷方式->目标(T)\" 在最后加上  --disable-web-security --user-data-dir 前面记得留空格！　　“微信小程序开发者工具”跨域的话在开发小程序的模式下可以设置允许跨域具体操作：打开小程序项目->微信小程序开发工具界面上方“设置”->\"项目设置“->右边弹出”项目设置“->勾选”不校验安全域名、TLS 版本以及 HTTPS 证书“, ok! 如果在公众号网页调试的模式下要允许跨域的话暂时没找到设置方法找到再补充。连接真机调试　　还是在“微信开发者工具”的基础上连接调试具体步骤如下：　　1、手机端设置允许“USB调试”　　2、按照提示的步骤走如图　　　　3、点击“开始调试”后会打开新的页面显示连接情况如果没有显示连接设备可以重插usb或者刷新微信公众号页面看看如图：　　　　4、点击“inspect”会打开调试页面跟平常在chrome下调试一样只是最近打开却发现为空白页面后来查了下是因为被墙了的原因试着看能打开https://chrome-devtools-frontend.appspot.com 不如果不行就是被墙或者公司ip屏蔽了科学上网可以上github找下挺多的这里不推荐了。当然也可以试下清除缓存：chrome://appcache-internals/# 只是微信开发者工具里好像打不开chrome://appcache-internals/# 。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序中tabBar的使用心得               黄秀杰--Node后端优雅使用Bmob                                                        原作者: 风刮起的猪                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序架构分析《一》调试技巧模块构成理念分析                                                      • 微信小程序开发初探：工具界面调试区六大工具介绍                                                      • 从零开始：注册小程序及在手机上查看调试微信小程序                                                      • 面向新手《二十四》让凌乱的代码整齐紧凑单步调试及变量查看 ...                                                      • github精选：微信小程序调试之第三方应用调试技巧                                                      • 解决调试腾讯云微信小程序Demo错误“登录失败：调用鉴权服务失败#40029_WEIXIN_CODE_E ...                                                      • 小程序常见问题汇总                                                      • 微信小程序开发——本地调试                                                                                               "},{"title": "微信小程序实战--王者图鉴 ", "author": "                  Rolan                  2017-9-7 00:33                ", "text": "                                                                                                                                                                                     灵感源于今年很火的手游——王者荣耀偶尔用手机上网查找游戏数据并不是很方便于是有了开发“王者图鉴”小程序的想法。从官网爬取数据将英雄、装备、铭文等信息整合在微信小程序中随时随地查询游戏信息。预览效果展示线上体验微信扫一扫下方的小程序码立即体验：技术栈原型设计：sketch后台数据爬取：node.js + leancloud (开源地址)前端：小程序生态(WXML/WXSS/JavaScript...)使用首先点击右上角的 Fork 或者绿色按钮 Clone or download 下载源码使用微信开发者工具进行调试和开发。微信也提供了小程序开发文档从注册小程序、开发工具、开发调试到发布提供了整套方案类似Apple那样打造了一个自己的生态圈。项目一共9个页面涉及列表展示、英雄详情、装备分类、铭文条件筛选等功能由于后台使用了leancloud的存储服务所以没有使用小程序的ajax api并且引入的leancloud sdk需要依赖一个在名为 leancloud.config.js 的文件它被放在 utils文件夹里由于leancloud这类三方服务通常是弹性付费的并且王者图鉴已经在微信上正式发布所以我push代码时ignored了 leancloud.config.js 请谅解。leancloud.config.js 包含了leancloud应用的AppID和AppKey信息：module.exports = {  appId: '你的AppID',  appKey: '你的AppKey'}在使用项目之前需要自行创建leancloud应用并搭建我之前写的 王者荣耀官网爬虫 获取数据它们都需要leancloud.config.js 文件。总结简单来说说微信小程序的开发吧有段时间在网上炒得沸沸扬扬然后抽空看了看开发文档卧槽这不是Vue.js么？！看下面的示例就知道了。小程序：Page({\tdata: {\t\tlist: []\t},\tonload: function () {\t\tthis.setData({\t\t\tlist: [1, 2, 3]\t\t})\t}})<view wx:for=\"{{ list }}\">{{ item }}</view>Vue.js:new Vue({\tdata: {\t\tlist: []\t},\tmounted: function () {\t\tthis.list = [1, 2, 3]\t}})<view v-for=\"item in list\">{{ item }}</view>虽然api看起来都挺像但还是有明显区别的：小程序是单向数据绑定不提供类似vue的v-model指令数据绑定的表达式只支持在双大括号中如果写成 wx:for=\"item in list\" 就会报错操作数据对象需要调用setData方法触发更新而不是vue那样直接赋绑定事件需要模板指令声明是否冒泡小程序有两个线程分别对应View(视图)和AppService(逻辑)两个独立模块。View用来渲染模板、样式AppService则用来处理业务逻辑、数据请求、API调用等。感兴趣的同学可以参考：《微信小程序架构解析》。另外小黄人外卖团队的小程序文章也不错。说回「王者图鉴」这是我的第一个小程序对于有经验的前端跟着官方文档一天就能上手了。相比编码完成整个产品的原型UI设计对我而言是一个挑战排版、配色、交互十多天时间参考了很多产品也对设计有了更深层次的认识最终落地的效果我还是比较满意的。该项目开源代码仅供学习参考禁止商业用途。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)stella                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序之页面拦截器               微信小程序的探讨--与外站进行数据传输、前后端交互                                                        原作者: kaeyleo                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序实战--仿bilibil（哔哩哔哩）小程序                                                      • 微信小程序开发实战&电影小程序之（1）——基础目录、欢迎页面的创建 ...                                                      • 微信小程序开发实战&电影小程序之（2）——阅读页面轮播图-新闻列表页面构建-数据绑定 ...                                                      • 实战案例-- 用Java编写基础小程序                                                      • POI微信小程序实战                                                      • 实战--小程序扫雷                                                      • 小程序实战--天气预报                                                      • 微信小程序实战--成语接龙小程序                                                      • Prepack详细介绍及微信小程序优化的新思路                                                      • 微信小程序实战--Jgank小程序开发（一）                                                      • 微信小程序实战--高仿人民日报                                                      • 微信小程序实例--豆瓣电影                                                                                               "},{"title": "微信小程序实战--成语接龙小程序 ", "author": "                  Rolan                  2017-8-25 00:12                ", "text": "                                                                                                                                                                                     我是一名安卓程序员以前没有接触过前端开发直到有幸接手了公司的小程序项目。小程序学起来还是很快的对于有编程经验的人看着示例代码对照着官方文档几天就能上手了。自从接触了小程序一直想做一个自己的东西要是每天有点人用就更好了。有一天和我家宝宝玩成语接龙突然想到我可以做一个成语接龙的小程序啊！产品琢磨了两天大概想做成这样：接龙可以有「所有人可参与」、「指定群成员参与」等类型不校验是否是成语否则就无法使用「印贼做父」了成语的读音还是要校验一下的难免会有人乱填所以每条成语可以赞也可以踩在有一定数据量后可以增加排行榜设计想法有了还有两件比较棘手的事：起个牛逼的名字求我家宝宝给我画设计图我想过很多名字「成语接龙吧」、「接下去」、「接吧」、「接一个」...宝宝：low 爆了叫「碰词」碰也有接的意思成语也是个词嘛这么 6 的名字居然有人先想到了于是最终决定用「碰词er」随便放两张设计图美如画啥的就不说了：下面说一下在开发方面几个我认为值得一提的地方。获取用户信息现在大部分的小程序都是一打开就弹出用户信息授权框有的甚至强制需要授权才可使用。我之前做的一个也是需要拿到 unionId 去登录才能使用的为此我还写过一篇文章说明如何实现。但显然微信认为这是一个很不好的体验。在用户没有接触你的小程序之前凭什么要信任你把自己的用户信息暴露给你。为了规范用户信息的获取官方出了这篇文章：获取用户信息方案介绍（FAQ 里面有两个问题还是我提的）刚好拿这个小程序来实践一下。首先明确什么情况下需要用到用户信息。这里需要用户信息显示在成语旁所以在创建接龙或者发送成语之前需要先获取到用户信息。如果你只是进来看看是不需要你任何授权的只有点击了创建接龙的按钮或者发送成语的按钮才会弹出授权提示框。我是这样做的。没有用户信息时设置 button 的 open-type 为 getUserInfo点击会触发用户信息的获取。要是已经有用户信息了则是一个普通的跳转按钮：<view class=\"create-button\">  <button wx:if=\"{{hasUserInfo}}\" class=\"button\" bindtap=\"navigateToCreate\">    <image class=\"img\" src=\"/images/icon_add.png\" mode=\"aspectFit\"/>  </button>  <button wx:else class=\"button\" open-type=\"getUserInfo\" bindgetuserinfo=\"getUserInfo\">    <image class=\"img\" src=\"/images/icon_add.png\" mode=\"aspectFit\"/>  </button></view>当用户确定授权了可以在 bindgetuserinfo 绑定的方法里用 e.detail.userInfo 拿到用户信息。但还有个问题open-type=\"getUserInfo\" 要到基础库 1.3.0 才能用最好还是做一下低版本兼容处理。群能力目前小程序已经支持获取到微信群的群 id 和显示群名。当用户创建的接龙类型是指定群成员参与时指定的群就是第一个转发到的群。而成员也只有通过这个群的分享进入小程序才可参与接龙。下面说说这两种情况是如何获取到群 id 的。在可分享的页面调用 wx.showShareMenu() 显示转发按钮。添加 onShareAppMessage 方法并在里面设置分享信息：onShareAppMessage: function () {  var that = this  return {    title: \"一起来玩成语接龙！\",    path: 'pages/xxx/xxx?id=' + this.data.id,    success(res) {      that.getShareInfo(res.shareTickets[0])    }  }}在 getShareInfo 方法里需要获取到分享信息现在能获取到的只有群 id：wx.getShareInfo({  shareTicket: shareTicket,  success(res) {    // 解密获取到 openGId  }})这里和 getUserInfo 一样拿到的数据是加密的需要将 res.encryptedData 和 res.iv 传给后台解密。加密方式和 userInfo 是一样的所以可以用同一个接口解密。解密后的 openGId 就是我们要的群 id。至于从微信群进入的情况我们需要对 app.js 的 onLaunch 方法动手。在 onLaunch 方法里可以获取到一个场景值它区分了各种进入小程序的场景各种场景值说明可以在这里查到。其中可以看到：当场景值为 1044 时我们就可能获取到携带的 shareTicket：onLaunch: function (ops) {  if (ops != null && ops.scene == 1044) {    this.globalData.shareTicket = ops.shareTicket  }}之后再对这个 shareTicket 进行解密获取 openGId判断用户是否可参与。聊天列表从设计图可以看到成语列表是置底的类似微信聊天的效果。但列表都是默认置顶的如何让它置底呢？其实很简单这里利用了 scroll-view 组件的 scroll-into-view 属性：注意这里有个细节id 不能以数字开头但我的 id 就是数字开头的怎么办？前面随便加个字母就好了：<scroll-view class=\"scroll\" scroll-y=\"true\" scroll-into-view=\"x{{toView}}\">  <!-- ...... --></scroll-view>item 的 id 前面也记得加个 x。然后在获得页面数据 setData 之后将列表定位到底部：setTimeout(function () {  that.setData({    toView: list[list.length - 1].id  })}, 300)这里的延时是不可少的因为页面渲染需要点时间不同性能的手机需要的时间还不一样。看过几台手机300 毫秒应该是比较合适的。如果要实现滑动到顶部加载更多的话可以用上 bindscrolltoupper 这个属性：获取更多后将 toView 设置为新获取到的列表最后一项的 id。浮动按钮首页右下角的按钮美如画但是它会造成一定的遮挡。安卓里有一个叫 FloatActionButton 的控件当列表滚动时可以向下移动隐藏我尝试在小程序里实现类似的效果。我觉得遮挡其实只对列表最底部有影响所以当列表滚到底部时隐藏就好了发生滚动再显示。在不使用 scroll-view 的情况下页面触底会触发 onReachBottom 方法滚动会触发 onPageScroll 方法所以这个功能可以这样实现：jsonReachBottom: function (event) {  // 隐藏按钮避免遮挡  this.setData({    showBtn: false  })},onPageScroll: function (event) {  // 显示创建按钮  this.setData({    showCreateBtn: true  })}wxml<view class=\"button {{showBtn?'show-button':'hide-button'}}\"/>wxss.show-button {  transform: translateY(0);  transition: 0.3s;}.hide-button {  transform: translateY(180rpx);  transition: 0.3s;}是不是很简单效果还不错：但是这里面有两个坑：在开发工具上没什么问题但在真机上列表到达底部触发 onReachBottom 之后居然还会触发 onPageScroll。我的做法是在 onReachBottom 之后的三百毫秒内不显示按钮。在列表高度不满屏幕高度时向上滑动列表也会触发 onReachBottom但是不会触发 onPageScroll导致隐藏后就不会再显示了。解决方法是可以先判断列表是否可滚动不可滚动的情况下不隐藏按钮。总结刚开始在没有推广的情况下在我身边的人都不愿意玩的情况下每天会有一两百个新用户。在上次知晓程序推荐过后现在居然每天有一两千个新用户！流量费都快给不起了非常感谢大家的捧场。最后感谢我家宝宝做了这么好看的设计图。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)CrazyIdeas                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    熊晨沣蓝牙实战---小程序蓝牙连接的开发1.0               微信小程序--初始化完成自动切换到设定的tab页                                                        原作者: SouthernBox                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序实战--仿bilibil（哔哩哔哩）小程序                                                      • 微信小程序开发实战&电影小程序之（1）——基础目录、欢迎页面的创建 ...                                                      • 微信小程序开发实战&电影小程序之（2）——阅读页面轮播图-新闻列表页面构建-数据绑定 ...                                                      • 实战案例-- 用Java编写基础小程序                                                      • POI微信小程序实战                                                      • 实战--小程序扫雷                                                      • 小程序实战--天气预报                                                      • 微信小程序实战--王者图鉴                                                      • 微信小程序实战--Jgank小程序开发（一）                                                      • 微信小程序实战--高仿人民日报                                                      • 微信小程序实战 - 简易记事本                                                                                               "},{"title": "黄秀杰--Node后端优雅使用Bmob ", "author": "                  Rolan                  2017-11-27 00:24                ", "text": "                                                                                                                                                                                     数据库CRUD使用JS SDK对于增删改查、连表操作直接使用浏览器JS SDK在bmob.jshttps://www.bmob.cn/static/bmob_jssdk_quickstart.zip仅需加一个module.exports = Bmob导出就可以在Node使用了语法与小程序里写法一样优雅比Bmob提供的npm包要好用N倍。JS SDK的使用xmlhttprequest作ajax请求所以node下还要依赖xmlhttprequest npm包将\"xmlhttprequest\": \"^1.8.0\"添加到package.json dependencies里同样再加上\"localStorage\": \"^1.0.3\"。这样就改造完成了。代码说话看对比以下是Bmob npm库var BC = require('bmob');BC.initialize(\"9a22a7cb3217e88cac2e81fe7e88c600\", \"025c1282712e387a62b2bcd5a970f93c\");var db = new BC.Db;db.find({  \"table\":\"XXX\",          //表名  \"keys\":\"a,b,c\",         //返回字段列表多个字段用,分隔  \"where\":{\"a\":\"XXXX\",\"b\":\"XXXX\"},       //查询条件是一个JSON object  //\"where\":{\"c\":{\"$ne\":1}},       //条件查询 查询c字段值不为1的记录  \"order\":\"-a,b\",         //排序列表[-]字段名称,-表示降序默认为升序  \"limit\":10,            //limit大小一页返回多少条记录默认为0  \"skip\":2,             //skip,分页offset(page-1)*limit  \"count\":1            //count,只返回符合条件的记录总数 },function(err,data){    //回调函数 });注：对于表关联include操作一直没有发现怎么处理这是一个硬伤npm库也2年多没有维护了。以下是改造过的浏览器JS SDK//app.jsvar Bmob = require('./bmob.js');Bmob.initialize(\"9a22a7cb3217e88cac2e81fe7e88c600\", \"025c1282712e387a62b2bcd5a970f93c\");// bmobvar Food = Bmob.Object.extend(\"Food\");var query = new Bmob.Query(Food);query.include('category');query.limit(this.pageSize);query.skip(this.pageIndex * this.pageSize);query.find({    success: function(object) {        console.log(object);    },    error: function(object, error) {        alert(\"query object fail\");    }});使用connect-multiparty+request.js+RESTFul上传附件经过上面的改造可以操作数据库但对于附件上传还是要自己再增强'use strict';var router = require('express').Router();var multipart = require('connect-multiparty');var multipartMiddleware = multipart();var path = require('path');var fs = require('fs');var Bmob = require('../util/bmob.js');var {appId, appSecret} = require('../util/config');// 添加分类router.post('/upload', multipartMiddleware, function(req, res) {    console.log('uploading');    // 临时文件完整路径    var file_url = req.files.file.path;    // 截取文件名    var filename = path.basename(file_url);    console.log(filename)    /* request 上传 */    var request = require('request');    request.post({        headers: {            \"X-Bmob-Application-Id\": appId,            \"X-Bmob-REST-API-Key\": appSecret        },        url: 'https://api.bmob.cn/2/files/' + filename,        body: fs.readFileSync(file_url)    }, function optionalCallback(err, httpResponse, body) {        if (err) {            return console.error('upload failed:', err);        }        res.send(body);    });});module.exports = router;这里要注意不能像传统自己服务端那样使用formData的方式上传而是直接给body值——感谢Bmob的magic大大指点才从坑里出来。//formData: var formData = {//     file: fs.createReadStream(file_url),//}//或者//formData: var formData = {//     file: fs.readFileSync(file_url),//}经过以上2大改造就可以在Node中优雅得使用Bmob了我的灵犀外卖后端就是基于这个做出的。源码：https://git.oschina.net/laeser/dinner-web                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发调试常见问题&解决               小程序常见问题汇总                                                        原作者: 黄秀杰                   来自: 微信                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 黄秀杰--基于Bmob从零开始写一个博客小程序                                                      • 基于Bmob在小程序端实现一键支付                                                      • 微信小程序开发实践点滴——接入Bmob后端云及Bmob常用API的使用 ...                                                      • Bmob基本REST API的python封装                                                                                               "},{"title": "书籍讯息介绍：微信小程序开发实战 ", "author": "                  天下雪                  2016-12-7 22:11                ", "text": "                                                                                                                                                                                     天下雪的话：我发这篇文章非是软文或者广告文而是作者费心制作出一个电子书是一个为微信小程序大众谋取福利的事情并且作者正在更新我们作为一个全力支持微信小程序学习的网站应该要表示一下自己的支持并且也应该让广大学习者了解这样一个讯息；本电子书费用9.9元；作者：李宁：以下是部分免费章节截图：阅读地址：http://yuedu.baidu.com/ebook/b3af07cfb04e852458fb770bf78a6529647d35c9目录截图：                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    git精选：微信小程序新手跳坑指南21条               微信小程序讲解《一》——宏观了解心中有数                                                        原作者: 李宁                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序--实现多个按钮toggle功能 ", "author": "                  Rolan                  2017-6-13 00:59                ", "text": "                                                                                                                                                                                     如下图所示实现该按钮toggle功能。百度上很多都是只设置一个按钮的toggle所以我现在来稍微总结下：多个按钮如何实现自身的toggle功能。 原理：1列表展示的时候我们会用wx:for 来循环数据那么我们就会得到相应的当前的第几个数据（即 wx:key=\"index\"） 2.在每一个数据里面添加一个toggle的属性toggle=false 则不展示 3.设置一个点击方法获取当前按钮所在的是第几个数据然后将相应的toggle取反然后将修改后的数据重新写进去 (我出错的地方就在这) 4. 在wxml页面判断toggle的值是true/false 然后修改相应的class名 js代码：Page({    data:{      datas:[]    },    onLoad:function(options){      var that=this;      API.my_ajax('',function(res){  //用mock.js 设置的模拟数据调用格式        // console.log(res);        var listData=res.data;        for(var i=0;i<listData.length;i++){          listData[i]['toggle']=false;  //添加toggle 属性        }        that.setData({          datas:listData        })        // console.log(listData)      })    },    showBtn:function(e){      console.log(e);        console.log(this);    //这两个console.log 可以查看当前方法里面所有的数据可以查找一下我们所需要的内容是否有在里面底下的index 就是这样找到的     var a=e.currentTarget.dataset.index;      var b=this.data.datas[a].toggle;      this.data.datas[a].toggle=!b;      //设置之后我们要把数据从新添回去      this.setData({        datas:this.data.datas      })     }  })  wxml代码：<!--使用二维码按钮-->              <label class=\"icon_qrcode_wrap\" data-index=\"{{index}}\" bindtap=\"showBtn\">                  <text>使用规格及二维码</text>                  <image class=\"icon_right\" src=\"../../images/up.png\"></image>              </label>              <!--弹出二维码样式-->              <view  class=\"qrcode_show_wrap {{item.toggle==true ? '':'none'}}\">                  <view class=\"qrcode_container\">                      <!--<image class=\"qrcode_big_bg\"src=\"../../images/qrcode_black_bg.png\"></image>-->                      <view class=\"block_qrcode_wrap\">                          <image class=\"tiaoma\" src=\"../../images/tiao_code.png\"></image>                          <image class=\"rqcode\" src=\"../../images/rq_code_img.png\"></image>                          <text style=\"display:block;\" class=\"fs12\">erwr43545</text>                      </view>                      <text class=\"rq_code_title cfff fs13\">使用规则</text>                      <text class=\"cfff code_txt\">就掉粉丝活生生的谁让他和人文就掉粉丝活生生的谁让他和人文就掉粉丝活生生的谁让他和人文</text>                  </view>              </view>          </view>  gyhtr                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)w珞璃86                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序：商城系列专辑（开发指南+精品Demo）               微信小程序 监听手势滑动切换页面                                                        原作者: 百分乐                   来自: csdn博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序缓存--根据不同的id来进行设置和读取缓存                                                      • 通过微信小程序“运维密码”实现SSH双因子认证                                                      • 微信小程序左滑显示按钮demo                                                                                               "},{"title": "github精选：微信小程序入坑指南 ", "author": "                  天下雪                  2016-12-29 01:31                ", "text": "                                                                                                                                                                                     本文作者：wxdev来自githubv0.11.122100微信web开发者工具 -> 项目开启如下选项： 开启 ES6 转 ES5 开启 上传代码时样式文件自动补全 开启 代码压缩上传 监听文件变化自动刷新开发者工具 开发环境不校验请求域名以及 TLS 版本打包后不能大于 1MB 没用的文件不要加到你的工程。只支持 HTTPS 请求需要在微信公众平台设置安全域名。资源文件（图片、字体等）尽量使用远程路径减小体积。底部 tab 图标必须是本地路径。建议布局类资源放本地（打开快、体验好）展示类资源放远程（不影响体验）。建议使用 CSS Flexbox 布局抛弃浮动布局。建议使用 rpx 单位代替 rem会自动以宽度 750px PSD 为标准自适应不同设备。.demo {    width: 100rpx; /* 图层 100px就写 100rpx */}不支持后代选择器、子选择器（虽然真机当前版本支持但是不保证以后支持不建议使用）。.parent .child {} /* 不支持 */.parent > .child {} /* 不支持 */可以借鉴 CSS BEM 命名法来尽量避免类名冲突的问题。真机 background-image 不支持本地路径只能使用 <image src=\"\" /> 或者 远程路径<image /> 需要设置样式 height 才能撑开不像 HTML 中的 <img /> 会自动适应宽高。可以利用 mode 属性来设置图像的缩放模式。建议使用 ES6 语法进行开发但是需要自行引入 es6 polyfill用到什么才引入什么不要加入无用的代码。最多只能打开 5 个新页面需要合理利用 <navigator open-type=\"navigate | redirect | switchTab\" />、wx.navigateTo()、wx.redirectTo()、wx.switchTab()、wx.navigateBack()。wx.setNavigationBarTitle()、wx.showToast() 等 API需要在 Page onReady() 生命周期后调用否则可能会无效。页面与页面、组件与组件之间通信可以用一个全局共享的事件对象。databus.js// 这里用 eventemitter 做示例也可以选择其它的事件库（eventproxy 等）或者自己实现import EventEmitter from 'path/to/eventemitter'export default new EventEmitter()page-a.jsimport databus from 'path/to/databus'// 接收数据databus.on('demo', data => console.log(data))page-b.jsimport databus from 'path/to/databus'// 发送数据databus.emit('demo', {hello: 'world'})                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (3)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (3 人)Duobewu529778790yf641370637                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    面向新手《十一》：weui-wxss的使用page.json中背景色不生效               小程序_弹力小球（新手看看就算了老鸟快去找虫吃0.0）                                                        原作者: wxdev                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • git精选：微信小程序新手跳坑指南21条                                                      • 微信小程序跳坑                                                      • 兜兜乐客：微信小程序犀牛课堂培训课完整PPT                                                      • 微信小程序学习知识精选                                                      • github精选：微信小程序踩坑集合（更新）                                                      • 微信小程序开发入坑指南                                                      • github精选：构建自己的第一个小程序                                                      • 小程序踩坑记《一》初始化显示指定界面scroll-view上拉加载与page的下拉刷新冲突 ...                                                                                               "},{"title": "微信小程序UI规范 ", "author": "                  Rolan                  2018-9-1 00:12                ", "text": "                                                                                                                                                                                                                                                                 微信小程序设计的基本原则是微信设计中心针对在微信类上线的小程序页面总结的设计指南及建议。以下设计原则都是基于对用户的尊重的基础上的旨在微信生态类建立有号、高效、一致的用户体验的同时最大程度顺应和支持各业务需求设计实现用户与程序的共赢。一、有好礼貌为了避免用户在微信中使用小程序服务时注意力被周围复杂环境干扰小程序哎设计时应该注意减少无关的设计元素对用户目标干扰礼貌地向用户展示程序侧提供的服务友好地引导用户进行操作。1. 重点突出每个页面都应有明确的重点以便于用户每进入一个新页面的时候都能快速地理解页面内容在确定了重点的前提下应尽量避免页面上出现其他干扰项影响用户的决策和操作。反例示意此页面的主题是查询却添加了诸多与查询不相关的业务入口与用户的预期不符易造成用户的迷失。纠正示意去掉任何与用户目标不相关的内容明确页面主题在技术和页面控件允许的前提下提供有助于用户目标的帮助内容比如最近搜索词常用搜索词等。反例示意操作没有注册让用户无从选择纠正示意首先要避免并列过多操作让用户选择在不得不并列多个操作时需区分操作主次减轻用户的选择难度。2. 流程明确为了让用户顺畅地使用页面在用户进行某一个操作流程时应避免出现用户目标流程之外的内容而打断用户。反例示意用户本打算进行搜索在进入页面时却被突如其来的抽奖弹窗所打断；对于抽奖没有兴趣的用户是非常不友好的干扰平添一份对开发团队的恼怒；而即使有部分用户确实被“诱人”的抽奖活动所吸引离开主流程去抽奖之后可能就遗忘了原本的目标进而失去了对产品真正价值的利用和认识。二、清晰明确作为一个负责任的开发者一旦用户进入我们的小程序页面就有责任和义务清晰明确告知用户身在何处、又可以往何处去确保用户在页面中游刃有余地穿梭而不迷路这样才能为用户提供安全的愉悦的使用体验。1. 导航明确来去自如导航是确保用户在网页中浏览跳转时不迷路的最关键因素。导航需要告诉用户我在哪我可以去哪如何回去等问题。首先在微信系统内的所有小程序的全部页面均会自带微信提供的导航栏统一统一解决我在哪如何回去的问题。在微信层级导航保持体验一致有益用户在微信内形成较为统一的体验和交互认知无需在各小程序和微信切换中新增学习成本或使用习惯。微信导航栏微信导航栏直接继承于客户端除导航栏颜色之外开发者无需亦不可以对其中的内容进行自定义。但开发者需要规定小程序各个页面的跳转关系让导航系统能够以合理的方式工作。微信导航栏分为导航区域、标题区域以及操作区域。其中导航区控制程序页面进程。目前导航栏分深浅两种基本配色在iOS和Android展示有所不同如下图所示：导航区（iOS）导航区通常只有一个操作即返回上一级界面。开发者可定义其内容不可对样式进行修改。导航区（Android）通常情况下系统导航左侧唯一的操作为“离开小程序回到微信程序后台运行”。当用户进入小程序次级页面后我们建议小程序自身可以设计返回操作同事用户也可以通过安卓系统自带的硬件返回按钮返回上一级。微信导航栏自定义颜色规则（iOS和Android）小程序导航栏支持基本的背景颜色自定义功能选择的颜色需要在满足可用性前提下和谐搭配微信提供的两套主导航栏图标。建议参考以下选色效果：选色方案示例：页面内导航开发者可根据自身功能合计需要在页面内添加自有导航。并保持不同页面间导航一致。但是受限于手机屏幕尺寸的限制小程序页面的导航应尽量简单若仅为一般线性浏览的页面建议仅使用微信导航栏即可。微信控件库提供tab导航供开发者选择。tab栏可固定在页面顶部或者底部便于用户在不同的tab页面间作切换。为确保点击区域tab项不得超过4项。一个页面也不应出现一组以上的tab栏。2. 减少等待反馈及时页面的过长时间的等待会引起用户的不良情绪使用微信小程序项目提供的技术已能很大程度缩短等待时间。即便如此当不可避免的出现了加载和等待的时候需要予以及时的反馈以舒缓用户等待的不良情绪。启动页设计小程序启动也是小程序在微信内容一定程度上展现品牌特征的页面之一。本页面将突出展示小程序品牌特征和加载状态。启动页除LOGO品牌展示外页面上的其他所有元素如加载进度指示由微信统一提供且不能更改。无需开发者开发。下拉标示区微信类所有小程序页面都会再下拉时出现微信为其统一设计的标示区。品牌展示区由品牌名称和微信小程序提示组成。目的是强化品牌和用户对小程序的产品感知。下拉标示（iOS深浅两色方案）微信提供深浅两套配色方案如此处标示所示文字颜色不可自定义开发者在自定义背景色时应注意保证下拉标示的辨识度。下拉标示（Android深浅两色方案）微信下拉提示用于给用户明确的小程序归属者防止造假与作弊。此处标示提供深浅两套方案文字颜色不可自定义开发者在自定义背景色时应注意保证下拉标示的辨识度。页面刷新交互（iOS）开发者可自定义需要通过下拉交互完成刷新的页面此类交互微信将提供标准能力和样式。在样式上刷新图标与下拉标示配色已捆绑分为深浅两套方案开发者在使用时应注意头部文字、下拉标示与刷新图标的和谐统一。但用户在该类页面做出下拉交互时出现微信小程序页面标准加载动画。开发者无需自行开发样式。在开发者没有在页面顶部设计tab的情况下若定义该页面可通过下拉动作刷新则刷新后加载状态提示语小程序品牌展示区出现在标题栏之下页面顶部。开发者暂无法执行定义此加载效果。在开发者定义了页面顶部tab并定义该Tab下的内容页面可通过下拉动作刷新则刷新后加载状态提示语小程序品牌展示区出现在顶部Tab之下且仅刷新当前页面内容。开发者暂无法自行定义此加载效果。页面刷新交互（Android）与iOS相同在样式上Android下刷新图标与下拉标示配色已捆绑分为深浅两套方案开发者在使用时应注意头部文字、下拉标识与刷新图标的和谐统一。微信下拉标示错误使用案例请避免以下错误使用情况确保信息的可见性和页面的可用性。页面内导航微信控件库提供深浅tab导航方案供开发者选择。tab栏需固定在页面顶部便于用户在不同的tab页面间作切换。为确保点击区域tab项不得超过4项。一个页面也不应出现一组以上的tab栏。Tab栏选中态默认为100%实色未选中态带有60%其中选中态颜色可自定义。在自定义颜色选择中务必保持Tab的可用性、可视性和可操作性。页面内加载反馈开发者可在小程序里自定义页面内容的加载样式。建议不管是使用在局部还是全体自定义加载样式都应该尽可能简洁并使用简单动画告知用户加载过程。开发者也可以使用微信提供的统一的页面加载样式如图中例所示。模态加载模态的加载样式将覆盖整个页面的由于无法明确告知具体加载的位置或内哦让那个将可能引起用户的焦虑感因此应谨慎使用。除了在某些全局性操作下不要使用模态的菊花。局部加载反馈即旨在触发加载的页面局部进行反馈这样的反馈机制更加有针对性页面改动小是微信推荐的反馈方式。例如：加载反馈注意事项若加载时间较长应提供取消操作并使用进度条显示载入的进度。载入过程中应保持动画效果；无动画效果的加载很容易让人产生该界面已经卡死的错觉。不要再同一个页面使用超过1个加载动画。结果反馈除了在用户等待的过程中需予以及时反馈外对操作的结果也需要予以明确反馈。根据实际情况看可选择不同的结果反馈样式。对于页面局部的操作可在操作区域予以直接反馈对于页面级操作结果可使用toast、弹窗或结果页面展示。页面局部操作结果反馈对于页面局部的操作可在操作区域予以直接反馈例如点击多选控件前后如下图。对于常用控件微信设计中心已提供控件库及WeUI控件库其中的控件都已设计有完整的操作反馈。页面全局操作结果——toast其中toast适用于轻量级的成功提示1.5秒后自动消失并不打断流程对用户影响较小适用于不需要强调成功专题的操作提醒。特别注意toast形式不适用于任何错误提醒。页面全局操作结果——弹框对于需要用户明确知晓的操作结果状态可通过弹框来提示并可附带下一步操作指引。页面全局操作结果——结果页对于操作结果已经是当前流程的终结的情况可使用操作结果页来反馈。这种方式最为强烈和明确的告知用户操作已经完成并可根据实际情况给出下一步操作的指引。3. 异常可控有路可退在设计任何的任务和流程时异常状态和流程往往容易被忽略而这些异常场景往往是用户最为沮丧和需要帮助的时候因此需要格外注意异常状态的设计在出现异常时予以用户必要的状态提示并告知解决方案使其有路可退。要杜绝异常状态下用户莫名其妙又无处可去卡在某一个页面的情况。2.2中所提到的弹窗和结果页面都可作为异常状态的提醒方式。除此之外在表单页面中尤其是表单项较多的页面中还应明确指出出错项目以便用户修改。异常状态——表单出错表单报错在表单顶部告知错误原因并标识出错误字段提示用户修改。三、便捷优雅从PC时代的物理键盘鼠标到移动端时代手指虽然输入设备极大精简但是手指操作的准确性却大大不如键盘鼠标精确。为了适应这个变化需要开发者在设计过程中充分利用手机特性让用户便捷优雅的操控界面。1. 减少输入由于手机键盘区域小且密集输入困难的同时还易引起输入错误因此在设计小程序页面时因尽量减少用户输入理由现有接口或其他一些易于操作的选择控件来改善用户输入的体验。减少输入巧用接口例如下图中在添加银行卡时采用摄像头识别SDK接口来帮助用户输入。除此之外微信团队还对外开放例如地理位置接口等多种SDK接口（详见微信JS-SDK）充分利用这些接口将大大提高用户输入的效率和准确性进而优化体验。除了利用接口外在不得不让用户进行手动输入时应尽量让用户做选择而不是键盘输入。一方面回忆易于记忆让用户在有限的选项中做选择通常来说是容易于完全靠记忆输入；另一方面仍然是考虑到手机键盘密集的单键输入极易造成输入错误。例如图中在用户搜索时提供搜索历史快捷选项将帮助用户快速进行搜索而减少或避免不必要的键盘输入。2. 避免误操作一位内在手机上我们通过手指触摸屏幕来操控界面手指的点击精确度远不如鼠标因此在设计页面上需点击的控件时需要充分考虑到其热区面积避免由于可点击区域过小或过于密集而造成误操作。当简单的将原本在电脑屏幕上使用的界面不做任何适配直接移植到手机上时往往就容易出现这样的问题。由于手机屏幕分辨率各不相同因此最适宜点击像素尺寸也不完全一致但换算成物理尺寸后大致是在7mm-9mm之间。在微信提供的标准控件库中各种控件均已考虑到了页面点击效果以及不同屏幕的适配因此再次推荐使用或模仿标准控件尺寸进行设计。3. 利用接口提升性能微信设计中心已推出了一套网页标准控件库包括sketch设计控件库和WeUI重构代码库这些控件都已充分考虑了移动端页面的特点能够保证其在移动端页面上的可用性和操作性能；同事微信web开发团队也在不断完善和扩充微信JS-SDK接口并提供微信公共库利用这些资源不但能够为用户提供更加快捷的服务而且对页面性能的提高有极大作用无形之中提升了用户体验。四、统一稳定除了以上所提到的种种原则建议接入微信的小程序还应该时刻注意不同页面间的统一性和延续性在不同的页面尽量使用一致的控件和交互方式。统一的页面体验和有延续性的界面元素都将帮助用最少的学习成本达成使用目标减轻页面跳动所造成的不适感。正因如此小程序可根据需要使用微信提供的标准控件以达到统一稳定的目的。五、视觉规范为方便设计师进行设计微信提供一套可供Web设计和小程序使用的基础控件库；同时方便开发者调用。1. 字体规范常用字号为20181716141311（pt）使用场景具体如下：微信类字体的使用与所运行的系统字体保持一致以导航为例iOS与Android对应字体如下：导航（iOS和Android）字体颜色主内容Black黑色次要内容Grey灰色；时间戳与表单缺省值Light灰色；大段的说明内容而且属于主要内容用Semi黑；蓝色为链接用色绿色为完成字样颜色红色为出错用色Press与Disable状态分别降低透明度为20%与10%；2. 列表视觉规范3. 表单输入视觉规范4. 按钮使用原则列表外按钮上文字标准按钮高度为44px下使用：颜色#000000 / #353535 字号18pt可点状态下文字调整透明度为60%不可点状态下文字调整透明度为30%列表外按钮上文字标准按钮高度为25px下使用：颜色#000000 / #353535 字号14pt页面线性按钮上文字标准按钮高度为35px下使用：颜色#09BB07 / #353535 字号16pt5. 图标使用原则                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)w青呈84wjojo13                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            2个方面总结：小程序的产品设计               小程序产品设计中的坑                                                        原作者: 曾二                   来自: 叽哩叽哩                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 手机界面设计尺寸规范                                                                                               "},{"title": "微信小程序：设计的6个关键词及设计思路 ", "author": "                  天下雪                  2016-11-23 10:57                ", "text": "                                                                                                                                                                                                                                                                 第一部分：设计的6个关键词微信小程序和传统的APP存在较大的差异所以在设计小程序时不能以传统APP的思维来实现要采用与之相匹配的小程序思维进行设计。那么可以从以下6个关键词中思考：轻量：让用户便捷、迅速、简单地获取服务不要挑战微信的产品观。社交：必须和微信生态融入那就必须考虑到微信的生态基因。抛开社交关系链做的话最大的可能性是过于平庸导致反响平平。价值：小程序本身不是为了哗众取众必须对用户有切实的价值能够让用户在有需要时主动进入主动唤醒。引流：对于第三方来说微信必须是重要的流量入口。在微信允许的范围内用可能的手段获取用户流量是我们需要着重考虑的。数据：即便没有引流成功至少要获取用户数据支持自有APP开展业务。生态：如果已经有了微信公众号、服务号在微信生态内考虑和小程序相互依托互为补充。第二部分：设计思路1、重点内容不要局限于工具思维而是基于服务做拓展外延很多文章都在聊小程序目前最好做的是工具。话虽然没错但不要局限于工具思维最核心的仍然是服务。从目前你所在的业务大类出发用户究竟需要什么样的服务？用户在进入APP前和离开APP后场景上需要有什么补充？可能分析下来和你的APP主营业务并不完全一致没有关系只要能达到你对微信小程序的预期就可以了。举例来说如果一家阅读类APP只是单纯将内容聚类和搜索的功能移植到微信小程序并不能给用户带来更多期待也很难做到让用户主动去唤醒小程序。如果跳出APP主营业务回归阅读这件事本身用户在开始阅读之前如何引起阅读兴趣？阅读之后是否有摘录的需求？这时候或许深挖摘录这个点会比直接做内容更有意义。2、自有APP切入社交关系微信的社交关系链是个大宝藏从这个点切入和微信的使用场景做结合用户也更好接受。而更有意义的是利用微信小程序获取用户社交关系拓展自有产品的业务模式和服务范围。仍以阅读类APP为例假设上述的摘录需求和社交做结合在摘录中可以二次批注相互交流不断深挖既能把主营业务和社交结合起来又符合价值化、轻量化、略带浪漫主义情节的微信产品观。3、融入微信生态时刻记得微信小程序是在微信内与微信的所有功能息息相关要尽可能深入地融入微信生态不要孤立地做设计。微信小程序是微信生态的一部分更是衔接用户、服务、信息三者的重要载体在设计之初就要考虑到生态的搭建和后续扩展。继续说阅读类APP如果确定要通过摘录做切入点那么摘录的来源可能是公众号推送的文章、群聊天记录、或者是自家服务号推送的活动信息让你的小程序融入整个微信并为后续服务升级、用户体系升级、变现模式、或者是衔接微信的其他功能服务留好余地。4、如果不能直接分享到朋友圈那就换一个姿势分享相信获取流量是各家都想实现的目标分享功能依然重要。如果微信不允许直接分享到朋友圈那么就在聊天上多下功夫一个群聊内的分享并不一定比朋友圈差。又或者使用其他手段将你的微信小程序暴露在朋友圈里间接实现分享的目的。再次还有扫一扫和搜索可以利用。总之在不触犯微信规则的前提下尽可能扩大你能接触到的用户范围。5、胜在轻巧微信小程序的设计方案需要遵从轻巧的原则。这两个字要分开来看：一个是轻即轻量用户能够快速进入快速享受到服务快速离开使用过程中没有心理负担；一个是巧即巧妙创意永远是制胜法宝仅仅移植web或app的功能很难达到预期的目标只有为微信小程序量身订制、富有创新、充满心意的设计才能稳稳把红利抓牢。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (1)                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)wx_AlphaGo十11hiform                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                                           手机界面设计尺寸规范                                                        原作者: liujia216                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序SEO优化                                                                                               "},{"title": "小程序生成图片库 ", "author": "                  Rolan                  2018-7-5 00:12                ", "text": "                                                                                                                                                                                     Painter由于我们无法将小程序直接分享到朋友圈但分享到朋友圈的需求目前又很多业界目前的做法是利用小程序的 Canvas 功能生成一张带有二维码的图片然后引导用户下载图片到本地后再分享到朋友圈。而小程序 Canvas 功能是很难用的往往为了绘制一张简单图片就得写上一堆 boilerplate code 。如果此时一个小程序中包含多个绘图的需求那绝壁要疯。另外 Canvas 上有很多绘图的坑肯定会让你疯上加疯。这边说上几个小程序 Canvas 的坑：1 Canvas 绘图是用的 px而在小程序中我们一般使用 rpx 进行相对布局。2小程序的 drawCanvas 方法在 IDE 中可以直接设置网络图片进行绘制但在真机上设置网络图片无用。3canvasContext.clip 方法在 iOS 设备上 微信 6.6.6 版本及以下有 bug会导致该 clip 下面使用的的 restore 方法失效。画家计划想到小程序中有如此大量的生成图片需求而 Canvas 生成方法又是如此难用和坑爹。那我们就想到可不可以做一款可以很方便生成图片的库而且还能屏蔽掉直接使用 Canvas 的那些坑呢。所以我们发起了 “画家计划— 通过 json 数据形式来进行动态渲染并绘制出图片”。 Painter 库的整体架构如下：首先我们定义了一套绘图 JSON 规范开发者可以根据需求构建生成图片的 Palette（调色板）然后在程序运行过程中把调色板传入给 Painter（画家）。Painter 会调用 Pen（画笔）根据 Palette 内容绘制出对应的图片后返回。How To Use运行例子因该项目为 submodule 管理方式。首次 clone 代码时需加上 --recursive 参数。git clone https://github.com/Kujiale-Mobile/Painter.git --recursive代码下载后用小程序 IDE 打开后即可使用。使用 Painter引入代码可以在主项目下执行以下命令通过 submodule 的方式引入 painter 组件。建议是在 components 目录下。git submodule add https://github.com/Kujiale-Mobile/PainterCore.git painter作为自定义组件引入注意目录为第一步引入的代码所在目录\"usingComponents\":{  \"painter\":\"/components/painter/painter\"}组件接收 palette 字段作为画图数据的数据源, 图案数据以json形式存在推荐使用“皮肤模板”的方法进行传递示例代码如下：数据传入后则会自动进行绘图。绘图完成后你可以通过绑定 imgOK 或 onImgErr 事件来获得成功后的图片 或失败的原因。bind:imgOK=\"onImgOK\"bind:imgErr=\"onImgErr\"Palette 规范如你使用 wxss + wxml 规范进行绘制一样Painter 需要根据一定的规范来进行图片绘制。当然 Painter 的绘制规范要比 wxml 简单很多。调色板属性一个调色板首先需要给予一些整体属性background: 可以是颜色值也可以为网络图片的链接默认为白色width: 宽度height: 高度borderRadius: 边框的圆角（该属性也同样适用于子 view）views: 里面承载子 view子 View 属性当我们把整体的调色板属性构建起来后里面就可以添加子 View 来进行绘制了。typecontentdescription自有cssimageurl表示图片资源的地址本地或网络texttext文本的内容fontSize: 文字大小color: 字体颜色（默认为黑色）rect无矩形color: 颜色qrcodecontent画二维码background: 背景颜色（默认为透明色）布局属性以上 View 除去自己拥有的特别属性外还有以下的通用布局属性属性意义rotate旋转按照顺时针旋转的度数默认不旋转borderRadius边界圆角程度如果是正方形布局该属性为一半宽或高时则为圆形top、right、bottom、left如 css 中为 absolute 布局时的作用默认 top 和 left 为 0尺寸即其他1目前 Painter 中支持两种尺寸单位px 和 rpx代表的意思和小程序中一致此处就不多说。2目前子 view 的 css 属性支持 object 或 array。所以意味着你可以把几个子 view 共用的 css 属性提取出来。做到让 Palette 更加简洁。3因为我们的 palette 是以 js 承载的 json所以意味着你可以在每一个属性中很方便的加上自己的逻辑。也可以把某些属性单独提取出来让多个 palette 共用做到模块化。举个栗子{  background: '#eee',  width: '654rpx',  height: '400rpx',  borderRadius: '20rpx',  views: [  {    type: 'image',    url: 'https://qhyxpicoss.kujiale.com/r/2017/12/04/L3D123I45VHNYULVSAEYCV3P3X6888_3200x2400.jpg@!70q',    css: {      top: '48rpx',      right: '48rpx',      width: '192rpx',      height: '192rpx',    },  }  ],}绘制效果如下LicenseCopyright (c) 2018 KujialeLicensed under the Apache License, Version 2.0 (the \"License\");you may not use this file except in compliance with the License.You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0Unless required by applicable law or agreed to in writing, softwaredistributed under the License is distributed on an \"AS IS\" BASIS,WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.See the License for the specific language governing permissions andlimitations under the License.                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序如何获取地理位置和进行地图导航               Taro实践 - TOPLIFE小程序 开发体验                                                        原作者: Kujiale-Mobile                   来自: github                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序利用canvas生成海报分享图片                                                      • 小程序上传一张或多张图片到阿里云OSS                                                      • 小程序基础核心组件库处理Banner、图片上传、列表刷新                                                      • 微信小程序设置图片固定比例                                                      • 小程序页面效果 - 下载图片并且显示进度                                                                                               "},{"title": "微信小程序朋友圈分享图片生成方案实现 ", "author": "                  Rolan                  2018-8-9 00:03                ", "text": "                                                                                                                                                                                     在小程序界里生成图片分享到朋友圈这个功能是如此得光芒耀眼以至于各个小程序都趋之若鹜地前来跪倒在她的石榴裙下。不幸的是微信爸爸并没有提供给我们很好很便捷的相关工具；恰恰相反屏幕截屏的功能被残忍丢进历史的垃圾桶只留下一个Canvas组件以及围绕在其周围的深渊巨坑们。所以我们准备了一套名为Painter的工具 为开发者提供一种简单实用的“绘制”图片的解决思路让开发者可以自由地生成自己想要的图片文件。github传送门： github.com/Kujiale-Mob…如果直接使用canvas进行绘图那绝对是很酸爽的一次体验除了失控的代码还有无数的天坑。先来列举一下canvas 中踩过的坑以及我们的解决（或绕过）的方法。canvas的坑painter从实现上来讲是用了小程序的canvas作为载体来实现以上功能的。而canvas有很多著名的坑。有的坑我们小心翼翼地绕了过去；有的坑我们还是痛快淋漓地一脚踩了下去……在微信版本6.6.6的某些ios机型上canvas的clip()方法不能被restore。导致在这些机型上无法进行切圆角的操作。迫于无奈在开发中我们不得已抛弃了这些机型用了一个if语句将这些机器的切圆角功能阉割了。。。小程序的canvas提供了measuretText()方法暂时只支持测量文本宽度无法知道文字的具体高度。因此一些元素对齐的需求无法做到很漂亮。在绘制图片的时候有几率会发生很神奇的表现即canvas绘图的时候位置出现整体偏差造成最后生成的图片有残缺。这种情况大多数时候发生在onLoad中调用painter的情况下。我们处理的方法是对图片的宽和高比例进行检测一旦出现异常就重新绘制一遍。canvas不能绘制网络图片。canvas.drawImage(url)方法给url传入一个网络链接在模拟器上表现完美然而在真机上无法绘制。我们在Painter中引入了一套自己的网络图片下载后绘制的机制并在其中加入了LRU存储管理机制。canvas是原生组件始终位于视图的最上层z-index设置对其无效。这个就不多说了。。很多人应该都踩过。canvas要进行绘制则canvas组件必须真实地被写在页面上而且其wx:if不能为false。不过允许把canvas组件放置在屏幕之外如设置position:fixed;left:750rpx;。这一方法是可以解决56两点问题的黑科技Painter的功能如图所示通过右边的类似于css又有点像json但其实上它是个js的寥寥几行代码我们绘制出了左边的这样的图形包含了背景图片、文字、图片、二维码这四种常用的元素。Painter阅读完代码绘制成图片以后会将图片的链接返回给我们。此时我们可以将图片上传、保存到本地或者显示在屏幕上。它可以很方便地定制所需要的图片还可以自由动态地给图片更换风格。此外小程序canvas.drawImage()方法在真机上不能绘制网络图片。而Painter 可以解决这个问题如果有绘制网络图片的需求也可以考虑使用Painter。Painter其它优势painter可以下载网络图片到本地并对下载到本地的网络内容进行LRU管理。目前小程序允许的最大本地储存为10m我们默认painter可使用的本地存储为6m超出时会对本地存储进行清理。如果需要自定义可以在/painter/lib/downloader.js中修改MAX_SPACE_IN_B属性。目前子 view 的 css 属性支持 object 或 array。允许将几个view公用的css属性提取出来。由于palette 是以 js 承载的 json所以你可以在每一个属性中很方便的加上自己的逻辑。也可以把某些属性单独提取出来让多个 palette 共用做到模块化。使用demo下载demo项目使用submodule的方式进行管理因此在clone时需要运行git clone https://github.com/Kujiale-Mobile/Painter.git --recursiveclone完成后可以看到目录。其中/pages/example中存放的是使用示例/components/painter就是我们所引入的功能组件。此外还有一个palette目录里面存放是我们所需要绘图代码。实际工作时painter会调取card.js里的信息在图片上绘制出相应的图形就像一支画笔在调色板上调制蘸取了颜料然后在画布上创作一样。将Painter引入到自己的项目你可以直接将demo里的painter复制粘贴到自己的项目下当然也可以更为优雅地运行一下这个代码：git submodule add https://github.com/Kujiale-Mobile/PainterCore.git painter它会将Painter工具放置在你当前的目录下。我们推荐的做法是把它放在你的components下。引入组件像其它的组件一样在需要引入Painter的页面.json文件中添加：\"usingComponents\":{  \"painter\":\"/components/painter/painter\"}组件调用在页面的xml文件中调用painter组件并传入pallete规则的数据以及绘制结束以后的回调。<painter palette=\"{{data}}\" bind:imgOK=\"onImgOK\" bind:imgErr=\"onImgErr\"/>palette即是我们的调色板数据以json形式根据一定规范创建详细信息请移步下文。绘制回调bind:imgOK=\"onImgOK\"bind:imgErr=\"onImgErr\"数据传入后painter就会开始绘制无论绘制成功或是失败都能在相应的回调方法里获取相关的信息如：Pallette说到底Painter是一支画笔工具具体要让这支画笔画什么东西还得由我们天资聪颖的程序猿们来告诉它。告诉它应该画什么在哪里画画的时候用什么姿势……等等。这需要用一些别的手段因为科学的实验证明过试图用普通话这门语言跟它进行沟通是不会有任何效果的。调色板属性每一块调色板都它自己的整体属性它一般规定了整个绘图范围的大小、样式、背景等它处于整个json文件的最外层需要指定以下几个属性：示例代码：{      background: 'https://qhyxpicoss.kujiale.com/2018/06/12/LMPUSDAKAEBKKOASAAAAAAY8_981x600.png',      width: '654rpx',      height: '400rpx',      borderRadius: '20rpx',      views: [] }view属性画完了调色板的整体属性以后就可以向views中增加一些元素了。元素支持四种类型用type字段进行区分分类。不同种类的view又要求提供有不同的数据如image元素需要提供它的urltext元素需要提供text文字内容：除了各view的私有属性之外view还有一些公共属性可以设置：rotate控制元素的旋转如下图将一行文字顺时针旋转了6度。{    type: 'text',    text: '酷家乐 移动前端',    css: {     left: '20rpx',     top: '50rpx',     fontSize: '40rpx'   },},效果：borderRadius代码(圆形)：{          type: 'image',          url: this.cardInfo.avatar,          css: {            top: '48rpx',            left: '448rpx',            width: '192rpx',            height: '192rpx',            borderRadius:'96rpx',          },        },方角-->8rpx圆角-->圆形align这个属性值比较有意思它被用来设置元素在水平方向的、相对于位置设置的对齐方式。什么意思呢？比如说你设置了某元素的left为100rpx并设置align属性为left那么该元素的左端就与100rpx对齐；若设置align为center则该元素的中轴线与100rpx对齐。在下面的例子中三行文字的left都是230rpxalign分别为left, center, right。红线是横坐标为230rpx的轴线。即当设置了align属性的时候left值表达的是元素属性中align的位置。代码：{          type: 'text',          text: '酷家乐 移动前端',          css: {            left: '330rpx',            top: '100rpx',            fontSize: '40rpx',          },        },        {          type: 'text',          text: '酷家乐 移动前端',          css: {            left: '330rpx',            top: '200rpx',            fontSize: '40rpx',            align: 'center'          },        },        {          type: 'text',          text: '酷家乐 移动前端',          css: {            left: '330rpx',            top: '300rpx',            fontSize: '40rpx',            align: 'right'          },        },有了这个属性就可以设置元素的对齐形式完成下面的布局要求了：注意：align属性请和left属性配合使用设置right值将造成错误。align与rotate当align属性与rotate属性同时存在时元素的旋转表现是以元素的中心点为中心的。尺寸单位目前 Painter 中支持两种尺寸单位px 和 rpx代表的意思和小程序中一致。目前还没有很好地支持百分比的使用。保存图片演示获得图片的url后可以设置一个点击按钮点击保存到本地onImgOK(e) {    this.imagePath = e.detail.path;  },  saveImage() {    wx.saveImageToPhotosAlbum({      filePath: this.imagePath,    })  },按钮绑定saveImage方法点击进行保存：生成朋友圈分享图最后利用Painter工具可以生成不同样式的朋友圈分享图(下图为微信小程序 酷咖名片 线上版部分截图)                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    mpvue小程序《校友足迹》成长记（一）               小程序入门总结篇                                                        原作者:  生忘                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序带图片弹窗简单实现                                                      • 微信小程序利用canvas生成海报分享图片                                                      • 小程序上传一张或多张图片到阿里云OSS                                                      • 小程序基础核心组件库处理Banner、图片上传、列表刷新                                                      • 微信小程序设置图片固定比例                                                      • 小程序页面效果 - 下载图片并且显示进度                                                      • 轻松生成小程序分享海报                                                      • 小程序之canvas图片及文本适配                                                      • 小程序导出朋友圈海报详细记录                                                                                               "},{"title": "微信小程序学习点滴《三》：开发工具及开发环境配置，尺寸单位rpx与px,rem相互转换 ... ", "author": "                  天下雪                  2016-10-17 13:11                ", "text": "                                                                                                                                                                                     一：开发工具及开发环境配置1.开发工具下载地址Windows 64位 下载Windows 32位 下载MacOS 下载2.安装过程对于Windows用户直接双击下一步的方式安装即可此处注意我们使用的版本是官方最新的版本（不需要破解）可以不用AppID也就是说没有资格的开发者也可以测试。2.1 环境测试以及演示项目2.1.1安装完成过后通过打开我们已经完成的应用测试环境是否正常2.1.2开发者工具安装完成后打开并使用微信扫码登录。2.1.3选择创建“项目”填入你在公众平台的`AppID`如果没有的话可以点击`无AppID`。2.1.4设置一个本地项目的名称（非小程序名称）比如`WeApp Demo`并选择一个本地文件夹作为存储目录。点击\"添加项目\"2.2  接下来点击`新建项目`就可以在主界面中预览到示例项目了二：尺寸单位rpx与px,rem相互转换1. rpx :微信小程序开发中新出了尺寸单位rpx（responsive pixel）: 可以根据屏幕宽度进行自适应。规定屏幕宽为750rpx。如在 iPhone6 上屏幕宽度为375px共有750个物理像素则750rpx = 375px = 750物理像素1rpx = 0.5px = 1物理像素。微信官方建议视觉稿以iPhone 6为标准.2.rem rem（root em）: 规定屏幕宽度为20rem；1rem = (750/20)rpx 。微信小程序开发尺寸单位文档                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序学习点滴《二》：开发者工具快捷键轮播图 swiper图片组件 ...               微信小程序学习点滴《四》：网络请求                                                        原作者: dzp_coder                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序学习点滴《五》：网络请求(POST请求)填坑指南                                                      • 微信小程序开发之画布canvas 饼状图                                                      • 微信小程序学习点滴《六》：保留小数(toFixed) 四舍五入 获取整数 string转int ...                                                      • 微信小程序学习点滴《七》：数据存储 参数传递 数据缓存                                                      • 微信小程序学习点滴《八》：从相册获取图片 使用相机拍照 本地图片上传 ... ...                                                      • 微信小程序学习点滴《九》：本地图片上传(leancloud)                                                      • 微信小程序学习点滴《十》：真机测试 地图定位 map API 无法获取当前位置的问题 ... ...                                                      • 微信小程序学习点滴《十一》：选择器 时间选择器 日期选择器 地区选择器 ... ...                                                      • 微信小程序学习点滴《十二》：图片等比例缩放 获取屏幕尺寸图片尺寸 自适应 ... ...                                                      • 微信小程序学习点滴《十三》：音乐播放器 真机测试 audio API                                                      • 微信小程序学习点滴《十五》：用户系统 一键登录 获取session_key和openid ...                                                      • 微信小程序学习点滴《十六》：下拉刷新 上拉加载                                                      • 手机界面设计尺寸规范                                                      • 微信小程序rpx、px、rem等尺寸间关系浅析                                                      • 微信小程序开发--从px到rpx                                                                                               "},{"title": null, "author": "", "text": ""},{"title": "微信小程序再推iOS虚拟支付整改方案，开发者该怎么办？ ", "author": "                  Rolan                  2018-9-4 00:01                ", "text": "                                                                                                                                                                                     过去绕过iOS虚拟支付规则的玩法现在都不行了!作者：Miss豆教授来源：晓程序观察（ID：yinghoo-tech）本文为作者授权鸟哥笔记发布转载请联系作者并注明出处。几日前微信发出一则《关于小程序虚拟支付内容和服务的整改通知》内容如下：你好基于微信小程序平台运营规范开发者在iOS系统上提供的虚拟物品不能展现任何购买、支付的功能、页面、按钮即使实际上它们都不可使用；也不得引导至外部网页或APP来实现支付功能。请尽快排查当前小程序是否存在违规内容并于8月11日00:00前更新整改结果到线上版本。逾期未整改的小程序平台将参照《微信小程序平台运营规范》14.6虚拟支付相关规则暂停当前小程序iOS端用户访问。从这则通知可以看到过去绕过iOS虚拟支付规则的玩法现在都不行了。曲线救国已成过去式据晓程序观察（yinghoo-tech）了解iOS端一直都不能使用虚拟支付这个新的提示又是什么意思？ 这次通知中有3个重点内容：1、 不要在平台上展示任何支付功能包括货架（价格标签）、购买/支付/订阅等功能或按钮。这是说诸如知识付费类的小程序在iOS端与安卓版的界面都会有类似“订阅课程”等标识但之后iOS端的小程序界面这些标识都不能再显示了。连展示都不能有这是对新规则的进一步细化、明示。此类标识都将被禁止这类呈现货架价格、提示购买的行为将被禁止2、不要试图引导用户到微信公众号、H5、App或是任何外链进行付费。以前部分开发者使用了如下两种曲线救国的方式从最新的通知来看微信正在进一步让规则细化让这两种方式将彻底成为过去：1、小程序跳转App。由于小程序支持打开App功能iOS系统内如需使用“虚拟支付”功能的开发者可以引导用户跳转至App进行支付；2、引导至公众号。很多公众号主页的菜单栏有充值功能比如移动充租赁类公众号、第三方电信服务公众号等等。开发者可以在小程序中为用户提供去往公众号的路径让用户去公众号完成支付。以上这些形态都需要修改3、本周内尽快整改避免被违规处理。注意不是所有提供支付功能的小程序都要被整改仅仅只有涉及“虚拟支付”的小程序需要调整。什么是虚拟支付？说白了就是购买非实物摸不到的物品。比如： VIP会员、充值、课程、虚拟物品等等。受到影响的首当其冲就是内容付费类的小程序关停iOS版虚拟支付功能将对这些小程序既有的变现模式带来极大冲击。而其他涉及虚拟支付的答题类和虚拟礼物类小程序也都会受到波及。影响范围仅限iOS端Android不受影响 开发者们依然可以在安卓版本的小程序内提供虚拟支付。开发者别焦虑这里有三大应对攻略通知来得很突然很多开发者还一脸懵逼别担心为了不避免因调整不及时被封禁我们为大家总结了三大应对攻略。1、关闭付费通道。7月下旬微信就切断了小程序iOS虚拟支付的接口。关闭付费通道是最一劳永逸的解决办法 最好将虚拟支付的指示文字都一并删除 以避免毫无必要的误会。以会员卡业务为例近日小程序「腾讯视频」就关闭了会员卡开通渠道原本会员开通按钮仅显示“你还不是会员”不再提供开通服务。2、所有的付费调整成免费。有些小程序的收费功能 其实可以变成免费功能 结合其他比如：分享、签到、会员注册可得到奖励的社交玩法不仅能增加小程序的用户粘性还能达到流量增长的目的。同时高曝光的小程序还能进一步增加流量主广告收入。可以参考下面这款小程序。3、直接提示不可服务。对于虚拟支付比较集中的在线课程会员等可以以免费的形式对外。或者先在其他渠道做这些服务。但如果不愿意免费就最好 直接提示不可服务 提示语最好不要出现Apple和iOS相关关键词。小程序「网易公开课精品」已经率先用这种方式完成整改在线课程显示为无法订阅。不过依然可以试听让用户了解产品以便日后平台规则若有调整可以重新开放订阅。另外所有小游戏目前仅支持安卓端的道具内购iOS端小游戏也一样要进行整改了类似下图的价格标签与“充值”字样都不能显示。 鉴于微信多次对于小程序虚拟支付进行限制本次整改我们预测是微信和苹果对于规则协调的最新结果因此我们建议开发者在政策明朗之前暂时先不要触及iOS虚拟支付相关业务。另一条路是 开发者可以暂时专注安卓端的小程序虚拟支付 毕竟根据市场研究机构Kantar发布的2018年第二季度智能手机行业的报告在中国市场安卓在第二季度占据了80.4%的市场份额iOS只有19.5%比例为八二开安卓用户还是拥有数量上的优势。iOS生态内的虚拟支付一直命运起伏苹果对虚拟支付的管控有迹可循。众所周知苹果一直有着IAP（in-App Purchase道具内购）规则App Store审核指南规定：“如果您想要在App内解锁特性或功能 (解锁方式有：订阅、游戏内货币、游戏关卡、优质内容的访问权限或解锁完整版等)则必须使用 App 内购买项目。”任何经过IAP机制的购买行为 苹果公司都要抽取其中30%作为手续费。从国外经验来看系统和平台的双重收费是有先例的以Facebook上Instant Games为例App Store或者Google play也都要收“过路费”。根据“游戏陀螺”的报道Facebook 已经在近日为 Instant Games 开放内购内购的分成比例是3:7。开发者拿70%在Google Play扣除了分成后的营收中Instant Games再拿30%所以开发者实际拿到手是49%。微信也在一直积极配合苹果对虚拟支付的规则并寻求解决方法。苹果一出政策微信就会调整。在小程序诞生之初微信就在《微信小程序平台运营规范》里明确表示 ：iOS系统下微信小程序暂不得为虚拟物品购买提供支付功能。今年5月更是发布明确公告：“除小游戏类目的安卓内购功能小程序暂不支持虚拟支付。”诸如「腾讯视频」这样的官方小程序也一样暂停了iOS端小程序的虚拟支付功能一视同仁没有例外。小程序生态内最受瞩目的“现金牛”小游戏iOS端如今同样不支持道具内购。事实上这次规则调整早就有所预示7月下旬微信就关闭了iOS虚拟支付的接口 从产品层截断了虚拟支付的路径充分遵守了苹果相关规则。 不过鉴于iOS虚拟支付多变的“历史轨迹”我们建议开发者不要着急最不变的就是变化木尚未成舟大家要做的就是深耕产品抓住用户喜好用更多的创新来挖掘微信10.3亿月活用户这个流量池。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    我们做了个测试发现小程序广告的防作弊机制！               晓程序观察 从“一夜暴富”到“一贫如洗”小程序20个月「封禁」史！ ...                                                        原作者: 鸟哥笔记                   来自: 鸟哥笔记                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序接入微信支付避雷指南                                                      • 微信、支付宝同时宣布：启动高速“无感”支付                                                      • 从一颗大树变成一片森林微信要把移动支付的“半条命”交给服务商 ...                                                      • “微信、支付宝小程序”骗局：百元程序要价几万                                                      • 微信小程序支付功能开发与踩坑经验总结                                                      • 微信小程序再推iOS虚拟支付整改方案我们给开发者总结3条有效应对措施 ...                                                                                               "},{"title": "小程序出现bug，如何快速让用户提供信息？ ", "author": "                  Rolan                  2018-5-10 00:23                ", "text": "                                                                                                                                                                                     前言：做任何产品都会有bug一旦出现bug开发的同学都希望能尽多的了解bug的复现场景。连胜老师今天来说一下小程序中如何快速的让用户提供相关信息。开发的同学是不是之前也做过类似于检测用户网络的页面？如下图：当用户反馈问题时客服的同学只需要丢一个URL地址给用户让用户把内容copy过来或者截图发过来。客服的同学就可以根据这些信息做个基本判断比如连不上外网（youtube、google、facebook等没办法访问）、连接你公司的CDN服务器时比较慢、使用的浏览器版本不正确等。补个链接：http://demos.pxuexiao.com/network_speed/index.html以上是做PC或者移动端H5时会用到的一种方法在小程序中你自己也可以做一个类似的页面。先看下截图效果：上面的参数获取大家可以查看官方APIwx.getSystemInfoSync里面可以获取很多内容：再丢个官方API文档的地址：https://developers.weixin.qq.com/miniprogram/dev/api/systeminfo.html#wxgetsysteminfosync用户权限信息可以调用wx.getSetting来获取这里就不详细说了。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序弹出和隐藏遮罩层动画以及五星评分               微信小程序radio点选框再次点击取消                                                        原作者:  知晓程序员                   来自:  知晓程序员                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "微信小程序可实时改变转速的css3旋转动画 ", "author": "                  Rolan                  2018-8-30 00:38                ", "text": "                                                                                                                                                                                     先上效果图 最上面那一行就是个简单的换颜色效果极其简答就不多说了直接上代码。<view class='box' style='background-color:{{backgroundcolor}}'></view><view class='viewBox'>  <button bindtap='changeColor' data-color='black' class='box'>黑</button>  <button bindtap='changeColor' data-color='violet' class='box'>紫</button>  <button bindtap='changeColor' data-color='orange' class='box'>橙</button>  <button bindtap='changeColor' data-color='blue' class='box'>蓝</button>  <button bindtap='changeColor' data-color='green' class='box'>绿</button></view>JS  data: {    backgroundcolor:'red'  },  changeColor:function(e){    this.setData({      backgroundcolor: e.currentTarget.dataset.color    })  }那么下面咱们说一说这个旋转的动画。小程序里呢有自己的动画api但是用起来感觉极其麻烦而且容易产生倒转对设备的性能消耗也多动画多了以后就会极其卡顿所以还是css3的动画比较好。 首先来写这个css3动画 css3旋转动画<view class='animationSlow'></view>.animationSlow {   width: 100rpx;  height: 100rpx;  background-color: orange;  animation-name: myfirst; /*动画的名称 */  animation-duration: 2000ms; /*动画从开始到结束的时间*/  animation-timing-function: linear; /*动画执行快慢的参数*/  animation-iteration-count: infinite; /*动画执行多少次的参数*//*以下是兼容ios所需参数意义与上相同*/  -webkit-animation-name: myfirst;  -webkit-animation-duration: 2000ms;  -webkit-animation-timing-function: linear;  -webkit-animation-iteration-count: infinite;}@keyframes myfirst {  /*开始转的角度*/  from {    transform: rotate(0deg);  }/*结束的角度*/  to {    transform: rotate(360deg);  }}/*兼容ios*/@-webkit-keyframes myfirst {  from {    transform: rotate(0deg);  }  to {    transform: rotate(360deg);  }}效果图 如果只是一个一次性的动画效果现在这些代码就OK了。 如果想要实时可以改变旋转的转速我们还得再加点东西。实现可以实时修改转速 微信小程序里涉及到实时数据就避免不了Page.data这个东西。 1.我们需要将控制动画时间的css属性放到内联样式中去<view class='animationSlow' style='animation-duration: 2000ms;-webkit-animation-duration: 2000ms;'></view>2.在页面对应的js中设置掌控时间的Page.data属性将wxml里内联属性的时间改为Page.data的属性。  data: {    animationTime:'2000ms'  },<view class='animationSlow' style='animation-duration: {{animationTime}};-webkit-animation-duration: {{animationTime}};'></view>3.接下来我们写几个按钮绑定上修改这个时间的方法进而来改变转速。这一步都是基本代码我就不贴代码了。放个效果图吧。效果图那么接下来重点来了：其实这里有个bug这个效果呢在安卓机上是一点点问题都没有的。但是在苹果机上动画一旦开始再通过这个方法去修改转速就不能生效了。解决IOS系统的BUG 上面说了IOS系统上呢动画一旦开始这个方法就不能用了。那么咱是不是可以先把这个动画停下来然后再改转速呢？这个办法可不可以呢？答案是肯定的但是不是去把动画时间改为0而是采用了css3动画的一个属性。CSS3 动画教程animation-play-state: paused|running;简而言之就是先用这个属性把动画暂停修改转速然后再让它跑起来。这一切都得再js里进行。 1.需要在标签的内联样式里加上这个属性在Page.data里再定义一个属性控制开始暂停。<view class='animationSlow' style='animation-duration: {{animationTime}};-webkit-animation-duration: {{animationTime}};animation-play-state:{{status}};-webkit-animation-play-state:{{status}};'></view> data: {    animationTime:'2000ms',    status: 'running'//paused  },2.然后我们去修改改变转速的方法。暂停>(修改>跑起来)效果上稍微有些延迟。 changeTime:function(e){    this.setData({      status: 'paused'    })    this.setData({      timeAnimation: e.currentTarget.dataset.time,      status: 'running'    })  },3.来上效果图了。效果图可能动图上感觉不出来不过你们可以去真机试一下就可以展现出来了。本次分享结束(@LcFireRabbit)作者：LcFireRabbit 链接：https://www.jianshu.com/p/4c1928534c4f                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    富文本解析-微信小程序 rich-text 组件               微信小程序 canvas区间滑动选取                                                        原作者: LcFireRabbit                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "Flex布局 ", "author": "                  Rolan                  2017-10-14 00:12                ", "text": "                                                                                                                                                                                     本文最早发布在： Rootrl's blog简介Flex是Flexible Box的缩写意为弹性布局。是W3C在2009年提出的一个新的布局方案。可以方便的实现各种页面布局。目前浏览器兼容如下：Flex在移动端开发上已是主流比如H5页面微信小程序等等。Why Flex传统的布局方案主要基于CSS盒子模型依赖Display、Position、Float等属性。但是它对于一些特殊布局非常不方便比如水平垂直居中。传统方式实现起来非常繁杂各种黑科技比如以下是一种水平垂直居中的实现方式：基础的DOM如下一个父元素是宽高为500px的红色容器包裹着宽高为100px的黄色子容器：<style>    * {        margin: 0;        padding: 0;    }    .dad {        background-color: red;        width: 500px;        height: 500px;    }    .son {        background-color: yellow;        width: 100px;        height: 100px;    }</style><div class=\"dad\">    <div class=\"son\">    </div></div>现要实现子元素在父元素中水平垂直居中传统的方式如下基于定位。.dad {    position: relative;}.son {    position: absolute;    margin: auto;    top: 0;    right: 0;    bottom: 0;    left: 0;}而Flex只需几行代码搞定非常方便：.dad {    display: flex;    justify-content: center;    align-items: center}使用任何一个容器都可以指定为Flex布局。.box {    display: flex;}行内元素也可以使用Flex布局：.box {    display: inline-flex}Webkit内核的浏览器需加上-webkit前缀。注意：设为Flex布局后子元素的float、clear、vertical-alian属性都将失效。基本概念父容器设为flex后它的所有子元素自动成为容器成员（这里加入我的理解如果不对请指出：这里的子元素不论什么元素块级还是行内而且只作用于子元素孙元素不起作用需继续在子元素上设置display:flex）Flex的基本概念就是容器和轴容器包括外层的父容器和内层的子容器（也叫项目flex item）轴包括主轴和交叉轴。如图：容器默认存在两根轴水平的主轴(main axis)和垂直的交叉轴（cross axis）。主轴的开始位置（与边框的交叉点）叫做main start结束位置叫做main end；交叉轴的开始位置叫做cross start结束位置叫做cross end。子容器（项目）默认沿主轴排列单个项目占据的主轴空间叫做main size占据的交叉轴空间叫做cross size。Flex布局主要涉及12个属性（不含display:flex）其中容器和子容器各6个但是平常使用到的基本只有4个属性父容器和子容器各2个。作用于父容器的属性：flex-directionflex-wrapflex-flowjustify-contentalign-itemsalign-content作用于子容器（项目）的属性：orderflex-growflex-shrinkflex-basisflexalign-self详细介绍容器属性flex-directionflex-direction属性决定主轴的方向及子容器（项目）的排列方向。.box {  flex-direction: row | row-reverse | column | column-reverse;}可能的值：row（默认值）：主轴为水平方向起点在左端。 row-reverse：主轴为水平方向起点在右端。 column：主轴为垂直方向起点在上沿。 column-reverse：主轴为垂直方向起点在下沿。 如图：flex-wrap默认情况下项目都排在一条线（又称\"轴线\"）上。flex-wrap属性定义如果一条轴线排不下如何换行。.box {  flex-wrap: nowrap | wrap | wrap-reverse;}可能的值：nowrap（默认）：不换行 wrap：换行第一行在上方 wrap-reverse: 换行第一行在下方 flex-flowflex-flow属性是flex-direction和flex-wrap属性的简写形式默认为：row nowrap.box {    flex-flow: <flex-direction> || <flex-wrap>}justify-contentjustify-content定义了项目在主轴上的对齐方式。.box {    justify-content: flex-start| flext-end | center | space-between |space-around;}它可能取5个值具体对齐方式与轴的方向有关。下面假设主轴为从左到右。flex-start（默认值）：左对齐 flex-end：右对齐 center： 居中 space-between：两端对齐项目之间的间隔都相等。 space-around：每个项目两侧的间隔相等。所以项目之间的间隔比项目与边框的间隔大一倍。 如图：align-itemsalign-items属性定义了项目在交叉轴上的对齐方式：.box {    align-items: flex-start| flex-end | center | baseline | strech}它可能取5个值。具体的对齐方式与交叉轴的方向有关下面假设交叉轴从上到下：flex-start：交叉轴的起点对齐。 flex-end：交叉轴的终点对齐。 center：交叉轴的中点对齐。 baseline: 项目的第一行文字的基线对齐。 stretch（默认值）：如果项目未设置高度或设为auto将占满整个容器的高度。 如图：algin-contentalign-content属性定义了多根轴线的对齐方式。如果项目只有一根轴线该属性不起作用。可能的值：flex-start：与交叉轴的起点对齐。 flex-end：与交叉轴的终点对齐。 center：与交叉轴的中点对齐。 space-between：与交叉轴两端对齐轴线之间的间隔平均分布。 space-around：每根轴线两侧的间隔都相等。所以轴线之间的间隔比轴线与边框的间隔大一倍。 stretch（默认值）：轴线占满整个交叉轴。 如图：项目属性                                            .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)此生拜阳明                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序＋电商该怎么玩？               微信小程序实战--Jgank小程序开发（一）                                                        原作者: Rootrl's                   来自: Rootrl's blog                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序入门：Flex布局                                                      • flex实现小程序导航                                                      • flex实现小程序自适应图文列表                                                      • 微信小程序 View：flex 布局                                                      • 微信小程序开发--从block盒式布局到Flex弹性布局                                                      • 【基础】微信小程序flex布局                                                      • Flex 实现表格布局 （微信小程序）                                                      • 微信小程序开发之——flex布局和weui-wxss的使用                                                      • Flex布局在小程序的使用                                                                                               "},{"title": "微信小程序把玩《六》：picker组件，radio组件，slider组件 ", "author": "                  天下雪                  2016-10-21 15:03                ", "text": "                                                                                                                                                                                     一：picker组件picker选择器分为三种普通选择器时间选择器 日期选择器 用mode属性区分默认是普通选择器。测试时时间和日期点击无反应不知道是BUG还是啥！没法手机测试现在也不知道咋回事！！主要属性：普通选择器时间选择器日期选择器wxml<view>普通选择器</view><!--mode默认selector range数据源value选择的index bindchange事件监听--><picker mode=\"selector\" range=\"{{array}}\" value=\"{{index}}\" bindchange=\"listenerPickerSelected\">    <text>{{array[index]}}</text></picker><view>时间选择器</view><picker mode=\"time\" value=\"{{time}}\" start=\"06:00\" end=\"24:00\" bindchange=\"listenerTimePickerSelected\">    <text>{{time}}</text></picker><view>日期选择器</view><picker mode=\"date\" value=\"{{date}}\" start=\"2016-09-26\" end=\"2017-10-10\" bindchange=\"listenerDatePickerSelected\">    <text>{{date}}</text></picker>jsPage({  data:{    // text:\"这是一个页面\"    array: ['Android', 'IOS', 'ReactNativ', 'WeChat', 'Web'],    index: 0,    time: '08:30',    date: '2016-09-26'  },  /**   * 监听普通picker选择器   */  listenerPickerSelected: function(e) {      //改变index值通过setData()方法重绘界面      this.setData({        index: e.detail.value      });  },   /**   * 监听时间picker选择器   */  listenerTimePickerSelected: function(e) {      //调用setData()重新绘制      this.setData({          time: e.detail.value,      });  },  /**   * 监听日期picker选择器   */  listenerDatePickerSelected:function(e) {    this.setDate({      date: e.detail.value    })  },  onLoad:function(options){    // 页面初始化 options为页面跳转所带来的参数  },  onReady:function(){    // 页面渲染完成  },  onShow:function(){    // 页面显示  },  onHide:function(){    // 页面隐藏  },  onUnload:function(){    // 页面关闭  }})二：radio组件赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)gyx2813                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    新手跳坑指南：小程序开发过程中遇到的各种坑               微信小程序把玩《七》：switch组件action-sheet组件modal组件                                                        原作者: 顺子_RTFSC                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序把玩《一》：window配置tabBar底部导航应用生命周期 ...                                                      • 微信小程序把玩《二》：页面生命周期模块化数据绑定view组件 ... ...                                                      • 微信小程序把玩《三》：scroll-view组件swiper组件icon组件                                                      • 微信小程序把玩《四》：text组件progress组件button组件                                                      • 微信小程序把玩《五》：checkbox组件form组件input组件                                                      • 微信小程序把玩《八》：toast组件loading组件navigator组件                                                      • 微信小程序把玩《十》：wx.request(object) APIwx.uploadFile(object)                                                      • 微信小程序把玩《十一》：Image APIRecord APIAudio API                                                      • 微信小程序把玩《十二》：Video APIStorage APIlocation API                                                      • 微信小程序把玩《十三》：获取设备信息 APInavigation APIanimation API ...                                                      • 微信小程序把玩《十四》：canvas API                                                      • 小程序 自定义slider组件音频播放实例                                                      • 微信小程序radio点选框再次点击取消                                                                                                                                                   0 条回复                                                                        \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                                             相关栏目              官方教程后端教程官方问答入门系列官方基础教程新手教程面向新手系列小技巧系列https相关系列实战教程                新手教程阅读排行            jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092515|b49c94384a0e5df58ba9eb4eb7ab60a0|2';\t\t\t\t\t\t"},{"title": "Flex布局在小程序的使用 ", "author": "                  Rolan                  2017-11-13 00:15                ", "text": "                                                                                                                                                                                     Flex布局是一种十分灵活方便的布局方式目前主流的现代浏览器基本都实现了对Flex布局的完全支持。而在微信小程序中IOS端使用的渲染引擎WKWebView和安卓端使用的X5 也都实现了对Flex的支持。所以为了在小程序开发中更方便地布局有必要来详细了解下Flex布局在小程序的使用。本文将针对Flex布局的各个属性进行介绍并直接使用wxss来编写例子运行环境是小程序的开发者工具。Flex布局的基本概念Flex布局直接应用于一个Flex容器布局的对象是容器中的各个项目元素（“item”）。项目元素布局的核心概念在于两条轴：主轴和交叉轴通过控制项目元素在主轴、交叉轴上的排列方式进行布局参见下图：这里要注意两条轴的方向不是固定的（可以通过flex-direction来控制）；此外一个Flex容器里可以再包含Flex容器也就是能拥有多根主轴和交叉轴。Flex容器属性容器属性有6个：flex-directionflex-wrapflex-flowjustify-contentalign-itemsalign-contentflex-direction设定主轴方向：row →（默认）row-reverse ←column ↓column-reverse↑flex-wrap规定如果容器在主轴方向无法容下所有项目主轴上的项目如何换行（flex-direction为column和column-reverse时就是“换列”了）：nowrap（默认）即不作换行各个项目相接触时会挤压使宽度变小wrap：换行正常从上到下wrap-reverse：换行只是各行在交叉轴上的排列方向和wrap时相反flex-flowflex-direction和flex-wrap的简写默认值为“row wrap”。justify-content所有项目在主轴上对齐方式：none（默认）center：在主轴上居中flex-start：主轴起点对齐fex-end：主轴终点对齐space-between：两端对齐项目间间隔相等space-around：各项目两侧间隔相等align-items所有项目在交叉轴上对齐方式：stretch（默认）即项目取auto大小时拉伸以占满容器的在交叉轴方向上的大小center：在交叉轴上居中flex-start：交叉轴起点对齐flex-end： 交叉轴终点对齐baseline：各项目第一行文字的基线对齐align-content定义了多根主轴的对齐方式如果项目只有一根主轴则不起作用多根主轴一般会在主轴上折行时出现：stretch（默认）即auto大小时主轴线上的项目会拉伸来占满整个交叉轴。center：在交叉轴上居中flex-start：交叉轴起点对齐flex-end： 交叉轴终点对齐space-between：两端对齐项目间间隔相等space-around：各项目两侧间隔相等Flex项目属性项目属性有6个：orderflex-basisflex-growflex-shrinkflexalign-selforder定义项目排列序号；默认为0可为负：flex-basis在Flex项目自适应放大缩小之前项目占据的主轴空间的基值。默认值为auto即项目的本来大小：flex-grow注意该属性指定的是项目对剩余空间的瓜分比例这里有两个关键点：容器在主轴上要有剩余空间该属性是对剩余空间的瓜分也即项目的最终大小是各项目的flex-basis大小、再加上瓜分得到的大小默认为0即如果存在剩余空间也不放大（grow）不可为负：flex-shrink:空间不足时项目对缩小份额的瓜分比例还是有两个关键点：容器在主轴上空间不足以放下所有的项目空间不足可以让项目缩小而该属性就是对缩小份额的瓜分也即项目的最终大小是各项目的flex-basis大小、再减去瓜分得到的缩小份额默认为1即如果空间不足项目将缩小不可负：flexflex-grow, flex-shrink 和 flex-basis的简写。默认值为“0 1 auto”还有两个值auto即“1 1 auto”、none即“0 0 auto”。align-self让一个项目有与其他项目不同的交叉轴对齐方式主要用来覆盖align-items属性。默认值是auto即继承父元素的align-items属性若无父元素则等同于stretch；其他值效果和align-items一样。总结Flex布局也叫弹性布局个人理解所谓“弹性”主要体现在Flex项目的自伸缩上。主轴上的自伸缩主要通过flex-grow、flex-shrink来控制交叉轴上的自伸缩则体现在align-*属性的默认值stretch上。一些注意点一些属性会在对Flex项目上无效：column-*属性、float 和 clear、vertical-align 。在Flex容器使用 float 会导致Flex布局失效。参考Flex 布局教程                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序实例--猜拳游戏               微信小程序内嵌网页web-view开发教程                                                        原作者: LevonLin                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • flex实现小程序导航                                                      • flex实现小程序自适应图文列表                                                      • 微信小程序 View：flex 布局                                                      • 微信小程序开发--从block盒式布局到Flex弹性布局                                                      • 【基础】微信小程序flex布局                                                      • Flex 实现表格布局 （微信小程序）                                                      • 微信小程序开发之——flex布局和weui-wxss的使用                                                      • Flex布局                                                                                               "},{"title": "黄秀杰小程序入门佳品——增删改查+页面跳转+传值取值+布局样式 ... ... ... ", "author": "                  Rolan                  2017-8-2 10:14                ", "text": "                                                                                                                                                                                     目标场景分类管理技术点读取分类列表点击某分类进入编辑页操作编辑与删除点击列表页底部按钮跳转添加共用编辑页效果列表页jsvar Bmob = require('../../utils/bmob.js');var that;Page({    onLoad: function () {        that = this;    },    onShow: function () {        that.loadCategories();    },    loadCategories: function () {                var query = new Bmob.Query('Category');        query.limit(Number.Max_VALUE);        query.find().then(function (categories) {            console.log(categories);            that.setData({                categories: categories            });        });    },    add: function () {                // 跳转添加页面        wx.navigateTo({            url: '../add/add'        });    },})可以看到上面使用了onShow代替了onLoad作为加载请求loadCategories这是因为考虑到添加完毕后会有返回上页能和自刷新最新数据。相应的布局页面 class=\"item\" wx:for=\"{{categories}}\" wx:key=\"\">     class=\"title\" url=\"../add/add?objectId={{item.objectId}}\" open-type=\"navigate\" hover-class=\"none\">{{item.title}} class=\"add-category\" bindtap=\"add\">     src=\"/images/add.png\" class=\"icon\" />     class=\"caption\">新增分类列表页跳转可以使用代替的bindtap这样更简洁一些；而底部的添加按钮使用position: fixed固定底部；wx:for循环提供objectId作为参数以传递给编辑页面。编辑页面var Bmob = require('../../utils/bmob.js');var that;Page({    onLoad: function (                                            .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)wx_無舆倫                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发问答《五十八》动态决定程序的启动页 & 背景图设置手机上无法预览 ...  ...               微信小程序五星级评分效果                                                        原作者: Rolan                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 黄秀杰--基于Bmob从零开始写一个博客小程序                                                      • 黄秀杰--小程序实现选择图片九宫格带预览                                                      • 黄秀杰---小程序对接WebSocket扫盲（PHP后端）                                                      • 黄秀杰教程--灵犀外卖选购页实现切换分类与数量加减                                                      • 黄秀杰实战教程--购物车动画与加减                                                      • 黄秀杰实战系列-- 灵动商城姊妹——灵犀外卖新鲜出炉                                                      • 微信小程序开发--从block盒式布局到Flex弹性布局                                                      • Flex 实现表格布局 （微信小程序）                                                      • 小程序页面跳转解析                                                      • 微信小程序实现淡入淡出效果（页面跳转）                                                      • 小程序 - 简单入门                                                                                               "},{"title": "微信小程序开发——本地调试 ", "author": "                  Rolan                  2017-12-27 00:15                ", "text": "                                                                                                                                                                                     在我们开发小程序时可能小程序端和后台是同时开发的这种情况下如果后台代码写一点再部署到服务器然后再调试小程序会很繁琐。而很多小程序api又必须要经过腾讯服务器再转发到我们自己的后台这就要求我们的后台能够被外网访问到。前段时间写小程序时尝试过几种方法这里简单介绍一下。​\t首先对于那些不需要调用类似用户登录这些必须要appid的功能我们可以直接在创建项目的时候不填appid这样小程序就不受合法域名的限制可以直接访问我们局域网内部的后台。​\t而对于用户登录、微信支付等这些api必须要appid也必须通过腾讯的服务器这时候我们就必须让我们的后台能被外网访问到而且在合法域名配置里面只能是https。一般我们在开发时肯定都已经买好了外网服务器（比如阿里云ecs）配置什么的也不是本文重点本文假设你已经有一台ecs备案、ssl证书什么的都搞定了。以下是几种方案：直接使用外网服务器​\t常规流程后台代码部署到服务器然后小程序调试。上面已经提过缺点很明显。但如果说你们的需求很明确后台能很快写完而且不需要经常修改可以这么做。说点题外话对于部署这部分可能很多都是本地打包好比如打包成jar然后scp或者ftp上传到服务器然后再运行。我觉得可以在服务器上配置git直接把代码托管到服务器也行或者代码在码云等平台的话在服务器上用git pull下来也行然后直接服务器运行代码等后台稳定后再打包运行我觉得这么做比较好因为每次打包都会花不少时间。当然用docker之类的当我没说。使用一些内网穿透工具​\t以前我有用过一些ngrok、ittun（基于ngrok）、localtunel ( nodejs ) 都有用过。优点是比较方便不需要太多配置但缺点也很明细不稳定。你也可以自己构建ngrok。通过外网服务器转发到本地服务器（推荐这种方法）​\t这种方法我是最近用过的感觉效果很不错稳定速度快但我的服务器是centos, 不知道win server上有没有类似的。​\t首先开启服务器的远程转发功能在/etc/ssh/sshd_config文件末尾加入一句：GatewayPorts yes然后重启ssh：sudo systemctl restart sshd.​\t然后本地环境安装xshell这里借助它的隧道功能来转发。具体的是在属性>连接>ssh>隧道里面添加一条转发规则比如把服务器上面的80端口转发到本地80端口。​\t重启xshell当xshell连接上服务器时服务器上面到80端口的请求就可以转发到本地80端口了。​\t接下来要解决的是小程序只能访问https那我们只需要把ssl:443端口转发到http:80端口就ok了直接上nginx部分配置：location /admin/ {  proxy_pass http://localhost/admin/;}location /image/ {  proxy_pass http://localhost/image/;}location /api/ {  proxy_pass http://localhost/api/;}​\t这样配置比较有针对性比如admin是管理员后台接口给web端调用image为图片路径api给小程序调用。当然也可以直接所有的都转发：location / {  proxy_pass http://localhost;}​\t或者说你有一个正常运行的版本已经在服务器上运行还需要再配置一个开发的时候用可以这么来：location /dev/ {  proxy_pass http://localhost/;}​\t当然道理都一样你甚至还可以只在一台服务器上面配置ssl然后给不同的后台配置不同的转发路径这样其他后台就不用上ssl了前提是服务器负载没问题。当然我也就随口一说哈哈。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发学习--外部设备的使用               微信小程序框架wxss--电话列表展示demo                                                        原作者: 孤__狼                   来自: 开源中国                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序新增功能：特殊API的调试                                                      • 微信小程序开发问答《六十三》设置某个页面为启动后打开的第一个页面 & 调试技巧 ...                                                      • 微信小程序 + mock.js 实现后台模拟及调试                                                      • 微信小程序开发问答《七十五》调试界面鼠标指针消失问题 & 图片资源路径 ...                                                      • 微信小程序开发调试常见问题&解决                                                                                               "},{"title": "基于Bmob在小程序端实现一键支付 ", "author": "                  Rolan                  2017-7-3 00:47                ", "text": "                                                                                                                                                                                     几个容易忽略的细节1.需要先拿到openidvar openId = Bmob.User.current().get('authData').weapp.openid;2.事先声明一个thatvar that = this;Bmob文档没提但看到控制台报没有that定义也就自然会加上了3.需要作实名认证未认证会报 code: 10012, message: \"your credit info must verify ok.\"认证入口：https://bmob.cn/account/info实名认证.png4.Bmob付费会员享受支付最低100元/月价目表：http://bmob.cn/prices5.Bmob后台配置项应用配置->微信小程序帐号服务配置pay-config.png6.代码如下——略有改动var that = this;var openId = Bmob.User.current().get('authData').weapp.openid;// console.log(openId);//传参数金额名称描述,openidBmob.Pay.wechatPay(0.01, '名称1', '描述', openId).then(function (resp) {  console.log('resp');  console.log(resp);  that.setData({    loading: true,    dataInfo: resp  })  //服务端返回成功  var timeStamp = resp.timestamp,    nonceStr = resp.noncestr,    packages = resp.package,    orderId = resp.out_trade_no,//订单号如需保存请建表保存。    sign = resp.sign;  //打印订单号  console.log(orderId);  //发起支付  wx.requestPayment({    'timeStamp': timeStamp,    'nonceStr': nonceStr,    'package': packages,    'signType': 'MD5',    'paySign': sign,    'success': function (res) {      //付款成功,这里可以写你的业务代码      console.log(res);    },    'fail': function (res) {      //付款失败      console.log('付款失败');      console.log(res);    }  })}, function (err) {  console.log('服务端返回失败');  console.log(err.message);  // common.showTip(err.message, 'loading',{},6000);  console.log(err);});文档出处:http://docs.bmob.cn/data/wechatApp/b_developdoc/doc/index.html#小程序支付甩掉PHP诸多SDK抛开服务端配置不用云函数不用云引擎Bmob一行代码搞定预下单这酸爽简直了！源码下载：http://git.oschina.net/laeser/dinner                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    黄秀杰---小程序对接WebSocket扫盲（PHP后端）               微信小程序数据处理                                                        原作者: 黄秀杰                   来自: 微信公众号                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 初次Bmob后端云小程序开发分享                                                      • 小程序与php 实现微信支付                                                      • 黄秀杰--基于Bmob从零开始写一个博客小程序                                                      • PHP：微信小程序调用【统一下单】【微信支付】【支付回调】API；XML转ArrayArray转X ...                                                      • 微信小程序开发实践点滴——接入Bmob后端云及Bmob常用API的使用 ...                                                      • thinkphp5+easywechat开发小程序支付                                                      • 微信小程序支付c#后台实现                                                      • 黄秀杰--Node后端优雅使用Bmob                                                                                               "},{"title": "微信小程序开发实践点滴——接入Bmob后端云及Bmob常用API的使用 ... ", "author": "                  Rolan                  2017-7-5 00:14                ", "text": "                                                                                                                                                                                     接入Bmob后端云做一个简单的总结。所谓后端云一句话概括就是跑在云端的数据库后台+服务器后台引入到微信小程序开发中能带来的好处就是：让我们可以专注于小程序本身的业务逻辑开发而不用去管复杂的后台服务器、后台数据库的搭建和维护。准备一个小程序公众号和Bmob账号首先需要到微信公众平台官网上去注册一个小程序类型的公众号假设将要开发的小程序命名为：MyApp.打开Bmob官网注册一个账号。获取并记录好MyApp小程序的AppID和AppSecret这两项信息在小程序后台的\"设置－开发设置\"页面可以获取到获取到后需要在一个文本文件中记好后面要用到。登录Bmob控制台创建一个应用假设名字叫MyBmobApp然后进入应用。到\"设置\"页面输入刚刚获取到的小程序的AppID和AppSecret并保存。获取并记好MyBmobApp对应的Application ID和REST API key.登录小程序MyApp后台到\"设置－开发设置－服务器域名\"页面添加Bmob安全域名并保存（可一次性添加多个）。注：四种安全域名(两种类型：https和wss)全部填api.bmob.cn和xxx.bmobcloud.com其中\"xxx\"为MyBmobApp的Application ID.下载SDK到Bmob官网下载微信小程序对应的SDK并解压将其中的所有js文件都放到小程序工程的utils目录下。初始化和引入Bmob在小程序工程的app.js中加入如下代码进行全局初始化：var Bmob = require('utils/bmob.js');Bmob.initialize('XXX','XXXXXX');// 注：其中'XXX'为MyBmobApp的Application ID,'XXXXXX'为其REST API key在需要用到Bmob的page页的js中引入Bmob：var Bmob = require('../../utils/bmob.js');现在就可以在小程序中对Bmob后端云数据库进行各种操作了像操作本地数据库那么简单。Bmob后端云官网：http://www.bmob.cn/Bmob后端云微信小程序开发文档：http://docs.bmob.cn/data/wechatApp/b_developdoc/doc/index.htmlBmob是一个很好用的后端云平台自己在开发小程序的过程中有用到比较好用免去了搭建服务器、配置数据库的烦�                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    通过api接口将json数据展现到小程序示例               微信小程序 Node.js (基础九) 函数 & (基础十) 路由                                                        原作者: AzureSky                   来自: 博客园                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 初次Bmob后端云小程序开发分享                                                      • 使用BmobSDK开源心邮小程序(操作心情、点赞、评论等）                                                      • 黄秀杰--基于Bmob从零开始写一个博客小程序                                                      • 基于Bmob在小程序端实现一键支付                                                      • 小程序版本的 Auto Draw                                                      • 以微信小程序为例学习网站开发平台API调用                                                      • 黄秀杰--Node后端优雅使用Bmob                                                      • 微信小程序开发最佳实践                                                                                               "},{"title": "Bmob基本REST API的python封装 ", "author": "                  Rolan                  2017-7-7 00:02                ", "text": "                                                                                                                                                                                     本文使用python对Bmob REST API的基本增删改查接口进行封装方便在小程序开发时批量插入原始数据。常用操作函数封装#!/usr/bin/python# coding:utf-8# Bmob后端云基本REST API封装import requestsimport json# 每个应用都会有这两个ID以下方法如果不传入这两个参数那么使用这里默认的值APP_ID = 'XXX'REST_API_KEY = 'XXX'# 封装rest api的get方法根据对象ID获取一条数据# table_name：要查询的表名# object_id：要查询的数据记录的IDdef query(table_name,object_id,app_id = APP_ID,rest_api_key = REST_API_KEY):    # 构建请求头    headers = {}    headers['X-Bmob-Application-Id'] = app_id    headers['X-Bmob-REST-API-Key'] = rest_api_key    # 构建url    url = 'https://api.bmob.cn/1/classes/{table_name}/{object_id}'.format(table_name = table_name,object_id = object_id)    # 发起请求    resp = requests.get(url,headers = headers,verify = False)        # 设置响应体编码    resp.encoding = 'utf-8'        if resp and resp.status_code == 200:        return json.loads(resp.text)    return None# 封装rest api的post方法插入一条记录# table_name：表名如果表名还不存在则先创建一个表再插入数据# data：字典要插入的记录的各个字段的字段名和值def insert(table_name,data,app_id = APP_ID,rest_api_key = REST_API_KEY):    # 构建请求头    headers = {}    headers['X-Bmob-Application-Id'] = app_id    headers['X-Bmob-REST-API-Key'] = rest_api_key    headers['Content-Type'] = 'application/json'    # 构建url    url = 'https://api.bmob.cn/1/classes/{table_name}'.format(table_name = table_name)    # 发起请求    resp = requests.post(url,headers = headers,data = json.dumps(data),verify = False)        # 设置响应体编码    resp.encoding = 'utf-8'        if resp and resp.status_code == 201:        print 'insert success!'        return json.loads(resp.text)    return None# 封装rest api的put方法,传入记录ID修改一条数据# table_name：要更新的表名# object_id：要更新的数据记录的ID# data：字典类型要更新的数据的键值对def update(table_name,object_id,data,app_id = APP_ID,rest_api_key = REST_API_KEY):    # 构建请求头    headers = {}    headers['X-Bmob-Application-Id'] = app_id    headers['X-Bmob-REST-API-Key'] = rest_api_key    headers['Content-Type'] = 'application/json'    # 构建url    url = 'https://api.bmob.cn/1/classes/{table_name}/{object_id}'.format(table_name = table_name,object_id = object_id)    # 发起请求    resp = requests.put(url,headers = headers,data = json.dumps(data),verify = False)        # 设置响应体编码    resp.encoding = 'utf-8'        if resp and resp.status_code == 200:        print 'update {0} success!'.format(object_id)        return json.loads(resp.text)    return None# 封装rest api的delete方法根据对象ID删除一条记录# table_name：要删除的记录所在的表名# object_id：要删除的数据记录的IDdef delete(table_name,object_id,app_id = APP_ID,rest_api_key = REST_API_KEY):    # 构建请求头    headers = {}    headers['X-Bmob-Application-Id'] = app_id    headers['X-Bmob-REST-API-Key'] = rest_api_key    # 构建url    url = 'https://api.bmob.cn/1/classes/{table_name}/{object_id}'.format(table_name = table_name,object_id = object_id)    # 发起请求    resp = requests.delete(url,headers = headers,verify = False)        # 设置响应体编码    resp.encoding = 'utf-8'        if resp and resp.status_code == 200:        print 'delete {0} success!'.format(object_id)        return json.loads(resp.text)    return None# 查询一个表中的所有数据# table_name：要查询的表名def list(table_name,app_id = APP_ID,rest_api_key = REST_API_KEY):    # 构建请求头    headers = {}    headers['X-Bmob-Application-Id'] = app_id    headers['X-Bmob-REST-API-Key'] = rest_api_key    # 构建url    url = 'https://api.bmob.cn/1/classes/{table_name}'.format(table_name = table_name)    # 发起请求    resp = requests.get(url,headers = headers,verify = False)        # 设置响应体编码    resp.encoding = 'utf-8'        if resp and resp.status_code == 200:        return json.loads(resp.text)['results']    return None# 批量操作：批量创建# request_data结构：'''table_name = 'test'{    \"requests\":[        {            \"method\":\"POST\",            \"path\":\"/1/classes/{0}\".format(table_name),            \"body\":{                \"name\":\"Tom\",                \"age\":18            }        },        {            \"method\":\"POST\",            \"path\":\"/1/classes/{0}\".format(table_name),            \"body\":{                \"name\":\"John\",                \"age\":21            }        }    ]}'''def batch_insert(request_data,app_id = APP_ID,rest_api_key = REST_API_KEY):    # 构建请求头    headers = {}    headers['X-Bmob-Application-Id'] = app_id    headers['X-Bmob-REST-API-Key'] = rest_api_key    headers['Content-Type'] = 'application/json'    # url    url = 'https://api.bmob.cn/1/batch'    # 发起请求    resp = requests.post(url,data = json.dumps(request_data),headers = headers,verify = False)        # 设置响应体编码    resp.encoding = 'utf-8'        if resp and resp.status_code == 200:        return json.loads(resp.text)    return None调用示例#!/usr/bin/python# coding:utf-8# 测试工具方法的使用import bmob_base_utils as utilsdef main():    # 测试query方法    #resp = utils.query(table_name = 'monthly', object_id = '2290ce60cc')    #print resp    # 测试insert方法    '''    data = {'name':'Ben','age':18}    resp = utils.insert(table_name = 'test',data = data)    print resp    '''    # 测试update方法    #data = {'age':999}    #utils.update(table_name = 'test',object_id = '79cfd8639b',data = data)    # 测试delete方法    #utils.delete(table_name = 'test', object_id = '79cfd8639b')    # 测试list方法    # print utils.list('test')    # 测试batch_insert方法    request_data = {}    request_data['requests'] = []        table_name = 'test'    data1 = {        \"method\":\"POST\",        \"path\":\"/1/classes/{0}\".format(table_name),        \"body\":{            \"name\":\"Tom\",            \"age\":18        }    }    data2 = {        \"method\":\"POST\",        \"path\":\"/1/classes/{0}\".format(table_name),        \"body\":{            \"name\":\"John\",            \"age\":21        }    }    request_data['requests'].append(data1)    request_data['requests'].append(data2)    utils.batch_insert(request_data)if __name__ == '__main__':    main()                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 Node.js (基础十一) 全局对象 & (基础十二) GET/POST请求 ...               小程序版本的 Auto Draw                                                        原作者: AzureSky                   来自: 博客园                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序之HTTPS请求封装示例                                                      • 微信小程序--二次封装的缓存框架 wCache（支持缓存时间、默认值） ...                                                      • 微信小程序网络请求封装                                                      • 微信小程序之网络请求简单封装                                                      • 微信小程序--外部API调用方法遇到的一个小问题                                                      • 以微信小程序为例学习网站开发平台API调用                                                      • 前端开发--微信小程序中页面代码中的模板封装                                                      • 微信小程序 wepy wx.previewImage 封装                                                      • 微信小程序request的Promise封装                                                      • 黄秀杰--Node后端优雅使用Bmob                                                                                               "},{"title": "面向新手《十一》：weui-wxss的使用，page.json中背景色不生效 ", "author": "                  天下雪                  2016-12-29 00:51                ", "text": "                                                                                                                                                                                                                                                                 本系列针对新手为一些新手可能需要到的知识点聚合更多本系列相关文章请看相关文章内；一：weui-wxss的使用分享者：SundayAaron原文地址概述：WeUI 是一套同微信原生视觉体验一致的基础样式库由微信官方设计团队为微信内网页和微信小程序量身设计令用户的使用感知更加统一。包含button、cell、dialog、 progress、 toast、article、actionsheet、icon等各式元素。预览：用微信web开发者工具打开dist目录（请注意是dist目录不是整个项目）Github下载地址： https://github.com/weui/weui-wxss使用：组件的wxml结构请看dist/example/下的组件样式文件可直接引用dist/style/weui.wxss或者单独引用dist/style/widget下的组件的wxss使用示例：下载weui-wxss压缩包解压。把dist/style/weui.wxss文件放到你项目的根目录（或者其他目录）。在app.wxss中添加如下代码：@import 'weui.wxss'; 注意：路径要对应上！接下来我们以SearchBar为例在自己的小程序里使用SearchBar样式。新建快速项目去除掉无用代码把weui.wxss文件拷贝到项目目录在app.wxss里引用样式文件 @import 'weui.wxss';新建一个searchbar文件夹在app.jason中定义searchbar页面把weui-wxss里的 weui-wxss-master\\dist\\example\\searchbar 文件都拷贝到你新建的项目 searchbar文件里调试、查看结果 其他效果同理demo下载地址： http://download.csdn.net/detail/sundayaaron/9709961文件下载：weui的使用.zip二：page.json中设置背景色不生效解决办法分享者：Pluto原文地址在page.json中按照官方文档设置{  \"navigationBarBackgroundColor\": \"#ffffff\",  \"navigationBarTextStyle\": \"black\",  \"navigationBarTitleText\": \"微信接口功能演示\",  \"backgroundColor\": \"#eeeeee\",  \"backgroundTextStyle\": \"light\"}实际上是并没有看到效果。。没找到解决办法自己直接在wxss中改了样式如下：Page {  background: #203348;  color: #fff;  font-size: 30rpx;  width: 100%;  height: 100%;  overflow-x: hidden;  overflow-y: auto;}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序小技巧系列《十三》多级联动自定义圆形进度条 ... ...               github精选：微信小程序入坑指南                                                        原作者: 天下雪                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 面向新手系列《四》官方文档BUGtip及QA提示一览                                                      • 面向新手系列《五》POST请求服务器接收不到data参数问题                                                      • 面向新手系列《六》快速创建页面技巧及正则使用简介                                                      • 面向新手系列《七》加载本地图片与网络请求                                                      • 面向新手系列《八》for循坏数据访问下拉刷新/上拉加载                                                      • 面向新手《九》：微信小程序常见错误及基本排除方法                                                      • 面向新手《十》：多个view居中显示轮播局部元素隐藏                                                      • 新手跳坑指南《六十六》：路径path坑；相对路径与绝对路径                                                      • 面向新手《十二》：拍照或选择图片并上传文件关于tabbar                                                      • 面向新手《十三》：快速掌握小程序事件自定义参数的方法获取微信用户唯一标识openid ...                                                      • 面向新手《十四》template的使用上传文件uploadfile                                                      • 面向新手《十五》api支持解读微信小程序框架简介                                                      • 面向新手《十六》入门实战：欢迎页面的创建简易新闻demo制作 ... ...                                                      • 面向新手《十八》获取微信访问用户的openid解密 C# 代码                                                      • 微信小程序参考微信设计规范做的modal模态框                                                      • WeUI（微信）原型资源分享（附组件库及原型下载）                                                      • 微信小程序开发之——flex布局和weui-wxss的使用                                                      • 微信小程序设计weui框架                                                      • 小程序开发实用技巧——扩展 Page 页面对象                                                                                               "},{"title": "小程序踩坑记《一》初始化显示指定界面，scroll-view上拉加载与page的下拉刷新冲突 ... ", "author": "                  天下雪                  2017-2-11 00:31                ", "text": "                                                                                                                                                                                     作者：zhangzy来自原文地址一：初始化显示指定界面一般对于后台功能比如商家、管理员等需要先登录才能进入到app所以需要在打开的时候来判断用户是否登录从而决定是进入app还是登录界面。那么在小程序中我们怎么来进行登录的判断呢？大家都知道在小程序中我们注册页面是通过 app.json 这个文件 的pages字段。{  \"pages\": [      \"page/login/index\",      \"page/index/index\",  ]}注册之后打开小程序会自动显示注册在最前面的页面这里也就是 page/login/index你会发现就算你登录之后也还是会进入到登录界面但是我们需要在用户登录之后跳转到page/index/index所以这里我们需要加逻辑判断来切换跳转由于注册入口是app.json而非js文件所以这里不能加条件判断看来不能从这里下手对于单入口程序来说一般都是在入口文件进行判断看文档我们会发现小程序的入口文是app.js并有对应的生命周期 我们或许可以在onLaunch做处理App({  onLaunch: function () {    let user = UserModel.getUserSync();    if(user) {      wx.redirectTo({url: 'page/index/index'});      return    }  }});上面逻辑就是如果用户登录跳转到首页如果首页是tabbar中的请使用wx.switchTab方法看上去很完美。运行测试一下WAService.js:3 jsEnginScriptErrorCannot read property 'webviewId' of undefinedTypeError: Cannot read property 'webviewId' of undefined    at x (http://700744025.appservice.open.weixin.qq.com/WAService.js:5:26872)    at .<anonymous> (http://700744025.appservice.open.weixin.qq.com/WAService.js:5:28821)    at http://700744025.appservice.open.weixin.qq.com/WAService.js:6:688    at http://700744025.appservice.open.weixin.qq.com/WAService.js:4:2530    at Array.forEach (native)    at .<anonymous赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    获取微信小程序页面带参二维码全流程               小程序踩坑记《二》页面关闭数据传递picker的日期bug                                                                                                                                                                /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • github精选：微信小程序入坑指南                                                      • github精选：微信小程序踩坑集合（更新）                                                      • 微信小程序开发入坑指南                                                      • 微信小程序踩坑记                                                      • 小程序踩坑记《二》页面关闭数据传递picker的日期bug                                                      • 小程序踩坑记《三》复杂数据的传递长按与点击事件冲突                                                      • 百度翻译api实现微信翻译小程序                                                      • 微信小程序踩坑之路                                                      • github精选：微信小程序入坑指南：scroll-view                                                                                                                                                   0 条回复                                                                        \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                                   推荐阅读开发小程序折叠面板2020-02-16小程序对文件及后缀名解析2020-02-16小程序后端 egg 框架开发记录2020-02-16国务院推荐微信到家业务微信预告新能力协2020-02-16支付宝英雄帖发布首周超1200位开发者报名：2020-02-16微信开放“智慧零售”入口每日优鲜、优衣2020-02-18微信小程序直播能力开启公测 疫情下助推商2020-02-18微信紧急征集这四类小程序让你的小程序被2020-02-19新能力！小程序直播开始公测无门槛免费使2020-02-19Taro 小程序开发大型实战：尝鲜微信小程序2020-02-19最新Demo搭建2020-02-04            jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092516|b8e746d3b2eeb4c35fd8df409514e4c6|2';\t\t\t\t\t\t"},{"title": "微信小程序：商城系列专辑（开发指南+精品Demo） ", "author": "                  Rolan                  2017-6-12 12:34                ", "text": "                                                                                                                                                                                     商城开发指南：微信小程序商城模块 | 链接使用zanui开发小程序微商城（模板组件的开发规范）| 链接ecshop商城开发：用户信息的获取和缓存地址信息的缓存 | 链接微信小程序商城 - 基于ecshop插件接口文件 | 链接基于vue, react, node.js, go开发的微商城 | 链接移动小商城：基于node包含前后台 | 链接微信小程序之侧栏分类 —— 微信小程序实战商城系列（1） | 链接微信小程序之仿淘宝分类入口 —— 微信小程序实战商城系列（2） | 链接微信小程序之购物数量加减 —— 微信小程序实战商城系列（3）| 链接微信小程序之商品属性分类 —— 微信小程序实战商城系列（4）| 链接微信小程序之购物车—— 微信小程序实战商城系列（5）| 链接商城Demo：微信小程序Demo：零食商城 | 链接微信小程序商城类demo：灵动云商（含PHP后端）| 链接微信小程序demo：经销商/供应商/加工厂/供应商城 | 链接微信小程序demo：儿童类微商城 | 链接微信小程序Demo：美容商城 | 链接微信小程序demo：济颐馆：营养品类商城 | 链接微信小程序demo：仁怀酱酒宝：酒类商城模板 | 链接微信小程序Demo：五洲商城 | 链接微信小程序Demo：微商商城 | 链接微信小程序Demo：辣椒忍者（点餐商城）| 链接微信小程序demo：九猫大百货 | 链接微信小程序Demo：淘宝商城一类 | 链接微信小程序完整demo：企业版商城（含php后端）| 链接微信小程序demo：猴哥数码商城（附java后端）| 链接微信小程序demo：乐仁商城 | 链接微信小程序商城类demo：丽芙家具 | 链接微信小程序demo：仿玩物志商城 | 链接微信小程序demo：我的商城 抽屉层 | 链接微信小程序demo：酒水商城 | 链接微信小程序商城类demo：DFS：前端、PHP后端 | 链接微信小程序demo：辅材商城tab列表 | 链接微信小程序完整demo：巴爷商城（含后端）| 链接微信小程序demo：同乐居商城：购物车合算（适用1221）| 链接微信小程序商城demo：界面设计基本完善（适用1221）| 链接微信小程序demo：幸运叶子商城 | 链接微信小程序学习用demo：康爱多微商城：学习界面设计 | 链接微信小程序商城demo：UI设计完善适用1122版本 | 链接微信小程序demo：投资收益商城（组件练习适用1122版本）| 链接微信小程序学习用demo：积分商城 | 链接微信小程序demo：基础商城 | 链接微信小程序demo：商城分销系统 | 链接优质demo推荐：老酒商城：适用1028版本 | 链接微信小程序demo：黑市商城框架；适用1028版本 | 链接微信小程序demo：XY商城：适用1028版本 | 链接微信小程序demo：环球小镇商城 | 链接微信小程序demo：有调商城 | 链接微信小程序demo：大好商城（新增功能天气查询和2048游戏）| 链接微信小程序demo：吉利宝商城 | 链接微信小程序demo：爱宝宝母婴微商城 完整源码+配置指南 | 链接                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)yeayee天下钞票                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序调用PHP后台接口解析纯html文本               微信小程序--实现多个按钮toggle功能                                                        原作者: rolan                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序：小技巧系列合辑No.1                                                      • 微信小程序 ：小商户的大舞台！                                                      • 【微信小程序开发】来看看那些年我们踩过的坑~                                                      • 微信小程序商城开发--注意要点                                                                                               "},{"title": "github精选：微信小程序踩坑集合（更新） ", "author": "                  天下雪                  2017-1-12 00:59                ", "text": "                                                                                                                                                                                     分享者：senolaGitHub地址：https://github.com/senola/webchat-app-issues早就知道小程序这个坑很深一个多月的实践发现这个坑果然名不虚传...      不过开发的小程序如期上线了还是值得庆贺！！！呵呵记录一下那些让自己停顿的点。一、开发微信小程序遇到的坑1、 {{}} 不能执行方法只能处理简单的运算如 “+ - * /”比如遇到遍历list每个item的金额需要格式化只能在js里预先格式化好再setData一遍( ╯□╰ )2、只能通过,只能通过,只能通过setData()更新视图坑..........3、我们规定页面路径只能是五层请尽量避免多层级的交互方式。4、A页面-->B页面B页面返回A如何触发A的刷新不增加页面层级。 暂时想到的方案：在A页面的onshow事件里写A的初始化数据逻辑。5、undefined 当作字符串处理 if(xxx == \"undefined\") 【后期版本迭代优化了】6、遇到奇怪的问题（如样式等）先重启工具百试不爽7、不支持本地web字体(需要使用线上字体),经测试发现一些安卓就是不能正常显示。几经折腾才发现原来还要存放字体的服务器要支持跨域。尼玛手机上调试也不报错差点放弃web字体了。卡了好久坑.............8、本地资源无法通过 css 获取 可以使用网络图片或者 base64或者使用 <image/> 标签9、不能直接操作 Page.data 【避免在直接对 Page.data 进行赋值修改请使用 Page.setData 进行操作才能将数据同步到页面中进行渲染】10、数字键盘用 type=\"digit\"11、已用 https但报无法建立与该服务器的安全连接是什么情况【需要 nginx 配置一下 https 的加密标准为tls1.2及以上】12、wx.setStorage(OBJECT) 【目前每个小程序限制5M】13、数据监控【微信后台：事实访问次数/昨日概况/累计访问用户数/TOP受访页】14、微信调试神器ngrok见 ngrok15、view 添加点击效果[需要开启hover效果]：<view hover hover-class=\"item-hover\"> 16、用户授权调试方法【开发工具-》清除手机授权数据 (缓存-清除手机授权数据) 】17、安卓手机上小程序第一次加载时候首页时候 onshow方法会莫名其妙加载两遍而同样在iphone下却不会由于需要在onshow里面触发获取用户信息所以系统加载两次onshow会导致后台报错。。。18、禁止页面下拉： 设置 \"disableScroll\": true 。19、安卓下会出现getAppConfig:fail无法获取userInfo。微信问题下载最新的微信安装包20、后台不能接受POST数据但是可以接收GET请求参数    url: url,    data: data,    method: \"POST\",    dataType: \"json\",    header: {      'content-type': 'application/x-www-form-urlencoded' //==> 此处若为application/json则服务端无法获取POST的参数    }21、小程序第一次启动用户拒绝授权后下一次无法唤起授权弹框默认记住上一次用户的选择。暂时没有找到解决方法微信也没有相关解析。【2017-01-10】22、跳转到有tabbar的页面一定要用 wx.switchTab().这个在各个群里几乎每天都有人问到！！！22、绑定开发者/体验者时记得去手机上确认邀请。（超多人问）23、 微信后台更新了request合法域名可以直接去微信开发工具-->项目-->配置信息-->刷新立马生效。24、 小程序官方没有提供java版登录信息解密示例可以用这个demo java版解密demo25、 使用wx:for遍历的时候最好加上wx:key=\"{{item.id}}\"如果明确知道该列表是静态或者不必关注其顺序可以选择忽略但是如果遍历的数组会发生改变则有可能导致数据顺序会改变。26、小程序开发页面便利之处在于rpx, 所以设计稿建议用iphone6尺寸。flex布局可以参考这篇二、小程序开发前相关配置1、登录--->管理员扫二维码-->设置-->开发设置-->生成AppSecrect2、服务器配置 登录--->管理员扫二维码-->设置-->开发设置-->服务器域名-->扫二维码3、绑定开发者 用户身份-->开发者-->二维码 开发者最多10人4、绑定体验者 用户身份-->体验者-->二维码扫描 体验者20人三、小程序发布发布只能用管理员账号。步骤如下：开发工具中退出开发者账号管理员扫码登录开发者工具上传-->微信后台设为体验版本-->审核-->发布注意： 审核时间不定2-6天四、审核不通过原因收集1、小程序简介没有介绍小程序功能2、类目与页面提供的内容不一致3、小程序提供的服务和内容必须是正式的不能以测试内容提交多次以测试内容提交4、含有声音视频内容请补充相关对应类目5、首页图片与文字有互相重叠建议优化6、搜索框及少数下才能选中页面评论点击无响应页面图片分辨率尺寸失真7、部分图片显示被压缩体检不好8、有账号体系的小程序除自有登录方式必须支持微信授权登录9、必须登录才能使用的服务请提供测试账号10、存在虚拟物品在线交易 ios系统需要走IAP,小程序暂不支付请留意后续11、小程序服务类目所对应的页面中的核心内容必须与该类目一致。12、必须保证用户在该页面能使用该服务类目不得隐藏不得进行多次跳转13、不得展示和推荐第三方小程序。示例：不能做小程序导航不能做小程序链接互推小程序排行榜等14、小程序的页面内容中存在诱导类行为包括但不限于诱导分享、诱导添加、诱导关注公众号、诱导下载等要求用户分享、添加、关注或下载后才可操作的程序含有明示或暗示用户分享的文案、图片、按钮、浮层、弹窗等的小程序通过利益诱惑诱导用户分享、传播的小程序用夸张言语来胁迫、引诱用户分享的小程序强制或诱导用户添加小程序的都将会被拒绝；15、 禁止视频、音乐、语音等多媒体的自动播放16、 如果小程序有账户系统必须提供能正常使用且易于发现的“退出”账户选项17、小程序内容不能包含赌博、竞猜和抽奖的。18、小程序的页面内容中不能存在测试类内容；示例：算命抽签星座运势等。其他微信小程序平台常见拒绝情形五、文档及社区1、官方文档2、官方Q&A3、官方社区4、小程序接入指南5、小程序常见FAQ六、code1、封装微信发起请求接口,登录失效默认自动发起登录请求/** * 发起的是 HTTPS 请求 * @pram url: 请求地址,协议必须为https * @pram data 请求参数请求参数 * @param success 请求成功回调 * @param fail 请求失败回调 * @param complete 请求完成（成功或者失败）回调 */function request(url, data, success, fail, complete) {  var _url = url,      _data = data,      _success = success,      _fail = fail,       _complete = complete;  wx.request({    url: url,    data: data,    method: \"POST\",    dataType: \"json\",    header: {      'content-type': 'application/x-www-form-urlencoded',      'Client-Agent': getSystemInfo(),      'WX-SESSION-ID': wx.getStorageSync(constant['WX-SESSION-ID']) //每次请求带上登录标志    },    success: function(res) {      if(res.data.code == \"-9999\") { //会话失效重新登录        requestLogin(function(){          constant['NUM_TRY_LOGIN'] ++;          //设置请求上限防止重复提交并死循环          if(constant['NUM_TRY_LOGIN'] < constant['LIMIT_NUM_TRY_LOGIN']) {            request(_url, _data, _success, _fail, _complete);          }        });        return;      }      if(res.data.code == \"0\") {         if(typeof _success == \"function\") {           _success(res.data);         }      } else {         wx.showToast({title: res.data.msg, icon: 'loading', duration: 2000});         return;      }    },    fail: function(res) {      if(typeof _fail == \"function\") {        _fail(res);      }      if(typeof _fail == \"string\") { //请求失败的弹框提示        wx.showToast({title: _fail, icon: 'loading', duration: 2000});      }    },    complete: function(res) {      if(typeof _complete == \"function\") {        _complete(res);      }    }  });}2、请求登录接口/** * 请求登录,获取用户相关信息 * @param callback */function requestLogin(callback) {  var _callback = callback;  wx.login({      success: function (event) {        // 获取到请求码继续请求用户的基本信息        if(event.code) {          var code = event.code;          wx.getUserInfo({              success: function (res) {                var data = {                  code: code,                  encryptedData: res.encryptedData,                  iv: res.iv,                  signature: res.signature,                  rawData: res.rawData                }                var url = domain + \"/wx_xxx\"; //请求登录地址                request(url, data,                   function(res){ //success                    if(res.code == \"0\") {                       //此处可以将服务端返回的登录状态保存起来                       wx.setStorageSync(constant['WX-SESSION-ID'], res.object.sessionId);                       if(typeof _callback == \"function\") {                         _callback();                       }                    }                  },                  function(res){ //fail                    wx.showToast({title: '请求登录失败',icon: 'loading', duration: 2000});                  }                );              },              fail: function(res) {                //用户拒绝授权                if(res.errMsg == \"getUserInfo:cancel\" || res.errMsg == \"getUserInfo:fail auth deny\") {                   wx.redirectTo({ //跳转至未授权页面                    url: '../xxx-page/xxx-page'                  });                }              }          })        } else {          wx.showToast({title: '微信登录失败',icon: 'loading', duration: 2000});        }      },      fail: function(res) {        wx.showToast({title: '微信登陆失败！',icon: 'loading', duration: 2000});      }  });}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (4)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (4 人)JudyMr.LixfmaiGegentibu                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    推荐！微信小程序开发心得：首页制作animation使用动画详解 ... ... ...               干货！微信小程序常规增删改查学习                                                        原作者: senola                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序跳坑                                                      • github精选：微信小程序入坑指南                                                      • 新手跳坑指南《六十六》：路径path坑；相对路径与绝对路径                                                      • 推荐阅读！微信小程序全面实战架构设计 && 躲坑攻略 ...                                                      • 微信小程序实战教程：微信支付跳坑流程                                                      • 微信小程序跳坑记：uploadFile:fail与一键登录之无法识别json数据 ...                                                      • 微信小程序开发新手注意点                                                      • 微信小程序踩坑记                                                      • github精选：构建自己的第一个小程序                                                      • 小程序踩坑记《一》初始化显示指定界面scroll-view上拉加载与page的下拉刷新冲突 ...                                                      • 微信小程序踩坑                                                      • 微信小程序踩坑之路                                                      • 小程序开发踩坑                                                                                               "},{"title": "微信小程序开发入坑指南 ", "author": "                  天下雪                  2017-1-12 00:03                ", "text": "                                                                                                                                                                                     作者：奔跑的炸鸡来自授权地址前言从去年一月份微信宣告要做小程序时的圈子里已经有了局部躁动去年九月内测时更是全民热捧似乎张晓龙和他的微信已经准备好再一次改变世界。还好微信比它的粉丝们要理智的多不做分发不搞渠道不发“红利”所以昨天正式发布时也并没有想象中的所有人一起迎接新世界到来的景象。OSC上有人发帖问“微信小程序就要发布了,大家激动吗”底下居然都已经有人开喷了。。但是话说回来从技术角度看微信为我们提供了基于微信本身的新应用场景下的新技术那么作为一个开发者对他有所了解还是有必要的。对于一个新技术对其建立一个相对清晰的概念是最重要的事情因为有了一个大概的印象之后任何程序员都可以很快的学习和进步。因此这篇文章我不会照抄文档也不会讲一些“高深”的东西我们来解决初次接触无从下手的问题。学习怎么做出“Hell World”开始前的准备微信小程序官网：微信小程序官方网站微信小程序开发工具下载地址：微信小程序下载地址使用微信小程序开发工具登录并创建项目下载并安装微信提供的微信小程序开发工具之后我来学习如何使用它。登录界面首先是登录界面这里我们需要扫描二维码进入即使我们没有在微信公众平台上申请注册小程序也是可以扫描登陆的所以无需担心直接用自己的微信扫描并登录即可。然后在接下来出现的界面中点击加号图片来建立我们的项目。创建项目创建项目这里有几点需要注意：如果已经申请到了小程序权限那么直接填对应的Appid即可如果没有的话直接点击无AppID选项则可以创建本地项目。微信Web开发者工具在创建项目的时候不会创建跟项目同名的项目文件夹所以项目文件夹请提前手动创建好不要为了图方便直接创建项目到桌面mac版的开发工具无法在桌面创建项目。最后的创建quick start项目 如果勾选的话微信会在项目初始化后创建一个登录界面和打印日志的界面是否勾选看个人意愿。初次使用的同学建议勾选上可以更方便的对小程序有个初步认识。认识开发界面开发工具界面项目创建完毕后呈现给我们的就是主界面了。先说明一下左侧四个按钮的含义编辑：主要的开发界面提供效果预览代码编辑器,并可以对项目配置文件编辑添加删除和管理调试：主要的调试界面提供效果预览代码编辑器控制台输出断点调试性能监控等功能项目：项目的总体设置关闭：关闭项目认识项目结构初始化项目目录上图红色方框圈中的地方就是我们初始化之后的项目目录。其中app.jsapp.json和app.wxss文件时属于整个项目的全局文件。app.js：我们在这里注册程序并将对程序做初始化的操作放在这里做iOS的同学可以认为这就是AppDelgete文件app.json：我们在这里对App进行全局配置决定页面文件的路径、窗口表现、设置网络超时时间、设置多 tab 等app.wxss文件：全局的样式文件你可以认为就是微信版的css文件实际用法也和css几乎一样接下来是页面的结构微信小程序中每个页面对应四个文件分别为.js .json .wxml 和.wxss.wxml文件是布局文件实际上接触过reactnative的同学一眼就发现了微信采用了和rc相似度极高的JSX语法刚开始可能看着别扭但实际学习成本很低很快就可以上手。对于每个页面.wxml文件和.js文件都是必须的其他两个则可有可无如果有的话在选择样式或者配置时优先使用和自己同名的文件里的配置。需要特别说明的是如果不打算给页面写单独的配置文件不要创建空白的.json文件会导致页面路径查找失败。修改布局文件之前说了那么多概念记不住也没关系我们接下来通过动手来熟悉他们。首先我们来试着添加代码“index.wxml”这个文件。点击左侧的编辑按钮在右侧的文件目录中找到index.wxml文件然后随便写几句.微信小程序提供的组件还是相对比较丰富的具体支持的组件大家可以移步文档查看。代码写完之后直接cmd+s保存就可以刷新预览视图实时查看效果很方便基本语法也很简单大家应该一看就会。这是一个文本组件之间可以相互嵌套也就是说愿意的话你可以这么写<button>  <button>    <button>      <button>这是一个按钮</button>    </button>  </button></button>只不过看起来很奇怪罢了组件嵌套绑定数据和事件如果将微信小程序开发类比为iOS开发的话.wxml文件就相当于.xib而.js文件就相当于.m文件。这里的数据绑定其实就是在js中为.wxml中声明的变量提供数据而事件绑定就是在js中实现.wxml文件中声明的方法。我们先来看看数据绑定的例子。我们在index.wxml文件里随便找个地方书写如下代码：   <text>hello {{name}}</text>这里这个name就是我们声明的数据在申明时我们需要用一种称之为Mustache的语法不知道这是什么无所谓记住在两边加上两个大括号就行了。而这个数据我们需要在.js中提供。我们打开index.js找到page下的data：{},在其中添上一行name:\"小明同学\"Paste_Image.png然后cmd+s保存看下预览视图是不是出现了“hello 小明同学”.提供绑定的数据这里的page我们一会就会说而这个data你可以认为就是用来提供数据源的我们在.wxml中绑定的动态数据都来自对应page的data。接下来我们来实现事件的绑定我们再在index.wxml中随便找个地方,书写如下代码：  <button bindtap=\"ToNewPage\">跳转新界面</button>这句话的意思就是我们创建了一个按钮并给它绑定了一个叫做“ToNewPage”的点击方法。bingtap即为button控件的点击方法接下来我们要来实现这个方法依然是在index.js里的page中添加我们在data下面另起一行写下如下代码ToNewPage: function(){wx.navigateTo({  url: '../welcom/welcom',  success: function(res){    // success  },  fail: function() {    // fail  },  complete: function() {    // complete  }})}实现绑定的事件我们在事件中写了一个跳转新页面的操作试图跳转到一个位于welcom文件夹下的叫做welcom的页面所以想实现这个操作我们还得先创建welcom页面。wx.navigateTo()方法是微信提供的跳转页面的API这种大量回调的编程风格如果接触过Node.js或者Rect的同学可能比较熟悉。不熟悉的同学可以移步这里做个学习创建新页面前面已经说过微信小程序的每个页面都需要四个文件再加上微信小程序的定位决定了他不会有很多页面和很复杂的目录结构所以建议每个页面单独新建一个文件夹方便管理。还是在编辑模块开发工具已经很贴心帮我们做好了创建文件夹或者对应格式文件的功能但是这里需要注意的是在创建四个个文件的时候务必保证除后缀外名称一致。创建文件创建好后的文件如下所示welcom之前我们说过.json是配置文件.wxss是样式文件是非必须的尤其是.json文件如果不需要额外配置该页面最好不创建如果你不小心创建了请务必保证文件里至少有个{},否则编译器会报错。创建完之后我们还要做以下两件事：1.配置文件路径。如果不配置路径的话则无法跳转到此页面。打开app.json文件在pages数组中添加一行welcom的路径添加后如图所示配置路径2.注册页面。如果不注册页面的话编译器会报警\"XXXX出现脚本错误或者未正确调用 Page()\"。打开welcom.js在里面书写如下代码。Page({ data:{},onLoad:function(options){// 页面初始化 options为页面跳转所带来的参数},onReady:function(){  // 页面渲染完成},onShow:function(){// 页面显示},onHide:function(){// 页面隐藏},onUnload:function(){// 页面关闭 }})这个例子写的很长里面包含了page所有的生命周期函数如果你不想写这么多的话。你只需要写Page({})这样就可以完成页面的注册然后之后再根据你的需要去写具体的代码。这里请注意方法名的大小写是Page不是page。然后我们重新刷新页面再次点击我们在index.wxml中写的按钮会发现它直接就调转到了新写的页面。到此为止我们同时完成了新页面的创建和跳转以及事件的绑定。在.wxml文件中还有列表渲染条件渲染之类的概念大家可以移步文档自行查看基本概念大同小异。接下来我们来看最后一部分也是我们还没用到的.wxss文件。样式上面也说过.wxss文件就是微信版的css而且和传统css用法基本一模一样。也同时支持方便快捷的内联式的写法和使用.wxss样式表文件来统布局的方法。优先级方面：内联>.wxss>app.wxss在选择器方面的支持也比较全面因此这里就不在展开讲大家自行查看文档即可。结束语不管小程序会不会像之前人们吹捧的那样改变世界至少从开发者的角度讲从完善的文档到量身定做的开发工具微信这次真的是诚意满满。尤其是开发文档方面应该是我见过的最清楚最完善的开发文档了。因此这篇文章就像前面所说希望能帮大家解决一开始的无从下手的问题。等对微信小程序开发整体有了一个概念之后配合详细的官方文档开发微信小程序对每个开发者都不算难事。最后祝大家玩的开心。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)菜鸟vv                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    使用TypeScript开发微信小程序（1）               SF问答精选《一》：如何引入第三方插件调用自定义方法                                                        原作者: 奔跑的炸鸡                   来自: 授权地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • github精选：微信小程序入坑指南                                                      • 微信小程序踩坑记                                                      • 小程序踩坑记《一》初始化显示指定界面scroll-view上拉加载与page的下拉刷新冲突 ...                                                                                               "},{"title": "小程序之canvas图片及文本适配 ", "author": "                  Rolan                  2018-9-3 00:32                ", "text": "                                                                                                                                                                                     场景需求小程序目前不支持直接分享到朋友圈所以对于有分享到朋友圈的需求一般是生成一张图片例如生成一张带有小程序码的图片用户可以将这张图片保存到手机本地然后将这张图片分享到朋友圈。这张图片需要使用canvas画出来。今天我们不讲怎么生成码这个一般是后端封装一个API前端通过调用API得到一个小程序码的url通过image去画到canvas上跟在canvas上画一个image是一样的逻辑。这篇文章主要是讲怎么在canvas上适配图片和文字也就是怎么将图片和文本画到canvas上的正确的位置能在不同的手机上都能正确的展示。效果图展示（以下图片是在微信开发者工具中显示的） 这里演示的Demo是： “选择图片”button选择一张图片可以居中显示在以下图中的黄色区域即canvas中并在canvas的顶部居中展示文本“你若盛开蝴蝶自来”。以下是两个不同尺寸的图片画在canvas上分别在iphone5、iphone6、iphone6 plus上的展示效果图。这里的猫图片的原始尺寸：658*658这里的girl图片的原始尺寸是：700*699代码说明小程序尺寸单位小程序尺寸单位2. wxml<button bindtap=\"chooseImg\">选择图片</button><view class=\"canvas-box\">    <canvas class=\"canvas\" canvas-id=\"shareCanvas\" bindlongtap=\"saveShareImage\"></canvas></view>$3. scss（wxss） 这里我用的是scss去写样式代码在webStorm中可以通过配置将scss解析成wxss至于具体怎么配置可以自行百度。 PS1：这里定义了一个scss rpx function是因为在webStrom中格式化代码的时候会将数字和单位rpx中间添加一个空格导致编译报错所以用一个function去处理 PS2：样式说明（设计稿是基于iphone6视觉稿标准）： button宽高：700rpx * 92rpx (350px * 46px) 包裹canvas的容器的view（.canvas-box）position:fixed,占据除顶部button的高度之外填满剩余全部空间canvas居中显示宽高：700rpx 100%@function rpx($value) {  @return $value*1rpx;}page {  background-color: #fff6f6;  button {    width: rpx(700);    height: rpx(92);    background-color: #ffddab !important;  }  .canvas-box {    position: fixed;    top: rpx(92);    left: 0;    right: 0;    bottom: 0;    canvas {      position: absolute;      width: rpx(700);      height: 100%;      top: 50%;      left: 50%;      transform: translate(-50%, -50%);    }  }}$4. js 1、在data中定义三个变量data: {        windowWidth: 0, // 可使用窗口宽度        windowHeight: 0, // 可使用窗口高度        ratio: 0 // 根据尺寸动态计算 1px换算成多少rpx    }2、通过wx.getSystemInfo获得系统信息并且计算ratio    onReady: function (e) {        // 获取系统信息        wx.getSystemInfo({            success: res => {                console.log(res);                this.setData({                    windowWidth: res.windowWidth,                    windowHeight: res.windowHeight,                });                this.setData({                    // 屏幕宽度 375px = 750rpx1px=2rpx                    // 1px = （750 / 屏幕宽度）rpx；                    // 1rpx = （屏幕宽度 / 750）px;                    ratio: 750 / this.data.windowWidth                });            }        });    },3、button的触发事件chooseImg通过wx.chooseImage选择图片通过wx.getImageInfo获取选择的图片的大小chooseImg: function () {        wx.chooseImage({            count: 1,            success: res => {                let imgUrl = res.tempFilePaths[0];                // 获取图片大小                wx.getImageInfo({                    src: imgUrl,                    success: data => {                        let imgWidth = data.width;                        let imgHeight = data.height;                        // 创建canvas根据选择的图片大小在canvas上绘制图片和文字                        this.createCanvasShareImage(imgUrl, imgWidth, imgHeight);                    }                });            }        });    }4、创建canvas并在canvas上添加图片和文本 createCanvasShareImage: function (imgUrl, imgW, imgH) {        // 使用wx.createCanvasContext获取绘图上下文 context        let context = wx.createCanvasContext('shareCanvas');        console.log('context: ', context);        // 获取canvas的宽度：        // 750的设计稿基于iphone6的尺寸（屏幕宽度： 375px）在小程序中的比例是： 1px = 2rpx ==> 375px = 750rpx ==> 屏幕宽度(px) = 750rpx        // 所以 1rpx = 屏幕宽度 / 750        // 我们这里css中设置的 canvas 的width：700rpx, 所以 canvas的宽度计算是： [（屏幕宽度 / 750）* 700]rpx 这样就可以做到在不同手机上都可以适配        let canvasWidthPx = 700 / this.data.ratio;        // 设置 canvas 的背景并填充canvas        context.fillStyle = '#ffdc22';        context.fillRect(0, 0, canvasWidthPx, this.data.windowHeight);        // 绘制图片：图片居中显示在 canvas 中        let imgX = (700 - imgW) / 2;        let imgY = (this.data.windowHeight * this.data.ratio - 46 * this.data.ratio - imgH) / 2;        let clipWidth = imgW * this.data.ratio;        let clipHeight = imgH * this.data.ratio;        context.drawImage(imgUrl, -imgX, -imgY, clipWidth, clipHeight, 0, 0, imgW, imgH);        // 设置字体大小、文本颜色        context.setFontSize(20);        context.fillStyle = \"#000\";        // 计算文本的宽度：measureText() 取到文本的 width        let txtWidth = context.measureText('你若盛开蝴蝶自来').width;        // 绘制居中文本：这个地方的 (x, y)的坐标是在文本的左下角位置        context.fillText(\"你若盛开蝴蝶自来\", (canvasWidthPx - txtWidth) / 2, 20 * this.data.ratio);        context.draw();    }5、长按bindlongtapcanva保存图片或者直接预览图片先通过wx.canvasToTempFilePath将当前画布指定区域的内容导出生成指定大小的的图片再通过wx.saveImageToPhotosAlbum将图片保存到本地或者通过wx.previewImage直接预览图片。    saveShareImage() {        wx.canvasToTempFilePath({            canvasId: 'shareCanvas',            success: (res) => {                console.log('canvasToTempFilePath： ', res);                // 将图片保存到相册                wx.saveImageToPhotosAlbum({                    filePath: res.tempFilePath,                    success: (data) => {                        console.log(data);                    }                });                // 直接预览图片                wx.previewImage({                    urls: [res.tempFilePath]                })            }        })    }真机效果图显示（一加六手机） 一加6手机显示的小程序效果图.png保存到手机本地的图片.png作者：豆豆的故事 链接：https://www.jianshu.com/p/75fa54f6caa8                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 - 多地点标识(map)               Mpvue中无缝接入Vant Weapp组件库                                                        原作者: 豆豆的故事                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序朋友圈分享图片生成方案实现                                                      • 小程序页面效果 - 下载图片并且显示进度                                                      • 微信小程序如何裁剪图片作为转发封面                                                      • canvas里的图片如何自适应                                                      • 小程序生成海报保存分享图片完全指南                                                      • 小程序 Canvas绘图不同尺寸设备 UI兼容的两个解决方案                                                      • 微信小程序-canvas绘制文字实现自动换行                                                                                               "},{"title": "微信小程序开发--从px到rpx ", "author": "                  Rolan                  2017-8-7 00:06                ", "text": "                                                                                                                                                                                     我一直在想我是不是有必要再写这一节还是给大家提供一些阅读链接。因为关于单位的定义都是比较官方的。没什么好讨论的我这里做一个汇总和简单的说明吧。首先本文只以移动设备为例说明。本文摘要：设计师以iphone6为标准出设计稿的话1rpx=0.5px=1物理像素。Photoshop里面量出来的尺寸为物理像素点。所以可以直接使用标注尺寸数据。--------------------------------------看懂本文摘要的话就不用阅读下面的内容了-------------------------------------【英寸Inch】英寸表示屏幕斜对角线的长度。如下图所示：【像素Pixel】像素是图像的基本采样单位它不是一个确定的物理量因为像素点的物理大小是不确定的。如图:【分辨率】分辨率是屏幕像素的数量一般用屏幕宽度的像素点乘以屏幕高度的像素点。如描述iphone6的分辨率是750*1334.分辨率又分为【物理分辨率】和【逻辑分辨率】值得注意的是实际工作中设计师常常给的是物理分辨率程序中用到的是逻辑分辨率但是都称为分辨率容易混淆。【物理分辨率】是硬件所支持的分辨率【逻辑分辨率】是软件可以达到的分辨率。物理分辨率和逻辑分辨率的商称为【像素倍率dpr】也就是常说的几倍屏。如下图中所示iphone6的分辨率写着375*667这里指的就是它的逻辑分辨率。我们上面提的750*1334则是它的物理分辨率。所以iphone6的像素倍率=（750*1334）/（375*667）=2理解了上述的几个概念我们就可以接着来看下面的几个单位。【px】px就是Pixel的缩写就是指像素。这个作为图片采样的基本单位没什么需要特别说明的。【rem】在做移动端适配是最常用的方法就是使用rem作为单位因为rem是根据html的fontsize去动态计算实际的px的。所以常常应用这点做反向使用。即根据屏幕大小动态的设置fontsize.来达到不同的分辨率下有一样的效果。【rpx】rpx其实是微信对于rem的一种应用的规定或者说一种设计的方案官方上规定屏幕宽度为20rem规定屏幕宽为750rpx。所以在微信小程序中1rem=750/20rpx。但是这不是我们要关注的重点。在使用rem时我们常常让设计师根据iphone6的标准出设计稿。因为如果以iphone6为标准并且在iphone6上将fontsize设置成62.5%。那么1rem就等于10px我们只要将设计师标注的尺寸（一般标注的是物理分辨率）除以20就可以得到单位为rem的数值了。在 iPhone6 上屏幕宽度为375px共有750个物理像素则750rpx = 375px = 750物理像素1rpx = 0.5px = 1物理像素。css中的px与设备的物理像素并非绝对的一比一关系。px与物理像素的比例与设备的dpr（像素倍率）有关。rpx称为相对像素值rpx与物理像素也并非绝对的一比一关系。wxss将设备宽定义为750rpx是以iPhone6的分辨率（750x1334）为基准划分的。也就是说在iPhone6上1rpx=1物理像素=0.5px。因为设计师标注的尺寸一般是物理分辨率。所以如果以iphone6为标准出设计稿的话那么我们就可以不需要经过换算直接标准rpx。这节课的内容就到这里结束了。感谢您的阅读。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (1)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)sadgvs                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序实例-- 电影影评小程序               微信小程序开发问答《六十》错误状态码(例如：401)的获取& 日期选择器的起始时间极限 ...                                                        原作者: 陈小聪-小虎Oni                   来自: csdn博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序学习点滴《三》：开发工具及开发环境配置尺寸单位rpx与px,rem相互转换 ...                                                      • 微信小程序中rpx与rem单位使用                                                      • 微信小程序尺寸单位rpx和样式使用详解                                                      • 微信小程序 iphone6 和 iphone6plus 如何设置rpx单位                                                      • 微信小程序- 移动设备的分辨率与rpx                                                      • 微信小程序开发-rem转换rpx小工具                                                      • 微信小程序——动画操作时rpx 和 px 的转换计算                                                                                               "},{"title": "小程序入门总结篇 ", "author": "                  Rolan                  2018-8-10 00:08                ", "text": "                                                                                                                                                                                     须知App() 必须在 app.js 中注册且不能注册多个。编译后的代码包大小需小于 1MB 否则代码包将上传失败。每个页面需要手动在 app.json 中进行注册否则不能访问。app.json 中 pages 数组的第一项代表小程序的初始页面小程序中新增/减少页面都需要对 pages 数组进行修改。直接修改 this.data 无效无法改变页面的状态还会造成数据不一致。单次设置的数据不能超过 1024kB 请尽量避免一次设置过多的数据。不要尝试修改页面栈会导致路由以及页面状态错误。tabBar 只能配置最少2个、最多5个 tab 按数组的顺序排序。小程序页面只能同时打开 5 个如果交互流程较长难以支持。同时只能存在 5 个 url 请求。无法跳转小程序以外的 url 。没有 cookie 。没有开放加载 web 页面没有a标签链接不可嵌套 iframe没有 window 变量但微信提供了wx全局方法集事件绑定和条件渲染类似 Angular 全部写在 WXML 中1.1 主体由 app.js 、 app.json 、 app.wxss 三个文件组成放在根目录app.js 根目录的 app.js 很有用,因为在它内部注册的变量或方法都是可以被所有页面获取到。可以监听并处理小程序的生命周期、声明全局变量。其余的 .js 文 件可以通过 var app = getApp() 获取其实例调用其中定义的方法和变量但不可以调用生命周期的方法app.json 是小程序的全局配置pages 配置小程序的组成页面第一个代表小程序的初始页面window  设置小程序的状态栏、标题栏、导航条、窗口背景颜色tabBar  配置小程序tab栏的样式和对应的页面app.wxss 是小程序的公共样式表可以在其他 .wxss 文件中直接使用app.json\"pages\": [ //设置页面的路径  \"pages/index/index\", //不需要写index.wxml,index.js,index,wxss,框架会自动寻找并整合  \"pages/logs/logs\"],\"window\": { //设置默认窗口的表现形式  \"navigationBarBackgroundColor\": \"#ffffff\", //顶部导航栏背景色  \"navigationBarTextStyle\": \"black\", //顶部导航文字的颜色 black/white  \"navigationBarTitleText\": \"微信接口功能演示\", //顶部导航的显示文字  \"backgroundColor\": \"#eeeeee\", //窗口的背景色  \"backgroundTextStyle\": \"light\", //下拉背景字体、loading 图的样式仅支持 dark/light  \"enablePullDownRefresh\": \"false\" //是否支持下拉刷新 不支持的话就直接不写！  \"disableScroll\": true, //  设置true不能上下滚动true/false注意！只能在 page.json 中有效无法在 app.json 中设置该项。},\"tabBar\": { //底部tab或者顶部tab的表现是个数组最少配置2个最多5个  \"list\": [{ //设置tab的属性最少2个最多5个    \"pagePath\": \"pages/index/index\", //点击底部 tab 跳转的路径    \"text\": \"首页\", //tab 按钮上的文字    \"iconPath\": \"../img/a.png\", //tab图片的路径    \"selectedIconPath\": \"../img/a.png\" //tab 在当前页也就是选中状态的路径  }, {    \"pagePath\": \"pages/logs/logs\",    \"text\": \"日志\"  }],  \"color\": \"red\", //tab 的字体颜色  \"selectedColor\": \"#673ab7\", //当前页 tab 的颜色也就是选中页的  \"backgroundColor\": \"#2196f3\", //tab 的背景色  \"borderStyle\": \"white\", //边框的颜色 black/white  \"position\": \"bottom\" //tab处于窗口的位置 top/bottom  },\"networkTimeout\": { //默认都是 60000 秒一分钟    \"request\": 10000, //请求网络超时时间 10000 秒    \"downloadFile\": 10000 //链接服务器超时时间 10000 秒      \"uploadFile\": \"10000\", //上传图片 10000 秒    \"downloadFile\": \"10000\" //下载图片超时时间 10000 秒  },\"debug\": true //项目上线后建议关闭此项或者不写此项1.2 pagespages 文件夹里是小程序的各个页面每个界面一般都由 .wxml 、 .wxss 、 .js 、 .json四个文件组成四个文件必须是相同的名字和路径.js 是页面的脚本代码通过 Page() 函数注册页面。可以指定页面的初始数据、生命周期、事件处理等.wxml 是页面的布局文件只能使用微信定义的组件.wxss 是样式表需要注意尺寸单位： rpx 可以根据屏幕的宽带进行自适应样式导入： @import 导入外联样式表如： @import \"test.wxss\" ;定义在 app.wxss 中的全局样式作用于每个页面。定义在 page 的 .wxss 文件只作用于对应的页面会覆盖 app.wxss 中相同的选择器.json 是页面的配置文件只能设置 app.json 中的 window 配置内容会覆盖 app.json 中 window 的相同配置项即使不配置任何东西也需要写 {} ,否则会报错1.3 utilsutils 里面包含一些公共的代码抽取的 js 文件作为模块方便使用。模块通过 module.exports 对外暴露接口其他地方使用是 var utils = require('../../utils/util.js') 进行引用二、视图层 WXML2.1 数据绑定传统的视图和数据绑定那么微信小程序是通过什么方法来管理视图和对象绑定的呢,状态模式-单向数据流数据流向是单向的即视图变化不会影响对象状态UI.wxml 中的动态数据都来自 Page 中的 data 。数据绑定使用数据绑定使用双大括号将变量包起来可以作用于内容、组件属性(需要在双引号之内)、控制属性(需要在双引号之内)、关键字(需要在双引号之内)Page({    data: {        message: \"Hello\",        id:0,        status: true    }})<view> {{message}} view><view id=\"item-{{id}}\"> view><view wx:if=\"{{status}}\"> view><view hidden=\"{{status}}\"> checkbox>还可以进行简单的运算在大括号里<view hidden=\"{{status ? true : false}}\"> Hidden view><view> {{a + b}} + c view> <view wx:if=\"{{num > 6}}\"> view><view>{{\"hello\" + word}}view>2.2 条件渲染用 wx:if=”” 来判断是否渲染代码块<view wx:if=\"{{status}}\"> isShow view>还可以添加 else 块<view wx:if=\"{{num > 5}}\"> A view><view wx:elif=\"{{num > 2}}\"> B view><view wx:else> C view>2.3 列表渲染在组件上使用 wx:for 属性绑定一个数组就可以渲染组件了默认情况下数组的当前下标变量名为 index ,当前项的变量名为 item<view wx:for=\"{{array}}\">  {{index}}: {{item.message}}view>Page({  data: {    array: [\"AA\",\"BB\",\"CC\"]  }})使用 wx:for-item 可以指定数组当前元素的变量名使用 wx:for-index 可以指定数组当前下标的变量名<view wx:for=\"{{array}}\" wx:for-index=\"num\" wx:for-item=\"itemName\">  {{num}}: {{itemName}}view>2.4 模板templatename 定义组件模版的名称引用模版的时候使用 is 属性指定模版的名字 is 可以进行简单的三目运算需要传入模版需要的 data 数据。因为模版拥有自己的作用域所以只能使用 data 传入数据而不接受双花括号的写法<template name=\"msgItem\"><view><text> {{index}}: {{msg}} text><text> Time: {{time}} text>view>template><template is=\"msgItem\" data=\"{{...item}}\"/>2.5 公共模块的引用WXML 提供 import 和 include 两种文件引用方式。import 有作用域的概念不能多重引用<import src=\"a.wxml\"/><template name=\"A\"> <text> A template text>template>include 就可以多重引用<include src=\"header.wxml\"/><view> body view><view> header view><include src=\"footer.wxml\"/>2.6 事件名称以 bind 开头的事件不阻止冒泡名称以 catch 开头的事件冒泡是阻止的。如 bindTap和 catchTab在 WXM L 中可以使用 dataset 定义 data 中的数据会通过事件传递。它的事件以 data-开头多个单词以 - 链接如 data-a-b三、生命周期3.1 App()应用生命周期onLaunchonShowonHideonShowonError前台、后台定义： 当用户点击左上角关闭或者按了设备 Home 键离开微信小程序并没有直接销毁而是进入了后台；当再次进入微信或再次打开小程序又会从后台进入前台//app.jsApp({  onLaunch: function() {       //小程序初始化(全局只触发一次)  },  onShow: function() {      //小程序显示  },  onHide: function() {      //小程序隐藏  },  onError: function(msg) {      //小程序错误  },})//其他 开发者可以添加任意的函数或数据到 Object 参数中用 this 可以访问3.2 Page页面生命周期每个页面也有自己的生命周期小程序注册完成后加载页面触发 onLoad 方法。页面载入后触发 onShow 方法显示页面。首次显示页面会触发 onReady 方法渲染页面元素和样式一个页面只会调用一次。当小程序后台运行或跳转到其他页面时触发 onHide 方法。当小程序有后台进入到前台运行或重新进入页面时触发 onShow 方法。当使用重定向方法 wx.redirectTo(OBJECT) 或关闭当前页返回上一页 wx.navigateBack() 触发 onUnload//index.jsPage({  onLoad: function(options) {    //页面加载-----(一个页面只会调用一次)  },  onReady: function() {    //页面渲染-----(一个页面只会调用一次)  },  onShow: function() {    //页面显示-----(每次打开页面都会调用一次)  },  onHide: function() {    //页面隐藏-----(当navigateTo或底部tab切换时调用)  },  onUnload: function() {    //页面卸载-----(当redirectTo或navigateBack的时候调用)  },})//其他 开发者可以添加任意的函数或数据到 object 参数中在页面的函数中用 this 可以访问3.3 应用生命周期影响页面生命周期小程序初始化完成后页面首次加载触发 onLoad 只会触发一次。当小程序进入到后台先执行页面 onHide 方法再执行应用 onHide 方法。当小程序从后台进入到前台先执行应用 onShow 方法再执行页面 onShow 方法四、小程序限制4.1 程序限制脚本内不能使用 window 等对象zepto/jquery 会使用到 window 对象和 document 对象所以无法使用。样式表不支持级联选择器本地资源无法通过 css 获取 background-image 可以使用网络图片或者 base64 或者使用标签不支持 A 标签无法打开普通网页4.2 数量限制底部或顶部可以添加 tab 按钮区域 tabBar 是一个数组只能配置最少2个、最多5个 tab  tab 按数组的顺序排序。一个应用同时只能打开5个页面小程序的 wx.request 请求最开始最大并发数是5个后来估计随着用小程序的越来越多总之就是增加到了10个4.3 大小限制tabBar 上面的按钮 iconPath 图片路径 icon 大小限制为 40kbtabBar 上面的按钮 selectedIconPath 选中时的图片路径 icon 大小限制为 40kbsetData 页面传递数据单次设置的数据不能超过 1024kBsetStorage 本地缓存最大为 10MB小程序源码打包后的大小限制为 1M五、路由微信路由接口有三个分别是 wx.redirectTo 、 wx.navigateTo 和 wx.switchTab wx.navigateTo 全局最多调用5次如果某页面设置为 tab 页则只支持 wx.switchTab 不支持其他两种路由方式访问5.1 哪些情况会触发页面跳转小程序启动初始化第一个页面打开新页面调用 API wx.navigateTo 或使用  组件页面重定向调用 API wx.redirectTo 或使用  组件页面返回调用 API wx.navigateBack 或用户按左上角返回按钮tarbar 切换5.2 如何跳转页面使用 wx.navigateTo 接口跳转,原页面保留wx.navigateTo({  //目的页面地址  url: 'pages/logs/index',  success: function(res){},  ...})使用 wx.redirectTo 接口跳转关闭原页面,不能返回wx.redirectTo({  //目的页面地址  url: 'pages/logs/index',  success: function(res){},  ...})5.3 使用组件\"pages/logs/index\" hover-class=\"navigator-hover\">跳转当该组件添加 redirect 属性时等同于 wx.redirectTo 接口；默认 redirect 属性为 false等同于 wx.navigateTo 接口用户点击左上角返回按钮或调用 wx.navigateBack 接口返回上一页wx.navigateBack({    delta: 1})delta 为1时表示返回上一页为2时表示上上一页以此类推；如果dalta大于已打开的页面总数则返回到首页。返回后元界面会销毁5.4 页面跳转传值url?key=value&key1=value1传递的参数没有被 URIEncode ,传递中文没有乱码5.5 如何正确使用页面跳转官方规定小程序最多只能有五个页面同时存在意思是在不关闭页面的情况最多新开五个页面页面深度为5对于可逆操作使用 wx.navigateTo ,比如从首页跳转到二级页面从二级页面返回是不需要重新渲染首页对于不可逆操作使用 wx.redirectTo ,比如用户登录成功后关闭登录页面不能返回到登录界面。对于一些介绍性等不常用页面 wx.redirectTo 或 wx.navigatrBack不要在首页使用 wx.redirectTo 这样会导致应用无法返回首页5.6 页面栈getCurrentPages()使用wx.navigateTo每新开一个页面页面栈大小加1,直到页面栈大小为5为止使用wx.navigateTo重复打开界面假如使用wx.navigateTo从四级页面跳转到二级页面此时会在页面栈顶添加一个与二级页面初始状态一样的界面但两个页面状态是独立的。页面栈大小会加1如果页面栈大小为5则wx.navigateTo无效使用wx.redirectTo重定向假如使用wx.redirectTo从四级页面重定向到二级页面此时会将关闭四级页面并使用二级页面替换四级页面但两个页面状态是独立的。此时的页面栈大小不变请注意和使用wx.navigateTo的区别使用wx.navigateBack返回总结wx.navigateTowx.redirectTowx.navigateBack六、数据通信6.1 页面之间的通信app.globalDatawx.setStorageSyncurl// A页面-传递数据// 需要注意的是wx.switchTab 中的 url 不能传参数。wx.navigateTo({   url:'../pageD/pageD?name=raymond&gender=male'})// B页面-接收数据////通过onLoad的option...Page({onLoad: function(option){ console.log(option.name +'is'+ option.gender)// raymond is male  this.setData({option: option })}})6.2 参数传递6.2.1 小程序传递参数的方式1、通过在 App.js 中设置全局变量通常把不会更改的数据放在 app.js 的 Data 中在各个页面中都可以通过 APP 实例获取 Data 数据var app = getApp();var data = app.data;2、通过拼接 URL 直接传递wx.navigateTo({}) 中 URL 携带参数wx.navigateTo({  url: 'test?id=1'});在wxml中使用 navigator 跳转url传递参数代码如下将要传递到另一个页面的字符串testId的值赋值到url中class=\"test-item\" url=\"../../pages/test/test?testId={{testData.testId}}\">navigator>在 js 页面中 onLoad 方法中接收Page({  onLoad: function(options) {      var testId = options.testId      console.log(testId)  }})navigator 跳转 url 传递数组如果一个页面要将一个数组如相册列表传递到另一个页面class=\"test-item\" url=\"../../pages/test/test?albumList={{testData.albumList}}\">navigator>传递到js后从 options 中得到的是个字符串每个图片的url通过’,’分隔所以此时还需要对其进行处理重新组装为数组Page({    data: {         // 相册列表数据        albumList: [],    },        onLoad: function (options) {        var that = this;        that.setData({            albumList: options.albumList.split(\",\")        });    }})3、在wxml中绑定事件后通过 data-hi=\"参数\" 的方式传递这种方式一般是在wxml中绑定事件同时设置需要传递的数据如果需要传递多个可以写多个 data-[参数] 的方式进行传递<view bindtap=\"clickMe\" data-testId={{testId}}\">    ...view>在js页面中自定义方法clickMe中接收Page({    clickMe: function(event) {        var testId = event.currentTarget.dataset.testid;        wx.navigateTo({            url: '../../pages/test/test'        })    }})wxml中配置data-albumlist传递数组<view bindtap=\"clickMe\" data-albumlist={{testData.albumList}}\">    view>在js页面中自定义方法clickMe中接收Page({    clickMe: function(event) {        var albumList = event.currentTarget.dataset.albumlist.split(\",\");        wx.navigateTo({            url: '../../pages/test/test'        })    }})4、通过数据缓存存储再获取wx.setStorageSync(KEY,DATA) 存储数据try {  wx.setStorageSync('key', 'value')} catch (e) {    }wx.getStorageSync(KEY) 获取数据try {  var value = wx.getStorageSync('key')  if (value) {    // Do something with return value  }} catch (e) {   // Do something when catch error}或wx.getStorage({  key: 'key',  success: function(res) {     console.log(res.data)  }})七、疑问汇总为什么脚本内不能使用window等对象页面的脚本逻辑是在 JsCore 中运行JsCore是一个没有窗口对象的环境所以不能在脚本中使用 window 也无法在脚本中操作组件为什么 zepto/jquery 无法使用zepto/jquery 会使用到 window 对象和 document 对象所以无法使用wx.navigateTo无法打开页面一个应用同时只能打开5个页面当已经打开了5个页面之后 wx.navigateTo 不能正常打开新页面。请避免多层级的交互方式或者使用 wx.redirectTo样式表不支持级联选择器WXSS 支持以 . 开始的类选择器本地资源无法通过 css 获取background-image ：可以使用网络图片或者 base64 或者使用  标签如何修改窗口的背景色使用 page 标签选择器可以修改顶层节点的样式page {   display: block;   min-height: 100%;   background-color: red;}为什么上传不成功为了提升体验流畅度编译后的代码包大小需小于 1MB 大于 1MB 的代码包将上传失败HTTPS 请求不成功tls 仅支持 1.2 及以上版本微信小程序支持fetch或者promise吗?promise 工具目前不支持 fetch 客户端不支持 工具下个版本保持统一wx.request的POST方法的参数传输服务器接收不到的bugwx.request post 的 content-type 默认为 ‘application/json '如果服务器没有用到 json 解释的话可以把 content-type 设置回 urlencodedwx.request({....method: \"POST\",header: {\"content-type\": \"application/x-www-form-urlencoded\"},...})wx.uploadFile在手机上返回http码403安卓的微信升级到6.5.2及其以上版本小程序SVG支持吗?image 的src放远程svg可以 background-image 里也可以ipad不能使用小程序？暂时不支持ipad打开小程序请问小程序页内支持长按保存图片或分享图片吗？目前没有这个功能微信小程序不支持cookie使用 Reids 存储 session有些手机不支持Object.assign方法如果使用了该方法会出现莫名其妙的报错（并不会提示Object.assign is not function而是导致调用了Object.assign方法的方法不能被调用）！直接写一个合并对象的方法function assignObject(o, n) {    for (var p in n) {        if (n.hasOwnProperty(p) && (!o.hasOwnProperty(p)))            o[p] = n[p];    }}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)不捡鞋的张良cub帅哥成                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序朋友圈分享图片生成方案实现               小程序页面效果 - 下载图片并且显示进度                                                        原作者: Poetry's                    来自: Poetry's Blog                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序开发实践总结                                                      • JDC | 京东设计中心--小程序实战总结                                                                                               "},{"title": "微信、支付宝同时宣布：启动高速“无感”支付 ", "author": "                  Rolan                  2018-1-24 09:53                ", "text": "                                                                                                                                                                                     这个时代变化有多快？当你还在惊叹手机支付带来的改变时马云、马化腾却已经开始让支付脱离手机了！高速巨变同时宣布截至此时微信、支付宝已同时宣布：启动高速“无感”支付。多年未变的高速收费将迎来巨变！何为“无感”支付？你看支付宝：直接推出“车牌付”！只要信用分550分以上便可直接把车与支付宝账户绑定你的车就变成了支付宝车牌就变成了付款码。下高速时自动识别车牌自动从你的支付宝扣费。全程不需要现金、不需要找零、更不需要掏出手机！你再看微信：直接推出“高速e行”！只要你把你的车与微信账户绑定再开通免密支付。如果不放心还可以单独预存通行费。下高速时自动识别车牌自动从你的微信账户中扣款并发送扣费短信。实现先通行后扣费。更令人振奋的是这只是刚刚开始。待线路全面统一后将全国实现不领卡、不停车、全自动支付。目前支付宝从河南打响了第一枪微信从山东打响了第一枪。一场浩浩荡荡的“全国高速包围战”已经打响！                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信携手教育部培育小程序开发新生态               新版微信内测！账号快速切换微信版余额宝也来了！                                                        原作者: 万能互联                   来自: 搜狐科技                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • “同住”小程序疑涉黄被下线前车之鉴下共享床位为何屡禁不止 ...                                                      • 继微信小程序后星巴克上线了功能一样的支付宝小程序                                                      • 微信小程序再推iOS虚拟支付整改方案开发者该怎么办？                                                                                               "},{"title": "从一颗大树变成一片森林，微信要把移动支付的“半条命”交给服务商 ... ", "author": "                  Rolan                  2018-3-20 00:11                ", "text": "                                                                                                                                                                                     图片来源@视觉中国移动支付还有新故事吗？众所周知的是作为这一市场的最大赢家腾讯与阿里双方瓜分了近九成第三方移动支付市场。而在“双寡头”背后中国移动支付舞台上其实还有另一个十分重要而低调的角色——支付服务商数量庞大的服务商们实际承担着最终落地执行的重任。2018年3月19日微信支付合作伙伴大会连续第三年召开其主角正是广大的支付服务商腾讯副总裁、微信支付总经理张颖去年末曾透露微信支付目前已有超过3万家服务商合作伙伴。梳理历年微信支付在合作伙伴大会上提出的战略关键词或许可以一窥腾讯对于服务商战略的演进脉络。微信支付合作伙伴大会现场2016年的合作伙伴大会上微信支付开启了“星火计划”投入1亿元激励服务商帮助服务商拓展商户资源和持续运营这是业内首次对中小服务商进行的大规模激励。到了2017年微信正式提出了赋能创新的关键词向合作伙伴开放数十种类别、上百个项目的全新能力以微信支付为基础与合作伙伴共同壮大移动支付的千亿规模服务生态。此外针对小程序开放服务商接入模式微信支付为服务商提供小程序的接入方式和能力支持。而在2018年微信支付向钛媒体表示合作伙伴赋能体系将“进一步升级”——从产品、政策、服务商成长助力三个方面为服务商提供扶持政策 ：在产品层 为服务商提供多种微信产品的能力包括支付、小程序、会员、跨境支付、广告等；在政策上投入更多激励措施推出更多以城市为单位的运营活动微信团队将分行业提供针对性的扶持策；联合腾讯大学共建培训体系升级合作伙伴成长计划形成梯度项目包括腾飞计划、服务商讲师认证、境内外成长计划大会、行业小课堂等。由真金白银的砸钱激励进化到全方位提供微信生态内的能力这是腾讯从一个点燃“星星之火”到构建“商业生态”的过程。关键角色“服务商”对于将“连接”作为公司定位的腾讯来说如何在新兴业务中扮演好基础设施的提供方成为其当下提出的生态合作战略中的重要任务。正如腾讯董事会主席兼首席执行官马化腾去年《财富》杂志举办的财富全球论坛中所谈到的那样：“腾讯只有‘半条命’另外半条命靠这个生态里面其他的合作伙伴。”智慧零售正是腾讯依靠另外“半条命”的绝佳体现。由于线下零售行业涉及到的领域众多针对每一个行业进行定制开发是一个相当浪费人力财力的过程因此用开放接口能力的方式赋能“服务商”就成为腾讯连接线下商业的重要手段。服务商在腾讯布局智慧零售的版图中也充当了更加关键的角色这从微信内部的组织架构调整也可略见一斑根据微信支付联合产品部总经理耿志军透露传统意义上接触零售前端的“BD（商务拓展）”角色从2016年开始就从微信内部消失逐渐由产品运营取代。“因为有服务商的存在我们觉得BD 角色的意义就不大了因此原有的 BD 也逐渐向产品运营转化不用去前端跟服务商抢但可以撬动更大的市场。 ” 耿志军说到。按照微信官方对微信支付服务商给出的定义：微信支付服务商是指有技术开发能力的第三方开发者为普通商户提供微信支付技术开发、营销方案即服务商可在微信支付开放的服务商高级接口的基础上为商户完成支付申请、技术开发、机具调试、活动营销等全生态链服务。如此看来如果将微信视为人与人商户与用户的“连接器”那么服务商则更像是一个“转化器”。它可能是一个技术的提供商也可能是一个行业综合解决方案商还有可能是售卖硬件设备服务商或是运营门店营销活动的服务商、提供物料铺设的服务商。通过服务商微信支付可以连接到更多的从个体、企业与商户。为了壮大合作服务商的队伍微信支付没有将服务商的准入设定高门槛任何具备相应资质的机构都可以在微信支付商户平台上在线提交申请资料当微信支付审核通过后便可以完成线上签约开始做落地业务。耿志军甚至表示这是一个“无门槛”的准入“只要注册机构就可以拿到我们所有的资料、所有的解决方案所有的能力都服务于你。生态就是这样各司其职就像一棵大树你长得好坏我不管我能提供的就是给你下雨、给你提供空气。”连接的最终价值：赋能在推广移动支付的过程中“社交红包”充当了微信支付教育大众用户的角色；而在 To B 端的行业普及中标杆案例的推广就显得极其重要。在今年的微信支付合作伙伴大会中来自智慧停车、智慧医疗以及智慧旅游等领域的代表企业集中亮相也即代表了微信支付“赋能”服务商的能力。去年12月腾讯副总裁、微信支付总经理张颖曾在2017《财富》全球论坛上表示微信支付已经覆盖服务商数量超过 3 万家。通过对不同场景的渗透让产业得以改变从智慧停车、智慧医疗到智慧旅游场景——才是让微信支付服务商们建立能力的真正契机。深耕医疗行业服务的海鹚网络就通过微信支付充分连接到了自身垂直服务能力。这家企业专注在为医院提供挂号、就诊、取药、诊后康复等全流程的saas服务。海鹚网络的业务负责人在采访中告诉钛媒体“在技术层面通过微信支付的加持我们在2017年全年实现了包括微信医疗行业首批小程序、微信人脸核身试点、微信商保线上理赔、微信电子发票等多项产品创新。”具体到微信商保理赔这一产品实现了无纸化手机端快捷理赔并可用微信钱包收取保险公司的理赔款项普通看病费用的诊后报销流程由此大为简化惠及大众。除此之外运营层面微信支付提供的基础物料、扫码器、运营活动等帮助降海鹚网络等大量的中小企业降低了运营成本。微信医疗服务（由采访对象“海鹚网络”供图）智慧停车也是微信支付在城市中应用最广泛的场景之一。早在2014年一家来自厦门的技术型企业——科拓股份就在厦门上线了全国首个支持微信支付的自助缴费停车场。科拓股份速停车事业部总经理翁鹏路介绍用户可以通过微信公众号即可查看停车位置、停车时长等信息并微信支付停车费。与传统的取卡停车不同微信停车车辆进场前可由摄像头自动抓拍车辆信息并识别车牌号实现自动开闸进场。进场后用户会收到一条包括停车空位和商场优惠的信息。智慧停车服务（由采访对象“科拓”供图）翁鹏路表示整个智慧停车场的实现用到了微信各方面的产品。比如电子发票、积分抵扣等等与微信的会员卡、票券打通之后用户就能够使用优惠券支付停车费。翁鹏路以一家位于杭州的智慧停车场为例其微信支付的比例达到了83%。与此同时和“无人零售”同步进行的是的停车场的“无人化”在翁鹏路看来停车场是各个行业当中最适合或者最先开始无人化的场景。据其介绍一家位于南京日均四五千车流量的停车场已实现了完全的无人化甚至停车场的岗亭也不再需要。景区的智能点餐体验（由采访对象“道控”供图）高效的支付体验也同样改变了旅游产业。从2017年起游客到访河南洛阳的龙门石窟就已经可以体验到人脸识别技术——游客不再需要在验票处出示纸质票面甚至也不再需要掏出手机扫码验证入园只需看着摄像头“刷脸”即可1秒入园。这一技术由一家叫做“道控”的微信支付服务商提供该公司是景区场景支付体量较大的垂直服务商之一景区“刷脸识别”的实现由腾讯优图实验室提供了人脸识别技术支持。微信支付的新生态梳理微信支付与服务商合作已经三年多从实际落地的案例来看生态共享与技术开放是微信支付的“赋能”主要有两大关键词。所谓的生态共享即微信支付的“赋能”以覆盖10 亿用户的微信为基础不仅让用户能体验最符合日常使用习惯的便捷操作同时更拥有微信整个庞大的生态系统作支撑。从更宏观的角度看腾讯集团背后还蕴含着巨大用户流量以及腾讯的生态系统同样为支付服务商们所共享。而智慧停车、智慧医疗这样属于智慧城市&生活领域的创新体验享受的均是支付技术创新的红利在微信支付内部被称为“技术开放”战略从药店、景区到停车场腾讯正在将门槛很高的人工智能、机器学习等技术“赋能”给服务商再由服务商实现与现实场景的结合。耿志军在接受钛媒体采访时表示“通过微信支付与服务商的合作2018年移动支付走向了行业深耕的阶段。”当移动支付结合微信产品能力结合人脸识别等智能技术整个支付行业实现了闭环很多行业都会由此发生变化。而这些变化正在智慧零售等现实场景之中发生。“它所发生的变化不是说原来收现金现在用微信支付了而是它的商业逻辑都会发生改变这是一个非常令人兴奋的事情。大家可以看到越来越多的场景自然而然地去改变我们的生活。”耿志军说道。从大众消费市场的移动支付推广到线下零售场景的实体连接“服务商”正成为微信支付拓展版图的重要力量；可以预见的是通过对多种业态的赋能 服务商生态会产生规模效应会有越来越多的服务商依靠微信支付这种基础工具的力量崭露头角。在今年年初的微信公开课上智慧零售首次作为主要议题出现在当天的日程而在“微信之父”张小龙当天的演讲中“走进线下”成为微信即将大展拳脚的下一个目标随着小程序、企业微信逐渐成熟一个全新的微信生态将从通讯与社交延伸出更丰富的能力而移动支付仅仅只是开始。（本文首发钛媒体作者/蔡鹏程编辑/苏建勋）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    新世相刷屏营销链接被封违反微信平台规则               十大手机厂商围剿小程序某软件工程师：呵呵                                                        原作者: 蔡鹏程                    来自: 钛媒体                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序实操总结之设计篇                                                      • 前微信海外运营总监刘翌：如何用小程序做10亿用户的生意？                                                      • 小程序开放插件功能                                                      • 315在即微信官方又有大动作代购、专柜、微商被点名                                                      • 9 大手机厂商联手狙击微信小程序！小米、华为联合推出「快应用」 ...                                                      • 央行出手！扫码付款将限额每天最多只能花这个数                                                      • 傲娇的苹果也妥协支付宝小程序可固定在IOS桌面上了                                                      • 对标小程序安卓手机“快应用”联盟是不是伪命题？                                                      • 微信小程序再推iOS虚拟支付整改方案开发者该怎么办？                                                                                               "},{"title": "富文本解析-微信小程序 rich-text 组件 ", "author": "                  Rolan                  2018-8-30 00:23                ", "text": "                                                                                                                                                                                     微信小程序富文本解析器微信小程序在rich-text组件后开始支持富文本解析但需要对照一套自定义规则的 JOSN 数据格式API 返回的富文本需要前端做数据转换。这个主要是用于某些需要 API 直接输出富文本的地方。比如后端输出title字段, 但 title 字段中有加重提示的几个文字是需要标红的。这种情况下后端如果不返回富文本前端去在小程序去处理是比较麻烦的还得定个规则前端再写好样式拼接起来。如果后端直接给你返回富文本用这个去解析可以直接搞定。如官网给的例子：=如何才能将 HTML 转为微信小程序组件支持的数据格式呢？html2json 是一个将 HTML 解析为对应的 json 格式但 html2json 库转换出来的 JSON 与微信小程序要求不一致且不支持解析 style故在此库的基础上做的了扩展与调整。使用方法：import html2json from 'wxapp-rich-text';// 或者下载该仓库import html2json from './your/path/index.js';const html =  '<div id=\"this-id\" class=\"this-class\">sample<br/>text<h2 style=\"color: red;font-size:48rpx;\">sample text</h2></div>';const json = html2json(html);this.setData({    nodes: json,});源码见Github: https://github.com/treadpit/w...目前只测试了一些简单的例子如下图：                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序实现类3D轮播图               微信小程序可实时改变转速的css3旋转动画                                                        原作者: treadpit                   来自: segmentfault                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • xiaochun系列教程--微信小程序 Picker & rich-text                                                                                               "},{"title": "晓程序观察 从“一夜暴富”到“一贫如洗”，小程序20个月「封禁」史！ ... ", "author": "                  Rolan                  2018-9-5 00:01                ", "text": "                                                                                                                                                                                     谁注意到了一个特殊的日子即将到来？9月9日微信小程序正式上线满20个月。20个月说长不长说短不短却涵盖了小程序从诞生之初的备受争议、陷入低谷到价值的逐渐被肯定再到全面发力、受到追捧的过程。在这个过程中用户从认识、接受到喜爱；创业者从看不懂到蜂拥而至；投资人从不看好到纷纷入局这一幅生动的“浮世绘”正反映了小程序生态这一年多的浮浮沉沉。虽然现在小程序终于迎来爆发但在这样一个特殊的时间节点我们却想回望过去盘点一下那些被封禁的小程序以点带面从这个侧面来考量小程序这一年多的发展脉络。首个被封禁的小程序为他人敲响了警钟2017年5月的某个普通的日子一款叫做「匿名聊聊」的小程序悄然刷爆朋友圈。你只需要输入3位数的聊天口令就能跟分享小程序码的朋友瞎扯几句。就算你骂他“SB”他也不知道你是谁。看似无厘头的玩法却在5小时内达到PV1700万成为了首个刷屏的小程序。但这款小程序的寿命也只有这短短的5小时。“很抱歉小程序匿名聊聊由于涉嫌诱导分享已暂停服务”这样一句简单的公告结束了「匿名聊聊」短暂的生命。这个公告的意义不仅仅是在于封禁了一款小程序更重要是表明了微信的态度。早在小程序自诞生之初许多人把小程序当做挖掘微信流量的新工具因此不惜用各种鼓励分享甚至诱导分享的方式来获取流量。但在小程序运营规范里曾明确提到：“微信小程序提供的服务中不得存在诱导类行为包括但不限于诱导分享、诱导关注、诱导下载、诱导抽奖等。”「匿名聊聊」的被封无疑给这些开发者敲了一记警钟微信现身说法用实际行为表明了态度：哪怕流量千万违反了规则也绝不姑息。「匿名聊聊」开了“小程序被封”的先河后微信封禁违规小程序速度一步步加快了。越来越多的封禁越来越正规的小程序从2017年10月开始这个势头越来越明显。当时正值国庆假期过后的第一个工作周大批投票类（腾讯投票、投票箱）、红包类（包你说、包你拼）、直播类（虎牙精选、斗鱼直播）小程序“因内容安全风险暂时无法打开”。直播类示例图一时间惹得不少开发者人心惶惶。大量的违规小程序被封其实也映射出小程序审核机制逐渐完善。但正所谓“道高一尺魔高一丈”依旧有人愿意剑走偏锋铤而走险。年底是各行各业全力以赴为业绩冲刺的时候尤其是那些“淘宝客”们在经历2017年微信有史以来最严厉的打击后有许多淘宝客想通过钻小程序的空子来冲一把业绩。但他们不知道的是在种下违法种子的那一刻就已经被微信盯上了。《小程序运营规范》5.9：不得通过微信小程序实施多级分销欺诈行为发布分销信息诱导用户进行添加、分享或直接参与。一经发现存在此类行为微信有权对其进行限制功能直至封禁处理并有权拒绝再向该主体提供服务。2017年年底大量的淘宝客小程序被微信封禁。无独有偶2018年1月与淘宝客小程序这种分销模式极为相似的「云集全球精品分享」小程序也因“涉嫌违反相关法律法规和政策已暂停服务”。早在三个月前微信就已经禁封了云集的相关公号相信2018年春节前的这个月投了云集2.28亿元的钟鼎创投和云集代言人吴秀波的睡眠质量应该都不会太好。然而要冲业绩的不只是电商一些共享酒店类小程序在年底也要拼“业绩”因此不惜以情色为幌子来招揽生意。2018年1月「同住酒店」拼房小程序因“涉及低俗、性暗示或色情信息”被封。或许这款小程序的出发点很“白月光”：给用户一个节省费用的平台。但无奈不少用户发布需求时大量露骨、x暗示的用词再加上平台监管不力“葬送”了一款小程序的大好前程。同样也因为对UGC内容的监管不力1月中旬大名鼎鼎的“头脑王者”也因为“违反《即时通信工具公众信息服务发展管理暂行规定》”被禁封了近4个月。为了规范用户内容微信为开发者提供了“内容安全接口”专门用来审核用户UGC据说是鉴黄的一把好手。 当小程序逐渐走向正轨时小游戏的横空出世再次掀起微信生态的高潮。封禁席卷小游戏“历史”何其相似2018年4月小游戏正式向第三方开放一个新的阶段拉开了帷幕。但率先登场的一幕却显得有些混乱与狼狈。小游戏开放没多久各种分享卡片就像出笼的野兽一样在各个微信群里狂奔通过微信的社交链迅速生长起来在小游戏首次闭门会议上微信团队透露大多数小游戏通过社交分享的占比在60%-90%。火箭一样上升的用户量足够让开发者们偷着乐很久但那些“被分享”的用户却笑不出来了。两个分享卡片几乎就能占据了微信群的“半壁江山”也难怪不少群主在群聊名称里加上了“禁游戏”的标签甚至有人因为卡片的分享直接在群里骂了起来小游戏这头野兽几乎要把微信群“吞食”了。肆意分享的卡片愤怒的群成员像一场乱剧。这一场乱剧终于在一个月后收场。5月初微信团队在开始下重手惩治在微信群里恶意刷屏的小游戏微信的戒律棒首先砸在了「欢乐球球」的头上。在「欢乐球球」里游戏失败后会提示10S内分享到群就能直接复活继续游戏。这种方式既不让用户分享给个人也不提供“直接跳过”的选项用户要么选择分享到群要么选择等待10秒不给其他选择机会。既然如此微信团队也别无选择。因为涉嫌违规「欢乐球球」成为了第一款因违规被暂停了分享功能的小游戏。有趣的是第一个被封的小程序「匿名聊聊」是因为涉嫌诱导分享第一个被惩罚的小游戏同样是触犯了这条红线。历史既有偶然也有必然这说明了诱导分享自始至终都是微信生态里不可越过的一条红线。但除了诱导分享外小游戏生态还有一条红线那就是对知识产权的侵犯。5月4日微信团队发布《小游戏原创保护机制》表示将从多个方面保护小游戏的原创并且封禁了一批明显涉嫌抄袭的小游戏。其中另一款刷屏小游戏「弹球王者」就因为“涉嫌侵犯他人合法权益”被永久暂停了服务有人调侃：「弹球王者」曾经是个王者直到它被封了。「弹球王者」之所以被封是因为它与一款名为「物理弹球」的小游戏在玩法和界面上几乎一模一样这样赤裸裸的拿来主义自然不被微信所允许。坐拥再多用户触碰法律底线一样被封2018年6月1日一款名为「西瓜足迹」的小程序在朋友圈疯狂刷屏用户可以在小程序里选择去过的地方生成一张图分享到朋友圈。「西瓜足迹」的开发者戴宏民在当天夜里12点发了一条朋友圈：“2018.6.1milestone1000万。”小程序后台显示「西瓜足迹」当天页面浏览量超过1000万相信那一天他是彻夜未眠。但同样彻夜未眠的是另一位小程序开发者赵恩彪因为他发现「西瓜足迹」和他的小程序「脚步地图」几乎一模一样而 「脚步地图」早在1月份就上线了却一直不温不火。“那天晚上我没睡着在床头坐到了天亮看太阳出来。后想一切办法提高脚步地图传播力发现已经干不过西瓜了。”赵恩彪在之后接受《财经天下》采访时如此表示。值得注意的是赵恩彪很早就拿到了软件著作权基本可以断定「西瓜足迹」几乎完全抄袭了「脚步地图」用户在不知情的情况下“帮助李鬼打败了李逵”。因此6月6日「西瓜足迹」因为涉嫌侵犯他人合法权益已被暂停服务。「西瓜足迹」的封禁说明了哪怕是千万流量的刷屏爆款只要在暗地里做违法的勾当违反了基本规则微信就绝不姑息。正如因“涉嫌违反用户数据使用规范”的「抖音好友」小程序在未经腾讯许可的前提下让用户授权登录并提示“分享到群”来寻找微信里的抖音好友涉嫌用户隐私微信不得不过问。小程序每一次封禁其实就是一次成长在成长过程中总会遇到“成长的烦恼”“封禁”二字看似无情而果决其实是成长中必经的阵痛。作为开发者如需不被封禁产品本身和微信规则之间的平衡是值得研究的课题。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序再推iOS虚拟支付整改方案开发者该怎么办？               移动端应用相互跳转的 16 种路径详解                                                        原作者: 晓程序观察                   来自: 晓程序观察                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                "},{"title": "小程序接入微信支付避雷指南 ", "author": "                  Rolan                  2018-1-20 00:02                ", "text": "                                                                                                                                                                                     接入背景笔者在一年前负责一个违章查缴的H5产品那时候开始接触微信支付。时隔一年后我们又做了一款违章查缴的小程序这次还是需要用到微信支付。基本上基于微信生态下的产品想要接通支付功能那么无论如何也避免不了的一个环节就是接入微信支付产品。下文是笔者基于过往开发经验总结的一个接入微信支付的避雷指南！坑一：自动结算1、什么情况这里先解释一下什么是自动结算。当结算周期到了以后微信支付会将微信支付商户号里面的未结算金额自动划走至商户号绑定的银行账户上面并且收取约定的费率。简单来说就是：自动帮你提现了并且还收手续费。会产生什么样的问题呢？当我需要退款给用户的时候发现账户上的前全部被结算的银行卡上了没有钱退款给用户！！那么如何关闭自动结算这个差评功能呢？打开微信支付商户后台点击产品中心看下有没有关闭自动结算的功能。然而并不是所有商家号都拥有这个功能的。没有关闭自动提现功能的产品中心有关闭自动提现功能的产品中心如何拥有关闭自动提现的功能？我找了很久终于发现了其中的奥秘为什么一个商家号里面有这个功能一个没有。关键在：结算周期商家号结算周期信息只要你属于结算周期为T+n的都是没有关闭自动提现功能的。而且在你注册的时候选定了经营类目那么你的结算周期就将无法进行修改！！因为关于结算的修改内容微信只开放了修改结算银行账户。修改账户信息2、怎么避免踩坑先看几个截图：经营类目结算周期为：实时结算到基本户经营类目结算周期为：T+n也就是说你选择的经营类目结算周期为实时结算到基本户才有关闭自动结算的功能而结算周期为T+n的是没有这个功能的。坑二：无法更换小程序绑定的微信支付商户号1、什么情况小程序后台里面关于微信支付的绑定方式有两种：1、利用现有小程序作为申请入口申请一个新的微信支付；2、绑定已有的微信支付商户号。无论选择哪种方式都是一绑定终生！也就是没有入口进行更换绑定的商户号小程序后台-微信支付页面2、如何避免踩坑（1）一定要慎重、慎重、慎重！想清楚是新注册还是绑定旧账户。推荐不同的业务最好分开结算这样便于财务进行对账。（2）如果条件允许一定要绑定能关闭自动结算的微信支付商户号能省去许多麻烦。坑三：关于退款来源1、什么情况微信支付API文档截图微信支付api文档里面退款申请接口列表有一个叫退款申请的api。我们可以利用调取这个接口从而在自己的后台开发出退款功能而不用每对一个用户发起退款都要登录微信支付的后台进行操作。而退款资金来源字段有两种资金来源：一种是未结算资金退款一种是可用余额退款。未结算资金：当你的账号是t+n的时候只要结算周期没到入账的所有资金都会算作未结算资金。可用余额退款：可用余额一般是指你通过“充值”进入商户号里面的钱。在开发的过程中我们曾经遇到一个场景：明明今天有订单金额进账但是怎么也不能对用户进行退款。原来我们是设置了退款资金来源为可用余额退款。从而系统退款的时候自动绕过了未结算资金退款。2、如何避免踩坑设计业务退款流程的时候应该做一个逻辑判断：先判断未结算资金是否满足退款金额如果可以则用未结算金额退款。不满足则再用可用余额退款如果不满足则退款失败。退款功能流程设计为什么要这么设计？可以先利用未结算资金退款的话就能少收取一些结算时候的手续费减少金额损耗。第二可用余额是充值进去用一点少一点微信支付的充值流程异常复杂少用可用余额可以减少不必要的公司内部财务流程。小结微信支付作为小程序生态帮助商家实现商业化的一个必不可少的环节优化用户体验还是十分必要的希望能尽快迭代改进。 作者：罗舜偉ଲ一个年轻的产品经理。立足微信生态圈熟悉公众号平台、开放平台探索小程序相关业务领域ing…..目前正在和小伙伴为将千万级用户小程序蜕变成亿级用户小程序而努力！本文由 @罗舜偉ଲ 原创发布于人人都是产品经理。未经许可禁止转载题图来源于网络                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    对于电商领域小程序意味着什么？               开发者说：跳一跳小程序的回忆杀与野心故事                                                        原作者: 罗舜偉ଲ                   来自: 人人都是产品经理                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序电商乏善可陈恐被微信战略边缘化                                                      • 7年时间、64次迭代、10亿月活微信凭什么？                                                      • 关于打击“假货、高仿”类小程序的公告                                                      • 对于电商领域小程序意味着什么？                                                      • 手机秒变公交卡小程序HCE能力全面开放                                                      • 微信支付接入银联支付市场又增变局？                                                      • 微信小程序再推iOS虚拟支付整改方案开发者该怎么办？                                                                                               "},{"title": "微信小程序 + mock.js 实现后台模拟及调试 ", "author": "                  Rolan                  2017-9-26 00:29                ", "text": "                                                                                                                                                                                     一、创建小程序项目mock.js 从 https://github.com/nuysoft/Mock/blob/refactoring/dist/mock.js 下载api.js：配置模拟数据和后台接口数据通过 DEBUG = true;//切换数据入口let API_HOST = \"http://xxx.com/xxx\";let DEBUG = true;//切换数据入口var Mock = require('mock.js')function ajax(data = '', fn, method = \"get\", header = {}) {    if (!DEBUG) {        wx.request({            url: config.API_HOST + data,            method: method ? method : 'get',            data: {},            header: header ? header : { \"Content-Type\": \"application/json\" },            success: function (res) {                fn(res);            }        });    } else {        // 模拟数据        var res = Mock.mock({            'error_code': '',            'error_msg': '',            'data|10': [{                'id|+1': 1,                'img': \"@image('200x100', '#4A7BF7','#fff','pic')\",                'title': '@ctitle(3,8)',                'city': \"@county(true)\",                'stock_num': '@integer(0,100)',//库存数量                  'marketing_start': '@datetime()',                'marketing_stop': '@now()',                'price': '@integer(100,2000)',//现价单位：分                  'original_price': '@integer(100,3000)'            }]          })        // 输出结果       // console.log(JSON.stringify(res, null, 2))        fn(res);    }}module.exports = {    ajax: ajax}index.js页面//index.js//获取应用实例var app = getApp()var API = require('../../utils/api.js')Page({    data: {    },    onLoad: function () {        console.log('onLoad')        var that = this        // 使用 Mock        API.ajax('', function (res) {            //这里既可以获取模拟的res            console.log(res)            that.setData({                list:res.data            })        });        console.log(this.data.list)    }})index.wxml<!--index.wxml--><block wx:for=\"{{list}}\" wx:key=\"name\">  <view>{{item.title}}</view>  <text>{{item.city}}</text>  <view>    <text>{{item.marketing_start}}</text>  </view>  <image src='{{item.img}}'></image></block>页面显示                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    关于小程序swiper的问题               微信小程序--location API                                                        原作者: 吾生有涯 而知无涯                   来自: csdn                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序使用mock.js提供模拟数据提示输入对话框prompt                                                      • 用 RxJS、RxWX 编写更优秀的微信小程序代码                                                      • 微信小程序开发——本地调试                                                                                               "},{"title": "微信小程序开发学习--外部设备的使用 ", "author": "                  Rolan                  2017-12-26 00:37                ", "text": "                                                                                                                                                                                     微信小程序开发中我们会用到蓝牙相机、录音等设备。使用这些设备的时候我们可以先获得用户的授权再进行操作1、相机的使用相机的使用主要有拍照和拍摄视频这两个都是在用户上传图片的时候我们在soureType中加上camera属性就能够选择拍摄并上传我们在上传后能够获得这些视频和图片的临时路径在页面中加入用于展示他们的<video>或者<image>标签就可以展示所上传的视频或者图片但是这个临时路径并不能保存需要上传到自己的服务器才能够保存。（注：在使用video标签的时候）bindButtonTap: function () {    var that = this    wx.chooseVideo({      sourceType: ['album', 'camera'],      maxDuration: 60,      camera: ['front', 'back'],      success: function (res) {        console.log(res);        that.setData({          src: res.tempFilePath   //tempfilepath为文件上传的临时路径        })      }    });  },2、蓝牙、网络状态、拨打电话等设备都可以直接使用微信提供的接口进行访问打开比较特别的是微信中还有截屏触发事件（wx.onUserCaptureScreen）、剪贴板的set和get事件（wx.setClipboardData）、使手机发生震动的事件（wx.vibrateLong）                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序canvas绘制坐标图               微信小程序开发——本地调试                                                        原作者: JiSight                   来自: cnblogs                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序把玩《十三》：获取设备信息 APInavigation APIanimation API ...                                                      • 面对新手《十一》获取设备信息template模板引用                                                                                               "},{"title": "微信小程序开发问答《五十八》动态决定程序的启动页 & 背景图设置手机上无法预览 ...  ... ", "author": "                  Rolan                  2017-7-31 00:01                ", "text": "                                                                                                                                                                                     1、微信小程序 如何动态决定程序的启动页问：文档中说是配置中pages数组的第一个成员为启动页。但我现在的需要求是在应用刚启动时就要判断用户是否为登录状态。如果是则进入首页否则进入登录页。答：1、可以写一个启动页在这个启动页里面判断当前状态如果是登录状态就自己跳转到首页否则你就跳转到登录页。2、你在app.js中的onLaunch中判断就可以了根据不同的条件进行跳转不同的页面。2、项目内文件夹删除不掉想要删publishTask文件夹在IDE里删没反应去文件资源管理器删提示需要管理员权限原来因为要删的文件夹里有嵌套一层文件夹所以禁止删除。要先删掉里层文件夹才可以删除外层。换句话说想要删除的文件夹要保证不包含文件夹。3、微信小程序中input控件自动聚焦、软键盘的关闭和打开cursor-spacing:  类型：Number指定光标与键盘的距离单位 px 。取 input 距离底部的距离和 cursor-spacing 指定的距离的最小值作为光标与键盘的距离auto-focus:true类型：Boolean自动聚焦拉起键盘。如果你设置为true,那边你打开页面就会弹出键盘这时可能会遮挡一些控件。此功能即将废弃尽量使用focusfocus:类型：boolean获取焦点confirm-type类型：boolean设置键盘右下角按钮的文字这个很有意思可以根据需求填写confirm-hold类型：boolean点击键盘右下角按钮时是否保持键盘不收起4、微信小程序 调用时方法未被定义可能是调用方法时 未使用this正确写法：[javascript] view plain copy// 初始化    this.init(options.id)  5、小程序背景图设置以及手机上无法预览的解决方法背景图设置可以设置整个页面或者某个view 的背景图在XXX.wxml中设置：[javascript] view plain copy print?\"font-size:14px;\">class=\"container\" \"color:#ff0000;\">style=\"background-image:url('../images/xxx.png')\">  注： 如果你用的是本地图片那很有可能在小程序的开发工具中能显示但是在手机预览中无法显示。换成网上图片地址即可。                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    [微信小程序]上传图片到阿里云OSS               黄秀杰小程序入门佳品——增删改查+页面跳转+传值取值+布局样式 ... ... ...                                                                                                                                                                /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发问答《五十二》为何不能在网页调用微信jsapi & 安卓手机wx.hideLoading ...                                                      • 微信小程序开发问答《五十三》手机号码处理为344格式 & bindtap方法传参 ... ...                                                      • 微信小程序开发问答《五十四》同步请求授权 &  用户拒绝授权,重新调起授权 ... ...                                                      • 微信小程序开发问答《五十五》单选框选中之后为什么取消不了 & 请求php后台返回json数 ...                                                      • 微信小程序开发问答《五十六》时间戳获取js & 竖向滚动页面出现遮挡问题 ...                                                      • 微信小程序开发问答《五十七》小程序实时生成可分享卡片的方案 & 主动发起分享 ...                                                      • 微信小程序开发问答《五十九》后台换取openid & 数据过滤                                                      • 微信小程序开发问答《六十》错误状态码(例如：401)的获取& 日期选择器的起始时间极限 ...                                                      • 微信小程序开发问答《六十一》 轮播图修改小点点 & 使用字体图标 ...                                                      • 微信小程序开发问答《六十二》 下拉出来的白底调色 & wx.navigateBack 传值到上一个界 ...                                                      • 微信小程序开发问答《六十四》赋值undefined & wx for中对满足条件的项添加class ...  ...                                                      • 如何给小程序页面加载一张背景图片                                                      • 喂快给我打一个小程序预览码                                                                                               "},{"title": "微信小程序 Node.js (基础十一) 全局对象 & (基础十二) GET/POST请求 ... ", "author": "                  Rolan                  2017-7-7 00:56                ", "text": "                                                                                                                                                                                     微信小程序 Node.js (基础十一) 全局对象在浏览器 JavaScript 中通常 window 是全局对象。Node.js 中的全局对象是 global所有全局变量（除了 global 本身以外）都是 global 对象的属性。global 最根本的作用是作为全局变量的宿主。注意： 永远使用 var 定义变量以避免引入全局变量因为全局变量会污染 命名空间提高代码的耦合风险。__filename 脚本绝对路径表示当前正在执行的脚本的文件名。它将输出文件所在位置的绝对路径且和命令行参数所指定的文件名不一定相同。 如果在模块中返回的值是模块文件的路径。console.log(__filename);//  C:\\Users\\admin\\main.js1212__dirname 脚本所在的目录表示当前执行脚本所在的目录。console.log(__dirname);//  C:\\Users\\admin1212setTimeout(cb, ms) 执行一次函数cb全局函数在指定的毫秒(ms)数后执行指定函数(cb)。 setTimeout() 只执行一次指定函数。 返回一个代表定时器的句柄值。function printHello(){   console.log( \"Hello, World!\");}// 两秒后执行以上函数setTimeout(printHello, 2000);1234512345clearTimeout(t) 停止函数tclearTimeout( t ) 全局函数用于停止一个之前通过 setTimeout() 创建的定时器。 参数 t 是通过 setTimeout() 函数创建的定时器。function printHello(){   console.log( \"Hello, World!\");}// 两秒后执行以上函数var t = setTimeout(printHello, 2000);clearTimeout(t)123456123456setInterval(cb, ms) 不停地调用函数cbsetInterval(cb, ms) 全局函数在指定的毫秒(ms)数后执行指定函数(cb)。返回一个代表定时器的句柄值。可以使用 clearInterval(t) 函数来清除定时器。setInterval() 方法会不停地调用函数直到 clearInterval() 被调用或窗口被关闭。function printHello(){   console.log( \"Hello, World!\");}// 两秒后执行以上函数setInterval(printHello, 2000);1234512345process 一个与操作系统的简单接口process 是一个全局变量即 global 对象的属性。 它用于描述当前Node.js 进程状态的对象提供了一个与操作系统的简单接口。通常在你写本地命令行程序的时候少不了要和它打交道。微信小程序 Node.js (基础十二) GET/POST请求var http = require(\"http\")var url = require(\"url\")var util = require(\"util\")var querystring = require(\"querystring\")function start(){    //    获取GET请求内容    this.getRequest = function(){        http.createServer(function(request,response){            var pathname = url.parse(request.url).pathname            console.log(pathname)            response.writeHead(200,{\"Content-Type\":\"text/plain\"})            response.write(\"Hello World\")            // http://127.0.0.1:8888/user?name=12456            // util.inspect(object) 将任意对象转换 为字符串            // url.parse 将一个URL字符串转换成对象并返回            response.end(util.inspect(url.parse(request.url,true)));            response.end(url.parse(request.url,true).query.name);        }).listen(8888)    }    //    获取POST请求内容    this.postRequst = function (){        http.createServer(function (req, res) {          var body = \"\";          req.on('data', function (chunk) {            body += chunk;          });          req.on('end', function () {            // 设置响应头部信息及编码            res.writeHead(200, {'Content-Type': 'text/html; charset=utf8'});            //  {\"name\":\"123\",\"address\":\"123123\"}            console.log(body)            //  querystring.parse 将一个字符串反序列化为一个对象            //  { '{\"name\":\"123\",\"address\":\"123123\"}': '' }            console.log(querystring.parse(body))            //  JSON.parse(string)  将字符串转为JS对象。            //  JSON.stringify(obj) 将JS对象转为字符串。            //  { name: '123', address: '123123' }            console.log(JSON.parse(body))            body = JSON.parse(body)                res.write(\"网站名：\" + body.name);                res.write(\"\");                res.write(\"网站 URL：\" + body.address);            res.end();          });        }).listen(3000);    }}module.exports = start1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545512345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455var Util = require(\"./util\")var util = new Util ();util.postRequst();123123                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发实践点滴——接入Bmob后端云及Bmob常用API的使用 ...               Bmob基本REST API的python封装                                                        原作者: xiaochun365                   来自: csdn博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序 Node.js (基础一) NPM(包管理工具)                                                      • 微信小程序 Node.js (基础二) REPL 交互式解释器 & (基础三) 回调函数 ...                                                      • 微信小程序 Node.js (基础四) 事件循环& (基础五) EventEmitter                                                      • 微信小程序 Node.js (基础六) Buffer(缓冲区)                                                      • 微信小程序 Node.js (基础七) Stream流 & (基础八) exports模块系统 ...                                                      • xiaochun系列教程--微信小程序 WeUi.wxss                                                      • 微信小程序 post 发送数据 终极大法                                                      • 微信小程序全局状态管理并提供Vuex的开发体验                                                                                               "},{"title": "微信小程序--外部API调用方法遇到的一个小问题 ", "author": "                  Rolan                  2017-7-28 00:37                ", "text": "                                                                                                                                                                                     最近对微信小程序比较感兴趣想写一个查询车辆违章记录的小程序。在调用外部接口时需要appcode 这种authoriztion。发现微信小程序的 ajax请求使用这种方式不起作用。改为直接在header中赋值生效了不知道什么原因希望遇到同样问题的伙伴可以不用弯路。beforeSend: function (xhr){         console.log('授权码');         xhr.setRequestHeader(\"Authorization\", \"APPCODE \"+\"XXXXXXXXXXXXXXXXXXX\");       },  解决方法header: {         'content-type': 'application/json',         'Authorization': \"APPCODE \" + \"<span style=\"font-family: Arial, Helvetica, sans-serif;\">XXXXXXXXXXXXXXXXXXX</span>\"       },  详细代码如下[javascript] view plain copyconfirm: function () {      console.log(\"clicked confirm\");      this.setData({        hidden: true      });      var timestamp = new Date().getTime();      var apiUrl = \"http://ddycapi.market.alicloudapi.com/violation/query\";   //注释掉的代码为废弃车首页和路帮网的免费接口使用阿里云的api收费服务   //var appId = \"129\";   //var appKey = \"4263c4f0-4f56-0135-3375-0242c0a80006\";   //var carInfo = \"{plate_num=\" + this.data.plateNo + \"&body_num=\" + this.data.frameNo + \"&engine_num=\" + this.data.engineNo + \"&city_id=190&car_type=02}\";  // var signStr = appId + carInfo + timestamp + appKey;  // var sign = util.md5(signStr);   //console.log(\"carInfo:\" + carInfo);   //console.log(\"signStr:\" + signStr);   //console.log(\"sign:\" + sign);   //var url = apiUrl + \"car_info=\" + carInfo + \"&api_id=\" + appId + \"&sign=\" + sign + \"×tamp=\" + timestamp;  // console.log(\"url:\" + url);    var that = this;    wx.request({      url: apiUrl,      method:'post',      data: { \"plateNumber\": \"陕AD3738\", \"engineNo\": \"695176712\", \"vin\": \"662722\", \"carType\": \"02\" },      header: {        'content-type': 'application/json',        'Authorization': \"APPCODE \" + \"<span style=\"font-family: Arial, Helvetica, sans-serif;\">XXXXXXXXXXXXXXXXXXX</span>\"      },      beforeSend: function (xhr){        console.log('授权码');        xhr.setRequestHeader(\"Authorization\", \"APPCODE \"+\"XXXXXXXXXXXXXXXXXXX\");      },      success: function (res) {        if (res.statusCode != 200) {          console.log('接口调用异常');          that.setData({            resultModalHidden: false,            resultMsg: '接口调用异常'          });        }        var obj = res.data;        var status = Number(obj.status);        that.setData({          resultModalHidden: false        });        switch (status) {          case 1002:            console.log('app_id有误');            break;          case 1003:            console.log(' sign加密有误');            break;          case 1004:            console.log('车牌号汽车类型违章城市 等字段不能为空');            break;          case 1005:            that.setData({              resultMsg: '输入的车辆信息有误请查证后重新输入'            });            console.log('车辆信息有误');            break;          case 2000:            that.setData({              resultMsg: '恭喜当前城市交管局暂无您的违章记录'            });            console.log('正常(无违章记录)');            break;          case 2001:            console.log('正常（有违章记录）');            break;          case 5000:            console.log('请求超时请稍后重试');            break;          case 5001:            console.log('交管局系统连线忙碌中请稍后再试');            break;          case 5002:            console.log('恭喜当前城市交管局暂无您的违章记录');            break;          case 5003:            console.log('数据异常请重新查询');            break;          case 5004:            console.log('系统错误请稍后重试');            break;          case 5005:            console.log(' 车辆查询数量超过限制');            break;          case 5006:            console.log('你访问的速度过快, 请后再试');            break;          case 5008:            that.setData({              resultMsg: '输入的车辆信息有误请查证后重新输入'            });            console.log('输入的车辆信息有误请查证后重新输入');            break;          default:            console.log('未知错误');        }        console.log(res)      }    })  },                                               .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (1 人)zhangfq603124                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序--消息推送配置Token令牌错误校验失败如何解决               微信小程序开发之保持用户的session                                                        原作者: 霸气虚幻哥-隔壁老王                   来自: csdn博客                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 用python抓取摩拜单车API数据并做可视化分析(源码)                                                      • 微信小程序开发手记《六》：API                                                      • 关于微信小程序API认证                                                      • 微信小程序位置API                                                      • 利用WordPress REST API 开发微信小程序从入门到放弃                                                      • Bmob基本REST API的python封装                                                      • 以微信小程序为例学习网站开发平台API调用                                                      • 微信小程序通过api接口将json数据展现到小程序上                                                                                               "},{"title": "微信小程序之网络请求简单封装 ", "author": "                  Rolan                  2017-6-28 00:40                ", "text": "                                                                                                                                                                                     在微信小程序中实现网络请求相对于Android来说感觉简单很多我们只需要使用其提供的API就可以解决网络请求问题。普通HTTPS请求(wx.request)上传文件(wx.uploadFile)下载文件(wx.downloadFile)WebSocket通信(wx.connectSocket)为了数据安全微信小程序网络请求只支持https当然各个参数的含义就不在细说不熟悉的话可以；可以去阅读官方文档的网络请求api当我们使用request时header的content-typ默认是application/json在文档中指出method 的value必须是大写不过经过测试小写也能请求成功。request默认的超时时间是60s如果我们想自定义超时时间我们可以在app.json中加入下面代码片段分别设置requestsocket和上传文件及下载文件的超时时间。  \"networkTimeout\": {    \"request\": 5000,    \"connectSocket\": 5000,    \"uploadFile\": 5000,    \"downloadFile\": 5000  }设置过超时时间我们就开始封装网络请求平时我们所接触的网络请求一般会分为两类一类是在后台运行的没有加载对话框提示另一种就是有提示如提示正在加载数据那么我们就以此为线索来进行封装。先创建一个network的网络请求工具类然后// 展示进度条的网络请求// url:网络请求的url// params:请求参数// message:进度条的提示信息// success:成功的回调函数// fail：失败的回调function requestLoading(url, params, message, success, fail) {  console.log(params)    wx.showLoading({      title: message,    })  wx.request({    url: url,    data: params,    header: {      'content-type': 'application/x-www-form-urlencoded'    },    method: 'post',    success: function (res) {      //console.log(res.data)        wx.hideLoading()      if (res.statusCode == 200) {        success(res.data)      } else {        fail()      }    },    fail: function (res) {        wx.hideLoading()        fail()    },    complete: function (res) {    },  })}上面函数很好理解参数的含义已在代码中解释在网络请求开始前先展示Loading对话框提示用户当前网络正在请求数据当网络请求成功或者失败后调用wx.hideLoading()取消提示框的展示。在api中还提供了wx.showNavigationBarLoading()用于显示当前页面的导航条加载动画那么如果我们想展示这个动画可以在requestLoading执行开始调用wx.showNavigationBarLoading()然后在网络请求成功或者失败后调用wx.hideNavigationBarLoading()隐藏导航栏加载动画。当网络请求成功并且状态码为200时将请求到的数据回调通过success(res.data)回调给我们的方法在上面我们没有对失败原因进行细分当然你也可以给失败回调加个参数用于提示用户失败的原因如res.statusCode ==500时提示服务器内部错误res.statusCode ==-1时提示请检查网络res.statusCode ==404找不到地址等等。然后我们在创建一个不显示对话框用户后台请求数据的请求函数为了少写代码我们共用上面的函数如下//不显示对话框的请求function request(url, params, success, fail) {  this.requestLoading(url, params, \"\", success, fail)}我们看到我们最终还是调用的requestLoading那么我们可以在该函数作下判断如果提示信息message==''就不显示对话框。最终的代码function request(url, params, success, fail) {  this.requestLoading(url, params, \"\", success, fail)}// 展示进度条的网络请求// url:网络请求的url// params:请求参数// message:进度条的提示信息// success:成功的回调函数// fail：失败的回调function requestLoading(url, params, message, success, fail) {  console.log(params)  wx.showNavigationBarLoading()  if (message != \"\") {    wx.showLoading({      title: message,    })  }  wx.request({    url: url,    data: params,    header: {      //'Content-Type': 'application/json'      'content-type': 'application/x-www-form-urlencoded'    },    method: 'post',    success: function (res) {      //console.log(res.data)      wx.hideNavigationBarLoading()      if (message != \"\") {        wx.hideLoading()      }      if (res.statusCode == 200) {        success(res.data)      } else {        fail()      }    },    fail: function (res) {      wx.hideNavigationBarLoading()      if (message != \"\") {        wx.hideLoading()      }      fail()    },    complete: function (res) {    },  })}module.exports = {  request: request,  requestLoading: requestLoading}使用就很简单了如下//路径根据自己项目路径修改var network = require(\"/utils/network.js\")getData:function(){    network.requestLoading(URL.MY_SCORE, that.data.params, '正在加载数据', function (res) {    //res就是我们请求接口返回的数据      console.log(res)    }, function () {      wx.showToast({        title: '加载数据失败',      })    })}                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发体验               微信小程序设置底部导航栏目方法                                                        原作者: Code4Android                   来自: 掘金                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 小程序request接口的封装实现给循环列表添加点击样式                                                      • 微信小程序 wx.request 方法的异步封装。                                                      • 小程序简单封装http访问网络库                                                      • 微信小程序 es6-promise.js封装请求处理异步进程                                                      • Bmob基本REST API的python封装                                                      • 前端开发--微信小程序中页面代码中的模板封装                                                      • 微信小程序 wepy wx.previewImage 封装                                                      • 微信小程序的网络设置及网络请求：wx.request(OBJECT)                                                      • 在小程序、mpvue中使用flyio发起网络请求                                                                                               "},{"title": "微信小程序网络请求封装 ", "author": "                  yuzeng84                  2017-5-29 00:09                ", "text": "                                                                                                                                                                                                                                                                 请求报文示例 请求报文示例// request.js  https://XXXXXXXX/XXX/yy/yyyvar API_URL = 'https://XXXXXXXX/XXX/'function request(method, requestHandler) {    var api_key = 'XXX'   //用于加密的key    var APPEND_URL = requestHandler.url    var tradeId = requestHandler.tradeId    // 获取当前时间戳    var timestamp = getDate(new Date)    var param = {        \"head\": {            \"timestamp\": timestamp,            \"tradeId\": tradeId,            \"validCode\": \"\",            // \"userId\" : wx.getStorageSync('userId'),            // \"token\" : wx.getStorageSync('token')        },        \"body\": {        }    }    //封装head节dian    var head_dic = param.head     var plainStr     if( wx.getStorageSync('userId') != null ||  wx.getStorageSync('token')!= null) {        head_dic.userId = wx.getStorageSync('userId')        head_dic.token = wx.getStorageSync('token')       plainStr = head_dic.tradeId + head_dic.timestamp +head_dic.userId+head_dic.token+api_key    } else {    plainStr = head_dic.tradeId + head_dic.timestamp +api_key    }    var validCode1 = utilMd5.hexMD5(plainStr)  // md5加密    var validCode = validCode1.toUpperCase()    head_dic.validCode = validCode    param.head = head_dic    param.body =  requestHandler.params    wx.request({        url: API_URL + APPEND_URL+'.json',        data: { param: JSON.stringify(param) },   //json转son字符串        method: method, // OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, CONNECT        header: {            'content-Type': 'application/x-www-form-urlencoded'        }, // 设置请求的 header        success: function (res) {            //注意：可以对参数解密等处理            requestHandler.success(res)        },        fail: function () {            requestHandler.fail()        },        complete: function () {            // complete        }    })}var requestHandler = {    url: '',    tradeId:'',    params: {},    success: function (res) {        // success    },    fail: function () {        // fail    },}// GETfunction GET(requestHandler) {    request('GET', requestHandler)}// POSTfunction POST(requestHandler) {    request('POST', requestHandler)}module.exports = {    GET: GET,    POST: POST,    showToast: showToast}调用createShopRequest: function () {    var that = this    var params = new Object()    params.shopName = ''    requestServer.POST(      {        url: 'yy/yyy',        tradeId: 'yyy',        params: params,        success: function (res) {          console.log(res.data)        },        fail: function () {        },      })  },                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序搜索组件wxSearch               小程序地图map                                                        原作者: 大慧慧                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序开发：request请求后台获取不到data解决方法                                                      • 微信小程序带参数二维码让我重新认识Post网络请求                                                      • 微信小程序入门《二》request请求                                                      • 小程序网络请求wx.request                                                      • 使用 wx-queue-request 控制 wx.request 请求数                                                      • 微信小程序 es6-promise.js封装请求处理异步进程                                                      • 微信小程序网络请求应用---发送参数返回服务器内容                                                      • Bmob基本REST API的python封装                                                      • 前端开发--微信小程序中页面代码中的模板封装                                                      • 微信小程序 wepy wx.previewImage 封装                                                      • 微信小程序的网络设置及网络请求：wx.request(OBJECT)                                                                                               "},{"title": "微信小程序request的Promise封装 ", "author": "                  Rolan                  2017-11-20 00:31                ", "text": "                                                                                                                                                                                      在我们开发过程中经常需要附带一个token所以这里把token单独抽取出来。​ 可能我们的接口都是以某一个特定的前缀开始的比如 /api, 所以我们可以提取一个baseUrl这样后面的请求中就可以不用每次都加上前缀了而且后期修改也简单只需要改一下配置文件就可以。​ 对于后台放回的数据我们一般会用code来标记是否操作成功。这里可以做一个统一的错误处理所以这里添加了一个拦截器数组可以配置多个拦截器。​ 然后就是对方法的封装首先写一个request方法来封装wx.request方法。然后再分别封装get、post、put、delete方法使用的时候直接调用这几个方法就可以。​ 对于header、token、interceptor、baseUrl的配置方法我们可以直接返回this实现链式调用。​ 具体的在使用的时候可以现在App.js的onLaunch方法中配置req。import req from '../../utils/Request.js'configReq(){    //配置baseUrl和拦截器baseUrl例如 /api    req.baseUrl(config.serverUrl)      .interceptor(res=>{        switch(res.data.code){          case 401:             wx.showToast({              icon: 'loading',              title: '重新登录',            })            this.login()            return false;          case 0:            return true;          default:            wx.showToast({              title: '操作失败',            })            return false;        }      })  },​ 在登录后设置tokenreq.token(token)​ 具体的网络请求方法如下：req.post('/goods',data,header)    .then(res=>res.data.data)    .then(data=>{        wx.showToast({            title:'创建成功'        })    })​ 代码：const METHOD={  GET:'GET',  POST:'POST',  PUT:'PUT',  DELETE:'DELETE'}class Request{  _header={    token:null  }  _baseUrl=null  interceptors = []  constructor(){    const token=wx.getStorageSync('token')    if(token){      this._header.token=token    }  }  intercept(res){    return this.interceptors                  .filter(f=> typeof f === 'function')                  .every(f=> f(res))  }  request({url,method,header={},data}){    return new Promise((resolve,reject)=>{      wx.request({        url: (this._baseUrl || '')+url,        method: method || METHOD.GET,        data: data,        header: {          ...this._header,          ...header        },        success: res=>this.intercept(res) && resolve(res),        fail:reject      })    })  }  get(url,data,header){    return this.request({url,method:METHOD.GET,header,data})  }  post(url,data,header){    return this.request({url,method:METHOD.POST,header,data})  }  put(url,data,header){    return this.request({url,method:METHOD.PUT,header,data})  }  delete(url,data,header){    return this.request({url,method:METHOD.DELETE,header,data})  }  token(token){    this._header.token=token    return this  }  header(header){    this._header=header    return this  }  baseUrl(baseUrl){    this._baseUrl=baseUrl    return this  }  interceptor(f){    if(typeof f === 'function'){      this.interceptors.push                                            .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    小程序支付常见问题解答               微信小程序之cover-view                                                        原作者: evolify                    来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • Bmob基本REST API的python封装                                                      • g微信小程序实践（一）用Promise 封装API                                                      • 微信小程序封装http访问网络库实例代码                                                      • 前端开发--微信小程序中页面代码中的模板封装                                                      • 微信小程序 wepy wx.previewImage 封装                                                      • 微信小程序Http高级封装 es6 promise                                                      • 微信小程序之多文件下载的简单封装                                                      • 微信小程序封装get、post请求                                                      • 小程序 Promise 连续请求服务器写法,减少代码量                                                                                               "},{"title": "推荐！微信小程序开发心得：首页制作，animation使用，动画详解 ... ... ... ", "author": "                  天下雪                  2017-1-6 00:55                ", "text": "                                                                                                                                                                                     作者：谷歌’s来自原文地址：http://www.cnblogs.com/laogu2/p/6248925.html微信小程序也已出来有一段时间了最近写了几款微信小程序项目今天来说说感受。首先开发一款微信小程序最主要的就是针对于公司来运营的因为在申请appid(微信小程序ID号)时候需要填写相关的公司认证信息如营业执照等再次就是用一个未曾开通过公众号的QQ号或微信号来注册一个微信小程序号。最后下载微信小程序开发工具。由于这里我们更多的关注如何去开发一些app,而不是科谱微信小程序故在此不在过多的解释详细的说明可以去官网帮助文档。首先我们拿自己的项目在一步一步的说明并开发吧下面是一个微信app的截图 在看到上图小伙伴们大致有一个了解这个是调试工具中的一些效果没有在真机上好看。由于在开发中本以为画面不是很流利实际上完全出乎我的意料动画效果很流畅可以与ios,andriod app相媲美以后有时间讲讲开发其它app的相关例子。在介绍这个文章前假设用户都已看过微信小程序的相关文档。这个项目基本上是按照微信原有的文件结构来的并没有额外的去添加特别多的文件结构因为微信小程序规定项目文件大小不能超过1M要求我们尽可能的压缩小程序代码或其它图片文件等下面是微信app文件结构整体截图  1.app.js 主要是全局公共的js方法声明及调用所在的文件2.app.json 是小程序整个的配置文件所以有的页面都在要此注册不然不允许访问（如下图所示）3.app.wxss 是小程序全局的css文件公共css写在此最好不过的了4.pages下是对应着所有页面每个页面可以添加四种类型的文件.json.wxss.wxml.js （如下图所示）5.utils 是我们公共的js存放的地方因为微信小程序要求每个js文件里的方法不可以直接引用或调用必须要用 module.exports方法导出这样pages 下的.js文件才可以调用到我们在此写的js方法。这点特别要注意 1)app.json页面配置及注册： 2)pages页面结构: 下面我们开始详细的讲解每个页面一、首页首页分为四个文件组成如下图所示具体的页面功能上面已说过。     下面来看下index.wxml效果  最上面的“来运吧”标题在index.json文件下定义的每个文件都可以用不同的.json来定义当然代码也可以动态改变它很简单吧标题就这么简单的出现了。1）接下来看看横向滚动的banner, index.wxml这样来描述那么swiper是什么东东呢？微信小程序帮助文档这样说明的 swiper滑块视图容器 属性名类型默认值说明indicator-dotsBooleanfalse是否显示面板指示点autoplayBooleanfalse是否自动切换currentNumber0当前所在页面的 indexintervalNumber5000自动切换时间间隔durationNumber500滑动动画时长circularBooleanfalse是否采用衔接滑动bindchangeEventHandle current 改变时会触发 change 事件event.detail = {current: current}注意：其中只可放置组件其他节点会被自动删除。swiper-item仅可放置在组件中宽高自动设置为100%。 <swiper indicator-dots=\"{{indicatorDots}}\"   autoplay=\"{{autoplay}}\" interval=\"{{interval}}\" duration=\"{{duration}}\">   <block wx:for=\"{{imgUrls}}\">     <swiper-item>       <image src=\"{{item}}\" class=\"slide-image\" width=\"355\" height=\"150\"/>     </swiper-item>   </block> </swiper> <button bindtap=\"changeIndicatorDots\"> indicator-dots </button> <button bindtap=\"changeAutoplay\"> autoplay </button> <slider bindchange=\"intervalChange\" show-value min=\"500\" max=\"2000\"/> interval <slider bindchange=\"durationChange\" show-value min=\"1000\" max=\"10000\"/> duration Page({   data: {     imgUrls: [       'http://img02.tooopen.com/images/20150928/tooopen_sy_143912755726.jpg',       'http://img06.tooopen.com/images/20160818/tooopen_sy_175866434296.jpg',       'http://img06.tooopen.com/images/20160818/tooopen_sy_175833047715.jpg'     ],     indicatorDots: false,     autoplay: false,     interval: 5000,     duration: 1000   },   changeIndicatorDots: function(e) {     this.setData({       indicatorDots: !this.data.indicatorDots     })   },   changeAutoplay: function(e) {     this.setData({       autoplay: !this.data.autoplay     })   },   intervalChange: function(e) {     this.setData({       interval: e.detail.value     })   },   durationChange: function(e) {     this.setData({       duration: e.detail.value     })   } })看了上面的官方文档就可以清楚的知道这个就是我们类似在写html里用到的banner滑动插件一样拿过来就可以使用多么的方便。我们的项目中同样用参数绑定的方式输出的相关参数参数定义在index.js pages({...})方法中  为什么要绑定参数？为什么不直接写入参数呢？好处太多图片我们不可能写死从服务器请求图片同时可以方便的控制我们的相关参数来改变swiper的行为等。至于参数绑定官网说的也很清楚这里不在解释。2）城市选择及切换这块看起来很简单实际上很麻烦如果对动画不熟悉的朋友可以会苦恼一番的。上面的动画很流畅可能是因为抓屏工具不太好这点大可不用关心。我们点击中间的“交换圆”的时候”出发城市“与”到达城市“相互交换他们不是立即变化而是中间有一个\"位移\"效果同时那个“交换的圆”也要旋转180度。这样体验感立马\"高上大\"。呵呵不是吗？下面我们详细的来实现它。我们首先来温习下官网动画相关的文档说明 wx.createAnimation(OBJECT)创建一个动画实例animation。调用实例的方法来描述动画。最后通过动画实例的export方法导出动画数据传递给组件的animation属性。注意: export 方法每次调用后会清掉之前的动画操作OBJECT参数说明：参数类型必填说明durationInteger否动画持续时间单位ms默认值 400timingFunctionString否定义动画的效果默认值\"linear\"有效值：\"linear\",\"ease\",\"ease-in\",\"ease-in-out\",\"ease-out\",\"step-start\",\"step-end\"delayInteger否动画延迟时间单位 ms默认值 0transformOriginString否设置transform-origin默认为\"50% 50% 0\"var animation = wx.createAnimation({  transformOrigin: \"50% 50%\",  duration: 1000,  timingFunction: \"ease\",  delay: 0})animation动画实例可以调用以下方法来描述动画调用结束后会返回自身支持链式调用的写法。样式：方法参数说明opacityvalue透明度参数范围 0~1backgroundColorcolor颜色值widthlength长度值如果传入 Number 则默认使用 px可传入其他自定义单位的长度值heightlength长度值如果传入 Number 则默认使用 px可传入其他自定义单位的长度值toplength长度值如果传入 Number 则默认使用 px可传入其他自定义单位的长度值leftlength                                            .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                (2)                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (2 人)snailerwx_d0c5f84dac                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序图集预览器列表页实现上拉加载下拉刷新               github精选：微信小程序踩坑集合（更新）                                                        原作者: 谷歌’s                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 精品教程：微信小程序实战之知乎日报                                                      • 精品教程《二》：微信小程序实战之小豆瓣图书                                                      • 微信小程序学习用精品demo：麻将骰子：附详细教程                                                      • oopsguy精品教程《三》微信小程序之ES6与事项助手                                                      • 精品demo探趣实战教程：微信小程序初体验与DEMO分享                                                      • 精品！微信小程序电影推荐demo实战开发小结（附源码及思维导图） ... ... ... ... ... ...                                                      • 微信小程序的动画效果：使用animation快速制作切换动画                                                      • 微信小程序连续旋转动画this.animation.rotate                                                      • 新手转战小程序开发心得                                                                                                                                                   4 条回复                                                                                     天下雪                              2017-1-7 01:09                                       snailer: 不错很详细！没看过动画案例的也能大概看懂。同学水平不错啊    回复                                                                            snailer                              2017-1-7 01:04                                       不错很详细！没看过动画案例的也能大概看懂。    回复                                                                            天下雪                              2017-1-6 15:42                                       wx_d0c5f84dac: 真的受教了感谢分享！同学假如有学习的不错的东西也欢迎在论坛里分享一下    回复                                                                            wx_d0c5f84dac                              2017-1-6 15:36                                       真的受教了感谢分享！    回复                                                               \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                        推荐教程开发小程序折叠面板2020-02-16小程序对文件及后缀名解析2020-02-16小程序后端 egg 框架开发记录2020-02-16           最新Demo同城小程序代码2020-01-09汽车养护2020-01-07微信答题小程序仿头脑王者源码2020-01-02微信小程序图书共享借阅全套模板2019-12-10行政后勤服务小程序2019-11-28微信小程序--蓝牙控制音乐播放小车2019-11-15微信小程序--颜色选择器2019-11-13求小程序源码2019-11-04微信小程序--垃圾分类小程序2019-10-25            jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092517|413637228689f40f5a1758c13e4540be|2';\t\t\t\t\t\t"},{"title": "微信小程序商城开发--注意要点 ", "author": "                  Rolan                  2017-10-9 00:23                ", "text": "                                                                                                                                                                                                                                                                 这篇说一下我们在此次开发商城类的小程序时遇到的一些需要注意的小问题！⒈收货地址 这个问题想起来就醉的不行！在开始静态布局的时候费了大半天劲把整个选择地址创建地址（地图选址）重新编辑修改地址删除地址的页面都写好然后在手机预览。点一下选择收货地址蹦出来两套页面啊！一套就是我写的另一套是…… 当初是死活也没想到小程序自带的 wx.chooseAdress 是直接调用微信底层的方法的而且所有功能应有尽有。真是欲哭无泪啊！！！分析下发生这种事情的原因：首先刚开始接触小程序对一些方法在不了解的情况下就开始入手写代码也算是个大忌了；其次这个功能在较低版本的开发者工具上面是预览不出该效果的只能在手机预览；再次臣妾实在是没想到啊。就当是个教训了在此提醒各位新手一定要避开这个坑！⒉小程序最多只能跳5栈 在开发小程序前一定要熟知业务流程尽量把跳转页面控制在5栈之内。详情参考 API 。 如果遇到一些比较复杂的业务流程无法控制在5栈之内请参考某大神的系列文章⒊页面传值 这个比较简单些用法跟html+javascript类似。方法有多种我只说我用到的两种：通过链接传值和本地存储传值！链接传值： wxml 代码 <navigator url=\"../orderForm/orderForm?form_id=1\">在接收页面的 js 中写onLoad:function(options){    this.setData({        Form_id:options.form_id    })}这样就接收到传过来的值了。本地存储传值： 传值页面的 js 中写// 把选中的商品 id（cartIdString）放入本地存储 供支付页面使用    wx.setStorage({      key: 'cartIdString',      data: cartIdString,      success:function(res){        console.log('sucess')      }    })    // 把选中的商品 总价 放入本地存储 供支付页面使用    wx.setStorage({      key: 'total',      data: that.data.total,      success: function (res) {        console.log('sucess')      }    })接收页面的 js 中写onReady:function(e){    var that = this;    // 给后台返回购物车页面中被选中商品的 id    wx.getStorage({      key: 'cartIdString',      success: function (res) {        console.log(res.data)      }    })// 返回购物车页面中被选中商品的 总价    wx.getStorage({      key: 'total',      success: function (res) {        that.setData({          total: res.data        })      }    })⒋request请求数量 整个小程序在运行时同时存在的 request 请求数量限制在5个。解决办法是在页面出栈时将该页面的所有 request 请求全部销毁。 先给每一个 request 请求赋给一个变量然后在 onUnload 事件中用 requestTask.abort() 方法将其销毁。js 代码onLoad: function () {    var that = this;    var a = wx.request({      url: 'http://192.168.200.146:8080/trwl/xcx/selcar',      method: 'GET',      dataType: 'json',      success: function (res) {        that.setData({          carts:res.data        })        that.sum()      },      fail: function (res) { },      complete: function (res) { },    })  },//将 request 进行销毁onUnload: function () {    requestTask.abort();    a.abort();}5.往后台传求组时不能直接以Array的格式传需要将其转换成字符串格式 代码如下：var cartIdArray = [];    var cartIdString = '';    var carts = this.data.carts;    for(var i=0;i<carts.length;i++){      if(carts[i].ch){        cartIdArray.push(this.data.carts[i].cartId)      }    }    for (var i = 0; i < cartIdArray.length; i++) {      cartIdString += cartIdArray[i] + \",\";    }看完点赞的读者都是好读者！                                              .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                (24)                鸡蛋                (1)function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}刚表态过的朋友 (25 人)w吖。46aptsalyqlyqhjh1123w缺心眼49w亮有一计77chowyzw媛。73灿烈黄小花w﹉﹉计然68wGrassroot39wnick41wzmz34鑫小程序wuxia小小超wx_哇哈哈indexcqqw天上水74可口的大汉delgiswx_单调25332109990                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            小程序常用的知识点               小程序审核发布经验                                                        原作者: 刘飞                   来自: 简书                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序--辣椒忍者（点餐商城）                                                      • 微信小程序之侧栏分类 —— 微信小程序实战商城系列（1）                                                      • 微信小程序之仿淘宝分类入口 —— 微信小程序实战商城系列（2） ... ...                                                      • 微信小程序之购物数量加减 —— 微信小程序实战商城系列（3） ... ...                                                      • 微信小程序之商品属性分类 —— 微信小程序实战商城系列（4） ... ... ...                                                      • 微信小程序---商城模块                                                      • 微信小程序：商城系列专辑（开发指南+精品Demo）                                                      • 通过新浪云部署NideShop微信小程序商城（基于Node.js+MySQL+ThinkJS） ... ...                                                      • 黄秀杰实战系列-- 灵动商城姊妹——灵犀外卖新鲜出炉                                                      • 送给将要写小程序的你                                                                                               "},{"title": "【微信小程序开发】来看看，那些年我们踩过的坑~ ", "author": "                  Rolan                  2017-6-14 14:53                ", "text": "                                                                                                                                                                                     textarea组件value不显示textarea组件默认值绑定data数据真机不显示问题 | 链接使用.switchTab跳转到tabbar页传递参数问题跳转时无法带参数解决方法| 链接自定义属性data问题自定义的属性都会转为小写,js取时要注意!| 链接scroll-view下拉刷新被请求多次在手机端会多次触发而在微信开发者工具就能正常使用| 链接navigate跳转传参url被截断被url截断了你要编下码才能传过去| 链接发布后无法访问（小程序尚未发布）有时候在审核通过后然后在后台提交发布这个时候小程序会出现一些异常情况 | 链接信息推送配置token校验失败消息推送一直无法开启总是报服务器繁忙或者token无效| 链接判断显示与不显示 wx:if=\"false\"在微信小程序中判断显示与不显示或者其他用boolean 类型的值。。。 | 链接onLaunch异步回调数据无法加载开发经常遇到这样的场景在小程序生成时直接获取微信用户信息并且注册到自己服务器上| 链接微信小程序与PHP交互时传递参数的坑当小程序的网络请求需要传递参数时php接收该参数的方法与原生的不同不再用$_POST[| 链接XML格式转换为json格式微信小程序不支持DOM所以XML需要转化为JSON后再传给前端；| 链接post请求无法获取数据直接写成这样 header: { \"content-type\": \"application/x-www-form-urlencoded\" },| 链接swiper无法保持宽高比swiper 里的图片大小 为什么 给了高度以后就不按比例来显示| 链接js里面的data数据展现不出来我这个为嘛有些页面能调出数据有些不能？| 链接jq$带来的问题问题描述：带有$的js微信不识别 解决方法请不要在微信小程序内使用| 链接item加短横线-问题写了一句for循环 其他页面突然全变空白了| 链接小程序地图和百度地图的坐标转换老程序收集的程序是百度的bd0911坐标而小程序坐标是腾讯按另一个标准来的坐标系统。| 链接wx.uploadFile 的编码坑跳坑记录主要是由于真机预览时 formData 中的非字母、数字的 ASCII 编码的字符如中文、泰文传|链接IIS服务器无法上传大于50K的图片40K一下的图片上传到服务器OK , 超过40K接口直接返回413的错误,请求实数据过大| 链接图片显示不全对于一张网络图片高度太高而显示不全如何解决？| 链接微信小程序 +nodejs+socket.io bug微信小程序 websocket 协议版本为13 而 socket.io 支持的协议版本为4| 链接es6不支持Object.assignObject.assign 和 for of 不能用 需要转化后才能用| 链接更新后hover-class在真机下无效在开发工具中点击没问题但在真机测试时点击后无效果| 链接小程序的登录号注册腾讯云我扫一扫登陆腾讯云没有我小程序的号| 链接路径path坑；相对路径与绝对路径小程序里面的好多path路径都是相对路径这个问题在很多api中都可能会遇到| 链接打开调试模式与非调试模式的区别开启调试模式不会检查合法域名关闭了就会检查| 链接当前系统代理不是安全代理可能的原因： 1：使用了代理； 2：使用了翻墙软件或VPN| 链接下拉刷新在真机上无法实现一直有同学反映模拟器中可以正确的实现下拉刷新但在真机上无法实现下拉刷新的问题| 链接input cursor真机无法使用搜索输入框做个限制输入字符长度和最少字符 在dev 调试中发现e.detail.cursor | 链接设置颜色真机无效假如使用英文颜色在真机无效请使用十六进制颜色码； 比如red无效请修改为#FF0000 | 链接canvas、textarea、video层级最高的变通方法小程序中 canvas、textarea、video 等组件使用原生渲染如果需要弹层交互的话它们会|链接button无法修改样式使用button标签默认是无法更改样式加上类名也会因为优先级问题不能覆盖原样式 | 链接长按触发longtap事件时同时触发tap触发longtap时加锁手指移开屏幕时解除锁 通过触发事件来控制事件分发 | 链接页面跳转传带有“%”等特殊参数url里的特殊参数一般需要用encodeURIComponent编码掉| 链接【IOS坑】hidden在个别组件无效今日项目中发现IOS下hidden无效Android下正常；| 链接wx.scanCode()扫描二维码API及无法扫描问题为什么用小程序扫码一律都扫不出来| 链接referer及服务器反盗链导致的403报错等问题HTTP 请求 Header , header 中不能设置 Referer| 链接                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序实现移动端滑动分页效果（ajax）               微信小程序中如何使用wxParse解析html                                                                                                                                                                /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 微信小程序：商城系列专辑（开发指南+精品Demo）                                                      • 微信小程序爬坑日记                                                                                               "},{"title": "SF问答精选《一》：如何引入第三方插件，调用自定义方法 ", "author": "                  天下雪                  2017-1-13 00:49                ", "text": "                                                                                                                                                                                     除了我们网站还有很多地方聚集着小程序的开发者在上面也有一些问题和答案会给大家一些参考；本期整理的是sf：segmentfault.com回答部分会标注个人id此处的个人id指的是sf内的个人id；假如是我回答的则没有标注；以下均属于个人回答所以仅供参考如有不正确的地方请指出以便我修正；如果你对其中的问题也有自己的答案欢迎分享在底下以便观看者查看参考；问题：微信小程序工具登入的问题从微信小程序工具页面下载微信小程序安装后运行微信小程序工具。可是扫码后就是登入不了！提示：答：一般这个问题是由开启代理或翻墙等引发的取消即可；或在微信开发者工具的代理内选择直接连接；问题：微信小程序下拉加载更多数据如何实现答：@kstd123回答Page({onPullDownRefresh: ()=>{wx.stopPullDownRefresh();}})问题：微信小程序 懒加载的问题在微信小程序中由于无法使用dom该怎么处理图片的懒加载呢？如果只是单纯的一个列表进行懒加载可以通过元素高度来判断如果复杂的单页面进行懒加载就很难实现答：@不爱吃西红柿的鱼回答文档：https://mp.weixin.qq.com/debug/wxadoc/dev/component/image.html?t=201715binderror HandleEvent 当错误发生时发布到 AppService 的事件名事件对象event.detail = {errMsg: 'something wrong'}bindload HandleEvent 当图片载入完毕时发布到 AppService 的事件名事件对象event.detail = {height:'图片高度px', width:'图片宽度px'}问题：微信小程序调用自定义方法getStatus 是一个方法怎样写一个方法根据传入的参数返回一个值还有在前端页怎么调用这个方法。就像angularJs 那样。小程序怎么实现答：@wenkanglin回答首先你更正一下写法不用在小程序中使用html的标签把div换掉使用view组件。虽然像一些html的标签在小程序中编译运行不会报错但也不会被识别的另一些像h1、h2这些标签写在小程序中会报错！然后小程序中不支持直接事件传参{{getStatus(param)}}会报错我目前想到的办法是添加一个data属性来做比如：<view class=\"flow-tit\" data-param=\"{{param}}\" bindtap=\"{{getStatus}}\"></view>然后在js文件中获取该参数：getStatus(e) {  console.log(e.target.dataset.param)}问题：微信小程序get和post请求小程序的请求要做跨域处理吗答：@xiadd回答不存在跨域问题因为只可以访问后台设置好的的域名还必须是https问题：微信小程序中生成3rd_session请问这个3rd_session一般是怎么生成？后台服务器使用nodejs。答：@lvsjack回答3rd_session就是后台服务器生成的随机数。后台服务器可以调用head -n 80 /dev/urandom | tr -dc A-Za-z0-9 | head -c 168这样的shell 命令获取168位的随机字符串。问题：微信小程序 服务器 TLS版本Linux 服务器上的 TLS 版本是 1.0 小程序要求 要 1.2该如何升级补充：1 nginx 的配置文件中 2 若勾选不校验则可以正常调用 api 3 若不勾选微信小程序开发工具报错 4 真机调试则始终报错答：@Wake回答修改配置文件中的下面两个设置ssl_protocols TLSv1 TLSv1.1 TLSv1.2;ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;问题：如何引入第三方插件（网上的方法已经试过）引入第三方插件网上有人说需要进行UMD打包打包之后引入还是不行。有的说需要暴露接口对插件代码进行改造加入了module.exports = function,然后通过require引入但是引入后还是报错。个人引用的是strophe.js文件求大神告知解决办法答：@Vace_Vlm回答去看了一下Strophe的源码。不知道你用的什么版本的。我看源码最后是这样的function (Strophe, build, msg, iq, pres) {    window.Strophe = Strophe;    window.$build = build;    window.$msg = msg;    window.$iq = iq;    window.$pres = pres;};小程序中宿主环境不是浏览器所以没有window。这样写当然是不行的。你可以尝试修改为function (Strophe, build, msg, iq, pres) {    var global = {}    global.Strophe = Strophe;    global.$build = build;    global.$msg = msg;    global.$iq = iq;    global.$pres = pres;    module.exports = global};使用的时候：var Strophe = require('./pathStrophe.js').Strophe注：小程序和web编程是有区别的。我看了一下这个库的源码使用了很多document, xhr之类的这些是不支持的哦。可以查阅官方文档。Storophe源代码问题：微信小程序怎么修改 wx:for 的默认下标变量名index?项目中遇到一个业务场景, 在wxml页面中需要两个for循环嵌套, 在内循环里使用外循环的下标index, 但是这个又和内循环的index冲突, 各位有知道怎么自定义 wx:for 的下标吗?答：@@shuangwaiwai回答wx:for-index=\"index\" 引号里面自己定义就好问题：微信小程序中如何通过JS来操作page标签的CSS属性？已经可以在wxss文件中使用page标签来设置整个页面的样式但是如果想要通过用户的操作来对page标签的样式做出修改的话应该怎么做呢？答：@许剑锋回答小程序目前没有修改样式api但是可以利用数据绑定实现动态改变样式可以用view标签模拟page然后改变view标签的样式以下案例演示了如果改变page背景颜色：index.wxml<view class=\"page\" style=\"background-color:{{pageBackgroundColor}}\" ><button bindtap=\"changeColor\" hover-class=\"none\">点击修改背景颜色</button></view>index.wxss.page {  display: block;  min-height: 100%;  width: 100%;  position: absolute;  left: 0;  top: 0;  z-index: 1;}index.jsPage({  data: {    // 自定义page对象CSS样式对象    pageBackgroundColor:'#5cb85c'  },  onLoad: function () {},  // 改变背景颜色  changeColor: function() {    var bgColor = this.data.pageBackgroundColor == 'red' ? '#5cb85c' : 'red';    // 设置背景颜色数据    this.setData( {      pageBackgroundColor: bgColor    } );  }                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序开发入坑指南               SF问答精选《二》使用第三方库问题swiper点何修改样式                                                        原作者: 天下雪                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • SF问答精选《二》使用第三方库问题swiper点何修改样式                                                      • sf问答精选《三》点击展开再次点击收回setData                                                      • 微信小程序外部引入方法                                                                                               "},{"title": "微信小程序踩坑 ", "author": "                  天下雪                  2017-2-25 00:05                ", "text": "                                                                                                                                                                                                                                                                 不支持importantcolor不支持父级覆盖如果视图滚动则上层的vew背景色是半透明的没法遮挡事件绑定不支持delagate吧wx.login 不支持断网设置会很慢只能超时获取网络状态不管有无网络都是会触发success只是networkType不同。没网的时候ios和adr返回值不同分别为fail和noneview 是 display：block。text是inline。只有text的可以选中input 如果value是通过data赋值的同时又绑定了bindinput有可能会触发循环导致文字闪烁按钮点击多次对多次执行比如页面跳转template的data传值,import src路径计算有bug ./item.wxml 和 item.wxml 是不一样的用后者否则就是../item.wxmlsetData 单次设置不能超过1024kbstorage存储大小限制是每个10m小程序中的组件样式是可以覆盖的比如button使用普通的class可以覆盖小程序不支持webfont字体的外部引用但是如果转成base64的话是可以正常使用的                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                                                                                      鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                                            微信小程序开发：框架与组件               记第一次小程序之旅                                                        原作者: 余歌_非鱼                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • github精选：微信小程序踩坑集合（更新）                                                      • 微信小程序踩坑记                                                      • 一个小程序开发者踩过的坑和脑子里进过的水！                                                      • 关于上拉加载下拉更新的问题踩的坑！                                                      • 微信小程序踩坑之路                                                      • 小程序开发踩坑                                                                                               "},{"title": "使用TypeScript开发微信小程序（1） ", "author": "                  天下雪                  2017-1-11 15:31                ", "text": "                                                                                                                                                                                     原文链接：http://mp.weixin.qq.com/s?__biz=MzI0ODU5Mzg0NA==&mid=2247483727&idx=1&sn=111550394a7cd5c5034a7d51e0f7b6a7&chksm=e99f2d94dee8a4824e1aab59df7204e98e09af0d85d277c10ea1882215368744405b101a708e#rdTypeScript 的基本数据类型有boolean、number、string 、array、enum、any、void。TypeScript 的基本数据类型有boolean、number、string 、array、enum、any、void。Boolean（布尔值）最基本的数据类型就是简单的 true / false 值称之为“布尔值”。赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序 结构以及常见问题               微信小程序开发入坑指南                                                        原作者: guyoung                                                                                                        /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • 使用 Visual Studio Code 和 TypeScript 开发微信小程序                                                      • 微信小程序根据java后台传的type值链接不同的页面                                                                                                                                                   2 条回复                                                                                     天下雪                              2017-1-11 15:06                                       学后分享好    回复                                                                            guyoung                              2017-1-11 15:19                                       @天下雪 文章基本上官方文档代码可以参考    回复                                                               \t\tupdateseccode('cSHxP6g5', '<sec> <span id=\"sec<hash>\" onclick=\"showMenu(this.id);\"><sec></span><div id=\"sec<hash>_menu\" class=\"p_pop p_opt\" style=\"display:none\"><sec></div>', 'portal::view');发表回复                                                              jQuery(function(){jQuery(\"#tedt .pt\").focus(function(){  jQuery(this).addClass(\"bgchange\");}).blur(function(){  jQuery(this).removeClass(\"bgchange\");});    });                                                             相关栏目              官方教程后端教程官方问答入门系列官方基础教程新手教程面向新手系列小技巧系列https相关系列实战教程                新手教程阅读排行            jQuery(function() {jQuery(\"span\").click(function() {var thisEle = jQuery(\"#article_content\").css(\"font-size\");var textFontSize = parseFloat(thisEle, 10);var unit = thisEle.slice( - 2);var cName = jQuery(this).attr(\"class\");if (cName == \"bigger\") {if (textFontSize <= 22) {textFontSize += 2;}} else if (cName == \"smaller\") {if (textFontSize >= 12) {textFontSize -= 2;}}jQuery(\"#article_content\").css(\"font-size\", textFontSize + unit);});});              © 2019 极乐科技 |          鄂ICP备14019861号 |         鄂公网安备：42018502003797 | 网站地图                 var _hmt = _hmt || [];(function() {  var hm = document.createElement(\"script\");  hm.src = \"//hm.baidu.com/hm.js?c3e02db653db36da2f23ce021891217b\";  var s = document.getElementsByTagName(\"script\")[0];   s.parentNode.insertBefore(hm, s);})();  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-98020757-1', 'auto');  ga('send', 'pageview');!function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement(\"script\"),tag=t.getElementsByTagName(\"script\")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,\"script\",\"assets.growingio.com/2.1/gio.js\",\"gio\");  gio('init','874f0f6c4c3a4387', {});//custom page code begin here//custom page code end heregio('send');                         返回顶部jQuery.noConflict();jQuery(function(){        //首先将#back-to-top隐藏        jQuery(\"#share\").hide();        //当滚动条的位置处于距顶部100像素以下时跳转链接出现否则消失        jQuery(function () {            jQuery(window).scroll(function(){                if (jQuery(window).scrollTop()>100){                    jQuery(\"#share\").fadeIn();                }                else                {                    jQuery(\"#share\").fadeOut();                }            });            //当点击跳转链接后回到页面顶部位置            jQuery(\"#totop\").click(function(){                jQuery('body,html').animate({scrollTop:0},500);                return false;            });        });    });   \t\t\t\t\t\t\t\t\t\tvar tipsinfo = '9999|X3.2|0.6||0||0|7|1582092517|413637228689f40f5a1758c13e4540be|2';\t\t\t\t\t\t"},{"title": "小程序开发踩坑 ", "author": "                  天下雪                  2017-3-27 00:18                ", "text": "                                                                                                                                                                                     作者：proto袁浩宇原文地址从1月10多号到2月19日一直在做微信小程序虽然很菜但是还是来分享哈自己的心得下面就来详细的介绍哈自己目前的遇到比较尴尬的地方1.开发工具开发工具这个的确有点恶心我这里图方便就直接下来微信小程序官方推荐的。目前来看这个编辑器还是相当不稳定的比如不能正常关闭wxml查看节点不会加载等等。所以你如果用到一个比较稳定的版本请慎重考虑是否选择升级。2.开发工具也有的小技巧由于你页面展示的顺序是由你app.json中的页面地址的顺序来展示的经常切换代码顺序来预览就非常不方便了这里我们就可以使用官方编辑器自带的功能来调整。如图他这个地方有点小坑这三个箭头代表三个功能。中间那个就是我们要用的设置启动页的。如图 我们只要放入app.json你需要的地址即可同时我们也可以看到这里也可以设置参数。但是一定要注意在图中红圈的地方打上勾点击确定才能生效！3.上传与预览由于小程序大小最大为1024kb所以大家要严格控制自己项目的大小由于有时候开发工具存在的bug导致你的程序大于1024Kb时候也能出现扫描二维码的界面。但是在扫码后会提示构建失败之类的这个时候首先回去看看你的程序大小是否合格。当时有时候也会出现预览时候报错undefined的这个时候也可以去看看自己程序大小。4.onload与onshowonload只会在页面加载时候执行比如你用navigateBack回到之前的页面的时候之前那个页面不会再执行onload所以我们要触发某些函数的时候我们可以放在onshow里面即使是navigateBack回来也会执行。this.onload可以重新onload但是注意你之前onload是否有options传参的操作如果有在你使用this.onload的时候记得对参数传递处理5.关于绝对定位对于移动端网页都有这个问题对于一些有虚拟按键的手机绝对定位不是一个很好的选择他会在虚拟按键下出现上移的问题6.关于时间戳相互转换之前用了一些不是很好的方法原本以为没问题的确在安卓机型上没问题在ios上则出现了bug所以这里推荐使用微信小程序自带的util（这里有个使用的传送门http://www.jb51.net/article/97457.htm）7.data管理由于不能操作dom这里很多东西要用setData更新有时候逻辑稍微复杂flag和data就会很多这里个人觉得需要建立一个管理来理清这些东西                                             .appreciate{ margin-bottom:16px;}.appreciate .btn_appreciation { display: block; width: 110px; height: 40px; margin: 40px auto 0;font-size: 18px; line-height: 40px; text-align: center; vertical-align: middle; color: #fff; border-radius: 5px; background: #ff8000;}.appreciate .head_count.show { display: block;}.appreciate .head_count {display: none; margin: 30px auto 0; font-size: 14px;text-align: center;}.appreciate .head_count i {color: #ff8000;}.appreciate .head_count b {color: gray;}.appreciate_list_wrapper{ overflow: hidden; margin: 0 auto; width: 200px;}.appreciate_list.vcenter{ text-align: center;}.appreciate_list.vcenter a{ display:block;}.appreciate_list { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list img { position: relative; width: 34px;   height: 34px; margin: 0 6px 4px 0; border-radius: 17px;max-width: 100%!important;}.appreciate .btn_appreciation_t{background: #dc5d4a;}.appreciate .head_count_t i {color: #607fa6;}.appreciate_list_wrapper_t{ overflow: hidden; margin: 0 auto; width: 250px;}.appreciate_list_t.vcenter_t { text-align: center;}.appreciate_list_t.vcenter_t a{ display:block;}.appreciate_list_t { max-height: 120px; overflow: hidden; margin-right: -6px; line-height: 15px;}.appreciate_list_t img { position: relative; width: 30px; height: 30px; margin: 0 6px 4px 0;max-width: 100%!important;} 赞赏                                                               邀请                                                                                                                              鲜花                                鸡蛋                function errorhandle_clickhandle(message, values) {if(values['id']) {showCreditPrompt();show_click(values['idtype'], values['id'], values['clickid']);}}                         分享至 :QQ空间window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"2\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"16\"},\"share\":{},\"image\":{\"viewList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"],\"viewText\":\"分享到：\",\"viewSize\":\"16\"},\"selectShare\":{\"bdContainerClass\":null,\"bdSelectMiniList\":[\"qzone\",\"tsina\",\"tqq\",\"renren\",\"weixin\"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];收藏                                                    微信小程序学习笔记（二）：目录结构数据展示               微信小程序开发者问题集锦                                                        原作者: _proto_袁浩宇                   来自: 原文地址                                                                                     /*700*200 创建于 2017/12/12*/    var cpro_id = \"u3158955\";                                                                   相关阅读                                                                                                  • github精选：微信小程序踩坑集合（更新）                                                      • 微信小程序踩坑记                                                      • 微信小程序踩坑                                                      • github精选：小程序个人踩坑汇总并研究一些解决办法                                                      • 开发踩坑与总结：扩展icon组件不同页面中的数据交互使用gulp客服按钮 ...                                                      • 微信小程序踩坑之路                                                      • github精选：微信小程序入坑指南：scroll-view                                                      • 微信小程序日常知识储备及开发遇到的坑                                                      • 微信小程序开发踩坑记                                                      • 微信小程序开发中走过的坑(一)：获取城市地理位置及具体位置下拉及刷新的实现 ...                                                      • 微信小程序开发中走过的坑(二)：注册页面的实现                                                      • 微信小程序开发路上遇到的那些坑                                                      • 【每日出击运签】小程序“踩坑”总结                                                                                               "}